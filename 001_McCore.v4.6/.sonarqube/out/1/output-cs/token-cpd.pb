æÁ
uD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Common\c_FByteConverter.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
internal 
static 
class 
FByteConverter (
{ 
public"" 
static"" 
byte"" 
["" 
]"" 
getBytes"" %
(""% &
UInt16## 
value## 
,## 
bool$$ 
	isReverse$$ 
)%% 
{&& 	
byte'' 
['' 
]'' 
buf'' 
='' 
null'' 
;'' 
try)) 
{** 
buf++ 
=++ 
BitConverter++ "
.++" #
GetBytes++# +
(+++ ,
value++, 1
)++1 2
;++2 3
if,, 
(,, 
	isReverse,, 
),, 
{-- 
Array.. 
... 
Reverse.. !
(..! "
buf.." %
)..% &
;..& '
}// 
return00 
buf00 
;00 
}11 
catch22 
(22 
	Exception22 
ex22 
)22  
{33 
FDebug44 
.44 
throwException44 %
(44% &
ex44& (
)44( )
;44) *
}55 
finally66 
{77 
buf88 
=88 
null88 
;88 
}99 
return:: 
null:: 
;:: 
};; 	
public?? 
static?? 
byte?? 
[?? 
]?? 
getBytes?? %
(??% &
UInt32@@ 
value@@ 
,@@ 
boolAA 
	isReverseAA 
)BB 
{CC 	
byteDD 
[DD 
]DD 
bufDD 
=DD 
nullDD 
;DD 
tryFF 
{GG 
bufHH 
=HH 
BitConverterHH "
.HH" #
GetBytesHH# +
(HH+ ,
valueHH, 1
)HH1 2
;HH2 3
ifII 
(II 
	isReverseII 
)II 
{JJ 
ArrayKK 
.KK 
ReverseKK !
(KK! "
bufKK" %
)KK% &
;KK& '
}LL 
returnMM 
bufMM 
;MM 
}NN 
catchOO 
(OO 
	ExceptionOO 
exOO 
)OO  
{PP 
FDebugQQ 
.QQ 
throwExceptionQQ %
(QQ% &
exQQ& (
)QQ( )
;QQ) *
}RR 
finallySS 
{TT 
bufUU 
=UU 
nullUU 
;UU 
}VV 
returnWW 
nullWW 
;WW 
}XX 	
public\\ 
static\\ 
byte\\ 
[\\ 
]\\ 
getBytes\\ %
(\\% &
UInt64]] 
value]] 
,]] 
bool^^ 
	isReverse^^ 
)__ 
{`` 	
byteaa 
[aa 
]aa 
bufaa 
=aa 
nullaa 
;aa 
trycc 
{dd 
bufee 
=ee 
BitConverteree "
.ee" #
GetBytesee# +
(ee+ ,
valueee, 1
)ee1 2
;ee2 3
ifff 
(ff 
	isReverseff 
)ff 
{gg 
Arrayhh 
.hh 
Reversehh !
(hh! "
bufhh" %
)hh% &
;hh& '
}ii 
returnjj 
bufjj 
;jj 
}kk 
catchll 
(ll 
	Exceptionll 
exll 
)ll  
{mm 
FDebugnn 
.nn 
throwExceptionnn %
(nn% &
exnn& (
)nn( )
;nn) *
}oo 
finallypp 
{qq 
bufrr 
=rr 
nullrr 
;rr 
}ss 
returntt 
nulltt 
;tt 
}uu 	
publicyy 
staticyy 
byteyy 
[yy 
]yy 
getBytesyy %
(yy% &
charzz 
valuezz 
,zz 
bool{{ 
	isReverse{{ 
)|| 
{}} 	
byte~~ 
[~~ 
]~~ 
buf~~ 
=~~ 
null~~ 
;~~ 
try
€€ 
{
 
buf
‚‚ 
=
‚‚ 
BitConverter
‚‚ "
.
‚‚" #
GetBytes
‚‚# +
(
‚‚+ ,
value
‚‚, 1
)
‚‚1 2
;
‚‚2 3
if
ƒƒ 
(
ƒƒ 
	isReverse
ƒƒ 
)
ƒƒ 
{
„„ 
Array
…… 
.
…… 
Reverse
…… !
(
……! "
buf
……" %
)
……% &
;
……& '
}
†† 
return
‡‡ 
buf
‡‡ 
;
‡‡ 
}
ˆˆ 
catch
‰‰ 
(
‰‰ 
	Exception
‰‰ 
ex
‰‰ 
)
‰‰  
{
ŠŠ 
FDebug
‹‹ 
.
‹‹ 
throwException
‹‹ %
(
‹‹% &
ex
‹‹& (
)
‹‹( )
;
‹‹) *
}
ŒŒ 
finally
 
{
 
buf
 
=
 
null
 
;
 
}
 
return
‘‘ 
null
‘‘ 
;
‘‘ 
}
’’ 	
public
–– 
static
–– 
byte
–– 
[
–– 
]
–– 
getBytes
–– %
(
––% &
bool
—— 
value
—— 
,
—— 
bool
˜˜ 
	isReverse
˜˜ 
)
™™ 
{
šš 	
byte
›› 
[
›› 
]
›› 
buf
›› 
=
›› 
null
›› 
;
›› 
try
 
{
 
buf
ŸŸ 
=
ŸŸ 
new
ŸŸ 
byte
ŸŸ 
[
ŸŸ 
$num
ŸŸ  
]
ŸŸ  !
;
ŸŸ! "
if
   
(
   
!
   
value
   
)
   
{
¡¡ 
buf
¢¢ 
[
¢¢ 
$num
¢¢ 
]
¢¢ 
=
¢¢ 
$num
¢¢ !
;
¢¢! "
}
££ 
else
¤¤ 
{
¥¥ 
buf
¦¦ 
[
¦¦ 
$num
¦¦ 
]
¦¦ 
=
¦¦ 
$num
¦¦ !
;
¦¦! "
}
§§ 
if
©© 
(
©© 
	isReverse
©© 
)
©© 
{
ªª 
Array
«« 
.
«« 
Reverse
«« !
(
««! "
buf
««" %
)
««% &
;
««& '
}
¬¬ 
return
­­ 
buf
­­ 
;
­­ 
}
®® 
catch
¯¯ 
(
¯¯ 
	Exception
¯¯ 
ex
¯¯ 
)
¯¯  
{
°° 
FDebug
±± 
.
±± 
throwException
±± %
(
±±% &
ex
±±& (
)
±±( )
;
±±) *
}
²² 
finally
³³ 
{
´´ 
buf
µµ 
=
µµ 
null
µµ 
;
µµ 
}
¶¶ 
return
·· 
null
·· 
;
·· 
}
¸¸ 	
public
¼¼ 
static
¼¼ 
byte
¼¼ 
[
¼¼ 
]
¼¼ 
getBytes
¼¼ %
(
¼¼% &
Int64
½½ 
value
½½ 
,
½½ 
bool
¾¾ 
	isReverse
¾¾ 
)
¿¿ 
{
ÀÀ 	
byte
ÁÁ 
[
ÁÁ 
]
ÁÁ 
buf
ÁÁ 
=
ÁÁ 
null
ÁÁ 
;
ÁÁ 
try
ÃÃ 
{
ÄÄ 
buf
ÅÅ 
=
ÅÅ 
BitConverter
ÅÅ "
.
ÅÅ" #
GetBytes
ÅÅ# +
(
ÅÅ+ ,
value
ÅÅ, 1
)
ÅÅ1 2
;
ÅÅ2 3
if
ÆÆ 
(
ÆÆ 
	isReverse
ÆÆ 
)
ÆÆ 
{
ÇÇ 
Array
ÈÈ 
.
ÈÈ 
Reverse
ÈÈ !
(
ÈÈ! "
buf
ÈÈ" %
)
ÈÈ% &
;
ÈÈ& '
}
ÉÉ 
return
ÊÊ 
buf
ÊÊ 
;
ÊÊ 
}
ËË 
catch
ÌÌ 
(
ÌÌ 
	Exception
ÌÌ 
ex
ÌÌ 
)
ÌÌ  
{
ÍÍ 
FDebug
ÎÎ 
.
ÎÎ 
throwException
ÎÎ %
(
ÎÎ% &
ex
ÎÎ& (
)
ÎÎ( )
;
ÎÎ) *
}
ÏÏ 
finally
ĞĞ 
{
ÑÑ 
buf
ÒÒ 
=
ÒÒ 
null
ÒÒ 
;
ÒÒ 
}
ÓÓ 
return
ÔÔ 
null
ÔÔ 
;
ÔÔ 
}
ÕÕ 	
public
ÙÙ 
static
ÙÙ 
byte
ÙÙ 
[
ÙÙ 
]
ÙÙ 
getBytes
ÙÙ %
(
ÙÙ% &
Int32
ÚÚ 
value
ÚÚ 
,
ÚÚ 
bool
ÛÛ 
	isReverse
ÛÛ 
)
ÜÜ 
{
İİ 	
byte
ŞŞ 
[
ŞŞ 
]
ŞŞ 
buf
ŞŞ 
=
ŞŞ 
null
ŞŞ 
;
ŞŞ 
try
àà 
{
áá 
buf
ââ 
=
ââ 
BitConverter
ââ "
.
ââ" #
GetBytes
ââ# +
(
ââ+ ,
value
ââ, 1
)
ââ1 2
;
ââ2 3
if
ãã 
(
ãã 
	isReverse
ãã 
)
ãã 
{
ää 
Array
åå 
.
åå 
Reverse
åå !
(
åå! "
buf
åå" %
)
åå% &
;
åå& '
}
ææ 
return
çç 
buf
çç 
;
çç 
}
èè 
catch
éé 
(
éé 
	Exception
éé 
ex
éé 
)
éé  
{
êê 
FDebug
ëë 
.
ëë 
throwException
ëë %
(
ëë% &
ex
ëë& (
)
ëë( )
;
ëë) *
}
ìì 
finally
íí 
{
îî 
buf
ïï 
=
ïï 
null
ïï 
;
ïï 
}
ğğ 
return
ññ 
null
ññ 
;
ññ 
}
òò 	
public
öö 
static
öö 
byte
öö 
[
öö 
]
öö 
getBytes
öö %
(
öö% &
Int16
÷÷ 
value
÷÷ 
,
÷÷ 
bool
øø 
	isReverse
øø 
)
ùù 
{
úú 	
byte
ûû 
[
ûû 
]
ûû 
buf
ûû 
=
ûû 
null
ûû 
;
ûû 
try
ıı 
{
şş 
buf
ÿÿ 
=
ÿÿ 
BitConverter
ÿÿ "
.
ÿÿ" #
GetBytes
ÿÿ# +
(
ÿÿ+ ,
value
ÿÿ, 1
)
ÿÿ1 2
;
ÿÿ2 3
if
€€ 
(
€€ 
	isReverse
€€ 
)
€€ 
{
 
Array
‚‚ 
.
‚‚ 
Reverse
‚‚ !
(
‚‚! "
buf
‚‚" %
)
‚‚% &
;
‚‚& '
}
ƒƒ 
return
„„ 
buf
„„ 
;
„„ 
}
…… 
catch
†† 
(
†† 
	Exception
†† 
ex
†† 
)
††  
{
‡‡ 
FDebug
ˆˆ 
.
ˆˆ 
throwException
ˆˆ %
(
ˆˆ% &
ex
ˆˆ& (
)
ˆˆ( )
;
ˆˆ) *
}
‰‰ 
finally
ŠŠ 
{
‹‹ 
buf
ŒŒ 
=
ŒŒ 
null
ŒŒ 
;
ŒŒ 
}
 
return
 
null
 
;
 
}
 	
public
““ 
static
““ 
byte
““ 
[
““ 
]
““ 
getBytes
““ %
(
““% &
double
”” 
value
”” 
,
”” 
bool
•• 
	isReverse
•• 
)
–– 
{
—— 	
byte
˜˜ 
[
˜˜ 
]
˜˜ 
buf
˜˜ 
=
˜˜ 
null
˜˜ 
;
˜˜ 
try
šš 
{
›› 
buf
œœ 
=
œœ 
BitConverter
œœ "
.
œœ" #
GetBytes
œœ# +
(
œœ+ ,
value
œœ, 1
)
œœ1 2
;
œœ2 3
if
 
(
 
	isReverse
 
)
 
{
 
Array
ŸŸ 
.
ŸŸ 
Reverse
ŸŸ !
(
ŸŸ! "
buf
ŸŸ" %
)
ŸŸ% &
;
ŸŸ& '
}
   
return
¡¡ 
buf
¡¡ 
;
¡¡ 
}
¢¢ 
catch
££ 
(
££ 
	Exception
££ 
ex
££ 
)
££  
{
¤¤ 
FDebug
¥¥ 
.
¥¥ 
throwException
¥¥ %
(
¥¥% &
ex
¥¥& (
)
¥¥( )
;
¥¥) *
}
¦¦ 
finally
§§ 
{
¨¨ 
buf
©© 
=
©© 
null
©© 
;
©© 
}
ªª 
return
«« 
null
«« 
;
«« 
}
¬¬ 	
public
°° 
static
°° 
byte
°° 
[
°° 
]
°° 
getBytes
°° %
(
°°% &
Single
±± 
value
±± 
,
±± 
bool
²² 
	isReverse
²² 
)
³³ 
{
´´ 	
byte
µµ 
[
µµ 
]
µµ 
buf
µµ 
=
µµ 
null
µµ 
;
µµ 
try
·· 
{
¸¸ 
buf
¹¹ 
=
¹¹ 
BitConverter
¹¹ "
.
¹¹" #
GetBytes
¹¹# +
(
¹¹+ ,
value
¹¹, 1
)
¹¹1 2
;
¹¹2 3
if
ºº 
(
ºº 
	isReverse
ºº 
)
ºº 
{
»» 
Array
¼¼ 
.
¼¼ 
Reverse
¼¼ !
(
¼¼! "
buf
¼¼" %
)
¼¼% &
;
¼¼& '
}
½½ 
return
¾¾ 
buf
¾¾ 
;
¾¾ 
}
¿¿ 
catch
ÀÀ 
(
ÀÀ 
	Exception
ÀÀ 
ex
ÀÀ 
)
ÀÀ  
{
ÁÁ 
FDebug
ÂÂ 
.
ÂÂ 
throwException
ÂÂ %
(
ÂÂ% &
ex
ÂÂ& (
)
ÂÂ( )
;
ÂÂ) *
}
ÃÃ 
finally
ÄÄ 
{
ÅÅ 
buf
ÆÆ 
=
ÆÆ 
null
ÆÆ 
;
ÆÆ 
}
ÇÇ 
return
ÈÈ 
null
ÈÈ 
;
ÈÈ 
}
ÉÉ 	
public
ÍÍ 
static
ÍÍ 
UInt16
ÍÍ 
toUInt16
ÍÍ %
(
ÍÍ% &
byte
ÎÎ 
[
ÎÎ 
]
ÎÎ 
bytes
ÎÎ 
,
ÎÎ 
bool
ÏÏ 
	isReverse
ÏÏ 
)
ĞĞ 
{
ÑÑ 	
try
ÒÒ 
{
ÓÓ 
if
ÔÔ 
(
ÔÔ 
	isReverse
ÔÔ 
)
ÔÔ 
{
ÕÕ 
Array
ÖÖ 
.
ÖÖ 
Reverse
ÖÖ !
(
ÖÖ! "
bytes
ÖÖ" '
)
ÖÖ' (
;
ÖÖ( )
}
×× 
return
ØØ 
BitConverter
ØØ #
.
ØØ# $
ToUInt16
ØØ$ ,
(
ØØ, -
bytes
ØØ- 2
,
ØØ2 3
$num
ØØ4 5
)
ØØ5 6
;
ØØ6 7
}
ÙÙ 
catch
ÚÚ 
(
ÚÚ 
	Exception
ÚÚ 
ex
ÚÚ 
)
ÚÚ  
{
ÛÛ 
FDebug
ÜÜ 
.
ÜÜ 
throwException
ÜÜ %
(
ÜÜ% &
ex
ÜÜ& (
)
ÜÜ( )
;
ÜÜ) *
}
İİ 
finally
ŞŞ 
{
ßß 
}
áá 
return
ââ 
$num
ââ 
;
ââ 
}
ãã 	
public
çç 
static
çç 
UInt32
çç 
toUInt32
çç %
(
çç% &
byte
èè 
[
èè 
]
èè 
bytes
èè 
,
èè 
bool
éé 
	isReverse
éé 
)
êê 
{
ëë 	
try
ìì 
{
íí 
if
îî 
(
îî 
	isReverse
îî 
)
îî 
{
ïï 
Array
ğğ 
.
ğğ 
Reverse
ğğ !
(
ğğ! "
bytes
ğğ" '
)
ğğ' (
;
ğğ( )
}
ññ 
return
òò 
BitConverter
òò #
.
òò# $
ToUInt32
òò$ ,
(
òò, -
bytes
òò- 2
,
òò2 3
$num
òò4 5
)
òò5 6
;
òò6 7
}
óó 
catch
ôô 
(
ôô 
	Exception
ôô 
ex
ôô 
)
ôô  
{
õõ 
FDebug
öö 
.
öö 
throwException
öö %
(
öö% &
ex
öö& (
)
öö( )
;
öö) *
}
÷÷ 
finally
øø 
{
ùù 
}
ûû 
return
üü 
$num
üü 
;
üü 
}
ıı 	
public
 
static
 
UInt64
 
toUInt64
 %
(
% &
byte
‚‚ 
[
‚‚ 
]
‚‚ 
bytes
‚‚ 
,
‚‚ 
bool
ƒƒ 
	isReverse
ƒƒ 
)
„„ 
{
…… 	
try
†† 
{
‡‡ 
if
ˆˆ 
(
ˆˆ 
	isReverse
ˆˆ 
)
ˆˆ 
{
‰‰ 
Array
ŠŠ 
.
ŠŠ 
Reverse
ŠŠ !
(
ŠŠ! "
bytes
ŠŠ" '
)
ŠŠ' (
;
ŠŠ( )
}
‹‹ 
return
ŒŒ 
BitConverter
ŒŒ #
.
ŒŒ# $
ToUInt64
ŒŒ$ ,
(
ŒŒ, -
bytes
ŒŒ- 2
,
ŒŒ2 3
$num
ŒŒ4 5
)
ŒŒ5 6
;
ŒŒ6 7
}
 
catch
 
(
 
	Exception
 
ex
 
)
  
{
 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
‘‘ 
finally
’’ 
{
““ 
}
•• 
return
–– 
$num
–– 
;
–– 
}
—— 	
public
›› 
static
›› 
Int16
›› 
toInt16
›› #
(
››# $
byte
œœ 
[
œœ 
]
œœ 
bytes
œœ 
,
œœ 
bool
 
	isReverse
 
)
 
{
ŸŸ 	
try
   
{
¡¡ 
if
¢¢ 
(
¢¢ 
	isReverse
¢¢ 
)
¢¢ 
{
££ 
Array
¤¤ 
.
¤¤ 
Reverse
¤¤ !
(
¤¤! "
bytes
¤¤" '
)
¤¤' (
;
¤¤( )
}
¥¥ 
return
¦¦ 
BitConverter
¦¦ #
.
¦¦# $
ToInt16
¦¦$ +
(
¦¦+ ,
bytes
¦¦, 1
,
¦¦1 2
$num
¦¦3 4
)
¦¦4 5
;
¦¦5 6
}
§§ 
catch
¨¨ 
(
¨¨ 
	Exception
¨¨ 
ex
¨¨ 
)
¨¨  
{
©© 
FDebug
ªª 
.
ªª 
throwException
ªª %
(
ªª% &
ex
ªª& (
)
ªª( )
;
ªª) *
}
«« 
finally
¬¬ 
{
­­ 
}
¯¯ 
return
°° 
$num
°° 
;
°° 
}
±± 	
public
µµ 
static
µµ 
Int32
µµ 
toInt32
µµ #
(
µµ# $
byte
¶¶ 
[
¶¶ 
]
¶¶ 
bytes
¶¶ 
,
¶¶ 
bool
·· 
	isReverse
·· 
)
¸¸ 
{
¹¹ 	
try
ºº 
{
»» 
if
¼¼ 
(
¼¼ 
	isReverse
¼¼ 
)
¼¼ 
{
½½ 
Array
¾¾ 
.
¾¾ 
Reverse
¾¾ !
(
¾¾! "
bytes
¾¾" '
)
¾¾' (
;
¾¾( )
}
¿¿ 
return
ÀÀ 
BitConverter
ÀÀ #
.
ÀÀ# $
ToInt32
ÀÀ$ +
(
ÀÀ+ ,
bytes
ÀÀ, 1
,
ÀÀ1 2
$num
ÀÀ3 4
)
ÀÀ4 5
;
ÀÀ5 6
}
ÁÁ 
catch
ÂÂ 
(
ÂÂ 
	Exception
ÂÂ 
ex
ÂÂ 
)
ÂÂ  
{
ÃÃ 
FDebug
ÄÄ 
.
ÄÄ 
throwException
ÄÄ %
(
ÄÄ% &
ex
ÄÄ& (
)
ÄÄ( )
;
ÄÄ) *
}
ÅÅ 
finally
ÆÆ 
{
ÇÇ 
}
ÉÉ 
return
ÊÊ 
$num
ÊÊ 
;
ÊÊ 
}
ËË 	
public
ÏÏ 
static
ÏÏ 
Int64
ÏÏ 
toInt64
ÏÏ #
(
ÏÏ# $
byte
ĞĞ 
[
ĞĞ 
]
ĞĞ 
bytes
ĞĞ 
,
ĞĞ 
bool
ÑÑ 
	isReverse
ÑÑ 
)
ÒÒ 
{
ÓÓ 	
try
ÔÔ 
{
ÕÕ 
if
ÖÖ 
(
ÖÖ 
	isReverse
ÖÖ 
)
ÖÖ 
{
×× 
Array
ØØ 
.
ØØ 
Reverse
ØØ !
(
ØØ! "
bytes
ØØ" '
)
ØØ' (
;
ØØ( )
}
ÙÙ 
return
ÚÚ 
BitConverter
ÚÚ #
.
ÚÚ# $
ToInt64
ÚÚ$ +
(
ÚÚ+ ,
bytes
ÚÚ, 1
,
ÚÚ1 2
$num
ÚÚ3 4
)
ÚÚ4 5
;
ÚÚ5 6
}
ÛÛ 
catch
ÜÜ 
(
ÜÜ 
	Exception
ÜÜ 
ex
ÜÜ 
)
ÜÜ  
{
İİ 
FDebug
ŞŞ 
.
ŞŞ 
throwException
ŞŞ %
(
ŞŞ% &
ex
ŞŞ& (
)
ŞŞ( )
;
ŞŞ) *
}
ßß 
finally
àà 
{
áá 
}
ãã 
return
ää 
$num
ää 
;
ää 
}
åå 	
public
éé 
static
éé 
Single
éé 
toFloat4
éé %
(
éé% &
byte
êê 
[
êê 
]
êê 
bytes
êê 
,
êê 
bool
ëë 
	isReverse
ëë 
)
ìì 
{
íí 	
try
îî 
{
ïï 
if
ğğ 
(
ğğ 
	isReverse
ğğ 
)
ğğ 
{
ññ 
Array
òò 
.
òò 
Reverse
òò !
(
òò! "
bytes
òò" '
)
òò' (
;
òò( )
}
óó 
return
ôô 
BitConverter
ôô #
.
ôô# $
ToSingle
ôô$ ,
(
ôô, -
bytes
ôô- 2
,
ôô2 3
$num
ôô4 5
)
ôô5 6
;
ôô6 7
}
õõ 
catch
öö 
(
öö 
	Exception
öö 
ex
öö 
)
öö  
{
÷÷ 
FDebug
øø 
.
øø 
throwException
øø %
(
øø% &
ex
øø& (
)
øø( )
;
øø) *
}
ùù 
finally
úú 
{
ûû 
}
ıı 
return
şş 
$num
şş 
;
şş 
}
ÿÿ 	
public
ƒƒ 
static
ƒƒ 
Double
ƒƒ 
toFloat8
ƒƒ %
(
ƒƒ% &
byte
„„ 
[
„„ 
]
„„ 
bytes
„„ 
,
„„ 
bool
…… 
	isReverse
…… 
)
†† 
{
‡‡ 	
try
ˆˆ 
{
‰‰ 
if
ŠŠ 
(
ŠŠ 
	isReverse
ŠŠ 
)
ŠŠ 
{
‹‹ 
Array
ŒŒ 
.
ŒŒ 
Reverse
ŒŒ !
(
ŒŒ! "
bytes
ŒŒ" '
)
ŒŒ' (
;
ŒŒ( )
}
 
return
 
BitConverter
 #
.
# $
ToDouble
$ ,
(
, -
bytes
- 2
,
2 3
$num
4 5
)
5 6
;
6 7
}
 
catch
 
(
 
	Exception
 
ex
 
)
  
{
‘‘ 
FDebug
’’ 
.
’’ 
throwException
’’ %
(
’’% &
ex
’’& (
)
’’( )
;
’’) *
}
““ 
finally
”” 
{
•• 
}
—— 
return
˜˜ 
$num
˜˜ 
;
˜˜ 
}
™™ 	
public
 
static
 
string
 
	toBoolean
 &
(
& '
byte
ŸŸ 
bytes
ŸŸ 
)
   
{
¡¡ 	
try
¢¢ 
{
££ 
if
¤¤ 
(
¤¤ 
bytes
¤¤ 
==
¤¤ 
$num
¤¤ !
)
¤¤! "
{
¥¥ 
return
¦¦ 
$str
¦¦ 
;
¦¦ 
}
§§ 
else
¨¨ 
{
©© 
return
ªª 
$str
ªª 
;
ªª 
}
«« 
}
¬¬ 
catch
­­ 
(
­­ 
	Exception
­­ 
ex
­­ 
)
­­  
{
®® 
FDebug
¯¯ 
.
¯¯ 
throwException
¯¯ %
(
¯¯% &
ex
¯¯& (
)
¯¯( )
;
¯¯) *
}
°° 
finally
±± 
{
²² 
}
´´ 
return
µµ 
$str
µµ 
;
µµ 
}
¶¶ 	
}
¼¼ 
}½½ ¹a
qD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Common\c_FConstants.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
internal 
static 
class 

FConstants $
{ 
public!! 
const!! 
string!! 

err_m_0001!! &
=!!' (
$str!!) [
;!![ \
public(( 
const(( 
string(( 

err_m_0002(( &
=((' (
$str(() E
;((E F
public// 
const// 
string// 

err_m_0003// &
=//' (
$str//) B
;//B C
public66 
const66 
string66 

err_m_000466 &
=66' (
$str66) M
;66M N
public== 
const== 
string== 

err_m_0005== &
===' (
$str==) G
;==G H
publicDD 
constDD 
stringDD 

err_m_0006DD &
=DD' (
$strDD) F
;DDF G
publicKK 
constKK 
stringKK 

err_m_0007KK &
=KK' (
$strKK) I
;KKI J
publicRR 
constRR 
stringRR 

err_m_0008RR &
=RR' (
$strRR) I
;RRI J
publicYY 
constYY 
stringYY 

err_m_0009YY &
=YY' (
$strYY) G
;YYG H
public`` 
const`` 
string`` 

err_m_0010`` &
=``' (
$str``) >
;``> ?
publicgg 
constgg 
stringgg 

err_m_0011gg &
=gg' (
$strgg) B
;ggB C
publicnn 
constnn 
stringnn 

err_m_0012nn &
=nn' (
$strnn) >
;nn> ?
publicuu 
constuu 
stringuu 

err_m_0013uu &
=uu' (
$struu) :
;uu: ;
public|| 
const|| 
string|| 

err_m_0014|| &
=||' (
$str||) C
;||C D
public
ƒƒ 
const
ƒƒ 
string
ƒƒ 

err_m_0015
ƒƒ &
=
ƒƒ' (
$str
ƒƒ) >
;
ƒƒ> ?
public
ŠŠ 
const
ŠŠ 
string
ŠŠ 

err_m_0016
ŠŠ &
=
ŠŠ' (
$str
ŠŠ) B
;
ŠŠB C
public
‘‘ 
const
‘‘ 
string
‘‘ 

err_m_0017
‘‘ &
=
‘‘' (
$str
‘‘) N
;
‘‘N O
public
˜˜ 
const
˜˜ 
string
˜˜ 

err_m_0018
˜˜ &
=
˜˜' (
$str
˜˜) O
;
˜˜O P
public
ŸŸ 
const
ŸŸ 
string
ŸŸ 

err_m_0019
ŸŸ &
=
ŸŸ' (
$str
ŸŸ) B
;
ŸŸB C
public
¦¦ 
const
¦¦ 
string
¦¦ 

err_m_0020
¦¦ &
=
¦¦' (
$str
¦¦) I
;
¦¦I J
public
­­ 
const
­­ 
string
­­ 

err_m_0021
­­ &
=
­­' (
$str
­­) F
;
­­F G
public
´´ 
const
´´ 
string
´´ 

err_m_0022
´´ &
=
´´' (
$str
´´) H
;
´´H I
public
»» 
const
»» 
string
»» 

err_m_0023
»» &
=
»»' (
$str
»») A
;
»»A B
public
ÂÂ 
const
ÂÂ 
string
ÂÂ 

err_m_0024
ÂÂ &
=
ÂÂ' (
$str
ÂÂ) >
;
ÂÂ> ?
public
ÉÉ 
const
ÉÉ 
string
ÉÉ 

err_m_0025
ÉÉ &
=
ÉÉ' (
$str
ÉÉ) C
;
ÉÉC D
public
ĞĞ 
const
ĞĞ 
string
ĞĞ 

err_m_0026
ĞĞ &
=
ĞĞ' (
$str
ĞĞ) I
;
ĞĞI J
public
×× 
const
×× 
string
×× 

err_m_0027
×× &
=
××' (
$str
××) E
;
××E F
public
ŞŞ 
const
ŞŞ 
string
ŞŞ 

err_m_0028
ŞŞ &
=
ŞŞ' (
$str
ŞŞ) B
;
ŞŞB C
public
åå 
const
åå 
string
åå 

err_m_0029
åå &
=
åå' (
$str
åå) ?
;
åå? @
public
ìì 
const
ìì 
string
ìì 

err_m_0030
ìì &
=
ìì' (
$str
ìì) M
;
ììM N
public
óó 
const
óó 
string
óó 

err_m_0031
óó &
=
óó' (
$stróó) ­
;óó­ ®
public
úú 
const
úú 
string
úú 

err_m_0032
úú &
=
úú' (
$str
úú) M
;
úúM N
public
 
const
 
string
 

err_m_0033
 &
=
' (
$str
) <
;
< =
public
ˆˆ 
const
ˆˆ 
string
ˆˆ 

err_m_0034
ˆˆ &
=
ˆˆ' (
$str
ˆˆ) ?
;
ˆˆ? @
public
 
const
 
string
 

err_m_0035
 &
=
' (
$str
) B
;
B C
public
–– 
const
–– 
string
–– 

err_m_0036
–– &
=
––' (
$str
––) {
;
––{ |
public
 
const
 
string
 

err_m_0037
 &
=
' (
$str
) S
;
S T
public
¤¤ 
const
¤¤ 
string
¤¤ 

err_m_0060
¤¤ &
=
¤¤' (
$str
¤¤) M
;
¤¤M N
public
«« 
const
«« 
string
«« 

err_m_0061
«« &
=
««' (
$str
««) >
;
««> ?
public
²² 
const
²² 
string
²² 

err_m_0062
²² &
=
²²' (
$str
²²) C
;
²²C D
public
»» 
const
»» 
string
»» 
err_m_12001
»» '
=
»»( )
$str»»* ¯
;»»¯ °
public
ÂÂ 
const
ÂÂ 
string
ÂÂ 
err_m_12002
ÂÂ '
=
ÂÂ( )
$str
ÂÂ* |
;
ÂÂ| }
public
ÉÉ 
const
ÉÉ 
string
ÉÉ 
err_m_12003
ÉÉ '
=
ÉÉ( )
$strÉÉ* Ô
;ÉÉÔ Õ
public
ĞĞ 
const
ĞĞ 
string
ĞĞ 
err_m_12004
ĞĞ '
=
ĞĞ( )
$str
ĞĞ* q
;
ĞĞq r
public
×× 
const
×× 
string
×× 
err_m_12128
×× '
=
××( )
$str
××* j
;
××j k
public
ŞŞ 
const
ŞŞ 
string
ŞŞ 
err_m_14001
ŞŞ '
=
ŞŞ( )
$strŞŞ* ¾
;ŞŞ¾ ¿
public
åå 
const
åå 
string
åå 
err_m_14002
åå '
=
åå( )
$stråå* ¢
;åå¢ £
public
ìì 
const
ìì 
string
ìì 
err_m_14003
ìì '
=
ìì( )
$str
ìì* s
;
ììs t
public
óó 
const
óó 
string
óó 
err_m_14128
óó '
=
óó( )
$str
óó* l
;
óól m
public
úú 
const
úú 
string
úú 
err_m_16001
úú '
=
úú( )
$str
úú* X
;
úúX Y
public
 
const
 
string
 
err_m_16002
 '
=
( )
$str
* Z
;
Z [
public
ˆˆ 
const
ˆˆ 
string
ˆˆ 
err_m_16003
ˆˆ '
=
ˆˆ( )
$str
ˆˆ* W
;
ˆˆW X
public
 
const
 
string
 
err_m_16004
 '
=
( )
$str
* Z
;
Z [
public
–– 
const
–– 
string
–– 
err_m_16005
–– '
=
––( )
$str
––* _
;
––_ `
public
 
const
 
string
 
err_m_16006
 '
=
( )
$str
* O
;
O P
public
¤¤ 
const
¤¤ 
string
¤¤ 
err_m_16007
¤¤ '
=
¤¤( )
$str
¤¤* H
;
¤¤H I
public
«« 
const
«« 
string
«« 
err_m_16008
«« '
=
««( )
$str
««* g
;
««g h
public
²² 
const
²² 
string
²² 
err_m_16009
²² '
=
²²( )
$str
²²* O
;
²²O P
public
¹¹ 
const
¹¹ 
string
¹¹ 
err_m_16010
¹¹ '
=
¹¹( )
$str
¹¹* s
;
¹¹s t
public
ÀÀ 
const
ÀÀ 
string
ÀÀ 
err_m_16011
ÀÀ '
=
ÀÀ( )
$str
ÀÀ* Y
;
ÀÀY Z
public
ÇÇ 
const
ÇÇ 
string
ÇÇ 
err_m_16012
ÇÇ '
=
ÇÇ( )
$str
ÇÇ* N
;
ÇÇN O
public
ÎÎ 
const
ÎÎ 
string
ÎÎ 
err_m_16900
ÎÎ '
=
ÎÎ( )
$str
ÎÎ* Q
;
ÎÎQ R
public
ÕÕ 
const
ÕÕ 
string
ÕÕ 
err_m_17001
ÕÕ '
=
ÕÕ( )
$strÕÕ* Ì
;ÕÕÌ Í
public
ÜÜ 
const
ÜÜ 
string
ÜÜ 
err_m_17002
ÜÜ '
=
ÜÜ( )
$str
ÜÜ* Y
;
ÜÜY Z
public
ãã 
const
ãã 
string
ãã 
err_m_17003
ãã '
=
ãã( )
$strãã* ±
;ãã± ²
public
êê 
const
êê 
string
êê 
err_m_17004
êê '
=
êê( )
$str
êê* |
;
êê| }
public
ññ 
const
ññ 
string
ññ 
err_m_17005
ññ '
=
ññ( )
$str
ññ* i
;
ññi j
public
øø 
const
øø 
string
øø 
err_m_17128
øø '
=
øø( )
$str
øø* b
;
øøb c
public
ÿÿ 
const
ÿÿ 
string
ÿÿ 
err_m_20001
ÿÿ '
=
ÿÿ( )
$str
ÿÿ* P
;
ÿÿP Q
public
†† 
const
†† 
string
†† 
err_m_20002
†† '
=
††( )
$str
††* I
;
††I J
public
 
const
 
string
 
err_m_20003
 '
=
( )
$str
* F
;
F G
public
”” 
const
”” 
string
”” 
err_m_20004
”” '
=
””( )
$str
””* h
;
””h i
public
›› 
const
›› 
string
›› 
err_m_20005
›› '
=
››( )
$str
››* S
;
››S T
public
¢¢ 
const
¢¢ 
string
¢¢ 
err_m_20006
¢¢ '
=
¢¢( )
$str
¢¢* T
;
¢¢T U
public
©© 
const
©© 
string
©© 
err_m_20007
©© '
=
©©( )
$str
©©* M
;
©©M N
public
°° 
const
°° 
string
°° 
err_m_20008
°° '
=
°°( )
$str
°°* O
;
°°O P
public
·· 
const
·· 
string
·· 
err_m_21001
·· '
=
··( )
$str
··* p
;
··p q
public
¾¾ 
const
¾¾ 
string
¾¾ 
err_m_21002
¾¾ '
=
¾¾( )
$str
¾¾* _
;
¾¾_ `
public
ÅÅ 
const
ÅÅ 
string
ÅÅ 
err_m_21003
ÅÅ '
=
ÅÅ( )
$strÅÅ* ™
;ÅÅ™ š
public
ÌÌ 
const
ÌÌ 
string
ÌÌ 
err_m_21004
ÌÌ '
=
ÌÌ( )
$str
ÌÌ* r
;
ÌÌr s
public
ÓÓ 
const
ÓÓ 
string
ÓÓ 
err_m_21005
ÓÓ '
=
ÓÓ( )
$strÓÓ* º
;ÓÓº »
public
ÚÚ 
const
ÚÚ 
string
ÚÚ 
err_m_21006
ÚÚ '
=
ÚÚ( )
$strÚÚ* ¹
;ÚÚ¹ º
public
áá 
const
áá 
string
áá 
err_m_21007
áá '
=
áá( )
$stráá* ¶
;áá¶ ·
public
èè 
const
èè 
string
èè 
err_m_21008
èè '
=
èè( )
$strèè* ­
;èè­ ®
}
îî 
}ïï ”
uD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Common\c_FSecsConverter.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
internal 
static 
class 
FSecsConverter (
{ 
public 
static 
string 
convertBinToSml ,
(, -
byte 
[ 
] 
binData 
) 
{ 	
StringBuilder 
smlData !
=" #
null$ (
;( )
UInt32 
pos 
= 
$num 
; 
try!! 
{"" 
smlData## 
=## 
new## 
StringBuilder## +
(##+ ,
)##, -
;##- .
smlData$$ 
.$$ 

AppendLine$$ "
($$" #
$str$$# '
)$$' (
;$$( )
convertBinToSml%% 
(%%  
binData%%  '
,%%' (
ref%%) ,
pos%%- 0
,%%0 1
smlData%%2 9
,%%9 :
$num%%; <
)%%< =
;%%= >
smlData&& 
.&& 
Append&& 
(&& 
$str&& "
)&&" #
;&&# $
return'' 
smlData'' 
.'' 
ToString'' '
(''' (
)''( )
;'') *
}(( 
catch)) 
()) 
	Exception)) 
ex)) 
)))  
{** 
FDebug++ 
.++ 
throwException++ %
(++% &
ex++& (
)++( )
;++) *
},, 
finally-- 
{.. 
}00 
return11 
string11 
.11 
Empty11 
;11  
}22 	
public66 
static66 
void66 
convertBinToSml66 *
(66* +
byte77 
[77 
]77 
binData77 
,77 
ref88 
UInt3288 
pos88 
,88 
StringBuilder99 
smlData99 !
,99! "
int:: 
depth:: 
);; 
{<< 	
FFormat== 
fFormat== 
;== 
int>> 
lenBytes>> 
=>> 
$num>> 
;>> 
UInt32?? 
len?? 
=?? 
$num?? 
;?? 
byte@@ 
tmpByte@@ 
=@@ 
$num@@ 
;@@ 
byteAA 
[AA 
]AA 
byteArrAA 
=AA 
nullAA !
;AA! "
stringBB 
depthStrBB 
=BB 
stringBB $
.BB$ %
EmptyBB% *
;BB* +
UInt32CC 
formatBytesCC 
=CC  
$numCC! "
;CC" #
UInt32DD 
itemLenDD 
=DD 
$numDD 
;DD 
stringEE 
valEE 
=EE 
stringEE 
.EE  
EmptyEE  %
;EE% &
tryGG 
{HH 
ifII 
(II 
depthII 
>II 
$numII 
)II 
{JJ 
depthStrKK 
=KK 
depthStrKK '
.KK' (
PadRightKK( 0
(KK0 1
depthKK1 6
*KK7 8
$numKK9 :
,KK: ;
$charKK< ?
)KK? @
;KK@ A
smlDataLL 
.LL 

AppendLineLL &
(LL& '
)LL' (
;LL( )
}MM 
depthNN 
++NN 
;NN 
tmpByteUU 
=UU 
binDataUU !
[UU! "
posUU" %
++UU% '
]UU' (
;UU( )
fFormatVV 
=VV 
	getFormatVV #
(VV# $
tmpByteVV$ +
>>VV, .
$numVV/ 0
)VV0 1
;VV1 2
lenBytesWW 
=WW 
tmpByteWW "
&WW# $
$numWW% )
;WW) *
byteArr^^ 
=^^ 
new^^ 
byte^^ "
[^^" #
$num^^# $
]^^$ %
;^^% &
if__ 
(__ 
lenBytes__ 
==__ 
$num__  !
)__! "
{`` 
byteArraa 
[aa 
$numaa 
]aa 
=aa  
binDataaa! (
[aa( )
posaa) ,
++aa, .
]aa. /
;aa/ 0
}bb 
elsecc 
ifcc 
(cc 
lenBytescc !
==cc" $
$numcc% &
)cc& '
{dd 
byteArree 
[ee 
$numee 
]ee 
=ee  
binDataee! (
[ee( )
posee) ,
++ee, .
]ee. /
;ee/ 0
byteArrff 
[ff 
$numff 
]ff 
=ff  
binDataff! (
[ff( )
posff) ,
++ff, .
]ff. /
;ff/ 0
}gg 
elsehh 
{ii 
byteArrjj 
[jj 
$numjj 
]jj 
=jj  
binDatajj! (
[jj( )
posjj) ,
++jj, .
]jj. /
;jj/ 0
byteArrkk 
[kk 
$numkk 
]kk 
=kk  
binDatakk! (
[kk( )
poskk) ,
++kk, .
]kk. /
;kk/ 0
byteArrll 
[ll 
$numll 
]ll 
=ll  
binDatall! (
[ll( )
posll) ,
++ll, .
]ll. /
;ll/ 0
}mm 
lennn 
=nn 
FByteConverternn $
.nn$ %
toUInt32nn% -
(nn- .
byteArrnn. 5
,nn5 6
falsenn7 <
)nn< =
;nn= >
smlDatarr 
.rr 
Appendrr 
(rr 
depthStrrr '
+rr( )
$strrr* -
+rr. /
fFormatrr0 7
.rr7 8
ToStringrr8 @
(rr@ A
)rrA B
)rrB C
;rrC D
ifss 
(ss 
fFormatss 
==ss 
FFormatss &
.ss& '
Lss' (
)ss( )
{tt 
ifuu 
(uu 
lenuu 
>uu 
$numuu 
)uu  
{vv 
smlDataww 
.ww  
Appendww  &
(ww& '
$strww' *
+ww+ ,
lenww- 0
+ww1 2
$strww3 6
)ww6 7
;ww7 8
}xx 
forzz 
(zz 
intzz 
izz 
=zz  
$numzz! "
;zz" #
izz$ %
<zz& '
lenzz( +
;zz+ ,
izz- .
++zz. 0
)zz0 1
{{{ 
convertBinToSml|| '
(||' (
binData||( /
,||/ 0
ref||1 4
pos||5 8
,||8 9
smlData||: A
,||A B
depth||C H
)||H I
;||I J
}}} 
if 
( 
len 
> 
$num 
)  
{
€€ 
smlData
 
.
  

AppendLine
  *
(
* +
)
+ ,
;
, -
smlData
‚‚ 
.
‚‚  
Append
‚‚  &
(
‚‚& '
depthStr
‚‚' /
+
‚‚0 1
$str
‚‚2 5
)
‚‚5 6
;
‚‚6 7
}
ƒƒ 
else
„„ 
{
…… 
smlData
†† 
.
††  
Append
††  &
(
††& '
$str
††' *
)
††* +
;
††+ ,
}
‡‡ 
}
ˆˆ 
else
‰‰ 
{
ŠŠ 
formatBytes
‹‹ 
=
‹‹  !
getFormatBytes
‹‹" 0
(
‹‹0 1
fFormat
‹‹1 8
)
‹‹8 9
;
‹‹9 :
itemLen
ŒŒ 
=
ŒŒ 
len
ŒŒ !
/
ŒŒ" #
formatBytes
ŒŒ$ /
;
ŒŒ/ 0
if
 
(
 
itemLen
 
>
  !
$num
" #
)
# $
{
 
smlData
 
.
  
Append
  &
(
& '
$str
' *
+
+ ,
itemLen
- 4
.
4 5
ToString
5 =
(
= >
)
> ?
+
@ A
$str
B F
)
F G
;
G H
}
 
if
’’ 
(
’’ 
itemLen
’’ 
>
’’  !
$num
’’" #
)
’’# $
{
““ 
smlData
”” 
.
””  
Append
””  &
(
””& '
$str
””' *
)
””* +
;
””+ ,
}
•• 
val
–– 
=
–– 
getBinToValue
–– '
(
––' (
fFormat
––( /
,
––/ 0
binData
––1 8
,
––8 9
pos
––: =
,
––= >
itemLen
––? F
,
––F G
formatBytes
––H S
)
––S T
;
––T U
pos
—— 
+=
—— 
len
—— 
;
—— 
if
›› 
(
›› 
fFormat
›› 
==
››  "
FFormat
››# *
.
››* +
A
››+ ,
||
››- /
fFormat
››0 7
==
››8 :
FFormat
››; B
.
››B C
A2
››C E
||
››F H
fFormat
››I P
==
››Q S
FFormat
››T [
.
››[ \
J8
››\ ^
)
››^ _
{
œœ 
if
 
(
 
len
 
>
  !
$num
" #
)
# $
{
 
smlData
ŸŸ #
.
ŸŸ# $
Append
ŸŸ$ *
(
ŸŸ* +
$str
ŸŸ+ .
+
ŸŸ/ 0
val
ŸŸ1 4
+
ŸŸ5 6
$str
ŸŸ7 :
)
ŸŸ: ;
;
ŸŸ; <
}
   
}
¡¡ 
else
¢¢ 
{
££ 
smlData
¤¤ 
.
¤¤  
Append
¤¤  &
(
¤¤& '
val
¤¤' *
)
¤¤* +
;
¤¤+ ,
}
¥¥ 
smlData
¦¦ 
.
¦¦ 
Append
¦¦ "
(
¦¦" #
$str
¦¦# &
)
¦¦& '
;
¦¦' (
}
§§ 
}
¨¨ 
catch
©© 
(
©© 
	Exception
©© 
ex
©© 
)
©©  
{
ªª 
FDebug
«« 
.
«« 
throwException
«« %
(
««% &
ex
««& (
)
««( )
;
««) *
}
¬¬ 
finally
­­ 
{
®® 
}
°° 
}
±± 	
public
µµ 
static
µµ 
FXmlNode
µµ !
convertBinToXmlNode
µµ 2
(
µµ2 3
UInt16
¶¶ 
	sessionId
¶¶ 
,
¶¶ 
byte
·· 
stream
·· 
,
·· 
byte
¸¸ 
function
¸¸ 
,
¸¸ 
bool
¹¹ 
wbit
¹¹ 
,
¹¹ 
UInt32
ºº 
systemBytes
ºº 
,
ºº 
byte
»» 
[
»» 
]
»» 
binData
»» 
)
¼¼ 
{
½½ 	
FXmlDocument
¾¾ 
fXmlDoc
¾¾  
=
¾¾! "
null
¾¾# '
;
¾¾' (
FXmlNode
¿¿ 
fXmlNodeSmg
¿¿  
=
¿¿! "
null
¿¿# '
;
¿¿' (
UInt32
ÀÀ 
pos
ÀÀ 
=
ÀÀ 
$num
ÀÀ 
;
ÀÀ 
try
ÂÂ 
{
ÃÃ 
fXmlDoc
ÄÄ 
=
ÄÄ 
new
ÄÄ 
FXmlDocument
ÄÄ *
(
ÄÄ* +
)
ÄÄ+ ,
;
ÄÄ, -
fXmlDoc
ÅÅ 
.
ÅÅ  
preserveWhiteSpace
ÅÅ *
=
ÅÅ+ ,
false
ÅÅ- 2
;
ÅÅ2 3
fXmlNodeSmg
ÌÌ 
=
ÌÌ 
fXmlDoc
ÌÌ %
.
ÌÌ% &

createNode
ÌÌ& 0
(
ÌÌ0 1
FSecsTag
ÌÌ1 9
.
ÌÌ9 :
E_SecsMessage
ÌÌ: G
)
ÌÌG H
;
ÌÌH I
fXmlNodeSmg
ÍÍ 
.
ÍÍ 
set_attrVal
ÍÍ '
(
ÍÍ' (
FSecsTag
ÍÍ( 0
.
ÍÍ0 1
A_SessionId
ÍÍ1 <
,
ÍÍ< =
	sessionId
ÍÍ> G
.
ÍÍG H
ToString
ÍÍH P
(
ÍÍP Q
)
ÍÍQ R
)
ÍÍR S
;
ÍÍS T
fXmlNodeSmg
ÎÎ 
.
ÎÎ 
set_attrVal
ÎÎ '
(
ÎÎ' (
FSecsTag
ÎÎ( 0
.
ÎÎ0 1
A_Stream
ÎÎ1 9
,
ÎÎ9 :
stream
ÎÎ; A
.
ÎÎA B
ToString
ÎÎB J
(
ÎÎJ K
)
ÎÎK L
)
ÎÎL M
;
ÎÎM N
fXmlNodeSmg
ÏÏ 
.
ÏÏ 
set_attrVal
ÏÏ '
(
ÏÏ' (
FSecsTag
ÏÏ( 0
.
ÏÏ0 1

A_Function
ÏÏ1 ;
,
ÏÏ; <
function
ÏÏ= E
.
ÏÏE F
ToString
ÏÏF N
(
ÏÏN O
)
ÏÏO P
)
ÏÏP Q
;
ÏÏQ R
fXmlNodeSmg
ĞĞ 
.
ĞĞ 
set_attrVal
ĞĞ '
(
ĞĞ' (
FSecsTag
ĞĞ( 0
.
ĞĞ0 1
A_WBit
ĞĞ1 7
,
ĞĞ7 8
wbit
ĞĞ9 =
.
ĞĞ= >
ToString
ĞĞ> F
(
ĞĞF G
)
ĞĞG H
)
ĞĞH I
;
ĞĞI J
fXmlNodeSmg
ÑÑ 
.
ÑÑ 
set_attrVal
ÑÑ '
(
ÑÑ' (
FSecsTag
ÑÑ( 0
.
ÑÑ0 1
A_SystemBytes
ÑÑ1 >
,
ÑÑ> ?
systemBytes
ÑÑ@ K
.
ÑÑK L
ToString
ÑÑL T
(
ÑÑT U
)
ÑÑU V
)
ÑÑV W
;
ÑÑW X
if
ØØ 
(
ØØ 
binData
ØØ 
.
ØØ 
Length
ØØ "
>
ØØ# $
$num
ØØ% &
)
ØØ& '
{
ÙÙ !
convertBinToXmlNode
ÚÚ '
(
ÚÚ' (
fXmlDoc
ÚÚ( /
,
ÚÚ/ 0
fXmlNodeSmg
ÚÚ1 <
,
ÚÚ< =
binData
ÚÚ> E
,
ÚÚE F
ref
ÚÚG J
pos
ÚÚK N
)
ÚÚN O
;
ÚÚO P
}
ÛÛ 
return
ßß 
fXmlNodeSmg
ßß "
;
ßß" #
}
àà 
catch
áá 
(
áá 
	Exception
áá 
ex
áá 
)
áá  
{
ââ 
FDebug
ãã 
.
ãã 
throwException
ãã %
(
ãã% &
ex
ãã& (
)
ãã( )
;
ãã) *
}
ää 
finally
åå 
{
ææ 
fXmlDoc
çç 
=
çç 
null
çç 
;
çç 
}
èè 
return
éé 
null
éé 
;
éé 
}
êê 	
public
îî 
static
îî 
void
îî !
convertBinToXmlNode
îî .
(
îî. /
FXmlDocument
ïï 
fXmlDoc
ïï  
,
ïï  !
FXmlNode
ğğ 
fXmlNodeParent
ğğ #
,
ğğ# $
Byte
ññ 
[
ññ 
]
ññ 
binData
ññ 
,
ññ 
ref
òò 
UInt32
òò 
pos
òò 
)
óó 
{
ôô 	
FFormat
õõ 
fFormat
õõ 
;
õõ 
int
öö 
lenBytes
öö 
=
öö 
$num
öö 
;
öö 
UInt32
÷÷ 
len
÷÷ 
=
÷÷ 
$num
÷÷ 
;
÷÷ 
byte
øø 
tmpByte
øø 
=
øø 
$num
øø 
;
øø 
byte
ùù 
[
ùù 
]
ùù 
byteArr
ùù 
=
ùù 
null
ùù !
;
ùù! "
string
úú 
depthStr
úú 
=
úú 
string
úú $
.
úú$ %
Empty
úú% *
;
úú* +
UInt32
ûû 
formatBytes
ûû 
=
ûû  
$num
ûû! "
;
ûû" #
UInt32
üü 
itemLen
üü 
=
üü 
$num
üü 
;
üü 
string
ıı 
val
ıı 
=
ıı 
string
ıı 
.
ıı  
Empty
ıı  %
;
ıı% &
FXmlNode
şş 
fXmlNodeSit
şş  
=
şş! "
null
şş# '
;
şş' (
try
€€ 
{
 
fXmlNodeSit
‚‚ 
=
‚‚ 
fXmlDoc
‚‚ %
.
‚‚% &

createNode
‚‚& 0
(
‚‚0 1
FSecsTag
‚‚1 9
.
‚‚9 :

E_SecsItem
‚‚: D
)
‚‚D E
;
‚‚E F
tmpByte
‰‰ 
=
‰‰ 
binData
‰‰ !
[
‰‰! "
pos
‰‰" %
++
‰‰% '
]
‰‰' (
;
‰‰( )
fFormat
ŠŠ 
=
ŠŠ 
FSecsConverter
ŠŠ (
.
ŠŠ( )
	getFormat
ŠŠ) 2
(
ŠŠ2 3
tmpByte
ŠŠ3 :
>>
ŠŠ; =
$num
ŠŠ> ?
)
ŠŠ? @
;
ŠŠ@ A
lenBytes
‹‹ 
=
‹‹ 
tmpByte
‹‹ "
&
‹‹# $
$num
‹‹% )
;
‹‹) *
fXmlNodeSit
ŒŒ 
.
ŒŒ 
set_attrVal
ŒŒ '
(
ŒŒ' (
FSecsTag
ŒŒ( 0
.
ŒŒ0 1
A_Format
ŒŒ1 9
,
ŒŒ9 :
fFormat
ŒŒ; B
.
ŒŒB C
ToString
ŒŒC K
(
ŒŒK L
)
ŒŒL M
)
ŒŒM N
;
ŒŒN O
byteArr
““ 
=
““ 
new
““ 
byte
““ "
[
““" #
$num
““# $
]
““$ %
;
““% &
if
”” 
(
”” 
lenBytes
”” 
==
”” 
$num
””  !
)
””! "
{
•• 
byteArr
–– 
[
–– 
$num
–– 
]
–– 
=
––  
binData
––! (
[
––( )
pos
––) ,
++
––, .
]
––. /
;
––/ 0
}
—— 
else
˜˜ 
if
˜˜ 
(
˜˜ 
lenBytes
˜˜ !
==
˜˜" $
$num
˜˜% &
)
˜˜& '
{
™™ 
byteArr
šš 
[
šš 
$num
šš 
]
šš 
=
šš  
binData
šš! (
[
šš( )
pos
šš) ,
++
šš, .
]
šš. /
;
šš/ 0
byteArr
›› 
[
›› 
$num
›› 
]
›› 
=
››  
binData
››! (
[
››( )
pos
››) ,
++
››, .
]
››. /
;
››/ 0
}
œœ 
else
 
{
 
byteArr
ŸŸ 
[
ŸŸ 
$num
ŸŸ 
]
ŸŸ 
=
ŸŸ  
binData
ŸŸ! (
[
ŸŸ( )
pos
ŸŸ) ,
++
ŸŸ, .
]
ŸŸ. /
;
ŸŸ/ 0
byteArr
   
[
   
$num
   
]
   
=
    
binData
  ! (
[
  ( )
pos
  ) ,
++
  , .
]
  . /
;
  / 0
byteArr
¡¡ 
[
¡¡ 
$num
¡¡ 
]
¡¡ 
=
¡¡  
binData
¡¡! (
[
¡¡( )
pos
¡¡) ,
++
¡¡, .
]
¡¡. /
;
¡¡/ 0
}
¢¢ 
len
££ 
=
££ 
FByteConverter
££ $
.
££$ %
toUInt32
££% -
(
££- .
byteArr
££. 5
,
££5 6
false
££7 <
)
££< =
;
££= >
formatBytes
¤¤ 
=
¤¤ 
getFormatBytes
¤¤ ,
(
¤¤, -
fFormat
¤¤- 4
)
¤¤4 5
;
¤¤5 6
itemLen
¥¥ 
=
¥¥ 
len
¥¥ 
/
¥¥ 
formatBytes
¥¥  +
;
¥¥+ ,
fXmlNodeSit
¦¦ 
.
¦¦ 
set_attrVal
¦¦ '
(
¦¦' (
FSecsTag
¦¦( 0
.
¦¦0 1
A_Length
¦¦1 9
,
¦¦9 :
itemLen
¦¦; B
.
¦¦B C
ToString
¦¦C K
(
¦¦K L
)
¦¦L M
)
¦¦M N
;
¦¦N O
if
ªª 
(
ªª 
fFormat
ªª 
==
ªª 
FFormat
ªª &
.
ªª& '
L
ªª' (
)
ªª( )
{
«« 
for
¬¬ 
(
¬¬ 
int
¬¬ 
i
¬¬ 
=
¬¬  
$num
¬¬! "
;
¬¬" #
i
¬¬$ %
<
¬¬& '
itemLen
¬¬( /
;
¬¬/ 0
i
¬¬1 2
++
¬¬2 4
)
¬¬4 5
{
­­ !
convertBinToXmlNode
®® +
(
®®+ ,
fXmlDoc
®®, 3
,
®®3 4
fXmlNodeSit
®®5 @
,
®®@ A
binData
®®B I
,
®®I J
ref
®®K N
pos
®®O R
)
®®R S
;
®®S T
}
¯¯ 
}
°° 
else
±± 
{
²² 
val
³³ 
=
³³ 
getBinToValue
³³ '
(
³³' (
fFormat
³³( /
,
³³/ 0
binData
³³1 8
,
³³8 9
pos
³³: =
,
³³= >
itemLen
³³? F
,
³³F G
formatBytes
³³H S
)
³³S T
;
³³T U
pos
´´ 
+=
´´ 
len
´´ 
;
´´ 
fXmlNodeSit
µµ 
.
µµ  
set_attrVal
µµ  +
(
µµ+ ,
FSecsTag
µµ, 4
.
µµ4 5
A_Value
µµ5 <
,
µµ< =
val
µµ> A
)
µµA B
;
µµB C
}
¶¶ 
fXmlNodeParent
ºº 
.
ºº 
appendChild
ºº *
(
ºº* +
fXmlNodeSit
ºº+ 6
)
ºº6 7
;
ºº7 8
}
»» 
catch
¼¼ 
(
¼¼ 
	Exception
¼¼ 
ex
¼¼ 
)
¼¼  
{
½½ 
FDebug
¾¾ 
.
¾¾ 
throwException
¾¾ %
(
¾¾% &
ex
¾¾& (
)
¾¾( )
;
¾¾) *
}
¿¿ 
finally
ÀÀ 
{
ÁÁ 
fXmlNodeSit
ÂÂ 
=
ÂÂ 
null
ÂÂ "
;
ÂÂ" #
}
ÃÃ 
}
ÄÄ 	
public
ÈÈ 
static
ÈÈ 
FSecsDataMessage
ÈÈ &)
convertXmlToSecsDataMessage
ÈÈ' B
(
ÈÈB C
FSecs1ToHsms
ÉÉ 
fSecs1ToHsms
ÉÉ %
,
ÉÉ% &
FXmlNode
ÊÊ 
fXmlNodeSmg
ÊÊ  
)
ËË 
{
ÌÌ 	
UInt16
ÍÍ 
	sessionId
ÍÍ 
=
ÍÍ 
$num
ÍÍ  
;
ÍÍ  !
byte
ÎÎ 
stream
ÎÎ 
=
ÎÎ 
$num
ÎÎ 
;
ÎÎ 
byte
ÏÏ 
function
ÏÏ 
=
ÏÏ 
$num
ÏÏ 
;
ÏÏ 
bool
ĞĞ 
wbit
ĞĞ 
=
ĞĞ 
false
ĞĞ 
;
ĞĞ 
UInt32
ÑÑ 
systemBytes
ÑÑ 
=
ÑÑ  
$num
ÑÑ! "
;
ÑÑ" #
string
ÒÒ 
val
ÒÒ 
=
ÒÒ 
string
ÒÒ 
.
ÒÒ  
Empty
ÒÒ  %
;
ÒÒ% &
List
ÓÓ 
<
ÓÓ 
byte
ÓÓ 
>
ÓÓ 
binData
ÓÓ 
=
ÓÓ  
null
ÓÓ! %
;
ÓÓ% &
try
ÕÕ 
{
ÖÖ 
	sessionId
×× 
=
×× 
UInt16
×× "
.
××" #
Parse
××# (
(
××( )
fXmlNodeSmg
××) 4
.
××4 5
get_attrVal
××5 @
(
××@ A
FSecsTag
××A I
.
××I J
A_SessionId
××J U
,
××U V
$str
××W Z
)
××Z [
)
××[ \
;
××\ ]
stream
ØØ 
=
ØØ 
byte
ØØ 
.
ØØ 
Parse
ØØ #
(
ØØ# $
fXmlNodeSmg
ØØ$ /
.
ØØ/ 0
get_attrVal
ØØ0 ;
(
ØØ; <
FSecsTag
ØØ< D
.
ØØD E
A_Stream
ØØE M
,
ØØM N
$str
ØØO R
)
ØØR S
)
ØØS T
;
ØØT U
function
ÙÙ 
=
ÙÙ 
byte
ÙÙ 
.
ÙÙ  
Parse
ÙÙ  %
(
ÙÙ% &
fXmlNodeSmg
ÙÙ& 1
.
ÙÙ1 2
get_attrVal
ÙÙ2 =
(
ÙÙ= >
FSecsTag
ÙÙ> F
.
ÙÙF G

A_Function
ÙÙG Q
,
ÙÙQ R
$str
ÙÙS V
)
ÙÙV W
)
ÙÙW X
;
ÙÙX Y
wbit
ÚÚ 
=
ÚÚ 
bool
ÚÚ 
.
ÚÚ 
Parse
ÚÚ !
(
ÚÚ! "
fXmlNodeSmg
ÚÚ" -
.
ÚÚ- .
get_attrVal
ÚÚ. 9
(
ÚÚ9 :
FSecsTag
ÚÚ: B
.
ÚÚB C
A_WBit
ÚÚC I
,
ÚÚI J
$str
ÚÚK R
)
ÚÚR S
)
ÚÚS T
;
ÚÚT U
val
ÜÜ 
=
ÜÜ 
fXmlNodeSmg
ÜÜ !
.
ÜÜ! "
get_attrVal
ÜÜ" -
(
ÜÜ- .
FSecsTag
ÜÜ. 6
.
ÜÜ6 7
A_SystemBytes
ÜÜ7 D
,
ÜÜD E
string
ÜÜF L
.
ÜÜL M
Empty
ÜÜM R
)
ÜÜR S
;
ÜÜS T
if
İİ 
(
İİ 
val
İİ 
!=
İİ 
string
İİ !
.
İİ! "
Empty
İİ" '
)
İİ' (
{
ŞŞ 
systemBytes
ßß 
=
ßß  !
UInt32
ßß" (
.
ßß( )
Parse
ßß) .
(
ßß. /
val
ßß/ 2
)
ßß2 3
;
ßß3 4
}
àà 
binData
ää 
=
ää 
new
ää 
List
ää "
<
ää" #
byte
ää# '
>
ää' (
(
ää( )
)
ää) *
;
ää* +
if
åå 
(
åå 
fXmlNodeSmg
åå 
.
åå  
hasChildNode
åå  ,
)
åå, -
{
ææ "
convertXmlToSecsItem
çç (
(
çç( )
fXmlNodeSmg
çç) 4
.
çç4 5
selectSingleNode
çç5 E
(
ççE F
FSecsTag
ççF N
.
ççN O

E_SecsItem
ççO Y
)
ççY Z
,
ççZ [
binData
çç\ c
)
ççc d
;
ççd e
}
èè 
return
ìì 
new
ìì 
FSecsDataMessage
ìì +
(
ìì+ ,
fSecs1ToHsms
ìì, 8
,
ìì8 9
	sessionId
ìì: C
,
ììC D
wbit
ììE I
,
ììI J
stream
ììK Q
,
ììQ R
function
ììS [
,
ìì[ \
systemBytes
ìì] h
,
ììh i
binData
ììj q
.
ììq r
ToArray
ììr y
(
ììy z
)
ììz {
)
ìì{ |
;
ìì| }
}
íí 
catch
îî 
(
îî 
	Exception
îî 
ex
îî 
)
îî  
{
ïï 
FDebug
ğğ 
.
ğğ 
throwException
ğğ %
(
ğğ% &
ex
ğğ& (
)
ğğ( )
;
ğğ) *
}
ññ 
finally
òò 
{
óó 
}
õõ 
return
öö 
null
öö 
;
öö 
}
÷÷ 	
public
ûû 
static
ûû 
void
ûû "
convertXmlToSecsItem
ûû /
(
ûû/ 0
FXmlNode
üü 
fXmlNodeSit
üü  
,
üü  !
List
ıı 
<
ıı 
byte
ıı 
>
ıı 
binData
ıı 
)
şş 
{
ÿÿ 	
FFormat
€€ 
fFormat
€€ 
;
€€ 
byte
 

formatCode
 
=
 
$num
 
;
  
UInt32
‚‚ 
formatBytes
‚‚ 
=
‚‚  
$num
‚‚! "
;
‚‚" #
UInt32
ƒƒ 
len
ƒƒ 
=
ƒƒ 
$num
ƒƒ 
;
ƒƒ 
byte
„„ 
lenBytes
„„ 
=
„„ 
$num
„„ 
;
„„ 
UInt32
…… 
itemLen
…… 
=
…… 
$num
…… 
;
…… 
byte
†† 
[
†† 
]
†† 
lenArr
†† 
=
†† 
null
††  
;
††  !
byte
‡‡ 
[
‡‡ 
]
‡‡ 
byteArr
‡‡ 
=
‡‡ 
null
‡‡ !
;
‡‡! "
byte
ˆˆ 
[
ˆˆ 
]
ˆˆ 
valArr
ˆˆ 
=
ˆˆ 
null
ˆˆ  
;
ˆˆ  !
FXmlNodeList
‰‰ 
fXmlNodeChilds
‰‰ '
=
‰‰( )
null
‰‰* .
;
‰‰. /
try
‹‹ 
{
ŒŒ 
fFormat
 
=
 
(
 
FFormat
 "
)
" #
Enum
# '
.
' (
Parse
( -
(
- .
typeof
. 4
(
4 5
FFormat
5 <
)
< =
,
= >
fXmlNodeSit
? J
.
J K
get_attrVal
K V
(
V W
FSecsTag
W _
.
_ `
A_Format
` h
)
h i
)
i j
;
j k

formatCode
 
=
 
(
 
byte
 "
)
" #
(
# $
(
$ %
int
% (
)
( )
fFormat
) 0
<<
1 3
$num
4 5
)
5 6
;
6 7
formatBytes
 
=
 
getFormatBytes
 ,
(
, -
fFormat
- 4
)
4 5
;
5 6
if
““ 
(
““ 
fFormat
““ 
==
““ 
FFormat
““ &
.
““& '
L
““' (
)
““( )
{
”” 
fXmlNodeChilds
•• "
=
••# $
fXmlNodeSit
••% 0
.
••0 1
selectNodes
••1 <
(
••< =
FSecsTag
••= E
.
••E F

E_SecsItem
••F P
)
••P Q
;
••Q R
len
–– 
=
–– 
(
–– 
UInt32
–– !
)
––! "
fXmlNodeChilds
––" 0
.
––0 1
count
––1 6
;
––6 7
lenBytes
—— 
=
—— 
getLengthBytes
—— -
(
——- .
len
——. 1
)
——1 2
;
——2 3
if
™™ 
(
™™ 
lenBytes
™™  
==
™™! #
$num
™™$ %
)
™™% &
{
šš 

formatCode
›› "
|=
››# %
$num
››& *
;
››* +
lenArr
œœ 
=
œœ  
new
œœ! $
byte
œœ% )
[
œœ) *
$num
œœ* +
]
œœ+ ,
{
œœ- .
(
œœ/ 0
byte
œœ0 4
)
œœ4 5
len
œœ5 8
}
œœ9 :
;
œœ: ;
}
 
else
 
if
 
(
 
lenBytes
 %
==
& (
$num
) *
)
* +
{
ŸŸ 

formatCode
   "
|=
  # %
$num
  & *
;
  * +
lenArr
¡¡ 
=
¡¡  
FByteConverter
¡¡! /
.
¡¡/ 0
getBytes
¡¡0 8
(
¡¡8 9
(
¡¡9 :
UInt16
¡¡: @
)
¡¡@ A
len
¡¡A D
,
¡¡D E
true
¡¡F J
)
¡¡J K
;
¡¡K L
}
¢¢ 
else
££ 
{
¤¤ 

formatCode
¥¥ "
|=
¥¥# %
$num
¥¥& *
;
¥¥* +
byteArr
¦¦ 
=
¦¦  !
FByteConverter
¦¦" 0
.
¦¦0 1
getBytes
¦¦1 9
(
¦¦9 :
(
¦¦: ;
UInt32
¦¦; A
)
¦¦A B
len
¦¦B E
,
¦¦E F
true
¦¦G K
)
¦¦K L
;
¦¦L M
lenArr
§§ 
=
§§  
new
§§! $
byte
§§% )
[
§§) *
$num
§§* +
]
§§+ ,
;
§§, -
lenArr
¨¨ 
[
¨¨ 
$num
¨¨  
]
¨¨  !
=
¨¨" #
byteArr
¨¨$ +
[
¨¨+ ,
$num
¨¨, -
]
¨¨- .
;
¨¨. /
lenArr
©© 
[
©© 
$num
©©  
]
©©  !
=
©©" #
byteArr
©©$ +
[
©©+ ,
$num
©©, -
]
©©- .
;
©©. /
lenArr
ªª 
[
ªª 
$num
ªª  
]
ªª  !
=
ªª" #
byteArr
ªª$ +
[
ªª+ ,
$num
ªª, -
]
ªª- .
;
ªª. /
}
«« 
binData
­­ 
.
­­ 
Add
­­ 
(
­­  

formatCode
­­  *
)
­­* +
;
­­+ ,
binData
®® 
.
®® 
AddRange
®® $
(
®®$ %
lenArr
®®% +
)
®®+ ,
;
®®, -
foreach
°° 
(
°° 
FXmlNode
°° %
c
°°& '
in
°°( *
fXmlNodeChilds
°°+ 9
)
°°9 :
{
±± "
convertXmlToSecsItem
²² ,
(
²², -
c
²²- .
,
²². /
binData
²²0 7
)
²²7 8
;
²²8 9
}
³³ 
}
´´ 
else
µµ 
{
¶¶ 
valArr
·· 
=
·· !
getStringToBinValue
·· 0
(
··0 1
fFormat
··1 8
,
··8 9
fXmlNodeSit
··: E
.
··E F
get_attrVal
··F Q
(
··Q R
FSecsTag
··R Z
.
··Z [
A_Value
··[ b
,
··b c
string
··d j
.
··j k
Empty
··k p
)
··p q
,
··q r
ref
··s v
itemLen
··w ~
)
··~ 
;·· €
len
¸¸ 
=
¸¸ 
itemLen
¸¸ !
*
¸¸" #
formatBytes
¸¸$ /
;
¸¸/ 0
lenBytes
¹¹ 
=
¹¹ 
getLengthBytes
¹¹ -
(
¹¹- .
len
¹¹. 1
)
¹¹1 2
;
¹¹2 3
if
»» 
(
»» 
lenBytes
»»  
==
»»! #
$num
»»$ %
)
»»% &
{
¼¼ 

formatCode
½½ "
|=
½½# %
$num
½½& *
;
½½* +
lenArr
¾¾ 
=
¾¾  
new
¾¾! $
byte
¾¾% )
[
¾¾) *
$num
¾¾* +
]
¾¾+ ,
{
¾¾- .
(
¾¾/ 0
byte
¾¾0 4
)
¾¾4 5
len
¾¾5 8
}
¾¾9 :
;
¾¾: ;
}
¿¿ 
else
ÀÀ 
if
ÀÀ 
(
ÀÀ 
lenBytes
ÀÀ %
==
ÀÀ& (
$num
ÀÀ) *
)
ÀÀ* +
{
ÁÁ 

formatCode
ÂÂ "
|=
ÂÂ# %
$num
ÂÂ& *
;
ÂÂ* +
lenArr
ÃÃ 
=
ÃÃ  
FByteConverter
ÃÃ! /
.
ÃÃ/ 0
getBytes
ÃÃ0 8
(
ÃÃ8 9
(
ÃÃ9 :
UInt16
ÃÃ: @
)
ÃÃ@ A
len
ÃÃA D
,
ÃÃD E
true
ÃÃF J
)
ÃÃJ K
;
ÃÃK L
}
ÄÄ 
else
ÅÅ 
{
ÆÆ 

formatCode
ÇÇ "
|=
ÇÇ# %
$num
ÇÇ& *
;
ÇÇ* +
byteArr
ÈÈ 
=
ÈÈ  !
FByteConverter
ÈÈ" 0
.
ÈÈ0 1
getBytes
ÈÈ1 9
(
ÈÈ9 :
(
ÈÈ: ;
UInt32
ÈÈ; A
)
ÈÈA B
len
ÈÈB E
,
ÈÈE F
true
ÈÈG K
)
ÈÈK L
;
ÈÈL M
lenArr
ÉÉ 
=
ÉÉ  
new
ÉÉ! $
byte
ÉÉ% )
[
ÉÉ) *
$num
ÉÉ* +
]
ÉÉ+ ,
;
ÉÉ, -
lenArr
ÊÊ 
[
ÊÊ 
$num
ÊÊ  
]
ÊÊ  !
=
ÊÊ" #
byteArr
ÊÊ$ +
[
ÊÊ+ ,
$num
ÊÊ, -
]
ÊÊ- .
;
ÊÊ. /
lenArr
ËË 
[
ËË 
$num
ËË  
]
ËË  !
=
ËË" #
byteArr
ËË$ +
[
ËË+ ,
$num
ËË, -
]
ËË- .
;
ËË. /
lenArr
ÌÌ 
[
ÌÌ 
$num
ÌÌ  
]
ÌÌ  !
=
ÌÌ" #
byteArr
ÌÌ$ +
[
ÌÌ+ ,
$num
ÌÌ, -
]
ÌÌ- .
;
ÌÌ. /
}
ÍÍ 
binData
ÏÏ 
.
ÏÏ 
Add
ÏÏ 
(
ÏÏ  

formatCode
ÏÏ  *
)
ÏÏ* +
;
ÏÏ+ ,
binData
ĞĞ 
.
ĞĞ 
AddRange
ĞĞ $
(
ĞĞ$ %
lenArr
ĞĞ% +
)
ĞĞ+ ,
;
ĞĞ, -
if
ÒÒ 
(
ÒÒ 
valArr
ÒÒ 
!=
ÒÒ !
null
ÒÒ" &
)
ÒÒ& '
{
ÓÓ 
binData
ÔÔ 
.
ÔÔ  
AddRange
ÔÔ  (
(
ÔÔ( )
valArr
ÔÔ) /
)
ÔÔ/ 0
;
ÔÔ0 1
}
ÕÕ 
}
ÖÖ 
}
×× 
catch
ØØ 
(
ØØ 
	Exception
ØØ 
ex
ØØ 
)
ØØ  
{
ÙÙ 
FDebug
ÚÚ 
.
ÚÚ 
throwException
ÚÚ %
(
ÚÚ% &
ex
ÚÚ& (
)
ÚÚ( )
;
ÚÚ) *
}
ÛÛ 
finally
ÜÜ 
{
İİ 
}
ßß 
}
àà 	
public
ää 
static
ää 
FFormat
ää 
	getFormat
ää '
(
ää' (
int
åå 
value
åå 
)
ææ 
{
çç 	
try
èè 
{
éé 
if
êê 
(
êê 
value
êê 
==
êê 
$num
êê 
)
êê 
{
ëë 
return
ìì 
FFormat
ìì "
.
ìì" #
L
ìì# $
;
ìì$ %
}
íí 
else
îî 
if
îî 
(
îî 
value
îî 
==
îî !
$num
îî" #
)
îî# $
{
ïï 
return
ğğ 
FFormat
ğğ "
.
ğğ" #
B
ğğ# $
;
ğğ$ %
}
ññ 
else
òò 
if
òò 
(
òò 
value
òò 
==
òò !
$num
òò" #
)
òò# $
{
óó 
return
ôô 
FFormat
ôô "
.
ôô" #
BL
ôô# %
;
ôô% &
}
õõ 
else
öö 
if
öö 
(
öö 
value
öö 
==
öö !
$num
öö" $
)
öö$ %
{
÷÷ 
return
øø 
FFormat
øø "
.
øø" #
A
øø# $
;
øø$ %
}
ùù 
else
úú 
if
úú 
(
úú 
value
úú 
==
úú !
$num
úú" $
)
úú$ %
{
ûû 
return
üü 
FFormat
üü "
.
üü" #
J8
üü# %
;
üü% &
}
ıı 
else
şş 
if
şş 
(
şş 
value
şş 
==
şş !
$num
şş" $
)
şş$ %
{
ÿÿ 
return
€€ 
FFormat
€€ "
.
€€" #
A2
€€# %
;
€€% &
}
 
else
‚‚ 
if
‚‚ 
(
‚‚ 
value
‚‚ 
==
‚‚ !
$num
‚‚" $
)
‚‚$ %
{
ƒƒ 
return
„„ 
FFormat
„„ "
.
„„" #
I8
„„# %
;
„„% &
}
…… 
else
†† 
if
†† 
(
†† 
value
†† 
==
†† !
$num
††" $
)
††$ %
{
‡‡ 
return
ˆˆ 
FFormat
ˆˆ "
.
ˆˆ" #
I4
ˆˆ# %
;
ˆˆ% &
}
‰‰ 
else
ŠŠ 
if
ŠŠ 
(
ŠŠ 
value
ŠŠ 
==
ŠŠ !
$num
ŠŠ" $
)
ŠŠ$ %
{
‹‹ 
return
ŒŒ 
FFormat
ŒŒ "
.
ŒŒ" #
I2
ŒŒ# %
;
ŒŒ% &
}
 
else
 
if
 
(
 
value
 
==
 !
$num
" $
)
$ %
{
 
return
 
FFormat
 "
.
" #
I1
# %
;
% &
}
‘‘ 
else
’’ 
if
’’ 
(
’’ 
value
’’ 
==
’’ !
$num
’’" $
)
’’$ %
{
““ 
return
”” 
FFormat
”” "
.
””" #
F8
””# %
;
””% &
}
•• 
else
–– 
if
–– 
(
–– 
value
–– 
==
–– !
$num
––" $
)
––$ %
{
—— 
return
˜˜ 
FFormat
˜˜ "
.
˜˜" #
F4
˜˜# %
;
˜˜% &
}
™™ 
else
šš 
if
šš 
(
šš 
value
šš 
==
šš !
$num
šš" $
)
šš$ %
{
›› 
return
œœ 
FFormat
œœ "
.
œœ" #
U8
œœ# %
;
œœ% &
}
 
else
 
if
 
(
 
value
 
==
 !
$num
" $
)
$ %
{
ŸŸ 
return
   
FFormat
   "
.
  " #
U4
  # %
;
  % &
}
¡¡ 
else
¢¢ 
if
¢¢ 
(
¢¢ 
value
¢¢ 
==
¢¢ !
$num
¢¢" $
)
¢¢$ %
{
££ 
return
¤¤ 
FFormat
¤¤ "
.
¤¤" #
U2
¤¤# %
;
¤¤% &
}
¥¥ 
else
¦¦ 
if
¦¦ 
(
¦¦ 
value
¦¦ 
==
¦¦ !
$num
¦¦" $
)
¦¦$ %
{
§§ 
return
¨¨ 
FFormat
¨¨ "
.
¨¨" #
U1
¨¨# %
;
¨¨% &
}
©© 
return
ªª 
FFormat
ªª 
.
ªª 
A
ªª  
;
ªª  !
}
«« 
catch
¬¬ 
(
¬¬ 
	Exception
¬¬ 
ex
¬¬ 
)
¬¬  
{
­­ 
FDebug
®® 
.
®® 
throwException
®® %
(
®®% &
ex
®®& (
)
®®( )
;
®®) *
}
¯¯ 
finally
°° 
{
±± 
}
³³ 
return
´´ 
FFormat
´´ 
.
´´ 
A
´´ 
;
´´ 
}
µµ 	
public
¹¹ 
static
¹¹ 
UInt32
¹¹ 
getFormatBytes
¹¹ +
(
¹¹+ ,
FFormat
ºº 
fFormat
ºº 
)
»» 
{
¼¼ 	
try
½½ 
{
¾¾ 
if
¿¿ 
(
¿¿ 
fFormat
¿¿ 
==
¿¿ 
FFormat
¿¿ &
.
¿¿& '
L
¿¿' (
)
¿¿( )
{
ÀÀ 
return
ÁÁ 
$num
ÁÁ 
;
ÁÁ 
}
ÂÂ 
else
ÃÃ 
if
ÃÃ 
(
ÃÃ 
fFormat
ÃÃ  
==
ÃÃ! #
FFormat
ÃÃ$ +
.
ÃÃ+ ,
B
ÃÃ, -
)
ÃÃ- .
{
ÄÄ 
return
ÅÅ 
$num
ÅÅ 
;
ÅÅ 
}
ÆÆ 
else
ÇÇ 
if
ÇÇ 
(
ÇÇ 
fFormat
ÇÇ  
==
ÇÇ! #
FFormat
ÇÇ$ +
.
ÇÇ+ ,
BL
ÇÇ, .
)
ÇÇ. /
{
ÈÈ 
return
ÉÉ 
$num
ÉÉ 
;
ÉÉ 
}
ÊÊ 
else
ËË 
if
ËË 
(
ËË 
fFormat
ËË  
==
ËË! #
FFormat
ËË$ +
.
ËË+ ,
A
ËË, -
||
ËË. 0
fFormat
ËË1 8
==
ËË9 ;
FFormat
ËË< C
.
ËËC D
J8
ËËD F
||
ËËG I
fFormat
ËËJ Q
==
ËËR T
FFormat
ËËU \
.
ËË\ ]
A2
ËË] _
)
ËË_ `
{
ÌÌ 
return
ÍÍ 
$num
ÍÍ 
;
ÍÍ 
}
ÎÎ 
else
ÏÏ 
if
ÏÏ 
(
ÏÏ 
fFormat
ÏÏ  
==
ÏÏ! #
FFormat
ÏÏ$ +
.
ÏÏ+ ,
I8
ÏÏ, .
)
ÏÏ. /
{
ĞĞ 
return
ÑÑ 
$num
ÑÑ 
;
ÑÑ 
}
ÒÒ 
else
ÓÓ 
if
ÓÓ 
(
ÓÓ 
fFormat
ÓÓ  
==
ÓÓ! #
FFormat
ÓÓ$ +
.
ÓÓ+ ,
I4
ÓÓ, .
)
ÓÓ. /
{
ÔÔ 
return
ÕÕ 
$num
ÕÕ 
;
ÕÕ 
}
ÖÖ 
else
×× 
if
×× 
(
×× 
fFormat
××  
==
××! #
FFormat
××$ +
.
××+ ,
I2
××, .
)
××. /
{
ØØ 
return
ÙÙ 
$num
ÙÙ 
;
ÙÙ 
}
ÚÚ 
else
ÛÛ 
if
ÛÛ 
(
ÛÛ 
fFormat
ÛÛ  
==
ÛÛ! #
FFormat
ÛÛ$ +
.
ÛÛ+ ,
I1
ÛÛ, .
)
ÛÛ. /
{
ÜÜ 
return
İİ 
$num
İİ 
;
İİ 
}
ŞŞ 
else
ßß 
if
ßß 
(
ßß 
fFormat
ßß  
==
ßß! #
FFormat
ßß$ +
.
ßß+ ,
F8
ßß, .
)
ßß. /
{
àà 
return
áá 
$num
áá 
;
áá 
}
ââ 
else
ãã 
if
ãã 
(
ãã 
fFormat
ãã  
==
ãã! #
FFormat
ãã$ +
.
ãã+ ,
F4
ãã, .
)
ãã. /
{
ää 
return
åå 
$num
åå 
;
åå 
}
ææ 
else
çç 
if
çç 
(
çç 
fFormat
çç  
==
çç! #
FFormat
çç$ +
.
çç+ ,
U8
çç, .
)
çç. /
{
èè 
return
éé 
$num
éé 
;
éé 
}
êê 
else
ëë 
if
ëë 
(
ëë 
fFormat
ëë  
==
ëë! #
FFormat
ëë$ +
.
ëë+ ,
U4
ëë, .
)
ëë. /
{
ìì 
return
íí 
$num
íí 
;
íí 
}
îî 
else
ïï 
if
ïï 
(
ïï 
fFormat
ïï  
==
ïï! #
FFormat
ïï$ +
.
ïï+ ,
U2
ïï, .
)
ïï. /
{
ğğ 
return
ññ 
$num
ññ 
;
ññ 
}
òò 
else
óó 
if
óó 
(
óó 
fFormat
óó  
==
óó! #
FFormat
óó$ +
.
óó+ ,
U1
óó, .
)
óó. /
{
ôô 
return
õõ 
$num
õõ 
;
õõ 
}
öö 
return
÷÷ 
$num
÷÷ 
;
÷÷ 
}
øø 
catch
ùù 
(
ùù 
	Exception
ùù 
ex
ùù 
)
ùù  
{
úú 
FDebug
ûû 
.
ûû 
throwException
ûû %
(
ûû% &
ex
ûû& (
)
ûû( )
;
ûû) *
}
üü 
finally
ıı 
{
şş 
}
€€ 
return
 
$num
 
;
 
}
‚‚ 	
public
†† 
static
†† 
byte
†† 
getLengthBytes
†† )
(
††) *
UInt32
‡‡ 
length
‡‡ 
)
ˆˆ 
{
‰‰ 	
try
ŠŠ 
{
‹‹ 
if
ŒŒ 
(
ŒŒ 
length
ŒŒ 
<=
ŒŒ 
$num
ŒŒ "
)
ŒŒ" #
{
 
return
 
$num
 
;
 
}
 
else
 
if
 
(
 
length
 
<=
  "
$num
# )
)
) *
{
‘‘ 
return
’’ 
$num
’’ 
;
’’ 
}
““ 
return
”” 
$num
”” 
;
”” 
}
•• 
catch
–– 
(
–– 
	Exception
–– 
ex
–– 
)
––  
{
—— 
FDebug
˜˜ 
.
˜˜ 
throwException
˜˜ %
(
˜˜% &
ex
˜˜& (
)
˜˜( )
;
˜˜) *
}
™™ 
finally
šš 
{
›› 
}
 
return
 
$num
 
;
 
}
ŸŸ 	
public
££ 
static
££ 
string
££ 
getBinToValue
££ *
(
££* +
FFormat
¤¤ 
fFormat
¤¤ 
,
¤¤ 
byte
¥¥ 
[
¥¥ 
]
¥¥ 
value
¥¥ 
,
¥¥ 
UInt32
¦¦ 
index
¦¦ 
,
¦¦ 
UInt32
§§ 
length
§§ 
,
§§ 
UInt32
¨¨ 
formatBytes
¨¨ 
)
©© 
{
ªª 	
StringBuilder
«« 
returnValue
«« %
=
««& '
null
««( ,
;
««, -
byte
¬¬ 
[
¬¬ 
]
¬¬ 
byteArr
¬¬ 
=
¬¬ 
null
¬¬ !
;
¬¬! "
try
®® 
{
¯¯ 
if
°° 
(
°° 
length
°° 
==
°° 
$num
°° 
)
°°  
{
±± 
return
²² 
string
²² !
.
²²! "
Empty
²²" '
;
²²' (
}
³³ 
returnValue
·· 
=
·· 
new
·· !
StringBuilder
··" /
(
··/ 0
)
··0 1
;
··1 2
if
»» 
(
»» 
fFormat
»» 
==
»» 
FFormat
»» &
.
»»& '
B
»»' (
)
»»( )
{
¼¼ 
for
½½ 
(
½½ 
int
½½ 
i
½½ 
=
½½  
$num
½½! "
;
½½" #
i
½½$ %
<
½½& '
length
½½( .
;
½½. /
i
½½0 1
++
½½1 3
)
½½3 4
{
¾¾ 
returnValue
¿¿ #
.
¿¿# $
Append
¿¿$ *
(
¿¿* +
$char
¿¿+ .
)
¿¿. /
;
¿¿/ 0
returnValue
ÀÀ #
.
ÀÀ# $
Append
ÀÀ$ *
(
ÀÀ* +
value
ÀÀ+ 0
[
ÀÀ0 1
index
ÀÀ1 6
]
ÀÀ6 7
.
ÀÀ7 8
ToString
ÀÀ8 @
(
ÀÀ@ A
$str
ÀÀA E
)
ÀÀE F
)
ÀÀF G
;
ÀÀG H
index
ÁÁ 
+=
ÁÁ  
formatBytes
ÁÁ! ,
;
ÁÁ, -
}
ÂÂ 
returnValue
ÃÃ 
.
ÃÃ  
Remove
ÃÃ  &
(
ÃÃ& '
$num
ÃÃ' (
,
ÃÃ( )
$num
ÃÃ* +
)
ÃÃ+ ,
;
ÃÃ, -
}
ÄÄ 
else
ÅÅ 
if
ÅÅ 
(
ÅÅ 
fFormat
ÅÅ  
==
ÅÅ! #
FFormat
ÅÅ$ +
.
ÅÅ+ ,
BL
ÅÅ, .
)
ÅÅ. /
{
ÆÆ 
for
ÇÇ 
(
ÇÇ 
int
ÇÇ 
i
ÇÇ 
=
ÇÇ  
$num
ÇÇ! "
;
ÇÇ" #
i
ÇÇ$ %
<
ÇÇ& '
length
ÇÇ( .
;
ÇÇ. /
i
ÇÇ0 1
++
ÇÇ1 3
)
ÇÇ3 4
{
ÈÈ 
returnValue
ÉÉ #
.
ÉÉ# $
Append
ÉÉ$ *
(
ÉÉ* +
$char
ÉÉ+ .
)
ÉÉ. /
;
ÉÉ/ 0
returnValue
ÊÊ #
.
ÊÊ# $
Append
ÊÊ$ *
(
ÊÊ* +
FByteConverter
ÊÊ+ 9
.
ÊÊ9 :
	toBoolean
ÊÊ: C
(
ÊÊC D
value
ÊÊD I
[
ÊÊI J
index
ÊÊJ O
]
ÊÊO P
)
ÊÊP Q
)
ÊÊQ R
;
ÊÊR S
index
ËË 
+=
ËË  
formatBytes
ËË! ,
;
ËË, -
}
ÌÌ 
returnValue
ÍÍ 
.
ÍÍ  
Remove
ÍÍ  &
(
ÍÍ& '
$num
ÍÍ' (
,
ÍÍ( )
$num
ÍÍ* +
)
ÍÍ+ ,
;
ÍÍ, -
}
ÎÎ 
else
ÏÏ 
if
ÏÏ 
(
ÏÏ 
fFormat
ÏÏ  
==
ÏÏ! #
FFormat
ÏÏ$ +
.
ÏÏ+ ,
A
ÏÏ, -
||
ÏÏ. 0
fFormat
ÏÏ1 8
==
ÏÏ9 ;
FFormat
ÏÏ< C
.
ÏÏC D
A2
ÏÏD F
)
ÏÏF G
{
ĞĞ 
returnValue
ÑÑ 
.
ÑÑ  
Append
ÑÑ  &
(
ÑÑ& '
Encoding
ÑÑ' /
.
ÑÑ/ 0
Default
ÑÑ0 7
.
ÑÑ7 8
	GetString
ÑÑ8 A
(
ÑÑA B
value
ÑÑB G
,
ÑÑG H
(
ÑÑI J
int
ÑÑJ M
)
ÑÑM N
index
ÑÑN S
,
ÑÑS T
(
ÑÑU V
int
ÑÑV Y
)
ÑÑY Z
length
ÑÑZ `
)
ÑÑ` a
)
ÑÑa b
;
ÑÑb c
}
ÒÒ 
else
ÓÓ 
if
ÓÓ 
(
ÓÓ 
fFormat
ÓÓ  
==
ÓÓ! #
FFormat
ÓÓ$ +
.
ÓÓ+ ,
I8
ÓÓ, .
)
ÓÓ. /
{
ÔÔ 
for
ÕÕ 
(
ÕÕ 
int
ÕÕ 
i
ÕÕ 
=
ÕÕ  
$num
ÕÕ! "
;
ÕÕ" #
i
ÕÕ$ %
<
ÕÕ& '
length
ÕÕ( .
;
ÕÕ. /
i
ÕÕ0 1
++
ÕÕ1 3
)
ÕÕ3 4
{
ÖÖ 
byteArr
×× 
=
××  !
new
××" %
byte
××& *
[
××* +
formatBytes
××+ 6
]
××6 7
;
××7 8
for
ØØ 
(
ØØ 
int
ØØ  
j
ØØ! "
=
ØØ# $
$num
ØØ% &
;
ØØ& '
j
ØØ( )
<
ØØ* +
formatBytes
ØØ, 7
;
ØØ7 8
j
ØØ9 :
++
ØØ: <
)
ØØ< =
{
ÙÙ 
byteArr
ÚÚ #
[
ÚÚ# $
j
ÚÚ$ %
]
ÚÚ% &
=
ÚÚ' (
value
ÚÚ) .
[
ÚÚ. /
index
ÚÚ/ 4
+
ÚÚ5 6
j
ÚÚ7 8
]
ÚÚ8 9
;
ÚÚ9 :
}
ÛÛ 
returnValue
ßß #
.
ßß# $
Append
ßß$ *
(
ßß* +
$char
ßß+ .
)
ßß. /
;
ßß/ 0
returnValue
àà #
.
àà# $
Append
àà$ *
(
àà* +
FByteConverter
àà+ 9
.
àà9 :
toInt64
àà: A
(
ààA B
byteArr
ààB I
,
ààI J
true
ààK O
)
ààO P
)
ààP Q
;
ààQ R
index
áá 
+=
áá  
formatBytes
áá! ,
;
áá, -
}
ââ 
returnValue
ãã 
.
ãã  
Remove
ãã  &
(
ãã& '
$num
ãã' (
,
ãã( )
$num
ãã* +
)
ãã+ ,
;
ãã, -
}
ää 
else
åå 
if
åå 
(
åå 
fFormat
åå  
==
åå! #
FFormat
åå$ +
.
åå+ ,
I4
åå, .
)
åå. /
{
ææ 
for
çç 
(
çç 
int
çç 
i
çç 
=
çç  
$num
çç! "
;
çç" #
i
çç$ %
<
çç& '
length
çç( .
;
çç. /
i
çç0 1
++
çç1 3
)
çç3 4
{
èè 
byteArr
éé 
=
éé  !
new
éé" %
byte
éé& *
[
éé* +
formatBytes
éé+ 6
]
éé6 7
;
éé7 8
for
êê 
(
êê 
int
êê  
j
êê! "
=
êê# $
$num
êê% &
;
êê& '
j
êê( )
<
êê* +
formatBytes
êê, 7
;
êê7 8
j
êê9 :
++
êê: <
)
êê< =
{
ëë 
byteArr
ìì #
[
ìì# $
j
ìì$ %
]
ìì% &
=
ìì' (
value
ìì) .
[
ìì. /
index
ìì/ 4
+
ìì5 6
j
ìì7 8
]
ìì8 9
;
ìì9 :
}
íí 
returnValue
ññ #
.
ññ# $
Append
ññ$ *
(
ññ* +
$char
ññ+ .
)
ññ. /
;
ññ/ 0
returnValue
òò #
.
òò# $
Append
òò$ *
(
òò* +
FByteConverter
òò+ 9
.
òò9 :
toInt32
òò: A
(
òòA B
byteArr
òòB I
,
òòI J
true
òòK O
)
òòO P
)
òòP Q
;
òòQ R
index
óó 
+=
óó  
formatBytes
óó! ,
;
óó, -
}
ôô 
returnValue
õõ 
.
õõ  
Remove
õõ  &
(
õõ& '
$num
õõ' (
,
õõ( )
$num
õõ* +
)
õõ+ ,
;
õõ, -
}
öö 
else
÷÷ 
if
÷÷ 
(
÷÷ 
fFormat
÷÷  
==
÷÷! #
FFormat
÷÷$ +
.
÷÷+ ,
I2
÷÷, .
)
÷÷. /
{
øø 
for
ùù 
(
ùù 
int
ùù 
i
ùù 
=
ùù  
$num
ùù! "
;
ùù" #
i
ùù$ %
<
ùù& '
length
ùù( .
;
ùù. /
i
ùù0 1
++
ùù1 3
)
ùù3 4
{
úú 
byteArr
ûû 
=
ûû  !
new
ûû" %
byte
ûû& *
[
ûû* +
formatBytes
ûû+ 6
]
ûû6 7
;
ûû7 8
for
üü 
(
üü 
int
üü  
j
üü! "
=
üü# $
$num
üü% &
;
üü& '
j
üü( )
<
üü* +
formatBytes
üü, 7
;
üü7 8
j
üü9 :
++
üü: <
)
üü< =
{
ıı 
byteArr
şş #
[
şş# $
j
şş$ %
]
şş% &
=
şş' (
value
şş) .
[
şş. /
index
şş/ 4
+
şş5 6
j
şş7 8
]
şş8 9
;
şş9 :
}
ÿÿ 
returnValue
ƒƒ #
.
ƒƒ# $
Append
ƒƒ$ *
(
ƒƒ* +
$char
ƒƒ+ .
)
ƒƒ. /
;
ƒƒ/ 0
returnValue
„„ #
.
„„# $
Append
„„$ *
(
„„* +
FByteConverter
„„+ 9
.
„„9 :
toInt16
„„: A
(
„„A B
byteArr
„„B I
,
„„I J
true
„„K O
)
„„O P
)
„„P Q
;
„„Q R
index
…… 
+=
……  
formatBytes
……! ,
;
……, -
}
†† 
returnValue
‡‡ 
.
‡‡  
Remove
‡‡  &
(
‡‡& '
$num
‡‡' (
,
‡‡( )
$num
‡‡* +
)
‡‡+ ,
;
‡‡, -
}
ˆˆ 
else
‰‰ 
if
‰‰ 
(
‰‰ 
fFormat
‰‰  
==
‰‰! #
FFormat
‰‰$ +
.
‰‰+ ,
I1
‰‰, .
)
‰‰. /
{
ŠŠ 
for
‹‹ 
(
‹‹ 
int
‹‹ 
i
‹‹ 
=
‹‹  
$num
‹‹! "
;
‹‹" #
i
‹‹$ %
<
‹‹& '
length
‹‹( .
;
‹‹. /
i
‹‹0 1
++
‹‹1 3
)
‹‹3 4
{
ŒŒ 
returnValue
 #
.
# $
Append
$ *
(
* +
$char
+ .
)
. /
;
/ 0
returnValue
 #
.
# $
Append
$ *
(
* +
value
+ 0
[
0 1
index
1 6
]
6 7
)
7 8
;
8 9
index
 
+=
  
formatBytes
! ,
;
, -
}
 
returnValue
‘‘ 
.
‘‘  
Remove
‘‘  &
(
‘‘& '
$num
‘‘' (
,
‘‘( )
$num
‘‘* +
)
‘‘+ ,
;
‘‘, -
}
’’ 
else
““ 
if
““ 
(
““ 
fFormat
““  
==
““! #
FFormat
““$ +
.
““+ ,
F8
““, .
)
““. /
{
”” 
for
•• 
(
•• 
int
•• 
i
•• 
=
••  
$num
••! "
;
••" #
i
••$ %
<
••& '
length
••( .
;
••. /
i
••0 1
++
••1 3
)
••3 4
{
–– 
byteArr
—— 
=
——  !
new
——" %
byte
——& *
[
——* +
formatBytes
——+ 6
]
——6 7
;
——7 8
for
˜˜ 
(
˜˜ 
int
˜˜  
j
˜˜! "
=
˜˜# $
$num
˜˜% &
;
˜˜& '
j
˜˜( )
<
˜˜* +
formatBytes
˜˜, 7
;
˜˜7 8
j
˜˜9 :
++
˜˜: <
)
˜˜< =
{
™™ 
byteArr
šš #
[
šš# $
j
šš$ %
]
šš% &
=
šš' (
value
šš) .
[
šš. /
index
šš/ 4
+
šš5 6
j
šš7 8
]
šš8 9
;
šš9 :
}
›› 
returnValue
ŸŸ #
.
ŸŸ# $
Append
ŸŸ$ *
(
ŸŸ* +
$char
ŸŸ+ .
)
ŸŸ. /
;
ŸŸ/ 0
returnValue
   #
.
  # $
Append
  $ *
(
  * +
FByteConverter
  + 9
.
  9 :
toFloat8
  : B
(
  B C
byteArr
  C J
,
  J K
true
  L P
)
  P Q
)
  Q R
;
  R S
index
¡¡ 
+=
¡¡  
formatBytes
¡¡! ,
;
¡¡, -
}
¢¢ 
returnValue
££ 
.
££  
Remove
££  &
(
££& '
$num
££' (
,
££( )
$num
££* +
)
££+ ,
;
££, -
}
¤¤ 
else
¥¥ 
if
¥¥ 
(
¥¥ 
fFormat
¥¥  
==
¥¥! #
FFormat
¥¥$ +
.
¥¥+ ,
F4
¥¥, .
)
¥¥. /
{
¦¦ 
for
§§ 
(
§§ 
int
§§ 
i
§§ 
=
§§  
$num
§§! "
;
§§" #
i
§§$ %
<
§§& '
length
§§( .
;
§§. /
i
§§0 1
++
§§1 3
)
§§3 4
{
¨¨ 
byteArr
©© 
=
©©  !
new
©©" %
byte
©©& *
[
©©* +
formatBytes
©©+ 6
]
©©6 7
;
©©7 8
for
ªª 
(
ªª 
int
ªª  
j
ªª! "
=
ªª# $
$num
ªª% &
;
ªª& '
j
ªª( )
<
ªª* +
formatBytes
ªª, 7
;
ªª7 8
j
ªª9 :
++
ªª: <
)
ªª< =
{
«« 
byteArr
¬¬ #
[
¬¬# $
j
¬¬$ %
]
¬¬% &
=
¬¬' (
value
¬¬) .
[
¬¬. /
index
¬¬/ 4
+
¬¬5 6
j
¬¬7 8
]
¬¬8 9
;
¬¬9 :
}
­­ 
returnValue
±± #
.
±±# $
Append
±±$ *
(
±±* +
$char
±±+ .
)
±±. /
;
±±/ 0
returnValue
²² #
.
²²# $
Append
²²$ *
(
²²* +
FByteConverter
²²+ 9
.
²²9 :
toFloat4
²²: B
(
²²B C
byteArr
²²C J
,
²²J K
true
²²L P
)
²²P Q
)
²²Q R
;
²²R S
index
³³ 
+=
³³  
formatBytes
³³! ,
;
³³, -
}
´´ 
returnValue
µµ 
.
µµ  
Remove
µµ  &
(
µµ& '
$num
µµ' (
,
µµ( )
$num
µµ* +
)
µµ+ ,
;
µµ, -
}
¶¶ 
else
·· 
if
·· 
(
·· 
fFormat
··  
==
··! #
FFormat
··$ +
.
··+ ,
U8
··, .
)
··. /
{
¸¸ 
for
¹¹ 
(
¹¹ 
int
¹¹ 
i
¹¹ 
=
¹¹  
$num
¹¹! "
;
¹¹" #
i
¹¹$ %
<
¹¹& '
length
¹¹( .
;
¹¹. /
i
¹¹0 1
++
¹¹1 3
)
¹¹3 4
{
ºº 
byteArr
»» 
=
»»  !
new
»»" %
byte
»»& *
[
»»* +
formatBytes
»»+ 6
]
»»6 7
;
»»7 8
for
¼¼ 
(
¼¼ 
int
¼¼  
j
¼¼! "
=
¼¼# $
$num
¼¼% &
;
¼¼& '
j
¼¼( )
<
¼¼* +
formatBytes
¼¼, 7
;
¼¼7 8
j
¼¼9 :
++
¼¼: <
)
¼¼< =
{
½½ 
byteArr
¾¾ #
[
¾¾# $
j
¾¾$ %
]
¾¾% &
=
¾¾' (
value
¾¾) .
[
¾¾. /
index
¾¾/ 4
+
¾¾5 6
j
¾¾7 8
]
¾¾8 9
;
¾¾9 :
}
¿¿ 
returnValue
ÃÃ #
.
ÃÃ# $
Append
ÃÃ$ *
(
ÃÃ* +
$char
ÃÃ+ .
)
ÃÃ. /
;
ÃÃ/ 0
returnValue
ÄÄ #
.
ÄÄ# $
Append
ÄÄ$ *
(
ÄÄ* +
FByteConverter
ÄÄ+ 9
.
ÄÄ9 :
toUInt64
ÄÄ: B
(
ÄÄB C
byteArr
ÄÄC J
,
ÄÄJ K
true
ÄÄL P
)
ÄÄP Q
)
ÄÄQ R
;
ÄÄR S
index
ÅÅ 
+=
ÅÅ  
formatBytes
ÅÅ! ,
;
ÅÅ, -
}
ÆÆ 
returnValue
ÇÇ 
.
ÇÇ  
Remove
ÇÇ  &
(
ÇÇ& '
$num
ÇÇ' (
,
ÇÇ( )
$num
ÇÇ* +
)
ÇÇ+ ,
;
ÇÇ, -
}
ÈÈ 
else
ÉÉ 
if
ÉÉ 
(
ÉÉ 
fFormat
ÉÉ  
==
ÉÉ! #
FFormat
ÉÉ$ +
.
ÉÉ+ ,
U4
ÉÉ, .
)
ÉÉ. /
{
ÊÊ 
for
ËË 
(
ËË 
int
ËË 
i
ËË 
=
ËË  
$num
ËË! "
;
ËË" #
i
ËË$ %
<
ËË& '
length
ËË( .
;
ËË. /
i
ËË0 1
++
ËË1 3
)
ËË3 4
{
ÌÌ 
byteArr
ÍÍ 
=
ÍÍ  !
new
ÍÍ" %
byte
ÍÍ& *
[
ÍÍ* +
formatBytes
ÍÍ+ 6
]
ÍÍ6 7
;
ÍÍ7 8
for
ÎÎ 
(
ÎÎ 
int
ÎÎ  
j
ÎÎ! "
=
ÎÎ# $
$num
ÎÎ% &
;
ÎÎ& '
j
ÎÎ( )
<
ÎÎ* +
formatBytes
ÎÎ, 7
;
ÎÎ7 8
j
ÎÎ9 :
++
ÎÎ: <
)
ÎÎ< =
{
ÏÏ 
byteArr
ĞĞ #
[
ĞĞ# $
j
ĞĞ$ %
]
ĞĞ% &
=
ĞĞ' (
value
ĞĞ) .
[
ĞĞ. /
index
ĞĞ/ 4
+
ĞĞ5 6
j
ĞĞ7 8
]
ĞĞ8 9
;
ĞĞ9 :
}
ÑÑ 
returnValue
ÕÕ #
.
ÕÕ# $
Append
ÕÕ$ *
(
ÕÕ* +
$char
ÕÕ+ .
)
ÕÕ. /
;
ÕÕ/ 0
returnValue
ÖÖ #
.
ÖÖ# $
Append
ÖÖ$ *
(
ÖÖ* +
FByteConverter
ÖÖ+ 9
.
ÖÖ9 :
toUInt32
ÖÖ: B
(
ÖÖB C
byteArr
ÖÖC J
,
ÖÖJ K
true
ÖÖL P
)
ÖÖP Q
)
ÖÖQ R
;
ÖÖR S
index
×× 
+=
××  
formatBytes
××! ,
;
××, -
}
ØØ 
returnValue
ÙÙ 
.
ÙÙ  
Remove
ÙÙ  &
(
ÙÙ& '
$num
ÙÙ' (
,
ÙÙ( )
$num
ÙÙ* +
)
ÙÙ+ ,
;
ÙÙ, -
}
ÚÚ 
else
ÛÛ 
if
ÛÛ 
(
ÛÛ 
fFormat
ÛÛ  
==
ÛÛ! #
FFormat
ÛÛ$ +
.
ÛÛ+ ,
U2
ÛÛ, .
)
ÛÛ. /
{
ÜÜ 
for
İİ 
(
İİ 
int
İİ 
i
İİ 
=
İİ  
$num
İİ! "
;
İİ" #
i
İİ$ %
<
İİ& '
length
İİ( .
;
İİ. /
i
İİ0 1
++
İİ1 3
)
İİ3 4
{
ŞŞ 
byteArr
ßß 
=
ßß  !
new
ßß" %
byte
ßß& *
[
ßß* +
formatBytes
ßß+ 6
]
ßß6 7
;
ßß7 8
for
àà 
(
àà 
int
àà  
j
àà! "
=
àà# $
$num
àà% &
;
àà& '
j
àà( )
<
àà* +
formatBytes
àà, 7
;
àà7 8
j
àà9 :
++
àà: <
)
àà< =
{
áá 
byteArr
ââ #
[
ââ# $
j
ââ$ %
]
ââ% &
=
ââ' (
value
ââ) .
[
ââ. /
index
ââ/ 4
+
ââ5 6
j
ââ7 8
]
ââ8 9
;
ââ9 :
}
ãã 
returnValue
çç #
.
çç# $
Append
çç$ *
(
çç* +
$char
çç+ .
)
çç. /
;
çç/ 0
returnValue
èè #
.
èè# $
Append
èè$ *
(
èè* +
FByteConverter
èè+ 9
.
èè9 :
toUInt16
èè: B
(
èèB C
byteArr
èèC J
,
èèJ K
true
èèL P
)
èèP Q
)
èèQ R
;
èèR S
index
éé 
+=
éé  
formatBytes
éé! ,
;
éé, -
}
êê 
returnValue
ëë 
.
ëë  
Remove
ëë  &
(
ëë& '
$num
ëë' (
,
ëë( )
$num
ëë* +
)
ëë+ ,
;
ëë, -
}
ìì 
else
íí 
if
íí 
(
íí 
fFormat
íí  
==
íí! #
FFormat
íí$ +
.
íí+ ,
U1
íí, .
)
íí. /
{
îî 
for
ïï 
(
ïï 
int
ïï 
i
ïï 
=
ïï  
$num
ïï! "
;
ïï" #
i
ïï$ %
<
ïï& '
length
ïï( .
;
ïï. /
i
ïï0 1
++
ïï1 3
)
ïï3 4
{
ğğ 
returnValue
ññ #
.
ññ# $
Append
ññ$ *
(
ññ* +
$char
ññ+ .
)
ññ. /
;
ññ/ 0
returnValue
òò #
.
òò# $
Append
òò$ *
(
òò* +
value
òò+ 0
[
òò0 1
index
òò1 6
]
òò6 7
)
òò7 8
;
òò8 9
index
óó 
+=
óó  
formatBytes
óó! ,
;
óó, -
}
ôô 
returnValue
õõ 
.
õõ  
Remove
õõ  &
(
õõ& '
$num
õõ' (
,
õõ( )
$num
õõ* +
)
õõ+ ,
;
õõ, -
}
öö 
else
÷÷ 
if
÷÷ 
(
÷÷ 
fFormat
÷÷  
==
÷÷! #
FFormat
÷÷$ +
.
÷÷+ ,
J8
÷÷, .
)
÷÷. /
{
øø 
for
ùù 
(
ùù 
int
ùù 
i
ùù 
=
ùù  
$num
ùù! "
;
ùù" #
i
ùù$ %
<
ùù& '
length
ùù( .
;
ùù. /
i
ùù0 1
++
ùù1 3
)
ùù3 4
{
úú 
if
ûû 
(
ûû 
value
ûû !
[
ûû! "
index
ûû" '
]
ûû' (
==
ûû) +
$num
ûû, 0
)
ûû0 1
{
üü 
returnValue
ıı '
.
ıı' (
Append
ıı( .
(
ıı. /
$str
ıı/ 3
)
ıı3 4
;
ıı4 5
}
şş 
else
ÿÿ 
if
ÿÿ 
(
ÿÿ  !
value
ÿÿ! &
[
ÿÿ& '
index
ÿÿ' ,
]
ÿÿ, -
==
ÿÿ. 0
$num
ÿÿ1 5
)
ÿÿ5 6
{
€€ 
returnValue
 '
.
' (
Append
( .
(
. /
$str
/ 3
)
3 4
;
4 5
}
‚‚ 
else
ƒƒ 
{
„„ 
returnValue
…… '
.
……' (
Append
……( .
(
……. /
(
……/ 0
char
……0 4
)
……4 5
value
……5 :
[
……: ;
index
……; @
]
……@ A
)
……A B
;
……B C
}
†† 
index
‡‡ 
+=
‡‡  
formatBytes
‡‡! ,
;
‡‡, -
}
ˆˆ 
}
‰‰ 
return
ŠŠ 
returnValue
ŠŠ "
.
ŠŠ" #
ToString
ŠŠ# +
(
ŠŠ+ ,
)
ŠŠ, -
;
ŠŠ- .
}
‹‹ 
catch
ŒŒ 
(
ŒŒ 
	Exception
ŒŒ 
ex
ŒŒ 
)
ŒŒ  
{
 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
 
{
‘‘ 
returnValue
’’ 
=
’’ 
null
’’ "
;
’’" #
byteArr
““ 
=
““ 
null
““ 
;
““ 
}
”” 
return
•• 
string
•• 
.
•• 
Empty
•• 
;
••  
}
–– 	
public
šš 
static
šš 
byte
šš 
[
šš 
]
šš !
getStringToBinValue
šš 0
(
šš0 1
FFormat
›› 
fFormat
›› 
,
›› 
string
œœ 
value
œœ 
,
œœ 
ref
 
UInt32
 
length
 
)
 
{
ŸŸ 	
string
   
[
   
]
   
arrVal
   
=
   
null
   "
;
  " #
List
¡¡ 
<
¡¡ 
byte
¡¡ 
>
¡¡ 
binValue
¡¡ 
=
¡¡  !
null
¡¡" &
;
¡¡& '
try
££ 
{
¤¤ 
if
¥¥ 
(
¥¥ 
value
¥¥ 
==
¥¥ 
string
¥¥ #
.
¥¥# $
Empty
¥¥$ )
)
¥¥) *
{
¦¦ 
length
§§ 
=
§§ 
$num
§§ 
;
§§ 
return
¨¨ 
null
¨¨ 
;
¨¨  
}
©© 
binValue
­­ 
=
­­ 
new
­­ 
List
­­ #
<
­­# $
byte
­­$ (
>
­­( )
(
­­) *
)
­­* +
;
­­+ ,
if
¯¯ 
(
¯¯ 
fFormat
¯¯ 
!=
¯¯ 
FFormat
¯¯ &
.
¯¯& '
A
¯¯' (
&&
¯¯) +
fFormat
¯¯, 3
!=
¯¯4 6
FFormat
¯¯7 >
.
¯¯> ?
A2
¯¯? A
)
¯¯A B
{
°° 
arrVal
±± 
=
±± 
value
±± "
.
±±" #
Split
±±# (
(
±±( )
new
±±) ,
char
±±- 1
[
±±1 2
]
±±2 3
{
±±4 5
$char
±±6 9
}
±±: ;
,
±±; < 
StringSplitOptions
±±= O
.
±±O P 
RemoveEmptyEntries
±±P b
)
±±b c
;
±±c d
}
²² 
if
¶¶ 
(
¶¶ 
fFormat
¶¶ 
==
¶¶ 
FFormat
¶¶ &
.
¶¶& '
L
¶¶' (
)
¶¶( )
{
·· 
length
¸¸ 
=
¸¸ 
$num
¸¸ 
;
¸¸ 
return
¹¹ 
null
¹¹ 
;
¹¹  
}
ºº 
else
»» 
if
»» 
(
»» 
fFormat
»»  
==
»»! #
FFormat
»»$ +
.
»»+ ,
B
»», -
)
»»- .
{
¼¼ 
length
½½ 
=
½½ 
(
½½ 
UInt32
½½ $
)
½½$ %
arrVal
½½% +
.
½½+ ,
Length
½½, 2
;
½½2 3
foreach
¾¾ 
(
¾¾ 
string
¾¾ #
v
¾¾$ %
in
¾¾& (
arrVal
¾¾) /
)
¾¾/ 0
{
¿¿ 
binValue
ÀÀ  
.
ÀÀ  !
Add
ÀÀ! $
(
ÀÀ$ %
byte
ÀÀ% )
.
ÀÀ) *
Parse
ÀÀ* /
(
ÀÀ/ 0
v
ÀÀ0 1
,
ÀÀ1 2
System
ÀÀ3 9
.
ÀÀ9 :
Globalization
ÀÀ: G
.
ÀÀG H
NumberStyles
ÀÀH T
.
ÀÀT U
	HexNumber
ÀÀU ^
)
ÀÀ^ _
)
ÀÀ_ `
;
ÀÀ` a
}
ÁÁ 
}
ÂÂ 
else
ÃÃ 
if
ÃÃ 
(
ÃÃ 
fFormat
ÃÃ  
==
ÃÃ! #
FFormat
ÃÃ$ +
.
ÃÃ+ ,
BL
ÃÃ, .
)
ÃÃ. /
{
ÄÄ 
length
ÅÅ 
=
ÅÅ 
(
ÅÅ 
UInt32
ÅÅ $
)
ÅÅ$ %
arrVal
ÅÅ% +
.
ÅÅ+ ,
Length
ÅÅ, 2
;
ÅÅ2 3
foreach
ÆÆ 
(
ÆÆ 
string
ÆÆ #
v
ÆÆ$ %
in
ÆÆ& (
arrVal
ÆÆ) /
)
ÆÆ/ 0
{
ÇÇ 
if
ÈÈ 
(
ÈÈ 
v
ÈÈ 
.
ÈÈ 
ToUpper
ÈÈ %
(
ÈÈ% &
)
ÈÈ& '
==
ÈÈ( *
$str
ÈÈ+ 1
)
ÈÈ1 2
{
ÉÉ 
binValue
ÊÊ $
.
ÊÊ$ %
Add
ÊÊ% (
(
ÊÊ( )
$num
ÊÊ) -
)
ÊÊ- .
;
ÊÊ. /
}
ËË 
else
ÌÌ 
{
ÍÍ 
binValue
ÎÎ $
.
ÎÎ$ %
Add
ÎÎ% (
(
ÎÎ( )
$num
ÎÎ) -
)
ÎÎ- .
;
ÎÎ. /
}
ÏÏ 
}
ĞĞ 
}
ÑÑ 
else
ÒÒ 
if
ÒÒ 
(
ÒÒ 
fFormat
ÒÒ  
==
ÒÒ! #
FFormat
ÒÒ$ +
.
ÒÒ+ ,
A
ÒÒ, -
||
ÒÒ. 0
fFormat
ÒÒ1 8
==
ÒÒ9 ;
FFormat
ÒÒ< C
.
ÒÒC D
A2
ÒÒD F
)
ÒÒF G
{
ÓÓ 
length
ÔÔ 
=
ÔÔ 
(
ÔÔ 
UInt32
ÔÔ $
)
ÔÔ$ %
Encoding
ÔÔ% -
.
ÔÔ- .
Default
ÔÔ. 5
.
ÔÔ5 6
GetByteCount
ÔÔ6 B
(
ÔÔB C
value
ÔÔC H
)
ÔÔH I
;
ÔÔI J
binValue
ÕÕ 
.
ÕÕ 
AddRange
ÕÕ %
(
ÕÕ% &
Encoding
ÕÕ& .
.
ÕÕ. /
Default
ÕÕ/ 6
.
ÕÕ6 7
GetBytes
ÕÕ7 ?
(
ÕÕ? @
value
ÕÕ@ E
)
ÕÕE F
)
ÕÕF G
;
ÕÕG H
}
ÖÖ 
else
×× 
if
×× 
(
×× 
fFormat
××  
==
××! #
FFormat
××$ +
.
××+ ,
I8
××, .
)
××. /
{
ØØ 
length
ÙÙ 
=
ÙÙ 
(
ÙÙ 
UInt32
ÙÙ $
)
ÙÙ$ %
arrVal
ÙÙ% +
.
ÙÙ+ ,
Length
ÙÙ, 2
;
ÙÙ2 3
foreach
ÚÚ 
(
ÚÚ 
string
ÚÚ #
v
ÚÚ$ %
in
ÚÚ& (
arrVal
ÚÚ) /
)
ÚÚ/ 0
{
ÛÛ 
binValue
ÜÜ  
.
ÜÜ  !
AddRange
ÜÜ! )
(
ÜÜ) *
FByteConverter
ÜÜ* 8
.
ÜÜ8 9
getBytes
ÜÜ9 A
(
ÜÜA B
Convert
ÜÜB I
.
ÜÜI J
ToInt64
ÜÜJ Q
(
ÜÜQ R
v
ÜÜR S
)
ÜÜS T
,
ÜÜT U
true
ÜÜV Z
)
ÜÜZ [
)
ÜÜ[ \
;
ÜÜ\ ]
}
İİ 
}
ŞŞ 
else
ßß 
if
ßß 
(
ßß 
fFormat
ßß  
==
ßß! #
FFormat
ßß$ +
.
ßß+ ,
I4
ßß, .
)
ßß. /
{
àà 
length
áá 
=
áá 
(
áá 
UInt32
áá $
)
áá$ %
arrVal
áá% +
.
áá+ ,
Length
áá, 2
;
áá2 3
foreach
ââ 
(
ââ 
string
ââ #
v
ââ$ %
in
ââ& (
arrVal
ââ) /
)
ââ/ 0
{
ãã 
binValue
ää  
.
ää  !
AddRange
ää! )
(
ää) *
FByteConverter
ää* 8
.
ää8 9
getBytes
ää9 A
(
ääA B
Convert
ääB I
.
ääI J
ToInt32
ääJ Q
(
ääQ R
v
ääR S
)
ääS T
,
ääT U
true
ääV Z
)
ääZ [
)
ää[ \
;
ää\ ]
}
åå 
}
ææ 
else
çç 
if
çç 
(
çç 
fFormat
çç  
==
çç! #
FFormat
çç$ +
.
çç+ ,
I2
çç, .
)
çç. /
{
èè 
length
éé 
=
éé 
(
éé 
UInt32
éé $
)
éé$ %
arrVal
éé% +
.
éé+ ,
Length
éé, 2
;
éé2 3
foreach
êê 
(
êê 
string
êê #
v
êê$ %
in
êê& (
arrVal
êê) /
)
êê/ 0
{
ëë 
binValue
ìì  
.
ìì  !
AddRange
ìì! )
(
ìì) *
FByteConverter
ìì* 8
.
ìì8 9
getBytes
ìì9 A
(
ììA B
Convert
ììB I
.
ììI J
ToInt16
ììJ Q
(
ììQ R
v
ììR S
)
ììS T
,
ììT U
true
ììV Z
)
ììZ [
)
ìì[ \
;
ìì\ ]
}
íí 
}
îî 
else
ïï 
if
ïï 
(
ïï 
fFormat
ïï  
==
ïï! #
FFormat
ïï$ +
.
ïï+ ,
I1
ïï, .
)
ïï. /
{
ğğ 
length
ññ 
=
ññ 
(
ññ 
UInt32
ññ $
)
ññ$ %
arrVal
ññ% +
.
ññ+ ,
Length
ññ, 2
;
ññ2 3
foreach
òò 
(
òò 
string
òò #
v
òò$ %
in
òò& (
arrVal
òò) /
)
òò/ 0
{
óó 
binValue
ôô  
.
ôô  !
Add
ôô! $
(
ôô$ %
(
ôô% &
byte
ôô& *
)
ôô* +
sbyte
ôô+ 0
.
ôô0 1
Parse
ôô1 6
(
ôô6 7
v
ôô7 8
)
ôô8 9
)
ôô9 :
;
ôô: ;
}
õõ 
}
öö 
else
÷÷ 
if
÷÷ 
(
÷÷ 
fFormat
÷÷  
==
÷÷! #
FFormat
÷÷$ +
.
÷÷+ ,
U8
÷÷, .
)
÷÷. /
{
øø 
length
ùù 
=
ùù 
(
ùù 
UInt32
ùù $
)
ùù$ %
arrVal
ùù% +
.
ùù+ ,
Length
ùù, 2
;
ùù2 3
foreach
úú 
(
úú 
string
úú #
v
úú$ %
in
úú& (
arrVal
úú) /
)
úú/ 0
{
ûû 
binValue
üü  
.
üü  !
AddRange
üü! )
(
üü) *
FByteConverter
üü* 8
.
üü8 9
getBytes
üü9 A
(
üüA B
Convert
üüB I
.
üüI J
ToUInt64
üüJ R
(
üüR S
v
üüS T
)
üüT U
,
üüU V
true
üüW [
)
üü[ \
)
üü\ ]
;
üü] ^
}
ıı 
}
şş 
else
ÿÿ 
if
ÿÿ 
(
ÿÿ 
fFormat
ÿÿ  
==
ÿÿ! #
FFormat
ÿÿ$ +
.
ÿÿ+ ,
U4
ÿÿ, .
)
ÿÿ. /
{
€€ 
length
 
=
 
(
 
UInt32
 $
)
$ %
arrVal
% +
.
+ ,
Length
, 2
;
2 3
foreach
‚‚ 
(
‚‚ 
string
‚‚ #
v
‚‚$ %
in
‚‚& (
arrVal
‚‚) /
)
‚‚/ 0
{
ƒƒ 
binValue
„„  
.
„„  !
AddRange
„„! )
(
„„) *
FByteConverter
„„* 8
.
„„8 9
getBytes
„„9 A
(
„„A B
Convert
„„B I
.
„„I J
ToUInt32
„„J R
(
„„R S
v
„„S T
)
„„T U
,
„„U V
true
„„W [
)
„„[ \
)
„„\ ]
;
„„] ^
}
…… 
}
†† 
else
‡‡ 
if
‡‡ 
(
‡‡ 
fFormat
‡‡  
==
‡‡! #
FFormat
‡‡$ +
.
‡‡+ ,
U2
‡‡, .
)
‡‡. /
{
ˆˆ 
length
‰‰ 
=
‰‰ 
(
‰‰ 
UInt32
‰‰ $
)
‰‰$ %
arrVal
‰‰% +
.
‰‰+ ,
Length
‰‰, 2
;
‰‰2 3
foreach
ŠŠ 
(
ŠŠ 
string
ŠŠ #
v
ŠŠ$ %
in
ŠŠ& (
arrVal
ŠŠ) /
)
ŠŠ/ 0
{
‹‹ 
binValue
ŒŒ  
.
ŒŒ  !
AddRange
ŒŒ! )
(
ŒŒ) *
FByteConverter
ŒŒ* 8
.
ŒŒ8 9
getBytes
ŒŒ9 A
(
ŒŒA B
Convert
ŒŒB I
.
ŒŒI J
ToUInt16
ŒŒJ R
(
ŒŒR S
v
ŒŒS T
)
ŒŒT U
,
ŒŒU V
true
ŒŒW [
)
ŒŒ[ \
)
ŒŒ\ ]
;
ŒŒ] ^
}
 
}
 
else
 
if
 
(
 
fFormat
  
==
! #
FFormat
$ +
.
+ ,
U1
, .
)
. /
{
 
length
‘‘ 
=
‘‘ 
(
‘‘ 
UInt32
‘‘ $
)
‘‘$ %
arrVal
‘‘% +
.
‘‘+ ,
Length
‘‘, 2
;
‘‘2 3
foreach
’’ 
(
’’ 
string
’’ #
v
’’$ %
in
’’& (
arrVal
’’) /
)
’’/ 0
{
““ 
binValue
””  
.
””  !
Add
””! $
(
””$ %
byte
””% )
.
””) *
Parse
””* /
(
””/ 0
v
””0 1
)
””1 2
)
””2 3
;
””3 4
}
•• 
}
–– 
else
—— 
if
—— 
(
—— 
fFormat
——  
==
——! #
FFormat
——$ +
.
——+ ,
F8
——, .
)
——. /
{
˜˜ 
length
™™ 
=
™™ 
(
™™ 
UInt32
™™ $
)
™™$ %
arrVal
™™% +
.
™™+ ,
Length
™™, 2
;
™™2 3
foreach
šš 
(
šš 
string
šš #
v
šš$ %
in
šš& (
arrVal
šš) /
)
šš/ 0
{
›› 
binValue
œœ  
.
œœ  !
AddRange
œœ! )
(
œœ) *
FByteConverter
œœ* 8
.
œœ8 9
getBytes
œœ9 A
(
œœA B
Convert
œœB I
.
œœI J
ToDouble
œœJ R
(
œœR S
v
œœS T
)
œœT U
,
œœU V
true
œœW [
)
œœ[ \
)
œœ\ ]
;
œœ] ^
}
 
}
 
else
ŸŸ 
if
ŸŸ 
(
ŸŸ 
fFormat
ŸŸ  
==
ŸŸ! #
FFormat
ŸŸ$ +
.
ŸŸ+ ,
F4
ŸŸ, .
)
ŸŸ. /
{
   
length
¡¡ 
=
¡¡ 
(
¡¡ 
UInt32
¡¡ $
)
¡¡$ %
arrVal
¡¡% +
.
¡¡+ ,
Length
¡¡, 2
;
¡¡2 3
foreach
¢¢ 
(
¢¢ 
string
¢¢ #
v
¢¢$ %
in
¢¢& (
arrVal
¢¢) /
)
¢¢/ 0
{
££ 
binValue
¤¤  
.
¤¤  !
AddRange
¤¤! )
(
¤¤) *
FByteConverter
¤¤* 8
.
¤¤8 9
getBytes
¤¤9 A
(
¤¤A B
Convert
¤¤B I
.
¤¤I J
ToSingle
¤¤J R
(
¤¤R S
v
¤¤S T
)
¤¤T U
,
¤¤U V
true
¤¤W [
)
¤¤[ \
)
¤¤\ ]
;
¤¤] ^
}
¥¥ 
}
¦¦ 
return
ªª 
binValue
ªª 
.
ªª  
ToArray
ªª  '
(
ªª' (
)
ªª( )
;
ªª) *
}
«« 
catch
¬¬ 
(
¬¬ 
	Exception
¬¬ 
ex
¬¬ 
)
¬¬  
{
­­ 
FDebug
®® 
.
®® 
throwException
®® %
(
®®% &
ex
®®& (
)
®®( )
;
®®) *
}
¯¯ 
finally
°° 
{
±± 
}
³³ 
return
´´ 
null
´´ 
;
´´ 
}
µµ 	
}
¹¹ 
}ºº Ö*
lD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Common\e_FEnum.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
public 

enum 
FConnectMode 
: 
int "
{ 
Active 
, 
Passive 
} 
public 

enum 
FCommunicationState #
:$ %
int& )
{   
Closed!! 
,!! 
Opened"" 
,"" 
	Connected## 
,## 
Selected$$ 
}%% 
public)) 

enum)) 
FEventId)) 
:)) 
int)) 
{** 
None++ 
,++ 
Secs1StateChanged-- 
,-- 
Secs1ErrorRaised.. 
,.. 
Secs1TimeoutRaised// 
,// "
Secs1HandshakeReceived00 
,00 
Secs1HandshakeSent11 
,11 
Secs1BlockReceived22 
,22 
Secs1BlockSent33 
,33 $
Secs1DataMessageReceived44  
,44  ! 
Secs1DataMessageSent55 
,55 0
$Secs1InterceptingDataMessageReceived66 ,
,66, -
HsmsStateChanged88 
,88 
HsmsErrorRaised99 
,99 
HsmsTimeoutRaised:: 
,:: &
HsmsControlMessageReceived;; "
,;;" #"
HsmsControlMessageSent<< 
,<< #
HsmsDataMessageReceived== 
,==  
HsmsDataMessageSent>> 
,>> /
#HsmsInterceptingDataMessageReceived?? +
,??+ ,
LogMonitoringAA 
}BB 
publicFF 

enumFF 
FSecsTimeoutFF 
:FF 
intFF "
{GG 
T1HH 

=HH 
$numHH 
,HH 
T2II 

=II 
$numII 
,II 
T3JJ 

=JJ 
$numJJ 
,JJ 
T4KK 

=KK 
$numKK 
,KK 
T5LL 

=LL 
$numLL 
,LL 
T6MM 

=MM 
$numMM 
,MM 
T7NN 

=NN 
$numNN 
,NN 
T8OO 

=OO 
$numOO 
}PP 
publicTT 

enumTT 
FSecs1HandshakeCodeTT #
:TT$ %
intTT& )
{UU 
ENQVV 
=VV 
$numVV 
,VV 
EOTWW 
=WW 
$numWW 
,WW 
ACKXX 
=XX 
$numXX 
,XX 
NAKYY 
=YY 
$numYY 
}ZZ 
internal^^ 
enum^^ 
FSecs1RecvState^^ !
:^^" #
int^^$ '
{__ 
Enq`` 
,`` 
Eotaa 
,aa 
	Completedbb 
}cc 
internalgg 
enumgg 
FSecs1SendStategg !
:gg" #
intgg$ '
{hh 
Enqii 
,ii 
Eotjj 
,jj 
	Completedkk 
}ll 
publicpp 

enumpp #
FHsmsControlMessageTypepp '
:pp( )
intpp* -
{qq 
	SelectReqrr 
=rr 
$numrr 
,rr 
	SelectRspss 
=ss 
$numss 
,ss 
DeselectReqtt 
=tt 
$numtt 
,tt 
DeselectRspuu 
=uu 
$numuu 
,uu 
LinktestReqvv 
=vv 
$numvv 
,vv 
LinktestRspww 
=ww 
$numww 
,ww 
	RejectReqxx 
=xx 
$numxx 
,xx 
SeparateReqyy 
=yy 
$numyy 
}zz 
public~~ 

enum~~ 
FResultCode~~ 
:~~ 
int~~ !
{ 
Success
€€ 
,
€€ 
Warninig
 
,
 
Error
‚‚ 
}
ƒƒ 
public
‡‡ 

enum
‡‡ 
FFormat
‡‡ 
:
‡‡ 
int
‡‡ 
{
ˆˆ 
L
‰‰ 	
=
‰‰
 
$num
‰‰ 
,
‰‰ 
B
ŠŠ 	
=
ŠŠ
 
$num
ŠŠ 
,
ŠŠ 
BL
‹‹ 

=
‹‹ 
$num
‹‹ 
,
‹‹ 
A
ŒŒ 	
=
ŒŒ
 
$num
ŒŒ 
,
ŒŒ 
J8
 

=
 
$num
 
,
 
A2
 

=
 
$num
 
,
 
I8
 

=
 
$num
 
,
 
I4
 

=
 
$num
 
,
 
I2
‘‘ 

=
‘‘ 
$num
‘‘ 
,
‘‘ 
I1
’’ 

=
’’ 
$num
’’ 
,
’’ 
F8
““ 

=
““ 
$num
““ 
,
““ 
F4
”” 

=
”” 
$num
”” 
,
”” 
U8
•• 

=
•• 
$num
•• 
,
•• 
U4
–– 

=
–– 
$num
–– 
,
–– 
U2
—— 

=
—— 
$num
—— 
,
—— 
U1
˜˜ 

=
˜˜ 
$num
˜˜ 
,
˜˜ 
}
™™ 
} ’
pD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Common\d_FDelegate.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
public 

delegate 
void $
FEventRaisedEventHandler 1
(1 2
object2 8
sender9 ?
,? @
FEventArgsBaseA O
eP Q
)Q R
;R S
} §
oD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Common\c_FSecsTag.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
public 

static 
class 
FSecsTag  
{ 
public 
const 
string 
E_SecsMessage )
=* +
$str, 1
;1 2
public 
const 
string 
A_SessionId '
=( )
$str* -
;- .
public 
const 
string 
A_Stream $
=% &
$str' *
;* +
public 
const 
string 

A_Function &
=' (
$str) ,
;, -
public 
const 
string 
A_WBit "
=# $
$str% (
;( )
public 
const 
string 
A_SystemBytes )
=* +
$str, 0
;0 1
public## 
const## 
string## 

E_SecsItem## &
=##' (
$str##) .
;##. /
public$$ 
const$$ 
string$$ 
A_Format$$ $
=$$% &
$str$$' *
;$$* +
public%% 
const%% 
string%% 
A_Length%% $
=%%% &
$str%%' *
;%%* +
public&& 
const&& 
string&& 
A_Value&& #
=&&$ %
$str&&& )
;&&) *
}** 
}++ –H
zD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\SerialToEthernet\Common\c_FByteConverter.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSerialToEthernet -
{ 
public 

static 
class 
FByteConverter &
{ 
public!! 
static!! 
byte!! 
[!! 
]!! 
getBytes!! %
(!!% &
UInt16"" 
value"" 
,"" 
bool## 
	isReverse## 
)$$ 
{%% 	
byte&& 
[&& 
]&& 
buf&& 
=&& 
null&& 
;&& 
try(( 
{)) 
buf** 
=** 
BitConverter** "
.**" #
GetBytes**# +
(**+ ,
value**, 1
)**1 2
;**2 3
if++ 
(++ 
	isReverse++ 
)++ 
{,, 
Array-- 
.-- 
Reverse-- !
(--! "
buf--" %
)--% &
;--& '
}.. 
return// 
buf// 
;// 
}00 
catch11 
(11 
	Exception11 
ex11 
)11  
{22 
FDebug33 
.33 
throwException33 %
(33% &
ex33& (
)33( )
;33) *
}44 
finally55 
{66 
buf77 
=77 
null77 
;77 
}88 
return99 
null99 
;99 
}:: 	
public>> 
static>> 
byte>> 
[>> 
]>> 
getBytes>> %
(>>% &
UInt32?? 
value?? 
,?? 
bool@@ 
	isReverse@@ 
)AA 
{BB 	
byteCC 
[CC 
]CC 
bufCC 
=CC 
nullCC 
;CC 
tryEE 
{FF 
bufGG 
=GG 
BitConverterGG "
.GG" #
GetBytesGG# +
(GG+ ,
valueGG, 1
)GG1 2
;GG2 3
ifHH 
(HH 
	isReverseHH 
)HH 
{II 
ArrayJJ 
.JJ 
ReverseJJ !
(JJ! "
bufJJ" %
)JJ% &
;JJ& '
}KK 
returnLL 
bufLL 
;LL 
}MM 
catchNN 
(NN 
	ExceptionNN 
exNN 
)NN  
{OO 
FDebugPP 
.PP 
throwExceptionPP %
(PP% &
exPP& (
)PP( )
;PP) *
}QQ 
finallyRR 
{SS 
bufTT 
=TT 
nullTT 
;TT 
}UU 
returnVV 
nullVV 
;VV 
}WW 	
public[[ 
static[[ 
byte[[ 
[[[ 
][[ 
getBytes[[ %
([[% &
string\\ 
	byteValue\\ 
)]] 
{^^ 	
List__ 
<__ 
byte__ 
>__ 
buf__ 
=__ 
null__ !
;__! "
tryaa 
{bb 
bufcc 
=cc 
newcc 
Listcc 
<cc 
bytecc #
>cc# $
(cc$ %
)cc% &
;cc& '
ifdd 
(dd 
	byteValuedd 
==dd 
stringdd %
.dd% &
Emptydd& +
)dd+ ,
{ee 
returnff 
nullff 
;ff  
}gg 
foreachii 
(ii 
stringii 
sii  !
inii" $
	byteValueii% .
.ii. /
Splitii/ 4
(ii4 5
$charii5 8
)ii8 9
)ii9 :
{jj 
bufkk 
.kk 
Addkk 
(kk 
Convertkk #
.kk# $
ToBytekk$ *
(kk* +
skk+ ,
,kk, -
$numkk. 0
)kk0 1
)kk1 2
;kk2 3
}ll 
returnmm 
bufmm 
.mm 
ToArraymm "
(mm" #
)mm# $
;mm$ %
}nn 
catchoo 
(oo 
	Exceptionoo 
exoo 
)oo  
{pp 
FDebugqq 
.qq 
throwExceptionqq %
(qq% &
exqq& (
)qq( )
;qq) *
}rr 
finallyss 
{tt 
bufuu 
=uu 
nulluu 
;uu 
}vv 
returnww 
nullww 
;ww 
}xx 	
public|| 
static|| 
string|| 
toString|| %
(||% &
byte}} 
[}} 
]}} 
data}} 
)~~ 
{ 	
StringBuilder
€€ 
val
€€ 
=
€€ 
null
€€  $
;
€€$ %
try
‚‚ 
{
ƒƒ 
val
„„ 
=
„„ 
new
„„ 
StringBuilder
„„ '
(
„„' (
)
„„( )
;
„„) *
if
…… 
(
…… 
data
…… 
==
…… 
null
……  
)
……  !
{
†† 
return
‡‡ 
string
‡‡ !
.
‡‡! "
Empty
‡‡" '
;
‡‡' (
}
ˆˆ 
for
ŒŒ 
(
ŒŒ 
int
ŒŒ 
i
ŒŒ 
=
ŒŒ 
$num
ŒŒ 
;
ŒŒ 
i
ŒŒ  !
<
ŒŒ" #
data
ŒŒ$ (
.
ŒŒ( )
Length
ŒŒ) /
;
ŒŒ/ 0
i
ŒŒ1 2
++
ŒŒ2 4
)
ŒŒ4 5
{
 
val
 
.
 
Append
 
(
 
$str
 "
)
" #
;
# $
val
 
.
 
Append
 
(
 
data
 #
[
# $
i
$ %
]
% &
.
& '
ToString
' /
(
/ 0
$str
0 4
)
4 5
)
5 6
;
6 7
}
 
if
’’ 
(
’’ 
val
’’ 
.
’’ 
Length
’’ 
>
’’  
$num
’’! "
)
’’" #
{
““ 
val
”” 
.
”” 
Remove
”” 
(
”” 
$num
””  
,
””  !
$num
””" #
)
””# $
;
””$ %
}
•• 
return
™™ 
val
™™ 
.
™™ 
ToString
™™ #
(
™™# $
)
™™$ %
;
™™% &
}
šš 
catch
›› 
(
›› 
	Exception
›› 
ex
›› 
)
››  
{
œœ 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
ŸŸ 
{
   
val
¡¡ 
=
¡¡ 
null
¡¡ 
;
¡¡ 
}
¢¢ 
return
££ 
string
££ 
.
££ 
Empty
££ 
;
££  
}
¤¤ 	
public
¨¨ 
static
¨¨ 
string
¨¨ 
toString
¨¨ %
(
¨¨% &
byte
©© 
	byteValue
©© 
)
ªª 
{
«« 	
string
¬¬ 
s
¬¬ 
=
¬¬ 
string
¬¬ 
.
¬¬ 
Empty
¬¬ #
;
¬¬# $
try
®® 
{
¯¯ 
if
°° 
(
°° 
	byteValue
°° 
==
°°  

FAsciiByte
°°! +
.
°°+ ,
LF
°°, .
)
°°. /
{
±± 
s
²² 
=
²² 
$str
²² 
;
²² 
}
³³ 
else
´´ 
if
´´ 
(
´´ 
	byteValue
´´ "
==
´´# %

FAsciiByte
´´& 0
.
´´0 1
CR
´´1 3
)
´´3 4
{
µµ 
s
¶¶ 
=
¶¶ 
$str
¶¶ 
;
¶¶ 
}
·· 
else
¸¸ 
if
¸¸ 
(
¸¸ 
	byteValue
¸¸ "
==
¸¸# %

FAsciiByte
¸¸& 0
.
¸¸0 1
SP
¸¸1 3
)
¸¸3 4
{
¹¹ 
s
ºº 
=
ºº 
$str
ºº 
;
ºº 
}
»» 
else
¼¼ 
{
½½ 
s
¾¾ 
=
¾¾ 
Encoding
¾¾  
.
¾¾  !
Default
¾¾! (
.
¾¾( )
	GetString
¾¾) 2
(
¾¾2 3
new
¾¾3 6
byte
¾¾7 ;
[
¾¾; <
]
¾¾< =
{
¾¾> ?
	byteValue
¾¾@ I
}
¾¾J K
)
¾¾K L
;
¾¾L M
}
¿¿ 
return
ÁÁ 
s
ÁÁ 
;
ÁÁ 
}
ÂÂ 
catch
ÃÃ 
(
ÃÃ 
	Exception
ÃÃ 
ex
ÃÃ 
)
ÃÃ  
{
ÄÄ 
FDebug
ÅÅ 
.
ÅÅ 
throwException
ÅÅ %
(
ÅÅ% &
ex
ÅÅ& (
)
ÅÅ( )
;
ÅÅ) *
}
ÆÆ 
finally
ÇÇ 
{
ÈÈ 
}
ÊÊ 
return
ËË 
string
ËË 
.
ËË 
Empty
ËË 
;
ËË  
}
ÌÌ 	
}
ÒÒ 
}ÓÓ «
vD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\SerialToEthernet\Common\c_FConstants.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSerialToEthernet -
{ 
internal 
static 
class 

FConstants $
{ 
public 
const 
string 

err_m_0015 &
=' (
$str) >
;> ?
public## 
const## 
string## 

err_m_0016## &
=##' (
$str##) B
;##B C
public** 
const** 
string** 

err_m_0027** &
=**' (
$str**) E
;**E F
public11 
const11 
string11 

err_m_003011 &
=11' (
$str11) N
;11N O
}77 
}88 œ
uD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\SerialToEthernet\Common\d_FDelegate.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSerialToEthernet -
{ 
public 

delegate 
void $
FEventRaisedEventHandler 1
(1 2
object2 8
sender9 ?
,? @
FEventArgsBaseA O
eP Q
)Q R
;R S
} 
qD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\SerialToEthernet\Common\e_FEnum.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSerialToEthernet -
{ 
public 

enum 
FConnectMode 
: 
int "
{ 
Active 
, 
Passive 
} 
public 

enum 
FCommunicationState #
:$ %
int& )
{ 
Closed 
, 
Opened 
, 
	Connected 
}!! 
public%% 

enum%% 
FEventId%% 
:%% 
int%% 
{&& 
None'' 
,'' 
SerialStateChanged)) 
,)) 
SerialErrorRaised** 
,** 
SerialDataReceived++ 
,++ 
SerialDataSent,, 
,,, 
SocketStateChanged.. 
,.. 
SocketErrorRaised// 
,// 
SocketTimeoutRaised00 
,00 
SocketDataReceived11 
,11 
SocketDataSent22 
,22  
SocketDataSendFailed33 
,33 
LogMonitoring55 
}66 
public:: 

enum:: 
FResultCode:: 
::: 
int:: !
{;; 
Success<< 
,<< 
Warninig== 
,== 
Error>> 
}?? 
}CC án
yD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\SerialToEthernet\Config\c_FSocketConfig.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSerialToEthernet -
{ 
public 

class 
FSocketConfig 
: 
IDisposable  +
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FSerialToEthernet !
m_fSerialToEthernet" 5
=6 7
null8 <
;< =
private 
FConnectMode 
m_fConnectMode +
=, -
FConnectMode. :
.: ;
Passive; B
;B C
private 
string 
	m_localIp  
=! "
$str# .
;. /
private 
int 
m_localPort 
=  !
$num" &
;& '
private 
string 

m_remoteIp !
=" #
$str$ /
;/ 0
private 
int 
m_remotePort  
=! "
$num# '
;' (
private   
int    
m_retryConnectPeriod   (
=  ) *
$num  + -
;  - .
internal&& 
FSocketConfig&& 
(&& 
FSerialToEthernet'' 
fSerialToEthernet'' /
)(( 
{)) 	
m_fSerialToEthernet** 
=**  !
fSerialToEthernet**" 3
;**3 4
}++ 	
~// 	
FSocketConfig//	 
(// 
)00 
{11 	
	myDispose22 
(22 
false22 
)22 
;22 
}33 	
	protected77 
void77 
	myDispose77  
(77  !
bool88 
	disposing88 
)99 
{:: 	
if;; 
(;; 
!;; 

m_disposed;; 
);; 
{<< 
if== 
(== 
	disposing== 
)== 
{>> 
m_fSerialToEthernet?? '
=??( )
null??* .
;??. /
}@@ 

m_disposedBB 
=BB 
trueBB !
;BB! "
}CC 
}DD 	
publicLL 
voidLL 
DisposeLL 
(LL 
)MM 
{NN 	
	myDisposeOO 
(OO 
trueOO 
)OO 
;OO 
GCPP 
.PP 
SuppressFinalizePP 
(PP  
thisPP  $
)PP$ %
;PP% &
}QQ 	
publicYY 
FConnectModeYY 
fConnectModeYY (
{ZZ 	
get[[ 
{\\ 
try]] 
{^^ 
return__ 
m_fConnectMode__ )
;__) *
}`` 
catchaa 
(aa 
	Exceptionaa  
exaa! #
)aa# $
{bb 
FDebugcc 
.cc 
throwExceptioncc )
(cc) *
excc* ,
)cc, -
;cc- .
}dd 
finallyee 
{ff 
}hh 
returnii 
FConnectModeii #
.ii# $
Passiveii$ +
;ii+ ,
}jj 
setll 
{mm 
trynn 
{oo 
validateStatepp !
(pp! "
)pp" #
;pp# $
m_fConnectModerr "
=rr# $
valuerr% *
;rr* +
}ss 
catchtt 
(tt 
	Exceptiontt  
extt! #
)tt# $
{uu 
FDebugvv 
.vv 
throwExceptionvv )
(vv) *
exvv* ,
)vv, -
;vv- .
}ww 
finallyxx 
{yy 
}{{ 
}|| 
}}} 	
public
 
string
 
localIp
 
{
‚‚ 	
get
ƒƒ 
{
„„ 
try
…… 
{
†† 
return
‡‡ 
	m_localIp
‡‡ $
;
‡‡$ %
}
ˆˆ 
catch
‰‰ 
(
‰‰ 
	Exception
‰‰  
ex
‰‰! #
)
‰‰# $
{
ŠŠ 
FDebug
‹‹ 
.
‹‹ 
throwException
‹‹ )
(
‹‹) *
ex
‹‹* ,
)
‹‹, -
;
‹‹- .
}
ŒŒ 
finally
 
{
 
}
 
return
‘‘ 
string
‘‘ 
.
‘‘ 
Empty
‘‘ #
;
‘‘# $
}
’’ 
set
”” 
{
•• 
try
–– 
{
—— 
validateState
˜˜ !
(
˜˜! "
)
˜˜" #
;
˜˜# $
if
šš 
(
šš 
value
šš 
.
šš 
Trim
šš "
(
šš" #
)
šš# $
==
šš% '
string
šš( .
.
šš. /
Empty
šš/ 4
)
šš4 5
{
›› 
FDebug
œœ 
.
œœ 
throwFException
œœ .
(
œœ. /
string
œœ/ 5
.
œœ5 6
Format
œœ6 <
(
œœ< =

FConstants
œœ= G
.
œœG H

err_m_0015
œœH R
,
œœR S
$str
œœT ^
)
œœ^ _
)
œœ_ `
;
œœ` a
}
 
	m_localIp
ŸŸ 
=
ŸŸ 
value
ŸŸ  %
;
ŸŸ% &
}
   
catch
¡¡ 
(
¡¡ 
	Exception
¡¡  
ex
¡¡! #
)
¡¡# $
{
¢¢ 
FDebug
££ 
.
££ 
throwException
££ )
(
££) *
ex
££* ,
)
££, -
;
££- .
}
¤¤ 
finally
¥¥ 
{
¦¦ 
}
¨¨ 
}
©© 
}
ªª 	
public
®® 
int
®® 
	localPort
®® 
{
¯¯ 	
get
°° 
{
±± 
try
²² 
{
³³ 
return
´´ 
m_localPort
´´ &
;
´´& '
}
µµ 
catch
¶¶ 
(
¶¶ 
	Exception
¶¶  
ex
¶¶! #
)
¶¶# $
{
·· 
FDebug
¸¸ 
.
¸¸ 
throwException
¸¸ )
(
¸¸) *
ex
¸¸* ,
)
¸¸, -
;
¸¸- .
}
¹¹ 
finally
ºº 
{
»» 
}
½½ 
return
¾¾ 
$num
¾¾ 
;
¾¾ 
}
¿¿ 
set
ÁÁ 
{
ÂÂ 
try
ÃÃ 
{
ÄÄ 
validateState
ÅÅ !
(
ÅÅ! "
)
ÅÅ" #
;
ÅÅ# $
if
ÇÇ 
(
ÇÇ 
value
ÇÇ 
<
ÇÇ 
$num
ÇÇ  !
||
ÇÇ" $
value
ÇÇ% *
>
ÇÇ+ ,
$num
ÇÇ- 2
)
ÇÇ2 3
{
ÈÈ 
FDebug
ÉÉ 
.
ÉÉ 
throwFException
ÉÉ .
(
ÉÉ. /
string
ÉÉ/ 5
.
ÉÉ5 6
Format
ÉÉ6 <
(
ÉÉ< =

FConstants
ÉÉ= G
.
ÉÉG H

err_m_0015
ÉÉH R
,
ÉÉR S
$str
ÉÉT `
)
ÉÉ` a
)
ÉÉa b
;
ÉÉb c
}
ÊÊ 
m_localPort
ÌÌ 
=
ÌÌ  !
value
ÌÌ" '
;
ÌÌ' (
}
ÍÍ 
catch
ÎÎ 
(
ÎÎ 
	Exception
ÎÎ  
ex
ÎÎ! #
)
ÎÎ# $
{
ÏÏ 
FDebug
ĞĞ 
.
ĞĞ 
throwException
ĞĞ )
(
ĞĞ) *
ex
ĞĞ* ,
)
ĞĞ, -
;
ĞĞ- .
}
ÑÑ 
finally
ÒÒ 
{
ÓÓ 
}
ÕÕ 
}
ÖÖ 
}
×× 	
public
ÛÛ 
string
ÛÛ 
remoteIp
ÛÛ 
{
ÜÜ 	
get
İİ 
{
ŞŞ 
try
ßß 
{
àà 
return
áá 

m_remoteIp
áá %
;
áá% &
}
ââ 
catch
ãã 
(
ãã 
	Exception
ãã  
ex
ãã! #
)
ãã# $
{
ää 
FDebug
åå 
.
åå 
throwException
åå )
(
åå) *
ex
åå* ,
)
åå, -
;
åå- .
}
ææ 
finally
çç 
{
èè 
}
êê 
return
ëë 
string
ëë 
.
ëë 
Empty
ëë #
;
ëë# $
}
ìì 
set
îî 
{
ïï 
try
ğğ 
{
ññ 
validateState
òò !
(
òò! "
)
òò" #
;
òò# $
if
ôô 
(
ôô 
value
ôô 
.
ôô 
Trim
ôô "
(
ôô" #
)
ôô# $
==
ôô% '
string
ôô( .
.
ôô. /
Empty
ôô/ 4
)
ôô4 5
{
õõ 
FDebug
öö 
.
öö 
throwFException
öö .
(
öö. /
string
öö/ 5
.
öö5 6
Format
öö6 <
(
öö< =

FConstants
öö= G
.
ööG H

err_m_0015
ööH R
,
ööR S
$str
ööT _
)
öö_ `
)
öö` a
;
ööa b
}
÷÷ 

m_remoteIp
ùù 
=
ùù  
value
ùù! &
;
ùù& '
}
úú 
catch
ûû 
(
ûû 
	Exception
ûû  
ex
ûû! #
)
ûû# $
{
üü 
FDebug
ıı 
.
ıı 
throwException
ıı )
(
ıı) *
ex
ıı* ,
)
ıı, -
;
ıı- .
}
şş 
finally
ÿÿ 
{
€€ 
}
‚‚ 
}
ƒƒ 
}
„„ 	
public
ˆˆ 
int
ˆˆ 

remotePort
ˆˆ 
{
‰‰ 	
get
ŠŠ 
{
‹‹ 
try
ŒŒ 
{
 
return
 
m_remotePort
 '
;
' (
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
‘‘ 
FDebug
’’ 
.
’’ 
throwException
’’ )
(
’’) *
ex
’’* ,
)
’’, -
;
’’- .
}
““ 
finally
”” 
{
•• 
}
—— 
return
˜˜ 
$num
˜˜ 
;
˜˜ 
}
™™ 
set
›› 
{
œœ 
try
 
{
 
validateState
ŸŸ !
(
ŸŸ! "
)
ŸŸ" #
;
ŸŸ# $
if
¡¡ 
(
¡¡ 
value
¡¡ 
<
¡¡ 
$num
¡¡  !
||
¡¡" $
value
¡¡% *
>
¡¡+ ,
$num
¡¡- 2
)
¡¡2 3
{
¢¢ 
FDebug
££ 
.
££ 
throwFException
££ .
(
££. /
string
££/ 5
.
££5 6
Format
££6 <
(
££< =

FConstants
££= G
.
££G H

err_m_0015
££H R
,
££R S
$str
££T a
)
££a b
)
££b c
;
££c d
}
¤¤ 
m_remotePort
¦¦  
=
¦¦! "
value
¦¦# (
;
¦¦( )
}
§§ 
catch
¨¨ 
(
¨¨ 
	Exception
¨¨  
ex
¨¨! #
)
¨¨# $
{
©© 
FDebug
ªª 
.
ªª 
throwException
ªª )
(
ªª) *
ex
ªª* ,
)
ªª, -
;
ªª- .
}
«« 
finally
¬¬ 
{
­­ 
}
¯¯ 
}
°° 
}
±± 	
public
µµ 
int
µµ  
retryConnectPeriod
µµ %
{
¶¶ 	
get
·· 
{
¸¸ 
try
¹¹ 
{
ºº 
return
»» "
m_retryConnectPeriod
»» /
;
»»/ 0
}
¼¼ 
catch
½½ 
(
½½ 
	Exception
½½  
ex
½½! #
)
½½# $
{
¾¾ 
FDebug
¿¿ 
.
¿¿ 
throwException
¿¿ )
(
¿¿) *
ex
¿¿* ,
)
¿¿, -
;
¿¿- .
}
ÀÀ 
finally
ÁÁ 
{
ÂÂ 
}
ÄÄ 
return
ÅÅ 
$num
ÅÅ 
;
ÅÅ 
}
ÆÆ 
set
ÈÈ 
{
ÉÉ 
try
ÊÊ 
{
ËË 
validateState
ÌÌ !
(
ÌÌ! "
)
ÌÌ" #
;
ÌÌ# $
if
ÎÎ 
(
ÎÎ 
value
ÎÎ 
<
ÎÎ 
$num
ÎÎ  !
||
ÎÎ" $
value
ÎÎ% *
>
ÎÎ+ ,
$num
ÎÎ- 0
)
ÎÎ0 1
{
ÏÏ 
FDebug
ĞĞ 
.
ĞĞ 
throwFException
ĞĞ .
(
ĞĞ. /
string
ĞĞ/ 5
.
ĞĞ5 6
Format
ĞĞ6 <
(
ĞĞ< =

FConstants
ĞĞ= G
.
ĞĞG H

err_m_0015
ĞĞH R
,
ĞĞR S
$str
ĞĞT `
)
ĞĞ` a
)
ĞĞa b
;
ĞĞb c
}
ÑÑ "
m_retryConnectPeriod
ÓÓ (
=
ÓÓ) *
value
ÓÓ+ 0
;
ÓÓ0 1
}
ÔÔ 
catch
ÕÕ 
(
ÕÕ 
	Exception
ÕÕ  
ex
ÕÕ! #
)
ÕÕ# $
{
ÖÖ 
FDebug
×× 
.
×× 
throwException
×× )
(
××) *
ex
××* ,
)
××, -
;
××- .
}
ØØ 
finally
ÙÙ 
{
ÚÚ 
}
ÜÜ 
}
İİ 
}
ŞŞ 	
private
ææ 
void
ææ 
validateState
ææ "
(
ææ" #
)
çç 
{
èè 	
try
éé 
{
êê 
if
ëë 
(
ëë !
m_fSerialToEthernet
ëë '
.
ëë' (
fSocketState
ëë( 4
!=
ëë5 7!
FCommunicationState
ëë8 K
.
ëëK L
Closed
ëëL R
)
ëëR S
{
ìì 
FDebug
íí 
.
íí 
throwFException
íí *
(
íí* +
string
íí+ 1
.
íí1 2
Format
íí2 8
(
íí8 9

FConstants
íí9 C
.
ííC D

err_m_0027
ííD N
,
ííN O
$str
ííP ]
)
íí] ^
)
íí^ _
;
íí_ `
}
îî 
}
ïï 
catch
ğğ 
(
ğğ 
	Exception
ğğ 
ex
ğğ 
)
ğğ  
{
ññ 
FDebug
òò 
.
òò 
throwException
òò %
(
òò% &
ex
òò& (
)
òò( )
;
òò) *
}
óó 
finally
ôô 
{
õõ 
}
÷÷ 
}
øø 	
}
şş 
}ÿÿ Åj
D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\SerialToEthernet\Config\c_FSerialPluginConfig.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSerialToEthernet -
{ 
public 

class 
FSerialPluginConfig $
:$ %
IDisposable& 1
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FSerialToEthernet !
m_fSerialToTcp" 0
=1 2
null3 7
;7 8
private 
string 
m_serialPort #
=$ %
$str& ,
;, -
private 
int 
m_baud 
= 
$num !
;! "
private 
StopBits 

m_stopBits #
=$ %
StopBits& .
.. /
One/ 2
;2 3
private 
int 

m_dataBits 
=  
$num! "
;" #
private   
Parity   
m_parity   
=    !
Parity  " (
.  ( )
None  ) -
;  - .
private!! 
byte!! 
[!! 
]!! 
m_prefix!! 
=!!  !
null!!" &
;!!& '
private"" 
byte"" 
["" 
]"" 
m_suffix"" 
=""  !
null""" &
;""& '
internal(( 
FSerialPluginConfig(( $
((($ %
FSerialToEthernet)) 
fSerialToEthernet)) /
)** 
{++ 	
m_fSerialToTcp,, 
=,, 
fSerialToEthernet,, .
;,,. /
}-- 	
~11 	
FSerialPluginConfig11	 
(11 
)22 
{33 	
	myDispose44 
(44 
false44 
)44 
;44 
}55 	
	protected99 
void99 
	myDispose99  
(99  !
bool:: 
	disposing:: 
);; 
{<< 	
if== 
(== 
!== 

m_disposed== 
)== 
{>> 
if?? 
(?? 
	disposing?? 
)?? 
{@@ 
m_fSerialToTcpAA "
=AA# $
nullAA% )
;AA) *
}BB 

m_disposedDD 
=DD 
trueDD !
;DD! "
}EE 
}FF 	
publicNN 
voidNN 
DisposeNN 
(NN 
)OO 
{PP 	
	myDisposeQQ 
(QQ 
trueQQ 
)QQ 
;QQ 
GCRR 
.RR 
SuppressFinalizeRR 
(RR  
thisRR  $
)RR$ %
;RR% &
}SS 	
public[[ 
string[[ 

serialPort[[  
{\\ 	
get]] 
{^^ 
try__ 
{`` 
returnaa 
m_serialPortaa '
;aa' (
}bb 
catchcc 
(cc 
	Exceptioncc  
excc! #
)cc# $
{dd 
FDebugee 
.ee 
throwExceptionee )
(ee) *
exee* ,
)ee, -
;ee- .
}ff 
finallygg 
{hh 
}jj 
returnkk 
stringkk 
.kk 
Emptykk #
;kk# $
}ll 
setnn 
{oo 
trypp 
{qq 
validateStaterr !
(rr! "
)rr" #
;rr# $
iftt 
(tt 
valuett 
.tt 
Trimtt "
(tt" #
)tt# $
==tt% '
stringtt( .
.tt. /
Emptytt/ 4
)tt4 5
{uu 
FDebugvv 
.vv 
throwFExceptionvv .
(vv. /
stringvv/ 5
.vv5 6
Formatvv6 <
(vv< =

FConstantsvv= G
.vvG H

err_m_0015vvH R
,vvR S
$strvvT a
)vva b
)vvb c
;vvc d
}ww 
m_serialPortyy  
=yy! "
valueyy# (
;yy( )
}zz 
catch{{ 
({{ 
	Exception{{  
ex{{! #
){{# $
{|| 
FDebug}} 
.}} 
throwException}} )
(}}) *
ex}}* ,
)}}, -
;}}- .
}~~ 
finally 
{
€€ 
}
‚‚ 
}
ƒƒ 
}
„„ 	
public
ˆˆ 
int
ˆˆ 
baud
ˆˆ 
{
‰‰ 	
get
ŠŠ 
{
‹‹ 
try
ŒŒ 
{
 
return
 
m_baud
 !
;
! "
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
‘‘ 
FDebug
’’ 
.
’’ 
throwException
’’ )
(
’’) *
ex
’’* ,
)
’’, -
;
’’- .
}
““ 
finally
”” 
{
•• 
}
—— 
return
˜˜ 
$num
˜˜ 
;
˜˜ 
}
™™ 
set
›› 
{
œœ 
try
 
{
 
validateState
ŸŸ !
(
ŸŸ! "
)
ŸŸ" #
;
ŸŸ# $
if
¡¡ 
(
¡¡ 
value
¡¡ 
<
¡¡ 
$num
¡¡  !
)
¡¡! "
{
¢¢ 
FDebug
££ 
.
££ 
throwFException
££ .
(
££. /
string
££/ 5
.
££5 6
Format
££6 <
(
££< =

FConstants
££= G
.
££G H

err_m_0015
££H R
,
££R S
$str
££T Z
)
££Z [
)
££[ \
;
££\ ]
}
¤¤ 
m_baud
¦¦ 
=
¦¦ 
value
¦¦ "
;
¦¦" #
}
§§ 
catch
¨¨ 
(
¨¨ 
	Exception
¨¨  
ex
¨¨! #
)
¨¨# $
{
©© 
FDebug
ªª 
.
ªª 
throwException
ªª )
(
ªª) *
ex
ªª* ,
)
ªª, -
;
ªª- .
}
«« 
finally
¬¬ 
{
­­ 
}
¯¯ 
}
°° 
}
±± 	
public
µµ 
StopBits
µµ 
stopBits
µµ  
{
¶¶ 	
get
·· 
{
¸¸ 
try
¹¹ 
{
ºº 
return
»» 

m_stopBits
»» %
;
»»% &
}
¼¼ 
catch
½½ 
(
½½ 
	Exception
½½  
ex
½½! #
)
½½# $
{
¾¾ 
FDebug
¿¿ 
.
¿¿ 
throwException
¿¿ )
(
¿¿) *
ex
¿¿* ,
)
¿¿, -
;
¿¿- .
}
ÀÀ 
finally
ÁÁ 
{
ÂÂ 
}
ÄÄ 
return
ÅÅ 
StopBits
ÅÅ 
.
ÅÅ  
One
ÅÅ  #
;
ÅÅ# $
}
ÆÆ 
set
ÈÈ 
{
ÉÉ 
try
ÊÊ 
{
ËË 
validateState
ÌÌ !
(
ÌÌ! "
)
ÌÌ" #
;
ÌÌ# $

m_stopBits
ÎÎ 
=
ÎÎ  
value
ÎÎ! &
;
ÎÎ& '
}
ÏÏ 
catch
ĞĞ 
(
ĞĞ 
	Exception
ĞĞ  
ex
ĞĞ! #
)
ĞĞ# $
{
ÑÑ 
FDebug
ÒÒ 
.
ÒÒ 
throwException
ÒÒ )
(
ÒÒ) *
ex
ÒÒ* ,
)
ÒÒ, -
;
ÒÒ- .
}
ÓÓ 
finally
ÔÔ 
{
ÕÕ 
}
×× 
}
ØØ 
}
ÙÙ 	
public
İİ 
int
İİ 
dataBits
İİ 
{
ŞŞ 	
get
ßß 
{
àà 
try
áá 
{
ââ 
return
ãã 

m_dataBits
ãã %
;
ãã% &
}
ää 
catch
åå 
(
åå 
	Exception
åå  
ex
åå! #
)
åå# $
{
ææ 
FDebug
çç 
.
çç 
throwException
çç )
(
çç) *
ex
çç* ,
)
çç, -
;
çç- .
}
èè 
finally
éé 
{
êê 
}
ìì 
return
íí 
$num
íí 
;
íí 
}
îî 
set
ğğ 
{
ññ 
try
òò 
{
óó 
validateState
ôô !
(
ôô! "
)
ôô" #
;
ôô# $

m_dataBits
öö 
=
öö  
value
öö! &
;
öö& '
}
÷÷ 
catch
øø 
(
øø 
	Exception
øø  
ex
øø! #
)
øø# $
{
ùù 
FDebug
úú 
.
úú 
throwException
úú )
(
úú) *
ex
úú* ,
)
úú, -
;
úú- .
}
ûû 
finally
üü 
{
ıı 
}
ÿÿ 
}
€€ 
}
 	
public
…… 
Parity
…… 
parity
…… 
{
†† 	
get
‡‡ 
{
ˆˆ 
try
‰‰ 
{
ŠŠ 
return
‹‹ 
m_parity
‹‹ #
;
‹‹# $
}
ŒŒ 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
‘‘ 
{
’’ 
}
”” 
return
•• 
Parity
•• 
.
•• 
None
•• "
;
••" #
}
–– 
set
˜˜ 
{
™™ 
try
šš 
{
›› 
validateState
œœ !
(
œœ! "
)
œœ" #
;
œœ# $
m_parity
 
=
 
value
 $
;
$ %
}
ŸŸ 
catch
   
(
   
	Exception
    
ex
  ! #
)
  # $
{
¡¡ 
FDebug
¢¢ 
.
¢¢ 
throwException
¢¢ )
(
¢¢) *
ex
¢¢* ,
)
¢¢, -
;
¢¢- .
}
££ 
finally
¤¤ 
{
¥¥ 
}
§§ 
}
¨¨ 
}
©© 	
public
­­ 
byte
­­ 
[
­­ 
]
­­ 
prefix
­­ 
{
®® 	
get
¯¯ 
{
°° 
try
±± 
{
²² 
return
³³ 
m_prefix
³³ #
;
³³# $
}
´´ 
catch
µµ 
(
µµ 
	Exception
µµ  
ex
µµ! #
)
µµ# $
{
¶¶ 
FDebug
·· 
.
·· 
throwException
·· )
(
··) *
ex
··* ,
)
··, -
;
··- .
}
¸¸ 
finally
¹¹ 
{
ºº 
}
¼¼ 
return
½½ 
null
½½ 
;
½½ 
}
¾¾ 
set
ÀÀ 
{
ÁÁ 
try
ÂÂ 
{
ÃÃ 
m_prefix
ÄÄ 
=
ÄÄ 
value
ÄÄ $
;
ÄÄ$ %
}
ÅÅ 
catch
ÆÆ 
(
ÆÆ 
	Exception
ÆÆ  
ex
ÆÆ! #
)
ÆÆ# $
{
ÇÇ 
FDebug
ÈÈ 
.
ÈÈ 
throwException
ÈÈ )
(
ÈÈ) *
ex
ÈÈ* ,
)
ÈÈ, -
;
ÈÈ- .
}
ÉÉ 
finally
ÊÊ 
{
ËË 
}
ÍÍ 
}
ÎÎ 
}
ÏÏ 	
public
ÓÓ 
byte
ÓÓ 
[
ÓÓ 
]
ÓÓ 
suffix
ÓÓ 
{
ÔÔ 	
get
ÕÕ 
{
ÖÖ 
try
×× 
{
ØØ 
return
ÙÙ 
m_suffix
ÙÙ #
;
ÙÙ# $
}
ÚÚ 
catch
ÛÛ 
(
ÛÛ 
	Exception
ÛÛ  
ex
ÛÛ! #
)
ÛÛ# $
{
ÜÜ 
FDebug
İİ 
.
İİ 
throwException
İİ )
(
İİ) *
ex
İİ* ,
)
İİ, -
;
İİ- .
}
ŞŞ 
finally
ßß 
{
àà 
}
ââ 
return
ãã 
null
ãã 
;
ãã 
}
ää 
set
ææ 
{
çç 
try
èè 
{
éé 
m_suffix
êê 
=
êê 
value
êê $
;
êê$ %
}
ëë 
catch
ìì 
(
ìì 
	Exception
ìì  
ex
ìì! #
)
ìì# $
{
íí 
FDebug
îî 
.
îî 
throwException
îî )
(
îî) *
ex
îî* ,
)
îî, -
;
îî- .
}
ïï 
finally
ğğ 
{
ññ 
}
óó 
}
ôô 
}
õõ 	
private
ıı 
void
ıı 
validateState
ıı "
(
ıı" #
)
şş 
{
ÿÿ 	
try
€€ 
{
 
if
‚‚ 
(
‚‚ 
m_fSerialToTcp
‚‚ "
.
‚‚" #
fSerialState
‚‚# /
!=
‚‚0 2!
FCommunicationState
‚‚3 F
.
‚‚F G
Closed
‚‚G M
)
‚‚M N
{
ƒƒ 
FDebug
„„ 
.
„„ 
throwFException
„„ *
(
„„* +
string
„„+ 1
.
„„1 2
Format
„„2 8
(
„„8 9

FConstants
„„9 C
.
„„C D

err_m_0027
„„D N
,
„„N O
$str
„„P Z
)
„„Z [
)
„„[ \
;
„„\ ]
}
…… 
}
†† 
catch
‡‡ 
(
‡‡ 
	Exception
‡‡ 
ex
‡‡ 
)
‡‡  
{
ˆˆ 
FDebug
‰‰ 
.
‰‰ 
throwException
‰‰ %
(
‰‰% &
ex
‰‰& (
)
‰‰( )
;
‰‰) *
}
ŠŠ 
finally
‹‹ 
{
ŒŒ 
}
 
}
 	
}
•• 
}–– ÿ¥
vD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\SerialToEthernet\c_FSerialToEthernet.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSerialToEthernet -
{ 
public 

class 
FSerialToEthernet "
:" #
IDisposable$ /
{ 
public 
event $
FEventRaisedEventHandler -
EventRaised. 9
=: ;
null< @
;@ A
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
bool 
m_logEnabled !
=" #
false$ )
;) *
private   
string   
m_logDirectory   %
=  & '
string  ( .
.  . /
Empty  / 4
;  4 5
private!! 
string!! 
m_logFileNameSuffix!! *
=!!+ ,
string!!- 3
.!!3 4
Empty!!4 9
;!!9 :
private"" 
int"" 
m_logFileMaxSize"" $
=""% &
$num""' (
;""( )
private## 
bool## "
m_logMonitoringEnabled## +
=##, -
false##. 3
;##3 4
private%% 
FCommunicationState%% #
m_fSerialState%%$ 2
=%%3 4
FCommunicationState%%5 H
.%%H I
Closed%%I O
;%%O P
private&& 
FCommunicationState&& #
m_fSocketState&&$ 2
=&&3 4
FCommunicationState&&5 H
.&&H I
Closed&&I O
;&&O P
private'' 
FSerialPluginConfig'' #
m_fSerialConfig''$ 3
=''4 5
null''6 :
;'': ;
private(( 
FSocketConfig(( 
m_fSocketConfig(( -
=((. /
null((0 4
;((4 5
private)) 
FEventPusher)) 
m_fEventPusher)) +
=)), -
null)). 2
;))2 3
private** 
FSerialPlugin** 
	m_fSerial** '
=**( )
null*** .
;**. /
private++ 
FBaseTcp++ 
m_fTcp++ 
=++  !
null++" &
;++& '
private,, 

FLogWriter,, 
m_fLogWriter,, '
=,,( )
null,,* .
;,,. /
public22 
FSerialToEthernet22  
(22  !
string33 
licFileName33 
)44 
{55 	
validateLicense66 
(66 
licFileName66 '
)66' (
;66( )
init:: 
(:: 
):: 
;:: 
};; 	
~?? 	
FSerialToEthernet??	 
(?? 
)@@ 
{AA 	
	myDisposeBB 
(BB 
falseBB 
)BB 
;BB 
}CC 	
	protectedGG 
voidGG 
	myDisposeGG  
(GG  !
boolHH 
	disposingHH 
)II 
{JJ 	
ifKK 
(KK 
!KK 

m_disposedKK 
)KK 
{LL 
ifMM 
(MM 
	disposingMM 
)MM 
{NN 
termOO 
(OO 
)OO 
;OO 
}PP 

m_disposedRR 
=RR 
trueRR !
;RR! "
}SS 
}TT 	
public\\ 
void\\ 
Dispose\\ 
(\\ 
)]] 
{^^ 	
	myDispose__ 
(__ 
true__ 
)__ 
;__ 
GC`` 
.`` 
SuppressFinalize`` 
(``  
this``  $
)``$ %
;``% &
}aa 	
publicii 
FSerialPluginConfigii "
fSerialConfigii# 0
{jj 	
getkk 
{ll 
trymm 
{nn 
returnoo 
m_fSerialConfigoo *
;oo* +
}pp 
catchqq 
(qq 
	Exceptionqq  
exqq! #
)qq# $
{rr 
FDebugss 
.ss 
throwExceptionss )
(ss) *
exss* ,
)ss, -
;ss- .
}tt 
finallyuu 
{vv 
}xx 
returnyy 
nullyy 
;yy 
}zz 
}{{ 	
public 
FSocketConfig 
fSocketConfig *
{
€€ 	
get
 
{
‚‚ 
try
ƒƒ 
{
„„ 
return
…… 
m_fSocketConfig
…… *
;
……* +
}
†† 
catch
‡‡ 
(
‡‡ 
	Exception
‡‡  
ex
‡‡! #
)
‡‡# $
{
ˆˆ 
FDebug
‰‰ 
.
‰‰ 
throwException
‰‰ )
(
‰‰) *
ex
‰‰* ,
)
‰‰, -
;
‰‰- .
}
ŠŠ 
finally
‹‹ 
{
ŒŒ 
}
 
return
 
null
 
;
 
}
 
}
‘‘ 	
public
•• !
FCommunicationState
•• "
fSerialState
••# /
{
–– 	
get
—— 
{
˜˜ 
try
™™ 
{
šš 
return
›› 
m_fSerialState
›› )
;
››) *
}
œœ 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
ŸŸ 
.
ŸŸ 
throwException
ŸŸ )
(
ŸŸ) *
ex
ŸŸ* ,
)
ŸŸ, -
;
ŸŸ- .
}
   
finally
¡¡ 
{
¢¢ 
}
¤¤ 
return
¥¥ !
FCommunicationState
¥¥ *
.
¥¥* +
Closed
¥¥+ 1
;
¥¥1 2
}
¦¦ 
}
§§ 	
public
«« !
FCommunicationState
«« "
fSocketState
««# /
{
¬¬ 	
get
­­ 
{
®® 
try
¯¯ 
{
°° 
return
±± 
m_fSocketState
±± )
;
±±) *
}
²² 
catch
³³ 
(
³³ 
	Exception
³³  
ex
³³! #
)
³³# $
{
´´ 
FDebug
µµ 
.
µµ 
throwException
µµ )
(
µµ) *
ex
µµ* ,
)
µµ, -
;
µµ- .
}
¶¶ 
finally
·· 
{
¸¸ 
}
ºº 
return
»» !
FCommunicationState
»» *
.
»»* +
Closed
»»+ 1
;
»»1 2
}
¼¼ 
}
½½ 	
internal
ÁÁ 
FEventPusher
ÁÁ 
fEventPusher
ÁÁ *
{
ÂÂ 	
get
ÃÃ 
{
ÄÄ 
try
ÅÅ 
{
ÆÆ 
return
ÇÇ 
m_fEventPusher
ÇÇ )
;
ÇÇ) *
}
ÈÈ 
catch
ÉÉ 
(
ÉÉ 
	Exception
ÉÉ  
ex
ÉÉ! #
)
ÉÉ# $
{
ÊÊ 
FDebug
ËË 
.
ËË 
throwException
ËË )
(
ËË) *
ex
ËË* ,
)
ËË, -
;
ËË- .
}
ÌÌ 
finally
ÍÍ 
{
ÎÎ 
}
ĞĞ 
return
ÑÑ 
null
ÑÑ 
;
ÑÑ 
}
ÒÒ 
}
ÓÓ 	
public
×× 
bool
×× 

logEnabled
×× 
{
ØØ 	
get
ÙÙ 
{
ÚÚ 
try
ÛÛ 
{
ÜÜ 
return
İİ 
m_logEnabled
İİ '
;
İİ' (
}
ŞŞ 
catch
ßß 
(
ßß 
	Exception
ßß  
ex
ßß! #
)
ßß# $
{
àà 
FDebug
áá 
.
áá 
throwException
áá )
(
áá) *
ex
áá* ,
)
áá, -
;
áá- .
}
ââ 
finally
ãã 
{
ää 
}
ææ 
return
çç 
false
çç 
;
çç 
}
èè 
set
êê 
{
ëë 
try
ìì 
{
íí 
m_logEnabled
îî  
=
îî! "
value
îî# (
;
îî( )
}
ïï 
catch
ğğ 
(
ğğ 
	Exception
ğğ  
ex
ğğ! #
)
ğğ# $
{
ññ 
FDebug
òò 
.
òò 
throwException
òò )
(
òò) *
ex
òò* ,
)
òò, -
;
òò- .
}
óó 
finally
ôô 
{
õõ 
}
÷÷ 
}
øø 
}
ùù 	
public
ıı 
string
ıı 
logDirectory
ıı "
{
şş 	
get
ÿÿ 
{
€€ 
try
 
{
‚‚ 
return
ƒƒ 
m_logDirectory
ƒƒ )
;
ƒƒ) *
}
„„ 
catch
…… 
(
…… 
	Exception
……  
ex
……! #
)
……# $
{
†† 
FDebug
‡‡ 
.
‡‡ 
throwException
‡‡ )
(
‡‡) *
ex
‡‡* ,
)
‡‡, -
;
‡‡- .
}
ˆˆ 
finally
‰‰ 
{
ŠŠ 
}
ŒŒ 
return
 
string
 
.
 
Empty
 #
;
# $
}
 
set
 
{
‘‘ 
try
’’ 
{
““ 
m_logDirectory
”” "
=
””# $
value
””% *
;
””* +
}
•• 
catch
–– 
(
–– 
	Exception
––  
ex
––! #
)
––# $
{
—— 
FDebug
˜˜ 
.
˜˜ 
throwException
˜˜ )
(
˜˜) *
ex
˜˜* ,
)
˜˜, -
;
˜˜- .
}
™™ 
finally
šš 
{
›› 
}
 
}
 
}
ŸŸ 	
public
££ 
string
££ 
logFileNameSuffix
££ '
{
¤¤ 	
get
¥¥ 
{
¦¦ 
try
§§ 
{
¨¨ 
return
©© !
m_logFileNameSuffix
©© .
;
©©. /
}
ªª 
catch
«« 
(
«« 
	Exception
««  
ex
««! #
)
««# $
{
¬¬ 
FDebug
­­ 
.
­­ 
throwException
­­ )
(
­­) *
ex
­­* ,
)
­­, -
;
­­- .
}
®® 
finally
¯¯ 
{
°° 
}
²² 
return
³³ 
string
³³ 
.
³³ 
Empty
³³ #
;
³³# $
}
´´ 
set
¶¶ 
{
·· 
try
¸¸ 
{
¹¹ !
m_logFileNameSuffix
ºº '
=
ºº( )
value
ºº* /
;
ºº/ 0
}
»» 
catch
¼¼ 
(
¼¼ 
	Exception
¼¼  
ex
¼¼! #
)
¼¼# $
{
½½ 
FDebug
¾¾ 
.
¾¾ 
throwException
¾¾ )
(
¾¾) *
ex
¾¾* ,
)
¾¾, -
;
¾¾- .
}
¿¿ 
finally
ÀÀ 
{
ÁÁ 
}
ÃÃ 
}
ÄÄ 
}
ÅÅ 	
public
ÉÉ 
int
ÉÉ 
logFileMaxSize
ÉÉ !
{
ÊÊ 	
get
ËË 
{
ÌÌ 
try
ÍÍ 
{
ÎÎ 
return
ÏÏ 
m_logFileMaxSize
ÏÏ +
;
ÏÏ+ ,
}
ĞĞ 
catch
ÑÑ 
(
ÑÑ 
	Exception
ÑÑ  
ex
ÑÑ! #
)
ÑÑ# $
{
ÒÒ 
FDebug
ÓÓ 
.
ÓÓ 
throwException
ÓÓ )
(
ÓÓ) *
ex
ÓÓ* ,
)
ÓÓ, -
;
ÓÓ- .
}
ÔÔ 
finally
ÕÕ 
{
ÖÖ 
}
ØØ 
return
ÙÙ 
$num
ÙÙ 
;
ÙÙ 
}
ÚÚ 
set
ÜÜ 
{
İİ 
try
ŞŞ 
{
ßß 
m_logFileMaxSize
àà $
=
àà% &
value
àà' ,
;
àà, -
}
áá 
catch
ââ 
(
ââ 
	Exception
ââ  
ex
ââ! #
)
ââ# $
{
ãã 
FDebug
ää 
.
ää 
throwException
ää )
(
ää) *
ex
ää* ,
)
ää, -
;
ää- .
}
åå 
finally
ææ 
{
çç 
}
éé 
}
êê 
}
ëë 	
public
ïï 
bool
ïï "
logMonitoringEnabled
ïï (
{
ğğ 	
get
ññ 
{
òò 
try
óó 
{
ôô 
return
õõ $
m_logMonitoringEnabled
õõ 1
;
õõ1 2
}
öö 
catch
÷÷ 
(
÷÷ 
	Exception
÷÷  
ex
÷÷! #
)
÷÷# $
{
øø 
FDebug
ùù 
.
ùù 
throwException
ùù )
(
ùù) *
ex
ùù* ,
)
ùù, -
;
ùù- .
}
úú 
finally
ûû 
{
üü 
}
şş 
return
ÿÿ 
false
ÿÿ 
;
ÿÿ 
}
€€ 
set
‚‚ 
{
ƒƒ 
try
„„ 
{
…… $
m_logMonitoringEnabled
†† *
=
††+ ,
value
††- 2
;
††2 3
}
‡‡ 
catch
ˆˆ 
(
ˆˆ 
	Exception
ˆˆ  
ex
ˆˆ! #
)
ˆˆ# $
{
‰‰ 
FDebug
ŠŠ 
.
ŠŠ 
throwException
ŠŠ )
(
ŠŠ) *
ex
ŠŠ* ,
)
ŠŠ, -
;
ŠŠ- .
}
‹‹ 
finally
ŒŒ 
{
 
}
 
}
 
}
‘‘ 	
private
™™ 
void
™™ 
validateLicense
™™ $
(
™™$ %
string
šš 
fileName
šš 
)
›› 
{
œœ 	
FLic2License
   
fLic
   
=
   
null
    $
;
  $ %
	FLic2Info
¡¡ 
fLicInfo
¡¡ 
=
¡¡  
null
¡¡! %
;
¡¡% &
try
££ 
{
¤¤ 
fLic
¥¥ 
=
¥¥ 
new
¥¥ 
FLic2License
¥¥ '
(
¥¥' (
)
¥¥( )
;
¥¥) *
fLicInfo
¦¦ 
=
¦¦ 
fLic
¦¦ 
.
¦¦  
validate
¦¦  (
(
¦¦( )
fileName
¦¦) 1
)
¦¦1 2
;
¦¦2 3
if
­­ 
(
­­ 
fLicInfo
­­ 
.
­­ 

fLicS2hCvt
­­ '
.
­­' (
productEnabled
­­( 6
==
­­7 9
FYesNo
­­: @
.
­­@ A
No
­­A C
)
­­C D
{
®® 
fLic
¯¯ 
.
¯¯ "
rasieValidationError
¯¯ -
(
¯¯- .
$str
¯¯. ?
)
¯¯? @
;
¯¯@ A
}
°° 
if
·· 
(
·· 
fLicInfo
·· 
.
·· 

fLicS2hCvt
·· '
.
··' (
expireIssuedCheck
··( 9
==
··: <
FYesNo
··= C
.
··C D
Yes
··D G
&&
··H J
!
··K L
fLic
··L P
.
··P Q%
validateExpireIssueDate
··Q h
(
··h i
fLicInfo
··i q
.
··q r

fLicS2hCvt
··r |
.
··| }
expireIssuedDate··} 
)·· 
)·· 
{
¸¸ 
fLic
¹¹ 
.
¹¹ "
rasieValidationError
¹¹ -
(
¹¹- .
$str
¹¹. B
)
¹¹B C
;
¹¹C D
}
ºº 
}
»» 
catch
¼¼ 
(
¼¼ 
	Exception
¼¼ 
ex
¼¼ 
)
¼¼  
{
½½ 
FDebug
¾¾ 
.
¾¾ 
throwException
¾¾ %
(
¾¾% &
ex
¾¾& (
)
¾¾( )
;
¾¾) *
}
¿¿ 
finally
ÀÀ 
{
ÁÁ 
if
ÂÂ 
(
ÂÂ 
fLic
ÂÂ 
!=
ÂÂ 
null
ÂÂ  
)
ÂÂ  !
{
ÃÃ 
fLic
ÄÄ 
.
ÄÄ 
Dispose
ÄÄ  
(
ÄÄ  !
)
ÄÄ! "
;
ÄÄ" #
fLic
ÅÅ 
=
ÅÅ 
null
ÅÅ 
;
ÅÅ  
}
ÆÆ 
if
ÈÈ 
(
ÈÈ 
fLicInfo
ÈÈ 
!=
ÈÈ 
null
ÈÈ  $
)
ÈÈ$ %
{
ÉÉ 
fLicInfo
ÊÊ 
.
ÊÊ 
Dispose
ÊÊ $
(
ÊÊ$ %
)
ÊÊ% &
;
ÊÊ& '
fLicInfo
ËË 
=
ËË 
null
ËË #
;
ËË# $
}
ÌÌ 
}
ÍÍ 
}
ÎÎ 	
private
ÒÒ 
void
ÒÒ 
init
ÒÒ 
(
ÒÒ 
)
ÓÓ 
{
ÔÔ 	
try
ÕÕ 
{
ÖÖ 
m_logDirectory
×× 
=
××  
Application
××! ,
.
××, -
StartupPath
××- 8
+
××9 :
$str
××; B
;
××B C!
m_logFileNameSuffix
ØØ #
=
ØØ$ %
$str
ØØ& 8
;
ØØ8 9
m_logFileMaxSize
ÙÙ  
=
ÙÙ! "
$num
ÙÙ# $
;
ÙÙ$ %
m_fLogWriter
İİ 
=
İİ 
new
İİ "

FLogWriter
İİ# -
(
İİ- .
this
İİ. 2
)
İİ2 3
;
İİ3 4
m_fSerialConfig
ää 
=
ää  !
new
ää" %!
FSerialPluginConfig
ää& 9
(
ää9 :
this
ää: >
)
ää> ?
;
ää? @
m_fSocketConfig
åå 
=
åå  !
new
åå" %
FSocketConfig
åå& 3
(
åå3 4
this
åå4 8
)
åå8 9
;
åå9 :
m_fEventPusher
éé 
=
éé  
new
éé! $
FEventPusher
éé% 1
(
éé1 2
this
éé2 6
)
éé6 7
;
éé7 8
}
êê 
catch
ëë 
(
ëë 
	Exception
ëë 
ex
ëë 
)
ëë  
{
ìì 
FDebug
íí 
.
íí 
throwException
íí %
(
íí% &
ex
íí& (
)
íí( )
;
íí) *
}
îî 
finally
ïï 
{
ğğ 
}
òò 
}
óó 	
private
÷÷ 
void
÷÷ 
term
÷÷ 
(
÷÷ 
)
øø 
{
ùù 	
try
úú 
{
ûû 
closeAll
üü 
(
üü 
)
üü 
;
üü 
if
€€ 
(
€€ 
m_fEventPusher
€€ "
!=
€€# %
null
€€& *
)
€€* +
{
 
m_fEventPusher
‚‚ "
.
‚‚" #
Dispose
‚‚# *
(
‚‚* +
)
‚‚+ ,
;
‚‚, -
m_fEventPusher
ƒƒ "
=
ƒƒ# $
null
ƒƒ% )
;
ƒƒ) *
}
„„ 
if
ˆˆ 
(
ˆˆ 
m_fSerialConfig
ˆˆ #
!=
ˆˆ$ &
null
ˆˆ' +
)
ˆˆ+ ,
{
‰‰ 
m_fSerialConfig
ŠŠ #
.
ŠŠ# $
Dispose
ŠŠ$ +
(
ŠŠ+ ,
)
ŠŠ, -
;
ŠŠ- .
m_fSerialConfig
‹‹ #
=
‹‹$ %
null
‹‹& *
;
‹‹* +
}
ŒŒ 
if
 
(
 
m_fSocketConfig
 #
!=
$ &
null
' +
)
+ ,
{
 
m_fSocketConfig
 #
.
# $
Dispose
$ +
(
+ ,
)
, -
;
- .
m_fSocketConfig
 #
=
$ %
null
& *
;
* +
}
‘‘ 
if
•• 
(
•• 
m_fLogWriter
••  
!=
••! #
null
••$ (
)
••( )
{
–– 
m_fLogWriter
——  
.
——  !
Dispose
——! (
(
——( )
)
——) *
;
——* +
m_fLogWriter
˜˜  
=
˜˜! "
null
˜˜# '
;
˜˜' (
}
™™ 
}
šš 
catch
›› 
(
›› 
	Exception
›› 
ex
›› 
)
››  
{
œœ 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
ŸŸ 
{
   
}
¢¢ 
}
££ 	
public
§§ 
void
§§ 

openSerial
§§ 
(
§§ 
)
¨¨ 
{
©© 	
try
ªª 
{
«« 
if
¬¬ 
(
¬¬ 
m_fSerialState
¬¬ "
!=
¬¬# %!
FCommunicationState
¬¬& 9
.
¬¬9 :
Closed
¬¬: @
)
¬¬@ A
{
­­ 
return
®® 
;
®® 
}
¯¯ 
	m_fSerial
³³ 
=
³³ 
new
³³ 
FSerialPlugin
³³  -
(
³³- .
this
³³. 2
)
³³2 3
;
³³3 4
	m_fSerial
´´ 
.
´´ 
open
´´ 
(
´´ 
)
´´  
;
´´  !
}
µµ 
catch
¶¶ 
(
¶¶ 
	Exception
¶¶ 
ex
¶¶ 
)
¶¶  
{
·· 
if
¸¸ 
(
¸¸ 
	m_fSerial
¸¸ 
!=
¸¸  
null
¸¸! %
)
¸¸% &
{
¹¹ 
	m_fSerial
ºº 
.
ºº 
Dispose
ºº %
(
ºº% &
)
ºº& '
;
ºº' (
	m_fSerial
»» 
=
»» 
null
»»  $
;
»»$ %
}
¼¼ 
FDebug
½½ 
.
½½ 
throwException
½½ %
(
½½% &
ex
½½& (
)
½½( )
;
½½) *
}
¾¾ 
finally
¿¿ 
{
ÀÀ 
}
ÂÂ 
}
ÃÃ 	
public
ÇÇ 
void
ÇÇ 

openSocket
ÇÇ 
(
ÇÇ 
)
ÈÈ 
{
ÉÉ 	
try
ÊÊ 
{
ËË 
if
ÌÌ 
(
ÌÌ 
m_fSocketState
ÌÌ "
!=
ÌÌ# %!
FCommunicationState
ÌÌ& 9
.
ÌÌ9 :
Closed
ÌÌ: @
)
ÌÌ@ A
{
ÍÍ 
return
ÎÎ 
;
ÎÎ 
}
ÏÏ 
if
ÓÓ 
(
ÓÓ 
m_fSocketConfig
ÓÓ #
.
ÓÓ# $
fConnectMode
ÓÓ$ 0
==
ÓÓ1 3
FConnectMode
ÓÓ4 @
.
ÓÓ@ A
Passive
ÓÓA H
)
ÓÓH I
{
ÔÔ 
m_fTcp
ÕÕ 
=
ÕÕ 
new
ÕÕ  
FTcpPassive
ÕÕ! ,
(
ÕÕ, -
this
ÕÕ- 1
)
ÕÕ1 2
;
ÕÕ2 3
}
ÖÖ 
else
×× 
{
ØØ 
m_fTcp
ÙÙ 
=
ÙÙ 
new
ÙÙ  

FTcpActive
ÙÙ! +
(
ÙÙ+ ,
this
ÙÙ, 0
)
ÙÙ0 1
;
ÙÙ1 2
}
ÚÚ 
m_fTcp
ÜÜ 
.
ÜÜ 
open
ÜÜ 
(
ÜÜ 
)
ÜÜ 
;
ÜÜ 
}
İİ 
catch
ŞŞ 
(
ŞŞ 
	Exception
ŞŞ 
ex
ŞŞ 
)
ŞŞ  
{
ßß 
if
àà 
(
àà 
m_fTcp
àà 
!=
àà 
null
àà "
)
àà" #
{
áá 
m_fTcp
ââ 
.
ââ 
Dispose
ââ "
(
ââ" #
)
ââ# $
;
ââ$ %
m_fTcp
ãã 
=
ãã 
null
ãã !
;
ãã! "
}
ää 
FDebug
åå 
.
åå 
throwException
åå %
(
åå% &
ex
åå& (
)
åå( )
;
åå) *
}
ææ 
finally
çç 
{
èè 
}
êê 
}
ëë 	
public
ïï 
void
ïï 
closeSerial
ïï 
(
ïï  
)
ğğ 
{
ññ 	
try
òò 
{
óó 
if
ôô 
(
ôô 
m_fSerialState
ôô "
==
ôô# %!
FCommunicationState
ôô& 9
.
ôô9 :
Closed
ôô: @
)
ôô@ A
{
õõ 
return
öö 
;
öö 
}
÷÷ 
if
ûû 
(
ûû 
	m_fSerial
ûû 
!=
ûû  
null
ûû! %
)
ûû% &
{
üü 
	m_fSerial
ıı 
.
ıı 
close
ıı #
(
ıı# $
)
ıı$ %
;
ıı% &
	m_fSerial
şş 
.
şş 
Dispose
şş %
(
şş% &
)
şş& '
;
şş' (
	m_fSerial
ÿÿ 
=
ÿÿ 
null
ÿÿ  $
;
ÿÿ$ %
}
€€ 
}
 
catch
‚‚ 
(
‚‚ 
	Exception
‚‚ 
ex
‚‚ 
)
‚‚  
{
ƒƒ 
FDebug
„„ 
.
„„ 
throwException
„„ %
(
„„% &
ex
„„& (
)
„„( )
;
„„) *
}
…… 
finally
†† 
{
‡‡ 
}
‰‰ 
}
ŠŠ 	
public
 
void
 
closeTcp
 
(
 
)
 
{
 	
try
‘‘ 
{
’’ 
if
““ 
(
““ 
m_fSocketState
““ "
==
““# %!
FCommunicationState
““& 9
.
““9 :
Closed
““: @
)
““@ A
{
”” 
return
•• 
;
•• 
}
–– 
if
šš 
(
šš 
m_fTcp
šš 
!=
šš 
null
šš "
)
šš" #
{
›› 
m_fTcp
œœ 
.
œœ 
close
œœ  
(
œœ  !
)
œœ! "
;
œœ" #
m_fTcp
 
.
 
Dispose
 "
(
" #
)
# $
;
$ %
m_fTcp
 
=
 
null
 !
;
! "
}
ŸŸ 
}
   
catch
¡¡ 
(
¡¡ 
	Exception
¡¡ 
ex
¡¡ 
)
¡¡  
{
¢¢ 
FDebug
££ 
.
££ 
throwException
££ %
(
££% &
ex
££& (
)
££( )
;
££) *
}
¤¤ 
finally
¥¥ 
{
¦¦ 
}
¨¨ 
}
©© 	
public
­­ 
void
­­ 
openAll
­­ 
(
­­ 
)
®® 
{
¯¯ 	
try
°° 
{
±± 

openSerial
²² 
(
²² 
)
²² 
;
²² 

openSocket
³³ 
(
³³ 
)
³³ 
;
³³ 
}
´´ 
catch
µµ 
(
µµ 
	Exception
µµ 
ex
µµ 
)
µµ  
{
¶¶ 
FDebug
·· 
.
·· 
throwException
·· %
(
··% &
ex
··& (
)
··( )
;
··) *
}
¸¸ 
finally
¹¹ 
{
ºº 
}
¼¼ 
}
½½ 	
public
ÁÁ 
void
ÁÁ 
closeAll
ÁÁ 
(
ÁÁ 
)
ÂÂ 
{
ÃÃ 	
try
ÄÄ 
{
ÅÅ 
closeTcp
ÆÆ 
(
ÆÆ 
)
ÆÆ 
;
ÆÆ 
closeSerial
ÇÇ 
(
ÇÇ 
)
ÇÇ 
;
ÇÇ 
}
ÈÈ 
catch
ÉÉ 
(
ÉÉ 
	Exception
ÉÉ 
ex
ÉÉ 
)
ÉÉ  
{
ÊÊ 
FDebug
ËË 
.
ËË 
throwException
ËË %
(
ËË% &
ex
ËË& (
)
ËË( )
;
ËË) *
}
ÌÌ 
finally
ÍÍ 
{
ÎÎ 
}
ĞĞ 
}
ÑÑ 	
internal
ÕÕ 
void
ÕÕ 
changeSerialState
ÕÕ '
(
ÕÕ' (!
FCommunicationState
ÖÖ 
fState
ÖÖ  &
,
ÖÖ& '
string
×× 

serialPort
×× 
,
×× 
int
ØØ 
baud
ØØ 
)
ÙÙ 
{
ÚÚ 	
try
ÛÛ 
{
ÜÜ 
if
İİ 
(
İİ 
m_fSerialState
İİ "
==
İİ# %
fState
İİ& ,
)
İİ, -
{
ŞŞ 
return
ßß 
;
ßß 
}
àà 
m_fSerialState
áá 
=
áá  
fState
áá! '
;
áá' (
m_fEventPusher
åå 
.
åå 
pushSerialEvent
åå .
(
åå. /
new
ææ 0
"FSerialPluginStateChangedEventArgs
ææ :
(
ææ: ;
this
çç 
,
çç 
FEventId
èè  
.
èè  ! 
SerialStateChanged
èè! 3
,
èè3 4
FResultCode
éé #
.
éé# $
Success
éé$ +
,
éé+ ,
string
êê 
.
êê 
Empty
êê $
,
êê$ %
fState
ëë 
,
ëë 

serialPort
ìì "
,
ìì" #
baud
íí 
)
îî 
)
ïï 
;
ïï 
}
ğğ 
catch
ññ 
(
ññ 
	Exception
ññ 
ex
ññ 
)
ññ  
{
òò 
FDebug
óó 
.
óó 
throwException
óó %
(
óó% &
ex
óó& (
)
óó( )
;
óó) *
}
ôô 
finally
õõ 
{
öö 
}
øø 
}
ùù 	
internal
ıı 
void
ıı 
changeTcpState
ıı $
(
ıı$ %!
FCommunicationState
şş 
fState
şş  &
,
şş& '
FConnectMode
ÿÿ 
fConnectMode
ÿÿ %
,
ÿÿ% &
string
€€ 
localIp
€€ 
,
€€ 
int
 
	localPort
 
,
 
string
‚‚ 
remoteIp
‚‚ 
,
‚‚ 
int
ƒƒ 

remotePort
ƒƒ 
)
„„ 
{
…… 	
try
†† 
{
‡‡ 
if
ˆˆ 
(
ˆˆ 
m_fSocketState
ˆˆ "
==
ˆˆ# %
fState
ˆˆ& ,
)
ˆˆ, -
{
‰‰ 
return
ŠŠ 
;
ŠŠ 
}
‹‹ 
m_fSocketState
ŒŒ 
=
ŒŒ  
fState
ŒŒ! '
;
ŒŒ' (
m_fEventPusher
 
.
 
pushTcpEvent
 +
(
+ ,
new
‘‘ *
FSocketStateChangedEventArgs
‘‘ 4
(
‘‘4 5
this
’’ 
,
’’ 
FEventId
““  
.
““  ! 
SocketStateChanged
““! 3
,
““3 4
FResultCode
”” #
.
””# $
Success
””$ +
,
””+ ,
string
•• 
.
•• 
Empty
•• $
,
••$ %
fState
–– 
,
–– 
fConnectMode
—— $
,
——$ %
localIp
˜˜ 
,
˜˜  
	localPort
™™ !
,
™™! "
remoteIp
šš  
,
šš  !

remotePort
›› "
)
œœ 
)
 
;
 
}
 
catch
ŸŸ 
(
ŸŸ 
	Exception
ŸŸ 
ex
ŸŸ 
)
ŸŸ  
{
   
FDebug
¡¡ 
.
¡¡ 
throwException
¡¡ %
(
¡¡% &
ex
¡¡& (
)
¡¡( )
;
¡¡) *
}
¢¢ 
finally
££ 
{
¤¤ 
}
¦¦ 
}
§§ 	
private
«« 
void
«« 
sendSerialData
«« #
(
««# $
FSerialSendData
¬¬ 
fSerialSendData
¬¬ +
)
­­ 
{
®® 	
try
¯¯ 
{
°° 
if
±± 
(
±± 
this
±± 
.
±± 
fSerialState
±± %
==
±±& (!
FCommunicationState
±±) <
.
±±< =
	Connected
±±= F
)
±±F G
{
²² 
	m_fSerial
³³ 
.
³³ 
send
³³ "
(
³³" #
fSerialSendData
³³# 2
)
³³2 3
;
³³3 4
}
´´ 
else
µµ 
{
¶¶ 
m_fEventPusher
·· "
.
··" #
pushSerialEvent
··# 2
(
··2 3
new
¸¸ ,
FSerialPluginDataSentEventArgs
¸¸ :
(
¸¸: ;
this
¹¹  
,
¹¹  !
FEventId
ºº $
.
ºº$ %
SerialDataSent
ºº% 3
,
ºº3 4
FResultCode
»» '
.
»»' (
Error
»»( -
,
»»- .
string
¼¼ "
.
¼¼" #
Format
¼¼# )
(
¼¼) *

FConstants
¼¼* 4
.
¼¼4 5

err_m_0030
¼¼5 ?
,
¼¼? @
$str
¼¼A I
)
¼¼I J
,
¼¼J K
fSerialSendData
½½ +
)
¾¾ 
)
¿¿ 
;
¿¿ 
}
ÀÀ 
}
ÁÁ 
catch
ÂÂ 
(
ÂÂ 
	Exception
ÂÂ 
ex
ÂÂ 
)
ÂÂ  
{
ÃÃ 
FDebug
ÄÄ 
.
ÄÄ 
throwException
ÄÄ %
(
ÄÄ% &
ex
ÄÄ& (
)
ÄÄ( )
;
ÄÄ) *
}
ÅÅ 
finally
ÆÆ 
{
ÇÇ 
}
ÉÉ 
}
ÊÊ 	
public
ÎÎ 
void
ÎÎ 
sendSerialData
ÎÎ "
(
ÎÎ" #
byte
ÏÏ 
[
ÏÏ 
]
ÏÏ 
data
ÏÏ 
)
ĞĞ 
{
ÑÑ 	
try
ÒÒ 
{
ÓÓ 
sendSerialData
ÔÔ 
(
ÔÔ 
new
ÕÕ 
FSerialSendData
ÕÕ '
(
ÕÕ' (
data
ÕÕ( ,
)
ÕÕ, -
)
ÖÖ 
;
ÖÖ 
}
×× 
catch
ØØ 
(
ØØ 
	Exception
ØØ 
ex
ØØ 
)
ØØ  
{
ÙÙ 
FDebug
ÚÚ 
.
ÚÚ 
throwException
ÚÚ %
(
ÚÚ% &
ex
ÚÚ& (
)
ÚÚ( )
;
ÚÚ) *
}
ÛÛ 
finally
ÜÜ 
{
İİ 
}
ßß 
}
àà 	
private
ää 
void
ää 
sendTcpData
ää  
(
ää  !
FSocketSendData
åå 
fSocketSendData
åå +
)
ææ 
{
çç 	
try
èè 
{
éé 
if
êê 
(
êê 
this
êê 
.
êê 
fSocketState
êê %
==
êê& (!
FCommunicationState
êê) <
.
êê< =
	Connected
êê= F
)
êêF G
{
ëë 
m_fTcp
ìì 
.
ìì 
send
ìì 
(
ìì  
fSocketSendData
ìì  /
)
ìì/ 0
;
ìì0 1
}
íí 
else
îî 
{
ïï 
m_fEventPusher
ğğ "
.
ğğ" #
pushTcpEvent
ğğ# /
(
ğğ/ 0
new
ññ &
FSocketDataSentEventArgs
ññ 4
(
ññ4 5
this
òò  
,
òò  !
FEventId
óó $
.
óó$ %
SocketDataSent
óó% 3
,
óó3 4
FResultCode
ôô '
.
ôô' (
Error
ôô( -
,
ôô- .
string
õõ "
.
õõ" #
Format
õõ# )
(
õõ) *

FConstants
õõ* 4
.
õõ4 5

err_m_0030
õõ5 ?
,
õõ? @
$str
õõA I
)
õõI J
,
õõJ K
fSocketSendData
öö +
)
÷÷ 
)
øø 
;
øø 
}
ùù 
}
úú 
catch
ûû 
(
ûû 
	Exception
ûû 
ex
ûû 
)
ûû  
{
üü 
FDebug
ıı 
.
ıı 
writeLog
ıı 
(
ıı  
ex
ıı  "
)
ıı" #
;
ıı# $
}
şş 
finally
ÿÿ 
{
€€ 
}
‚‚ 
}
ƒƒ 	
public
‡‡ 
void
‡‡ 
sendTcpData
‡‡ 
(
‡‡  '
FSerialPluginDataTransfer
ˆˆ %!
fSerialDataTransfer
ˆˆ& 9
)
‰‰ 
{
ŠŠ 	
try
‹‹ 
{
ŒŒ 
sendTcpData
 
(
 !
fSerialDataTransfer
 /
.
/ 0
getSerialData
0 =
(
= >
)
> ?
)
? @
;
@ A
}
 
catch
 
(
 
	Exception
 
ex
 
)
  
{
 
FDebug
‘‘ 
.
‘‘ 
throwException
‘‘ %
(
‘‘% &
ex
‘‘& (
)
‘‘( )
;
‘‘) *
}
’’ 
finally
““ 
{
”” 
}
–– 
}
—— 	
internal
›› 
void
›› 
onEventRaised
›› #
(
››# $
FEventArgsBase
œœ 
fArgs
œœ  
)
 
{
 	
try
ŸŸ 
{
   
if
¡¡ 
(
¡¡ 
m_logEnabled
¡¡  
)
¡¡  !
{
¢¢ 
m_fLogWriter
££  
.
££  !
write
££! &
(
££& '
fArgs
££' ,
)
££, -
;
££- .
}
¤¤ 
if
¨¨ 
(
¨¨ 
EventRaised
¨¨ 
!=
¨¨  "
null
¨¨# '
)
¨¨' (
{
©© 
EventRaised
ªª 
(
ªª  
this
ªª  $
,
ªª$ %
fArgs
ªª& +
)
ªª+ ,
;
ªª, -
}
«« 
}
¬¬ 
catch
­­ 
(
­­ 
	Exception
­­ 
ex
­­ 
)
­­  
{
®® 
FDebug
¯¯ 
.
¯¯ 
throwException
¯¯ %
(
¯¯% &
ex
¯¯& (
)
¯¯( )
;
¯¯) *
}
°° 
finally
±± 
{
²² 
}
´´ 
}
µµ 	
public
¹¹ 
void
¹¹ (
waitEventHandlingCompleted
¹¹ .
(
¹¹. /
)
ºº 
{
»» 	
try
¼¼ 
{
½½ 
m_fEventPusher
¾¾ 
.
¾¾ (
waitEventHandlingCompleted
¾¾ 9
(
¾¾9 :
)
¾¾: ;
;
¾¾; <
}
¿¿ 
catch
ÀÀ 
(
ÀÀ 
	Exception
ÀÀ 
ex
ÀÀ 
)
ÀÀ  
{
ÁÁ 
FDebug
ÂÂ 
.
ÂÂ 
throwException
ÂÂ %
(
ÂÂ% &
ex
ÂÂ& (
)
ÂÂ( )
;
ÂÂ) *
}
ÃÃ 
finally
ÄÄ 
{
ÅÅ 
}
ÇÇ 
}
ÈÈ 	
public
ÌÌ 
void
ÌÌ 
writeAppLog
ÌÌ 
(
ÌÌ  
string
ÍÍ 
log
ÍÍ 
)
ÎÎ 
{
ÏÏ 	
try
ĞĞ 
{
ÑÑ 
m_fLogWriter
ÒÒ 
.
ÒÒ 
write
ÒÒ "
(
ÒÒ" #
log
ÒÒ# &
)
ÒÒ& '
;
ÒÒ' (
}
ÓÓ 
catch
ÔÔ 
(
ÔÔ 
	Exception
ÔÔ 
ex
ÔÔ 
)
ÔÔ  
{
ÕÕ 
FDebug
ÖÖ 
.
ÖÖ 
throwException
ÖÖ %
(
ÖÖ% &
ex
ÖÖ& (
)
ÖÖ( )
;
ÖÖ) *
}
×× 
finally
ØØ 
{
ÙÙ 
}
ÛÛ 
}
ÜÜ 	
}
ââ 
}ãã ÷¹
lD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\c_FSecs1ToHsms.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
public 

class 
FSecs1ToHsms 
: 
IDisposable *
{ 
public 
event $
FEventRaisedEventHandler -
EventRaised. 9
=: ;
null< @
;@ A
private 
bool 

m_disposed 
=  !
false" '
;' (
private!! 
bool!! 
m_logEnabled!! !
=!!" #
false!!$ )
;!!) *
private"" 
string"" 
m_logDirectory"" %
=""& '
string""( .
."". /
Empty""/ 4
;""4 5
private## 
string## 
m_logFileNameSuffix## *
=##+ ,
string##- 3
.##3 4
Empty##4 9
;##9 :
private$$ 
int$$ 
m_logFileMaxSize$$ $
=$$% &
$num$$' (
;$$( )
private%% 
bool%% "
m_logMonitoringEnabled%% +
=%%, -
false%%. 3
;%%3 4
private'' 
FCommunicationState'' #
m_fSecs1State''$ 1
=''2 3
FCommunicationState''4 G
.''G H
Closed''H N
;''N O
private(( 
FCommunicationState(( #
m_fHsmsState(($ 0
=((1 2
FCommunicationState((3 F
.((F G
Closed((G M
;((M N
private)) 
FSecs1Config)) 
m_fSecs1Config)) +
=)), -
null)). 2
;))2 3
private** 
FHsmsConfig** 
m_fHsmsConfig** )
=*** +
null**, 0
;**0 1
private++ 
FEventPusher++ 
m_fEventPusher++ +
=++, -
null++. 2
;++2 3
private,, 
FSECS1,, 
m_fSecs1,, 
=,,  !
null,," &
;,,& '
private-- 
	FBaseHsms-- 
m_fHsms-- !
=--" #
null--$ (
;--( )
private.. 

FLogWriter.. 
m_fLogWriter.. '
=..( )
null..* .
;... /
private// 
FIDPointer32// !
m_fSystemBytesPointer// 2
=//3 4
null//5 9
;//9 :
private11 

Dictionary11 
<11 
string11 !
,11! "$
FInterceptingDataMessage11# ;
>11; <,
 m_fSecs1InterceptingDataMessages11= ]
=11^ _
null11` d
;11d e
private22 

Dictionary22 
<22 
string22 !
,22! "$
FInterceptingDataMessage22# ;
>22; <+
m_fHsmsInterceptingDataMessages22= \
=22] ^
null22_ c
;22c d
public88 
FSecs1ToHsms88 
(88 
string99 
licFileName99 
):: 
{;; 	
validateLicense<< 
(<< 
licFileName<< '
)<<' (
;<<( )
init@@ 
(@@ 
)@@ 
;@@ 
}AA 	
~EE 	
FSecs1ToHsmsEE	 
(EE 
)FF 
{GG 	
	myDisposeHH 
(HH 
falseHH 
)HH 
;HH 
}II 	
	protectedMM 
voidMM 
	myDisposeMM  
(MM  !
boolNN 
	disposingNN 
)OO 
{PP 	
ifQQ 
(QQ 
!QQ 

m_disposedQQ 
)QQ 
{RR 
ifSS 
(SS 
	disposingSS 
)SS 
{TT 
termUU 
(UU 
)UU 
;UU 
}VV 

m_disposedXX 
=XX 
trueXX !
;XX! "
}YY 
}ZZ 	
publicbb 
voidbb 
Disposebb 
(bb 
)cc 
{dd 	
	myDisposeee 
(ee 
trueee 
)ee 
;ee 
GCff 
.ff 
SuppressFinalizeff 
(ff  
thisff  $
)ff$ %
;ff% &
}gg 	
publicoo 
FSecs1Configoo 
fSecs1Configoo (
{pp 	
getqq 
{rr 
tryss 
{tt 
returnuu 
m_fSecs1Configuu )
;uu) *
}vv 
catchww 
(ww 
	Exceptionww  
exww! #
)ww# $
{xx 
FDebugyy 
.yy 
throwExceptionyy )
(yy) *
exyy* ,
)yy, -
;yy- .
}zz 
finally{{ 
{|| 
}~~ 
return 
null 
; 
}
€€ 
}
 	
public
…… 
FHsmsConfig
…… 
fHsmsConfig
…… &
{
†† 	
get
‡‡ 
{
ˆˆ 
try
‰‰ 
{
ŠŠ 
return
‹‹ 
m_fHsmsConfig
‹‹ (
;
‹‹( )
}
ŒŒ 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
‘‘ 
{
’’ 
}
”” 
return
•• 
null
•• 
;
•• 
}
–– 
}
—— 	
public
›› !
FCommunicationState
›› "
fSecs1State
››# .
{
œœ 	
get
 
{
 
try
ŸŸ 
{
   
return
¡¡ 
m_fSecs1State
¡¡ (
;
¡¡( )
}
¢¢ 
catch
££ 
(
££ 
	Exception
££  
ex
££! #
)
££# $
{
¤¤ 
FDebug
¥¥ 
.
¥¥ 
throwException
¥¥ )
(
¥¥) *
ex
¥¥* ,
)
¥¥, -
;
¥¥- .
}
¦¦ 
finally
§§ 
{
¨¨ 
}
ªª 
return
«« !
FCommunicationState
«« *
.
««* +
Closed
««+ 1
;
««1 2
}
¬¬ 
}
­­ 	
public
±± !
FCommunicationState
±± "

fHsmsState
±±# -
{
²² 	
get
³³ 
{
´´ 
try
µµ 
{
¶¶ 
return
·· 
m_fHsmsState
·· '
;
··' (
}
¸¸ 
catch
¹¹ 
(
¹¹ 
	Exception
¹¹  
ex
¹¹! #
)
¹¹# $
{
ºº 
FDebug
»» 
.
»» 
throwException
»» )
(
»») *
ex
»»* ,
)
»», -
;
»»- .
}
¼¼ 
finally
½½ 
{
¾¾ 
}
ÀÀ 
return
ÁÁ !
FCommunicationState
ÁÁ *
.
ÁÁ* +
Closed
ÁÁ+ 1
;
ÁÁ1 2
}
ÂÂ 
}
ÃÃ 	
internal
ÇÇ 
FEventPusher
ÇÇ 
fEventPusher
ÇÇ *
{
ÈÈ 	
get
ÉÉ 
{
ÊÊ 
try
ËË 
{
ÌÌ 
return
ÍÍ 
m_fEventPusher
ÍÍ )
;
ÍÍ) *
}
ÎÎ 
catch
ÏÏ 
(
ÏÏ 
	Exception
ÏÏ  
ex
ÏÏ! #
)
ÏÏ# $
{
ĞĞ 
FDebug
ÑÑ 
.
ÑÑ 
throwException
ÑÑ )
(
ÑÑ) *
ex
ÑÑ* ,
)
ÑÑ, -
;
ÑÑ- .
}
ÒÒ 
finally
ÓÓ 
{
ÔÔ 
}
ÖÖ 
return
×× 
null
×× 
;
×× 
}
ØØ 
}
ÙÙ 	
public
İİ 
bool
İİ 

logEnabled
İİ 
{
ŞŞ 	
get
ßß 
{
àà 
try
áá 
{
ââ 
return
ãã 
m_logEnabled
ãã '
;
ãã' (
}
ää 
catch
åå 
(
åå 
	Exception
åå  
ex
åå! #
)
åå# $
{
ææ 
FDebug
çç 
.
çç 
throwException
çç )
(
çç) *
ex
çç* ,
)
çç, -
;
çç- .
}
èè 
finally
éé 
{
êê 
}
ìì 
return
íí 
false
íí 
;
íí 
}
îî 
set
ğğ 
{
ññ 
try
òò 
{
óó 
m_logEnabled
ôô  
=
ôô! "
value
ôô# (
;
ôô( )
}
õõ 
catch
öö 
(
öö 
	Exception
öö  
ex
öö! #
)
öö# $
{
÷÷ 
FDebug
øø 
.
øø 
throwException
øø )
(
øø) *
ex
øø* ,
)
øø, -
;
øø- .
}
ùù 
finally
úú 
{
ûû 
}
ıı 
}
şş 
}
ÿÿ 	
public
ƒƒ 
string
ƒƒ 
logDirectory
ƒƒ "
{
„„ 	
get
…… 
{
†† 
try
‡‡ 
{
ˆˆ 
return
‰‰ 
m_logDirectory
‰‰ )
;
‰‰) *
}
ŠŠ 
catch
‹‹ 
(
‹‹ 
	Exception
‹‹  
ex
‹‹! #
)
‹‹# $
{
ŒŒ 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
 
{
 
}
’’ 
return
““ 
string
““ 
.
““ 
Empty
““ #
;
““# $
}
”” 
set
–– 
{
—— 
try
˜˜ 
{
™™ 
m_logDirectory
šš "
=
šš# $
value
šš% *
;
šš* +
}
›› 
catch
œœ 
(
œœ 
	Exception
œœ  
ex
œœ! #
)
œœ# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
ŸŸ 
finally
   
{
¡¡ 
}
££ 
}
¤¤ 
}
¥¥ 	
public
©© 
string
©© 
logFileNameSuffix
©© '
{
ªª 	
get
«« 
{
¬¬ 
try
­­ 
{
®® 
return
¯¯ !
m_logFileNameSuffix
¯¯ .
;
¯¯. /
}
°° 
catch
±± 
(
±± 
	Exception
±±  
ex
±±! #
)
±±# $
{
²² 
FDebug
³³ 
.
³³ 
throwException
³³ )
(
³³) *
ex
³³* ,
)
³³, -
;
³³- .
}
´´ 
finally
µµ 
{
¶¶ 
}
¸¸ 
return
¹¹ 
string
¹¹ 
.
¹¹ 
Empty
¹¹ #
;
¹¹# $
}
ºº 
set
¼¼ 
{
½½ 
try
¾¾ 
{
¿¿ !
m_logFileNameSuffix
ÀÀ '
=
ÀÀ( )
value
ÀÀ* /
;
ÀÀ/ 0
}
ÁÁ 
catch
ÂÂ 
(
ÂÂ 
	Exception
ÂÂ  
ex
ÂÂ! #
)
ÂÂ# $
{
ÃÃ 
FDebug
ÄÄ 
.
ÄÄ 
throwException
ÄÄ )
(
ÄÄ) *
ex
ÄÄ* ,
)
ÄÄ, -
;
ÄÄ- .
}
ÅÅ 
finally
ÆÆ 
{
ÇÇ 
}
ÉÉ 
}
ÊÊ 
}
ËË 	
public
ÏÏ 
int
ÏÏ 
logFileMaxSize
ÏÏ !
{
ĞĞ 	
get
ÑÑ 
{
ÒÒ 
try
ÓÓ 
{
ÔÔ 
return
ÕÕ 
m_logFileMaxSize
ÕÕ +
;
ÕÕ+ ,
}
ÖÖ 
catch
×× 
(
×× 
	Exception
××  
ex
××! #
)
××# $
{
ØØ 
FDebug
ÙÙ 
.
ÙÙ 
throwException
ÙÙ )
(
ÙÙ) *
ex
ÙÙ* ,
)
ÙÙ, -
;
ÙÙ- .
}
ÚÚ 
finally
ÛÛ 
{
ÜÜ 
}
ŞŞ 
return
ßß 
$num
ßß 
;
ßß 
}
àà 
set
ââ 
{
ãã 
try
ää 
{
åå 
m_logFileMaxSize
ææ $
=
ææ% &
value
ææ' ,
;
ææ, -
}
çç 
catch
èè 
(
èè 
	Exception
èè  
ex
èè! #
)
èè# $
{
éé 
FDebug
êê 
.
êê 
throwException
êê )
(
êê) *
ex
êê* ,
)
êê, -
;
êê- .
}
ëë 
finally
ìì 
{
íí 
}
ïï 
}
ğğ 
}
ññ 	
public
õõ 
bool
õõ "
logMonitoringEnabled
õõ (
{
öö 	
get
÷÷ 
{
øø 
try
ùù 
{
úú 
return
ûû $
m_logMonitoringEnabled
ûû 1
;
ûû1 2
}
üü 
catch
ıı 
(
ıı 
	Exception
ıı  
ex
ıı! #
)
ıı# $
{
şş 
FDebug
ÿÿ 
.
ÿÿ 
throwException
ÿÿ )
(
ÿÿ) *
ex
ÿÿ* ,
)
ÿÿ, -
;
ÿÿ- .
}
€€ 
finally
 
{
‚‚ 
}
„„ 
return
…… 
false
…… 
;
…… 
}
†† 
set
ˆˆ 
{
‰‰ 
try
ŠŠ 
{
‹‹ $
m_logMonitoringEnabled
ŒŒ *
=
ŒŒ+ ,
value
ŒŒ- 2
;
ŒŒ2 3
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
‘‘ 
finally
’’ 
{
““ 
}
•• 
}
–– 
}
—— 	
public
›› 
int
›› /
!secs1InterceptingDataMessageCount
›› 4
{
œœ 	
get
 
{
 
try
ŸŸ 
{
   
return
¡¡ .
 m_fSecs1InterceptingDataMessages
¡¡ ;
.
¡¡; <
Count
¡¡< A
;
¡¡A B
}
¢¢ 
catch
££ 
(
££ 
	Exception
££  
ex
££! #
)
££# $
{
¤¤ 
FDebug
¥¥ 
.
¥¥ 
throwException
¥¥ )
(
¥¥) *
ex
¥¥* ,
)
¥¥, -
;
¥¥- .
}
¦¦ 
finally
§§ 
{
¨¨ 
}
ªª 
return
«« 
$num
«« 
;
«« 
}
¬¬ 
}
­­ 	
public
±± 
int
±± .
 hsmsInterceptingDataMessageCount
±± 3
{
²² 	
get
³³ 
{
´´ 
try
µµ 
{
¶¶ 
return
·· -
m_fHsmsInterceptingDataMessages
·· :
.
··: ;
Count
··; @
;
··@ A
}
¸¸ 
catch
¹¹ 
(
¹¹ 
	Exception
¹¹  
ex
¹¹! #
)
¹¹# $
{
ºº 
FDebug
»» 
.
»» 
throwException
»» )
(
»») *
ex
»»* ,
)
»», -
;
»»- .
}
¼¼ 
finally
½½ 
{
¾¾ 
}
ÀÀ 
return
ÁÁ 
$num
ÁÁ 
;
ÁÁ 
}
ÂÂ 
}
ÃÃ 	
internal
ÇÇ 
FIDPointer32
ÇÇ !
fSystemBytesPointer
ÇÇ 1
{
ÈÈ 	
get
ÉÉ 
{
ÊÊ 
try
ËË 
{
ÌÌ 
return
ÍÍ #
m_fSystemBytesPointer
ÍÍ 0
;
ÍÍ0 1
}
ÎÎ 
catch
ÏÏ 
(
ÏÏ 
	Exception
ÏÏ  
ex
ÏÏ! #
)
ÏÏ# $
{
ĞĞ 
FDebug
ÑÑ 
.
ÑÑ 
throwException
ÑÑ )
(
ÑÑ) *
ex
ÑÑ* ,
)
ÑÑ, -
;
ÑÑ- .
}
ÒÒ 
finally
ÓÓ 
{
ÔÔ 
}
ÖÖ 
return
×× 
null
×× 
;
×× 
}
ØØ 
}
ÙÙ 	
private
áá 
void
áá 
validateLicense
áá $
(
áá$ %
string
ââ 
fileName
ââ 
)
ãã 
{
ää 	
FLic2License
èè 
fLic
èè 
=
èè 
null
èè  $
;
èè$ %
	FLic2Info
éé 
fLicInfo
éé 
=
éé  
null
éé! %
;
éé% &
try
ëë 
{
ìì 
fLic
íí 
=
íí 
new
íí 
FLic2License
íí '
(
íí' (
)
íí( )
;
íí) *
fLicInfo
îî 
=
îî 
fLic
îî 
.
îî  
validate
îî  (
(
îî( )
fileName
îî) 1
)
îî1 2
;
îî2 3
if
õõ 
(
õõ 
fLicInfo
õõ 
.
õõ 

fLicS2hCvt
õõ '
.
õõ' (
productEnabled
õõ( 6
==
õõ7 9
FYesNo
õõ: @
.
õõ@ A
No
õõA C
)
õõC D
{
öö 
fLic
÷÷ 
.
÷÷ "
rasieValidationError
÷÷ -
(
÷÷- .
$str
÷÷. ?
)
÷÷? @
;
÷÷@ A
}
øø 
if
ÿÿ 
(
ÿÿ 
fLicInfo
ÿÿ 
.
ÿÿ 

fLicS2hCvt
ÿÿ '
.
ÿÿ' (
expireIssuedCheck
ÿÿ( 9
==
ÿÿ: <
FYesNo
ÿÿ= C
.
ÿÿC D
Yes
ÿÿD G
&&
ÿÿH J
!
ÿÿK L
fLic
ÿÿL P
.
ÿÿP Q%
validateExpireIssueDate
ÿÿQ h
(
ÿÿh i
fLicInfo
ÿÿi q
.
ÿÿq r

fLicS2hCvt
ÿÿr |
.
ÿÿ| }
expireIssuedDateÿÿ} 
)ÿÿ 
)ÿÿ 
{
€€ 
fLic
 
.
 "
rasieValidationError
 -
(
- .
$str
. B
)
B C
;
C D
}
‚‚ 
}
ƒƒ 
catch
„„ 
(
„„ 
	Exception
„„ 
ex
„„ 
)
„„  
{
…… 
FDebug
†† 
.
†† 
throwException
†† %
(
††% &
ex
††& (
)
††( )
;
††) *
}
‡‡ 
finally
ˆˆ 
{
‰‰ 
if
ŠŠ 
(
ŠŠ 
fLic
ŠŠ 
!=
ŠŠ 
null
ŠŠ  
)
ŠŠ  !
{
‹‹ 
fLic
ŒŒ 
.
ŒŒ 
Dispose
ŒŒ  
(
ŒŒ  !
)
ŒŒ! "
;
ŒŒ" #
fLic
 
=
 
null
 
;
  
}
 
if
 
(
 
fLicInfo
 
!=
 
null
  $
)
$ %
{
‘‘ 
fLicInfo
’’ 
.
’’ 
Dispose
’’ $
(
’’$ %
)
’’% &
;
’’& '
fLicInfo
““ 
=
““ 
null
““ #
;
““# $
}
”” 
}
•• 
}
–– 	
private
šš 
void
šš 
init
šš 
(
šš 
)
›› 
{
œœ 	
try
 
{
 
m_logDirectory
ŸŸ 
=
ŸŸ  
Application
ŸŸ! ,
.
ŸŸ, -
StartupPath
ŸŸ- 8
+
ŸŸ9 :
$str
ŸŸ; B
;
ŸŸB C!
m_logFileNameSuffix
   #
=
  $ %
$str
  & 3
;
  3 4
m_logFileMaxSize
¡¡  
=
¡¡! "
$num
¡¡# $
;
¡¡$ %
m_fLogWriter
¥¥ 
=
¥¥ 
new
¥¥ "

FLogWriter
¥¥# -
(
¥¥- .
this
¥¥. 2
)
¥¥2 3
;
¥¥3 4#
m_fSystemBytesPointer
¦¦ %
=
¦¦& '
new
¦¦( +
FIDPointer32
¦¦, 8
(
¦¦8 9
$num
¦¦9 >
)
¦¦> ?
;
¦¦? @
m_fSecs1Config
­­ 
=
­­  
new
­­! $
FSecs1Config
­­% 1
(
­­1 2
this
­­2 6
)
­­6 7
;
­­7 8
m_fHsmsConfig
®® 
=
®® 
new
®®  #
FHsmsConfig
®®$ /
(
®®/ 0
this
®®0 4
)
®®4 5
;
®®5 6.
 m_fSecs1InterceptingDataMessages
²² 0
=
²²1 2
new
²²3 6

Dictionary
²²7 A
<
²²A B
string
²²B H
,
²²H I&
FInterceptingDataMessage
²²J b
>
²²b c
(
²²c d
)
²²d e
;
²²e f-
m_fHsmsInterceptingDataMessages
³³ /
=
³³0 1
new
³³2 5

Dictionary
³³6 @
<
³³@ A
string
³³A G
,
³³G H&
FInterceptingDataMessage
³³I a
>
³³a b
(
³³b c
)
³³c d
;
³³d e
m_fEventPusher
·· 
=
··  
new
··! $
FEventPusher
··% 1
(
··1 2
this
··2 6
)
··6 7
;
··7 8
}
¸¸ 
catch
¹¹ 
(
¹¹ 
	Exception
¹¹ 
ex
¹¹ 
)
¹¹  
{
ºº 
FDebug
»» 
.
»» 
throwException
»» %
(
»»% &
ex
»»& (
)
»»( )
;
»») *
}
¼¼ 
finally
½½ 
{
¾¾ 
}
ÀÀ 
}
ÁÁ 	
private
ÅÅ 
void
ÅÅ 
term
ÅÅ 
(
ÅÅ 
)
ÆÆ 
{
ÇÇ 	
try
ÈÈ 
{
ÉÉ 
closeAll
ÊÊ 
(
ÊÊ 
)
ÊÊ 
;
ÊÊ 
if
ÎÎ 
(
ÎÎ 
m_fEventPusher
ÎÎ "
!=
ÎÎ# %
null
ÎÎ& *
)
ÎÎ* +
{
ÏÏ 
m_fEventPusher
ĞĞ "
.
ĞĞ" #
Dispose
ĞĞ# *
(
ĞĞ* +
)
ĞĞ+ ,
;
ĞĞ, -
m_fEventPusher
ÑÑ "
=
ÑÑ# $
null
ÑÑ% )
;
ÑÑ) *
}
ÒÒ 
if
ÖÖ 
(
ÖÖ 
m_fSecs1Config
ÖÖ "
!=
ÖÖ# %
null
ÖÖ& *
)
ÖÖ* +
{
×× 
m_fSecs1Config
ØØ "
.
ØØ" #
Dispose
ØØ# *
(
ØØ* +
)
ØØ+ ,
;
ØØ, -
m_fSecs1Config
ÙÙ "
=
ÙÙ# $
null
ÙÙ% )
;
ÙÙ) *
}
ÚÚ 
if
ÛÛ 
(
ÛÛ 
m_fHsmsConfig
ÛÛ !
!=
ÛÛ" $
null
ÛÛ% )
)
ÛÛ) *
{
ÜÜ 
m_fHsmsConfig
İİ !
.
İİ! "
Dispose
İİ" )
(
İİ) *
)
İİ* +
;
İİ+ ,
m_fHsmsConfig
ŞŞ !
=
ŞŞ" #
null
ŞŞ$ (
;
ŞŞ( )
}
ßß .
 m_fSecs1InterceptingDataMessages
ãã 0
=
ãã1 2
null
ãã3 7
;
ãã7 8-
m_fHsmsInterceptingDataMessages
ää /
=
ää0 1
null
ää2 6
;
ää6 7
if
èè 
(
èè 
m_fLogWriter
èè  
!=
èè! #
null
èè$ (
)
èè( )
{
éé 
m_fLogWriter
êê  
.
êê  !
Dispose
êê! (
(
êê( )
)
êê) *
;
êê* +
m_fLogWriter
ëë  
=
ëë! "
null
ëë# '
;
ëë' (
}
ìì 
if
îî 
(
îî #
m_fSystemBytesPointer
îî )
!=
îî* ,
null
îî- 1
)
îî1 2
{
ïï #
m_fSystemBytesPointer
ğğ )
.
ğğ) *
Dispose
ğğ* 1
(
ğğ1 2
)
ğğ2 3
;
ğğ3 4#
m_fSystemBytesPointer
ññ )
=
ññ* +
null
ññ, 0
;
ññ0 1
}
òò 
}
óó 
catch
ôô 
(
ôô 
	Exception
ôô 
ex
ôô 
)
ôô  
{
õõ 
FDebug
öö 
.
öö 
throwException
öö %
(
öö% &
ex
öö& (
)
öö( )
;
öö) *
}
÷÷ 
finally
øø 
{
ùù 
}
ûû 
}
üü 	
public
€€ 
void
€€ 
	openSecs1
€€ 
(
€€ 
)
 
{
‚‚ 	
try
ƒƒ 
{
„„ 
if
…… 
(
…… 
m_fSecs1State
…… !
!=
……" $!
FCommunicationState
……% 8
.
……8 9
Closed
……9 ?
)
……? @
{
†† 
return
‡‡ 
;
‡‡ 
}
ˆˆ 
m_fSecs1
ŒŒ 
=
ŒŒ 
new
ŒŒ 
FSECS1
ŒŒ %
(
ŒŒ% &
this
ŒŒ& *
)
ŒŒ* +
;
ŒŒ+ ,
m_fSecs1
 
.
 
open
 
(
 
)
 
;
  
}
 
catch
 
(
 
	Exception
 
ex
 
)
  
{
 
if
‘‘ 
(
‘‘ 
m_fSecs1
‘‘ 
!=
‘‘ 
null
‘‘  $
)
‘‘$ %
{
’’ 
m_fSecs1
““ 
.
““ 
Dispose
““ $
(
““$ %
)
““% &
;
““& '
m_fSecs1
”” 
=
”” 
null
”” #
;
””# $
}
•• 
FDebug
–– 
.
–– 
throwException
–– %
(
––% &
ex
––& (
)
––( )
;
––) *
}
—— 
finally
˜˜ 
{
™™ 
}
›› 
}
œœ 	
public
   
void
   

closeSecs1
   
(
   
)
¡¡ 
{
¢¢ 	
try
££ 
{
¤¤ 
if
¥¥ 
(
¥¥ 
m_fSecs1State
¥¥ !
==
¥¥" $!
FCommunicationState
¥¥% 8
.
¥¥8 9
Closed
¥¥9 ?
)
¥¥? @
{
¦¦ 
return
§§ 
;
§§ 
}
¨¨ 
if
¬¬ 
(
¬¬ 
m_fSecs1
¬¬ 
!=
¬¬ 
null
¬¬  $
)
¬¬$ %
{
­­ 
m_fSecs1
®® 
.
®® 
close
®® "
(
®®" #
)
®®# $
;
®®$ %
m_fSecs1
¯¯ 
.
¯¯ 
Dispose
¯¯ $
(
¯¯$ %
)
¯¯% &
;
¯¯& '
m_fSecs1
°° 
=
°° 
null
°° #
;
°°# $
}
±± 
}
²² 
catch
³³ 
(
³³ 
	Exception
³³ 
ex
³³ 
)
³³  
{
´´ 
FDebug
µµ 
.
µµ 
throwException
µµ %
(
µµ% &
ex
µµ& (
)
µµ( )
;
µµ) *
}
¶¶ 
finally
·· 
{
¸¸ 
}
ºº 
}
»» 	
public
¿¿ 
void
¿¿ 
openHsms
¿¿ 
(
¿¿ 
)
ÀÀ 
{
ÁÁ 	
try
ÂÂ 
{
ÃÃ 
if
ÄÄ 
(
ÄÄ 
m_fHsmsState
ÄÄ  
!=
ÄÄ! #!
FCommunicationState
ÄÄ$ 7
.
ÄÄ7 8
Closed
ÄÄ8 >
)
ÄÄ> ?
{
ÅÅ 
return
ÆÆ 
;
ÆÆ 
}
ÇÇ 
if
ËË 
(
ËË 
m_fHsmsConfig
ËË !
.
ËË! "
fConnectMode
ËË" .
==
ËË/ 1
FConnectMode
ËË2 >
.
ËË> ?
Passive
ËË? F
)
ËËF G
{
ÌÌ 
m_fHsms
ÍÍ 
=
ÍÍ 
new
ÍÍ !
FHsmsPassive
ÍÍ" .
(
ÍÍ. /
this
ÍÍ/ 3
)
ÍÍ3 4
;
ÍÍ4 5
}
ÎÎ 
else
ÏÏ 
{
ĞĞ 
m_fHsms
ÑÑ 
=
ÑÑ 
new
ÑÑ !
FHsmsActive
ÑÑ" -
(
ÑÑ- .
this
ÑÑ. 2
)
ÑÑ2 3
;
ÑÑ3 4
}
ÒÒ 
m_fHsms
ÔÔ 
.
ÔÔ 
open
ÔÔ 
(
ÔÔ 
)
ÔÔ 
;
ÔÔ 
}
ÕÕ 
catch
ÖÖ 
(
ÖÖ 
	Exception
ÖÖ 
ex
ÖÖ 
)
ÖÖ  
{
×× 
if
ØØ 
(
ØØ 
m_fHsms
ØØ 
!=
ØØ 
null
ØØ #
)
ØØ# $
{
ÙÙ 
m_fHsms
ÚÚ 
.
ÚÚ 
Dispose
ÚÚ #
(
ÚÚ# $
)
ÚÚ$ %
;
ÚÚ% &
m_fHsms
ÛÛ 
=
ÛÛ 
null
ÛÛ "
;
ÛÛ" #
}
ÜÜ 
FDebug
İİ 
.
İİ 
throwException
İİ %
(
İİ% &
ex
İİ& (
)
İİ( )
;
İİ) *
}
ŞŞ 
finally
ßß 
{
àà 
}
ââ 
}
ãã 	
public
çç 
void
çç 
	closeHsms
çç 
(
çç 
)
èè 
{
éé 	
try
êê 
{
ëë 
if
ìì 
(
ìì 
m_fHsmsState
ìì  
==
ìì! #!
FCommunicationState
ìì$ 7
.
ìì7 8
Closed
ìì8 >
)
ìì> ?
{
íí 
return
îî 
;
îî 
}
ïï 
if
óó 
(
óó 
m_fHsms
óó 
!=
óó 
null
óó #
)
óó# $
{
ôô 
m_fHsms
õõ 
.
õõ 
close
õõ !
(
õõ! "
)
õõ" #
;
õõ# $
m_fHsms
öö 
.
öö 
Dispose
öö #
(
öö# $
)
öö$ %
;
öö% &
m_fHsms
÷÷ 
=
÷÷ 
null
÷÷ "
;
÷÷" #
}
øø 
}
ùù 
catch
úú 
(
úú 
	Exception
úú 
ex
úú 
)
úú  
{
ûû 
FDebug
üü 
.
üü 
throwException
üü %
(
üü% &
ex
üü& (
)
üü( )
;
üü) *
}
ıı 
finally
şş 
{
ÿÿ 
}
 
}
‚‚ 	
public
†† 
void
†† 
openAll
†† 
(
†† 
)
‡‡ 
{
ˆˆ 	
try
‰‰ 
{
ŠŠ 
openHsms
‹‹ 
(
‹‹ 
)
‹‹ 
;
‹‹ 
	openSecs1
ŒŒ 
(
ŒŒ 
)
ŒŒ 
;
ŒŒ 
}
 
catch
 
(
 
	Exception
 
ex
 
)
  
{
 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
‘‘ 
finally
’’ 
{
““ 
}
•• 
}
–– 	
public
šš 
void
šš 
closeAll
šš 
(
šš 
)
›› 
{
œœ 	
try
 
{
 

closeSecs1
ŸŸ 
(
ŸŸ 
)
ŸŸ 
;
ŸŸ 
	closeHsms
   
(
   
)
   
;
   
}
¡¡ 
catch
¢¢ 
(
¢¢ 
	Exception
¢¢ 
ex
¢¢ 
)
¢¢  
{
££ 
FDebug
¤¤ 
.
¤¤ 
throwException
¤¤ %
(
¤¤% &
ex
¤¤& (
)
¤¤( )
;
¤¤) *
}
¥¥ 
finally
¦¦ 
{
§§ 
}
©© 
}
ªª 	
internal
®® 
void
®® 
changeSecs1State
®® &
(
®®& '!
FCommunicationState
¯¯ 
fState
¯¯  &
,
¯¯& '
string
°° 

serialPort
°° 
,
°° 
int
±± 
baud
±± 
)
²² 
{
³³ 	
try
´´ 
{
µµ 
if
¶¶ 
(
¶¶ 
m_fSecs1State
¶¶ !
==
¶¶" $
fState
¶¶% +
)
¶¶+ ,
{
·· 
return
¸¸ 
;
¸¸ 
}
¹¹ 
m_fSecs1State
ºº 
=
ºº 
fState
ºº  &
;
ºº& '
m_fEventPusher
¾¾ 
.
¾¾ 
pushSecs1Event
¾¾ -
(
¾¾- .
new
¿¿ )
FSecs1StateChangedEventArgs
¿¿ 3
(
¿¿3 4
this
¿¿4 8
,
¿¿8 9
FEventId
¿¿: B
.
¿¿B C
Secs1StateChanged
¿¿C T
,
¿¿T U
FResultCode
¿¿V a
.
¿¿a b
Success
¿¿b i
,
¿¿i j
string
¿¿k q
.
¿¿q r
Empty
¿¿r w
,
¿¿w x
fState
¿¿y 
,¿¿ €

serialPort¿¿ ‹
,¿¿‹ Œ
baud¿¿ ‘
)¿¿‘ ’
)
ÀÀ 
;
ÀÀ 
}
ÁÁ 
catch
ÂÂ 
(
ÂÂ 
	Exception
ÂÂ 
ex
ÂÂ 
)
ÂÂ  
{
ÃÃ 
FDebug
ÄÄ 
.
ÄÄ 
throwException
ÄÄ %
(
ÄÄ% &
ex
ÄÄ& (
)
ÄÄ( )
;
ÄÄ) *
}
ÅÅ 
finally
ÆÆ 
{
ÇÇ 
}
ÉÉ 
}
ÊÊ 	
internal
ÎÎ 
void
ÎÎ 
changeHsmsState
ÎÎ %
(
ÎÎ% &
FConnectMode
ÏÏ 
fConnectMode
ÏÏ %
,
ÏÏ% &
string
ĞĞ 
localIp
ĞĞ 
,
ĞĞ 
int
ÑÑ 
	localPort
ÑÑ 
,
ÑÑ 
string
ÒÒ 
remoteIp
ÒÒ 
,
ÒÒ 
int
ÓÓ 

remotePort
ÓÓ 
,
ÓÓ !
FCommunicationState
ÔÔ 
fState
ÔÔ  &
)
ÕÕ 
{
ÖÖ 	
try
×× 
{
ØØ 
if
ÙÙ 
(
ÙÙ 
m_fHsmsState
ÙÙ  
==
ÙÙ! #
fState
ÙÙ$ *
)
ÙÙ* +
{
ÚÚ 
return
ÛÛ 
;
ÛÛ 
}
ÜÜ 
m_fHsmsState
İİ 
=
İİ 
fState
İİ %
;
İİ% &
m_fEventPusher
áá 
.
áá 
pushHsmsEvent
áá ,
(
áá, -
new
ââ (
FHsmsStateChangedEventArgs
ââ 2
(
ââ2 3
this
ãã 
,
ãã 
FEventId
ää  
.
ää  !
HsmsStateChanged
ää! 1
,
ää1 2
FResultCode
åå #
.
åå# $
Success
åå$ +
,
åå+ ,
string
ææ 
.
ææ 
Empty
ææ $
,
ææ$ %
fConnectMode
çç $
,
çç$ %
localIp
èè 
,
èè  
	localPort
éé !
,
éé! "
remoteIp
êê  
,
êê  !

remotePort
ëë "
,
ëë" #
fState
ìì 
)
íí 
)
îî 
;
îî 
}
ïï 
catch
ğğ 
(
ğğ 
	Exception
ğğ 
ex
ğğ 
)
ğğ  
{
ññ 
FDebug
òò 
.
òò 
throwException
òò %
(
òò% &
ex
òò& (
)
òò( )
;
òò) *
}
óó 
finally
ôô 
{
õõ 
}
÷÷ 
}
øø 	
internal
üü 
void
üü 
onEventRaised
üü #
(
üü# $
FEventArgsBase
ıı 
fArgs
ıı  
)
şş 
{
ÿÿ 	
FSecsDataMessage
€€ 
fSecsDataMessage
€€ -
=
€€. /
null
€€0 4
;
€€4 5
try
‚‚ 
{
ƒƒ 
if
„„ 
(
„„ 
m_logEnabled
„„  
)
„„  !
{
…… 
m_fLogWriter
††  
.
††  !
write
††! &
(
††& '
fArgs
††' ,
)
††, -
;
††- .
}
‡‡ 
if
‹‹ 
(
‹‹ 
EventRaised
‹‹ 
!=
‹‹  "
null
‹‹# '
)
‹‹' (
{
ŒŒ 
EventRaised
 
(
  
this
  $
,
$ %
fArgs
& +
)
+ ,
;
, -
}
 
if
’’ 
(
’’ 
fArgs
’’ 
.
’’ 
fEventId
’’ "
==
’’# %
FEventId
’’& .
.
’’. /&
Secs1DataMessageReceived
’’/ G
)
’’G H
{
““ 
if
”” 
(
”” 
(
”” 
(
”” 0
"FSecs1DataMessageReceivedEventArgs
”” <
)
””< =
fArgs
””= B
)
””B C
.
””C D
fResult
””D K
==
””L N
FResultCode
””O Z
.
””Z [
Success
””[ b
)
””b c
{
•• 
fSecsDataMessage
–– (
=
––) *
(
––+ ,
(
––, -0
"FSecs1DataMessageReceivedEventArgs
––- O
)
––O P
fArgs
––P U
)
––U V
.
––V W
fSecsDataMessage
––W g
;
––g h
if
—— 
(
—— 
!
—— ,
isSecs1InterceptingDataMessage
—— ;
(
——; <
fSecsDataMessage
——< L
.
——L M
stream
——M S
,
——S T
fSecsDataMessage
——U e
.
——e f
function
——f n
)
——n o
)
——o p
{
˜˜ !
sendHsmsDataMessage
™™ /
(
™™/ 0
(
™™0 1
(
™™1 20
"FSecs1DataMessageReceivedEventArgs
™™2 T
)
™™T U
fArgs
™™U Z
)
™™Z [
.
™™[ \
fSecsDataMessage
™™\ l
)
™™l m
;
™™m n
}
šš 
}
›› 
}
œœ 
else
 
if
 
(
 
fArgs
 
.
 
fEventId
 '
==
( *
FEventId
+ 3
.
3 4%
HsmsDataMessageReceived
4 K
)
K L
{
 
if
ŸŸ 
(
ŸŸ 
(
ŸŸ 
(
ŸŸ /
!FHsmsDataMessageReceivedEventArgs
ŸŸ ;
)
ŸŸ; <
fArgs
ŸŸ< A
)
ŸŸA B
.
ŸŸB C
fResult
ŸŸC J
==
ŸŸK M
FResultCode
ŸŸN Y
.
ŸŸY Z
Success
ŸŸZ a
)
ŸŸa b
{
   
fSecsDataMessage
¡¡ (
=
¡¡) *
(
¡¡+ ,
(
¡¡, -/
!FHsmsDataMessageReceivedEventArgs
¡¡- N
)
¡¡N O
fArgs
¡¡O T
)
¡¡T U
.
¡¡U V
fSecsDataMessage
¡¡V f
;
¡¡f g
if
¢¢ 
(
¢¢ 
!
¢¢ +
isHsmsInterceptingDataMessage
¢¢ :
(
¢¢: ;
fSecsDataMessage
¢¢; K
.
¢¢K L
stream
¢¢L R
,
¢¢R S
fSecsDataMessage
¢¢T d
.
¢¢d e
function
¢¢e m
)
¢¢m n
)
¢¢n o
{
££ "
sendSecs1DataMessage
¤¤ 0
(
¤¤0 1
(
¤¤1 2
(
¤¤2 3/
!FHsmsDataMessageReceivedEventArgs
¤¤3 T
)
¤¤T U
fArgs
¤¤U Z
)
¤¤Z [
.
¤¤[ \
fSecsDataMessage
¤¤\ l
)
¤¤l m
;
¤¤m n
}
¥¥ 
}
¦¦ 
}
§§ 
}
¨¨ 
catch
©© 
(
©© 
	Exception
©© 
ex
©© 
)
©©  
{
ªª 
FDebug
«« 
.
«« 
throwException
«« %
(
««% &
ex
««& (
)
««( )
;
««) *
}
¬¬ 
finally
­­ 
{
®® 
fSecsDataMessage
¯¯  
=
¯¯! "
null
¯¯# '
;
¯¯' (
}
°° 
}
±± 	
private
µµ 
void
µµ !
sendHsmsDataMessage
µµ (
(
µµ( )
FSecsDataMessage
¶¶ 
fSecsDataMessage
¶¶ -
)
·· 
{
¸¸ 	
FSecsDataMessage
¹¹ 
fMsg
¹¹ !
=
¹¹" #
null
¹¹$ (
;
¹¹( )
try
»» 
{
¼¼ 
fMsg
½½ 
=
½½ 
fSecsDataMessage
½½ '
.
½½' (
clone
½½( -
(
½½- .
)
½½. /
;
½½/ 0
if
ÁÁ 
(
ÁÁ 
this
ÁÁ 
.
ÁÁ 

fHsmsState
ÁÁ #
==
ÁÁ$ &!
FCommunicationState
ÁÁ' :
.
ÁÁ: ;
Selected
ÁÁ; C
)
ÁÁC D
{
ÂÂ 
m_fHsms
ÃÃ 
.
ÃÃ 
send
ÃÃ  
(
ÃÃ  !
fMsg
ÃÃ! %
)
ÃÃ% &
;
ÃÃ& '
}
ÄÄ 
else
ÅÅ 
{
ÆÆ 
m_fEventPusher
ÇÇ "
.
ÇÇ" #
pushHsmsEvent
ÇÇ# 0
(
ÇÇ0 1
new
ÈÈ +
FHsmsDataMessageSentEventArgs
ÈÈ 9
(
ÈÈ9 :
this
ÈÈ: >
,
ÈÈ> ?
FEventId
ÈÈ@ H
.
ÈÈH I!
HsmsDataMessageSent
ÈÈI \
,
ÈÈ\ ]
FResultCode
ÈÈ^ i
.
ÈÈi j
Error
ÈÈj o
,
ÈÈo p
string
ÈÈq w
.
ÈÈw x
Format
ÈÈx ~
(
ÈÈ~ 

FConstantsÈÈ ‰
.ÈÈ‰ Š

err_m_0030ÈÈŠ ”
,ÈÈ” •
$strÈÈ– œ
)ÈÈœ 
,ÈÈ 
fMsgÈÈŸ £
)ÈÈ£ ¤
)
ÉÉ 
;
ÉÉ 
}
ÊÊ 
}
ËË 
catch
ÌÌ 
(
ÌÌ 
	Exception
ÌÌ 
ex
ÌÌ 
)
ÌÌ  
{
ÍÍ 
FDebug
ÎÎ 
.
ÎÎ 
writeLog
ÎÎ 
(
ÎÎ  
ex
ÎÎ  "
)
ÎÎ" #
;
ÎÎ# $
}
ÏÏ 
finally
ĞĞ 
{
ÑÑ 
fMsg
ÒÒ 
=
ÒÒ 
null
ÒÒ 
;
ÒÒ 
}
ÓÓ 
}
ÔÔ 	
private
ØØ 
void
ØØ "
sendSecs1DataMessage
ØØ )
(
ØØ) *
FSecsDataMessage
ÙÙ 
fSecsDataMessage
ÙÙ -
)
ÚÚ 
{
ÛÛ 	
FSecsDataMessage
ÜÜ 
fMsg
ÜÜ !
=
ÜÜ" #
null
ÜÜ$ (
;
ÜÜ( )
try
ŞŞ 
{
ßß 
fMsg
àà 
=
àà 
fSecsDataMessage
àà '
.
àà' (
clone
àà( -
(
àà- .
)
àà. /
;
àà/ 0
if
ää 
(
ää 
this
ää 
.
ää 
fSecs1State
ää $
==
ää% '!
FCommunicationState
ää( ;
.
ää; <
Selected
ää< D
)
ääD E
{
åå 
m_fSecs1
ææ 
.
ææ 
send
ææ !
(
ææ! "
fMsg
ææ" &
)
ææ& '
;
ææ' (
}
çç 
else
èè 
{
éé 
m_fEventPusher
êê "
.
êê" #
pushSecs1Event
êê# 1
(
êê1 2
new
ëë ,
FSecs1DataMessageSentEventArgs
ëë :
(
ëë: ;
this
ëë; ?
,
ëë? @
FEventId
ëëA I
.
ëëI J"
Secs1DataMessageSent
ëëJ ^
,
ëë^ _
FResultCode
ëë` k
.
ëëk l
Error
ëël q
,
ëëq r
string
ëës y
.
ëëy z
Formatëëz €
(ëë€ 

FConstantsëë ‹
.ëë‹ Œ

err_m_0030ëëŒ –
,ëë– —
$strëë˜ Ÿ
)ëëŸ  
,ëë  ¡
fMsgëë¢ ¦
)ëë¦ §
)
ìì 
;
ìì 
}
íí 
}
îî 
catch
ïï 
(
ïï 
	Exception
ïï 
ex
ïï 
)
ïï  
{
ğğ 
FDebug
ññ 
.
ññ 
writeLog
ññ 
(
ññ  
ex
ññ  "
)
ññ" #
;
ññ# $
}
òò 
finally
óó 
{
ôô 
fMsg
õõ 
=
õõ 
null
õõ 
;
õõ 
}
öö 
}
÷÷ 	
public
ûû 
void
ûû (
waitEventHandlingCompleted
ûû .
(
ûû. /
)
üü 
{
ıı 	
try
şş 
{
ÿÿ 
m_fEventPusher
€€ 
.
€€ (
waitEventHandlingCompleted
€€ 9
(
€€9 :
)
€€: ;
;
€€; <
}
 
catch
‚‚ 
(
‚‚ 
	Exception
‚‚ 
ex
‚‚ 
)
‚‚  
{
ƒƒ 
FDebug
„„ 
.
„„ 
throwException
„„ %
(
„„% &
ex
„„& (
)
„„( )
;
„„) *
}
…… 
finally
†† 
{
‡‡ 
}
‰‰ 
}
ŠŠ 	
public
 
bool
 2
$containsSecs1InterceptingDataMessage
 8
(
8 9&
FInterceptingDataMessage
 $&
fInterceptingDataMessage
% =
)
 
{
‘‘ 	
try
’’ 
{
““ 
return
”” .
 m_fSecs1InterceptingDataMessages
”” 7
.
””7 8
ContainsKey
””8 C
(
””C D&
fInterceptingDataMessage
””D \
.
””\ ]
getKey
””] c
(
””c d
)
””d e
)
””e f
;
””f g
}
•• 
catch
–– 
(
–– 
	Exception
–– 
ex
–– 
)
––  
{
—— 
FDebug
˜˜ 
.
˜˜ 
throwException
˜˜ %
(
˜˜% &
ex
˜˜& (
)
˜˜( )
;
˜˜) *
}
™™ 
finally
šš 
{
›› 
}
 
return
 
false
 
;
 
}
ŸŸ 	
public
££ 
bool
££ 1
#containsHsmsInterceptingDataMessage
££ 7
(
££7 8&
FInterceptingDataMessage
¤¤ $&
fInterceptingDataMessage
¤¤% =
)
¥¥ 
{
¦¦ 	
try
§§ 
{
¨¨ 
return
©© -
m_fHsmsInterceptingDataMessages
©© 6
.
©©6 7
ContainsKey
©©7 B
(
©©B C&
fInterceptingDataMessage
©©C [
.
©©[ \
getKey
©©\ b
(
©©b c
)
©©c d
)
©©d e
;
©©e f
}
ªª 
catch
«« 
(
«« 
	Exception
«« 
ex
«« 
)
««  
{
¬¬ 
FDebug
­­ 
.
­­ 
throwException
­­ %
(
­­% &
ex
­­& (
)
­­( )
;
­­) *
}
®® 
finally
¯¯ 
{
°° 
}
²² 
return
³³ 
false
³³ 
;
³³ 
}
´´ 	
public
¸¸ 
void
¸¸ -
addSecs1InterceptingDataMessage
¸¸ 3
(
¸¸3 4&
FInterceptingDataMessage
¹¹ $&
fInterceptingDataMessage
¹¹% =
)
ºº 
{
»» 	
try
¼¼ 
{
½½ 
if
¾¾ 
(
¾¾ .
 m_fSecs1InterceptingDataMessages
¾¾ 4
.
¾¾4 5
ContainsKey
¾¾5 @
(
¾¾@ A&
fInterceptingDataMessage
¾¾A Y
.
¾¾Y Z
getKey
¾¾Z `
(
¾¾` a
)
¾¾a b
)
¾¾b c
)
¾¾c d
{
¿¿ 
return
ÀÀ 
;
ÀÀ 
}
ÁÁ .
 m_fSecs1InterceptingDataMessages
ÂÂ 0
.
ÂÂ0 1
Add
ÂÂ1 4
(
ÂÂ4 5&
fInterceptingDataMessage
ÂÂ5 M
.
ÂÂM N
getKey
ÂÂN T
(
ÂÂT U
)
ÂÂU V
,
ÂÂV W&
fInterceptingDataMessage
ÂÂX p
)
ÂÂp q
;
ÂÂq r
}
ÃÃ 
catch
ÄÄ 
(
ÄÄ 
	Exception
ÄÄ 
ex
ÄÄ 
)
ÄÄ  
{
ÅÅ 
FDebug
ÆÆ 
.
ÆÆ 
throwException
ÆÆ %
(
ÆÆ% &
ex
ÆÆ& (
)
ÆÆ( )
;
ÆÆ) *
}
ÇÇ 
finally
ÈÈ 
{
ÉÉ 
}
ËË 
}
ÌÌ 	
public
ĞĞ 
void
ĞĞ ,
addHsmsInterceptingDataMessage
ĞĞ 2
(
ĞĞ2 3&
FInterceptingDataMessage
ÑÑ $&
fInterceptingDataMessage
ÑÑ% =
)
ÒÒ 
{
ÓÓ 	
try
ÔÔ 
{
ÕÕ 
if
ÖÖ 
(
ÖÖ -
m_fHsmsInterceptingDataMessages
ÖÖ 3
.
ÖÖ3 4
ContainsKey
ÖÖ4 ?
(
ÖÖ? @&
fInterceptingDataMessage
ÖÖ@ X
.
ÖÖX Y
getKey
ÖÖY _
(
ÖÖ_ `
)
ÖÖ` a
)
ÖÖa b
)
ÖÖb c
{
×× 
return
ØØ 
;
ØØ 
}
ÙÙ -
m_fHsmsInterceptingDataMessages
ÚÚ /
.
ÚÚ/ 0
Add
ÚÚ0 3
(
ÚÚ3 4&
fInterceptingDataMessage
ÚÚ4 L
.
ÚÚL M
getKey
ÚÚM S
(
ÚÚS T
)
ÚÚT U
,
ÚÚU V&
fInterceptingDataMessage
ÚÚW o
)
ÚÚo p
;
ÚÚp q
}
ÛÛ 
catch
ÜÜ 
(
ÜÜ 
	Exception
ÜÜ 
ex
ÜÜ 
)
ÜÜ  
{
İİ 
FDebug
ŞŞ 
.
ŞŞ 
throwException
ŞŞ %
(
ŞŞ% &
ex
ŞŞ& (
)
ŞŞ( )
;
ŞŞ) *
}
ßß 
finally
àà 
{
áá 
}
ãã 
}
ää 	
public
èè 
void
èè 0
"removeSecs1InterceptingDataMessage
èè 6
(
èè6 7&
FInterceptingDataMessage
éé $&
fInterceptingDataMessage
éé% =
)
êê 
{
ëë 	
try
ìì 
{
íí 
if
îî 
(
îî 
!
îî .
 m_fSecs1InterceptingDataMessages
îî 5
.
îî5 6
ContainsKey
îî6 A
(
îîA B&
fInterceptingDataMessage
îîB Z
.
îîZ [
getKey
îî[ a
(
îîa b
)
îîb c
)
îîc d
)
îîd e
{
ïï 
return
ğğ 
;
ğğ 
}
ññ .
 m_fSecs1InterceptingDataMessages
òò 0
.
òò0 1
Remove
òò1 7
(
òò7 8&
fInterceptingDataMessage
òò8 P
.
òòP Q
getKey
òòQ W
(
òòW X
)
òòX Y
)
òòY Z
;
òòZ [
}
óó 
catch
ôô 
(
ôô 
	Exception
ôô 
ex
ôô 
)
ôô  
{
õõ 
FDebug
öö 
.
öö 
throwException
öö %
(
öö% &
ex
öö& (
)
öö( )
;
öö) *
}
÷÷ 
finally
øø 
{
ùù 
}
ûû 
}
üü 	
public
€	€	 
void
€	€	 /
!removeHsmsInterceptingDataMessage
€	€	 5
(
€	€	5 6&
FInterceptingDataMessage
		 $&
fInterceptingDataMessage
		% =
)
‚	‚	 
{
ƒ	ƒ	 	
try
„	„	 
{
…	…	 
if
†	†	 
(
†	†	 
!
†	†	 -
m_fHsmsInterceptingDataMessages
†	†	 4
.
†	†	4 5
ContainsKey
†	†	5 @
(
†	†	@ A&
fInterceptingDataMessage
†	†	A Y
.
†	†	Y Z
getKey
†	†	Z `
(
†	†	` a
)
†	†	a b
)
†	†	b c
)
†	†	c d
{
‡	‡	 
return
ˆ	ˆ	 
;
ˆ	ˆ	 
}
‰	‰	 -
m_fHsmsInterceptingDataMessages
Š	Š	 /
.
Š	Š	/ 0
Remove
Š	Š	0 6
(
Š	Š	6 7&
fInterceptingDataMessage
Š	Š	7 O
.
Š	Š	O P
getKey
Š	Š	P V
(
Š	Š	V W
)
Š	Š	W X
)
Š	Š	X Y
;
Š	Š	Y Z
}
‹	‹	 
catch
Œ	Œ	 
(
Œ	Œ	 
	Exception
Œ	Œ	 
ex
Œ	Œ	 
)
Œ	Œ	  
{
		 
FDebug
		 
.
		 
throwException
		 %
(
		% &
ex
		& (
)
		( )
;
		) *
}
		 
finally
		 
{
‘	‘	 
}
“	“	 
}
”	”	 	
public
˜	˜	 
void
˜	˜	 3
%removeAllSecs1InterceptingDataMessage
˜	˜	 9
(
˜	˜	9 :
)
™	™	 
{
š	š	 	
try
›	›	 
{
œ	œ	 .
 m_fSecs1InterceptingDataMessages
		 0
.
		0 1
Clear
		1 6
(
		6 7
)
		7 8
;
		8 9
}
		 
catch
Ÿ	Ÿ	 
(
Ÿ	Ÿ	 
	Exception
Ÿ	Ÿ	 
ex
Ÿ	Ÿ	 
)
Ÿ	Ÿ	  
{
 	 	 
FDebug
¡	¡	 
.
¡	¡	 
throwException
¡	¡	 %
(
¡	¡	% &
ex
¡	¡	& (
)
¡	¡	( )
;
¡	¡	) *
}
¢	¢	 
finally
£	£	 
{
¤	¤	 
}
¦	¦	 
}
§	§	 	
public
«	«	 
void
«	«	 2
$removeAllHsmsInterceptingDataMessage
«	«	 8
(
«	«	8 9
)
¬	¬	 
{
­	­	 	
try
®	®	 
{
¯	¯	 -
m_fHsmsInterceptingDataMessages
°	°	 /
.
°	°	/ 0
Clear
°	°	0 5
(
°	°	5 6
)
°	°	6 7
;
°	°	7 8
}
±	±	 
catch
²	²	 
(
²	²	 
	Exception
²	²	 
ex
²	²	 
)
²	²	  
{
³	³	 
FDebug
´	´	 
.
´	´	 
throwException
´	´	 %
(
´	´	% &
ex
´	´	& (
)
´	´	( )
;
´	´	) *
}
µ	µ	 
finally
¶	¶	 
{
·	·	 
}
¹	¹	 
}
º	º	 	
internal
¾	¾	 
bool
¾	¾	 ,
isSecs1InterceptingDataMessage
¾	¾	 4
(
¾	¾	4 5
byte
¿	¿	 
stream
¿	¿	 
,
¿	¿	 
byte
À	À	 
function
À	À	 
)
Á	Á	 
{
Â	Â	 	
const
Ã	Ã	 
string
Ã	Ã	 
	KeyFormat
Ã	Ã	 "
=
Ã	Ã	# $
$str
Ã	Ã	% .
;
Ã	Ã	. /
try
Å	Å	 
{
Æ	Æ	 
return
Ç	Ç	 .
 m_fSecs1InterceptingDataMessages
Ç	Ç	 7
.
Ç	Ç	7 8
ContainsKey
Ç	Ç	8 C
(
Ç	Ç	C D
string
Ç	Ç	D J
.
Ç	Ç	J K
Format
Ç	Ç	K Q
(
Ç	Ç	Q R
	KeyFormat
Ç	Ç	R [
,
Ç	Ç	[ \
stream
Ç	Ç	] c
.
Ç	Ç	c d
ToString
Ç	Ç	d l
(
Ç	Ç	l m
)
Ç	Ç	m n
,
Ç	Ç	n o
function
Ç	Ç	p x
.
Ç	Ç	x y
ToStringÇ	Ç	y 
(Ç	Ç	 ‚
)Ç	Ç	‚ ƒ
)Ç	Ç	ƒ „
)Ç	Ç	„ …
;Ç	Ç	… †
}
È	È	 
catch
É	É	 
(
É	É	 
	Exception
É	É	 
ex
É	É	 
)
É	É	  
{
Ê	Ê	 
FDebug
Ë	Ë	 
.
Ë	Ë	 
throwException
Ë	Ë	 %
(
Ë	Ë	% &
ex
Ë	Ë	& (
)
Ë	Ë	( )
;
Ë	Ë	) *
}
Ì	Ì	 
finally
Í	Í	 
{
Î	Î	 
}
Ğ	Ğ	 
return
Ñ	Ñ	 
false
Ñ	Ñ	 
;
Ñ	Ñ	 
}
Ò	Ò	 	
internal
Ö	Ö	 
bool
Ö	Ö	 +
isHsmsInterceptingDataMessage
Ö	Ö	 3
(
Ö	Ö	3 4
byte
×	×	 
stream
×	×	 
,
×	×	 
byte
Ø	Ø	 
function
Ø	Ø	 
)
Ù	Ù	 
{
Ú	Ú	 	
const
Û	Û	 
string
Û	Û	 
	KeyFormat
Û	Û	 "
=
Û	Û	# $
$str
Û	Û	% .
;
Û	Û	. /
try
İ	İ	 
{
Ş	Ş	 
return
ß	ß	 -
m_fHsmsInterceptingDataMessages
ß	ß	 6
.
ß	ß	6 7
ContainsKey
ß	ß	7 B
(
ß	ß	B C
string
ß	ß	C I
.
ß	ß	I J
Format
ß	ß	J P
(
ß	ß	P Q
	KeyFormat
ß	ß	Q Z
,
ß	ß	Z [
stream
ß	ß	\ b
.
ß	ß	b c
ToString
ß	ß	c k
(
ß	ß	k l
)
ß	ß	l m
,
ß	ß	m n
function
ß	ß	o w
.
ß	ß	w x
ToStringß	ß	x €
(ß	ß	€ 
)ß	ß	 ‚
)ß	ß	‚ ƒ
)ß	ß	ƒ „
;ß	ß	„ …
}
à	à	 
catch
á	á	 
(
á	á	 
	Exception
á	á	 
ex
á	á	 
)
á	á	  
{
â	â	 
FDebug
ã	ã	 
.
ã	ã	 
throwException
ã	ã	 %
(
ã	ã	% &
ex
ã	ã	& (
)
ã	ã	( )
;
ã	ã	) *
}
ä	ä	 
finally
å	å	 
{
æ	æ	 
}
è	è	 
return
é	é	 
false
é	é	 
;
é	é	 
}
ê	ê	 	
public
î	î	 
void
î	î	 "
sendSecs1DataMessage
î	î	 (
(
î	î	( )&
FSecsDataMessageTransfer
ï	ï	 $&
fSecsDataMessageTransfer
ï	ï	% =
)
ğ	ğ	 
{
ñ	ñ	 	
try
ò	ò	 
{
ó	ó	 "
sendSecs1DataMessage
ô	ô	 $
(
ô	ô	$ %&
fSecsDataMessageTransfer
ô	ô	% =
.
ô	ô	= > 
getSecsDataMessage
ô	ô	> P
(
ô	ô	P Q
)
ô	ô	Q R
)
ô	ô	R S
;
ô	ô	S T
}
õ	õ	 
catch
ö	ö	 
(
ö	ö	 
	Exception
ö	ö	 
ex
ö	ö	 
)
ö	ö	  
{
÷	÷	 
FDebug
ø	ø	 
.
ø	ø	 
throwException
ø	ø	 %
(
ø	ø	% &
ex
ø	ø	& (
)
ø	ø	( )
;
ø	ø	) *
}
ù	ù	 
finally
ú	ú	 
{
û	û	 
}
ı	ı	 
}
ş	ş	 	
public
‚
‚
 
void
‚
‚
 !
sendHsmsDataMessage
‚
‚
 '
(
‚
‚
' (&
FSecsDataMessageTransfer
ƒ
ƒ
 $&
fSecsDataMessageTransfer
ƒ
ƒ
% =
)
„
„
 
{
…
…
 	
try
†
†
 
{
‡
‡
 !
sendHsmsDataMessage
ˆ
ˆ
 #
(
ˆ
ˆ
# $&
fSecsDataMessageTransfer
ˆ
ˆ
$ <
.
ˆ
ˆ
< = 
getSecsDataMessage
ˆ
ˆ
= O
(
ˆ
ˆ
O P
)
ˆ
ˆ
P Q
)
ˆ
ˆ
Q R
;
ˆ
ˆ
R S
}
‰
‰
 
catch
Š
Š
 
(
Š
Š
 
	Exception
Š
Š
 
ex
Š
Š
 
)
Š
Š
  
{
‹
‹
 
FDebug
Œ
Œ
 
.
Œ
Œ
 
throwException
Œ
Œ
 %
(
Œ
Œ
% &
ex
Œ
Œ
& (
)
Œ
Œ
( )
;
Œ
Œ
) *
}


 
finally


 
{


 
}
‘
‘
 
}
’
’
 	
public
–
–
 
void
–
–
 
writeAppLog
–
–
 
(
–
–
  
string
—
—
 
log
—
—
 
)
˜
˜
 
{
™
™
 	
try
š
š
 
{
›
›
 
m_fLogWriter
œ
œ
 
.
œ
œ
 
write
œ
œ
 "
(
œ
œ
" #
log
œ
œ
# &
)
œ
œ
& '
;
œ
œ
' (
}


 
catch


 
(


 
	Exception


 
ex


 
)


  
{
Ÿ
Ÿ
 
FDebug
 
 
 
.
 
 
 
throwException
 
 
 %
(
 
 
% &
ex
 
 
& (
)
 
 
( )
;
 
 
) *
}
¡
¡
 
finally
¢
¢
 
{
£
£
 
}
¥
¥
 
}
¦
¦
 	
}
¬
¬
 
}­
­
 ¤´
sD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Config\c_FSecs1Config.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
public 

class 
FSecs1Config 
: 
IDisposable *
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FSecs1ToHsms 
m_fSecs1ToHsms +
=, -
null. 2
;2 3
private 
UInt16 
m_sessionId "
=# $
$num% &
;& '
private 
string 
m_serialPort #
=$ %
$str& ,
;, -
private   
int   
m_baud   
=   
$num   !
;  ! "
private!! 
bool!! 
m_rbit!! 
=!! 
false!! #
;!!# $
private"" 
bool"" 
m_interleave"" !
=""" #
true""$ (
;""( )
private## 
bool## 
m_duplicateError## %
=##& '
true##( ,
;##, -
private$$ 
bool$$ 
m_ignoreSystemBytes$$ (
=$$) *
false$$+ 0
;$$0 1
private%% 
int%% 
m_retryLimit%%  
=%%! "
$num%%# $
;%%$ %
private'' 
float'' 
m_t1Timeout'' !
=''" #
$num''$ (
;''( )
private(( 
float(( 
m_t2Timeout(( !
=((" #
$num(($ &
;((& '
private)) 
int)) 
m_t3Timeout)) 
=))  !
$num))" $
;))$ %
private** 
int** 
m_t4Timeout** 
=**  !
$num**" $
;**$ %
internal00 
FSecs1Config00 
(00 
FSecs1ToHsms11 
fSecs1ToHsms11 %
)22 
{33 	
m_fSecs1ToHsms44 
=44 
fSecs1ToHsms44 )
;44) *
}55 	
~99 	
FSecs1Config99	 
(99 
):: 
{;; 	
	myDispose<< 
(<< 
false<< 
)<< 
;<< 
}== 	
	protectedAA 
voidAA 
	myDisposeAA  
(AA  !
boolBB 
	disposingBB 
)CC 
{DD 	
ifEE 
(EE 
!EE 

m_disposedEE 
)EE 
{FF 
ifGG 
(GG 
	disposingGG 
)GG 
{HH 
m_fSecs1ToHsmsII "
=II# $
nullII% )
;II) *
}JJ 

m_disposedLL 
=LL 
trueLL !
;LL! "
}MM 
}NN 	
publicVV 
voidVV 
DisposeVV 
(VV 
)WW 
{XX 	
	myDisposeYY 
(YY 
trueYY 
)YY 
;YY 
GCZZ 
.ZZ 
SuppressFinalizeZZ 
(ZZ  
thisZZ  $
)ZZ$ %
;ZZ% &
}[[ 	
publiccc 
UInt16cc 
	sessionIdcc 
{dd 	
getee 
{ff 
trygg 
{hh 
returnii 
m_sessionIdii &
;ii& '
}jj 
catchkk 
(kk 
	Exceptionkk  
exkk! #
)kk# $
{ll 
FDebugmm 
.mm 
throwExceptionmm )
(mm) *
exmm* ,
)mm, -
;mm- .
}nn 
finallyoo 
{pp 
}rr 
returnss 
$numss 
;ss 
}tt 
setvv 
{ww 
tryxx 
{yy 
m_sessionIdzz 
=zz  !
valuezz" '
;zz' (
}{{ 
catch|| 
(|| 
	Exception||  
ex||! #
)||# $
{}} 
FDebug~~ 
.~~ 
throwException~~ )
(~~) *
ex~~* ,
)~~, -
;~~- .
} 
finally
€€ 
{
 
}
ƒƒ 
}
„„ 
}
…… 	
public
‰‰ 
string
‰‰ 

serialPort
‰‰  
{
ŠŠ 	
get
‹‹ 
{
ŒŒ 
try
 
{
 
return
 
m_serialPort
 '
;
' (
}
 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘  
ex
‘‘! #
)
‘‘# $
{
’’ 
FDebug
““ 
.
““ 
throwException
““ )
(
““) *
ex
““* ,
)
““, -
;
““- .
}
”” 
finally
•• 
{
–– 
}
˜˜ 
return
™™ 
string
™™ 
.
™™ 
Empty
™™ #
;
™™# $
}
šš 
set
œœ 
{
 
try
 
{
ŸŸ 
validateState
   !
(
  ! "
)
  " #
;
  # $
if
¢¢ 
(
¢¢ 
value
¢¢ 
.
¢¢ 
Trim
¢¢ "
(
¢¢" #
)
¢¢# $
==
¢¢% '
string
¢¢( .
.
¢¢. /
Empty
¢¢/ 4
)
¢¢4 5
{
££ 
FDebug
¤¤ 
.
¤¤ 
throwFException
¤¤ .
(
¤¤. /
string
¤¤/ 5
.
¤¤5 6
Format
¤¤6 <
(
¤¤< =

FConstants
¤¤= G
.
¤¤G H

err_m_0015
¤¤H R
,
¤¤R S
$str
¤¤T a
)
¤¤a b
)
¤¤b c
;
¤¤c d
}
¥¥ 
m_serialPort
§§  
=
§§! "
value
§§# (
;
§§( )
}
¨¨ 
catch
©© 
(
©© 
	Exception
©©  
ex
©©! #
)
©©# $
{
ªª 
FDebug
«« 
.
«« 
throwException
«« )
(
««) *
ex
««* ,
)
««, -
;
««- .
}
¬¬ 
finally
­­ 
{
®® 
}
°° 
}
±± 
}
²² 	
public
¶¶ 
int
¶¶ 
baud
¶¶ 
{
·· 	
get
¸¸ 
{
¹¹ 
try
ºº 
{
»» 
return
¼¼ 
m_baud
¼¼ !
;
¼¼! "
}
½½ 
catch
¾¾ 
(
¾¾ 
	Exception
¾¾  
ex
¾¾! #
)
¾¾# $
{
¿¿ 
FDebug
ÀÀ 
.
ÀÀ 
throwException
ÀÀ )
(
ÀÀ) *
ex
ÀÀ* ,
)
ÀÀ, -
;
ÀÀ- .
}
ÁÁ 
finally
ÂÂ 
{
ÃÃ 
}
ÅÅ 
return
ÆÆ 
$num
ÆÆ 
;
ÆÆ 
}
ÇÇ 
set
ÉÉ 
{
ÊÊ 
try
ËË 
{
ÌÌ 
validateState
ÍÍ !
(
ÍÍ! "
)
ÍÍ" #
;
ÍÍ# $
if
ÏÏ 
(
ÏÏ 
value
ÏÏ 
<
ÏÏ 
$num
ÏÏ  !
)
ÏÏ! "
{
ĞĞ 
FDebug
ÑÑ 
.
ÑÑ 
throwFException
ÑÑ .
(
ÑÑ. /
string
ÑÑ/ 5
.
ÑÑ5 6
Format
ÑÑ6 <
(
ÑÑ< =

FConstants
ÑÑ= G
.
ÑÑG H

err_m_0015
ÑÑH R
,
ÑÑR S
$str
ÑÑT Z
)
ÑÑZ [
)
ÑÑ[ \
;
ÑÑ\ ]
}
ÒÒ 
m_baud
ÔÔ 
=
ÔÔ 
value
ÔÔ "
;
ÔÔ" #
}
ÕÕ 
catch
ÖÖ 
(
ÖÖ 
	Exception
ÖÖ  
ex
ÖÖ! #
)
ÖÖ# $
{
×× 
FDebug
ØØ 
.
ØØ 
throwException
ØØ )
(
ØØ) *
ex
ØØ* ,
)
ØØ, -
;
ØØ- .
}
ÙÙ 
finally
ÚÚ 
{
ÛÛ 
}
İİ 
}
ŞŞ 
}
ßß 	
public
ãã 
bool
ãã 
rbit
ãã 
{
ää 	
get
åå 
{
ææ 
try
çç 
{
èè 
return
éé 
m_rbit
éé !
;
éé! "
}
êê 
catch
ëë 
(
ëë 
	Exception
ëë  
ex
ëë! #
)
ëë# $
{
ìì 
FDebug
íí 
.
íí 
throwException
íí )
(
íí) *
ex
íí* ,
)
íí, -
;
íí- .
}
îî 
finally
ïï 
{
ğğ 
}
òò 
return
óó 
false
óó 
;
óó 
}
ôô 
set
öö 
{
÷÷ 
try
øø 
{
ùù 
validateState
úú !
(
úú! "
)
úú" #
;
úú# $
m_rbit
üü 
=
üü 
value
üü "
;
üü" #
}
ıı 
catch
şş 
(
şş 
	Exception
şş  
ex
şş! #
)
şş# $
{
ÿÿ 
FDebug
€€ 
.
€€ 
throwException
€€ )
(
€€) *
ex
€€* ,
)
€€, -
;
€€- .
}
 
finally
‚‚ 
{
ƒƒ 
}
…… 
}
†† 
}
‡‡ 	
public
‹‹ 
bool
‹‹ 

interleave
‹‹ 
{
ŒŒ 	
get
 
{
 
try
 
{
 
return
‘‘ 
m_interleave
‘‘ '
;
‘‘' (
}
’’ 
catch
““ 
(
““ 
	Exception
““  
ex
““! #
)
““# $
{
”” 
FDebug
•• 
.
•• 
throwException
•• )
(
••) *
ex
••* ,
)
••, -
;
••- .
}
–– 
finally
—— 
{
˜˜ 
}
šš 
return
›› 
false
›› 
;
›› 
}
œœ 
set
 
{
ŸŸ 
try
   
{
¡¡ 
validateState
¢¢ !
(
¢¢! "
)
¢¢" #
;
¢¢# $
m_interleave
¤¤  
=
¤¤! "
value
¤¤# (
;
¤¤( )
}
¥¥ 
catch
¦¦ 
(
¦¦ 
	Exception
¦¦  
ex
¦¦! #
)
¦¦# $
{
§§ 
FDebug
¨¨ 
.
¨¨ 
throwException
¨¨ )
(
¨¨) *
ex
¨¨* ,
)
¨¨, -
;
¨¨- .
}
©© 
finally
ªª 
{
«« 
}
­­ 
}
®® 
}
¯¯ 	
public
³³ 
bool
³³ 
duplicateError
³³ "
{
´´ 	
get
µµ 
{
¶¶ 
try
·· 
{
¸¸ 
return
¹¹ 
m_duplicateError
¹¹ +
;
¹¹+ ,
}
ºº 
catch
»» 
(
»» 
	Exception
»»  
ex
»»! #
)
»»# $
{
¼¼ 
FDebug
½½ 
.
½½ 
throwException
½½ )
(
½½) *
ex
½½* ,
)
½½, -
;
½½- .
}
¾¾ 
finally
¿¿ 
{
ÀÀ 
}
ÂÂ 
return
ÃÃ 
false
ÃÃ 
;
ÃÃ 
}
ÄÄ 
set
ÆÆ 
{
ÇÇ 
try
ÈÈ 
{
ÉÉ 
validateState
ÊÊ !
(
ÊÊ! "
)
ÊÊ" #
;
ÊÊ# $
m_duplicateError
ÌÌ $
=
ÌÌ% &
value
ÌÌ' ,
;
ÌÌ, -
}
ÍÍ 
catch
ÎÎ 
(
ÎÎ 
	Exception
ÎÎ  
ex
ÎÎ! #
)
ÎÎ# $
{
ÏÏ 
FDebug
ĞĞ 
.
ĞĞ 
throwException
ĞĞ )
(
ĞĞ) *
ex
ĞĞ* ,
)
ĞĞ, -
;
ĞĞ- .
}
ÑÑ 
finally
ÒÒ 
{
ÓÓ 
}
ÕÕ 
}
ÖÖ 
}
×× 	
public
ÛÛ 
bool
ÛÛ 
ignoreSystemBytes
ÛÛ %
{
ÜÜ 	
get
İİ 
{
ŞŞ 
try
ßß 
{
àà 
return
áá !
m_ignoreSystemBytes
áá .
;
áá. /
}
ââ 
catch
ãã 
(
ãã 
	Exception
ãã  
ex
ãã! #
)
ãã# $
{
ää 
FDebug
åå 
.
åå 
throwException
åå )
(
åå) *
ex
åå* ,
)
åå, -
;
åå- .
}
ææ 
finally
çç 
{
èè 
}
êê 
return
ëë 
false
ëë 
;
ëë 
}
ìì 
set
îî 
{
ïï 
try
ğğ 
{
ññ 
validateState
òò !
(
òò! "
)
òò" #
;
òò# $!
m_ignoreSystemBytes
ôô '
=
ôô( )
value
ôô* /
;
ôô/ 0
}
õõ 
catch
öö 
(
öö 
	Exception
öö  
ex
öö! #
)
öö# $
{
÷÷ 
FDebug
øø 
.
øø 
throwException
øø )
(
øø) *
ex
øø* ,
)
øø, -
;
øø- .
}
ùù 
finally
úú 
{
ûû 
}
ıı 
}
şş 
}
ÿÿ 	
public
ƒƒ 
int
ƒƒ 

retryLimit
ƒƒ 
{
„„ 	
get
…… 
{
†† 
try
‡‡ 
{
ˆˆ 
return
‰‰ 
m_retryLimit
‰‰ '
;
‰‰' (
}
ŠŠ 
catch
‹‹ 
(
‹‹ 
	Exception
‹‹  
ex
‹‹! #
)
‹‹# $
{
ŒŒ 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
 
{
 
}
’’ 
return
““ 
$num
““ 
;
““ 
}
”” 
set
–– 
{
—— 
try
˜˜ 
{
™™ 
validateState
šš !
(
šš! "
)
šš" #
;
šš# $
if
œœ 
(
œœ 
value
œœ 
<
œœ 
$num
œœ  !
||
œœ" $
value
œœ% *
>
œœ+ ,
$num
œœ- /
)
œœ/ 0
{
 
FDebug
 
.
 
throwFException
 .
(
. /
string
/ 5
.
5 6
Format
6 <
(
< =

FConstants
= G
.
G H

err_m_0015
H R
,
R S
$str
T a
)
a b
)
b c
;
c d
}
ŸŸ 
m_retryLimit
¡¡  
=
¡¡! "
value
¡¡# (
;
¡¡( )
}
¢¢ 
catch
££ 
(
££ 
	Exception
££  
ex
££! #
)
££# $
{
¤¤ 
FDebug
¥¥ 
.
¥¥ 
throwException
¥¥ )
(
¥¥) *
ex
¥¥* ,
)
¥¥, -
;
¥¥- .
}
¦¦ 
finally
§§ 
{
¨¨ 
}
ªª 
}
«« 
}
¬¬ 	
public
°° 
float
°° 
	t1Timeout
°° 
{
±± 	
get
²² 
{
³³ 
try
´´ 
{
µµ 
return
¶¶ 
m_t1Timeout
¶¶ &
;
¶¶& '
}
·· 
catch
¸¸ 
(
¸¸ 
	Exception
¸¸  
ex
¸¸! #
)
¸¸# $
{
¹¹ 
FDebug
ºº 
.
ºº 
throwException
ºº )
(
ºº) *
ex
ºº* ,
)
ºº, -
;
ºº- .
}
»» 
finally
¼¼ 
{
½½ 
}
¿¿ 
return
ÀÀ 
$num
ÀÀ 
;
ÀÀ 
}
ÁÁ 
set
ÃÃ 
{
ÄÄ 
try
ÅÅ 
{
ÆÆ 
validateState
ÇÇ !
(
ÇÇ! "
)
ÇÇ" #
;
ÇÇ# $
if
ÉÉ 
(
ÉÉ 
value
ÉÉ 
<
ÉÉ 
$num
ÉÉ  $
||
ÉÉ% '
value
ÉÉ( -
>
ÉÉ. /
$num
ÉÉ0 5
)
ÉÉ5 6
{
ÊÊ 
FDebug
ËË 
.
ËË 
throwFException
ËË .
(
ËË. /
string
ËË/ 5
.
ËË5 6
Format
ËË6 <
(
ËË< =

FConstants
ËË= G
.
ËËG H

err_m_0015
ËËH R
,
ËËR S
$str
ËËT `
)
ËË` a
)
ËËa b
;
ËËb c
}
ÌÌ 
m_t1Timeout
ÎÎ 
=
ÎÎ  !
value
ÎÎ" '
;
ÎÎ' (
}
ÏÏ 
catch
ĞĞ 
(
ĞĞ 
	Exception
ĞĞ  
ex
ĞĞ! #
)
ĞĞ# $
{
ÑÑ 
FDebug
ÒÒ 
.
ÒÒ 
throwException
ÒÒ )
(
ÒÒ) *
ex
ÒÒ* ,
)
ÒÒ, -
;
ÒÒ- .
}
ÓÓ 
finally
ÔÔ 
{
ÕÕ 
}
×× 
}
ØØ 
}
ÙÙ 	
public
İİ 
float
İİ 
	t2Timeout
İİ 
{
ŞŞ 	
get
ßß 
{
àà 
try
áá 
{
ââ 
return
ãã 
m_t2Timeout
ãã &
;
ãã& '
}
ää 
catch
åå 
(
åå 
	Exception
åå  
ex
åå! #
)
åå# $
{
ææ 
FDebug
çç 
.
çç 
throwException
çç )
(
çç) *
ex
çç* ,
)
çç, -
;
çç- .
}
èè 
finally
éé 
{
êê 
}
ìì 
return
íí 
$num
íí 
;
íí 
}
îî 
set
ğğ 
{
ññ 
try
òò 
{
óó 
validateState
ôô !
(
ôô! "
)
ôô" #
;
ôô# $
if
öö 
(
öö 
value
öö 
<
öö 
$num
öö  $
||
öö% '
value
öö( -
>
öö. /
$num
öö0 5
)
öö5 6
{
÷÷ 
FDebug
øø 
.
øø 
throwFException
øø .
(
øø. /
string
øø/ 5
.
øø5 6
Format
øø6 <
(
øø< =

FConstants
øø= G
.
øøG H

err_m_0015
øøH R
,
øøR S
$str
øøT `
)
øø` a
)
øøa b
;
øøb c
}
ùù 
m_t2Timeout
ûû 
=
ûû  !
value
ûû" '
;
ûû' (
}
üü 
catch
ıı 
(
ıı 
	Exception
ıı  
ex
ıı! #
)
ıı# $
{
şş 
FDebug
ÿÿ 
.
ÿÿ 
throwException
ÿÿ )
(
ÿÿ) *
ex
ÿÿ* ,
)
ÿÿ, -
;
ÿÿ- .
}
€€ 
finally
 
{
‚‚ 
}
„„ 
}
…… 
}
†† 	
public
ŠŠ 
int
ŠŠ 
	t3Timeout
ŠŠ 
{
‹‹ 	
get
ŒŒ 
{
 
try
 
{
 
return
 
m_t3Timeout
 &
;
& '
}
‘‘ 
catch
’’ 
(
’’ 
	Exception
’’  
ex
’’! #
)
’’# $
{
““ 
FDebug
”” 
.
”” 
throwException
”” )
(
””) *
ex
””* ,
)
””, -
;
””- .
}
•• 
finally
–– 
{
—— 
}
™™ 
return
šš 
$num
šš 
;
šš 
}
›› 
set
 
{
 
try
ŸŸ 
{
   
validateState
¡¡ !
(
¡¡! "
)
¡¡" #
;
¡¡# $
if
££ 
(
££ 
value
££ 
<
££ 
$num
££  !
||
££" $
value
££% *
>
££+ ,
$num
££- 0
)
££0 1
{
¤¤ 
FDebug
¥¥ 
.
¥¥ 
throwFException
¥¥ .
(
¥¥. /
string
¥¥/ 5
.
¥¥5 6
Format
¥¥6 <
(
¥¥< =

FConstants
¥¥= G
.
¥¥G H

err_m_0015
¥¥H R
,
¥¥R S
$str
¥¥T `
)
¥¥` a
)
¥¥a b
;
¥¥b c
}
¦¦ 
m_t3Timeout
¨¨ 
=
¨¨  !
value
¨¨" '
;
¨¨' (
}
©© 
catch
ªª 
(
ªª 
	Exception
ªª  
ex
ªª! #
)
ªª# $
{
«« 
FDebug
¬¬ 
.
¬¬ 
throwException
¬¬ )
(
¬¬) *
ex
¬¬* ,
)
¬¬, -
;
¬¬- .
}
­­ 
finally
®® 
{
¯¯ 
}
±± 
}
²² 
}
³³ 	
public
·· 
int
·· 
	t4Timeout
·· 
{
¸¸ 	
get
¹¹ 
{
ºº 
try
»» 
{
¼¼ 
return
½½ 
m_t4Timeout
½½ &
;
½½& '
}
¾¾ 
catch
¿¿ 
(
¿¿ 
	Exception
¿¿  
ex
¿¿! #
)
¿¿# $
{
ÀÀ 
FDebug
ÁÁ 
.
ÁÁ 
throwException
ÁÁ )
(
ÁÁ) *
ex
ÁÁ* ,
)
ÁÁ, -
;
ÁÁ- .
}
ÂÂ 
finally
ÃÃ 
{
ÄÄ 
}
ÆÆ 
return
ÇÇ 
$num
ÇÇ 
;
ÇÇ 
}
ÈÈ 
set
ÊÊ 
{
ËË 
try
ÌÌ 
{
ÍÍ 
validateState
ÎÎ !
(
ÎÎ! "
)
ÎÎ" #
;
ÎÎ# $
if
ĞĞ 
(
ĞĞ 
value
ĞĞ 
<
ĞĞ 
$num
ĞĞ  !
||
ĞĞ" $
value
ĞĞ% *
>
ĞĞ+ ,
$num
ĞĞ- 0
)
ĞĞ0 1
{
ÑÑ 
FDebug
ÒÒ 
.
ÒÒ 
throwFException
ÒÒ .
(
ÒÒ. /
string
ÒÒ/ 5
.
ÒÒ5 6
Format
ÒÒ6 <
(
ÒÒ< =

FConstants
ÒÒ= G
.
ÒÒG H

err_m_0015
ÒÒH R
,
ÒÒR S
$str
ÒÒT `
)
ÒÒ` a
)
ÒÒa b
;
ÒÒb c
}
ÓÓ 
m_t4Timeout
ÕÕ 
=
ÕÕ  !
value
ÕÕ" '
;
ÕÕ' (
}
ÖÖ 
catch
×× 
(
×× 
	Exception
××  
ex
××! #
)
××# $
{
ØØ 
FDebug
ÙÙ 
.
ÙÙ 
throwException
ÙÙ )
(
ÙÙ) *
ex
ÙÙ* ,
)
ÙÙ, -
;
ÙÙ- .
}
ÚÚ 
finally
ÛÛ 
{
ÜÜ 
}
ŞŞ 
}
ßß 
}
àà 	
private
èè 
void
èè 
validateState
èè "
(
èè" #
)
éé 
{
êê 	
try
ëë 
{
ìì 
if
íí 
(
íí 
m_fSecs1ToHsms
íí "
.
íí" #
fSecs1State
íí# .
!=
íí/ 1!
FCommunicationState
íí2 E
.
ííE F
Closed
ííF L
)
ííL M
{
îî 
FDebug
ïï 
.
ïï 
throwFException
ïï *
(
ïï* +
string
ïï+ 1
.
ïï1 2
Format
ïï2 8
(
ïï8 9

FConstants
ïï9 C
.
ïïC D

err_m_0027
ïïD N
,
ïïN O
$str
ïïP \
)
ïï\ ]
)
ïï] ^
;
ïï^ _
}
ğğ 
}
ññ 
catch
òò 
(
òò 
	Exception
òò 
ex
òò 
)
òò  
{
óó 
FDebug
ôô 
.
ôô 
throwException
ôô %
(
ôô% &
ex
ôô& (
)
ôô( )
;
ôô) *
}
õõ 
finally
öö 
{
÷÷ 
}
ùù 
}
úú 	
}
€€ 
} íÂ
rD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Config\c_FHsmsConfig.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
public 

class 
FHsmsConfig 
: 
IDisposable )
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FSecs1ToHsms 
m_fSecs1ToHsms +
=, -
null. 2
;2 3
private 
UInt16 
m_sessionId "
=# $
$num% &
;& '
private 
FConnectMode 
m_fConnectMode +
=, -
FConnectMode. :
.: ;
Passive; B
;B C
private   
string   
	m_localIp    
=  ! "
$str  # .
;  . /
private!! 
int!! 
m_localPort!! 
=!!  !
$num!!" &
;!!& '
private"" 
string"" 

m_remoteIp"" !
=""" #
$str""$ /
;""/ 0
private## 
int## 
m_remotePort##  
=##! "
$num### '
;##' (
private$$ 
int$$ 
m_linkTestPeriod$$ $
=$$% &
$num$$' )
;$$) *
private%% 
int%% 
m_t3Timeout%% 
=%%  !
$num%%" $
;%%$ %
private&& 
int&& 
m_t5Timeout&& 
=&&  !
$num&&" $
;&&$ %
private'' 
int'' 
m_t6Timeout'' 
=''  !
$num''" #
;''# $
private(( 
int(( 
m_t7Timeout(( 
=((  !
$num((" $
;(($ %
private)) 
int)) 
m_t8Timeout)) 
=))  !
$num))" #
;))# $
internal// 
FHsmsConfig// 
(// 
FSecs1ToHsms00 
fSecs1ToHsms00 %
)11 
{22 	
m_fSecs1ToHsms33 
=33 
fSecs1ToHsms33 )
;33) *
}44 	
~88 	
FHsmsConfig88	 
(88 
)99 
{:: 	
	myDispose;; 
(;; 
false;; 
);; 
;;; 
}<< 	
	protected@@ 
void@@ 
	myDispose@@  
(@@  !
boolAA 
	disposingAA 
)BB 
{CC 	
ifDD 
(DD 
!DD 

m_disposedDD 
)DD 
{EE 
ifFF 
(FF 
	disposingFF 
)FF 
{GG 
m_fSecs1ToHsmsHH "
=HH# $
nullHH% )
;HH) *
}II 

m_disposedKK 
=KK 
trueKK !
;KK! "
}LL 
}MM 	
publicUU 
voidUU 
DisposeUU 
(UU 
)VV 
{WW 	
	myDisposeXX 
(XX 
trueXX 
)XX 
;XX 
GCYY 
.YY 
SuppressFinalizeYY 
(YY  
thisYY  $
)YY$ %
;YY% &
}ZZ 	
publicbb 
UInt16bb 
	sessionIdbb 
{cc 	
getdd 
{ee 
tryff 
{gg 
returnhh 
m_sessionIdhh &
;hh& '
}ii 
catchjj 
(jj 
	Exceptionjj  
exjj! #
)jj# $
{kk 
FDebugll 
.ll 
throwExceptionll )
(ll) *
exll* ,
)ll, -
;ll- .
}mm 
finallynn 
{oo 
}qq 
returnrr 
$numrr 
;rr 
}ss 
setuu 
{vv 
tryww 
{xx 
m_sessionIdyy 
=yy  !
valueyy" '
;yy' (
}zz 
catch{{ 
({{ 
	Exception{{  
ex{{! #
){{# $
{|| 
FDebug}} 
.}} 
throwException}} )
(}}) *
ex}}* ,
)}}, -
;}}- .
}~~ 
finally 
{
€€ 
}
‚‚ 
}
ƒƒ 
}
„„ 	
public
ˆˆ 
FConnectMode
ˆˆ 
fConnectMode
ˆˆ (
{
‰‰ 	
get
ŠŠ 
{
‹‹ 
try
ŒŒ 
{
 
return
 
m_fConnectMode
 )
;
) *
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
‘‘ 
FDebug
’’ 
.
’’ 
throwException
’’ )
(
’’) *
ex
’’* ,
)
’’, -
;
’’- .
}
““ 
finally
”” 
{
•• 
}
—— 
return
˜˜ 
FConnectMode
˜˜ #
.
˜˜# $
Passive
˜˜$ +
;
˜˜+ ,
}
™™ 
set
›› 
{
œœ 
try
 
{
 
validateState
ŸŸ !
(
ŸŸ! "
)
ŸŸ" #
;
ŸŸ# $
m_fConnectMode
¡¡ "
=
¡¡# $
value
¡¡% *
;
¡¡* +
}
¢¢ 
catch
££ 
(
££ 
	Exception
££  
ex
££! #
)
££# $
{
¤¤ 
FDebug
¥¥ 
.
¥¥ 
throwException
¥¥ )
(
¥¥) *
ex
¥¥* ,
)
¥¥, -
;
¥¥- .
}
¦¦ 
finally
§§ 
{
¨¨ 
}
ªª 
}
«« 
}
¬¬ 	
public
°° 
string
°° 
localIp
°° 
{
±± 	
get
²² 
{
³³ 
try
´´ 
{
µµ 
return
¶¶ 
	m_localIp
¶¶ $
;
¶¶$ %
}
·· 
catch
¸¸ 
(
¸¸ 
	Exception
¸¸  
ex
¸¸! #
)
¸¸# $
{
¹¹ 
FDebug
ºº 
.
ºº 
throwException
ºº )
(
ºº) *
ex
ºº* ,
)
ºº, -
;
ºº- .
}
»» 
finally
¼¼ 
{
½½ 
}
¿¿ 
return
ÀÀ 
string
ÀÀ 
.
ÀÀ 
Empty
ÀÀ #
;
ÀÀ# $
}
ÁÁ 
set
ÃÃ 
{
ÄÄ 
try
ÅÅ 
{
ÆÆ 
validateState
ÇÇ !
(
ÇÇ! "
)
ÇÇ" #
;
ÇÇ# $
if
ÉÉ 
(
ÉÉ 
value
ÉÉ 
.
ÉÉ 
Trim
ÉÉ "
(
ÉÉ" #
)
ÉÉ# $
==
ÉÉ% '
string
ÉÉ( .
.
ÉÉ. /
Empty
ÉÉ/ 4
)
ÉÉ4 5
{
ÊÊ 
FDebug
ËË 
.
ËË 
throwFException
ËË .
(
ËË. /
string
ËË/ 5
.
ËË5 6
Format
ËË6 <
(
ËË< =

FConstants
ËË= G
.
ËËG H

err_m_0015
ËËH R
,
ËËR S
$str
ËËT ^
)
ËË^ _
)
ËË_ `
;
ËË` a
}
ÌÌ 
	m_localIp
ÎÎ 
=
ÎÎ 
value
ÎÎ  %
;
ÎÎ% &
}
ÏÏ 
catch
ĞĞ 
(
ĞĞ 
	Exception
ĞĞ  
ex
ĞĞ! #
)
ĞĞ# $
{
ÑÑ 
FDebug
ÒÒ 
.
ÒÒ 
throwException
ÒÒ )
(
ÒÒ) *
ex
ÒÒ* ,
)
ÒÒ, -
;
ÒÒ- .
}
ÓÓ 
finally
ÔÔ 
{
ÕÕ 
}
×× 
}
ØØ 
}
ÙÙ 	
public
İİ 
int
İİ 
	localPort
İİ 
{
ŞŞ 	
get
ßß 
{
àà 
try
áá 
{
ââ 
return
ãã 
m_localPort
ãã &
;
ãã& '
}
ää 
catch
åå 
(
åå 
	Exception
åå  
ex
åå! #
)
åå# $
{
ææ 
FDebug
çç 
.
çç 
throwException
çç )
(
çç) *
ex
çç* ,
)
çç, -
;
çç- .
}
èè 
finally
éé 
{
êê 
}
ìì 
return
íí 
$num
íí 
;
íí 
}
îî 
set
ğğ 
{
ññ 
try
òò 
{
óó 
validateState
ôô !
(
ôô! "
)
ôô" #
;
ôô# $
if
öö 
(
öö 
value
öö 
<
öö 
$num
öö  !
||
öö" $
value
öö% *
>
öö+ ,
$num
öö- 2
)
öö2 3
{
÷÷ 
FDebug
øø 
.
øø 
throwFException
øø .
(
øø. /
string
øø/ 5
.
øø5 6
Format
øø6 <
(
øø< =

FConstants
øø= G
.
øøG H

err_m_0015
øøH R
,
øøR S
$str
øøT `
)
øø` a
)
øøa b
;
øøb c
}
ùù 
m_localPort
ûû 
=
ûû  !
value
ûû" '
;
ûû' (
}
üü 
catch
ıı 
(
ıı 
	Exception
ıı  
ex
ıı! #
)
ıı# $
{
şş 
FDebug
ÿÿ 
.
ÿÿ 
throwException
ÿÿ )
(
ÿÿ) *
ex
ÿÿ* ,
)
ÿÿ, -
;
ÿÿ- .
}
€€ 
finally
 
{
‚‚ 
}
„„ 
}
…… 
}
†† 	
public
ŠŠ 
string
ŠŠ 
remoteIp
ŠŠ 
{
‹‹ 	
get
ŒŒ 
{
 
try
 
{
 
return
 

m_remoteIp
 %
;
% &
}
‘‘ 
catch
’’ 
(
’’ 
	Exception
’’  
ex
’’! #
)
’’# $
{
““ 
FDebug
”” 
.
”” 
throwException
”” )
(
””) *
ex
””* ,
)
””, -
;
””- .
}
•• 
finally
–– 
{
—— 
}
™™ 
return
šš 
string
šš 
.
šš 
Empty
šš #
;
šš# $
}
›› 
set
 
{
 
try
ŸŸ 
{
   
validateState
¡¡ !
(
¡¡! "
)
¡¡" #
;
¡¡# $
if
££ 
(
££ 
value
££ 
.
££ 
Trim
££ "
(
££" #
)
££# $
==
££% '
string
££( .
.
££. /
Empty
££/ 4
)
££4 5
{
¤¤ 
FDebug
¥¥ 
.
¥¥ 
throwFException
¥¥ .
(
¥¥. /
string
¥¥/ 5
.
¥¥5 6
Format
¥¥6 <
(
¥¥< =

FConstants
¥¥= G
.
¥¥G H

err_m_0015
¥¥H R
,
¥¥R S
$str
¥¥T _
)
¥¥_ `
)
¥¥` a
;
¥¥a b
}
¦¦ 

m_remoteIp
¨¨ 
=
¨¨  
value
¨¨! &
;
¨¨& '
}
©© 
catch
ªª 
(
ªª 
	Exception
ªª  
ex
ªª! #
)
ªª# $
{
«« 
FDebug
¬¬ 
.
¬¬ 
throwException
¬¬ )
(
¬¬) *
ex
¬¬* ,
)
¬¬, -
;
¬¬- .
}
­­ 
finally
®® 
{
¯¯ 
}
±± 
}
²² 
}
³³ 	
public
·· 
int
·· 

remotePort
·· 
{
¸¸ 	
get
¹¹ 
{
ºº 
try
»» 
{
¼¼ 
return
½½ 
m_remotePort
½½ '
;
½½' (
}
¾¾ 
catch
¿¿ 
(
¿¿ 
	Exception
¿¿  
ex
¿¿! #
)
¿¿# $
{
ÀÀ 
FDebug
ÁÁ 
.
ÁÁ 
throwException
ÁÁ )
(
ÁÁ) *
ex
ÁÁ* ,
)
ÁÁ, -
;
ÁÁ- .
}
ÂÂ 
finally
ÃÃ 
{
ÄÄ 
}
ÆÆ 
return
ÇÇ 
$num
ÇÇ 
;
ÇÇ 
}
ÈÈ 
set
ÊÊ 
{
ËË 
try
ÌÌ 
{
ÍÍ 
validateState
ÎÎ !
(
ÎÎ! "
)
ÎÎ" #
;
ÎÎ# $
if
ĞĞ 
(
ĞĞ 
value
ĞĞ 
<
ĞĞ 
$num
ĞĞ  !
||
ĞĞ" $
value
ĞĞ% *
>
ĞĞ+ ,
$num
ĞĞ- 2
)
ĞĞ2 3
{
ÑÑ 
FDebug
ÒÒ 
.
ÒÒ 
throwFException
ÒÒ .
(
ÒÒ. /
string
ÒÒ/ 5
.
ÒÒ5 6
Format
ÒÒ6 <
(
ÒÒ< =

FConstants
ÒÒ= G
.
ÒÒG H

err_m_0015
ÒÒH R
,
ÒÒR S
$str
ÒÒT a
)
ÒÒa b
)
ÒÒb c
;
ÒÒc d
}
ÓÓ 
m_remotePort
ÕÕ  
=
ÕÕ! "
value
ÕÕ# (
;
ÕÕ( )
}
ÖÖ 
catch
×× 
(
×× 
	Exception
××  
ex
××! #
)
××# $
{
ØØ 
FDebug
ÙÙ 
.
ÙÙ 
throwException
ÙÙ )
(
ÙÙ) *
ex
ÙÙ* ,
)
ÙÙ, -
;
ÙÙ- .
}
ÚÚ 
finally
ÛÛ 
{
ÜÜ 
}
ŞŞ 
}
ßß 
}
àà 	
public
ää 
int
ää 
linkTestPeriod
ää !
{
åå 	
get
ææ 
{
çç 
try
èè 
{
éé 
return
êê 
m_linkTestPeriod
êê +
;
êê+ ,
}
ëë 
catch
ìì 
(
ìì 
	Exception
ìì  
ex
ìì! #
)
ìì# $
{
íí 
FDebug
îî 
.
îî 
throwException
îî )
(
îî) *
ex
îî* ,
)
îî, -
;
îî- .
}
ïï 
finally
ğğ 
{
ññ 
}
óó 
return
ôô 
$num
ôô 
;
ôô 
}
õõ 
set
÷÷ 
{
øø 
try
ùù 
{
úú 
validateState
ûû !
(
ûû! "
)
ûû" #
;
ûû# $
if
ıı 
(
ıı 
value
ıı 
<
ıı 
$num
ıı  !
||
ıı" $
value
ıı% *
>
ıı+ ,
$num
ıı- 0
)
ıı0 1
{
şş 
FDebug
ÿÿ 
.
ÿÿ 
throwFException
ÿÿ .
(
ÿÿ. /
string
ÿÿ/ 5
.
ÿÿ5 6
Format
ÿÿ6 <
(
ÿÿ< =

FConstants
ÿÿ= G
.
ÿÿG H

err_m_0015
ÿÿH R
,
ÿÿR S
$str
ÿÿT f
)
ÿÿf g
)
ÿÿg h
;
ÿÿh i
}
€€ 
m_linkTestPeriod
‚‚ $
=
‚‚% &
value
‚‚' ,
;
‚‚, -
}
ƒƒ 
catch
„„ 
(
„„ 
	Exception
„„  
ex
„„! #
)
„„# $
{
…… 
FDebug
†† 
.
†† 
throwException
†† )
(
††) *
ex
††* ,
)
††, -
;
††- .
}
‡‡ 
finally
ˆˆ 
{
‰‰ 
}
‹‹ 
}
ŒŒ 
}
 	
public
‘‘ 
int
‘‘ 
	t3Timeout
‘‘ 
{
’’ 	
get
““ 
{
”” 
try
•• 
{
–– 
return
—— 
m_t3Timeout
—— &
;
——& '
}
˜˜ 
catch
™™ 
(
™™ 
	Exception
™™  
ex
™™! #
)
™™# $
{
šš 
FDebug
›› 
.
›› 
throwException
›› )
(
››) *
ex
››* ,
)
››, -
;
››- .
}
œœ 
finally
 
{
 
}
   
return
¡¡ 
$num
¡¡ 
;
¡¡ 
}
¢¢ 
set
¤¤ 
{
¥¥ 
try
¦¦ 
{
§§ 
validateState
¨¨ !
(
¨¨! "
)
¨¨" #
;
¨¨# $
if
ªª 
(
ªª 
value
ªª 
<
ªª 
$num
ªª  !
||
ªª" $
value
ªª% *
>
ªª+ ,
$num
ªª- 0
)
ªª0 1
{
«« 
FDebug
¬¬ 
.
¬¬ 
throwFException
¬¬ .
(
¬¬. /
string
¬¬/ 5
.
¬¬5 6
Format
¬¬6 <
(
¬¬< =

FConstants
¬¬= G
.
¬¬G H

err_m_0015
¬¬H R
,
¬¬R S
$str
¬¬T `
)
¬¬` a
)
¬¬a b
;
¬¬b c
}
­­ 
m_t3Timeout
¯¯ 
=
¯¯  !
value
¯¯" '
;
¯¯' (
}
°° 
catch
±± 
(
±± 
	Exception
±±  
ex
±±! #
)
±±# $
{
²² 
FDebug
³³ 
.
³³ 
throwException
³³ )
(
³³) *
ex
³³* ,
)
³³, -
;
³³- .
}
´´ 
finally
µµ 
{
¶¶ 
}
¸¸ 
}
¹¹ 
}
ºº 	
public
¾¾ 
int
¾¾ 
	t5Timeout
¾¾ 
{
¿¿ 	
get
ÀÀ 
{
ÁÁ 
try
ÂÂ 
{
ÃÃ 
return
ÄÄ 
m_t5Timeout
ÄÄ &
;
ÄÄ& '
}
ÅÅ 
catch
ÆÆ 
(
ÆÆ 
	Exception
ÆÆ  
ex
ÆÆ! #
)
ÆÆ# $
{
ÇÇ 
FDebug
ÈÈ 
.
ÈÈ 
throwException
ÈÈ )
(
ÈÈ) *
ex
ÈÈ* ,
)
ÈÈ, -
;
ÈÈ- .
}
ÉÉ 
finally
ÊÊ 
{
ËË 
}
ÍÍ 
return
ÎÎ 
$num
ÎÎ 
;
ÎÎ 
}
ÏÏ 
set
ÑÑ 
{
ÒÒ 
try
ÓÓ 
{
ÔÔ 
validateState
ÕÕ !
(
ÕÕ! "
)
ÕÕ" #
;
ÕÕ# $
if
×× 
(
×× 
value
×× 
<
×× 
$num
××  !
||
××" $
value
××% *
>
××+ ,
$num
××- 0
)
××0 1
{
ØØ 
FDebug
ÙÙ 
.
ÙÙ 
throwFException
ÙÙ .
(
ÙÙ. /
string
ÙÙ/ 5
.
ÙÙ5 6
Format
ÙÙ6 <
(
ÙÙ< =

FConstants
ÙÙ= G
.
ÙÙG H

err_m_0015
ÙÙH R
,
ÙÙR S
$str
ÙÙT `
)
ÙÙ` a
)
ÙÙa b
;
ÙÙb c
}
ÚÚ 
m_t5Timeout
ÜÜ 
=
ÜÜ  !
value
ÜÜ" '
;
ÜÜ' (
}
İİ 
catch
ŞŞ 
(
ŞŞ 
	Exception
ŞŞ  
ex
ŞŞ! #
)
ŞŞ# $
{
ßß 
FDebug
àà 
.
àà 
throwException
àà )
(
àà) *
ex
àà* ,
)
àà, -
;
àà- .
}
áá 
finally
ââ 
{
ãã 
}
åå 
}
ææ 
}
çç 	
public
ëë 
int
ëë 
	t6Timeout
ëë 
{
ìì 	
get
íí 
{
îî 
try
ïï 
{
ğğ 
return
ññ 
m_t6Timeout
ññ &
;
ññ& '
}
òò 
catch
óó 
(
óó 
	Exception
óó  
ex
óó! #
)
óó# $
{
ôô 
FDebug
õõ 
.
õõ 
throwException
õõ )
(
õõ) *
ex
õõ* ,
)
õõ, -
;
õõ- .
}
öö 
finally
÷÷ 
{
øø 
}
úú 
return
ûû 
$num
ûû 
;
ûû 
}
üü 
set
şş 
{
ÿÿ 
try
€€ 
{
 
validateState
‚‚ !
(
‚‚! "
)
‚‚" #
;
‚‚# $
if
„„ 
(
„„ 
value
„„ 
<
„„ 
$num
„„  !
||
„„" $
value
„„% *
>
„„+ ,
$num
„„- 0
)
„„0 1
{
…… 
FDebug
†† 
.
†† 
throwFException
†† .
(
††. /
string
††/ 5
.
††5 6
Format
††6 <
(
††< =

FConstants
††= G
.
††G H

err_m_0015
††H R
,
††R S
$str
††T `
)
††` a
)
††a b
;
††b c
}
‡‡ 
m_t6Timeout
‰‰ 
=
‰‰  !
value
‰‰" '
;
‰‰' (
}
ŠŠ 
catch
‹‹ 
(
‹‹ 
	Exception
‹‹  
ex
‹‹! #
)
‹‹# $
{
ŒŒ 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
 
{
 
}
’’ 
}
““ 
}
”” 	
public
˜˜ 
int
˜˜ 
	t7Timeout
˜˜ 
{
™™ 	
get
šš 
{
›› 
try
œœ 
{
 
return
 
m_t7Timeout
 &
;
& '
}
ŸŸ 
catch
   
(
   
	Exception
    
ex
  ! #
)
  # $
{
¡¡ 
FDebug
¢¢ 
.
¢¢ 
throwException
¢¢ )
(
¢¢) *
ex
¢¢* ,
)
¢¢, -
;
¢¢- .
}
££ 
finally
¤¤ 
{
¥¥ 
}
§§ 
return
¨¨ 
$num
¨¨ 
;
¨¨ 
}
©© 
set
«« 
{
¬¬ 
try
­­ 
{
®® 
validateState
¯¯ !
(
¯¯! "
)
¯¯" #
;
¯¯# $
if
±± 
(
±± 
value
±± 
<
±± 
$num
±±  !
||
±±" $
value
±±% *
>
±±+ ,
$num
±±- 0
)
±±0 1
{
²² 
FDebug
³³ 
.
³³ 
throwFException
³³ .
(
³³. /
string
³³/ 5
.
³³5 6
Format
³³6 <
(
³³< =

FConstants
³³= G
.
³³G H

err_m_0015
³³H R
,
³³R S
$str
³³T `
)
³³` a
)
³³a b
;
³³b c
}
´´ 
m_t7Timeout
¶¶ 
=
¶¶  !
value
¶¶" '
;
¶¶' (
}
·· 
catch
¸¸ 
(
¸¸ 
	Exception
¸¸  
ex
¸¸! #
)
¸¸# $
{
¹¹ 
FDebug
ºº 
.
ºº 
throwException
ºº )
(
ºº) *
ex
ºº* ,
)
ºº, -
;
ºº- .
}
»» 
finally
¼¼ 
{
½½ 
}
¿¿ 
}
ÀÀ 
}
ÁÁ 	
public
ÅÅ 
int
ÅÅ 
	t8Timeout
ÅÅ 
{
ÆÆ 	
get
ÇÇ 
{
ÈÈ 
try
ÉÉ 
{
ÊÊ 
return
ËË 
m_t8Timeout
ËË &
;
ËË& '
}
ÌÌ 
catch
ÍÍ 
(
ÍÍ 
	Exception
ÍÍ  
ex
ÍÍ! #
)
ÍÍ# $
{
ÎÎ 
FDebug
ÏÏ 
.
ÏÏ 
throwException
ÏÏ )
(
ÏÏ) *
ex
ÏÏ* ,
)
ÏÏ, -
;
ÏÏ- .
}
ĞĞ 
finally
ÑÑ 
{
ÒÒ 
}
ÔÔ 
return
ÕÕ 
$num
ÕÕ 
;
ÕÕ 
}
ÖÖ 
set
ØØ 
{
ÙÙ 
try
ÚÚ 
{
ÛÛ 
validateState
ÜÜ !
(
ÜÜ! "
)
ÜÜ" #
;
ÜÜ# $
if
ŞŞ 
(
ŞŞ 
value
ŞŞ 
<
ŞŞ 
$num
ŞŞ  !
||
ŞŞ" $
value
ŞŞ% *
>
ŞŞ+ ,
$num
ŞŞ- 0
)
ŞŞ0 1
{
ßß 
FDebug
àà 
.
àà 
throwFException
àà .
(
àà. /
string
àà/ 5
.
àà5 6
Format
àà6 <
(
àà< =

FConstants
àà= G
.
ààG H

err_m_0015
ààH R
,
ààR S
$str
ààT `
)
àà` a
)
ààa b
;
ààb c
}
áá 
m_t8Timeout
ãã 
=
ãã  !
value
ãã" '
;
ãã' (
}
ää 
catch
åå 
(
åå 
	Exception
åå  
ex
åå! #
)
åå# $
{
ææ 
FDebug
çç 
.
çç 
throwException
çç )
(
çç) *
ex
çç* ,
)
çç, -
;
çç- .
}
èè 
finally
éé 
{
êê 
}
ìì 
}
íí 
}
îî 	
private
öö 
void
öö 
validateState
öö "
(
öö" #
)
÷÷ 
{
øø 	
try
ùù 
{
úú 
if
ûû 
(
ûû 
m_fSecs1ToHsms
ûû "
.
ûû" #

fHsmsState
ûû# -
!=
ûû. 0!
FCommunicationState
ûû1 D
.
ûûD E
Closed
ûûE K
)
ûûK L
{
üü 
FDebug
ıı 
.
ıı 
throwFException
ıı *
(
ıı* +
string
ıı+ 1
.
ıı1 2
Format
ıı2 8
(
ıı8 9

FConstants
ıı9 C
.
ııC D

err_m_0027
ııD N
,
ııN O
$str
ııP [
)
ıı[ \
)
ıı\ ]
;
ıı] ^
}
şş 
}
ÿÿ 
catch
€€ 
(
€€ 
	Exception
€€ 
ex
€€ 
)
€€  
{
 
FDebug
‚‚ 
.
‚‚ 
throwException
‚‚ %
(
‚‚% &
ex
‚‚& (
)
‚‚( )
;
‚‚) *
}
ƒƒ 
finally
„„ 
{
…… 
}
‡‡ 
}
ˆˆ 	
}
 
} »o
rD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Event\c_FEventPusher.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
internal 
class 
FEventPusher 
:  
IDisposable! ,
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FSecs1ToHsms 
m_fSecs1ToHsms +
=, -
null. 2
;2 3
private 
FQueue 
< 
FEventArgsBase %
>% &
m_fSecs1Events' 5
=6 7
null8 <
;< =
private 
FQueue 
< 
FEventArgsBase %
>% &
m_fHsmsEvents' 4
=5 6
null7 ;
;; <
private   
FThread   
m_fThdEventPusher   )
=  * +
null  , 0
;  0 1
private!! 
bool!! &
m_isCompletedEventHandling!! /
=!!0 1
false!!2 7
;!!7 8
internal'' 
FEventPusher'' 
('' 
FSecs1ToHsms(( 
fSecs1ToHsms(( %
))) 
{** 	
m_fSecs1ToHsms++ 
=++ 
fSecs1ToHsms++ )
;++) *
init-- 
(-- 
)-- 
;-- 
}.. 	
~22 	
FEventPusher22	 
(22 
)33 
{44 	
	myDispose55 
(55 
false55 
)55 
;55 
}66 	
	protected:: 
void:: 
	myDispose::  
(::  !
bool;; 
	disposing;; 
)<< 
{== 	
if>> 
(>> 
!>> 

m_disposed>> 
)>> 
{?? 
if@@ 
(@@ 
	disposing@@ 
)@@ 
{AA 
termBB 
(BB 
)BB 
;BB 
m_fSecs1ToHsmsDD "
=DD# $
nullDD% )
;DD) *
}EE 

m_disposedGG 
=GG 
trueGG !
;GG! "
}HH 
}II 	
publicQQ 
voidQQ 
DisposeQQ 
(QQ 
)RR 
{SS 	
	myDisposeTT 
(TT 
trueTT 
)TT 
;TT 
GCUU 
.UU 
SuppressFinalizeUU 
(UU  
thisUU  $
)UU$ %
;UU% &
}VV 	
public^^ 
int^^ 
secs1EventCount^^ "
{__ 	
get`` 
{aa 
trybb 
{cc 
returndd 
m_fSecs1Eventsdd )
.dd) *
countdd* /
;dd/ 0
}ee 
catchff 
(ff 
	Exceptionff  
exff! #
)ff# $
{gg 
FDebughh 
.hh 
throwExceptionhh )
(hh) *
exhh* ,
)hh, -
;hh- .
}ii 
finallyjj 
{kk 
}mm 
returnnn 
$numnn 
;nn 
}oo 
}pp 	
publictt 
inttt 
hsmsEventCounttt !
{uu 	
getvv 
{ww 
tryxx 
{yy 
returnzz 
m_fHsmsEventszz (
.zz( )
countzz) .
;zz. /
}{{ 
catch|| 
(|| 
	Exception||  
ex||! #
)||# $
{}} 
FDebug~~ 
.~~ 
throwException~~ )
(~~) *
ex~~* ,
)~~, -
;~~- .
} 
finally
€€ 
{
 
}
ƒƒ 
return
„„ 
$num
„„ 
;
„„ 
}
…… 
}
†† 	
public
ŠŠ 
bool
ŠŠ &
isCompletedEventHandling
ŠŠ ,
{
‹‹ 	
get
ŒŒ 
{
 
try
 
{
 
if
 
(
 
this
 
.
 
secs1EventCount
 ,
==
- /
$num
0 1
&&
2 4
this
5 9
.
9 :
hsmsEventCount
: H
==
I K
$num
L M
&&
N P(
m_isCompletedEventHandling
Q k
)
k l
{
‘‘ 
return
’’ 
true
’’ #
;
’’# $
}
““ 
return
”” 
false
””  
;
””  !
}
•• 
catch
–– 
(
–– 
	Exception
––  
ex
––! #
)
––# $
{
—— 
FDebug
˜˜ 
.
˜˜ 
throwException
˜˜ )
(
˜˜) *
ex
˜˜* ,
)
˜˜, -
;
˜˜- .
}
™™ 
finally
šš 
{
›› 
}
 
return
 
false
 
;
 
}
ŸŸ 
}
   	
private
¨¨ 
void
¨¨ 
init
¨¨ 
(
¨¨ 
)
©© 
{
ªª 	
try
«« 
{
¬¬ 
m_fSecs1Events
­­ 
=
­­  
new
­­! $
FQueue
­­% +
<
­­+ ,
FEventArgsBase
­­, :
>
­­: ;
(
­­; <
)
­­< =
;
­­= >
m_fHsmsEvents
®® 
=
®® 
new
®®  #
FQueue
®®$ *
<
®®* +
FEventArgsBase
®®+ 9
>
®®9 :
(
®®: ;
)
®®; <
;
®®< =(
m_isCompletedEventHandling
²² *
=
²²+ ,
true
²²- 1
;
²²1 2
m_fThdEventPusher
³³ !
=
³³" #
new
³³$ '
FThread
³³( /
(
³³/ 0
$str
³³0 A
,
³³A B
false
³³C H
,
³³H I
System
³³J P
.
³³P Q
	Threading
³³Q Z
.
³³Z [
ThreadPriority
³³[ i
.
³³i j
Normal
³³j p
,
³³p q
true
³³r v
)
³³v w
;
³³w x
m_fThdEventPusher
´´ !
.
´´! "
ThreadJobCalled
´´" 1
+=
´´2 4
new
´´5 8*
FThreadJobCalledEventHandler
´´9 U
(
´´U V/
!m_fThdEventPusher_ThreadJobCalled
´´V w
)
´´w x
;
´´x y
m_fThdEventPusher
µµ !
.
µµ! "
start
µµ" '
(
µµ' (
)
µµ( )
;
µµ) *
}
¶¶ 
catch
·· 
(
·· 
	Exception
·· 
ex
·· 
)
··  
{
¸¸ 
FDebug
¹¹ 
.
¹¹ 
throwException
¹¹ %
(
¹¹% &
ex
¹¹& (
)
¹¹( )
;
¹¹) *
}
ºº 
finally
»» 
{
¼¼ 
}
¾¾ 
}
¿¿ 	
private
ÃÃ 
void
ÃÃ 
term
ÃÃ 
(
ÃÃ 
)
ÄÄ 
{
ÅÅ 	
try
ÆÆ 
{
ÇÇ 
if
ÈÈ 
(
ÈÈ 
m_fThdEventPusher
ÈÈ %
!=
ÈÈ& (
null
ÈÈ) -
)
ÈÈ- .
{
ÉÉ 
while
ÊÊ 
(
ÊÊ 
!
ÊÊ 
this
ÊÊ  
.
ÊÊ  !&
isCompletedEventHandling
ÊÊ! 9
)
ÊÊ9 :
{
ËË 
System
ÌÌ 
.
ÌÌ 
	Threading
ÌÌ (
.
ÌÌ( )
Thread
ÌÌ) /
.
ÌÌ/ 0
Sleep
ÌÌ0 5
(
ÌÌ5 6
$num
ÌÌ6 8
)
ÌÌ8 9
;
ÌÌ9 :
}
ÍÍ 
m_fThdEventPusher
ÑÑ %
.
ÑÑ% &
ThreadJobCalled
ÑÑ& 5
-=
ÑÑ6 8
new
ÑÑ9 <*
FThreadJobCalledEventHandler
ÑÑ= Y
(
ÑÑY Z/
!m_fThdEventPusher_ThreadJobCalled
ÑÑZ {
)
ÑÑ{ |
;
ÑÑ| }
m_fThdEventPusher
ÒÒ %
.
ÒÒ% &
stop
ÒÒ& *
(
ÒÒ* +
)
ÒÒ+ ,
;
ÒÒ, -
m_fThdEventPusher
ÓÓ %
.
ÓÓ% &
Dispose
ÓÓ& -
(
ÓÓ- .
)
ÓÓ. /
;
ÓÓ/ 0
m_fThdEventPusher
ÔÔ %
=
ÔÔ& '
null
ÔÔ( ,
;
ÔÔ, -
}
ÕÕ 
if
×× 
(
×× 
m_fSecs1Events
×× "
!=
××# %
null
××& *
)
××* +
{
ØØ 
m_fSecs1Events
ÙÙ "
.
ÙÙ" #
Dispose
ÙÙ# *
(
ÙÙ* +
)
ÙÙ+ ,
;
ÙÙ, -
m_fSecs1Events
ÚÚ "
=
ÚÚ# $
null
ÚÚ% )
;
ÚÚ) *
}
ÛÛ 
if
İİ 
(
İİ 
m_fHsmsEvents
İİ !
!=
İİ" $
null
İİ% )
)
İİ) *
{
ŞŞ 
m_fHsmsEvents
ßß !
.
ßß! "
Dispose
ßß" )
(
ßß) *
)
ßß* +
;
ßß+ ,
m_fHsmsEvents
àà !
=
àà" #
null
àà$ (
;
àà( )
}
áá 
}
ââ 
catch
ãã 
(
ãã 
	Exception
ãã 
ex
ãã 
)
ãã  
{
ää 
FDebug
åå 
.
åå 
throwException
åå %
(
åå% &
ex
åå& (
)
åå( )
;
åå) *
}
ææ 
finally
çç 
{
èè 
}
êê 
}
ëë 	
public
ïï 
void
ïï 
pushSecs1Event
ïï "
(
ïï" #
FEventArgsBase
ğğ 
fArgs
ğğ  
)
ññ 
{
òò 	
try
óó 
{
ôô 
m_fSecs1Events
õõ 
.
õõ 
enqueue
õõ &
(
õõ& '
fArgs
õõ' ,
)
õõ, -
;
õõ- .
}
öö 
catch
÷÷ 
(
÷÷ 
	Exception
÷÷ 
ex
÷÷ 
)
÷÷  
{
øø 
FDebug
ùù 
.
ùù 
throwException
ùù %
(
ùù% &
ex
ùù& (
)
ùù( )
;
ùù) *
}
úú 
finally
ûû 
{
üü 
}
şş 
}
ÿÿ 	
public
ƒƒ 
void
ƒƒ 
pushHsmsEvent
ƒƒ !
(
ƒƒ! "
FEventArgsBase
„„ 
fArgs
„„  
)
…… 
{
†† 	
try
‡‡ 
{
ˆˆ 
m_fHsmsEvents
‰‰ 
.
‰‰ 
enqueue
‰‰ %
(
‰‰% &
fArgs
‰‰& +
)
‰‰+ ,
;
‰‰, -
}
ŠŠ 
catch
‹‹ 
(
‹‹ 
	Exception
‹‹ 
ex
‹‹ 
)
‹‹  
{
ŒŒ 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
 
{
 
}
’’ 
}
““ 	
public
—— 
void
—— (
waitEventHandlingCompleted
—— .
(
——. /
)
˜˜ 
{
™™ 	
try
šš 
{
›› 
while
œœ 
(
œœ 
!
œœ 
this
œœ 
.
œœ &
isCompletedEventHandling
œœ 5
)
œœ5 6
{
 
if
 
(
 
System
 
.
 
Windows
 &
.
& '
Forms
' ,
.
, -
Application
- 8
.
8 9
MessageLoop
9 D
)
D E
{
ŸŸ 
System
   
.
   
Windows
   &
.
  & '
Forms
  ' ,
.
  , -
Application
  - 8
.
  8 9
DoEvents
  9 A
(
  A B
)
  B C
;
  C D
}
¡¡ 
System
¢¢ 
.
¢¢ 
	Threading
¢¢ $
.
¢¢$ %
Thread
¢¢% +
.
¢¢+ ,
Sleep
¢¢, 1
(
¢¢1 2
$num
¢¢2 3
)
¢¢3 4
;
¢¢4 5
}
££ 
}
¤¤ 
catch
¥¥ 
(
¥¥ 
	Exception
¥¥ 
ex
¥¥ 
)
¥¥  
{
¦¦ 
FDebug
§§ 
.
§§ 
throwException
§§ %
(
§§% &
ex
§§& (
)
§§( )
;
§§) *
}
¨¨ 
finally
©© 
{
ªª 
}
¬¬ 
}
­­ 	
private
µµ 
void
µµ /
!m_fThdEventPusher_ThreadJobCalled
µµ 6
(
µµ6 7
object
¶¶ 
sender
¶¶ 
,
¶¶ 
FThreadEventArgs
·· 
e
·· 
)
¸¸ 
{
¹¹ 	
try
ºº 
{
»» 
if
¼¼ 
(
¼¼ 
this
¼¼ 
.
¼¼ 
secs1EventCount
¼¼ (
==
¼¼) +
$num
¼¼, -
&&
¼¼. 0
this
¼¼1 5
.
¼¼5 6
hsmsEventCount
¼¼6 D
==
¼¼E G
$num
¼¼H I
)
¼¼I J
{
½½ (
m_isCompletedEventHandling
¾¾ .
=
¾¾/ 0
true
¾¾1 5
;
¾¾5 6
e
¿¿ 
.
¿¿ 
sleepThread
¿¿ !
(
¿¿! "
$num
¿¿" #
)
¿¿# $
;
¿¿$ %
return
ÀÀ 
;
ÀÀ 
}
ÁÁ (
m_isCompletedEventHandling
ÂÂ *
=
ÂÂ+ ,
false
ÂÂ- 2
;
ÂÂ2 3
while
ÆÆ 
(
ÆÆ 
this
ÆÆ 
.
ÆÆ 
secs1EventCount
ÆÆ +
>
ÆÆ, -
$num
ÆÆ. /
)
ÆÆ/ 0
{
ÇÇ 
m_fSecs1ToHsms
ÈÈ "
.
ÈÈ" #
onEventRaised
ÈÈ# 0
(
ÈÈ0 1
m_fSecs1Events
ÈÈ1 ?
.
ÈÈ? @
dequeue
ÈÈ@ G
(
ÈÈG H
)
ÈÈH I
)
ÈÈI J
;
ÈÈJ K
}
ÉÉ 
while
ÍÍ 
(
ÍÍ 
this
ÍÍ 
.
ÍÍ 
hsmsEventCount
ÍÍ *
>
ÍÍ+ ,
$num
ÍÍ- .
)
ÍÍ. /
{
ÎÎ 
m_fSecs1ToHsms
ÏÏ "
.
ÏÏ" #
onEventRaised
ÏÏ# 0
(
ÏÏ0 1
m_fHsmsEvents
ÏÏ1 >
.
ÏÏ> ?
dequeue
ÏÏ? F
(
ÏÏF G
)
ÏÏG H
)
ÏÏH I
;
ÏÏI J
}
ĞĞ 
}
ÑÑ 
catch
ÒÒ 
(
ÒÒ 
	Exception
ÒÒ 
ex
ÒÒ 
)
ÒÒ  
{
ÓÓ 
FDebug
ÔÔ 
.
ÔÔ 
writeLog
ÔÔ 
(
ÔÔ  
ex
ÔÔ  "
)
ÔÔ" #
;
ÔÔ# $
}
ÕÕ 
finally
ÖÖ 
{
×× 
}
ÙÙ 
}
ÚÚ 	
}
àà 
}áá à=
sD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Event\c_FEventHandler.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
public 

class 
FEventHandler 
: 
IDisposable  +
{ 
public 
event $
FEventRaisedEventHandler -
EventRaised. 9
=: ;
null< @
;@ A
private 
bool 

m_disposed 
=  !
false" '
;' (
private!! 
FSecs1ToHsms!! 
m_fSecs1ToHsms!! +
=!!, -
null!!. 2
;!!2 3
private"" 
Control"" 
	m_invoker"" !
=""" #
null""$ (
;""( )
public(( 
FEventHandler(( 
((( 
FSecs1ToHsms)) 
fSecs1ToHsms)) %
,))% &
Control** 
invoker** 
)++ 
{,, 	
m_fSecs1ToHsms-- 
=-- 
fSecs1ToHsms-- )
;--) *
	m_invoker.. 
=.. 
invoker.. 
;..  
init00 
(00 
)00 
;00 
}11 	
~55 	
FEventHandler55	 
(55 
)66 
{77 	
	myDispose88 
(88 
false88 
)88 
;88 
}99 	
	protected== 
void== 
	myDispose==  
(==  !
bool>> 
	disposing>> 
)?? 
{@@ 	
ifAA 
(AA 
!AA 

m_disposedAA 
)AA 
{BB 
ifCC 
(CC 
	disposingCC 
)CC 
{DD 
termEE 
(EE 
)EE 
;EE 
m_fSecs1ToHsmsGG "
=GG# $
nullGG% )
;GG) *
	m_invokerHH 
=HH 
nullHH  $
;HH$ %
}II 

m_disposedKK 
=KK 
trueKK !
;KK! "
}LL 
}MM 	
publicUU 
voidUU 
DisposeUU 
(UU 
)VV 
{WW 	
	myDisposeXX 
(XX 
trueXX 
)XX 
;XX 
GCYY 
.YY 
SuppressFinalizeYY 
(YY  
thisYY  $
)YY$ %
;YY% &
}ZZ 	
privatehh 
voidhh 
inithh 
(hh 
)ii 
{jj 	
trykk 
{ll 
m_fSecs1ToHsmsmm 
.mm 
EventRaisedmm *
+=mm+ -
newmm. 1$
FEventRaisedEventHandlermm2 J
(mmJ K&
m_fSecs1ToHsms_EventRaisedmmK e
)mme f
;mmf g
}nn 
catchoo 
(oo 
	Exceptionoo 
exoo 
)oo  
{pp 
FDebugqq 
.qq 
throwExceptionqq %
(qq% &
exqq& (
)qq( )
;qq) *
}rr 
finallyss 
{tt 
}vv 
}ww 	
private{{ 
void{{ 
term{{ 
({{ 
)|| 
{}} 	
try~~ 
{ 
m_fSecs1ToHsms
€€ 
.
€€ 
EventRaised
€€ *
-=
€€+ -
new
€€. 1&
FEventRaisedEventHandler
€€2 J
(
€€J K(
m_fSecs1ToHsms_EventRaised
€€K e
)
€€e f
;
€€f g
}
 
catch
‚‚ 
(
‚‚ 
	Exception
‚‚ 
ex
‚‚ 
)
‚‚  
{
ƒƒ 
FDebug
„„ 
.
„„ 
throwException
„„ %
(
„„% &
ex
„„& (
)
„„( )
;
„„) *
}
…… 
finally
†† 
{
‡‡ 
}
‰‰ 
}
ŠŠ 	
private
 
bool
 
validateInvoker
 $
(
$ %
)
 
{
 	
try
‘‘ 
{
’’ 
if
““ 
(
““ 
	m_invoker
““ 
!=
““  
null
““! %
)
““% &
{
”” 
if
•• 
(
•• 
!
•• 
	m_invoker
•• "
.
••" #
Created
••# *
||
••+ -
!
••. /
	m_invoker
••/ 8
.
••8 9
IsHandleCreated
••9 H
)
••H I
{
–– 
return
—— 
false
—— $
;
——$ %
}
˜˜ 
}
™™ 
return
šš 
true
šš 
;
šš 
}
›› 
catch
œœ 
(
œœ 
	Exception
œœ 
ex
œœ 
)
œœ  
{
 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
ŸŸ 
finally
   
{
¡¡ 
}
££ 
return
¤¤ 
false
¤¤ 
;
¤¤ 
}
¥¥ 	
public
©© 
void
©© (
waitEventHandlingCompleted
©© .
(
©©. /
)
ªª 
{
«« 	
try
¬¬ 
{
­­ 
m_fSecs1ToHsms
®® 
.
®® 
fEventPusher
®® +
.
®®+ ,(
waitEventHandlingCompleted
®®, F
(
®®F G
)
®®G H
;
®®H I
}
¯¯ 
catch
°° 
(
°° 
	Exception
°° 
ex
°° 
)
°°  
{
±± 
FDebug
²² 
.
²² 
throwException
²² %
(
²²% &
ex
²²& (
)
²²( )
;
²²) *
}
³³ 
finally
´´ 
{
µµ 
}
·· 
}
¸¸ 	
private
ÀÀ 
void
ÀÀ (
m_fSecs1ToHsms_EventRaised
ÀÀ /
(
ÀÀ/ 0
object
ÁÁ 
sender
ÁÁ 
,
ÁÁ 
FEventArgsBase
ÂÂ 
e
ÂÂ 
)
ÃÃ 
{
ÄÄ 	
try
ÅÅ 
{
ÆÆ 
if
ÇÇ 
(
ÇÇ 
EventRaised
ÇÇ 
==
ÇÇ  "
null
ÇÇ# '
)
ÇÇ' (
{
ÈÈ 
return
ÉÉ 
;
ÉÉ 
}
ÊÊ 
if
ÎÎ 
(
ÎÎ 
!
ÎÎ 
validateInvoker
ÎÎ $
(
ÎÎ$ %
)
ÎÎ% &
)
ÎÎ& '
{
ÏÏ 
return
ĞĞ 
;
ĞĞ 
}
ÑÑ 
if
ÕÕ 
(
ÕÕ 
	m_invoker
ÕÕ 
==
ÕÕ  
null
ÕÕ! %
||
ÕÕ& (
!
ÕÕ) *
	m_invoker
ÕÕ* 3
.
ÕÕ3 4
InvokeRequired
ÕÕ4 B
)
ÕÕB C
{
ÖÖ 
EventRaised
×× 
(
××  
this
××  $
,
××$ %
e
××& '
)
××' (
;
××( )
}
ØØ 
else
ÙÙ 
{
ÚÚ 
	m_invoker
ÛÛ 
.
ÛÛ 
Invoke
ÛÛ $
(
ÛÛ$ %
new
ÛÛ% (
MethodInvoker
ÛÛ) 6
(
ÛÛ6 7
delegate
ÛÛ7 ?
(
ÛÛ? @
)
ÛÛ@ A
{
ÜÜ 
EventRaised
İİ #
(
İİ# $
this
İİ$ (
,
İİ( )
e
İİ* +
)
İİ+ ,
;
İİ, -
}
ŞŞ 
)
ŞŞ 
)
ŞŞ 
;
ŞŞ 
}
ßß 
}
àà 
catch
áá 
(
áá 
	Exception
áá 
ex
áá 
)
áá  
{
ââ 
if
ãã 
(
ãã 
ex
ãã 
is
ãã %
ObjectDisposedException
ãã 1
)
ãã1 2
{
ää 
return
åå 
;
åå 
}
ææ 
FDebug
çç 
.
çç 
writeLog
çç 
(
çç  
ex
çç  "
)
çç" #
;
çç# $
}
èè 
finally
éé 
{
êê 
}
ìì 
}
íí 	
}
óó 
}ôô œ
~D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Event\EventArgs\c_FEventArgsBase.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
[ 
Serializable 
] 
public 

class 
FEventArgsBase 
:  
	EventArgs! *
,* +
IDisposable, 7
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FSecs1ToHsms 
m_fSecs1ToHsms +
=, -
null. 2
;2 3
private 
FEventId 

m_fEventId #
=$ %
FEventId& .
.. /
None/ 3
;3 4
internal$$ 
FEventArgsBase$$ 
($$  
FSecs1ToHsms%% 
fSecs1ToHsms%% %
,%%% &
FEventId&& 
fEventId&& 
)'' 
{(( 	
m_fSecs1ToHsms)) 
=)) 
fSecs1ToHsms)) )
;))) *

m_fEventId** 
=** 
fEventId** !
;**! "
}++ 	
~// 	
FEventArgsBase//	 
(// 
)00 
{11 	
	myDispose22 
(22 
false22 
)22 
;22 
}33 	
	protected77 
virtual77 
void77 
	myDispose77 (
(77( )
bool88 
	disposing88 
)99 
{:: 	
if;; 
(;; 
!;; 

m_disposed;; 
);; 
{<< 
if== 
(== 
	disposing== 
)== 
{>> 
m_fSecs1ToHsms?? "
=??# $
null??% )
;??) *
}@@ 

m_disposedBB 
=BB 
trueBB !
;BB! "
}CC 
}DD 	
publicLL 
voidLL 
DisposeLL 
(LL 
)MM 
{NN 	
	myDisposeOO 
(OO 
trueOO 
)OO 
;OO 
GCPP 
.PP 
SuppressFinalizePP 
(PP  
thisPP  $
)PP$ %
;PP% &
}QQ 	
publicYY 
FSecs1ToHsmsYY 
fSecs1ToHsmsYY (
{ZZ 	
get[[ 
{\\ 
try]] 
{^^ 
return__ 
m_fSecs1ToHsms__ )
;__) *
}`` 
catchaa 
(aa 
	Exceptionaa  
exaa! #
)aa# $
{bb 
FDebugcc 
.cc 
throwExceptioncc )
(cc) *
excc* ,
)cc, -
;cc- .
}dd 
finallyee 
{ff 
}hh 
returnii 
nullii 
;ii 
}jj 
}kk 	
publicoo 
FEventIdoo 
fEventIdoo  
{pp 	
getqq 
{rr 
tryss 
{tt 
returnuu 

m_fEventIduu %
;uu% &
}vv 
catchww 
(ww 
	Exceptionww  
exww! #
)ww# $
{xx 
FDebugyy 
.yy 
throwExceptionyy )
(yy) *
exyy* ,
)yy, -
;yy- .
}zz 
finally{{ 
{|| 
}~~ 
return 
FEventId 
.  
None  $
;$ %
}
€€ 
}
 	
}
 
} ­6
‹D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Event\EventArgs\c_FSecs1StateChangedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
[ 
Serializable 
] 
public 

class '
FSecs1StateChangedEventArgs ,
:- .
FEventArgsBase/ =
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FResultCode 
	m_fResult %
=& '
FResultCode( 3
.3 4
Success4 ;
;; <
private 
string 
m_errorMessage %
=& '
string( .
.. /
Empty/ 4
;4 5
private 
FCommunicationState #
m_fState$ ,
=- .
FCommunicationState/ B
.B C
ClosedC I
;I J
private   
string   
m_serialPort   #
=  $ %
string  & ,
.  , -
Empty  - 2
;  2 3
private!! 
int!! 
m_baud!! 
=!! 
$num!! 
;!! 
internal'' '
FSecs1StateChangedEventArgs'' ,
('', -
FSecs1ToHsms(( 
fSecs1ToHsms(( %
,((% &
FEventId)) 
fEventId)) 
,)) 
FResultCode** 
fResult** 
,**  
string++ 
errorMessage++ 
,++  
FCommunicationState,, 
fState,,  &
,,,& '
string-- 

serialPort-- 
,-- 
int.. 
baud.. 
)// 
:00 
base00 
(00 
fSecs1ToHsms00 
,00  
fEventId00! )
)00) *
{11 	
	m_fResult22 
=22 
fResult22 
;22  
m_errorMessage33 
=33 
errorMessage33 )
;33) *
m_fState44 
=44 
fState44 
;44 
m_serialPort55 
=55 

serialPort55 %
;55% &
m_baud66 
=66 
baud66 
;66 
}77 	
~;; 	'
FSecs1StateChangedEventArgs;;	 $
(;;$ %
)<< 
{== 	
	myDispose>> 
(>> 
false>> 
)>> 
;>> 
}?? 	
	protectedCC 
overrideCC 
voidCC 
	myDisposeCC  )
(CC) *
boolDD 
	disposingDD 
)EE 
{FF 	
ifGG 
(GG 
!GG 

m_disposedGG 
)GG 
{HH 
ifII 
(II 
	disposingII 
)II 
{JJ 
}LL 

m_disposedMM 
=MM 
trueMM !
;MM! "
baseOO 
.OO 
	myDisposeOO 
(OO 
	disposingOO (
)OO( )
;OO) *
}PP 
}QQ 	
publicYY 
voidYY 
DisposeYY 
(YY 
)ZZ 
{[[ 	
	myDispose\\ 
(\\ 
true\\ 
)\\ 
;\\ 
GC]] 
.]] 
SuppressFinalize]] 
(]]  
this]]  $
)]]$ %
;]]% &
}^^ 	
publicff 
FResultCodeff 
fResultff "
{gg 	
gethh 
{ii 
tryjj 
{kk 
returnll 
	m_fResultll $
;ll$ %
}mm 
catchnn 
(nn 
	Exceptionnn  
exnn! #
)nn# $
{oo 
FDebugpp 
.pp 
throwExceptionpp )
(pp) *
expp* ,
)pp, -
;pp- .
}qq 
finallyrr 
{ss 
}uu 
returnvv 
FResultCodevv "
.vv" #
Successvv# *
;vv* +
}ww 
}xx 	
public|| 
string|| 
errorMessage|| "
{}} 	
get~~ 
{ 
try
€€ 
{
 
return
‚‚ 
m_errorMessage
‚‚ )
;
‚‚) *
}
ƒƒ 
catch
„„ 
(
„„ 
	Exception
„„  
ex
„„! #
)
„„# $
{
…… 
FDebug
†† 
.
†† 
throwException
†† )
(
††) *
ex
††* ,
)
††, -
;
††- .
}
‡‡ 
finally
ˆˆ 
{
‰‰ 
}
‹‹ 
return
ŒŒ 
string
ŒŒ 
.
ŒŒ 
Empty
ŒŒ #
;
ŒŒ# $
}
 
}
 	
public
’’ !
FCommunicationState
’’ "
fState
’’# )
{
““ 	
get
”” 
{
•• 
try
–– 
{
—— 
return
˜˜ 
m_fState
˜˜ #
;
˜˜# $
}
™™ 
catch
šš 
(
šš 
	Exception
šš  
ex
šš! #
)
šš# $
{
›› 
FDebug
œœ 
.
œœ 
throwException
œœ )
(
œœ) *
ex
œœ* ,
)
œœ, -
;
œœ- .
}
 
finally
 
{
ŸŸ 
}
¡¡ 
return
¢¢ !
FCommunicationState
¢¢ *
.
¢¢* +
Closed
¢¢+ 1
;
¢¢1 2
}
££ 
}
¤¤ 	
public
¨¨ 
string
¨¨ 

serialPort
¨¨  
{
©© 	
get
ªª 
{
«« 
try
¬¬ 
{
­­ 
return
®® 
m_serialPort
®® '
;
®®' (
}
¯¯ 
catch
°° 
(
°° 
	Exception
°°  
ex
°°! #
)
°°# $
{
±± 
FDebug
²² 
.
²² 
throwException
²² )
(
²²) *
ex
²²* ,
)
²², -
;
²²- .
}
³³ 
finally
´´ 
{
µµ 
}
·· 
return
¸¸ 
string
¸¸ 
.
¸¸ 
Empty
¸¸ #
;
¸¸# $
}
¹¹ 
}
ºº 	
public
¾¾ 
int
¾¾ 
baud
¾¾ 
{
¿¿ 	
get
ÀÀ 
{
ÁÁ 
try
ÂÂ 
{
ÃÃ 
return
ÄÄ 
m_baud
ÄÄ !
;
ÄÄ! "
}
ÅÅ 
catch
ÆÆ 
(
ÆÆ 
	Exception
ÆÆ  
ex
ÆÆ! #
)
ÆÆ# $
{
ÇÇ 
FDebug
ÈÈ 
.
ÈÈ 
throwException
ÈÈ )
(
ÈÈ) *
ex
ÈÈ* ,
)
ÈÈ, -
;
ÈÈ- .
}
ÉÉ 
finally
ÊÊ 
{
ËË 
}
ÍÍ 
return
ÎÎ 
$num
ÎÎ 
;
ÎÎ 
}
ÏÏ 
}
ĞĞ 	
}
ÜÜ 
}İİ ğ
ŠD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Event\EventArgs\c_FSecs1ErrorRaisedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
[ 
Serializable 
] 
public 

class &
FSecs1ErrorRaisedEventArgs +
:, -
FEventArgsBase. <
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
string 
m_errorMessage %
=& '
string( .
.. /
Empty/ 4
;4 5
internal## &
FSecs1ErrorRaisedEventArgs## +
(##+ ,
FSecs1ToHsms$$ 
fSecs1ToHsms$$ %
,$$% &
FEventId%% 
fEventId%% 
,%% 
string&& 
errorMessage&& 
)'' 
:(( 
base(( 
((( 
fSecs1ToHsms(( 
,((  
fEventId((! )
)(() *
{)) 	
m_errorMessage** 
=** 
errorMessage** )
;**) *
}++ 	
~// 	&
FSecs1ErrorRaisedEventArgs//	 #
(//# $
)00 
{11 	
	myDispose22 
(22 
false22 
)22 
;22 
}33 	
	protected77 
override77 
void77 
	myDispose77  )
(77) *
bool88 
	disposing88 
)99 
{:: 	
if;; 
(;; 
!;; 

m_disposed;; 
);; 
{<< 
if== 
(== 
	disposing== 
)== 
{>> 
}@@ 

m_disposedAA 
=AA 
trueAA !
;AA! "
baseCC 
.CC 
	myDisposeCC 
(CC 
	disposingCC (
)CC( )
;CC) *
}DD 
}EE 	
publicMM 
voidMM 
DisposeMM 
(MM 
)NN 
{OO 	
	myDisposePP 
(PP 
truePP 
)PP 
;PP 
GCQQ 
.QQ 
SuppressFinalizeQQ 
(QQ  
thisQQ  $
)QQ$ %
;QQ% &
}RR 	
publicZZ 
stringZZ 
errorMessageZZ "
{[[ 	
get\\ 
{]] 
try^^ 
{__ 
return`` 
m_errorMessage`` )
;``) *
}aa 
catchbb 
(bb 
	Exceptionbb  
exbb! #
)bb# $
{cc 
FDebugdd 
.dd 
throwExceptiondd )
(dd) *
exdd* ,
)dd, -
;dd- .
}ee 
finallyff 
{gg 
}ii 
returnjj 
stringjj 
.jj 
Emptyjj #
;jj# $
}kk 
}ll 	
}xx 
}yy Ø.
D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Event\EventArgs\c_FSecs1HandshakeReceivedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
[ 
Serializable 
] 
public 

class ,
 FSecs1HandshakeReceivedEventArgs 1
:2 3
FEventArgsBase4 B
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FResultCode 
	m_fResult %
=& '
FResultCode( 3
.3 4
Success4 ;
;; <
private 
string 
m_errorMessage %
=& '
string( .
.. /
Empty/ 4
;4 5
private 
FSecs1HandshakeCode #
m_fHandshakeCode$ 4
=5 6
FSecs1HandshakeCode7 J
.J K
ENQK N
;N O
internal%% ,
 FSecs1HandshakeReceivedEventArgs%% 1
(%%1 2
FSecs1ToHsms&& 
fSecs1ToHsms&& %
,&&% &
FEventId'' 
fEventId'' 
,'' 
FResultCode(( 
fResult(( 
,((  
string)) 
errorMessage)) 
,))  
FSecs1HandshakeCode** 
fHandshakeCode**  .
)++ 
:,, 
base,, 
(,, 
fSecs1ToHsms,, 
,,,  
fEventId,,! )
),,) *
{-- 	
	m_fResult.. 
=.. 
fResult.. 
;..  
m_errorMessage// 
=// 
errorMessage// )
;//) *
m_fHandshakeCode00 
=00 
fHandshakeCode00 -
;00- .
}11 	
~55 	,
 FSecs1HandshakeReceivedEventArgs55	 )
(55) *
)66 
{77 	
	myDispose88 
(88 
false88 
)88 
;88 
}99 	
	protected== 
override== 
void== 
	myDispose==  )
(==) *
bool>> 
	disposing>> 
)?? 
{@@ 	
ifAA 
(AA 
!AA 

m_disposedAA 
)AA 
{BB 
ifCC 
(CC 
	disposingCC 
)CC 
{DD 
}FF 

m_disposedGG 
=GG 
trueGG !
;GG! "
baseII 
.II 
	myDisposeII 
(II 
	disposingII (
)II( )
;II) *
}JJ 
}KK 	
publicSS 
voidSS 
DisposeSS 
(SS 
)TT 
{UU 	
	myDisposeVV 
(VV 
trueVV 
)VV 
;VV 
GCWW 
.WW 
SuppressFinalizeWW 
(WW  
thisWW  $
)WW$ %
;WW% &
}XX 	
public`` 
FResultCode`` 
fResult`` "
{aa 	
getbb 
{cc 
trydd 
{ee 
returnff 
	m_fResultff $
;ff$ %
}gg 
catchhh 
(hh 
	Exceptionhh  
exhh! #
)hh# $
{ii 
FDebugjj 
.jj 
throwExceptionjj )
(jj) *
exjj* ,
)jj, -
;jj- .
}kk 
finallyll 
{mm 
}oo 
returnpp 
FResultCodepp "
.pp" #
Successpp# *
;pp* +
}qq 
}rr 	
publicvv 
stringvv 
errorMessagevv "
{ww 	
getxx 
{yy 
tryzz 
{{{ 
return|| 
m_errorMessage|| )
;||) *
}}} 
catch~~ 
(~~ 
	Exception~~  
ex~~! #
)~~# $
{ 
FDebug
€€ 
.
€€ 
throwException
€€ )
(
€€) *
ex
€€* ,
)
€€, -
;
€€- .
}
 
finally
‚‚ 
{
ƒƒ 
}
…… 
return
†† 
string
†† 
.
†† 
Empty
†† #
;
††# $
}
‡‡ 
}
ˆˆ 	
public
ŒŒ !
FSecs1HandshakeCode
ŒŒ "
fHandshakeCode
ŒŒ# 1
{
 	
get
 
{
 
try
 
{
‘‘ 
return
’’ 
m_fHandshakeCode
’’ +
;
’’+ ,
}
““ 
catch
”” 
(
”” 
	Exception
””  
ex
””! #
)
””# $
{
•• 
FDebug
–– 
.
–– 
throwException
–– )
(
––) *
ex
––* ,
)
––, -
;
––- .
}
—— 
finally
˜˜ 
{
™™ 
}
›› 
return
œœ !
FSecs1HandshakeCode
œœ *
.
œœ* +
ENQ
œœ+ .
;
œœ. /
}
 
}
 	
internal
¦¦ 
byte
¦¦ 
[
¦¦ 
]
¦¦ 
getBinaryData
¦¦ %
(
¦¦% &
)
§§ 
{
¨¨ 	
try
©© 
{
ªª 
return
«« 
new
«« 
byte
«« 
[
««  
]
««  !
{
««" #
(
««$ %
byte
««% )
)
««) *
m_fHandshakeCode
««* :
}
««; <
;
««< =
}
¬¬ 
catch
­­ 
(
­­ 
	Exception
­­ 
ex
­­ 
)
­­  
{
®® 
FDebug
¯¯ 
.
¯¯ 
throwException
¯¯ %
(
¯¯% &
ex
¯¯& (
)
¯¯( )
;
¯¯) *
}
°° 
finally
±± 
{
²² 
}
´´ 
return
µµ 
null
µµ 
;
µµ 
}
¶¶ 	
}
¼¼ 
}½½ È.
ŒD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Event\EventArgs\c_FSecs1HandshakeSentEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
[ 
Serializable 
] 
public 

class (
FSecs1HandshakeSentEventArgs -
:. /
FEventArgsBase0 >
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FResultCode 
	m_fResult %
=& '
FResultCode( 3
.3 4
Success4 ;
;; <
private 
string 
m_errorMessage %
=& '
string( .
.. /
Empty/ 4
;4 5
private 
FSecs1HandshakeCode #
m_fHandshakeCode$ 4
=5 6
FSecs1HandshakeCode7 J
.J K
ENQK N
;N O
internal%% (
FSecs1HandshakeSentEventArgs%% -
(%%- .
FSecs1ToHsms&& 
fSecs1ToHsms&& %
,&&% &
FEventId'' 
fEventId'' 
,'' 
FResultCode(( 
fResult(( 
,((  
string)) 
errorMessage)) 
,))  
FSecs1HandshakeCode** 
fHandshakeCode**  .
)++ 
:,, 
base,, 
(,, 
fSecs1ToHsms,, 
,,,  
fEventId,,! )
),,) *
{-- 	
	m_fResult.. 
=.. 
fResult.. 
;..  
m_errorMessage// 
=// 
errorMessage// )
;//) *
m_fHandshakeCode00 
=00 
fHandshakeCode00 -
;00- .
}11 	
~55 	(
FSecs1HandshakeSentEventArgs55	 %
(55% &
)66 
{77 	
	myDispose88 
(88 
false88 
)88 
;88 
}99 	
	protected== 
override== 
void== 
	myDispose==  )
(==) *
bool>> 
	disposing>> 
)?? 
{@@ 	
ifAA 
(AA 
!AA 

m_disposedAA 
)AA 
{BB 
ifCC 
(CC 
	disposingCC 
)CC 
{DD 
}FF 

m_disposedGG 
=GG 
trueGG !
;GG! "
baseII 
.II 
	myDisposeII 
(II 
	disposingII (
)II( )
;II) *
}JJ 
}KK 	
publicSS 
voidSS 
DisposeSS 
(SS 
)TT 
{UU 	
	myDisposeVV 
(VV 
trueVV 
)VV 
;VV 
GCWW 
.WW 
SuppressFinalizeWW 
(WW  
thisWW  $
)WW$ %
;WW% &
}XX 	
public`` 
FResultCode`` 
fResult`` "
{aa 	
getbb 
{cc 
trydd 
{ee 
returnff 
	m_fResultff $
;ff$ %
}gg 
catchhh 
(hh 
	Exceptionhh  
exhh! #
)hh# $
{ii 
FDebugjj 
.jj 
throwExceptionjj )
(jj) *
exjj* ,
)jj, -
;jj- .
}kk 
finallyll 
{mm 
}oo 
returnpp 
FResultCodepp "
.pp" #
Successpp# *
;pp* +
}qq 
}rr 	
publicvv 
stringvv 
errorMessagevv "
{ww 	
getxx 
{yy 
tryzz 
{{{ 
return|| 
m_errorMessage|| )
;||) *
}}} 
catch~~ 
(~~ 
	Exception~~  
ex~~! #
)~~# $
{ 
FDebug
€€ 
.
€€ 
throwException
€€ )
(
€€) *
ex
€€* ,
)
€€, -
;
€€- .
}
 
finally
‚‚ 
{
ƒƒ 
}
…… 
return
†† 
string
†† 
.
†† 
Empty
†† #
;
††# $
}
‡‡ 
}
ˆˆ 	
public
ŒŒ !
FSecs1HandshakeCode
ŒŒ "
fHandshakeCode
ŒŒ# 1
{
 	
get
 
{
 
try
 
{
‘‘ 
return
’’ 
m_fHandshakeCode
’’ +
;
’’+ ,
}
““ 
catch
”” 
(
”” 
	Exception
””  
ex
””! #
)
””# $
{
•• 
FDebug
–– 
.
–– 
throwException
–– )
(
––) *
ex
––* ,
)
––, -
;
––- .
}
—— 
finally
˜˜ 
{
™™ 
}
›› 
return
œœ !
FSecs1HandshakeCode
œœ *
.
œœ* +
ENQ
œœ+ .
;
œœ. /
}
 
}
 	
internal
¦¦ 
byte
¦¦ 
[
¦¦ 
]
¦¦ 
getBinaryData
¦¦ %
(
¦¦% &
)
§§ 
{
¨¨ 	
try
©© 
{
ªª 
return
«« 
new
«« 
byte
«« 
[
««  
]
««  !
{
««" #
(
««$ %
byte
««% )
)
««) *
m_fHandshakeCode
««* :
}
««; <
;
««< =
}
¬¬ 
catch
­­ 
(
­­ 
	Exception
­­ 
ex
­­ 
)
­­  
{
®® 
FDebug
¯¯ 
.
¯¯ 
throwException
¯¯ %
(
¯¯% &
ex
¯¯& (
)
¯¯( )
;
¯¯) *
}
°° 
finally
±± 
{
²² 
}
´´ 
return
µµ 
null
µµ 
;
µµ 
}
¶¶ 	
}
¼¼ 
}½½ &
ŒD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Event\EventArgs\c_FSecs1BlockReceivedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
[ 
Serializable 
] 
public 

class (
FSecs1BlockReceivedEventArgs -
:. /
FEventArgsBase0 >
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FResultCode 
	m_fResult %
=& '
FResultCode( 3
.3 4
Success4 ;
;; <
private 
string 
m_errorMessage %
=& '
string( .
.. /
Empty/ 4
;4 5
private 

FSecsBlock 
m_fSecsBlock '
=( )
null* .
;. /
internal%% (
FSecs1BlockReceivedEventArgs%% -
(%%- .
FSecs1ToHsms&& 
fSecs1ToHsms&& %
,&&% &
FEventId'' 
fEventId'' 
,'' 
FResultCode(( 
fResult(( 
,((  
string)) 
errorMessage)) 
,))  

FSecsBlock** 

fSecsBlock** !
)++ 
:,, 
base,, 
(,, 
fSecs1ToHsms,, 
,,,  
fEventId,,! )
),,) *
{-- 	
m_fSecsBlock.. 
=.. 

fSecsBlock.. %
;..% &
}// 	
~33 	(
FSecs1BlockReceivedEventArgs33	 %
(33% &
)44 
{55 	
	myDispose66 
(66 
false66 
)66 
;66 
}77 	
	protected;; 
override;; 
void;; 
	myDispose;;  )
(;;) *
bool<< 
	disposing<< 
)== 
{>> 	
if?? 
(?? 
!?? 

m_disposed?? 
)?? 
{@@ 
ifAA 
(AA 
	disposingAA 
)AA 
{BB 
m_fSecsBlockCC  
=CC! "
nullCC# '
;CC' (
}DD 

m_disposedEE 
=EE 
trueEE !
;EE! "
baseGG 
.GG 
	myDisposeGG 
(GG 
	disposingGG (
)GG( )
;GG) *
}HH 
}II 	
publicQQ 
voidQQ 
DisposeQQ 
(QQ 
)RR 
{SS 	
	myDisposeTT 
(TT 
trueTT 
)TT 
;TT 
GCUU 
.UU 
SuppressFinalizeUU 
(UU  
thisUU  $
)UU$ %
;UU% &
}VV 	
public^^ 
FResultCode^^ 
fResult^^ "
{__ 	
get`` 
{aa 
trybb 
{cc 
returndd 
	m_fResultdd $
;dd$ %
}ee 
catchff 
(ff 
	Exceptionff  
exff! #
)ff# $
{gg 
FDebughh 
.hh 
throwExceptionhh )
(hh) *
exhh* ,
)hh, -
;hh- .
}ii 
finallyjj 
{kk 
}mm 
returnnn 
FResultCodenn "
.nn" #
Successnn# *
;nn* +
}oo 
}pp 	
publictt 
stringtt 
errorMessagett "
{uu 	
getvv 
{ww 
tryxx 
{yy 
returnzz 
m_errorMessagezz )
;zz) *
}{{ 
catch|| 
(|| 
	Exception||  
ex||! #
)||# $
{}} 
FDebug~~ 
.~~ 
throwException~~ )
(~~) *
ex~~* ,
)~~, -
;~~- .
} 
finally
€€ 
{
 
}
ƒƒ 
return
„„ 
string
„„ 
.
„„ 
Empty
„„ #
;
„„# $
}
…… 
}
†† 	
public
ŠŠ 

FSecsBlock
ŠŠ 

fSecsBlock
ŠŠ $
{
‹‹ 	
get
ŒŒ 
{
 
try
 
{
 
return
 
m_fSecsBlock
 '
;
' (
}
‘‘ 
catch
’’ 
(
’’ 
	Exception
’’  
ex
’’! #
)
’’# $
{
““ 
FDebug
”” 
.
”” 
throwException
”” )
(
””) *
ex
””* ,
)
””, -
;
””- .
}
•• 
finally
–– 
{
—— 
}
™™ 
return
šš 
null
šš 
;
šš 
}
›› 
}
œœ 	
}
¨¨ 
}©© ƒ(
’D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Event\EventArgs\c_FSecs1DataMessageReceivedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
[ 
Serializable 
] 
public 

class .
"FSecs1DataMessageReceivedEventArgs 3
:4 5
FEventArgsBase6 D
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FResultCode 
	m_fResult %
=& '
FResultCode( 3
.3 4
Success4 ;
;; <
private 
string 
m_errorMessage %
=& '
string( .
.. /
Empty/ 4
;4 5
private 
FSecsDataMessage  
m_fSecsDataMessage! 3
=4 5
null6 :
;: ;
internal%% .
"FSecs1DataMessageReceivedEventArgs%% 3
(%%3 4
FSecs1ToHsms&& 
fSecs1ToHsms&& %
,&&% &
FEventId'' 
fEventId'' 
,'' 
FResultCode(( 
fResult(( 
,((  
string)) 
errorMessage)) 
,))  
FSecsDataMessage** 
fSecsDataMessage** -
)++ 
:,, 
base,, 
(,, 
fSecs1ToHsms,, 
,,,  
fEventId,,! )
),,) *
{-- 	
	m_fResult.. 
=.. 
fResult.. 
;..  
m_errorMessage// 
=// 
errorMessage// )
;//) *
m_fSecsDataMessage00 
=00  
fSecsDataMessage00! 1
;001 2
}11 	
~55 	.
"FSecs1DataMessageReceivedEventArgs55	 +
(55+ ,
)66 
{77 	
	myDispose88 
(88 
false88 
)88 
;88 
}99 	
	protected== 
override== 
void== 
	myDispose==  )
(==) *
bool>> 
	disposing>> 
)?? 
{@@ 	
ifAA 
(AA 
!AA 

m_disposedAA 
)AA 
{BB 
ifCC 
(CC 
	disposingCC 
)CC 
{DD 
m_fSecsDataMessageEE &
=EE' (
nullEE) -
;EE- .
}FF 

m_disposedGG 
=GG 
trueGG !
;GG! "
baseII 
.II 
	myDisposeII 
(II 
	disposingII (
)II( )
;II) *
}JJ 
}KK 	
publicSS 
voidSS 
DisposeSS 
(SS 
)TT 
{UU 	
	myDisposeVV 
(VV 
trueVV 
)VV 
;VV 
GCWW 
.WW 
SuppressFinalizeWW 
(WW  
thisWW  $
)WW$ %
;WW% &
}XX 	
public`` 
FResultCode`` 
fResult`` "
{aa 	
getbb 
{cc 
trydd 
{ee 
returnff 
	m_fResultff $
;ff$ %
}gg 
catchhh 
(hh 
	Exceptionhh  
exhh! #
)hh# $
{ii 
FDebugjj 
.jj 
throwExceptionjj )
(jj) *
exjj* ,
)jj, -
;jj- .
}kk 
finallyll 
{mm 
}oo 
returnpp 
FResultCodepp "
.pp" #
Successpp# *
;pp* +
}qq 
}rr 	
publicvv 
stringvv 
errorMessagevv "
{ww 	
getxx 
{yy 
tryzz 
{{{ 
return|| 
m_errorMessage|| )
;||) *
}}} 
catch~~ 
(~~ 
	Exception~~  
ex~~! #
)~~# $
{ 
FDebug
€€ 
.
€€ 
throwException
€€ )
(
€€) *
ex
€€* ,
)
€€, -
;
€€- .
}
 
finally
‚‚ 
{
ƒƒ 
}
…… 
return
†† 
string
†† 
.
†† 
Empty
†† #
;
††# $
}
‡‡ 
}
ˆˆ 	
public
ŒŒ 
FSecsDataMessage
ŒŒ 
fSecsDataMessage
ŒŒ  0
{
 	
get
 
{
 
try
 
{
‘‘ 
return
’’  
m_fSecsDataMessage
’’ -
;
’’- .
}
““ 
catch
”” 
(
”” 
	Exception
””  
ex
””! #
)
””# $
{
•• 
FDebug
–– 
.
–– 
throwException
–– )
(
––) *
ex
––* ,
)
––, -
;
––- .
}
—— 
finally
˜˜ 
{
™™ 
}
›› 
return
œœ 
null
œœ 
;
œœ 
}
 
}
 	
}
ªª 
}«« ³
ŒD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Event\EventArgs\c_FSecs1TimeoutRaisedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
[ 
Serializable 
] 
public 

class (
FSecs1TimeoutRaisedEventArgs -
:. /
FEventArgsBase0 >
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FSecsTimeout 

m_fTimeout '
=( )
FSecsTimeout* 6
.6 7
T17 9
;9 :
private 
string 
m_errorMessage %
=& '
string( .
.. /
Empty/ 4
;4 5
internal$$ (
FSecs1TimeoutRaisedEventArgs$$ -
($$- .
FSecs1ToHsms%% 
fSecs1ToHsms%% %
,%%% &
FEventId&& 
fEventId&& 
,&& 
FSecsTimeout'' 
fTimeout'' !
,''! "
string(( 
errorMessage(( 
))) 
:** 
base** 
(** 
fSecs1ToHsms** 
,**  
fEventId**! )
)**) *
{++ 	

m_fTimeout,, 
=,, 
fTimeout,, !
;,,! "
m_errorMessage-- 
=-- 
errorMessage-- )
;--) *
}.. 	
~22 	(
FSecs1TimeoutRaisedEventArgs22	 %
(22% &
)33 
{44 	
	myDispose55 
(55 
false55 
)55 
;55 
}66 	
	protected:: 
override:: 
void:: 
	myDispose::  )
(::) *
bool;; 
	disposing;; 
)<< 
{== 	
if>> 
(>> 
!>> 

m_disposed>> 
)>> 
{?? 
if@@ 
(@@ 
	disposing@@ 
)@@ 
{AA 
}CC 

m_disposedDD 
=DD 
trueDD !
;DD! "
baseFF 
.FF 
	myDisposeFF 
(FF 
	disposingFF (
)FF( )
;FF) *
}GG 
}HH 	
publicPP 
voidPP 
DisposePP 
(PP 
)QQ 
{RR 	
	myDisposeSS 
(SS 
trueSS 
)SS 
;SS 
GCTT 
.TT 
SuppressFinalizeTT 
(TT  
thisTT  $
)TT$ %
;TT% &
}UU 	
public]] 
FSecsTimeout]] 
fTimeout]] $
{^^ 	
get__ 
{`` 
tryaa 
{bb 
returncc 

m_fTimeoutcc %
;cc% &
}dd 
catchee 
(ee 
	Exceptionee  
exee! #
)ee# $
{ff 
FDebuggg 
.gg 
throwExceptiongg )
(gg) *
exgg* ,
)gg, -
;gg- .
}hh 
finallyii 
{jj 
}ll 
returnmm 
FSecsTimeoutmm #
.mm# $
T1mm$ &
;mm& '
}nn 
}oo 	
publicss 
stringss 
errorMessagess "
{tt 	
getuu 
{vv 
tryww 
{xx 
returnyy 
m_errorMessageyy )
;yy) *
}zz 
catch{{ 
({{ 
	Exception{{  
ex{{! #
){{# $
{|| 
FDebug}} 
.}} 
throwException}} )
(}}) *
ex}}* ,
)}}, -
;}}- .
}~~ 
finally 
{
€€ 
}
‚‚ 
return
ƒƒ 
string
ƒƒ 
.
ƒƒ 
Empty
ƒƒ #
;
ƒƒ# $
}
„„ 
}
…… 	
}
‘‘ 
}’’ ´M
ŠD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Event\EventArgs\c_FHsmsStateChangedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
[ 
Serializable 
] 
public 

class &
FHsmsStateChangedEventArgs +
:, -
FEventArgsBase. <
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FResultCode 
	m_fResult %
=& '
FResultCode( 3
.3 4
Success4 ;
;; <
private 
string 
m_errorMessage %
=& '
string( .
.. /
Empty/ 4
;4 5
private 
FConnectMode 
m_fConnectMode +
=, -
FConnectMode. :
.: ;
Passive; B
;B C
private   
string   
	m_localIp    
=  ! "
string  # )
.  ) *
Empty  * /
;  / 0
private!! 
int!! 
m_localPort!! 
=!!  !
$num!!" #
;!!# $
private"" 
string"" 

m_remoteIp"" !
=""" #
string""$ *
.""* +
Empty""+ 0
;""0 1
private## 
int## 
m_remotePort##  
=##! "
$num### $
;##$ %
private$$ 
FCommunicationState$$ #
m_fState$$$ ,
=$$- .
FCommunicationState$$/ B
.$$B C
Closed$$C I
;$$I J
internal** &
FHsmsStateChangedEventArgs** +
(**+ ,
FSecs1ToHsms++ 
fSecs1ToHsms++ %
,++% &
FEventId,, 
fEventId,, 
,,, 
FResultCode-- 
fResult-- 
,--  
string.. 
errorMessage.. 
,..  
FConnectMode// 
fConnectMode// %
,//% &
string00 
localIp00 
,00 
int11 
	localPort11 
,11 
string22 
remoteIp22 
,22 
int33 

remotePort33 
,33 
FCommunicationState44 
fState44  &
)55 
:66 
base66 
(66 
fSecs1ToHsms66 
,66  
fEventId66! )
)66) *
{77 	
	m_fResult88 
=88 
fResult88 
;88  
m_errorMessage99 
=99 
errorMessage99 )
;99) *
m_fConnectMode:: 
=:: 
fConnectMode:: )
;::) *
	m_localIp;; 
=;; 
localIp;; 
;;;  
m_localPort<< 
=<< 
	localPort<< #
;<<# $

m_remoteIp== 
=== 
remoteIp== !
;==! "
m_remotePort>> 
=>> 

remotePort>> %
;>>% &
m_fState?? 
=?? 
fState?? 
;?? 
}@@ 	
~DD 	&
FHsmsStateChangedEventArgsDD	 #
(DD# $
)EE 
{FF 	
	myDisposeGG 
(GG 
falseGG 
)GG 
;GG 
}HH 	
	protectedLL 
overrideLL 
voidLL 
	myDisposeLL  )
(LL) *
boolMM 
	disposingMM 
)NN 
{OO 	
ifPP 
(PP 
!PP 

m_disposedPP 
)PP 
{QQ 
ifRR 
(RR 
	disposingRR 
)RR 
{SS 
}UU 

m_disposedVV 
=VV 
trueVV !
;VV! "
baseXX 
.XX 
	myDisposeXX 
(XX 
	disposingXX (
)XX( )
;XX) *
}YY 
}ZZ 	
publicbb 
voidbb 
Disposebb 
(bb 
)cc 
{dd 	
	myDisposeee 
(ee 
trueee 
)ee 
;ee 
GCff 
.ff 
SuppressFinalizeff 
(ff  
thisff  $
)ff$ %
;ff% &
}gg 	
publicoo 
FResultCodeoo 
fResultoo "
{pp 	
getqq 
{rr 
tryss 
{tt 
returnuu 
	m_fResultuu $
;uu$ %
}vv 
catchww 
(ww 
	Exceptionww  
exww! #
)ww# $
{xx 
FDebugyy 
.yy 
throwExceptionyy )
(yy) *
exyy* ,
)yy, -
;yy- .
}zz 
finally{{ 
{|| 
}~~ 
return 
FResultCode "
." #
Success# *
;* +
}
€€ 
}
 	
public
…… 
string
…… 
errorMessage
…… "
{
†† 	
get
‡‡ 
{
ˆˆ 
try
‰‰ 
{
ŠŠ 
return
‹‹ 
m_errorMessage
‹‹ )
;
‹‹) *
}
ŒŒ 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
‘‘ 
{
’’ 
}
”” 
return
•• 
string
•• 
.
•• 
Empty
•• #
;
••# $
}
–– 
}
—— 	
public
›› 
FConnectMode
›› 
fConnectMode
›› (
{
œœ 	
get
 
{
 
try
ŸŸ 
{
   
return
¡¡ 
m_fConnectMode
¡¡ )
;
¡¡) *
}
¢¢ 
catch
££ 
(
££ 
	Exception
££  
ex
££! #
)
££# $
{
¤¤ 
FDebug
¥¥ 
.
¥¥ 
throwException
¥¥ )
(
¥¥) *
ex
¥¥* ,
)
¥¥, -
;
¥¥- .
}
¦¦ 
finally
§§ 
{
¨¨ 
}
ªª 
return
«« 
FConnectMode
«« #
.
««# $
Active
««$ *
;
««* +
}
¬¬ 
}
­­ 	
public
±± 
string
±± 
localIp
±± 
{
²² 	
get
³³ 
{
´´ 
try
µµ 
{
¶¶ 
return
·· 
	m_localIp
·· $
;
··$ %
}
¸¸ 
catch
¹¹ 
(
¹¹ 
	Exception
¹¹  
ex
¹¹! #
)
¹¹# $
{
ºº 
FDebug
»» 
.
»» 
throwException
»» )
(
»») *
ex
»»* ,
)
»», -
;
»»- .
}
¼¼ 
finally
½½ 
{
¾¾ 
}
ÀÀ 
return
ÁÁ 
string
ÁÁ 
.
ÁÁ 
Empty
ÁÁ #
;
ÁÁ# $
}
ÂÂ 
}
ÃÃ 	
public
ÇÇ 
int
ÇÇ 
	localPort
ÇÇ 
{
ÈÈ 	
get
ÉÉ 
{
ÊÊ 
try
ËË 
{
ÌÌ 
return
ÍÍ 
m_localPort
ÍÍ &
;
ÍÍ& '
}
ÎÎ 
catch
ÏÏ 
(
ÏÏ 
	Exception
ÏÏ  
ex
ÏÏ! #
)
ÏÏ# $
{
ĞĞ 
FDebug
ÑÑ 
.
ÑÑ 
throwException
ÑÑ )
(
ÑÑ) *
ex
ÑÑ* ,
)
ÑÑ, -
;
ÑÑ- .
}
ÒÒ 
finally
ÓÓ 
{
ÔÔ 
}
ÖÖ 
return
×× 
$num
×× 
;
×× 
}
ØØ 
}
ÙÙ 	
public
İİ 
string
İİ 
remoteIp
İİ 
{
ŞŞ 	
get
ßß 
{
àà 
try
áá 
{
ââ 
return
ãã 

m_remoteIp
ãã %
;
ãã% &
}
ää 
catch
åå 
(
åå 
	Exception
åå  
ex
åå! #
)
åå# $
{
ææ 
FDebug
çç 
.
çç 
throwException
çç )
(
çç) *
ex
çç* ,
)
çç, -
;
çç- .
}
èè 
finally
éé 
{
êê 
}
ìì 
return
íí 
string
íí 
.
íí 
Empty
íí #
;
íí# $
}
îî 
}
ïï 	
public
óó 
int
óó 

remotePort
óó 
{
ôô 	
get
õõ 
{
öö 
try
÷÷ 
{
øø 
return
ùù 
m_remotePort
ùù '
;
ùù' (
}
úú 
catch
ûû 
(
ûû 
	Exception
ûû  
ex
ûû! #
)
ûû# $
{
üü 
FDebug
ıı 
.
ıı 
throwException
ıı )
(
ıı) *
ex
ıı* ,
)
ıı, -
;
ıı- .
}
şş 
finally
ÿÿ 
{
€€ 
}
‚‚ 
return
ƒƒ 
$num
ƒƒ 
;
ƒƒ 
}
„„ 
}
…… 	
public
‰‰ !
FCommunicationState
‰‰ "
fState
‰‰# )
{
ŠŠ 	
get
‹‹ 
{
ŒŒ 
try
 
{
 
return
 
m_fState
 #
;
# $
}
 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘  
ex
‘‘! #
)
‘‘# $
{
’’ 
FDebug
““ 
.
““ 
throwException
““ )
(
““) *
ex
““* ,
)
““, -
;
““- .
}
”” 
finally
•• 
{
–– 
}
˜˜ 
return
™™ !
FCommunicationState
™™ *
.
™™* +
Closed
™™+ 1
;
™™1 2
}
šš 
}
›› 	
}
§§ 
}¨¨ ì
‰D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Event\EventArgs\c_FHsmsErrorRaisedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
[ 
Serializable 
] 
public 

class %
FHsmsErrorRaisedEventArgs *
:+ ,
FEventArgsBase- ;
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
string 
m_errorMessage %
=& '
string( .
.. /
Empty/ 4
;4 5
internal## %
FHsmsErrorRaisedEventArgs## *
(##* +
FSecs1ToHsms$$ 
fSecs1ToHsms$$ %
,$$% &
FEventId%% 
fEventId%% 
,%% 
string&& 
errorMessage&& 
)'' 
:(( 
base(( 
((( 
fSecs1ToHsms(( 
,((  
fEventId((! )
)(() *
{)) 	
m_errorMessage** 
=** 
errorMessage** )
;**) *
}++ 	
~// 	%
FHsmsErrorRaisedEventArgs//	 "
(//" #
)00 
{11 	
	myDispose22 
(22 
false22 
)22 
;22 
}33 	
	protected77 
override77 
void77 
	myDispose77  )
(77) *
bool88 
	disposing88 
)99 
{:: 	
if;; 
(;; 
!;; 

m_disposed;; 
);; 
{<< 
if== 
(== 
	disposing== 
)== 
{>> 
}@@ 

m_disposedAA 
=AA 
trueAA !
;AA! "
baseCC 
.CC 
	myDisposeCC 
(CC 
	disposingCC (
)CC( )
;CC) *
}DD 
}EE 	
publicMM 
voidMM 
DisposeMM 
(MM 
)NN 
{OO 	
	myDisposePP 
(PP 
truePP 
)PP 
;PP 
GCQQ 
.QQ 
SuppressFinalizeQQ 
(QQ  
thisQQ  $
)QQ$ %
;QQ% &
}RR 	
publicZZ 
stringZZ 
errorMessageZZ "
{[[ 	
get\\ 
{]] 
try^^ 
{__ 
return`` 
m_errorMessage`` )
;``) *
}aa 
catchbb 
(bb 
	Exceptionbb  
exbb! #
)bb# $
{cc 
FDebugdd 
.dd 
throwExceptiondd )
(dd) *
exdd* ,
)dd, -
;dd- .
}ee 
finallyff 
{gg 
}ii 
returnjj 
stringjj 
.jj 
Emptyjj #
;jj# $
}kk 
}ll 	
}xx 
}yy ë&
D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Event\EventArgs\c_FHsmsControlMessageSentEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
[ 
Serializable 
] 
public 

class ,
 FHsmsControlMessageSentEventArgs 1
:2 3
FEventArgsBase4 B
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FResultCode 
	m_fResult %
=& '
FResultCode( 3
.3 4
Success4 ;
;; <
private 
string 
m_errorMessage %
=& '
string( .
.. /
Empty/ 4
;4 5
private 
FSecsControlMessage #!
m_fSecsControlMessage$ 9
=: ;
null< @
;@ A
internal%% ,
 FHsmsControlMessageSentEventArgs%% 1
(%%1 2
FSecs1ToHsms&& 
fSecs1ToHsms&& %
,&&% &
FEventId'' 
fEventId'' 
,'' 
FResultCode(( 
fResult(( 
,((  
string)) 
errorMessage)) 
,))  
FSecsControlMessage** 
fSecsControlMessage**  3
)++ 
:,, 
base,, 
(,, 
fSecs1ToHsms,, 
,,,  
fEventId,,! )
),,) *
{-- 	!
m_fSecsControlMessage.. !
=.." #
fSecsControlMessage..$ 7
;..7 8
}// 	
~33 	,
 FHsmsControlMessageSentEventArgs33	 )
(33) *
)44 
{55 	
	myDispose66 
(66 
false66 
)66 
;66 
}77 	
	protected;; 
override;; 
void;; 
	myDispose;;  )
(;;) *
bool<< 
	disposing<< 
)== 
{>> 	
if?? 
(?? 
!?? 

m_disposed?? 
)?? 
{@@ 
ifAA 
(AA 
	disposingAA 
)AA 
{BB !
m_fSecsControlMessageCC )
=CC* +
nullCC, 0
;CC0 1
}DD 

m_disposedEE 
=EE 
trueEE !
;EE! "
baseGG 
.GG 
	myDisposeGG 
(GG 
	disposingGG (
)GG( )
;GG) *
}HH 
}II 	
publicQQ 
voidQQ 
DisposeQQ 
(QQ 
)RR 
{SS 	
	myDisposeTT 
(TT 
trueTT 
)TT 
;TT 
GCUU 
.UU 
SuppressFinalizeUU 
(UU  
thisUU  $
)UU$ %
;UU% &
}VV 	
public^^ 
FResultCode^^ 
fResult^^ "
{__ 	
get`` 
{aa 
trybb 
{cc 
returndd 
	m_fResultdd $
;dd$ %
}ee 
catchff 
(ff 
	Exceptionff  
exff! #
)ff# $
{gg 
FDebughh 
.hh 
throwExceptionhh )
(hh) *
exhh* ,
)hh, -
;hh- .
}ii 
finallyjj 
{kk 
}mm 
returnnn 
FResultCodenn "
.nn" #
Successnn# *
;nn* +
}oo 
}pp 	
publictt 
stringtt 
errorMessagett "
{uu 	
getvv 
{ww 
tryxx 
{yy 
returnzz 
m_errorMessagezz )
;zz) *
}{{ 
catch|| 
(|| 
	Exception||  
ex||! #
)||# $
{}} 
FDebug~~ 
.~~ 
throwException~~ )
(~~) *
ex~~* ,
)~~, -
;~~- .
} 
finally
€€ 
{
 
}
ƒƒ 
return
„„ 
string
„„ 
.
„„ 
Empty
„„ #
;
„„# $
}
…… 
}
†† 	
public
ŠŠ !
FSecsControlMessage
ŠŠ "!
fSecsControlMessage
ŠŠ# 6
{
‹‹ 	
get
ŒŒ 
{
 
try
 
{
 
return
 #
m_fSecsControlMessage
 0
;
0 1
}
‘‘ 
catch
’’ 
(
’’ 
	Exception
’’  
ex
’’! #
)
’’# $
{
““ 
FDebug
”” 
.
”” 
throwException
”” )
(
””) *
ex
””* ,
)
””, -
;
””- .
}
•• 
finally
–– 
{
—— 
}
™™ 
return
šš 
null
šš 
;
šš 
}
›› 
}
œœ 	
}
¨¨ 
}©© û&
”D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Event\EventArgs\c_FHsmsControlMessageReceivedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
[ 
Serializable 
] 
public 

class 0
$FHsmsControlMessageReceivedEventArgs 5
:6 7
FEventArgsBase8 F
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FResultCode 
	m_fResult %
=& '
FResultCode( 3
.3 4
Success4 ;
;; <
private 
string 
m_errorMessage %
=& '
string( .
.. /
Empty/ 4
;4 5
private 
FSecsControlMessage #!
m_fSecsControlMessage$ 9
=: ;
null< @
;@ A
internal%% 0
$FHsmsControlMessageReceivedEventArgs%% 5
(%%5 6
FSecs1ToHsms&& 
fSecs1ToHsms&& %
,&&% &
FEventId'' 
fEventId'' 
,'' 
FResultCode(( 
fResult(( 
,((  
string)) 
errorMessage)) 
,))  
FSecsControlMessage** 
fSecsControlMessage**  3
)++ 
:,, 
base,, 
(,, 
fSecs1ToHsms,, 
,,,  
fEventId,,! )
),,) *
{-- 	!
m_fSecsControlMessage.. !
=.." #
fSecsControlMessage..$ 7
;..7 8
}// 	
~33 	0
$FHsmsControlMessageReceivedEventArgs33	 -
(33- .
)44 
{55 	
	myDispose66 
(66 
false66 
)66 
;66 
}77 	
	protected;; 
override;; 
void;; 
	myDispose;;  )
(;;) *
bool<< 
	disposing<< 
)== 
{>> 	
if?? 
(?? 
!?? 

m_disposed?? 
)?? 
{@@ 
ifAA 
(AA 
	disposingAA 
)AA 
{BB !
m_fSecsControlMessageCC )
=CC* +
nullCC, 0
;CC0 1
}DD 

m_disposedEE 
=EE 
trueEE !
;EE! "
baseGG 
.GG 
	myDisposeGG 
(GG 
	disposingGG (
)GG( )
;GG) *
}HH 
}II 	
publicQQ 
voidQQ 
DisposeQQ 
(QQ 
)RR 
{SS 	
	myDisposeTT 
(TT 
trueTT 
)TT 
;TT 
GCUU 
.UU 
SuppressFinalizeUU 
(UU  
thisUU  $
)UU$ %
;UU% &
}VV 	
public^^ 
FResultCode^^ 
fResult^^ "
{__ 	
get`` 
{aa 
trybb 
{cc 
returndd 
	m_fResultdd $
;dd$ %
}ee 
catchff 
(ff 
	Exceptionff  
exff! #
)ff# $
{gg 
FDebughh 
.hh 
throwExceptionhh )
(hh) *
exhh* ,
)hh, -
;hh- .
}ii 
finallyjj 
{kk 
}mm 
returnnn 
FResultCodenn "
.nn" #
Successnn# *
;nn* +
}oo 
}pp 	
publictt 
stringtt 
errorMessagett "
{uu 	
getvv 
{ww 
tryxx 
{yy 
returnzz 
m_errorMessagezz )
;zz) *
}{{ 
catch|| 
(|| 
	Exception||  
ex||! #
)||# $
{}} 
FDebug~~ 
.~~ 
throwException~~ )
(~~) *
ex~~* ,
)~~, -
;~~- .
} 
finally
€€ 
{
 
}
ƒƒ 
return
„„ 
string
„„ 
.
„„ 
Empty
„„ #
;
„„# $
}
…… 
}
†† 	
public
ŠŠ !
FSecsControlMessage
ŠŠ "!
fSecsControlMessage
ŠŠ# 6
{
‹‹ 	
get
ŒŒ 
{
 
try
 
{
 
return
 #
m_fSecsControlMessage
 0
;
0 1
}
‘‘ 
catch
’’ 
(
’’ 
	Exception
’’  
ex
’’! #
)
’’# $
{
““ 
FDebug
”” 
.
”” 
throwException
”” )
(
””) *
ex
””* ,
)
””, -
;
””- .
}
•• 
finally
–– 
{
—— 
}
™™ 
return
šš 
null
šš 
;
šš 
}
›› 
}
œœ 	
}
¨¨ 
}©© ÿ'
‘D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Event\EventArgs\c_FHsmsDataMessageReceivedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
[ 
Serializable 
] 
public 

class -
!FHsmsDataMessageReceivedEventArgs 2
:3 4
FEventArgsBase5 C
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FResultCode 
	m_fResult %
=& '
FResultCode( 3
.3 4
Success4 ;
;; <
private 
string 
m_errorMessage %
=& '
string( .
.. /
Empty/ 4
;4 5
private 
FSecsDataMessage  
m_fSecsDataMessage! 3
=4 5
null6 :
;: ;
internal%% -
!FHsmsDataMessageReceivedEventArgs%% 2
(%%2 3
FSecs1ToHsms&& 
fSecs1ToHsms&& %
,&&% &
FEventId'' 
fEventId'' 
,'' 
FResultCode(( 
fResult(( 
,((  
string)) 
errorMessage)) 
,))  
FSecsDataMessage** 
fSecsDataMessage** -
)++ 
:,, 
base,, 
(,, 
fSecs1ToHsms,, 
,,,  
fEventId,,! )
),,) *
{-- 	
	m_fResult.. 
=.. 
fResult.. 
;..  
m_errorMessage// 
=// 
errorMessage// )
;//) *
m_fSecsDataMessage00 
=00  
fSecsDataMessage00! 1
;001 2
}11 	
~55 	-
!FHsmsDataMessageReceivedEventArgs55	 *
(55* +
)66 
{77 	
	myDispose88 
(88 
false88 
)88 
;88 
}99 	
	protected== 
override== 
void== 
	myDispose==  )
(==) *
bool>> 
	disposing>> 
)?? 
{@@ 	
ifAA 
(AA 
!AA 

m_disposedAA 
)AA 
{BB 
ifCC 
(CC 
	disposingCC 
)CC 
{DD 
m_fSecsDataMessageEE &
=EE' (
nullEE) -
;EE- .
}FF 

m_disposedGG 
=GG 
trueGG !
;GG! "
baseII 
.II 
	myDisposeII 
(II 
	disposingII (
)II( )
;II) *
}JJ 
}KK 	
publicSS 
voidSS 
DisposeSS 
(SS 
)TT 
{UU 	
	myDisposeVV 
(VV 
trueVV 
)VV 
;VV 
GCWW 
.WW 
SuppressFinalizeWW 
(WW  
thisWW  $
)WW$ %
;WW% &
}XX 	
public`` 
FResultCode`` 
fResult`` "
{aa 	
getbb 
{cc 
trydd 
{ee 
returnff 
	m_fResultff $
;ff$ %
}gg 
catchhh 
(hh 
	Exceptionhh  
exhh! #
)hh# $
{ii 
FDebugjj 
.jj 
throwExceptionjj )
(jj) *
exjj* ,
)jj, -
;jj- .
}kk 
finallyll 
{mm 
}oo 
returnpp 
FResultCodepp "
.pp" #
Successpp# *
;pp* +
}qq 
}rr 	
publicvv 
stringvv 
errorMessagevv "
{ww 	
getxx 
{yy 
tryzz 
{{{ 
return|| 
m_errorMessage|| )
;||) *
}}} 
catch~~ 
(~~ 
	Exception~~  
ex~~! #
)~~# $
{ 
FDebug
€€ 
.
€€ 
throwException
€€ )
(
€€) *
ex
€€* ,
)
€€, -
;
€€- .
}
 
finally
‚‚ 
{
ƒƒ 
}
…… 
return
†† 
string
†† 
.
†† 
Empty
†† #
;
††# $
}
‡‡ 
}
ˆˆ 	
public
ŒŒ 
FSecsDataMessage
ŒŒ 
fSecsDataMessage
ŒŒ  0
{
 	
get
 
{
 
try
 
{
‘‘ 
return
’’  
m_fSecsDataMessage
’’ -
;
’’- .
}
““ 
catch
”” 
(
”” 
	Exception
””  
ex
””! #
)
””# $
{
•• 
FDebug
–– 
.
–– 
throwException
–– )
(
––) *
ex
––* ,
)
––, -
;
––- .
}
—— 
finally
˜˜ 
{
™™ 
}
›› 
return
œœ 
null
œœ 
;
œœ 
}
 
}
 	
}
ªª 
}«« ¯
‹D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Event\EventArgs\c_FHsmsTimeoutRaisedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
[ 
Serializable 
] 
public 

class '
FHsmsTimeoutRaisedEventArgs ,
:- .
FEventArgsBase/ =
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FSecsTimeout 

m_fTimeout '
=( )
FSecsTimeout* 6
.6 7
T17 9
;9 :
private 
string 
m_errorMessage %
=& '
string( .
.. /
Empty/ 4
;4 5
internal$$ '
FHsmsTimeoutRaisedEventArgs$$ ,
($$, -
FSecs1ToHsms%% 
fSecs1ToHsms%% %
,%%% &
FEventId&& 
fEventId&& 
,&& 
FSecsTimeout'' 
fTimeout'' !
,''! "
string(( 
errorMessage(( 
))) 
:** 
base** 
(** 
fSecs1ToHsms** 
,**  
fEventId**! )
)**) *
{++ 	

m_fTimeout,, 
=,, 
fTimeout,, !
;,,! "
m_errorMessage-- 
=-- 
errorMessage-- )
;--) *
}.. 	
~22 	'
FHsmsTimeoutRaisedEventArgs22	 $
(22$ %
)33 
{44 	
	myDispose55 
(55 
false55 
)55 
;55 
}66 	
	protected:: 
override:: 
void:: 
	myDispose::  )
(::) *
bool;; 
	disposing;; 
)<< 
{== 	
if>> 
(>> 
!>> 

m_disposed>> 
)>> 
{?? 
if@@ 
(@@ 
	disposing@@ 
)@@ 
{AA 
}CC 

m_disposedDD 
=DD 
trueDD !
;DD! "
baseFF 
.FF 
	myDisposeFF 
(FF 
	disposingFF (
)FF( )
;FF) *
}GG 
}HH 	
publicPP 
voidPP 
DisposePP 
(PP 
)QQ 
{RR 	
	myDisposeSS 
(SS 
trueSS 
)SS 
;SS 
GCTT 
.TT 
SuppressFinalizeTT 
(TT  
thisTT  $
)TT$ %
;TT% &
}UU 	
public]] 
FSecsTimeout]] 
fTimeout]] $
{^^ 	
get__ 
{`` 
tryaa 
{bb 
returncc 

m_fTimeoutcc %
;cc% &
}dd 
catchee 
(ee 
	Exceptionee  
exee! #
)ee# $
{ff 
FDebuggg 
.gg 
throwExceptiongg )
(gg) *
exgg* ,
)gg, -
;gg- .
}hh 
finallyii 
{jj 
}ll 
returnmm 
FSecsTimeoutmm #
.mm# $
T1mm$ &
;mm& '
}nn 
}oo 	
publicss 
stringss 
errorMessagess "
{tt 	
getuu 
{vv 
tryww 
{xx 
returnyy 
m_errorMessageyy )
;yy) *
}zz 
catch{{ 
({{ 
	Exception{{  
ex{{! #
){{# $
{|| 
FDebug}} 
.}} 
throwException}} )
(}}) *
ex}}* ,
)}}, -
;}}- .
}~~ 
finally 
{
€€ 
}
‚‚ 
return
ƒƒ 
string
ƒƒ 
.
ƒƒ 
Empty
ƒƒ #
;
ƒƒ# $
}
„„ 
}
…… 	
}
‘‘ 
}’’ ï'
D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Event\EventArgs\c_FHsmsDataMessageSentEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
[ 
Serializable 
] 
public 

class )
FHsmsDataMessageSentEventArgs .
:/ 0
FEventArgsBase1 ?
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FResultCode 
	m_fResult %
=& '
FResultCode( 3
.3 4
Success4 ;
;; <
private 
string 
m_errorMessage %
=& '
string( .
.. /
Empty/ 4
;4 5
private 
FSecsDataMessage  
m_fSecsDataMessage! 3
=4 5
null6 :
;: ;
internal%% )
FHsmsDataMessageSentEventArgs%% .
(%%. /
FSecs1ToHsms&& 
fSecs1ToHsms&& %
,&&% &
FEventId'' 
fEventId'' 
,'' 
FResultCode(( 
fResult(( 
,((  
string)) 
errorMessage)) 
,))  
FSecsDataMessage** 
fSecsDataMessage** -
)++ 
:,, 
base,, 
(,, 
fSecs1ToHsms,, 
,,,  
fEventId,,! )
),,) *
{-- 	
	m_fResult.. 
=.. 
fResult.. 
;..  
m_errorMessage// 
=// 
errorMessage// )
;//) *
m_fSecsDataMessage00 
=00  
fSecsDataMessage00! 1
;001 2
}11 	
~55 	)
FHsmsDataMessageSentEventArgs55	 &
(55& '
)66 
{77 	
	myDispose88 
(88 
false88 
)88 
;88 
}99 	
	protected== 
override== 
void== 
	myDispose==  )
(==) *
bool>> 
	disposing>> 
)?? 
{@@ 	
ifAA 
(AA 
!AA 

m_disposedAA 
)AA 
{BB 
ifCC 
(CC 
	disposingCC 
)CC 
{DD 
m_fSecsDataMessageEE &
=EE' (
nullEE) -
;EE- .
}FF 

m_disposedGG 
=GG 
trueGG !
;GG! "
baseII 
.II 
	myDisposeII 
(II 
	disposingII (
)II( )
;II) *
}JJ 
}KK 	
publicSS 
voidSS 
DisposeSS 
(SS 
)TT 
{UU 	
	myDisposeVV 
(VV 
trueVV 
)VV 
;VV 
GCWW 
.WW 
SuppressFinalizeWW 
(WW  
thisWW  $
)WW$ %
;WW% &
}XX 	
public`` 
FResultCode`` 
fResult`` "
{aa 	
getbb 
{cc 
trydd 
{ee 
returnff 
	m_fResultff $
;ff$ %
}gg 
catchhh 
(hh 
	Exceptionhh  
exhh! #
)hh# $
{ii 
FDebugjj 
.jj 
throwExceptionjj )
(jj) *
exjj* ,
)jj, -
;jj- .
}kk 
finallyll 
{mm 
}oo 
returnpp 
FResultCodepp "
.pp" #
Successpp# *
;pp* +
}qq 
}rr 	
publicvv 
stringvv 
errorMessagevv "
{ww 	
getxx 
{yy 
tryzz 
{{{ 
return|| 
m_errorMessage|| )
;||) *
}}} 
catch~~ 
(~~ 
	Exception~~  
ex~~! #
)~~# $
{ 
FDebug
€€ 
.
€€ 
throwException
€€ )
(
€€) *
ex
€€* ,
)
€€, -
;
€€- .
}
 
finally
‚‚ 
{
ƒƒ 
}
…… 
return
†† 
string
†† 
.
†† 
Empty
†† #
;
††# $
}
‡‡ 
}
ˆˆ 	
public
ŒŒ 
FSecsDataMessage
ŒŒ 
fSecsDataMessage
ŒŒ  0
{
 	
get
 
{
 
try
 
{
‘‘ 
return
’’  
m_fSecsDataMessage
’’ -
;
’’- .
}
““ 
catch
”” 
(
”” 
	Exception
””  
ex
””! #
)
””# $
{
•• 
FDebug
–– 
.
–– 
throwException
–– )
(
––) *
ex
––* ,
)
––, -
;
––- .
}
—— 
finally
˜˜ 
{
™™ 
}
›› 
return
œœ 
null
œœ 
;
œœ 
}
 
}
 	
}
ªª 
}«« ó'
D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Event\EventArgs\c_FSecs1DataMessageSentEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
[ 
Serializable 
] 
public 

class *
FSecs1DataMessageSentEventArgs /
:0 1
FEventArgsBase2 @
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FResultCode 
	m_fResult %
=& '
FResultCode( 3
.3 4
Success4 ;
;; <
private 
string 
m_errorMessage %
=& '
string( .
.. /
Empty/ 4
;4 5
private 
FSecsDataMessage  
m_fSecsDataMessage! 3
=4 5
null6 :
;: ;
internal%% *
FSecs1DataMessageSentEventArgs%% /
(%%/ 0
FSecs1ToHsms&& 
fSecs1ToHsms&& %
,&&% &
FEventId'' 
fEventId'' 
,'' 
FResultCode(( 
fResult(( 
,((  
string)) 
errorMessage)) 
,))  
FSecsDataMessage** 
fSecsDataMessage** -
)++ 
:,, 
base,, 
(,, 
fSecs1ToHsms,, 
,,,  
fEventId,,! )
),,) *
{-- 	
	m_fResult.. 
=.. 
fResult.. 
;..  
m_errorMessage// 
=// 
errorMessage// )
;//) *
m_fSecsDataMessage00 
=00  
fSecsDataMessage00! 1
;001 2
}11 	
~55 	*
FSecs1DataMessageSentEventArgs55	 '
(55' (
)66 
{77 	
	myDispose88 
(88 
false88 
)88 
;88 
}99 	
	protected== 
override== 
void== 
	myDispose==  )
(==) *
bool>> 
	disposing>> 
)?? 
{@@ 	
ifAA 
(AA 
!AA 

m_disposedAA 
)AA 
{BB 
ifCC 
(CC 
	disposingCC 
)CC 
{DD 
m_fSecsDataMessageEE &
=EE' (
nullEE) -
;EE- .
}FF 

m_disposedGG 
=GG 
trueGG !
;GG! "
baseII 
.II 
	myDisposeII 
(II 
	disposingII (
)II( )
;II) *
}JJ 
}KK 	
publicSS 
voidSS 
DisposeSS 
(SS 
)TT 
{UU 	
	myDisposeVV 
(VV 
trueVV 
)VV 
;VV 
GCWW 
.WW 
SuppressFinalizeWW 
(WW  
thisWW  $
)WW$ %
;WW% &
}XX 	
public`` 
FResultCode`` 
fResult`` "
{aa 	
getbb 
{cc 
trydd 
{ee 
returnff 
	m_fResultff $
;ff$ %
}gg 
catchhh 
(hh 
	Exceptionhh  
exhh! #
)hh# $
{ii 
FDebugjj 
.jj 
throwExceptionjj )
(jj) *
exjj* ,
)jj, -
;jj- .
}kk 
finallyll 
{mm 
}oo 
returnpp 
FResultCodepp "
.pp" #
Successpp# *
;pp* +
}qq 
}rr 	
publicvv 
stringvv 
errorMessagevv "
{ww 	
getxx 
{yy 
tryzz 
{{{ 
return|| 
m_errorMessage|| )
;||) *
}}} 
catch~~ 
(~~ 
	Exception~~  
ex~~! #
)~~# $
{ 
FDebug
€€ 
.
€€ 
throwException
€€ )
(
€€) *
ex
€€* ,
)
€€, -
;
€€- .
}
 
finally
‚‚ 
{
ƒƒ 
}
…… 
return
†† 
string
†† 
.
†† 
Empty
†† #
;
††# $
}
‡‡ 
}
ˆˆ 	
public
ŒŒ 
FSecsDataMessage
ŒŒ 
fSecsDataMessage
ŒŒ  0
{
 	
get
 
{
 
try
 
{
‘‘ 
return
’’  
m_fSecsDataMessage
’’ -
;
’’- .
}
““ 
catch
”” 
(
”” 
	Exception
””  
ex
””! #
)
””# $
{
•• 
FDebug
–– 
.
–– 
throwException
–– )
(
––) *
ex
––* ,
)
––, -
;
––- .
}
—— 
finally
˜˜ 
{
™™ 
}
›› 
return
œœ 
null
œœ 
;
œœ 
}
 
}
 	
}
ªª 
}«« ñ%
ˆD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Event\EventArgs\c_FSecs1BlockSentEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
[ 
Serializable 
] 
public 

class $
FSecs1BlockSentEventArgs )
:* +
FEventArgsBase, :
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FResultCode 
	m_fResult %
=& '
FResultCode( 3
.3 4
Success4 ;
;; <
private 
string 
m_errorMessage %
=& '
string( .
.. /
Empty/ 4
;4 5
private 

FSecsBlock 
m_fSecsBlock '
=( )
null* .
;. /
internal%% $
FSecs1BlockSentEventArgs%% )
(%%) *
FSecs1ToHsms&& 
fSecs1ToHsms&& %
,&&% &
FEventId'' 
fEventId'' 
,'' 
FResultCode(( 
fResult(( 
,((  
string)) 
errorMessage)) 
,))  

FSecsBlock** 

fSecsBlock** !
)++ 
:,, 
base,, 
(,, 
fSecs1ToHsms,, 
,,,  
fEventId,,! )
),,) *
{-- 	
m_fSecsBlock.. 
=.. 

fSecsBlock.. %
;..% &
}// 	
~33 	$
FSecs1BlockSentEventArgs33	 !
(33! "
)44 
{55 	
	myDispose66 
(66 
false66 
)66 
;66 
}77 	
	protected;; 
override;; 
void;; 
	myDispose;;  )
(;;) *
bool<< 
	disposing<< 
)== 
{>> 	
if?? 
(?? 
!?? 

m_disposed?? 
)?? 
{@@ 
ifAA 
(AA 
	disposingAA 
)AA 
{BB 
m_fSecsBlockCC  
=CC! "
nullCC# '
;CC' (
}DD 

m_disposedEE 
=EE 
trueEE !
;EE! "
baseGG 
.GG 
	myDisposeGG 
(GG 
	disposingGG (
)GG( )
;GG) *
}HH 
}II 	
publicQQ 
voidQQ 
DisposeQQ 
(QQ 
)RR 
{SS 	
	myDisposeTT 
(TT 
trueTT 
)TT 
;TT 
GCUU 
.UU 
SuppressFinalizeUU 
(UU  
thisUU  $
)UU$ %
;UU% &
}VV 	
public^^ 
FResultCode^^ 
fResult^^ "
{__ 	
get`` 
{aa 
trybb 
{cc 
returndd 
	m_fResultdd $
;dd$ %
}ee 
catchff 
(ff 
	Exceptionff  
exff! #
)ff# $
{gg 
FDebughh 
.hh 
throwExceptionhh )
(hh) *
exhh* ,
)hh, -
;hh- .
}ii 
finallyjj 
{kk 
}mm 
returnnn 
FResultCodenn "
.nn" #
Successnn# *
;nn* +
}oo 
}pp 	
publictt 
stringtt 
errorMessagett "
{uu 	
getvv 
{ww 
tryxx 
{yy 
returnzz 
m_errorMessagezz )
;zz) *
}{{ 
catch|| 
(|| 
	Exception||  
ex||! #
)||# $
{}} 
FDebug~~ 
.~~ 
throwException~~ )
(~~) *
ex~~* ,
)~~, -
;~~- .
} 
finally
€€ 
{
 
}
ƒƒ 
return
„„ 
string
„„ 
.
„„ 
Empty
„„ #
;
„„# $
}
…… 
}
†† 	
public
ŠŠ 

FSecsBlock
ŠŠ 

fSecsBlock
ŠŠ $
{
‹‹ 	
get
ŒŒ 
{
 
try
 
{
 
return
 
m_fSecsBlock
 '
;
' (
}
‘‘ 
catch
’’ 
(
’’ 
	Exception
’’  
ex
’’! #
)
’’# $
{
““ 
FDebug
”” 
.
”” 
throwException
”” )
(
””) *
ex
””* ,
)
””, -
;
””- .
}
•• 
finally
–– 
{
—— 
}
™™ 
return
šš 
null
šš 
;
šš 
}
›› 
}
œœ 	
}
¨¨ 
}©© ³(
D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Event\EventArgs\c_FSecs1InterceptingDataMessageReceivedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
[ 
Serializable 
] 
public 

class :
.FSecs1InterceptingDataMessageReceivedEventArgs ?
:@ A
FEventArgsBaseB P
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FResultCode 
	m_fResult %
=& '
FResultCode( 3
.3 4
Success4 ;
;; <
private 
string 
m_errorMessage %
=& '
string( .
.. /
Empty/ 4
;4 5
private 
FSecsDataMessage  
m_fSecsDataMessage! 3
=4 5
null6 :
;: ;
internal%% :
.FSecs1InterceptingDataMessageReceivedEventArgs%% ?
(%%? @
FSecs1ToHsms&& 
fSecs1ToHsms&& %
,&&% &
FEventId'' 
fEventId'' 
,'' 
FResultCode(( 
fResult(( 
,((  
string)) 
errorMessage)) 
,))  
FSecsDataMessage** 
fSecsDataMessage** -
)++ 
:,, 
base,, 
(,, 
fSecs1ToHsms,, 
,,,  
fEventId,,! )
),,) *
{-- 	
	m_fResult.. 
=.. 
fResult.. 
;..  
m_errorMessage// 
=// 
errorMessage// )
;//) *
m_fSecsDataMessage00 
=00  
fSecsDataMessage00! 1
;001 2
}11 	
~55 	:
.FSecs1InterceptingDataMessageReceivedEventArgs55	 7
(557 8
)66 
{77 	
	myDispose88 
(88 
false88 
)88 
;88 
}99 	
	protected== 
override== 
void== 
	myDispose==  )
(==) *
bool>> 
	disposing>> 
)?? 
{@@ 	
ifAA 
(AA 
!AA 

m_disposedAA 
)AA 
{BB 
ifCC 
(CC 
	disposingCC 
)CC 
{DD 
m_fSecsDataMessageEE &
=EE' (
nullEE) -
;EE- .
}FF 

m_disposedGG 
=GG 
trueGG !
;GG! "
baseII 
.II 
	myDisposeII 
(II 
	disposingII (
)II( )
;II) *
}JJ 
}KK 	
publicSS 
voidSS 
DisposeSS 
(SS 
)TT 
{UU 	
	myDisposeVV 
(VV 
trueVV 
)VV 
;VV 
GCWW 
.WW 
SuppressFinalizeWW 
(WW  
thisWW  $
)WW$ %
;WW% &
}XX 	
public`` 
FResultCode`` 
fResult`` "
{aa 	
getbb 
{cc 
trydd 
{ee 
returnff 
	m_fResultff $
;ff$ %
}gg 
catchhh 
(hh 
	Exceptionhh  
exhh! #
)hh# $
{ii 
FDebugjj 
.jj 
throwExceptionjj )
(jj) *
exjj* ,
)jj, -
;jj- .
}kk 
finallyll 
{mm 
}oo 
returnpp 
FResultCodepp "
.pp" #
Successpp# *
;pp* +
}qq 
}rr 	
publicvv 
stringvv 
errorMessagevv "
{ww 	
getxx 
{yy 
tryzz 
{{{ 
return|| 
m_errorMessage|| )
;||) *
}}} 
catch~~ 
(~~ 
	Exception~~  
ex~~! #
)~~# $
{ 
FDebug
€€ 
.
€€ 
throwException
€€ )
(
€€) *
ex
€€* ,
)
€€, -
;
€€- .
}
 
finally
‚‚ 
{
ƒƒ 
}
…… 
return
†† 
string
†† 
.
†† 
Empty
†† #
;
††# $
}
‡‡ 
}
ˆˆ 	
public
ŒŒ 
FSecsDataMessage
ŒŒ 
fSecsDataMessage
ŒŒ  0
{
 	
get
 
{
 
try
 
{
‘‘ 
return
’’  
m_fSecsDataMessage
’’ -
;
’’- .
}
““ 
catch
”” 
(
”” 
	Exception
””  
ex
””! #
)
””# $
{
•• 
FDebug
–– 
.
–– 
throwException
–– )
(
––) *
ex
––* ,
)
––, -
;
––- .
}
—— 
finally
˜˜ 
{
™™ 
}
›› 
return
œœ 
null
œœ 
;
œœ 
}
 
}
 	
}
ªª 
}«« ¯(
D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Event\EventArgs\c_FHsmsInterceptingDataMessageReceivedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
[ 
Serializable 
] 
public 

class 9
-FHsmsInterceptingDataMessageReceivedEventArgs >
:? @
FEventArgsBaseA O
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FResultCode 
	m_fResult %
=& '
FResultCode( 3
.3 4
Success4 ;
;; <
private 
string 
m_errorMessage %
=& '
string( .
.. /
Empty/ 4
;4 5
private 
FSecsDataMessage  
m_fSecsDataMessage! 3
=4 5
null6 :
;: ;
internal%% 9
-FHsmsInterceptingDataMessageReceivedEventArgs%% >
(%%> ?
FSecs1ToHsms&& 
fSecs1ToHsms&& %
,&&% &
FEventId'' 
fEventId'' 
,'' 
FResultCode(( 
fResult(( 
,((  
string)) 
errorMessage)) 
,))  
FSecsDataMessage** 
fSecsDataMessage** -
)++ 
:,, 
base,, 
(,, 
fSecs1ToHsms,, 
,,,  
fEventId,,! )
),,) *
{-- 	
	m_fResult.. 
=.. 
fResult.. 
;..  
m_errorMessage// 
=// 
errorMessage// )
;//) *
m_fSecsDataMessage00 
=00  
fSecsDataMessage00! 1
;001 2
}11 	
~55 	9
-FHsmsInterceptingDataMessageReceivedEventArgs55	 6
(556 7
)66 
{77 	
	myDispose88 
(88 
false88 
)88 
;88 
}99 	
	protected== 
override== 
void== 
	myDispose==  )
(==) *
bool>> 
	disposing>> 
)?? 
{@@ 	
ifAA 
(AA 
!AA 

m_disposedAA 
)AA 
{BB 
ifCC 
(CC 
	disposingCC 
)CC 
{DD 
m_fSecsDataMessageEE &
=EE' (
nullEE) -
;EE- .
}FF 

m_disposedGG 
=GG 
trueGG !
;GG! "
baseII 
.II 
	myDisposeII 
(II 
	disposingII (
)II( )
;II) *
}JJ 
}KK 	
publicSS 
voidSS 
DisposeSS 
(SS 
)TT 
{UU 	
	myDisposeVV 
(VV 
trueVV 
)VV 
;VV 
GCWW 
.WW 
SuppressFinalizeWW 
(WW  
thisWW  $
)WW$ %
;WW% &
}XX 	
public`` 
FResultCode`` 
fResult`` "
{aa 	
getbb 
{cc 
trydd 
{ee 
returnff 
	m_fResultff $
;ff$ %
}gg 
catchhh 
(hh 
	Exceptionhh  
exhh! #
)hh# $
{ii 
FDebugjj 
.jj 
throwExceptionjj )
(jj) *
exjj* ,
)jj, -
;jj- .
}kk 
finallyll 
{mm 
}oo 
returnpp 
FResultCodepp "
.pp" #
Successpp# *
;pp* +
}qq 
}rr 	
publicvv 
stringvv 
errorMessagevv "
{ww 	
getxx 
{yy 
tryzz 
{{{ 
return|| 
m_errorMessage|| )
;||) *
}}} 
catch~~ 
(~~ 
	Exception~~  
ex~~! #
)~~# $
{ 
FDebug
€€ 
.
€€ 
throwException
€€ )
(
€€) *
ex
€€* ,
)
€€, -
;
€€- .
}
 
finally
‚‚ 
{
ƒƒ 
}
…… 
return
†† 
string
†† 
.
†† 
Empty
†† #
;
††# $
}
‡‡ 
}
ˆˆ 	
public
ŒŒ 
FSecsDataMessage
ŒŒ 
fSecsDataMessage
ŒŒ  0
{
 	
get
 
{
 
try
 
{
‘‘ 
return
’’  
m_fSecsDataMessage
’’ -
;
’’- .
}
““ 
catch
”” 
(
”” 
	Exception
””  
ex
””! #
)
””# $
{
•• 
FDebug
–– 
.
–– 
throwException
–– )
(
––) *
ex
––* ,
)
––, -
;
––- .
}
—— 
finally
˜˜ 
{
™™ 
}
›› 
return
œœ 
null
œœ 
;
œœ 
}
 
}
 	
}
ªª 
}«« ®
‡D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Event\EventArgs\c_FLogMonitoringEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
[ 
Serializable 
] 
public 

class #
FLogMonitoringEventArgs (
:) *
FEventArgsBase+ 9
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
string 
m_log 
= 
string %
.% &
Empty& +
;+ ,
internal## #
FLogMonitoringEventArgs## (
(##( )
FSecs1ToHsms$$ 
fSecs1ToHsms$$ %
,$$% &
FEventId%% 
fEventId%% 
,%% 
string&& 
log&& 
)'' 
:(( 
base(( 
((( 
fSecs1ToHsms(( 
,((  
fEventId((! )
)(() *
{)) 	
m_log** 
=** 
log** 
;** 
}++ 	
~// 	#
FLogMonitoringEventArgs//	  
(//  !
)00 
{11 	
	myDispose22 
(22 
false22 
)22 
;22 
}33 	
	protected77 
override77 
void77 
	myDispose77  )
(77) *
bool88 
	disposing88 
)99 
{:: 	
if;; 
(;; 
!;; 

m_disposed;; 
);; 
{<< 
if== 
(== 
	disposing== 
)== 
{>> 
}@@ 

m_disposedAA 
=AA 
trueAA !
;AA! "
baseCC 
.CC 
	myDisposeCC 
(CC 
	disposingCC (
)CC( )
;CC) *
}DD 
}EE 	
publicMM 
voidMM 
DisposeMM 
(MM 
)NN 
{OO 	
	myDisposePP 
(PP 
truePP 
)PP 
;PP 
GCQQ 
.QQ 
SuppressFinalizeQQ 
(QQ  
thisQQ  $
)QQ$ %
;QQ% &
}RR 	
publicZZ 
stringZZ 
logZZ 
{[[ 	
get\\ 
{]] 
try^^ 
{__ 
return`` 
m_log``  
;``  !
}aa 
catchbb 
(bb 
	Exceptionbb  
exbb! #
)bb# $
{cc 
FDebugdd 
.dd 
throwExceptiondd )
(dd) *
exdd* ,
)dd, -
;dd- .
}ee 
finallyff 
{gg 
}ii 
returnjj 
stringjj 
.jj 
Emptyjj #
;jj# $
}kk 
}ll 	
}xx 
}yy ×Ú
tD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\LogWriter\c_FLogWriter.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
internal 
class 

FLogWriter 
: 
IDisposable *
{ 
const 
string 

LogFileExt 
=  !
$str" '
;' (
private 
bool 

m_disposed 
=  !
false" '
;' (
private!! 
FSecs1ToHsms!! 
m_fSecs1ToHsms!! +
=!!, -
null!!. 2
;!!2 3
private"" 
FQueue"" 
<"" 
string"" 
>"" 
m_fLogQueue"" *
=""+ ,
null""- 1
;""1 2
private## 
FThread## 

m_fThdMain## "
=### $
null##% )
;##) *
private%% 
string%% 
m_logFileName%% $
=%%% &
string%%' -
.%%- .
Empty%%. 3
;%%3 4
private&& 

FileStream&& 
m_fsLogFile&& &
=&&' (
null&&) -
;&&- .
private'' 
StreamWriter'' 
m_swLogFile'' (
='') *
null''+ /
;''/ 0
private(( 
string(( 
m_logFileNameSuffix(( *
=((+ ,
string((- 3
.((3 4
Empty((4 9
;((9 :
public.. 

FLogWriter.. 
(.. 
FSecs1ToHsms// 
fSecs1ToHsms// %
)00 
{11 	
m_fSecs1ToHsms22 
=22 
fSecs1ToHsms22 )
;22) *
init33 
(33 
)33 
;33 
}44 	
~88 	

FLogWriter88	 
(88 
)99 
{:: 	
	myDispose;; 
(;; 
false;; 
);; 
;;; 
}<< 	
	protected@@ 
void@@ 
	myDispose@@  
(@@  !
boolAA 
	disposingAA 
)BB 
{CC 	
ifDD 
(DD 
!DD 

m_disposedDD 
)DD 
{EE 
ifFF 
(FF 
	disposingFF 
)FF 
{GG 
termHH 
(HH 
)HH 
;HH 
m_fSecs1ToHsmsII "
=II# $
nullII% )
;II) *
}JJ 

m_disposedLL 
=LL 
trueLL !
;LL! "
}MM 
}NN 	
publicVV 
voidVV 
DisposeVV 
(VV 
)WW 
{XX 	
	myDisposeYY 
(YY 
trueYY 
)YY 
;YY 
GCZZ 
.ZZ 
SuppressFinalizeZZ 
(ZZ  
thisZZ  $
)ZZ$ %
;ZZ% &
}[[ 	
privateii 
voidii 
initii 
(ii 
)jj 
{kk 	
tryll 
{mm 
m_fLogQueuenn 
=nn 
newnn !
FQueuenn" (
<nn( )
stringnn) /
>nn/ 0
(nn0 1
)nn1 2
;nn2 3
m_logFileNameSuffixrr #
=rr$ %
m_fSecs1ToHsmsrr& 4
.rr4 5
logFileNameSuffixrr5 F
;rrF G

m_fThdMainvv 
=vv 
newvv  
FThreadvv! (
(vv( )
$strvv) :
)vv: ;
;vv; <

m_fThdMainww 
.ww 
ThreadJobCalledww *
+=ww+ -
newww. 1(
FThreadJobCalledEventHandlerww2 N
(wwN O&
m_fThdMain_ThreadJobCalledwwO i
)wwi j
;wwj k

m_fThdMainxx 
.xx 
startxx  
(xx  !
)xx! "
;xx" #
}yy 
catchzz 
(zz 
	Exceptionzz 
exzz 
)zz  
{{{ 
FDebug|| 
.|| 
throwException|| %
(||% &
ex||& (
)||( )
;||) *
}}} 
finally~~ 
{ 
}
 
}
‚‚ 	
private
†† 
void
†† 
term
†† 
(
†† 
)
‡‡ 
{
ˆˆ 	
try
‰‰ 
{
ŠŠ 
if
‹‹ 
(
‹‹ 

m_fThdMain
‹‹ 
!=
‹‹ !
null
‹‹" &
)
‹‹& '
{
ŒŒ 
if
 
(
 
m_fLogQueue
 #
!=
$ &
null
' +
)
+ ,
{
 
while
 
(
 
m_fLogQueue
 *
.
* +
count
+ 0
>
1 2
$num
3 4
)
4 5
{
 
System
‘‘ "
.
‘‘" #
	Threading
‘‘# ,
.
‘‘, -
Thread
‘‘- 3
.
‘‘3 4
Sleep
‘‘4 9
(
‘‘9 :
$num
‘‘: <
)
‘‘< =
;
‘‘= >
}
’’ 
}
““ 

m_fThdMain
—— 
.
—— 
stop
—— #
(
——# $
)
——$ %
;
——% &

m_fThdMain
˜˜ 
.
˜˜ 
Dispose
˜˜ &
(
˜˜& '
)
˜˜' (
;
˜˜( )

m_fThdMain
™™ 
.
™™ 
ThreadJobCalled
™™ .
-=
™™/ 1
new
™™2 5*
FThreadJobCalledEventHandler
™™6 R
(
™™R S(
m_fThdMain_ThreadJobCalled
™™S m
)
™™m n
;
™™n o

m_fThdMain
šš 
=
šš  
null
šš! %
;
šš% &
}
›› 
if
ŸŸ 
(
ŸŸ 
m_fLogQueue
ŸŸ 
!=
ŸŸ  "
null
ŸŸ# '
)
ŸŸ' (
{
   
m_fLogQueue
¡¡ 
.
¡¡  
Dispose
¡¡  '
(
¡¡' (
)
¡¡( )
;
¡¡) *
m_fLogQueue
¢¢ 
=
¢¢  !
null
¢¢" &
;
¢¢& '
}
££ 
closeLogFile
§§ 
(
§§ 
)
§§ 
;
§§ 
}
¨¨ 
catch
©© 
(
©© 
	Exception
©© 
ex
©© 
)
©©  
{
ªª 
FDebug
«« 
.
«« 
throwException
«« %
(
««% &
ex
««& (
)
««( )
;
««) *
}
¬¬ 
finally
­­ 
{
®® 
}
°° 
}
±± 	
private
µµ 
void
µµ 
openLogFile
µµ  
(
µµ  !
)
¶¶ 
{
·· 	
string
¸¸ 
searchPattern
¸¸  
=
¸¸! "
string
¸¸# )
.
¸¸) *
Empty
¸¸* /
;
¸¸/ 0
string
¹¹ 
[
¹¹ 
]
¹¹ 
files
¹¹ 
=
¹¹ 
null
¹¹ !
;
¹¹! "
FileInfo
ºº 
fileInfo
ºº 
=
ºº 
null
ºº  $
;
ºº$ %
string
»» 
newLogFileName
»» !
=
»»" #
string
»»$ *
.
»»* +
Empty
»»+ 0
;
»»0 1
try
½½ 
{
¾¾ 
if
¿¿ 
(
¿¿ 
!
¿¿ 
	Directory
¿¿ 
.
¿¿ 
Exists
¿¿ %
(
¿¿% &
m_fSecs1ToHsms
¿¿& 4
.
¿¿4 5
logDirectory
¿¿5 A
)
¿¿A B
)
¿¿B C
{
ÀÀ 
	Directory
ÁÁ 
.
ÁÁ 
CreateDirectory
ÁÁ -
(
ÁÁ- .
m_fSecs1ToHsms
ÁÁ. <
.
ÁÁ< =
logDirectory
ÁÁ= I
)
ÁÁI J
;
ÁÁJ K
}
ÂÂ 
if
ÆÆ 
(
ÆÆ 
m_fsLogFile
ÆÆ 
==
ÆÆ  "
null
ÆÆ# '
)
ÆÆ' (
{
ÇÇ !
m_logFileNameSuffix
ÈÈ '
=
ÈÈ( )
m_fSecs1ToHsms
ÈÈ* 8
.
ÈÈ8 9
logFileNameSuffix
ÈÈ9 J
;
ÈÈJ K
searchPattern
ÉÉ !
=
ÉÉ" #
$str
ÉÉ$ (
+
ÉÉ) *!
m_logFileNameSuffix
ÉÉ+ >
+
ÉÉ? @
$str
ÉÉA D
+
ÉÉE F

LogFileExt
ÉÉG Q
;
ÉÉQ R
files
ÊÊ 
=
ÊÊ 
	Directory
ÊÊ %
.
ÊÊ% &
GetFiles
ÊÊ& .
(
ÊÊ. /
m_fSecs1ToHsms
ÊÊ/ =
.
ÊÊ= >
logDirectory
ÊÊ> J
,
ÊÊJ K
searchPattern
ÊÊL Y
)
ÊÊY Z
;
ÊÊZ [
if
ÌÌ 
(
ÌÌ 
files
ÌÌ 
.
ÌÌ 
Length
ÌÌ $
==
ÌÌ% '
$num
ÌÌ( )
)
ÌÌ) *
{
ÍÍ 
m_logFileName
ÎÎ %
=
ÎÎ& '
string
ÎÎ( .
.
ÎÎ. /
Empty
ÎÎ/ 4
;
ÎÎ4 5
}
ÏÏ 
else
ĞĞ 
{
ÑÑ 
m_logFileName
ÒÒ %
=
ÒÒ& '
files
ÒÒ( -
[
ÒÒ- .
files
ÒÒ. 3
.
ÒÒ3 4
Length
ÒÒ4 :
-
ÒÒ; <
$num
ÒÒ= >
]
ÒÒ> ?
;
ÒÒ? @
fileInfo
ÓÓ  
=
ÓÓ! "
new
ÓÓ# &
FileInfo
ÓÓ' /
(
ÓÓ/ 0
m_logFileName
ÓÓ0 =
)
ÓÓ= >
;
ÓÓ> ?
if
ÔÔ 
(
ÔÔ 
fileInfo
ÔÔ $
.
ÔÔ$ %
Length
ÔÔ% +
>=
ÔÔ, .
(
ÔÔ/ 0
m_fSecs1ToHsms
ÔÔ0 >
.
ÔÔ> ?
logFileMaxSize
ÔÔ? M
*
ÔÔN O
$num
ÔÔP T
*
ÔÔU V
$num
ÔÔW [
)
ÔÔ[ \
)
ÔÔ\ ]
{
ÕÕ 
m_logFileName
ÖÖ )
=
ÖÖ* +
string
ÖÖ, 2
.
ÖÖ2 3
Empty
ÖÖ3 8
;
ÖÖ8 9
}
×× 
}
ØØ 
}
ÙÙ 
else
ÚÚ 
{
ÛÛ 
fileInfo
ÜÜ 
=
ÜÜ 
new
ÜÜ "
FileInfo
ÜÜ# +
(
ÜÜ+ ,
m_logFileName
ÜÜ, 9
)
ÜÜ9 :
;
ÜÜ: ;
if
İİ 
(
İİ 
fileInfo
İİ  
.
İİ  !
Length
İİ! '
>=
İİ( *
(
İİ+ ,
m_fSecs1ToHsms
İİ, :
.
İİ: ;
logFileMaxSize
İİ; I
*
İİJ K
$num
İİL P
*
İİQ R
$num
İİS W
)
İİW X
)
İİX Y
{
ŞŞ 
closeLogFile
ßß $
(
ßß$ %
)
ßß% &
;
ßß& '
m_logFileName
àà %
=
àà& '
string
àà( .
.
àà. /
Empty
àà/ 4
;
àà4 5
}
áá 
else
ââ 
if
ââ 
(
ââ !
m_logFileNameSuffix
ââ 0
!=
ââ1 3
m_fSecs1ToHsms
ââ4 B
.
ââB C
logFileNameSuffix
ââC T
)
ââT U
{
ãã 
closeLogFile
ää $
(
ää$ %
)
ää% &
;
ää& '
m_logFileName
åå %
=
åå& '
string
åå( .
.
åå. /
Empty
åå/ 4
;
åå4 5
}
ææ 
}
çç 
if
ëë 
(
ëë 
m_swLogFile
ëë 
==
ëë  "
null
ëë# '
)
ëë' (
{
ìì 
if
íí 
(
íí 
m_logFileName
íí %
==
íí& (
string
íí) /
.
íí/ 0
Empty
íí0 5
)
íí5 6
{
îî !
m_logFileNameSuffix
ïï +
=
ïï, -
m_fSecs1ToHsms
ïï. <
.
ïï< =
logFileNameSuffix
ïï= N
;
ïïN O
m_logFileName
ğğ %
=
ğğ& '
m_fSecs1ToHsms
ğğ( 6
.
ğğ6 7
logDirectory
ğğ7 C
+
ğğD E
$str
ğğF J
+
ğğK L
DateTime
ğğM U
.
ğğU V
Now
ğğV Y
.
ğğY Z
ToString
ğğZ b
(
ğğb c
$str
ğğc v
)
ğğv w
+
ğğx y
$str
ğğz }
+
ğğ~ #
m_logFileNameSuffixğğ€ “
+ğğ” •
$strğğ– ™
+ğğš ›

LogFileExtğğœ ¦
;ğğ¦ §
}
ññ 
m_fsLogFile
òò 
=
òò  !
new
òò" %

FileStream
òò& 0
(
òò0 1
m_logFileName
òò1 >
,
òò> ?
FileMode
òò@ H
.
òòH I
OpenOrCreate
òòI U
|
òòV W
FileMode
òòX `
.
òò` a
Append
òòa g
,
òòg h

FileAccess
òòi s
.
òòs t
Write
òòt y
,
òòy z
	FileShareòò{ „
.òò„ …
Readòò… ‰
)òò‰ Š
;òòŠ ‹
m_swLogFile
óó 
=
óó  !
new
óó" %
StreamWriter
óó& 2
(
óó2 3
m_fsLogFile
óó3 >
,
óó> ?
Encoding
óó@ H
.
óóH I
Default
óóI P
)
óóP Q
;
óóQ R
}
ôô 
}
õõ 
catch
öö 
(
öö 
	Exception
öö 
ex
öö 
)
öö  
{
÷÷ 
FDebug
øø 
.
øø 
throwException
øø %
(
øø% &
ex
øø& (
)
øø( )
;
øø) *
}
ùù 
finally
úú 
{
ûû 
files
üü 
=
üü 
null
üü 
;
üü 
fileInfo
ıı 
=
ıı 
null
ıı 
;
ıı  
}
şş 
}
ÿÿ 	
private
ƒƒ 
void
ƒƒ 
closeLogFile
ƒƒ !
(
ƒƒ! "
)
„„ 
{
…… 	
try
†† 
{
‡‡ 
if
ˆˆ 
(
ˆˆ 
m_swLogFile
ˆˆ 
!=
ˆˆ  "
null
ˆˆ# '
)
ˆˆ' (
{
‰‰ 
m_swLogFile
ŠŠ 
.
ŠŠ  
Flush
ŠŠ  %
(
ŠŠ% &
)
ŠŠ& '
;
ŠŠ' (
}
‹‹ 
if
 
(
 
m_fsLogFile
 
!=
  "
null
# '
)
' (
{
 
m_fsLogFile
 
.
  
Flush
  %
(
% &
)
& '
;
' (
}
 
if
”” 
(
”” 
m_swLogFile
”” 
!=
””  "
null
””# '
)
””' (
{
•• 
m_swLogFile
–– 
.
––  
Close
––  %
(
––% &
)
––& '
;
––' (
m_swLogFile
—— 
.
——  
Dispose
——  '
(
——' (
)
——( )
;
——) *
m_swLogFile
˜˜ 
=
˜˜  !
null
˜˜" &
;
˜˜& '
}
™™ 
if
›› 
(
›› 
m_fsLogFile
›› 
!=
››  "
null
››# '
)
››' (
{
œœ 
m_fsLogFile
 
.
  
Close
  %
(
% &
)
& '
;
' (
m_fsLogFile
 
.
  
Dispose
  '
(
' (
)
( )
;
) *
m_fsLogFile
ŸŸ 
=
ŸŸ  !
null
ŸŸ" &
;
ŸŸ& '
}
   
}
¡¡ 
catch
¢¢ 
(
¢¢ 
	Exception
¢¢ 
ex
¢¢ 
)
¢¢  
{
££ 
FDebug
¤¤ 
.
¤¤ 
throwException
¤¤ %
(
¤¤% &
ex
¤¤& (
)
¤¤( )
;
¤¤) *
}
¥¥ 
finally
¦¦ 
{
§§ 
}
©© 
}
ªª 	
private
®® 
void
®® 
writeLog
®® 
(
®® 
)
¯¯ 
{
°° 	
string
±± 
log
±± 
=
±± 
string
±± 
.
±±  
Empty
±±  %
;
±±% &
try
³³ 
{
´´ 
openLogFile
µµ 
(
µµ 
)
µµ 
;
µµ 
while
¶¶ 
(
¶¶ 
m_fLogQueue
¶¶ "
.
¶¶" #
count
¶¶# (
>
¶¶) *
$num
¶¶+ ,
)
¶¶, -
{
·· 
log
¸¸ 
=
¸¸ 
m_fLogQueue
¸¸ %
.
¸¸% &
dequeue
¸¸& -
(
¸¸- .
)
¸¸. /
;
¸¸/ 0
m_swLogFile
¹¹ 
.
¹¹  
Write
¹¹  %
(
¹¹% &
log
¹¹& )
)
¹¹) *
;
¹¹* +
}
ÁÁ 
m_swLogFile
ÂÂ 
.
ÂÂ 
Flush
ÂÂ !
(
ÂÂ! "
)
ÂÂ" #
;
ÂÂ# $
m_fsLogFile
ÃÃ 
.
ÃÃ 
Flush
ÃÃ !
(
ÃÃ! "
)
ÃÃ" #
;
ÃÃ# $
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
	Exception
ÅÅ 
ex
ÅÅ 
)
ÅÅ  
{
ÆÆ 
FDebug
ÇÇ 
.
ÇÇ 
throwException
ÇÇ %
(
ÇÇ% &
ex
ÇÇ& (
)
ÇÇ( )
;
ÇÇ) *
}
ÈÈ 
finally
ÉÉ 
{
ÊÊ 
}
ÌÌ 
}
ÍÍ 	
private
ÑÑ 
string
ÑÑ 
[
ÑÑ 
]
ÑÑ 
binToString
ÑÑ $
(
ÑÑ$ %
byte
ÒÒ 
[
ÒÒ 
]
ÒÒ 
byteData
ÒÒ 
)
ÓÓ 
{
ÔÔ 	
List
ÕÕ 
<
ÕÕ 
string
ÕÕ 
>
ÕÕ 
strData
ÕÕ  
=
ÕÕ! "
null
ÕÕ# '
;
ÕÕ' (
StringBuilder
ÖÖ 
sb
ÖÖ 
=
ÖÖ 
null
ÖÖ #
;
ÖÖ# $
int
×× 
index
×× 
=
×× 
$num
×× 
;
×× 
try
ÙÙ 
{
ÚÚ 
strData
ÛÛ 
=
ÛÛ 
new
ÛÛ 
List
ÛÛ "
<
ÛÛ" #
string
ÛÛ# )
>
ÛÛ) *
(
ÛÛ* +
)
ÛÛ+ ,
;
ÛÛ, -
strData
ÜÜ 
.
ÜÜ 
Add
ÜÜ 
(
ÜÜ 
$str
ÜÜ  
)
ÜÜ  !
;
ÜÜ! "
sb
İİ 
=
İİ 
new
İİ 
StringBuilder
İİ &
(
İİ& '
)
İİ' (
;
İİ( )
foreach
ŞŞ 
(
ŞŞ 
byte
ŞŞ 
b
ŞŞ 
in
ŞŞ  "
byteData
ŞŞ# +
)
ŞŞ+ ,
{
ßß 
sb
àà 
.
àà 
Append
àà 
(
àà 
b
àà 
.
àà  
ToString
àà  (
(
àà( )
$str
àà) -
)
àà- .
+
àà/ 0
$str
àà1 4
)
àà4 5
;
àà5 6
index
áá 
++
áá 
;
áá 
if
ââ 
(
ââ 
index
ââ 
%
ââ 
$num
ââ  "
==
ââ# %
$num
ââ& '
)
ââ' (
{
ãã 
strData
ää 
.
ää  
Add
ää  #
(
ää# $
sb
ää$ &
.
ää& '
ToString
ää' /
(
ää/ 0
)
ää0 1
)
ää1 2
;
ää2 3
sb
åå 
.
åå 
Clear
åå  
(
åå  !
)
åå! "
;
åå" #
}
ææ 
}
çç 
if
èè 
(
èè 
sb
èè 
.
èè 
Length
èè 
>
èè 
$num
èè  !
)
èè! "
{
éé 
strData
êê 
.
êê 
Add
êê 
(
êê  
sb
êê  "
.
êê" #
ToString
êê# +
(
êê+ ,
)
êê, -
)
êê- .
;
êê. /
}
ëë 
return
ïï 
strData
ïï 
.
ïï 
ToArray
ïï &
(
ïï& '
)
ïï' (
;
ïï( )
}
ğğ 
catch
ññ 
(
ññ 
	Exception
ññ 
ex
ññ 
)
ññ  
{
òò 
FDebug
óó 
.
óó 
throwException
óó %
(
óó% &
ex
óó& (
)
óó( )
;
óó) *
}
ôô 
finally
õõ 
{
öö 
strData
÷÷ 
=
÷÷ 
null
÷÷ 
;
÷÷ 
sb
øø 
=
øø 
null
øø 
;
øø 
}
ùù 
return
úú 
null
úú 
;
úú 
}
ûû 	
private
ÿÿ 
void
ÿÿ $
writeSecs1StateChanged
ÿÿ +
(
ÿÿ+ ,)
FSecs1StateChangedEventArgs
€€ '
fArgs
€€( -
)
 
{
‚‚ 	
StringBuilder
ƒƒ 
logData
ƒƒ !
=
ƒƒ" #
new
ƒƒ$ '
StringBuilder
ƒƒ( 5
(
ƒƒ5 6
)
ƒƒ6 7
;
ƒƒ7 8
try
…… 
{
†† 
logData
‡‡ 
.
‡‡ 

AppendLine
‡‡ "
(
‡‡" #
$str
‡‡# &
+
‡‡' (
DateTime
‡‡) 1
.
‡‡1 2
Now
‡‡2 5
.
‡‡5 6
ToString
‡‡6 >
(
‡‡> ?
$str
‡‡? X
)
‡‡X Y
+
‡‡Z [
$str
‡‡\ _
)
‡‡_ `
;
‡‡` a
logData
‹‹ 
.
‹‹ 
Append
‹‹ 
(
‹‹ 
fArgs
‹‹ $
.
‹‹$ %
fEventId
‹‹% -
.
‹‹- .
ToString
‹‹. 6
(
‹‹6 7
)
‹‹7 8
)
‹‹8 9
;
‹‹9 :
logData
ŒŒ 
.
ŒŒ 
Append
ŒŒ 
(
ŒŒ 
$str
ŒŒ +
+
ŒŒ, -
fArgs
ŒŒ. 3
.
ŒŒ3 4
fResult
ŒŒ4 ;
.
ŒŒ; <
ToString
ŒŒ< D
(
ŒŒD E
)
ŒŒE F
+
ŒŒG H
$str
ŒŒI L
)
ŒŒL M
;
ŒŒM N
if
 
(
 
fArgs
 
.
 
fResult
 !
!=
" $
FResultCode
% 0
.
0 1
Success
1 8
)
8 9
{
 
logData
 
.
 
Append
 "
(
" #
$str
# 5
+
6 7
fArgs
8 =
.
= >
errorMessage
> J
+
K L
$str
M P
)
P Q
;
Q R
}
 
logData
‘‘ 
.
‘‘ 

AppendLine
‘‘ "
(
‘‘" #
)
‘‘# $
;
‘‘$ %
logData
•• 
.
•• 

AppendLine
•• "
(
••" #
fArgs
••# (
.
••( )
fState
••) /
.
••/ 0
ToString
••0 8
(
••8 9
)
••9 :
+
••; <
$str
••= M
+
••N O
fArgs
••P U
.
••U V

serialPort
••V `
+
••a b
$str
••c n
+
••o p
fArgs
••q v
.
••v w
baud
••w {
.
••{ |
ToString••| „
(••„ …
)••… †
+••‡ ˆ
$str••‰ Œ
)••Œ 
;•• 
logData
™™ 
.
™™ 

AppendLine
™™ "
(
™™" #
)
™™# $
;
™™$ %
m_fLogQueue
šš 
.
šš 
enqueue
šš #
(
šš# $
logData
šš$ +
.
šš+ ,
ToString
šš, 4
(
šš4 5
)
šš5 6
)
šš6 7
;
šš7 8
}
›› 
catch
œœ 
(
œœ 
	Exception
œœ 
ex
œœ 
)
œœ  
{
 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
ŸŸ 
finally
   
{
¡¡ 
logData
¢¢ 
=
¢¢ 
null
¢¢ 
;
¢¢ 
}
££ 
}
¤¤ 	
private
¨¨ 
void
¨¨ #
writeSecs1ErrorRaised
¨¨ *
(
¨¨* +(
FSecs1ErrorRaisedEventArgs
©© &
fArgs
©©' ,
)
ªª 
{
«« 	
StringBuilder
¬¬ 
logData
¬¬ !
=
¬¬" #
new
¬¬$ '
StringBuilder
¬¬( 5
(
¬¬5 6
)
¬¬6 7
;
¬¬7 8
try
®® 
{
¯¯ 
logData
°° 
.
°° 

AppendLine
°° "
(
°°" #
$str
°°# &
+
°°' (
DateTime
°°) 1
.
°°1 2
Now
°°2 5
.
°°5 6
ToString
°°6 >
(
°°> ?
$str
°°? X
)
°°X Y
+
°°Z [
$str
°°\ _
)
°°_ `
;
°°` a
logData
´´ 
.
´´ 
Append
´´ 
(
´´ 
fArgs
´´ $
.
´´$ %
fEventId
´´% -
.
´´- .
ToString
´´. 6
(
´´6 7
)
´´7 8
)
´´8 9
;
´´9 :
logData
µµ 
.
µµ 
Append
µµ 
(
µµ 
$str
µµ 1
+
µµ2 3
fArgs
µµ4 9
.
µµ9 :
errorMessage
µµ: F
+
µµG H
$str
µµI L
)
µµL M
;
µµM N
logData
¶¶ 
.
¶¶ 

AppendLine
¶¶ "
(
¶¶" #
)
¶¶# $
;
¶¶$ %
logData
ºº 
.
ºº 

AppendLine
ºº "
(
ºº" #
)
ºº# $
;
ºº$ %
m_fLogQueue
»» 
.
»» 
enqueue
»» #
(
»»# $
logData
»»$ +
.
»»+ ,
ToString
»», 4
(
»»4 5
)
»»5 6
)
»»6 7
;
»»7 8
}
¼¼ 
catch
½½ 
(
½½ 
	Exception
½½ 
ex
½½ 
)
½½  
{
¾¾ 
FDebug
¿¿ 
.
¿¿ 
throwException
¿¿ %
(
¿¿% &
ex
¿¿& (
)
¿¿( )
;
¿¿) *
}
ÀÀ 
finally
ÁÁ 
{
ÂÂ 
logData
ÃÃ 
=
ÃÃ 
null
ÃÃ 
;
ÃÃ 
}
ÄÄ 
}
ÅÅ 	
private
ÉÉ 
void
ÉÉ %
writeSecs1TimeoutRaised
ÉÉ ,
(
ÉÉ, -*
FSecs1TimeoutRaisedEventArgs
ÊÊ (
fArgs
ÊÊ) .
)
ËË 
{
ÌÌ 	
StringBuilder
ÍÍ 
logData
ÍÍ !
=
ÍÍ" #
new
ÍÍ$ '
StringBuilder
ÍÍ( 5
(
ÍÍ5 6
)
ÍÍ6 7
;
ÍÍ7 8
try
ÏÏ 
{
ĞĞ 
logData
ÑÑ 
.
ÑÑ 

AppendLine
ÑÑ "
(
ÑÑ" #
$str
ÑÑ# &
+
ÑÑ' (
DateTime
ÑÑ) 1
.
ÑÑ1 2
Now
ÑÑ2 5
.
ÑÑ5 6
ToString
ÑÑ6 >
(
ÑÑ> ?
$str
ÑÑ? X
)
ÑÑX Y
+
ÑÑZ [
$str
ÑÑ\ _
)
ÑÑ_ `
;
ÑÑ` a
logData
ÕÕ 
.
ÕÕ 
Append
ÕÕ 
(
ÕÕ 
fArgs
ÕÕ $
.
ÕÕ$ %
fEventId
ÕÕ% -
.
ÕÕ- .
ToString
ÕÕ. 6
(
ÕÕ6 7
)
ÕÕ7 8
)
ÕÕ8 9
;
ÕÕ9 :
logData
ÖÖ 
.
ÖÖ 
Append
ÖÖ 
(
ÖÖ 
$str
ÖÖ 1
+
ÖÖ2 3
fArgs
ÖÖ4 9
.
ÖÖ9 :
errorMessage
ÖÖ: F
+
ÖÖG H
$str
ÖÖI L
)
ÖÖL M
;
ÖÖM N
logData
×× 
.
×× 

AppendLine
×× "
(
××" #
)
××# $
;
××$ %
logData
ÛÛ 
.
ÛÛ 

AppendLine
ÛÛ "
(
ÛÛ" #
fArgs
ÛÛ# (
.
ÛÛ( )
fTimeout
ÛÛ) 1
.
ÛÛ1 2
ToString
ÛÛ2 :
(
ÛÛ: ;
)
ÛÛ; <
)
ÛÛ< =
;
ÛÛ= >
logData
ßß 
.
ßß 

AppendLine
ßß "
(
ßß" #
)
ßß# $
;
ßß$ %
m_fLogQueue
àà 
.
àà 
enqueue
àà #
(
àà# $
logData
àà$ +
.
àà+ ,
ToString
àà, 4
(
àà4 5
)
àà5 6
)
àà6 7
;
àà7 8
}
áá 
catch
ââ 
(
ââ 
	Exception
ââ 
ex
ââ 
)
ââ  
{
ãã 
FDebug
ää 
.
ää 
throwException
ää %
(
ää% &
ex
ää& (
)
ää( )
;
ää) *
}
åå 
finally
ææ 
{
çç 
logData
èè 
=
èè 
null
èè 
;
èè 
}
éé 
}
êê 	
private
îî 
void
îî )
writeSecs1HandshakeReceived
îî 0
(
îî0 1.
 FSecs1HandshakeReceivedEventArgs
ïï ,
fArgs
ïï- 2
)
ğğ 
{
ññ 	
StringBuilder
òò 
logData
òò !
=
òò" #
new
òò$ '
StringBuilder
òò( 5
(
òò5 6
)
òò6 7
;
òò7 8
try
ôô 
{
õõ 
logData
öö 
.
öö 

AppendLine
öö "
(
öö" #
$str
öö# &
+
öö' (
DateTime
öö) 1
.
öö1 2
Now
öö2 5
.
öö5 6
ToString
öö6 >
(
öö> ?
$str
öö? X
)
ööX Y
+
ööZ [
$str
öö\ _
)
öö_ `
;
öö` a
logData
úú 
.
úú 
Append
úú 
(
úú 
fArgs
úú $
.
úú$ %
fEventId
úú% -
.
úú- .
ToString
úú. 6
(
úú6 7
)
úú7 8
)
úú8 9
;
úú9 :
logData
ûû 
.
ûû 
Append
ûû 
(
ûû 
$str
ûû +
+
ûû, -
fArgs
ûû. 3
.
ûû3 4
fResult
ûû4 ;
.
ûû; <
ToString
ûû< D
(
ûûD E
)
ûûE F
+
ûûG H
$str
ûûI L
)
ûûL M
;
ûûM N
if
üü 
(
üü 
fArgs
üü 
.
üü 
fResult
üü !
!=
üü" $
FResultCode
üü% 0
.
üü0 1
Success
üü1 8
)
üü8 9
{
ıı 
logData
şş 
.
şş 
Append
şş "
(
şş" #
$str
şş# 5
+
şş6 7
fArgs
şş8 =
.
şş= >
errorMessage
şş> J
+
şşK L
$str
şşM P
)
şşP Q
;
şşQ R
}
ÿÿ 
logData
€€ 
.
€€ 

AppendLine
€€ "
(
€€" #
)
€€# $
;
€€$ %
logData
„„ 
.
„„ 

AppendLine
„„ "
(
„„" #
fArgs
„„# (
.
„„( )
fHandshakeCode
„„) 7
.
„„7 8
ToString
„„8 @
(
„„@ A
)
„„A B
)
„„B C
;
„„C D
foreach
ˆˆ 
(
ˆˆ 
string
ˆˆ 
s
ˆˆ  !
in
ˆˆ" $
binToString
ˆˆ% 0
(
ˆˆ0 1
fArgs
ˆˆ1 6
.
ˆˆ6 7
getBinaryData
ˆˆ7 D
(
ˆˆD E
)
ˆˆE F
)
ˆˆF G
)
ˆˆG H
{
‰‰ 
logData
ŠŠ 
.
ŠŠ 

AppendLine
ŠŠ &
(
ŠŠ& '
s
ŠŠ' (
)
ŠŠ( )
;
ŠŠ) *
}
‹‹ 
logData
 
.
 

AppendLine
 "
(
" #
)
# $
;
$ %
m_fLogQueue
 
.
 
enqueue
 #
(
# $
logData
$ +
.
+ ,
ToString
, 4
(
4 5
)
5 6
)
6 7
;
7 8
}
‘‘ 
catch
’’ 
(
’’ 
	Exception
’’ 
ex
’’ 
)
’’  
{
““ 
FDebug
”” 
.
”” 
throwException
”” %
(
””% &
ex
””& (
)
””( )
;
””) *
}
•• 
finally
–– 
{
—— 
logData
˜˜ 
=
˜˜ 
null
˜˜ 
;
˜˜ 
}
™™ 
}
šš 	
private
 
void
 %
writeSecs1HandshakeSent
 ,
(
, -*
FSecs1HandshakeSentEventArgs
ŸŸ (
fArgs
ŸŸ) .
)
   
{
¡¡ 	
StringBuilder
¢¢ 
logData
¢¢ !
=
¢¢" #
new
¢¢$ '
StringBuilder
¢¢( 5
(
¢¢5 6
)
¢¢6 7
;
¢¢7 8
try
¤¤ 
{
¥¥ 
logData
¦¦ 
.
¦¦ 

AppendLine
¦¦ "
(
¦¦" #
$str
¦¦# &
+
¦¦' (
DateTime
¦¦) 1
.
¦¦1 2
Now
¦¦2 5
.
¦¦5 6
ToString
¦¦6 >
(
¦¦> ?
$str
¦¦? X
)
¦¦X Y
+
¦¦Z [
$str
¦¦\ _
)
¦¦_ `
;
¦¦` a
logData
ªª 
.
ªª 
Append
ªª 
(
ªª 
fArgs
ªª $
.
ªª$ %
fEventId
ªª% -
.
ªª- .
ToString
ªª. 6
(
ªª6 7
)
ªª7 8
)
ªª8 9
;
ªª9 :
logData
«« 
.
«« 
Append
«« 
(
«« 
$str
«« +
+
««, -
fArgs
««. 3
.
««3 4
fResult
««4 ;
.
««; <
ToString
««< D
(
««D E
)
««E F
+
««G H
$str
««I L
)
««L M
;
««M N
if
¬¬ 
(
¬¬ 
fArgs
¬¬ 
.
¬¬ 
fResult
¬¬ !
!=
¬¬" $
FResultCode
¬¬% 0
.
¬¬0 1
Success
¬¬1 8
)
¬¬8 9
{
­­ 
logData
®® 
.
®® 
Append
®® "
(
®®" #
$str
®®# 5
+
®®6 7
fArgs
®®8 =
.
®®= >
errorMessage
®®> J
+
®®K L
$str
®®M P
)
®®P Q
;
®®Q R
}
¯¯ 
logData
°° 
.
°° 

AppendLine
°° "
(
°°" #
)
°°# $
;
°°$ %
logData
´´ 
.
´´ 

AppendLine
´´ "
(
´´" #
fArgs
´´# (
.
´´( )
fHandshakeCode
´´) 7
.
´´7 8
ToString
´´8 @
(
´´@ A
)
´´A B
)
´´B C
;
´´C D
foreach
¸¸ 
(
¸¸ 
string
¸¸ 
s
¸¸  !
in
¸¸" $
binToString
¸¸% 0
(
¸¸0 1
fArgs
¸¸1 6
.
¸¸6 7
getBinaryData
¸¸7 D
(
¸¸D E
)
¸¸E F
)
¸¸F G
)
¸¸G H
{
¹¹ 
logData
ºº 
.
ºº 

AppendLine
ºº &
(
ºº& '
s
ºº' (
)
ºº( )
;
ºº) *
}
»» 
logData
¿¿ 
.
¿¿ 

AppendLine
¿¿ "
(
¿¿" #
)
¿¿# $
;
¿¿$ %
m_fLogQueue
ÀÀ 
.
ÀÀ 
enqueue
ÀÀ #
(
ÀÀ# $
logData
ÀÀ$ +
.
ÀÀ+ ,
ToString
ÀÀ, 4
(
ÀÀ4 5
)
ÀÀ5 6
)
ÀÀ6 7
;
ÀÀ7 8
}
ÁÁ 
catch
ÂÂ 
(
ÂÂ 
	Exception
ÂÂ 
ex
ÂÂ 
)
ÂÂ  
{
ÃÃ 
FDebug
ÄÄ 
.
ÄÄ 
throwException
ÄÄ %
(
ÄÄ% &
ex
ÄÄ& (
)
ÄÄ( )
;
ÄÄ) *
}
ÅÅ 
finally
ÆÆ 
{
ÇÇ 
logData
ÈÈ 
=
ÈÈ 
null
ÈÈ 
;
ÈÈ 
}
ÉÉ 
}
ÊÊ 	
private
ÎÎ 
void
ÎÎ %
writeSecs1BlockReceived
ÎÎ ,
(
ÎÎ, -*
FSecs1BlockReceivedEventArgs
ÏÏ (
fArgs
ÏÏ) .
)
ĞĞ 
{
ÑÑ 	
StringBuilder
ÒÒ 
logData
ÒÒ !
=
ÒÒ" #
new
ÒÒ$ '
StringBuilder
ÒÒ( 5
(
ÒÒ5 6
)
ÒÒ6 7
;
ÒÒ7 8
try
ÔÔ 
{
ÕÕ 
logData
ÖÖ 
.
ÖÖ 

AppendLine
ÖÖ "
(
ÖÖ" #
$str
ÖÖ# &
+
ÖÖ' (
DateTime
ÖÖ) 1
.
ÖÖ1 2
Now
ÖÖ2 5
.
ÖÖ5 6
ToString
ÖÖ6 >
(
ÖÖ> ?
$str
ÖÖ? X
)
ÖÖX Y
+
ÖÖZ [
$str
ÖÖ\ _
)
ÖÖ_ `
;
ÖÖ` a
logData
ÚÚ 
.
ÚÚ 
Append
ÚÚ 
(
ÚÚ 
fArgs
ÚÚ $
.
ÚÚ$ %
fEventId
ÚÚ% -
.
ÚÚ- .
ToString
ÚÚ. 6
(
ÚÚ6 7
)
ÚÚ7 8
)
ÚÚ8 9
;
ÚÚ9 :
logData
ÛÛ 
.
ÛÛ 
Append
ÛÛ 
(
ÛÛ 
$str
ÛÛ +
+
ÛÛ, -
fArgs
ÛÛ. 3
.
ÛÛ3 4
fResult
ÛÛ4 ;
.
ÛÛ; <
ToString
ÛÛ< D
(
ÛÛD E
)
ÛÛE F
+
ÛÛG H
$str
ÛÛI L
)
ÛÛL M
;
ÛÛM N
if
ÜÜ 
(
ÜÜ 
fArgs
ÜÜ 
.
ÜÜ 
fResult
ÜÜ !
!=
ÜÜ" $
FResultCode
ÜÜ% 0
.
ÜÜ0 1
Success
ÜÜ1 8
)
ÜÜ8 9
{
İİ 
logData
ŞŞ 
.
ŞŞ 
Append
ŞŞ "
(
ŞŞ" #
$str
ŞŞ# 5
+
ŞŞ6 7
fArgs
ŞŞ8 =
.
ŞŞ= >
errorMessage
ŞŞ> J
+
ŞŞK L
$str
ŞŞM P
)
ŞŞP Q
;
ŞŞQ R
}
ßß 
logData
àà 
.
àà 

AppendLine
àà "
(
àà" #
)
àà# $
;
àà$ %
logData
ää 
.
ää 
Append
ää 
(
ää 
$str
ää "
+
ää# $
fArgs
ää% *
.
ää* +

fSecsBlock
ää+ 5
.
ää5 6
stream
ää6 <
.
ää< =
ToString
ää= E
(
ääE F
)
ääF G
+
ääH I
$str
ääJ M
+
ääN O
fArgs
ääP U
.
ääU V

fSecsBlock
ääV `
.
ää` a
function
ääa i
.
ääi j
ToString
ääj r
(
äär s
)
ääs t
)
äät u
;
ääu v
if
åå 
(
åå 
fArgs
åå 
.
åå 

fSecsBlock
åå $
.
åå$ %
wbit
åå% )
)
åå) *
{
ææ 
logData
çç 
.
çç 
Append
çç "
(
çç" #
$str
çç# '
)
çç' (
;
çç( )
}
èè 
logData
éé 
.
éé 
Append
éé 
(
éé 
$str
éé ,
+
éé- .
fArgs
éé/ 4
.
éé4 5

fSecsBlock
éé5 ?
.
éé? @
blockNo
éé@ G
.
ééG H
ToString
ééH P
(
ééP Q
)
ééQ R
+
ééS T
$str
ééU `
+
ééa b
fArgs
ééc h
.
ééh i

fSecsBlock
ééi s
.
éés t
ebit
éét x
.
ééx y
ToStringééy 
(éé ‚
)éé‚ ƒ
+éé„ …
$stréé† ˜
+éé™ š
fArgséé›  
.éé  ¡

fSecsBlockéé¡ «
.éé« ¬
systemByteséé¬ ·
.éé· ¸
ToStringéé¸ À
(ééÀ Á
)ééÁ Â
+ééÃ Ä
$strééÅ Ò
+ééÓ Ô
fArgsééÕ Ú
.ééÚ Û

fSecsBlockééÛ å
.ééå æ
lengthééæ ì
.ééì í
ToStringééí õ
(ééõ ö
)ééö ÷
+ééø ù
$strééú ı
)ééı ş
;ééş ÿ
logData
êê 
.
êê 
Append
êê 
(
êê 
$str
êê .
+
êê/ 0
fArgs
êê1 6
.
êê6 7

fSecsBlock
êê7 A
.
êêA B
	sessionId
êêB K
.
êêK L
ToString
êêL T
(
êêT U
)
êêU V
+
êêW X
$str
êêY d
+
êêe f
fArgs
êêg l
.
êêl m

fSecsBlock
êêm w
.
êêw x
rbit
êêx |
.
êê| }
ToStringêê} …
(êê… †
)êê† ‡
+êêˆ ‰
$strêêŠ ™
+êêš ›
fArgsêêœ ¡
.êê¡ ¢

fSecsBlockêê¢ ¬
.êê¬ ­
checkSumêê­ µ
.êêµ ¶
ToStringêê¶ ¾
(êê¾ ¿
)êê¿ À
+êêÁ Â
$strêêÃ Æ
)êêÆ Ç
;êêÇ È
logData
ëë 
.
ëë 

AppendLine
ëë "
(
ëë" #
)
ëë# $
;
ëë$ %
foreach
ïï 
(
ïï 
string
ïï 
s
ïï  !
in
ïï" $
binToString
ïï% 0
(
ïï0 1
fArgs
ïï1 6
.
ïï6 7

fSecsBlock
ïï7 A
.
ïïA B
	blockData
ïïB K
)
ïïK L
)
ïïL M
{
ğğ 
logData
ññ 
.
ññ 

AppendLine
ññ &
(
ññ& '
s
ññ' (
)
ññ( )
;
ññ) *
}
òò 
logData
öö 
.
öö 

AppendLine
öö "
(
öö" #
)
öö# $
;
öö$ %
m_fLogQueue
÷÷ 
.
÷÷ 
enqueue
÷÷ #
(
÷÷# $
logData
÷÷$ +
.
÷÷+ ,
ToString
÷÷, 4
(
÷÷4 5
)
÷÷5 6
)
÷÷6 7
;
÷÷7 8
}
øø 
catch
ùù 
(
ùù 
	Exception
ùù 
ex
ùù 
)
ùù  
{
úú 
FDebug
ûû 
.
ûû 
throwException
ûû %
(
ûû% &
ex
ûû& (
)
ûû( )
;
ûû) *
}
üü 
finally
ıı 
{
şş 
logData
ÿÿ 
=
ÿÿ 
null
ÿÿ 
;
ÿÿ 
}
€€ 
}
 	
private
…… 
void
…… !
writeSecs1BlockSent
…… (
(
……( )&
FSecs1BlockSentEventArgs
†† $
fArgs
††% *
)
‡‡ 
{
ˆˆ 	
StringBuilder
‰‰ 
logData
‰‰ !
=
‰‰" #
new
‰‰$ '
StringBuilder
‰‰( 5
(
‰‰5 6
)
‰‰6 7
;
‰‰7 8
try
‹‹ 
{
ŒŒ 
logData
 
.
 

AppendLine
 "
(
" #
$str
# &
+
' (
DateTime
) 1
.
1 2
Now
2 5
.
5 6
ToString
6 >
(
> ?
$str
? X
)
X Y
+
Z [
$str
\ _
)
_ `
;
` a
logData
‘‘ 
.
‘‘ 
Append
‘‘ 
(
‘‘ 
fArgs
‘‘ $
.
‘‘$ %
fEventId
‘‘% -
.
‘‘- .
ToString
‘‘. 6
(
‘‘6 7
)
‘‘7 8
)
‘‘8 9
;
‘‘9 :
logData
’’ 
.
’’ 
Append
’’ 
(
’’ 
$str
’’ +
+
’’, -
fArgs
’’. 3
.
’’3 4
fResult
’’4 ;
.
’’; <
ToString
’’< D
(
’’D E
)
’’E F
+
’’G H
$str
’’I L
)
’’L M
;
’’M N
if
““ 
(
““ 
fArgs
““ 
.
““ 
fResult
““ !
!=
““" $
FResultCode
““% 0
.
““0 1
Success
““1 8
)
““8 9
{
”” 
logData
•• 
.
•• 
Append
•• "
(
••" #
$str
••# 5
+
••6 7
fArgs
••8 =
.
••= >
errorMessage
••> J
+
••K L
$str
••M P
)
••P Q
;
••Q R
}
–– 
logData
—— 
.
—— 

AppendLine
—— "
(
——" #
)
——# $
;
——$ %
logData
›› 
.
›› 
Append
›› 
(
›› 
$str
›› "
+
››# $
fArgs
››% *
.
››* +

fSecsBlock
››+ 5
.
››5 6
stream
››6 <
.
››< =
ToString
››= E
(
››E F
)
››F G
+
››H I
$str
››J M
+
››N O
fArgs
››P U
.
››U V

fSecsBlock
››V `
.
››` a
function
››a i
.
››i j
ToString
››j r
(
››r s
)
››s t
)
››t u
;
››u v
if
œœ 
(
œœ 
fArgs
œœ 
.
œœ 

fSecsBlock
œœ $
.
œœ$ %
wbit
œœ% )
)
œœ) *
{
 
logData
 
.
 
Append
 "
(
" #
$str
# '
)
' (
;
( )
}
ŸŸ 
logData
   
.
   
Append
   
(
   
$str
   ,
+
  - .
fArgs
  / 4
.
  4 5

fSecsBlock
  5 ?
.
  ? @
blockNo
  @ G
.
  G H
ToString
  H P
(
  P Q
)
  Q R
+
  S T
$str
  U `
+
  a b
fArgs
  c h
.
  h i

fSecsBlock
  i s
.
  s t
ebit
  t x
.
  x y
ToString  y 
(   ‚
)  ‚ ƒ
+  „ …
$str  † ˜
+  ™ š
fArgs  ›  
.    ¡

fSecsBlock  ¡ «
.  « ¬
systemBytes  ¬ ·
.  · ¸
ToString  ¸ À
(  À Á
)  Á Â
+  Ã Ä
$str  Å Ò
+  Ó Ô
fArgs  Õ Ú
.  Ú Û

fSecsBlock  Û å
.  å æ
length  æ ì
.  ì í
ToString  í õ
(  õ ö
)  ö ÷
+  ø ù
$str  ú ı
)  ı ş
;  ş ÿ
logData
¡¡ 
.
¡¡ 
Append
¡¡ 
(
¡¡ 
$str
¡¡ .
+
¡¡/ 0
fArgs
¡¡1 6
.
¡¡6 7

fSecsBlock
¡¡7 A
.
¡¡A B
	sessionId
¡¡B K
.
¡¡K L
ToString
¡¡L T
(
¡¡T U
)
¡¡U V
+
¡¡W X
$str
¡¡Y d
+
¡¡e f
fArgs
¡¡g l
.
¡¡l m

fSecsBlock
¡¡m w
.
¡¡w x
rbit
¡¡x |
.
¡¡| }
ToString¡¡} …
(¡¡… †
)¡¡† ‡
+¡¡ˆ ‰
$str¡¡Š ™
+¡¡š ›
fArgs¡¡œ ¡
.¡¡¡ ¢

fSecsBlock¡¡¢ ¬
.¡¡¬ ­
checkSum¡¡­ µ
.¡¡µ ¶
ToString¡¡¶ ¾
(¡¡¾ ¿
)¡¡¿ À
+¡¡Á Â
$str¡¡Ã Æ
)¡¡Æ Ç
;¡¡Ç È
logData
¢¢ 
.
¢¢ 

AppendLine
¢¢ "
(
¢¢" #
)
¢¢# $
;
¢¢$ %
foreach
¦¦ 
(
¦¦ 
string
¦¦ 
s
¦¦  !
in
¦¦" $
binToString
¦¦% 0
(
¦¦0 1
fArgs
¦¦1 6
.
¦¦6 7

fSecsBlock
¦¦7 A
.
¦¦A B
	blockData
¦¦B K
)
¦¦K L
)
¦¦L M
{
§§ 
logData
¨¨ 
.
¨¨ 

AppendLine
¨¨ &
(
¨¨& '
s
¨¨' (
)
¨¨( )
;
¨¨) *
}
©© 
logData
­­ 
.
­­ 

AppendLine
­­ "
(
­­" #
)
­­# $
;
­­$ %
m_fLogQueue
®® 
.
®® 
enqueue
®® #
(
®®# $
logData
®®$ +
.
®®+ ,
ToString
®®, 4
(
®®4 5
)
®®5 6
)
®®6 7
;
®®7 8
}
¯¯ 
catch
°° 
(
°° 
	Exception
°° 
ex
°° 
)
°°  
{
±± 
FDebug
²² 
.
²² 
throwException
²² %
(
²²% &
ex
²²& (
)
²²( )
;
²²) *
}
³³ 
finally
´´ 
{
µµ 
logData
¶¶ 
=
¶¶ 
null
¶¶ 
;
¶¶ 
}
·· 
}
¸¸ 	
private
¼¼ 
void
¼¼ .
 writeSecs1DataMessageReceivedSml
¼¼ 5
(
¼¼5 60
"FSecs1DataMessageReceivedEventArgs
½½ .
fArgs
½½/ 4
)
¾¾ 
{
¿¿ 	
StringBuilder
ÀÀ 
logData
ÀÀ !
=
ÀÀ" #
new
ÀÀ$ '
StringBuilder
ÀÀ( 5
(
ÀÀ5 6
)
ÀÀ6 7
;
ÀÀ7 8
try
ÂÂ 
{
ÃÃ 
logData
ÄÄ 
.
ÄÄ 

AppendLine
ÄÄ "
(
ÄÄ" #
$str
ÄÄ# &
+
ÄÄ' (
DateTime
ÄÄ) 1
.
ÄÄ1 2
Now
ÄÄ2 5
.
ÄÄ5 6
ToString
ÄÄ6 >
(
ÄÄ> ?
$str
ÄÄ? X
)
ÄÄX Y
+
ÄÄZ [
$str
ÄÄ\ _
)
ÄÄ_ `
;
ÄÄ` a
logData
ÈÈ 
.
ÈÈ 
Append
ÈÈ 
(
ÈÈ 
fArgs
ÈÈ $
.
ÈÈ$ %
fEventId
ÈÈ% -
.
ÈÈ- .
ToString
ÈÈ. 6
(
ÈÈ6 7
)
ÈÈ7 8
+
ÈÈ9 :
$str
ÈÈ; A
)
ÈÈA B
;
ÈÈB C
logData
ÉÉ 
.
ÉÉ 
Append
ÉÉ 
(
ÉÉ 
$str
ÉÉ +
+
ÉÉ, -
fArgs
ÉÉ. 3
.
ÉÉ3 4
fResult
ÉÉ4 ;
.
ÉÉ; <
ToString
ÉÉ< D
(
ÉÉD E
)
ÉÉE F
+
ÉÉG H
$str
ÉÉI L
)
ÉÉL M
;
ÉÉM N
if
ÊÊ 
(
ÊÊ 
fArgs
ÊÊ 
.
ÊÊ 
fResult
ÊÊ !
!=
ÊÊ" $
FResultCode
ÊÊ% 0
.
ÊÊ0 1
Success
ÊÊ1 8
)
ÊÊ8 9
{
ËË 
logData
ÌÌ 
.
ÌÌ 
Append
ÌÌ "
(
ÌÌ" #
$str
ÌÌ# 5
+
ÌÌ6 7
fArgs
ÌÌ8 =
.
ÌÌ= >
errorMessage
ÌÌ> J
+
ÌÌK L
$str
ÌÌM P
)
ÌÌP Q
;
ÌÌQ R
}
ÍÍ 
logData
ÎÎ 
.
ÎÎ 

AppendLine
ÎÎ "
(
ÎÎ" #
)
ÎÎ# $
;
ÎÎ$ %
logData
ÒÒ 
.
ÒÒ 
Append
ÒÒ 
(
ÒÒ 
$str
ÒÒ "
+
ÒÒ# $
fArgs
ÒÒ% *
.
ÒÒ* +
fSecsDataMessage
ÒÒ+ ;
.
ÒÒ; <
stream
ÒÒ< B
.
ÒÒB C
ToString
ÒÒC K
(
ÒÒK L
)
ÒÒL M
+
ÒÒN O
$str
ÒÒP S
+
ÒÒT U
fArgs
ÒÒV [
.
ÒÒ[ \
fSecsDataMessage
ÒÒ\ l
.
ÒÒl m
function
ÒÒm u
.
ÒÒu v
ToString
ÒÒv ~
(
ÒÒ~ 
)ÒÒ €
)ÒÒ€ 
;ÒÒ ‚
if
ÓÓ 
(
ÓÓ 
fArgs
ÓÓ 
.
ÓÓ 
fSecsDataMessage
ÓÓ *
.
ÓÓ* +
wbit
ÓÓ+ /
)
ÓÓ/ 0
{
ÔÔ 
logData
ÕÕ 
.
ÕÕ 
Append
ÕÕ "
(
ÕÕ" #
$str
ÕÕ# '
)
ÕÕ' (
;
ÕÕ( )
}
ÖÖ 
logData
×× 
.
×× 
Append
×× 
(
×× 
$str
×× 0
+
××1 2
fArgs
××3 8
.
××8 9
fSecsDataMessage
××9 I
.
××I J
systemBytes
××J U
.
××U V
ToString
××V ^
(
××^ _
)
××_ `
+
××a b
$str
××c p
+
××q r
fArgs
××s x
.
××x y
fSecsDataMessage××y ‰
.××‰ Š
length××Š 
.×× ‘
ToString××‘ ™
(××™ š
)××š ›
+××œ 
$str×× ®
+××¯ °
fArgs××± ¶
.××¶ · 
fSecsDataMessage××· Ç
.××Ç È
	sessionId××È Ñ
.××Ñ Ò
ToString××Ò Ú
(××Ú Û
)××Û Ü
+××İ Ş
$str××ß â
)××â ã
;××ã ä
logData
ØØ 
.
ØØ 

AppendLine
ØØ "
(
ØØ" #
)
ØØ# $
;
ØØ$ %
if
ÜÜ 
(
ÜÜ 
fArgs
ÜÜ 
.
ÜÜ 
fSecsDataMessage
ÜÜ *
.
ÜÜ* +
body
ÜÜ+ /
.
ÜÜ/ 0
Length
ÜÜ0 6
>
ÜÜ7 8
$num
ÜÜ9 :
)
ÜÜ: ;
{
İİ 
logData
ŞŞ 
.
ŞŞ 

AppendLine
ŞŞ &
(
ŞŞ& '
FSecsConverter
ŞŞ' 5
.
ŞŞ5 6
convertBinToSml
ŞŞ6 E
(
ŞŞE F
fArgs
ŞŞF K
.
ŞŞK L
fSecsDataMessage
ŞŞL \
.
ŞŞ\ ]
body
ŞŞ] a
)
ŞŞa b
)
ŞŞb c
;
ŞŞc d
}
ßß 
logData
ãã 
.
ãã 

AppendLine
ãã "
(
ãã" #
)
ãã# $
;
ãã$ %
m_fLogQueue
ää 
.
ää 
enqueue
ää #
(
ää# $
logData
ää$ +
.
ää+ ,
ToString
ää, 4
(
ää4 5
)
ää5 6
)
ää6 7
;
ää7 8
}
åå 
catch
ææ 
(
ææ 
	Exception
ææ 
ex
ææ 
)
ææ  
{
çç 
FDebug
èè 
.
èè 
throwException
èè %
(
èè% &
ex
èè& (
)
èè( )
;
èè) *
}
éé 
finally
êê 
{
ëë 
logData
ìì 
=
ìì 
null
ìì 
;
ìì 
}
íí 
}
îî 	
private
òò 
void
òò *
writeSecs1DataMessageSentSml
òò 1
(
òò1 2,
FSecs1DataMessageSentEventArgs
óó *
fArgs
óó+ 0
)
ôô 
{
õõ 	
StringBuilder
öö 
logData
öö !
=
öö" #
new
öö$ '
StringBuilder
öö( 5
(
öö5 6
)
öö6 7
;
öö7 8
try
øø 
{
ùù 
logData
úú 
.
úú 

AppendLine
úú "
(
úú" #
$str
úú# &
+
úú' (
DateTime
úú) 1
.
úú1 2
Now
úú2 5
.
úú5 6
ToString
úú6 >
(
úú> ?
$str
úú? X
)
úúX Y
+
úúZ [
$str
úú\ _
)
úú_ `
;
úú` a
logData
şş 
.
şş 
Append
şş 
(
şş 
fArgs
şş $
.
şş$ %
fEventId
şş% -
.
şş- .
ToString
şş. 6
(
şş6 7
)
şş7 8
+
şş9 :
$str
şş; A
)
şşA B
;
şşB C
logData
ÿÿ 
.
ÿÿ 
Append
ÿÿ 
(
ÿÿ 
$str
ÿÿ +
+
ÿÿ, -
fArgs
ÿÿ. 3
.
ÿÿ3 4
fResult
ÿÿ4 ;
.
ÿÿ; <
ToString
ÿÿ< D
(
ÿÿD E
)
ÿÿE F
+
ÿÿG H
$str
ÿÿI L
)
ÿÿL M
;
ÿÿM N
if
€€ 
(
€€ 
fArgs
€€ 
.
€€ 
fResult
€€ !
!=
€€" $
FResultCode
€€% 0
.
€€0 1
Success
€€1 8
)
€€8 9
{
 
logData
‚‚ 
.
‚‚ 
Append
‚‚ "
(
‚‚" #
$str
‚‚# 5
+
‚‚6 7
fArgs
‚‚8 =
.
‚‚= >
errorMessage
‚‚> J
+
‚‚K L
$str
‚‚M P
)
‚‚P Q
;
‚‚Q R
}
ƒƒ 
logData
„„ 
.
„„ 

AppendLine
„„ "
(
„„" #
)
„„# $
;
„„$ %
logData
ˆˆ 
.
ˆˆ 
Append
ˆˆ 
(
ˆˆ 
$str
ˆˆ "
+
ˆˆ# $
fArgs
ˆˆ% *
.
ˆˆ* +
fSecsDataMessage
ˆˆ+ ;
.
ˆˆ; <
stream
ˆˆ< B
.
ˆˆB C
ToString
ˆˆC K
(
ˆˆK L
)
ˆˆL M
+
ˆˆN O
$str
ˆˆP S
+
ˆˆT U
fArgs
ˆˆV [
.
ˆˆ[ \
fSecsDataMessage
ˆˆ\ l
.
ˆˆl m
function
ˆˆm u
.
ˆˆu v
ToString
ˆˆv ~
(
ˆˆ~ 
)ˆˆ €
)ˆˆ€ 
;ˆˆ ‚
if
‰‰ 
(
‰‰ 
fArgs
‰‰ 
.
‰‰ 
fSecsDataMessage
‰‰ *
.
‰‰* +
wbit
‰‰+ /
)
‰‰/ 0
{
ŠŠ 
logData
‹‹ 
.
‹‹ 
Append
‹‹ "
(
‹‹" #
$str
‹‹# '
)
‹‹' (
;
‹‹( )
}
ŒŒ 
logData
 
.
 
Append
 
(
 
$str
 0
+
1 2
fArgs
3 8
.
8 9
fSecsDataMessage
9 I
.
I J
systemBytes
J U
.
U V
ToString
V ^
(
^ _
)
_ `
+
a b
$str
c p
+
q r
fArgs
s x
.
x y
fSecsDataMessagey ‰
.‰ Š
lengthŠ 
. ‘
ToString‘ ™
(™ š
)š ›
+œ 
$str ®
+¯ °
fArgs± ¶
.¶ · 
fSecsDataMessage· Ç
.Ç È
	sessionIdÈ Ñ
.Ñ Ò
ToStringÒ Ú
(Ú Û
)Û Ü
+İ Ş
$strß â
)â ã
;ã ä
logData
 
.
 

AppendLine
 "
(
" #
)
# $
;
$ %
if
’’ 
(
’’ 
fArgs
’’ 
.
’’ 
fSecsDataMessage
’’ *
.
’’* +
body
’’+ /
.
’’/ 0
Length
’’0 6
>
’’7 8
$num
’’9 :
)
’’: ;
{
““ 
logData
”” 
.
”” 

AppendLine
”” &
(
””& '
FSecsConverter
””' 5
.
””5 6
convertBinToSml
””6 E
(
””E F
fArgs
””F K
.
””K L
fSecsDataMessage
””L \
.
””\ ]
body
””] a
)
””a b
)
””b c
;
””c d
}
•• 
logData
™™ 
.
™™ 

AppendLine
™™ "
(
™™" #
)
™™# $
;
™™$ %
m_fLogQueue
šš 
.
šš 
enqueue
šš #
(
šš# $
logData
šš$ +
.
šš+ ,
ToString
šš, 4
(
šš4 5
)
šš5 6
)
šš6 7
;
šš7 8
}
›› 
catch
œœ 
(
œœ 
	Exception
œœ 
ex
œœ 
)
œœ  
{
 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
ŸŸ 
finally
   
{
¡¡ 
logData
¢¢ 
=
¢¢ 
null
¢¢ 
;
¢¢ 
}
££ 
}
¤¤ 	
private
¨¨ 
void
¨¨ #
writeHsmsStateChanged
¨¨ *
(
¨¨* +(
FHsmsStateChangedEventArgs
©© &
fArgs
©©' ,
)
ªª 
{
«« 	
StringBuilder
¬¬ 
logData
¬¬ !
=
¬¬" #
new
¬¬$ '
StringBuilder
¬¬( 5
(
¬¬5 6
)
¬¬6 7
;
¬¬7 8
try
®® 
{
¯¯ 
logData
°° 
.
°° 

AppendLine
°° "
(
°°" #
$str
°°# &
+
°°' (
DateTime
°°) 1
.
°°1 2
Now
°°2 5
.
°°5 6
ToString
°°6 >
(
°°> ?
$str
°°? X
)
°°X Y
+
°°Z [
$str
°°\ _
)
°°_ `
;
°°` a
logData
´´ 
.
´´ 
Append
´´ 
(
´´ 
fArgs
´´ $
.
´´$ %
fEventId
´´% -
.
´´- .
ToString
´´. 6
(
´´6 7
)
´´7 8
)
´´8 9
;
´´9 :
logData
µµ 
.
µµ 
Append
µµ 
(
µµ 
$str
µµ +
+
µµ, -
fArgs
µµ. 3
.
µµ3 4
fResult
µµ4 ;
.
µµ; <
ToString
µµ< D
(
µµD E
)
µµE F
+
µµG H
$str
µµI L
)
µµL M
;
µµM N
if
¶¶ 
(
¶¶ 
fArgs
¶¶ 
.
¶¶ 
fResult
¶¶ !
!=
¶¶" $
FResultCode
¶¶% 0
.
¶¶0 1
Success
¶¶1 8
)
¶¶8 9
{
·· 
logData
¸¸ 
.
¸¸ 
Append
¸¸ "
(
¸¸" #
$str
¸¸# 5
+
¸¸6 7
fArgs
¸¸8 =
.
¸¸= >
errorMessage
¸¸> J
+
¸¸K L
$str
¸¸M P
)
¸¸P Q
;
¸¸Q R
}
¹¹ 
logData
ºº 
.
ºº 

AppendLine
ºº "
(
ºº" #
)
ºº# $
;
ºº$ %
logData
¾¾ 
.
¾¾ 

AppendLine
¾¾ "
(
¾¾" #
fArgs
¾¾# (
.
¾¾( )
fState
¾¾) /
.
¾¾/ 0
ToString
¾¾0 8
(
¾¾8 9
)
¾¾9 :
+
¾¾; <
$str
¾¾= N
+
¾¾O P
fArgs
¾¾Q V
.
¾¾V W
fConnectMode
¾¾W c
+
¾¾d e
$str
¾¾f t
+
¾¾u v
fArgs
¾¾w |
.
¾¾| }
localIp¾¾} „
+¾¾… †
$str¾¾‡ —
+¾¾˜ ™
fArgs¾¾š Ÿ
.¾¾Ÿ  
	localPort¾¾  ©
.¾¾© ª
ToString¾¾ª ²
(¾¾² ³
)¾¾³ ´
+¾¾µ ¶
$str¾¾· Æ
+¾¾Ç È
fArgs¾¾É Î
.¾¾Î Ï
remoteIp¾¾Ï ×
+¾¾Ø Ù
$str¾¾Ú ë
+¾¾ì í
fArgs¾¾î ó
.¾¾ó ô

remotePort¾¾ô ş
.¾¾ş ÿ
ToString¾¾ÿ ‡
(¾¾‡ ˆ
)¾¾ˆ ‰
+¾¾Š ‹
$str¾¾‹ 
)¾¾ 
;¾¾ 
logData
ÂÂ 
.
ÂÂ 

AppendLine
ÂÂ "
(
ÂÂ" #
)
ÂÂ# $
;
ÂÂ$ %
m_fLogQueue
ÃÃ 
.
ÃÃ 
enqueue
ÃÃ #
(
ÃÃ# $
logData
ÃÃ$ +
.
ÃÃ+ ,
ToString
ÃÃ, 4
(
ÃÃ4 5
)
ÃÃ5 6
)
ÃÃ6 7
;
ÃÃ7 8
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
	Exception
ÅÅ 
ex
ÅÅ 
)
ÅÅ  
{
ÆÆ 
FDebug
ÇÇ 
.
ÇÇ 
throwException
ÇÇ %
(
ÇÇ% &
ex
ÇÇ& (
)
ÇÇ( )
;
ÇÇ) *
}
ÈÈ 
finally
ÉÉ 
{
ÊÊ 
logData
ËË 
=
ËË 
null
ËË 
;
ËË 
}
ÌÌ 
}
ÍÍ 	
private
ÑÑ 
void
ÑÑ "
writeHsmsErrorRaised
ÑÑ )
(
ÑÑ) *'
FHsmsErrorRaisedEventArgs
ÒÒ %
fArgs
ÒÒ& +
)
ÓÓ 
{
ÔÔ 	
StringBuilder
ÕÕ 
logData
ÕÕ !
=
ÕÕ" #
new
ÕÕ$ '
StringBuilder
ÕÕ( 5
(
ÕÕ5 6
)
ÕÕ6 7
;
ÕÕ7 8
try
×× 
{
ØØ 
logData
ÙÙ 
.
ÙÙ 

AppendLine
ÙÙ "
(
ÙÙ" #
$str
ÙÙ# &
+
ÙÙ' (
DateTime
ÙÙ) 1
.
ÙÙ1 2
Now
ÙÙ2 5
.
ÙÙ5 6
ToString
ÙÙ6 >
(
ÙÙ> ?
$str
ÙÙ? X
)
ÙÙX Y
+
ÙÙZ [
$str
ÙÙ\ _
)
ÙÙ_ `
;
ÙÙ` a
logData
İİ 
.
İİ 
Append
İİ 
(
İİ 
fArgs
İİ $
.
İİ$ %
fEventId
İİ% -
.
İİ- .
ToString
İİ. 6
(
İİ6 7
)
İİ7 8
)
İİ8 9
;
İİ9 :
logData
ŞŞ 
.
ŞŞ 
Append
ŞŞ 
(
ŞŞ 
$str
ŞŞ 1
+
ŞŞ2 3
fArgs
ŞŞ4 9
.
ŞŞ9 :
errorMessage
ŞŞ: F
+
ŞŞG H
$str
ŞŞI L
)
ŞŞL M
;
ŞŞM N
logData
ßß 
.
ßß 

AppendLine
ßß "
(
ßß" #
)
ßß# $
;
ßß$ %
logData
ãã 
.
ãã 

AppendLine
ãã "
(
ãã" #
)
ãã# $
;
ãã$ %
m_fLogQueue
ää 
.
ää 
enqueue
ää #
(
ää# $
logData
ää$ +
.
ää+ ,
ToString
ää, 4
(
ää4 5
)
ää5 6
)
ää6 7
;
ää7 8
}
åå 
catch
ææ 
(
ææ 
	Exception
ææ 
ex
ææ 
)
ææ  
{
çç 
FDebug
èè 
.
èè 
throwException
èè %
(
èè% &
ex
èè& (
)
èè( )
;
èè) *
}
éé 
finally
êê 
{
ëë 
logData
ìì 
=
ìì 
null
ìì 
;
ìì 
}
íí 
}
îî 	
private
òò 
void
òò $
writeHsmsTimeoutRaised
òò +
(
òò+ ,)
FHsmsTimeoutRaisedEventArgs
óó '
fArgs
óó( -
)
ôô 
{
õõ 	
StringBuilder
öö 
logData
öö !
=
öö" #
new
öö$ '
StringBuilder
öö( 5
(
öö5 6
)
öö6 7
;
öö7 8
try
øø 
{
ùù 
logData
úú 
.
úú 

AppendLine
úú "
(
úú" #
$str
úú# &
+
úú' (
DateTime
úú) 1
.
úú1 2
Now
úú2 5
.
úú5 6
ToString
úú6 >
(
úú> ?
$str
úú? X
)
úúX Y
+
úúZ [
$str
úú\ _
)
úú_ `
;
úú` a
logData
şş 
.
şş 
Append
şş 
(
şş 
fArgs
şş $
.
şş$ %
fEventId
şş% -
.
şş- .
ToString
şş. 6
(
şş6 7
)
şş7 8
)
şş8 9
;
şş9 :
logData
ÿÿ 
.
ÿÿ 
Append
ÿÿ 
(
ÿÿ 
$str
ÿÿ 1
+
ÿÿ2 3
fArgs
ÿÿ4 9
.
ÿÿ9 :
errorMessage
ÿÿ: F
+
ÿÿG H
$str
ÿÿI L
)
ÿÿL M
;
ÿÿM N
logData
€€ 
.
€€ 

AppendLine
€€ "
(
€€" #
)
€€# $
;
€€$ %
logData
„„ 
.
„„ 

AppendLine
„„ "
(
„„" #
fArgs
„„# (
.
„„( )
fTimeout
„„) 1
.
„„1 2
ToString
„„2 :
(
„„: ;
)
„„; <
)
„„< =
;
„„= >
logData
ˆˆ 
.
ˆˆ 

AppendLine
ˆˆ "
(
ˆˆ" #
)
ˆˆ# $
;
ˆˆ$ %
m_fLogQueue
‰‰ 
.
‰‰ 
enqueue
‰‰ #
(
‰‰# $
logData
‰‰$ +
.
‰‰+ ,
ToString
‰‰, 4
(
‰‰4 5
)
‰‰5 6
)
‰‰6 7
;
‰‰7 8
}
ŠŠ 
catch
‹‹ 
(
‹‹ 
	Exception
‹‹ 
ex
‹‹ 
)
‹‹  
{
ŒŒ 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
 
{
 
logData
‘‘ 
=
‘‘ 
null
‘‘ 
;
‘‘ 
}
’’ 
}
““ 	
private
—— 
void
—— -
writeHsmsControlMessageReceived
—— 4
(
——4 52
$FHsmsControlMessageReceivedEventArgs
˜˜ 0
fArgs
˜˜1 6
)
™™ 
{
šš 	
StringBuilder
›› 
logData
›› !
=
››" #
new
››$ '
StringBuilder
››( 5
(
››5 6
)
››6 7
;
››7 8
try
 
{
 
logData
ŸŸ 
.
ŸŸ 

AppendLine
ŸŸ "
(
ŸŸ" #
$str
ŸŸ# &
+
ŸŸ' (
DateTime
ŸŸ) 1
.
ŸŸ1 2
Now
ŸŸ2 5
.
ŸŸ5 6
ToString
ŸŸ6 >
(
ŸŸ> ?
$str
ŸŸ? X
)
ŸŸX Y
+
ŸŸZ [
$str
ŸŸ\ _
)
ŸŸ_ `
;
ŸŸ` a
logData
££ 
.
££ 
Append
££ 
(
££ 
fArgs
££ $
.
££$ %
fEventId
££% -
.
££- .
ToString
££. 6
(
££6 7
)
££7 8
)
££8 9
;
££9 :
logData
¤¤ 
.
¤¤ 
Append
¤¤ 
(
¤¤ 
$str
¤¤ +
+
¤¤, -
fArgs
¤¤. 3
.
¤¤3 4
fResult
¤¤4 ;
.
¤¤; <
ToString
¤¤< D
(
¤¤D E
)
¤¤E F
+
¤¤G H
$str
¤¤I L
)
¤¤L M
;
¤¤M N
if
¥¥ 
(
¥¥ 
fArgs
¥¥ 
.
¥¥ 
fResult
¥¥ !
!=
¥¥" $
FResultCode
¥¥% 0
.
¥¥0 1
Success
¥¥1 8
)
¥¥8 9
{
¦¦ 
logData
§§ 
.
§§ 
Append
§§ "
(
§§" #
$str
§§# 5
+
§§6 7
fArgs
§§8 =
.
§§= >
errorMessage
§§> J
+
§§K L
$str
§§M P
)
§§P Q
;
§§Q R
}
¨¨ 
logData
©© 
.
©© 

AppendLine
©© "
(
©©" #
)
©©# $
;
©©$ %
logData
­­ 
.
­­ 
Append
­­ 
(
­­ 
fArgs
­­ $
.
­­$ %!
fSecsControlMessage
­­% 8
.
­­8 9
fType
­­9 >
.
­­> ?
ToString
­­? G
(
­­G H
)
­­H I
)
­­I J
;
­­J K
logData
®® 
.
®® 
Append
®® 
(
®® 
$str
®® *
+
®®+ ,
fArgs
®®- 2
.
®®2 3!
fSecsControlMessage
®®3 F
.
®®F G
byte2
®®G L
.
®®L M
ToString
®®M U
(
®®U V
)
®®V W
+
®®X Y
$str
®®Z f
+
®®g h
fArgs
®®i n
.
®®n o"
fSecsControlMessage®®o ‚
.®®‚ ƒ
byte3®®ƒ ˆ
.®®ˆ ‰
ToString®®‰ ‘
(®®‘ ’
)®®’ “
+®®” •
$str®®– ¢
+®®£ ¤
fArgs®®¥ ª
.®®ª «#
fSecsControlMessage®®« ¾
.®®¾ ¿
ptype®®¿ Ä
.®®Ä Å
ToString®®Å Í
(®®Í Î
)®®Î Ï
+®®Ğ Ñ
$str®®Ò Ş
+®®ß à
fArgs®®á æ
.®®æ ç#
fSecsControlMessage®®ç ú
.®®ú û
stype®®û €
.®®€ 
ToString®® ‰
(®®‰ Š
)®®Š ‹
+®®Œ 
$str®®  
+®®¡ ¢
fArgs®®£ ¨
.®®¨ ©#
fSecsControlMessage®®© ¼
.®®¼ ½
systemBytes®®½ È
.®®È É
ToString®®É Ñ
(®®Ñ Ò
)®®Ò Ó
+®®Ô Õ
$str®®Ö Ù
)®®Ù Ú
;®®Ú Û
logData
¯¯ 
.
¯¯ 
Append
¯¯ 
(
¯¯ 
$str
¯¯ +
+
¯¯, -
fArgs
¯¯. 3
.
¯¯3 4!
fSecsControlMessage
¯¯4 G
.
¯¯G H
length
¯¯H N
.
¯¯N O
ToString
¯¯O W
(
¯¯W X
)
¯¯X Y
+
¯¯Z [
$str
¯¯[ k
+
¯¯l m
fArgs
¯¯n s
.
¯¯s t"
fSecsControlMessage¯¯t ‡
.¯¯‡ ˆ
	sessionId¯¯ˆ ‘
.¯¯‘ ’
ToString¯¯’ š
(¯¯š ›
)¯¯› œ
+¯¯ 
$str¯¯Ÿ ¢
)¯¯¢ £
;¯¯£ ¤
if
°° 
(
°° 
fArgs
°° 
.
°° !
fSecsControlMessage
°° -
.
°°- .
reason
°°. 4
!=
°°5 7
string
°°8 >
.
°°> ?
Empty
°°? D
)
°°D E
{
±± 
logData
²² 
.
²² 
Append
²² "
(
²²" #
$str
²²# /
+
²²0 1
fArgs
²²2 7
.
²²7 8!
fSecsControlMessage
²²8 K
.
²²K L
reason
²²L R
+
²²S T
$str
²²U X
)
²²X Y
;
²²Y Z
}
³³ 
logData
´´ 
.
´´ 

AppendLine
´´ "
(
´´" #
)
´´# $
;
´´$ %
foreach
¸¸ 
(
¸¸ 
string
¸¸ 
s
¸¸  !
in
¸¸" $
binToString
¸¸% 0
(
¸¸0 1
fArgs
¸¸1 6
.
¸¸6 7!
fSecsControlMessage
¸¸7 J
.
¸¸J K
getBinaryData
¸¸K X
(
¸¸X Y
)
¸¸Y Z
)
¸¸Z [
)
¸¸[ \
{
¹¹ 
logData
ºº 
.
ºº 

AppendLine
ºº &
(
ºº& '
s
ºº' (
)
ºº( )
;
ºº) *
}
»» 
logData
¿¿ 
.
¿¿ 

AppendLine
¿¿ "
(
¿¿" #
)
¿¿# $
;
¿¿$ %
m_fLogQueue
ÀÀ 
.
ÀÀ 
enqueue
ÀÀ #
(
ÀÀ# $
logData
ÀÀ$ +
.
ÀÀ+ ,
ToString
ÀÀ, 4
(
ÀÀ4 5
)
ÀÀ5 6
)
ÀÀ6 7
;
ÀÀ7 8
}
ÁÁ 
catch
ÂÂ 
(
ÂÂ 
	Exception
ÂÂ 
ex
ÂÂ 
)
ÂÂ  
{
ÃÃ 
FDebug
ÄÄ 
.
ÄÄ 
throwException
ÄÄ %
(
ÄÄ% &
ex
ÄÄ& (
)
ÄÄ( )
;
ÄÄ) *
}
ÅÅ 
finally
ÆÆ 
{
ÇÇ 
logData
ÈÈ 
=
ÈÈ 
null
ÈÈ 
;
ÈÈ 
}
ÉÉ 
}
ÊÊ 	
private
ÎÎ 
void
ÎÎ )
writeHsmsControlMessageSent
ÎÎ 0
(
ÎÎ0 1.
 FHsmsControlMessageSentEventArgs
ÏÏ ,
fArgs
ÏÏ- 2
)
ĞĞ 
{
ÑÑ 	
StringBuilder
ÒÒ 
logData
ÒÒ !
=
ÒÒ" #
new
ÒÒ$ '
StringBuilder
ÒÒ( 5
(
ÒÒ5 6
)
ÒÒ6 7
;
ÒÒ7 8
try
ÔÔ 
{
ÕÕ 
logData
ÖÖ 
.
ÖÖ 

AppendLine
ÖÖ "
(
ÖÖ" #
$str
ÖÖ# &
+
ÖÖ' (
DateTime
ÖÖ) 1
.
ÖÖ1 2
Now
ÖÖ2 5
.
ÖÖ5 6
ToString
ÖÖ6 >
(
ÖÖ> ?
$str
ÖÖ? X
)
ÖÖX Y
+
ÖÖZ [
$str
ÖÖ\ _
)
ÖÖ_ `
;
ÖÖ` a
logData
ÚÚ 
.
ÚÚ 
Append
ÚÚ 
(
ÚÚ 
fArgs
ÚÚ $
.
ÚÚ$ %
fEventId
ÚÚ% -
.
ÚÚ- .
ToString
ÚÚ. 6
(
ÚÚ6 7
)
ÚÚ7 8
)
ÚÚ8 9
;
ÚÚ9 :
logData
ÛÛ 
.
ÛÛ 
Append
ÛÛ 
(
ÛÛ 
$str
ÛÛ +
+
ÛÛ, -
fArgs
ÛÛ. 3
.
ÛÛ3 4
fResult
ÛÛ4 ;
.
ÛÛ; <
ToString
ÛÛ< D
(
ÛÛD E
)
ÛÛE F
+
ÛÛG H
$str
ÛÛI L
)
ÛÛL M
;
ÛÛM N
if
ÜÜ 
(
ÜÜ 
fArgs
ÜÜ 
.
ÜÜ 
fResult
ÜÜ !
!=
ÜÜ" $
FResultCode
ÜÜ% 0
.
ÜÜ0 1
Success
ÜÜ1 8
)
ÜÜ8 9
{
İİ 
logData
ŞŞ 
.
ŞŞ 
Append
ŞŞ "
(
ŞŞ" #
$str
ŞŞ# 5
+
ŞŞ6 7
fArgs
ŞŞ8 =
.
ŞŞ= >
errorMessage
ŞŞ> J
+
ŞŞK L
$str
ŞŞM P
)
ŞŞP Q
;
ŞŞQ R
}
ßß 
logData
àà 
.
àà 

AppendLine
àà "
(
àà" #
)
àà# $
;
àà$ %
logData
ää 
.
ää 
Append
ää 
(
ää 
fArgs
ää $
.
ää$ %!
fSecsControlMessage
ää% 8
.
ää8 9
fType
ää9 >
.
ää> ?
ToString
ää? G
(
ääG H
)
ääH I
)
ääI J
;
ääJ K
logData
åå 
.
åå 
Append
åå 
(
åå 
$str
åå *
+
åå+ ,
fArgs
åå- 2
.
åå2 3!
fSecsControlMessage
åå3 F
.
ååF G
byte2
ååG L
.
ååL M
ToString
ååM U
(
ååU V
)
ååV W
+
ååX Y
$str
ååZ f
+
ååg h
fArgs
ååi n
.
åån o"
fSecsControlMessageååo ‚
.åå‚ ƒ
byte3ååƒ ˆ
.ååˆ ‰
ToStringåå‰ ‘
(åå‘ ’
)åå’ “
+åå” •
$stråå– ¢
+åå£ ¤
fArgsåå¥ ª
.ååª «#
fSecsControlMessageåå« ¾
.åå¾ ¿
ptypeåå¿ Ä
.ååÄ Å
ToStringååÅ Í
(ååÍ Î
)ååÎ Ï
+ååĞ Ñ
$strååÒ Ş
+ååß à
fArgsååá æ
.ååæ ç#
fSecsControlMessageååç ú
.ååú û
stypeååû €
.åå€ 
ToStringåå ‰
(åå‰ Š
)ååŠ ‹
+ååŒ 
$stråå  
+åå¡ ¢
fArgsåå£ ¨
.åå¨ ©#
fSecsControlMessageåå© ¼
.åå¼ ½
systemBytesåå½ È
.ååÈ É
ToStringååÉ Ñ
(ååÑ Ò
)ååÒ Ó
+ååÔ Õ
$strååÖ Ù
)ååÙ Ú
;ååÚ Û
logData
ææ 
.
ææ 
Append
ææ 
(
ææ 
$str
ææ +
+
ææ, -
fArgs
ææ. 3
.
ææ3 4!
fSecsControlMessage
ææ4 G
.
ææG H
length
ææH N
.
ææN O
ToString
ææO W
(
ææW X
)
ææX Y
+
ææZ [
$str
ææ[ k
+
ææl m
fArgs
ææn s
.
ææs t"
fSecsControlMessageææt ‡
.ææ‡ ˆ
	sessionIdææˆ ‘
.ææ‘ ’
ToStringææ’ š
(ææš ›
)ææ› œ
+ææ 
$strææŸ ¢
)ææ¢ £
;ææ£ ¤
if
çç 
(
çç 
fArgs
çç 
.
çç !
fSecsControlMessage
çç -
.
çç- .
reason
çç. 4
!=
çç5 7
string
çç8 >
.
çç> ?
Empty
çç? D
)
ççD E
{
èè 
logData
éé 
.
éé 
Append
éé "
(
éé" #
$str
éé# /
+
éé0 1
fArgs
éé2 7
.
éé7 8!
fSecsControlMessage
éé8 K
.
ééK L
reason
ééL R
+
ééS T
$str
ééU X
)
ééX Y
;
ééY Z
}
êê 
logData
ëë 
.
ëë 

AppendLine
ëë "
(
ëë" #
)
ëë# $
;
ëë$ %
foreach
ïï 
(
ïï 
string
ïï 
s
ïï  !
in
ïï" $
binToString
ïï% 0
(
ïï0 1
fArgs
ïï1 6
.
ïï6 7!
fSecsControlMessage
ïï7 J
.
ïïJ K
getBinaryData
ïïK X
(
ïïX Y
)
ïïY Z
)
ïïZ [
)
ïï[ \
{
ğğ 
logData
ññ 
.
ññ 

AppendLine
ññ &
(
ññ& '
s
ññ' (
)
ññ( )
;
ññ) *
}
òò 
logData
öö 
.
öö 

AppendLine
öö "
(
öö" #
)
öö# $
;
öö$ %
m_fLogQueue
÷÷ 
.
÷÷ 
enqueue
÷÷ #
(
÷÷# $
logData
÷÷$ +
.
÷÷+ ,
ToString
÷÷, 4
(
÷÷4 5
)
÷÷5 6
)
÷÷6 7
;
÷÷7 8
}
øø 
catch
ùù 
(
ùù 
	Exception
ùù 
ex
ùù 
)
ùù  
{
úú 
FDebug
ûû 
.
ûû 
throwException
ûû %
(
ûû% &
ex
ûû& (
)
ûû( )
;
ûû) *
}
üü 
finally
ıı 
{
şş 
logData
ÿÿ 
=
ÿÿ 
null
ÿÿ 
;
ÿÿ 
}
€€ 
}
 	
private
…… 
void
…… *
writeHsmsDataMessageReceived
…… 1
(
……1 2/
!FHsmsDataMessageReceivedEventArgs
†† -
fArgs
††. 3
)
‡‡ 
{
ˆˆ 	
StringBuilder
‰‰ 
logData
‰‰ !
=
‰‰" #
new
‰‰$ '
StringBuilder
‰‰( 5
(
‰‰5 6
)
‰‰6 7
;
‰‰7 8
try
‹‹ 
{
ŒŒ 
logData
 
.
 

AppendLine
 "
(
" #
$str
# &
+
' (
DateTime
) 1
.
1 2
Now
2 5
.
5 6
ToString
6 >
(
> ?
$str
? X
)
X Y
+
Z [
$str
\ _
)
_ `
;
` a
logData
‘‘ 
.
‘‘ 
Append
‘‘ 
(
‘‘ 
fArgs
‘‘ $
.
‘‘$ %
fEventId
‘‘% -
.
‘‘- .
ToString
‘‘. 6
(
‘‘6 7
)
‘‘7 8
)
‘‘8 9
;
‘‘9 :
logData
’’ 
.
’’ 
Append
’’ 
(
’’ 
$str
’’ +
+
’’, -
fArgs
’’. 3
.
’’3 4
fResult
’’4 ;
.
’’; <
ToString
’’< D
(
’’D E
)
’’E F
+
’’G H
$str
’’I L
)
’’L M
;
’’M N
if
““ 
(
““ 
fArgs
““ 
.
““ 
fResult
““ !
!=
““" $
FResultCode
““% 0
.
““0 1
Success
““1 8
)
““8 9
{
”” 
logData
•• 
.
•• 
Append
•• "
(
••" #
$str
••# 5
+
••6 7
fArgs
••8 =
.
••= >
errorMessage
••> J
+
••K L
$str
••M P
)
••P Q
;
••Q R
}
–– 
logData
—— 
.
—— 

AppendLine
—— "
(
——" #
)
——# $
;
——$ %
logData
›› 
.
›› 
Append
›› 
(
›› 
$str
›› "
+
››# $
fArgs
››% *
.
››* +
fSecsDataMessage
››+ ;
.
››; <
stream
››< B
.
››B C
ToString
››C K
(
››K L
)
››L M
+
››N O
$str
››P S
+
››T U
fArgs
››V [
.
››[ \
fSecsDataMessage
››\ l
.
››l m
function
››m u
.
››u v
ToString
››v ~
(
››~ 
)›› €
)››€ 
;›› ‚
if
œœ 
(
œœ 
fArgs
œœ 
.
œœ 
fSecsDataMessage
œœ *
.
œœ* +
wbit
œœ+ /
)
œœ/ 0
{
 
logData
 
.
 
Append
 "
(
" #
$str
# '
)
' (
;
( )
}
ŸŸ 
logData
   
.
   
Append
   
(
   
$str
   0
+
  1 2
fArgs
  3 8
.
  8 9
fSecsDataMessage
  9 I
.
  I J
systemBytes
  J U
.
  U V
ToString
  V ^
(
  ^ _
)
  _ `
+
  a b
$str
  c p
+
  q r
fArgs
  s x
.
  x y
fSecsDataMessage  y ‰
.  ‰ Š
length  Š 
.   ‘
ToString  ‘ ™
(  ™ š
)  š ›
+  œ 
$str   ®
+  ¯ °
fArgs  ± ¶
.  ¶ · 
fSecsDataMessage  · Ç
.  Ç È
	sessionId  È Ñ
.  Ñ Ò
ToString  Ò Ú
(  Ú Û
)  Û Ü
+  İ Ş
$str  ß â
)  â ã
;  ã ä
logData
¡¡ 
.
¡¡ 

AppendLine
¡¡ "
(
¡¡" #
)
¡¡# $
;
¡¡$ %
foreach
¥¥ 
(
¥¥ 
string
¥¥ 
s
¥¥  !
in
¥¥" $
binToString
¥¥% 0
(
¥¥0 1
fArgs
¥¥1 6
.
¥¥6 7
fSecsDataMessage
¥¥7 G
.
¥¥G H
getHsmsBinaryData
¥¥H Y
(
¥¥Y Z
true
¥¥Z ^
)
¥¥^ _
)
¥¥_ `
)
¥¥` a
{
¦¦ 
logData
§§ 
.
§§ 

AppendLine
§§ &
(
§§& '
s
§§' (
)
§§( )
;
§§) *
}
¨¨ 
logData
¬¬ 
.
¬¬ 

AppendLine
¬¬ "
(
¬¬" #
)
¬¬# $
;
¬¬$ %
m_fLogQueue
­­ 
.
­­ 
enqueue
­­ #
(
­­# $
logData
­­$ +
.
­­+ ,
ToString
­­, 4
(
­­4 5
)
­­5 6
)
­­6 7
;
­­7 8
}
®® 
catch
¯¯ 
(
¯¯ 
	Exception
¯¯ 
ex
¯¯ 
)
¯¯  
{
°° 
FDebug
±± 
.
±± 
throwException
±± %
(
±±% &
ex
±±& (
)
±±( )
;
±±) *
}
²² 
finally
³³ 
{
´´ 
logData
µµ 
=
µµ 
null
µµ 
;
µµ 
}
¶¶ 
}
·· 	
private
»» 
void
»» &
writeHsmsDataMessageSent
»» -
(
»»- .+
FHsmsDataMessageSentEventArgs
¼¼ )
fArgs
¼¼* /
)
½½ 
{
¾¾ 	
StringBuilder
¿¿ 
logData
¿¿ !
=
¿¿" #
new
¿¿$ '
StringBuilder
¿¿( 5
(
¿¿5 6
)
¿¿6 7
;
¿¿7 8
try
ÁÁ 
{
ÂÂ 
logData
ÃÃ 
.
ÃÃ 

AppendLine
ÃÃ "
(
ÃÃ" #
$str
ÃÃ# &
+
ÃÃ' (
DateTime
ÃÃ) 1
.
ÃÃ1 2
Now
ÃÃ2 5
.
ÃÃ5 6
ToString
ÃÃ6 >
(
ÃÃ> ?
$str
ÃÃ? X
)
ÃÃX Y
+
ÃÃZ [
$str
ÃÃ\ _
)
ÃÃ_ `
;
ÃÃ` a
logData
ÇÇ 
.
ÇÇ 
Append
ÇÇ 
(
ÇÇ 
fArgs
ÇÇ $
.
ÇÇ$ %
fEventId
ÇÇ% -
.
ÇÇ- .
ToString
ÇÇ. 6
(
ÇÇ6 7
)
ÇÇ7 8
)
ÇÇ8 9
;
ÇÇ9 :
logData
ÈÈ 
.
ÈÈ 
Append
ÈÈ 
(
ÈÈ 
$str
ÈÈ +
+
ÈÈ, -
fArgs
ÈÈ. 3
.
ÈÈ3 4
fResult
ÈÈ4 ;
.
ÈÈ; <
ToString
ÈÈ< D
(
ÈÈD E
)
ÈÈE F
+
ÈÈG H
$str
ÈÈI L
)
ÈÈL M
;
ÈÈM N
if
ÉÉ 
(
ÉÉ 
fArgs
ÉÉ 
.
ÉÉ 
fResult
ÉÉ !
!=
ÉÉ" $
FResultCode
ÉÉ% 0
.
ÉÉ0 1
Success
ÉÉ1 8
)
ÉÉ8 9
{
ÊÊ 
logData
ËË 
.
ËË 
Append
ËË "
(
ËË" #
$str
ËË# 5
+
ËË6 7
fArgs
ËË8 =
.
ËË= >
errorMessage
ËË> J
+
ËËK L
$str
ËËM P
)
ËËP Q
;
ËËQ R
}
ÌÌ 
logData
ÍÍ 
.
ÍÍ 

AppendLine
ÍÍ "
(
ÍÍ" #
)
ÍÍ# $
;
ÍÍ$ %
logData
ÑÑ 
.
ÑÑ 
Append
ÑÑ 
(
ÑÑ 
$str
ÑÑ "
+
ÑÑ# $
fArgs
ÑÑ% *
.
ÑÑ* +
fSecsDataMessage
ÑÑ+ ;
.
ÑÑ; <
stream
ÑÑ< B
.
ÑÑB C
ToString
ÑÑC K
(
ÑÑK L
)
ÑÑL M
+
ÑÑN O
$str
ÑÑP S
+
ÑÑT U
fArgs
ÑÑV [
.
ÑÑ[ \
fSecsDataMessage
ÑÑ\ l
.
ÑÑl m
function
ÑÑm u
.
ÑÑu v
ToString
ÑÑv ~
(
ÑÑ~ 
)ÑÑ €
)ÑÑ€ 
;ÑÑ ‚
if
ÒÒ 
(
ÒÒ 
fArgs
ÒÒ 
.
ÒÒ 
fSecsDataMessage
ÒÒ *
.
ÒÒ* +
wbit
ÒÒ+ /
)
ÒÒ/ 0
{
ÓÓ 
logData
ÔÔ 
.
ÔÔ 
Append
ÔÔ "
(
ÔÔ" #
$str
ÔÔ# '
)
ÔÔ' (
;
ÔÔ( )
}
ÕÕ 
logData
ÖÖ 
.
ÖÖ 
Append
ÖÖ 
(
ÖÖ 
$str
ÖÖ 0
+
ÖÖ1 2
fArgs
ÖÖ3 8
.
ÖÖ8 9
fSecsDataMessage
ÖÖ9 I
.
ÖÖI J
systemBytes
ÖÖJ U
.
ÖÖU V
ToString
ÖÖV ^
(
ÖÖ^ _
)
ÖÖ_ `
+
ÖÖa b
$str
ÖÖc o
+
ÖÖp q
fArgs
ÖÖr w
.
ÖÖw x
fSecsDataMessageÖÖx ˆ
.ÖÖˆ ‰
lengthÖÖ‰ 
.ÖÖ 
ToStringÖÖ ˜
(ÖÖ˜ ™
)ÖÖ™ š
+ÖÖ› œ
$strÖÖ ­
+ÖÖ® ¯
fArgsÖÖ° µ
.ÖÖµ ¶ 
fSecsDataMessageÖÖ¶ Æ
.ÖÖÆ Ç
	sessionIdÖÖÇ Ğ
.ÖÖĞ Ñ
ToStringÖÖÑ Ù
(ÖÖÙ Ú
)ÖÖÚ Û
+ÖÖÜ İ
$strÖÖŞ á
)ÖÖá â
;ÖÖâ ã
logData
×× 
.
×× 

AppendLine
×× "
(
××" #
)
××# $
;
××$ %
foreach
ÛÛ 
(
ÛÛ 
string
ÛÛ 
s
ÛÛ  !
in
ÛÛ" $
binToString
ÛÛ% 0
(
ÛÛ0 1
fArgs
ÛÛ1 6
.
ÛÛ6 7
fSecsDataMessage
ÛÛ7 G
.
ÛÛG H
getHsmsBinaryData
ÛÛH Y
(
ÛÛY Z
true
ÛÛZ ^
)
ÛÛ^ _
)
ÛÛ_ `
)
ÛÛ` a
{
ÜÜ 
logData
İİ 
.
İİ 

AppendLine
İİ &
(
İİ& '
s
İİ' (
)
İİ( )
;
İİ) *
}
ŞŞ 
logData
ââ 
.
ââ 

AppendLine
ââ "
(
ââ" #
)
ââ# $
;
ââ$ %
m_fLogQueue
ãã 
.
ãã 
enqueue
ãã #
(
ãã# $
logData
ãã$ +
.
ãã+ ,
ToString
ãã, 4
(
ãã4 5
)
ãã5 6
)
ãã6 7
;
ãã7 8
}
ää 
catch
åå 
(
åå 
	Exception
åå 
ex
åå 
)
åå  
{
ææ 
FDebug
çç 
.
çç 
throwException
çç %
(
çç% &
ex
çç& (
)
çç( )
;
çç) *
}
èè 
finally
éé 
{
êê 
logData
ëë 
=
ëë 
null
ëë 
;
ëë 
}
ìì 
}
íí 	
private
ññ 
void
ññ -
writeHsmsDataMessageReceivedSml
ññ 4
(
ññ4 5/
!FHsmsDataMessageReceivedEventArgs
òò -
fArgs
òò. 3
)
óó 
{
ôô 	
StringBuilder
õõ 
logData
õõ !
=
õõ" #
new
õõ$ '
StringBuilder
õõ( 5
(
õõ5 6
)
õõ6 7
;
õõ7 8
try
÷÷ 
{
øø 
logData
ùù 
.
ùù 

AppendLine
ùù "
(
ùù" #
$str
ùù# &
+
ùù' (
DateTime
ùù) 1
.
ùù1 2
Now
ùù2 5
.
ùù5 6
ToString
ùù6 >
(
ùù> ?
$str
ùù? X
)
ùùX Y
+
ùùZ [
$str
ùù\ _
)
ùù_ `
;
ùù` a
logData
ıı 
.
ıı 
Append
ıı 
(
ıı 
fArgs
ıı $
.
ıı$ %
fEventId
ıı% -
.
ıı- .
ToString
ıı. 6
(
ıı6 7
)
ıı7 8
+
ıı9 :
$str
ıı; A
)
ııA B
;
ııB C
logData
şş 
.
şş 
Append
şş 
(
şş 
$str
şş +
+
şş, -
fArgs
şş. 3
.
şş3 4
fResult
şş4 ;
.
şş; <
ToString
şş< D
(
şşD E
)
şşE F
+
şşG H
$str
şşI L
)
şşL M
;
şşM N
if
ÿÿ 
(
ÿÿ 
fArgs
ÿÿ 
.
ÿÿ 
fResult
ÿÿ !
!=
ÿÿ" $
FResultCode
ÿÿ% 0
.
ÿÿ0 1
Success
ÿÿ1 8
)
ÿÿ8 9
{
€	€	 
logData
		 
.
		 
Append
		 "
(
		" #
$str
		# 5
+
		6 7
fArgs
		8 =
.
		= >
errorMessage
		> J
+
		K L
$str
		M P
)
		P Q
;
		Q R
}
‚	‚	 
logData
ƒ	ƒ	 
.
ƒ	ƒ	 

AppendLine
ƒ	ƒ	 "
(
ƒ	ƒ	" #
)
ƒ	ƒ	# $
;
ƒ	ƒ	$ %
logData
‡	‡	 
.
‡	‡	 
Append
‡	‡	 
(
‡	‡	 
$str
‡	‡	 "
+
‡	‡	# $
fArgs
‡	‡	% *
.
‡	‡	* +
fSecsDataMessage
‡	‡	+ ;
.
‡	‡	; <
stream
‡	‡	< B
.
‡	‡	B C
ToString
‡	‡	C K
(
‡	‡	K L
)
‡	‡	L M
+
‡	‡	N O
$str
‡	‡	P S
+
‡	‡	T U
fArgs
‡	‡	V [
.
‡	‡	[ \
fSecsDataMessage
‡	‡	\ l
.
‡	‡	l m
function
‡	‡	m u
.
‡	‡	u v
ToString
‡	‡	v ~
(
‡	‡	~ 
)‡	‡	 €
)‡	‡	€ 
;‡	‡	 ‚
if
ˆ	ˆ	 
(
ˆ	ˆ	 
fArgs
ˆ	ˆ	 
.
ˆ	ˆ	 
fSecsDataMessage
ˆ	ˆ	 *
.
ˆ	ˆ	* +
wbit
ˆ	ˆ	+ /
)
ˆ	ˆ	/ 0
{
‰	‰	 
logData
Š	Š	 
.
Š	Š	 
Append
Š	Š	 "
(
Š	Š	" #
$str
Š	Š	# '
)
Š	Š	' (
;
Š	Š	( )
}
‹	‹	 
logData
Œ	Œ	 
.
Œ	Œ	 
Append
Œ	Œ	 
(
Œ	Œ	 
$str
Œ	Œ	 0
+
Œ	Œ	1 2
fArgs
Œ	Œ	3 8
.
Œ	Œ	8 9
fSecsDataMessage
Œ	Œ	9 I
.
Œ	Œ	I J
systemBytes
Œ	Œ	J U
.
Œ	Œ	U V
ToString
Œ	Œ	V ^
(
Œ	Œ	^ _
)
Œ	Œ	_ `
+
Œ	Œ	a b
$str
Œ	Œ	c p
+
Œ	Œ	q r
fArgs
Œ	Œ	s x
.
Œ	Œ	x y
fSecsDataMessageŒ	Œ	y ‰
.Œ	Œ	‰ Š
lengthŒ	Œ	Š 
.Œ	Œ	 ‘
ToStringŒ	Œ	‘ ™
(Œ	Œ	™ š
)Œ	Œ	š ›
+Œ	Œ	œ 
$strŒ	Œ	 ®
+Œ	Œ	¯ °
fArgsŒ	Œ	± ¶
.Œ	Œ	¶ · 
fSecsDataMessageŒ	Œ	· Ç
.Œ	Œ	Ç È
	sessionIdŒ	Œ	È Ñ
.Œ	Œ	Ñ Ò
ToStringŒ	Œ	Ò Ú
(Œ	Œ	Ú Û
)Œ	Œ	Û Ü
+Œ	Œ	İ Ş
$strŒ	Œ	ß â
)Œ	Œ	â ã
;Œ	Œ	ã ä
logData
		 
.
		 

AppendLine
		 "
(
		" #
)
		# $
;
		$ %
if
‘	‘	 
(
‘	‘	 
fArgs
‘	‘	 
.
‘	‘	 
fSecsDataMessage
‘	‘	 *
.
‘	‘	* +
body
‘	‘	+ /
.
‘	‘	/ 0
Length
‘	‘	0 6
>
‘	‘	7 8
$num
‘	‘	9 :
)
‘	‘	: ;
{
’	’	 
logData
“	“	 
.
“	“	 

AppendLine
“	“	 &
(
“	“	& '
FSecsConverter
“	“	' 5
.
“	“	5 6
convertBinToSml
“	“	6 E
(
“	“	E F
fArgs
“	“	F K
.
“	“	K L
fSecsDataMessage
“	“	L \
.
“	“	\ ]
body
“	“	] a
)
“	“	a b
)
“	“	b c
;
“	“	c d
}
”	”	 
logData
˜	˜	 
.
˜	˜	 

AppendLine
˜	˜	 "
(
˜	˜	" #
)
˜	˜	# $
;
˜	˜	$ %
m_fLogQueue
™	™	 
.
™	™	 
enqueue
™	™	 #
(
™	™	# $
logData
™	™	$ +
.
™	™	+ ,
ToString
™	™	, 4
(
™	™	4 5
)
™	™	5 6
)
™	™	6 7
;
™	™	7 8
}
š	š	 
catch
›	›	 
(
›	›	 
	Exception
›	›	 
ex
›	›	 
)
›	›	  
{
œ	œ	 
FDebug
		 
.
		 
throwException
		 %
(
		% &
ex
		& (
)
		( )
;
		) *
}
		 
finally
Ÿ	Ÿ	 
{
 	 	 
logData
¡	¡	 
=
¡	¡	 
null
¡	¡	 
;
¡	¡	 
}
¢	¢	 
}
£	£	 	
private
§	§	 
void
§	§	 )
writeHsmsDataMessageSentSml
§	§	 0
(
§	§	0 1+
FHsmsDataMessageSentEventArgs
¨	¨	 )
fArgs
¨	¨	* /
)
©	©	 
{
ª	ª	 	
StringBuilder
«	«	 
logData
«	«	 !
=
«	«	" #
new
«	«	$ '
StringBuilder
«	«	( 5
(
«	«	5 6
)
«	«	6 7
;
«	«	7 8
try
­	­	 
{
®	®	 
logData
¯	¯	 
.
¯	¯	 

AppendLine
¯	¯	 "
(
¯	¯	" #
$str
¯	¯	# &
+
¯	¯	' (
DateTime
¯	¯	) 1
.
¯	¯	1 2
Now
¯	¯	2 5
.
¯	¯	5 6
ToString
¯	¯	6 >
(
¯	¯	> ?
$str
¯	¯	? X
)
¯	¯	X Y
+
¯	¯	Z [
$str
¯	¯	\ _
)
¯	¯	_ `
;
¯	¯	` a
logData
³	³	 
.
³	³	 
Append
³	³	 
(
³	³	 
fArgs
³	³	 $
.
³	³	$ %
fEventId
³	³	% -
.
³	³	- .
ToString
³	³	. 6
(
³	³	6 7
)
³	³	7 8
+
³	³	9 :
$str
³	³	; A
)
³	³	A B
;
³	³	B C
logData
´	´	 
.
´	´	 
Append
´	´	 
(
´	´	 
$str
´	´	 +
+
´	´	, -
fArgs
´	´	. 3
.
´	´	3 4
fResult
´	´	4 ;
.
´	´	; <
ToString
´	´	< D
(
´	´	D E
)
´	´	E F
+
´	´	G H
$str
´	´	I L
)
´	´	L M
;
´	´	M N
if
µ	µ	 
(
µ	µ	 
fArgs
µ	µ	 
.
µ	µ	 
fResult
µ	µ	 !
!=
µ	µ	" $
FResultCode
µ	µ	% 0
.
µ	µ	0 1
Success
µ	µ	1 8
)
µ	µ	8 9
{
¶	¶	 
logData
·	·	 
.
·	·	 
Append
·	·	 "
(
·	·	" #
$str
·	·	# 5
+
·	·	6 7
fArgs
·	·	8 =
.
·	·	= >
errorMessage
·	·	> J
+
·	·	K L
$str
·	·	M P
)
·	·	P Q
;
·	·	Q R
}
¸	¸	 
logData
¹	¹	 
.
¹	¹	 

AppendLine
¹	¹	 "
(
¹	¹	" #
)
¹	¹	# $
;
¹	¹	$ %
logData
½	½	 
.
½	½	 
Append
½	½	 
(
½	½	 
$str
½	½	 "
+
½	½	# $
fArgs
½	½	% *
.
½	½	* +
fSecsDataMessage
½	½	+ ;
.
½	½	; <
stream
½	½	< B
.
½	½	B C
ToString
½	½	C K
(
½	½	K L
)
½	½	L M
+
½	½	N O
$str
½	½	P S
+
½	½	T U
fArgs
½	½	V [
.
½	½	[ \
fSecsDataMessage
½	½	\ l
.
½	½	l m
function
½	½	m u
.
½	½	u v
ToString
½	½	v ~
(
½	½	~ 
)½	½	 €
)½	½	€ 
;½	½	 ‚
if
¾	¾	 
(
¾	¾	 
fArgs
¾	¾	 
.
¾	¾	 
fSecsDataMessage
¾	¾	 *
.
¾	¾	* +
wbit
¾	¾	+ /
)
¾	¾	/ 0
{
¿	¿	 
logData
À	À	 
.
À	À	 
Append
À	À	 "
(
À	À	" #
$str
À	À	# '
)
À	À	' (
;
À	À	( )
}
Á	Á	 
logData
Â	Â	 
.
Â	Â	 
Append
Â	Â	 
(
Â	Â	 
$str
Â	Â	 0
+
Â	Â	1 2
fArgs
Â	Â	3 8
.
Â	Â	8 9
fSecsDataMessage
Â	Â	9 I
.
Â	Â	I J
systemBytes
Â	Â	J U
.
Â	Â	U V
ToString
Â	Â	V ^
(
Â	Â	^ _
)
Â	Â	_ `
+
Â	Â	a b
$str
Â	Â	c p
+
Â	Â	q r
fArgs
Â	Â	s x
.
Â	Â	x y
fSecsDataMessageÂ	Â	y ‰
.Â	Â	‰ Š
lengthÂ	Â	Š 
.Â	Â	 ‘
ToStringÂ	Â	‘ ™
(Â	Â	™ š
)Â	Â	š ›
+Â	Â	œ 
$strÂ	Â	 ®
+Â	Â	¯ °
fArgsÂ	Â	± ¶
.Â	Â	¶ · 
fSecsDataMessageÂ	Â	· Ç
.Â	Â	Ç È
	sessionIdÂ	Â	È Ñ
.Â	Â	Ñ Ò
ToStringÂ	Â	Ò Ú
(Â	Â	Ú Û
)Â	Â	Û Ü
+Â	Â	İ Ş
$strÂ	Â	ß â
)Â	Â	â ã
;Â	Â	ã ä
logData
Ã	Ã	 
.
Ã	Ã	 

AppendLine
Ã	Ã	 "
(
Ã	Ã	" #
)
Ã	Ã	# $
;
Ã	Ã	$ %
if
Ç	Ç	 
(
Ç	Ç	 
fArgs
Ç	Ç	 
.
Ç	Ç	 
fSecsDataMessage
Ç	Ç	 *
.
Ç	Ç	* +
body
Ç	Ç	+ /
.
Ç	Ç	/ 0
Length
Ç	Ç	0 6
>
Ç	Ç	7 8
$num
Ç	Ç	9 :
)
Ç	Ç	: ;
{
È	È	 
logData
É	É	 
.
É	É	 

AppendLine
É	É	 &
(
É	É	& '
FSecsConverter
É	É	' 5
.
É	É	5 6
convertBinToSml
É	É	6 E
(
É	É	E F
fArgs
É	É	F K
.
É	É	K L
fSecsDataMessage
É	É	L \
.
É	É	\ ]
body
É	É	] a
)
É	É	a b
)
É	É	b c
;
É	É	c d
}
Ê	Ê	 
logData
Î	Î	 
.
Î	Î	 

AppendLine
Î	Î	 "
(
Î	Î	" #
)
Î	Î	# $
;
Î	Î	$ %
m_fLogQueue
Ï	Ï	 
.
Ï	Ï	 
enqueue
Ï	Ï	 #
(
Ï	Ï	# $
logData
Ï	Ï	$ +
.
Ï	Ï	+ ,
ToString
Ï	Ï	, 4
(
Ï	Ï	4 5
)
Ï	Ï	5 6
)
Ï	Ï	6 7
;
Ï	Ï	7 8
}
Ğ	Ğ	 
catch
Ñ	Ñ	 
(
Ñ	Ñ	 
	Exception
Ñ	Ñ	 
ex
Ñ	Ñ	 
)
Ñ	Ñ	  
{
Ò	Ò	 
FDebug
Ó	Ó	 
.
Ó	Ó	 
throwException
Ó	Ó	 %
(
Ó	Ó	% &
ex
Ó	Ó	& (
)
Ó	Ó	( )
;
Ó	Ó	) *
}
Ô	Ô	 
finally
Õ	Õ	 
{
Ö	Ö	 
logData
×	×	 
=
×	×	 
null
×	×	 
;
×	×	 
}
Ø	Ø	 
}
Ù	Ù	 	
public
İ	İ	 
void
İ	İ	 
write
İ	İ	 
(
İ	İ	 
FEventArgsBase
Ş	Ş	 
fArgs
Ş	Ş	  
)
ß	ß	 
{
à	à	 	
try
á	á	 
{
â	â	 
if
ã	ã	 
(
ã	ã	 
fArgs
ã	ã	 
.
ã	ã	 
fEventId
ã	ã	 "
==
ã	ã	# %
FEventId
ã	ã	& .
.
ã	ã	. /
LogMonitoring
ã	ã	/ <
)
ã	ã	< =
{
ä	ä	 
return
å	å	 
;
å	å	 
}
æ	æ	 
if
ê	ê	 
(
ê	ê	 
fArgs
ê	ê	 
.
ê	ê	 
fEventId
ê	ê	 "
==
ê	ê	# %
FEventId
ê	ê	& .
.
ê	ê	. /
Secs1StateChanged
ê	ê	/ @
)
ê	ê	@ A
{
ë	ë	 $
writeSecs1StateChanged
ì	ì	 *
(
ì	ì	* +
(
ì	ì	+ ,)
FSecs1StateChangedEventArgs
ì	ì	, G
)
ì	ì	G H
fArgs
ì	ì	H M
)
ì	ì	M N
;
ì	ì	N O
}
í	í	 
else
î	î	 
if
î	î	 
(
î	î	 
fArgs
î	î	 
.
î	î	 
fEventId
î	î	 '
==
î	î	( *
FEventId
î	î	+ 3
.
î	î	3 4
Secs1ErrorRaised
î	î	4 D
)
î	î	D E
{
ï	ï	 #
writeSecs1ErrorRaised
ğ	ğ	 )
(
ğ	ğ	) *
(
ğ	ğ	* +(
FSecs1ErrorRaisedEventArgs
ğ	ğ	+ E
)
ğ	ğ	E F
fArgs
ğ	ğ	F K
)
ğ	ğ	K L
;
ğ	ğ	L M
}
ñ	ñ	 
else
ò	ò	 
if
ò	ò	 
(
ò	ò	 
fArgs
ò	ò	 
.
ò	ò	 
fEventId
ò	ò	 '
==
ò	ò	( *
FEventId
ò	ò	+ 3
.
ò	ò	3 4 
Secs1TimeoutRaised
ò	ò	4 F
)
ò	ò	F G
{
ó	ó	 %
writeSecs1TimeoutRaised
ô	ô	 +
(
ô	ô	+ ,
(
ô	ô	, -*
FSecs1TimeoutRaisedEventArgs
ô	ô	- I
)
ô	ô	I J
fArgs
ô	ô	J O
)
ô	ô	O P
;
ô	ô	P Q
}
õ	õ	 
else
ö	ö	 
if
ö	ö	 
(
ö	ö	 
fArgs
ö	ö	 
.
ö	ö	 
fEventId
ö	ö	 '
==
ö	ö	( *
FEventId
ö	ö	+ 3
.
ö	ö	3 4$
Secs1HandshakeReceived
ö	ö	4 J
)
ö	ö	J K
{
÷	÷	 )
writeSecs1HandshakeReceived
ø	ø	 /
(
ø	ø	/ 0
(
ø	ø	0 1.
 FSecs1HandshakeReceivedEventArgs
ø	ø	1 Q
)
ø	ø	Q R
fArgs
ø	ø	R W
)
ø	ø	W X
;
ø	ø	X Y
}
ù	ù	 
else
ú	ú	 
if
ú	ú	 
(
ú	ú	 
fArgs
ú	ú	 
.
ú	ú	 
fEventId
ú	ú	 '
==
ú	ú	( *
FEventId
ú	ú	+ 3
.
ú	ú	3 4 
Secs1HandshakeSent
ú	ú	4 F
)
ú	ú	F G
{
û	û	 %
writeSecs1HandshakeSent
ü	ü	 +
(
ü	ü	+ ,
(
ü	ü	, -*
FSecs1HandshakeSentEventArgs
ü	ü	- I
)
ü	ü	I J
fArgs
ü	ü	J O
)
ü	ü	O P
;
ü	ü	P Q
}
ı	ı	 
else
ş	ş	 
if
ş	ş	 
(
ş	ş	 
fArgs
ş	ş	 
.
ş	ş	 
fEventId
ş	ş	 '
==
ş	ş	( *
FEventId
ş	ş	+ 3
.
ş	ş	3 4 
Secs1BlockReceived
ş	ş	4 F
)
ş	ş	F G
{
ÿ	ÿ	 %
writeSecs1BlockReceived
€
€
 +
(
€
€
+ ,
(
€
€
, -*
FSecs1BlockReceivedEventArgs
€
€
- I
)
€
€
I J
fArgs
€
€
J O
)
€
€
O P
;
€
€
P Q
}


 
else
‚
‚
 
if
‚
‚
 
(
‚
‚
 
fArgs
‚
‚
 
.
‚
‚
 
fEventId
‚
‚
 '
==
‚
‚
( *
FEventId
‚
‚
+ 3
.
‚
‚
3 4
Secs1BlockSent
‚
‚
4 B
)
‚
‚
B C
{
ƒ
ƒ
 !
writeSecs1BlockSent
„
„
 '
(
„
„
' (
(
„
„
( )&
FSecs1BlockSentEventArgs
„
„
) A
)
„
„
A B
fArgs
„
„
B G
)
„
„
G H
;
„
„
H I
}
…
…
 
else
†
†
 
if
†
†
 
(
†
†
 
fArgs
†
†
 
.
†
†
 
fEventId
†
†
 '
==
†
†
( *
FEventId
†
†
+ 3
.
†
†
3 4&
Secs1DataMessageReceived
†
†
4 L
)
†
†
L M
{
‡
‡
 .
 writeSecs1DataMessageReceivedSml
ˆ
ˆ
 4
(
ˆ
ˆ
4 5
(
ˆ
ˆ
5 60
"FSecs1DataMessageReceivedEventArgs
ˆ
ˆ
6 X
)
ˆ
ˆ
X Y
fArgs
ˆ
ˆ
Y ^
)
ˆ
ˆ
^ _
;
ˆ
ˆ
_ `
}
‰
‰
 
else
Š
Š
 
if
Š
Š
 
(
Š
Š
 
fArgs
Š
Š
 
.
Š
Š
 
fEventId
Š
Š
 '
==
Š
Š
( *
FEventId
Š
Š
+ 3
.
Š
Š
3 4"
Secs1DataMessageSent
Š
Š
4 H
)
Š
Š
H I
{
‹
‹
 *
writeSecs1DataMessageSentSml
Œ
Œ
 0
(
Œ
Œ
0 1
(
Œ
Œ
1 2,
FSecs1DataMessageSentEventArgs
Œ
Œ
2 P
)
Œ
Œ
P Q
fArgs
Œ
Œ
Q V
)
Œ
Œ
V W
;
Œ
Œ
W X
}


 
else


 
if


 
(


 
fArgs


 
.


 
fEventId


 '
==


( *
FEventId


+ 3
.


3 4
HsmsStateChanged


4 D
)


D E
{


 #
writeHsmsStateChanged
‘
‘
 )
(
‘
‘
) *
(
‘
‘
* +(
FHsmsStateChangedEventArgs
‘
‘
+ E
)
‘
‘
E F
fArgs
‘
‘
F K
)
‘
‘
K L
;
‘
‘
L M
}
’
’
 
else
“
“
 
if
“
“
 
(
“
“
 
fArgs
“
“
 
.
“
“
 
fEventId
“
“
 '
==
“
“
( *
FEventId
“
“
+ 3
.
“
“
3 4
HsmsErrorRaised
“
“
4 C
)
“
“
C D
{
”
”
 "
writeHsmsErrorRaised
•
•
 (
(
•
•
( )
(
•
•
) *'
FHsmsErrorRaisedEventArgs
•
•
* C
)
•
•
C D
fArgs
•
•
D I
)
•
•
I J
;
•
•
J K
}
–
–
 
else
—
—
 
if
—
—
 
(
—
—
 
fArgs
—
—
 
.
—
—
 
fEventId
—
—
 '
==
—
—
( *
FEventId
—
—
+ 3
.
—
—
3 4
HsmsTimeoutRaised
—
—
4 E
)
—
—
E F
{
˜
˜
 $
writeHsmsTimeoutRaised
™
™
 *
(
™
™
* +
(
™
™
+ ,)
FHsmsTimeoutRaisedEventArgs
™
™
, G
)
™
™
G H
fArgs
™
™
H M
)
™
™
M N
;
™
™
N O
}
š
š
 
else
›
›
 
if
›
›
 
(
›
›
 
fArgs
›
›
 
.
›
›
 
fEventId
›
›
 '
==
›
›
( *
FEventId
›
›
+ 3
.
›
›
3 4(
HsmsControlMessageReceived
›
›
4 N
)
›
›
N O
{
œ
œ
 -
writeHsmsControlMessageReceived


 3
(


3 4
(


4 52
$FHsmsControlMessageReceivedEventArgs


5 Y
)


Y Z
fArgs


Z _
)


_ `
;


` a
}


 
else
Ÿ
Ÿ
 
if
Ÿ
Ÿ
 
(
Ÿ
Ÿ
 
fArgs
Ÿ
Ÿ
 
.
Ÿ
Ÿ
 
fEventId
Ÿ
Ÿ
 '
==
Ÿ
Ÿ
( *
FEventId
Ÿ
Ÿ
+ 3
.
Ÿ
Ÿ
3 4$
HsmsControlMessageSent
Ÿ
Ÿ
4 J
)
Ÿ
Ÿ
J K
{
 
 
 )
writeHsmsControlMessageSent
¡
¡
 /
(
¡
¡
/ 0
(
¡
¡
0 1.
 FHsmsControlMessageSentEventArgs
¡
¡
1 Q
)
¡
¡
Q R
fArgs
¡
¡
R W
)
¡
¡
W X
;
¡
¡
X Y
}
¢
¢
 
else
£
£
 
if
£
£
 
(
£
£
 
fArgs
£
£
 
.
£
£
 
fEventId
£
£
 '
==
£
£
( *
FEventId
£
£
+ 3
.
£
£
3 4%
HsmsDataMessageReceived
£
£
4 K
)
£
£
K L
{
¤
¤
 *
writeHsmsDataMessageReceived
¥
¥
 0
(
¥
¥
0 1
(
¥
¥
1 2/
!FHsmsDataMessageReceivedEventArgs
¥
¥
2 S
)
¥
¥
S T
fArgs
¥
¥
T Y
)
¥
¥
Y Z
;
¥
¥
Z [-
writeHsmsDataMessageReceivedSml
¦
¦
 3
(
¦
¦
3 4
(
¦
¦
4 5/
!FHsmsDataMessageReceivedEventArgs
¦
¦
5 V
)
¦
¦
V W
fArgs
¦
¦
W \
)
¦
¦
\ ]
;
¦
¦
] ^
}
§
§
 
else
¨
¨
 
if
¨
¨
 
(
¨
¨
 
fArgs
¨
¨
 
.
¨
¨
 
fEventId
¨
¨
 '
==
¨
¨
( *
FEventId
¨
¨
+ 3
.
¨
¨
3 4!
HsmsDataMessageSent
¨
¨
4 G
)
¨
¨
G H
{
©
©
 &
writeHsmsDataMessageSent
ª
ª
 ,
(
ª
ª
, -
(
ª
ª
- .+
FHsmsDataMessageSentEventArgs
ª
ª
. K
)
ª
ª
K L
fArgs
ª
ª
L Q
)
ª
ª
Q R
;
ª
ª
R S)
writeHsmsDataMessageSentSml
«
«
 /
(
«
«
/ 0
(
«
«
0 1+
FHsmsDataMessageSentEventArgs
«
«
1 N
)
«
«
N O
fArgs
«
«
O T
)
«
«
T U
;
«
«
U V
}
¬
¬
 
}
­
­
 
catch
®
®
 
(
®
®
 
	Exception
®
®
 
ex
®
®
 
)
®
®
  
{
¯
¯
 
FDebug
°
°
 
.
°
°
 
writeLog
°
°
 
(
°
°
  
ex
°
°
  "
)
°
°
" #
;
°
°
# $
}
±
±
 
finally
²
²
 
{
³
³
 
}
µ
µ
 
}
¶
¶
 	
public
º
º
 
void
º
º
 
write
º
º
 
(
º
º
 
string
»
»
 
log
»
»
 
)
¼
¼
 
{
½
½
 	
StringBuilder
¾
¾
 
logData
¾
¾
 !
=
¾
¾
" #
new
¾
¾
$ '
StringBuilder
¾
¾
( 5
(
¾
¾
5 6
)
¾
¾
6 7
;
¾
¾
7 8
try
À
À
 
{
Á
Á
 
logData
Â
Â
 
.
Â
Â
 

AppendLine
Â
Â
 "
(
Â
Â
" #
$str
Â
Â
# &
+
Â
Â
' (
DateTime
Â
Â
) 1
.
Â
Â
1 2
Now
Â
Â
2 5
.
Â
Â
5 6
ToString
Â
Â
6 >
(
Â
Â
> ?
$str
Â
Â
? X
)
Â
Â
X Y
+
Â
Â
Z [
$str
Â
Â
\ _
)
Â
Â
_ `
;
Â
Â
` a
logData
Ã
Ã
 
.
Ã
Ã
 
Append
Ã
Ã
 
(
Ã
Ã
 
log
Ã
Ã
 "
)
Ã
Ã
" #
;
Ã
Ã
# $
m_fLogQueue
Ä
Ä
 
.
Ä
Ä
 
enqueue
Ä
Ä
 #
(
Ä
Ä
# $
logData
Ä
Ä
$ +
.
Ä
Ä
+ ,
ToString
Ä
Ä
, 4
(
Ä
Ä
4 5
)
Ä
Ä
5 6
)
Ä
Ä
6 7
;
Ä
Ä
7 8
}
Å
Å
 
catch
Æ
Æ
 
(
Æ
Æ
 
	Exception
Æ
Æ
 
ex
Æ
Æ
 
)
Æ
Æ
  
{
Ç
Ç
 
FDebug
È
È
 
.
È
È
 
throwException
È
È
 %
(
È
È
% &
ex
È
È
& (
)
È
È
( )
;
È
È
) *
}
É
É
 
finally
Ê
Ê
 
{
Ë
Ë
 
logData
Ì
Ì
 
=
Ì
Ì
 
null
Ì
Ì
 
;
Ì
Ì
 
}
Í
Í
 
}
Î
Î
 	
private
Ö
Ö
 
void
Ö
Ö
 (
m_fThdMain_ThreadJobCalled
Ö
Ö
 /
(
Ö
Ö
/ 0
object
×
×
 
sender
×
×
 
,
×
×
 
FThreadEventArgs
Ø
Ø
 
e
Ø
Ø
 
)
Ù
Ù
 
{
Ú
Ú
 	
try
Û
Û
 
{
Ü
Ü
 
if
İ
İ
 
(
İ
İ
 
m_fLogQueue
İ
İ
 
.
İ
İ
  
count
İ
İ
  %
==
İ
İ
& (
$num
İ
İ
) *
)
İ
İ
* +
{
Ş
Ş
 
e
ß
ß
 
.
ß
ß
 
sleepThread
ß
ß
 !
(
ß
ß
! "
$num
ß
ß
" #
)
ß
ß
# $
;
ß
ß
$ %
return
à
à
 
;
à
à
 
}
á
á
 
writeLog
â
â
 
(
â
â
 
)
â
â
 
;
â
â
 
}
ã
ã
 
catch
ä
ä
 
(
ä
ä
 
	Exception
ä
ä
 
ex
ä
ä
 
)
ä
ä
  
{
å
å
 
FDebug
æ
æ
 
.
æ
æ
 
writeLog
æ
æ
 
(
æ
æ
  
ex
æ
æ
  "
)
æ
æ
" #
;
æ
æ
# $
e
ç
ç
 
.
ç
ç
 
sleepThread
ç
ç
 
(
ç
ç
 
$num
ç
ç
 
)
ç
ç
  
;
ç
ç
  !
}
è
è
 
finally
é
é
 
{
ê
ê
 
}
ì
ì
 
}
í
í
 	
}
ó
ó
 
}ô
ô
 §8
ŒD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Protocol\HSMS\c_FHsmsControlMessageTransaction.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
internal 
class *
FHsmsControlMessageTransaction 1
:2 3
IDisposable4 ?
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FSecs1ToHsms 
m_fSecs1ToHsms +
=, -
null. 2
;2 3
private 
FStaticTimer 
m_fTimer %
=& '
null( ,
;, -
private 
UInt16 
m_sessionId "
=# $
$num% &
;& '
private 
UInt32 
m_systemBytes $
=% &
$num' (
;( )
public%% *
FHsmsControlMessageTransaction%% -
(%%- .
FSecs1ToHsms&& 
fSecs1ToHsms&& %
)'' 
{(( 	
m_fSecs1ToHsms)) 
=)) 
fSecs1ToHsms)) )
;))) *
m_fTimer** 
=** 
new** 
FStaticTimer** '
(**' (
)**( )
;**) *
}++ 	
~// 	*
FHsmsControlMessageTransaction//	 '
(//' (
)00 
{11 	
	myDispose22 
(22 
false22 
)22 
;22 
}33 	
	protected77 
void77 
	myDispose77  
(77  !
bool88 
	disposing88 
)99 
{:: 	
if;; 
(;; 
!;; 

m_disposed;; 
);; 
{<< 
if== 
(== 
	disposing== 
)== 
{>> 
if?? 
(?? 
m_fTimer??  
!=??! #
null??$ (
)??( )
{@@ 
m_fTimerAA  
.AA  !
DisposeAA! (
(AA( )
)AA) *
;AA* +
m_fTimerBB  
=BB! "
nullBB# '
;BB' (
}CC 
m_fSecs1ToHsmsDD "
=DD# $
nullDD% )
;DD) *
}EE 

m_disposedFF 
=FF 
trueFF !
;FF! "
}GG 
}HH 	
publicPP 
voidPP 
DisposePP 
(PP 
)QQ 
{RR 	
	myDisposeSS 
(SS 
trueSS 
)SS 
;SS 
GCTT 
.TT 
SuppressFinalizeTT 
(TT  
thisTT  $
)TT$ %
;TT% &
}UU 	
public]] 
bool]] 
enabled]] 
{^^ 	
get__ 
{`` 
tryaa 
{bb 
returncc 
m_fTimercc #
.cc# $
enabledcc$ +
;cc+ ,
}dd 
catchee 
(ee 
	Exceptionee  
exee! #
)ee# $
{ff 
FDebuggg 
.gg 
throwExceptiongg )
(gg) *
exgg* ,
)gg, -
;gg- .
}hh 
finallyii 
{jj 
}ll 
returnmm 
falsemm 
;mm 
}nn 
}oo 	
publicss 
UInt16ss 
	sessionIdss 
{tt 	
getuu 
{vv 
tryww 
{xx 
returnyy 
m_sessionIdyy &
;yy& '
}zz 
catch{{ 
({{ 
	Exception{{  
ex{{! #
){{# $
{|| 
FDebug}} 
.}} 
throwException}} )
(}}) *
ex}}* ,
)}}, -
;}}- .
}~~ 
finally 
{
€€ 
}
‚‚ 
return
ƒƒ 
$num
ƒƒ 
;
ƒƒ 
}
„„ 
}
…… 	
public
‰‰ 
UInt32
‰‰ 
systemBytes
‰‰ !
{
ŠŠ 	
get
‹‹ 
{
ŒŒ 
try
 
{
 
return
 
m_systemBytes
 (
;
( )
}
 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘  
ex
‘‘! #
)
‘‘# $
{
’’ 
FDebug
““ 
.
““ 
throwException
““ )
(
““) *
ex
““* ,
)
““, -
;
““- .
}
”” 
finally
•• 
{
–– 
}
˜˜ 
return
™™ 
$num
™™ 
;
™™ 
}
šš 
}
›› 	
public
££ 
void
££ 
set
££ 
(
££ 
UInt16
¤¤ 
	sessionId
¤¤ 
,
¤¤ 
UInt32
¥¥ 
systemBytes
¥¥ 
)
¦¦ 
{
§§ 	
try
¨¨ 
{
©© 
m_fTimer
ªª 
.
ªª 
start
ªª 
(
ªª 
m_fSecs1ToHsms
ªª -
.
ªª- .
fHsmsConfig
ªª. 9
.
ªª9 :
	t6Timeout
ªª: C
*
ªªD E
$num
ªªF J
)
ªªJ K
;
ªªK L
m_sessionId
«« 
=
«« 
	sessionId
«« '
;
««' (
m_systemBytes
¬¬ 
=
¬¬ 
systemBytes
¬¬  +
;
¬¬+ ,
}
­­ 
catch
®® 
(
®® 
	Exception
®® 
ex
®® 
)
®®  
{
¯¯ 
FDebug
°° 
.
°° 
throwException
°° %
(
°°% &
ex
°°& (
)
°°( )
;
°°) *
}
±± 
finally
²² 
{
³³ 
}
µµ 
}
¶¶ 	
public
ºº 
void
ºº 
reset
ºº 
(
ºº 
)
»» 
{
¼¼ 	
try
½½ 
{
¾¾ 
m_fTimer
¿¿ 
.
¿¿ 
stop
¿¿ 
(
¿¿ 
)
¿¿ 
;
¿¿  
m_systemBytes
ÀÀ 
=
ÀÀ 
$num
ÀÀ  !
;
ÀÀ! "
}
ÁÁ 
catch
ÂÂ 
(
ÂÂ 
	Exception
ÂÂ 
ex
ÂÂ 
)
ÂÂ  
{
ÃÃ 
FDebug
ÄÄ 
.
ÄÄ 
throwException
ÄÄ %
(
ÄÄ% &
ex
ÄÄ& (
)
ÄÄ( )
;
ÄÄ) *
}
ÅÅ 
finally
ÆÆ 
{
ÇÇ 
}
ÉÉ 
}
ÊÊ 	
public
ÎÎ 
bool
ÎÎ 
timeout
ÎÎ 
(
ÎÎ 
)
ÏÏ 
{
ĞĞ 	
try
ÑÑ 
{
ÒÒ 
return
ÓÓ 
m_fTimer
ÓÓ 
.
ÓÓ  
elasped
ÓÓ  '
(
ÓÓ' (
false
ÓÓ( -
)
ÓÓ- .
;
ÓÓ. /
}
ÔÔ 
catch
ÕÕ 
(
ÕÕ 
	Exception
ÕÕ 
ex
ÕÕ 
)
ÕÕ  
{
ÖÖ 
FDebug
×× 
.
×× 
throwException
×× %
(
××% &
ex
××& (
)
××( )
;
××) *
}
ØØ 
finally
ÙÙ 
{
ÚÚ 
}
ÜÜ 
return
İİ 
false
İİ 
;
İİ 
}
ŞŞ 	
}
ää 
}åå ¨µ
zD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Protocol\HSMS\c_FHsmsPassive.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
internal 
class 
FHsmsPassive 
:  !
	FBaseHsms" +
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FHsmsRecvBuffer 

m_fRecvBuf  *
=+ ,
null- 1
;1 2
private 
FTcpListener 
m_fTcpListener +
=, -
null. 2
;2 3
private 

FTcpClient 
m_fTcpClient '
=( )
null* .
;. /
private 
	FCodeLock 
m_fMainSync %
=& '
null( ,
;, -
private   
FThread   

m_fThdMain   "
=  # $
null  % )
;  ) *
private!! 
FStaticTimer!! 
m_fTmrLinktest!! +
=!!, -
null!!. 2
;!!2 3
private"" 
FStaticTimer"" 
m_fTmrT7"" %
=""& '
null""( ,
;"", -
private## 
FStaticTimer## 
m_fTmrT8## %
=##& '
null##( ,
;##, -
private$$ *
FHsmsControlMessageTransaction$$ .
m_fTranLinktestReq$$/ A
=$$B C
null$$D H
;$$H I
private&& 
FStaticTimer&& %
m_fTmrHsmsPassive2Cleanup&& 6
=&&7 8
null&&9 =
;&&= >
private'' 
List'' 
<'' 
FHsmsPassive2'' "
>''" #
m_fHsmsPassive2List''$ 7
=''8 9
null'': >
;''> ?
public-- 
FHsmsPassive-- 
(-- 
FSecs1ToHsms.. 
fSecs1ToHsms.. %
)// 
:00 
base00 
(00 
fSecs1ToHsms00 
)00  
{11 	
init22 
(22 
)22 
;22 
}33 	
~77 	
FHsmsPassive77	 
(77 
)88 
{99 	
	myDispose:: 
(:: 
false:: 
):: 
;:: 
};; 	
	protected?? 
override?? 
void?? 
	myDispose??  )
(??) *
bool@@ 
	disposing@@ 
)AA 
{BB 	
ifCC 
(CC 
!CC 

m_disposedCC 
)CC 
{DD 
ifEE 
(EE 
	disposingEE 
)EE 
{FF 
termGG 
(GG 
)GG 
;GG 
}HH 

m_disposedII 
=II 
trueII !
;II! "
baseMM 
.MM 
	myDisposeMM 
(MM 
	disposingMM (
)MM( )
;MM) *
}NN 
}OO 	
publicWW 
voidWW 
DisposeWW 
(WW 
)XX 
{YY 	
	myDisposeZZ 
(ZZ 
trueZZ 
)ZZ 
;ZZ 
GC[[ 
.[[ 
SuppressFinalize[[ 
([[  
this[[  $
)[[$ %
;[[% &
}\\ 	
privatell 
voidll 
initll 
(ll 
)mm 
{nn 	
tryoo 
{pp 
m_fTmrLinktestqq 
=qq  
newqq! $
FStaticTimerqq% 1
(qq1 2
)qq2 3
;qq3 4
m_fTmrT7rr 
=rr 
newrr 
FStaticTimerrr +
(rr+ ,
)rr, -
;rr- .
m_fTmrT8ss 
=ss 
newss 
FStaticTimerss +
(ss+ ,
)ss, -
;ss- .
m_fTranLinktestReqtt "
=tt# $
newtt% (*
FHsmsControlMessageTransactiontt) G
(ttG H
thisttH L
.ttL M
fSecs1ToHsmsttM Y
)ttY Z
;ttZ [

m_fRecvBufuu 
=uu 
newuu  
FHsmsRecvBufferuu! 0
(uu0 1
)uu1 2
;uu2 3%
m_fTmrHsmsPassive2Cleanupyy )
=yy* +
newyy, /
FStaticTimeryy0 <
(yy< =
)yy= >
;yy> ?%
m_fTmrHsmsPassive2Cleanupzz )
.zz) *
startzz* /
(zz/ 0
$numzz0 4
*zz5 6
$numzz7 9
)zz9 :
;zz: ;
m_fHsmsPassive2List|| #
=||$ %
new||& )
List||* .
<||. /
FHsmsPassive2||/ <
>||< =
(||= >
)||> ?
;||? @
m_fMainSync
 
=
 
new
 !
	FCodeLock
" +
(
+ ,
)
, -
;
- .

m_fThdMain
‚‚ 
=
‚‚ 
new
‚‚  
FThread
‚‚! (
(
‚‚( )
$str
‚‚) A
)
‚‚A B
;
‚‚B C

m_fThdMain
ƒƒ 
.
ƒƒ 
ThreadJobCalled
ƒƒ *
+=
ƒƒ+ -
new
ƒƒ. 1*
FThreadJobCalledEventHandler
ƒƒ2 N
(
ƒƒN O(
m_fThdMain_ThreadJobCalled
ƒƒO i
)
ƒƒi j
;
ƒƒj k

m_fThdMain
„„ 
.
„„ 
start
„„  
(
„„  !
)
„„! "
;
„„" #
}
…… 
catch
†† 
(
†† 
	Exception
†† 
ex
†† 
)
††  
{
‡‡ 
FDebug
ˆˆ 
.
ˆˆ 
throwException
ˆˆ %
(
ˆˆ% &
ex
ˆˆ& (
)
ˆˆ( )
;
ˆˆ) *
}
‰‰ 
finally
ŠŠ 
{
‹‹ 
}
 
}
 	
private
’’ 
void
’’ 
term
’’ 
(
’’ 
)
““ 
{
”” 	
try
•• 
{
–– 
if
—— 
(
—— 

m_fThdMain
—— 
!=
—— !
null
——" &
)
——& '
{
˜˜ 

m_fThdMain
™™ 
.
™™ 
stop
™™ #
(
™™# $
)
™™$ %
;
™™% &

m_fThdMain
šš 
.
šš 
Dispose
šš &
(
šš& '
)
šš' (
;
šš( )

m_fThdMain
›› 
.
›› 
ThreadJobCalled
›› .
-=
››/ 1
new
››2 5*
FThreadJobCalledEventHandler
››6 R
(
››R S(
m_fThdMain_ThreadJobCalled
››S m
)
››m n
;
››n o

m_fThdMain
œœ 
=
œœ  
null
œœ! %
;
œœ% &
}
 
if
ŸŸ 
(
ŸŸ 
m_fTcpListener
ŸŸ "
!=
ŸŸ# %
null
ŸŸ& *
)
ŸŸ* +
{
   
m_fTcpListener
¡¡ "
.
¡¡" #
stop
¡¡# '
(
¡¡' (
)
¡¡( )
;
¡¡) *
m_fTcpListener
¢¢ "
.
¢¢" #
Dispose
¢¢# *
(
¢¢* +
)
¢¢+ ,
;
¢¢, -
m_fTcpListener
¤¤ "
.
¤¤" #(
TcpListenerAcceptCompleted
¤¤# =
-=
¤¤> @
new
¤¤A D5
'FTcpListenerAcceptCompletedEventHandler
¤¤E l
(
¤¤l m8
)m_fTcpListener_TcpListenerAcceptCompleted¤¤m –
)¤¤– —
;¤¤— ˜
m_fTcpListener
¥¥ "
.
¥¥" #$
TcpListenerErrorRaised
¥¥# 9
-=
¥¥: <
new
¥¥= @1
#FTcpListenerErrorRaisedEventHandler
¥¥A d
(
¥¥d e4
%m_fTcpListener_TcpListenerErrorRaised¥¥e Š
)¥¥Š ‹
;¥¥‹ Œ
m_fTcpListener
§§ "
=
§§# $
null
§§% )
;
§§) *
}
¨¨ 
if
ªª 
(
ªª 
m_fTcpClient
ªª  
!=
ªª! #
null
ªª$ (
)
ªª( )
{
«« 
m_fTcpClient
¬¬  
.
¬¬  !
close
¬¬! &
(
¬¬& '
)
¬¬' (
;
¬¬( )
m_fTcpClient
­­  
.
­­  !
Dispose
­­! (
(
­­( )
)
­­) *
;
­­* +
m_fTcpClient
¯¯  
.
¯¯  !#
TcpClientStateChanged
¯¯! 6
-=
¯¯7 9
new
¯¯: =0
"FTcpClientStateChangedEventHandler
¯¯> `
(
¯¯` a1
"m_fTcpClient_TcpClientStateChanged¯¯a ƒ
)¯¯ƒ „
;¯¯„ …
m_fTcpClient
°°  
.
°°  !#
TcpClientDataReceived
°°! 6
-=
°°7 9
new
°°: =0
"FTcpClientDataReceivedEventHandler
°°> `
(
°°` a1
"m_fTcpClient_TcpClientDataReceived°°a ƒ
)°°ƒ „
;°°„ …
m_fTcpClient
±±  
.
±±  !
TcpClientDataSent
±±! 2
-=
±±3 5
new
±±6 9,
FTcpClientDataSentEventHandler
±±: X
(
±±X Y,
m_fTcpClient_TcpClientDataSent
±±Y w
)
±±w x
;
±±x y
m_fTcpClient
²²  
.
²²  !%
TcpClientDataSendFailed
²²! 8
-=
²²9 ;
new
²²< ?2
$FTcpClientDataSendFailedEventHandler
²²@ d
(
²²d e3
$m_fTcpClient_TcpClientDataSendFailed²²e ‰
)²²‰ Š
;²²Š ‹
m_fTcpClient
³³  
.
³³  !"
TcpClientErrorRaised
³³! 5
-=
³³6 8
new
³³9 </
!FTcpClientErrorRaisedEventHandler
³³= ^
(
³³^ _0
!m_fTcpClient_TcpClientErrorRaised³³_ €
)³³€ 
;³³ ‚
m_fTcpClient
µµ  
=
µµ! "
null
µµ# '
;
µµ' (
}
¶¶ "
closeAllHsmsPassvie2
ºº $
(
ºº$ %
)
ºº% &
;
ºº& '
if
¼¼ 
(
¼¼ '
m_fTmrHsmsPassive2Cleanup
¼¼ -
!=
¼¼. 0
null
¼¼1 5
)
¼¼5 6
{
½½ '
m_fTmrHsmsPassive2Cleanup
¾¾ -
.
¾¾- .
Dispose
¾¾. 5
(
¾¾5 6
)
¾¾6 7
;
¾¾7 8'
m_fTmrHsmsPassive2Cleanup
¿¿ -
=
¿¿. /
null
¿¿0 4
;
¿¿4 5!
m_fHsmsPassive2List
ÁÁ '
=
ÁÁ( )
null
ÁÁ* .
;
ÁÁ. /
}
ÂÂ 
if
ÆÆ 
(
ÆÆ 
m_fTmrLinktest
ÆÆ "
!=
ÆÆ# %
null
ÆÆ& *
)
ÆÆ* +
{
ÇÇ 
m_fTmrLinktest
ÈÈ "
.
ÈÈ" #
Dispose
ÈÈ# *
(
ÈÈ* +
)
ÈÈ+ ,
;
ÈÈ, -
m_fTmrLinktest
ÉÉ "
=
ÉÉ# $
null
ÉÉ% )
;
ÉÉ) *
}
ÊÊ 
if
ÌÌ 
(
ÌÌ 
m_fTmrT7
ÌÌ 
!=
ÌÌ 
null
ÌÌ  $
)
ÌÌ$ %
{
ÍÍ 
m_fTmrT7
ÎÎ 
.
ÎÎ 
Dispose
ÎÎ $
(
ÎÎ$ %
)
ÎÎ% &
;
ÎÎ& '
m_fTmrT7
ÏÏ 
=
ÏÏ 
null
ÏÏ #
;
ÏÏ# $
}
ĞĞ 
if
ÒÒ 
(
ÒÒ 
m_fTmrT8
ÒÒ 
!=
ÒÒ 
null
ÒÒ  $
)
ÒÒ$ %
{
ÓÓ 
m_fTmrT8
ÔÔ 
.
ÔÔ 
Dispose
ÔÔ $
(
ÔÔ$ %
)
ÔÔ% &
;
ÔÔ& '
m_fTmrT8
ÕÕ 
=
ÕÕ 
null
ÕÕ #
;
ÕÕ# $
}
ÖÖ 
if
ØØ 
(
ØØ  
m_fTranLinktestReq
ØØ &
!=
ØØ' )
null
ØØ* .
)
ØØ. /
{
ÙÙ  
m_fTranLinktestReq
ÚÚ &
.
ÚÚ& '
Dispose
ÚÚ' .
(
ÚÚ. /
)
ÚÚ/ 0
;
ÚÚ0 1 
m_fTranLinktestReq
ÛÛ &
=
ÛÛ' (
null
ÛÛ) -
;
ÛÛ- .
}
ÜÜ 
if
ŞŞ 
(
ŞŞ 

m_fRecvBuf
ŞŞ 
!=
ŞŞ !
null
ŞŞ" &
)
ŞŞ& '
{
ßß 

m_fRecvBuf
àà 
.
àà 
Dispose
àà &
(
àà& '
)
àà' (
;
àà( )

m_fRecvBuf
áá 
=
áá  
null
áá! %
;
áá% &
}
ââ 
if
ää 
(
ää 
m_fMainSync
ää 
!=
ää  "
null
ää# '
)
ää' (
{
åå 
m_fMainSync
ææ 
.
ææ  
Dispose
ææ  '
(
ææ' (
)
ææ( )
;
ææ) *
m_fMainSync
çç 
=
çç  !
null
çç" &
;
çç& '
}
èè 
}
éé 
catch
êê 
(
êê 
	Exception
êê 
ex
êê 
)
êê  
{
ëë 
FDebug
ìì 
.
ìì 
throwException
ìì %
(
ìì% &
ex
ìì& (
)
ìì( )
;
ìì) *
}
íí 
finally
îî 
{
ïï 
}
ññ 
}
òò 	
public
öö 
override
öö 
void
öö 
open
öö !
(
öö! "
)
÷÷ 
{
øø 	
try
ùù 
{
úú 
m_fTcpListener
ûû 
=
ûû  
new
ûû! $
FTcpListener
ûû% 1
(
ûû1 2
this
ûû2 6
.
ûû6 7
fSecs1ToHsms
ûû7 C
.
ûûC D
fHsmsConfig
ûûD O
.
ûûO P
localIp
ûûP W
,
ûûW X
this
ûûY ]
.
ûû] ^
fSecs1ToHsms
ûû^ j
.
ûûj k
fHsmsConfig
ûûk v
.
ûûv w
	localPortûûw €
,ûû€ 
$numûû‚ ƒ
)ûûƒ „
;ûû„ …
m_fTcpListener
ıı 
.
ıı (
TcpListenerAcceptCompleted
ıı 9
+=
ıı: <
new
ıı= @5
'FTcpListenerAcceptCompletedEventHandler
ııA h
(
ııh i8
)m_fTcpListener_TcpListenerAcceptCompletedııi ’
)ıı’ “
;ıı“ ”
m_fTcpListener
şş 
.
şş $
TcpListenerErrorRaised
şş 5
+=
şş6 8
new
şş9 <1
#FTcpListenerErrorRaisedEventHandler
şş= `
(
şş` a4
%m_fTcpListener_TcpListenerErrorRaisedşşa †
)şş† ‡
;şş‡ ˆ
m_fTcpListener
€€ 
.
€€ 
start
€€ $
(
€€$ %
)
€€% &
;
€€& '
this
„„ 
.
„„ 
fSecs1ToHsms
„„ !
.
„„! "
changeHsmsState
„„" 1
(
„„1 2
FConnectMode
„„2 >
.
„„> ?
Passive
„„? F
,
„„F G
this
„„H L
.
„„L M
localIp
„„M T
,
„„T U
this
„„V Z
.
„„Z [
	localPort
„„[ d
,
„„d e
this
„„f j
.
„„j k
remoteIp
„„k s
,
„„s t
this
„„u y
.
„„y z

remotePort„„z „
,„„„ …#
FCommunicationState„„† ™
.„„™ š
Opened„„š  
)„„  ¡
;„„¡ ¢
}
…… 
catch
†† 
(
†† 
	Exception
†† 
ex
†† 
)
††  
{
‡‡ 
FDebug
ˆˆ 
.
ˆˆ 
throwException
ˆˆ %
(
ˆˆ% &
ex
ˆˆ& (
)
ˆˆ( )
;
ˆˆ) *
}
‰‰ 
finally
ŠŠ 
{
‹‹ 
}
 
}
 	
public
’’ 
override
’’ 
void
’’ 
close
’’ "
(
’’" #
)
““ 
{
”” 	
try
•• 
{
–– 
m_fTcpListener
—— 
.
—— 
stop
—— #
(
——# $
)
——$ %
;
——% &
m_fTcpListener
˜˜ 
.
˜˜ 
Dispose
˜˜ &
(
˜˜& '
)
˜˜' (
;
˜˜( )
m_fTcpListener
šš 
.
šš (
TcpListenerAcceptCompleted
šš 9
-=
šš: <
new
šš= @5
'FTcpListenerAcceptCompletedEventHandler
ššA h
(
ššh i8
)m_fTcpListener_TcpListenerAcceptCompletedšši ’
)šš’ “
;šš“ ”
m_fTcpListener
›› 
.
›› $
TcpListenerErrorRaised
›› 5
-=
››6 8
new
››9 <1
#FTcpListenerErrorRaisedEventHandler
››= `
(
››` a4
%m_fTcpListener_TcpListenerErrorRaised››a †
)››† ‡
;››‡ ˆ
m_fTcpListener
 
=
  
null
! %
;
% &
closeTcpClient
¡¡ 
(
¡¡ 
)
¡¡  
;
¡¡  !
resetResource
¢¢ 
(
¢¢ 
)
¢¢ 
;
¢¢  
this
¦¦ 
.
¦¦ 
fSecs1ToHsms
¦¦ !
.
¦¦! "
changeHsmsState
¦¦" 1
(
¦¦1 2
FConnectMode
¦¦2 >
.
¦¦> ?
Passive
¦¦? F
,
¦¦F G
this
¦¦H L
.
¦¦L M
localIp
¦¦M T
,
¦¦T U
this
¦¦V Z
.
¦¦Z [
	localPort
¦¦[ d
,
¦¦d e
this
¦¦f j
.
¦¦j k
remoteIp
¦¦k s
,
¦¦s t
this
¦¦u y
.
¦¦y z

remotePort¦¦z „
,¦¦„ …#
FCommunicationState¦¦† ™
.¦¦™ š
Closed¦¦š  
)¦¦  ¡
;¦¦¡ ¢
}
§§ 
catch
¨¨ 
(
¨¨ 
	Exception
¨¨ 
ex
¨¨ 
)
¨¨  
{
©© 
FDebug
ªª 
.
ªª 
throwException
ªª %
(
ªª% &
ex
ªª& (
)
ªª( )
;
ªª) *
}
«« 
finally
¬¬ 
{
­­ 
}
¯¯ 
}
°° 	
public
´´ 
override
´´ 
void
´´ 
send
´´ !
(
´´! "
FSecsDataMessage
µµ 
fSecsDataMessage
µµ -
)
¶¶ 
{
·· 	
try
¸¸ 
{
¹¹ 
sendDataMessage
ºº 
(
ºº  
fSecsDataMessage
ºº  0
)
ºº0 1
;
ºº1 2
}
»» 
catch
¼¼ 
(
¼¼ 
	Exception
¼¼ 
ex
¼¼ 
)
¼¼  
{
½½ 
FDebug
¾¾ 
.
¾¾ 
throwException
¾¾ %
(
¾¾% &
ex
¾¾& (
)
¾¾( )
;
¾¾) *
}
¿¿ 
finally
ÀÀ 
{
ÁÁ 
}
ÃÃ 
}
ÄÄ 	
private
ÈÈ 
void
ÈÈ "
closeAllHsmsPassvie2
ÈÈ )
(
ÈÈ) *
)
ÉÉ 
{
ÊÊ 	
try
ËË 
{
ÌÌ 
foreach
ÍÍ 
(
ÍÍ 
FHsmsPassive2
ÍÍ &
hp
ÍÍ' )
in
ÍÍ* ,!
m_fHsmsPassive2List
ÍÍ- @
)
ÍÍ@ A
{
ÎÎ 
hp
ÏÏ 
.
ÏÏ 
Dispose
ÏÏ 
(
ÏÏ 
)
ÏÏ  
;
ÏÏ  !
}
ĞĞ !
m_fHsmsPassive2List
ÑÑ #
.
ÑÑ# $
Clear
ÑÑ$ )
(
ÑÑ) *
)
ÑÑ* +
;
ÑÑ+ ,
}
ÒÒ 
catch
ÓÓ 
(
ÓÓ 
	Exception
ÓÓ 
ex
ÓÓ 
)
ÓÓ  
{
ÔÔ 
FDebug
ÕÕ 
.
ÕÕ 
throwException
ÕÕ %
(
ÕÕ% &
ex
ÕÕ& (
)
ÕÕ( )
;
ÕÕ) *
}
ÖÖ 
finally
×× 
{
ØØ 
}
ÚÚ 
}
ÛÛ 	
private
ßß 
void
ßß !
cleanUpHsmsPassive2
ßß (
(
ßß( )
)
àà 
{
áá 	
List
ââ 
<
ââ 
int
ââ 
>
ââ 
	indexList
ââ 
=
ââ  !
null
ââ" &
;
ââ& '
try
ää 
{
åå 
if
ææ 
(
ææ !
m_fHsmsPassive2List
ææ '
.
ææ' (
Count
ææ( -
==
ææ. 0
$num
ææ1 2
)
ææ2 3
{
çç 
return
èè 
;
èè 
}
éé 
	indexList
íí 
=
íí 
new
íí 
List
íí  $
<
íí$ %
int
íí% (
>
íí( )
(
íí) *
)
íí* +
;
íí+ ,
for
ïï 
(
ïï 
int
ïï 
i
ïï 
=
ïï !
m_fHsmsPassive2List
ïï 0
.
ïï0 1
Count
ïï1 6
-
ïï7 8
$num
ïï9 :
;
ïï: ;
i
ïï< =
>=
ïï> @
$num
ïïA B
;
ïïB C
i
ïïD E
--
ïïE G
)
ïïG H
{
ğğ 
if
ññ 
(
ññ !
m_fHsmsPassive2List
ññ +
[
ññ+ ,
i
ññ, -
]
ññ- .
.
ññ. /
fState
ññ/ 5
==
ññ6 8!
FCommunicationState
ññ9 L
.
ññL M
Closed
ññM S
)
ññS T
{
òò 
	indexList
óó !
.
óó! "
Add
óó" %
(
óó% &
i
óó& '
)
óó' (
;
óó( )
}
ôô 
}
õõ 
foreach
ùù 
(
ùù 
int
ùù 
index
ùù "
in
ùù# %
	indexList
ùù& /
)
ùù/ 0
{
úú !
m_fHsmsPassive2List
ûû '
[
ûû' (
index
ûû( -
]
ûû- .
.
ûû. /
Dispose
ûû/ 6
(
ûû6 7
)
ûû7 8
;
ûû8 9!
m_fHsmsPassive2List
üü '
.
üü' (
RemoveAt
üü( 0
(
üü0 1
index
üü1 6
)
üü6 7
;
üü7 8
}
ıı 
}
şş 
catch
ÿÿ 
(
ÿÿ 
	Exception
ÿÿ 
ex
ÿÿ 
)
ÿÿ  
{
€€ 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
‚‚ 
finally
ƒƒ 
{
„„ 
	indexList
…… 
=
…… 
null
……  
;
……  !
}
†† 
}
‡‡ 	
private
‹‹ 
void
‹‹ 
resetResource
‹‹ "
(
‹‹" #
)
ŒŒ 
{
 	
try
 
{
 
m_fTmrLinktest
““ 
.
““ 
stop
““ #
(
““# $
)
““$ %
;
““% &
m_fTmrT7
”” 
.
”” 
stop
”” 
(
”” 
)
”” 
;
””  
m_fTmrT8
•• 
.
•• 
stop
•• 
(
•• 
)
•• 
;
••   
m_fTranLinktestReq
–– "
.
––" #
reset
––# (
(
––( )
)
––) *
;
––* +

m_fRecvBuf
—— 
.
—— 
clear
——  
(
——  !
)
——! "
;
——" #
}
˜˜ 
catch
™™ 
(
™™ 
	Exception
™™ 
ex
™™ 
)
™™  
{
šš 
FDebug
›› 
.
›› 
throwException
›› %
(
››% &
ex
››& (
)
››( )
;
››) *
}
œœ 
finally
 
{
 
}
   
}
¡¡ 	
private
¥¥ 
void
¥¥ 
closeTcpClient
¥¥ #
(
¥¥# $
)
¦¦ 
{
§§ 	
try
¨¨ 
{
©© 
if
ªª 
(
ªª 
m_fTcpClient
ªª  
==
ªª! #
null
ªª$ (
)
ªª( )
{
«« 
return
¬¬ 
;
¬¬ 
}
­­ 
if
±± 
(
±± 
m_fTcpClient
±±  
.
±±  !
fState
±±! '
==
±±( *
FTcpClientState
±±+ :
.
±±: ;
	Connected
±±; D
)
±±D E
{
²² 
if
³³ 
(
³³ 
this
³³ 
.
³³ 
fSecs1ToHsms
³³ )
.
³³) *

fHsmsState
³³* 4
==
³³5 7!
FCommunicationState
³³8 K
.
³³K L
Selected
³³L T
)
³³T U
{
´´ 
while
µµ 
(
µµ 
this
µµ #
.
µµ# $
fSecs1ToHsms
µµ$ 0
.
µµ0 1
fEventPusher
µµ1 =
.
µµ= >
hsmsEventCount
µµ> L
>
µµM N
$num
µµO P
||
µµQ S
!
µµT U
m_fTcpClient
µµU a
.
µµa b
sendCompleted
µµb o
)
µµo p
{
¶¶ 
if
·· 
(
··  
System
··  &
.
··& '
Windows
··' .
.
··. /
Forms
··/ 4
.
··4 5
Application
··5 @
.
··@ A
MessageLoop
··A L
)
··L M
{
¸¸ 
System
¹¹  &
.
¹¹& '
Windows
¹¹' .
.
¹¹. /
Forms
¹¹/ 4
.
¹¹4 5
Application
¹¹5 @
.
¹¹@ A
DoEvents
¹¹A I
(
¹¹I J
)
¹¹J K
;
¹¹K L
}
ºº 
System
»» "
.
»»" #
	Threading
»»# ,
.
»», -
Thread
»»- 3
.
»»3 4
Sleep
»»4 9
(
»»9 :
$num
»»: ;
)
»»; <
;
»»< =
}
¼¼ 
}
½½ 
sendSeparateReq
¿¿ #
(
¿¿# $
)
¿¿$ %
;
¿¿% &
}
ÀÀ 
m_fTcpClient
ÄÄ 
.
ÄÄ 
close
ÄÄ "
(
ÄÄ" #
)
ÄÄ# $
;
ÄÄ$ %
m_fTcpClient
ÅÅ 
.
ÅÅ 
Dispose
ÅÅ $
(
ÅÅ$ %
)
ÅÅ% &
;
ÅÅ& '
m_fTcpClient
ÇÇ 
.
ÇÇ #
TcpClientStateChanged
ÇÇ 2
-=
ÇÇ3 5
new
ÇÇ6 90
"FTcpClientStateChangedEventHandler
ÇÇ: \
(
ÇÇ\ ]0
"m_fTcpClient_TcpClientStateChanged
ÇÇ] 
)ÇÇ €
;ÇÇ€ 
m_fTcpClient
ÈÈ 
.
ÈÈ #
TcpClientDataReceived
ÈÈ 2
-=
ÈÈ3 5
new
ÈÈ6 90
"FTcpClientDataReceivedEventHandler
ÈÈ: \
(
ÈÈ\ ]0
"m_fTcpClient_TcpClientDataReceived
ÈÈ] 
)ÈÈ €
;ÈÈ€ 
m_fTcpClient
ÉÉ 
.
ÉÉ 
TcpClientDataSent
ÉÉ .
-=
ÉÉ/ 1
new
ÉÉ2 5,
FTcpClientDataSentEventHandler
ÉÉ6 T
(
ÉÉT U,
m_fTcpClient_TcpClientDataSent
ÉÉU s
)
ÉÉs t
;
ÉÉt u
m_fTcpClient
ÊÊ 
.
ÊÊ %
TcpClientDataSendFailed
ÊÊ 4
-=
ÊÊ5 7
new
ÊÊ8 ;2
$FTcpClientDataSendFailedEventHandler
ÊÊ< `
(
ÊÊ` a3
$m_fTcpClient_TcpClientDataSendFailedÊÊa …
)ÊÊ… †
;ÊÊ† ‡
m_fTcpClient
ËË 
.
ËË "
TcpClientErrorRaised
ËË 1
-=
ËË2 4
new
ËË5 8/
!FTcpClientErrorRaisedEventHandler
ËË9 Z
(
ËËZ [/
!m_fTcpClient_TcpClientErrorRaised
ËË[ |
)
ËË| }
;
ËË} ~
m_fTcpClient
ÍÍ 
=
ÍÍ 
null
ÍÍ #
;
ÍÍ# $
}
ÎÎ 
catch
ÏÏ 
(
ÏÏ 
	Exception
ÏÏ 
ex
ÏÏ 
)
ÏÏ  
{
ĞĞ 
FDebug
ÑÑ 
.
ÑÑ 
throwException
ÑÑ %
(
ÑÑ% &
ex
ÑÑ& (
)
ÑÑ( )
;
ÑÑ) *
}
ÒÒ 
finally
ÓÓ 
{
ÔÔ 
}
ÖÖ 
}
×× 	
private
ÛÛ 
void
ÛÛ 
sendSelectRsp
ÛÛ "
(
ÛÛ" #
UInt16
ÜÜ 
	sessionId
ÜÜ 
,
ÜÜ 
byte
İİ 
status
İİ 
,
İİ 
UInt32
ŞŞ 
systemBytes
ŞŞ 
)
ßß 
{
àà 	
FHsmsSendBuffer
áá 
fBuf
áá  
=
áá! "
null
áá# '
;
áá' (!
FSecsControlMessage
ââ !
fSecsControlMessage
ââ  3
=
ââ4 5
null
ââ6 :
;
ââ: ;
try
ää 
{
åå 
fBuf
ææ 
=
ææ 
new
ææ 
FHsmsSendBuffer
ææ *
(
ææ* +
)
ææ+ ,
;
ææ, -
fBuf
çç 
.
çç 
genSelectRsp
çç !
(
çç! "
	sessionId
çç" +
,
çç+ ,
status
çç- 3
,
çç3 4
systemBytes
çç5 @
)
çç@ A
;
ççA B!
fSecsControlMessage
éé #
=
éé$ %
new
éé& )!
FSecsControlMessage
éé* =
(
éé= >
this
êê 
.
êê 
fSecs1ToHsms
êê %
,
êê% &%
FHsmsControlMessageType
ëë +
.
ëë+ ,
	SelectRsp
ëë, 5
,
ëë5 6
fBuf
ìì 
.
ìì 
	sessionId
ìì "
,
ìì" #
fBuf
íí 
.
íí 
byte2
íí 
,
íí 
fBuf
îî 
.
îî 
byte3
îî 
,
îî 
fBuf
ïï 
.
ïï 
ptype
ïï 
,
ïï 
fBuf
ğğ 
.
ğğ 
stype
ğğ 
,
ğğ 
fBuf
ññ 
.
ññ 
systemBytes
ññ $
,
ññ$ %
string
òò 
.
òò 
Empty
òò  
)
óó 
;
óó 
m_fTcpClient
õõ 
.
õõ 
send
õõ !
(
õõ! "
new
õõ" %
FSocketSendData
õõ& 5
(
õõ5 6
fBuf
õõ6 :
.
õõ: ;
getBinaryData
õõ; H
(
õõH I
)
õõI J
,
õõJ K!
fSecsControlMessage
õõL _
)
õõ_ `
)
õõ` a
;
õõa b
}
öö 
catch
÷÷ 
(
÷÷ 
	Exception
÷÷ 
ex
÷÷ 
)
÷÷  
{
øø !
procHsmsErrorRaised
ùù #
(
ùù# $
ex
ùù$ &
)
ùù& '
;
ùù' (
}
úú 
finally
ûû 
{
üü 
fBuf
ıı 
=
ıı 
null
ıı 
;
ıı !
fSecsControlMessage
şş #
=
şş$ %
null
şş& *
;
şş* +
}
ÿÿ 
}
€€ 	
private
„„ 
void
„„ 
sendDeselectRsp
„„ $
(
„„$ %
UInt16
…… 
	sessionId
…… 
,
…… 
UInt32
†† 
systemBytes
†† 
)
‡‡ 
{
ˆˆ 	
FHsmsSendBuffer
‰‰ 
fBuf
‰‰  
=
‰‰! "
null
‰‰# '
;
‰‰' (!
FSecsControlMessage
ŠŠ !
fSecsControlMessage
ŠŠ  3
=
ŠŠ4 5
null
ŠŠ6 :
;
ŠŠ: ;
try
ŒŒ 
{
 
fBuf
 
=
 
new
 
FHsmsSendBuffer
 *
(
* +
)
+ ,
;
, -
fBuf
 
.
 
genDeselectRsp
 #
(
# $
	sessionId
$ -
,
- .
systemBytes
/ :
)
: ;
;
; <!
fSecsControlMessage
‘‘ #
=
‘‘$ %
new
‘‘& )!
FSecsControlMessage
‘‘* =
(
‘‘= >
this
’’ 
.
’’ 
fSecs1ToHsms
’’ %
,
’’% &%
FHsmsControlMessageType
““ +
.
““+ ,
DeselectRsp
““, 7
,
““7 8
fBuf
”” 
.
”” 
	sessionId
”” "
,
””" #
fBuf
•• 
.
•• 
byte2
•• 
,
•• 
fBuf
–– 
.
–– 
byte3
–– 
,
–– 
fBuf
—— 
.
—— 
ptype
—— 
,
—— 
fBuf
˜˜ 
.
˜˜ 
stype
˜˜ 
,
˜˜ 
fBuf
™™ 
.
™™ 
systemBytes
™™ $
,
™™$ %
string
šš 
.
šš 
Empty
šš  
)
›› 
;
›› 
m_fTcpClient
 
.
 
send
 !
(
! "
new
" %
FSocketSendData
& 5
(
5 6
fBuf
6 :
.
: ;
getBinaryData
; H
(
H I
)
I J
,
J K!
fSecsControlMessage
L _
)
_ `
)
` a
;
a b
}
 
catch
ŸŸ 
(
ŸŸ 
	Exception
ŸŸ 
ex
ŸŸ 
)
ŸŸ  
{
   !
procHsmsErrorRaised
¡¡ #
(
¡¡# $
ex
¡¡$ &
)
¡¡& '
;
¡¡' (
}
¢¢ 
finally
££ 
{
¤¤ 
fBuf
¥¥ 
=
¥¥ 
null
¥¥ 
;
¥¥ !
fSecsControlMessage
¦¦ #
=
¦¦$ %
null
¦¦& *
;
¦¦* +
}
§§ 
}
¨¨ 	
private
¬¬ 
void
¬¬ 
sendLinktestReq
¬¬ $
(
¬¬$ %
)
­­ 
{
®® 	
FHsmsSendBuffer
¯¯ 
fBuf
¯¯  
=
¯¯! "
null
¯¯# '
;
¯¯' (!
FSecsControlMessage
°° !
fSecsControlMessage
°°  3
=
°°4 5
null
°°6 :
;
°°: ;
try
²² 
{
³³ 
fBuf
´´ 
=
´´ 
new
´´ 
FHsmsSendBuffer
´´ *
(
´´* +
)
´´+ ,
;
´´, -
fBuf
µµ 
.
µµ 
genLinktestReq
µµ #
(
µµ# $
this
µµ$ (
.
µµ( )!
fSystemBytesPointer
µµ) <
.
µµ< =
uniqueId
µµ= E
)
µµE F
;
µµF G!
fSecsControlMessage
·· #
=
··$ %
new
··& )!
FSecsControlMessage
··* =
(
··= >
this
¸¸ 
.
¸¸ 
fSecs1ToHsms
¸¸ %
,
¸¸% &%
FHsmsControlMessageType
¹¹ +
.
¹¹+ ,
LinktestReq
¹¹, 7
,
¹¹7 8
fBuf
ºº 
.
ºº 
	sessionId
ºº "
,
ºº" #
fBuf
»» 
.
»» 
byte2
»» 
,
»» 
fBuf
¼¼ 
.
¼¼ 
byte3
¼¼ 
,
¼¼ 
fBuf
½½ 
.
½½ 
ptype
½½ 
,
½½ 
fBuf
¾¾ 
.
¾¾ 
stype
¾¾ 
,
¾¾ 
fBuf
¿¿ 
.
¿¿ 
systemBytes
¿¿ $
,
¿¿$ %
string
ÀÀ 
.
ÀÀ 
Empty
ÀÀ  
)
ÁÁ 
;
ÁÁ 
m_fTcpClient
ÃÃ 
.
ÃÃ 
send
ÃÃ !
(
ÃÃ! "
new
ÃÃ" %
FSocketSendData
ÃÃ& 5
(
ÃÃ5 6
fBuf
ÃÃ6 :
.
ÃÃ: ;
getBinaryData
ÃÃ; H
(
ÃÃH I
)
ÃÃI J
,
ÃÃJ K!
fSecsControlMessage
ÃÃL _
)
ÃÃ_ `
)
ÃÃ` a
;
ÃÃa b 
m_fTranLinktestReq
ÊÊ "
.
ÊÊ" #
set
ÊÊ# &
(
ÊÊ& '
fBuf
ÊÊ' +
.
ÊÊ+ ,
	sessionId
ÊÊ, 5
,
ÊÊ5 6
fBuf
ÊÊ7 ;
.
ÊÊ; <
systemBytes
ÊÊ< G
)
ÊÊG H
;
ÊÊH I
}
ËË 
catch
ÌÌ 
(
ÌÌ 
	Exception
ÌÌ 
ex
ÌÌ 
)
ÌÌ  
{
ÍÍ !
procHsmsErrorRaised
ÎÎ #
(
ÎÎ# $
ex
ÎÎ$ &
)
ÎÎ& '
;
ÎÎ' (
}
ÏÏ 
finally
ĞĞ 
{
ÑÑ 
fBuf
ÒÒ 
=
ÒÒ 
null
ÒÒ 
;
ÒÒ !
fSecsControlMessage
ÓÓ #
=
ÓÓ$ %
null
ÓÓ& *
;
ÓÓ* +
}
ÔÔ 
}
ÕÕ 	
private
ÙÙ 
void
ÙÙ 
sendLinktestRsp
ÙÙ $
(
ÙÙ$ %
UInt16
ÚÚ 
	sessionId
ÚÚ 
,
ÚÚ 
UInt32
ÛÛ 
systemBytes
ÛÛ 
)
ÜÜ 
{
İİ 	
FHsmsSendBuffer
ŞŞ 
fBuf
ŞŞ  
=
ŞŞ! "
null
ŞŞ# '
;
ŞŞ' (!
FSecsControlMessage
ßß !
fSecsControlMessage
ßß  3
=
ßß4 5
null
ßß6 :
;
ßß: ;
try
áá 
{
ââ 
fBuf
ãã 
=
ãã 
new
ãã 
FHsmsSendBuffer
ãã *
(
ãã* +
)
ãã+ ,
;
ãã, -
fBuf
ää 
.
ää 
genLinktestRsp
ää #
(
ää# $
	sessionId
ää$ -
,
ää- .
systemBytes
ää/ :
)
ää: ;
;
ää; <!
fSecsControlMessage
ææ #
=
ææ$ %
new
ææ& )!
FSecsControlMessage
ææ* =
(
ææ= >
this
çç 
.
çç 
fSecs1ToHsms
çç %
,
çç% &%
FHsmsControlMessageType
èè +
.
èè+ ,
LinktestRsp
èè, 7
,
èè7 8
fBuf
éé 
.
éé 
	sessionId
éé "
,
éé" #
fBuf
êê 
.
êê 
byte2
êê 
,
êê 
fBuf
ëë 
.
ëë 
byte3
ëë 
,
ëë 
fBuf
ìì 
.
ìì 
ptype
ìì 
,
ìì 
fBuf
íí 
.
íí 
stype
íí 
,
íí 
fBuf
îî 
.
îî 
systemBytes
îî $
,
îî$ %
string
ïï 
.
ïï 
Empty
ïï  
)
ğğ 
;
ğğ 
m_fTcpClient
òò 
.
òò 
send
òò !
(
òò! "
new
òò" %
FSocketSendData
òò& 5
(
òò5 6
fBuf
òò6 :
.
òò: ;
getBinaryData
òò; H
(
òòH I
)
òòI J
,
òòJ K!
fSecsControlMessage
òòL _
)
òò_ `
)
òò` a
;
òòa b
}
óó 
catch
ôô 
(
ôô 
	Exception
ôô 
ex
ôô 
)
ôô  
{
õõ !
procHsmsErrorRaised
öö #
(
öö# $
ex
öö$ &
)
öö& '
;
öö' (
}
÷÷ 
finally
øø 
{
ùù 
fBuf
úú 
=
úú 
null
úú 
;
úú !
fSecsControlMessage
ûû #
=
ûû$ %
null
ûû& *
;
ûû* +
}
üü 
}
ıı 	
private
 
void
 
sendRejectReq
 "
(
" #
UInt16
‚‚ 
	sessionId
‚‚ 
,
‚‚ 
byte
ƒƒ 
stype
ƒƒ 
,
ƒƒ 
byte
„„ 

reasonCode
„„ 
,
„„ 
UInt32
…… 
systemBytes
…… 
)
†† 
{
‡‡ 	
FHsmsSendBuffer
ˆˆ 
fBuf
ˆˆ  
=
ˆˆ! "
null
ˆˆ# '
;
ˆˆ' (!
FSecsControlMessage
‰‰ !
fSecsControlMessage
‰‰  3
=
‰‰4 5
null
‰‰6 :
;
‰‰: ;
try
‹‹ 
{
ŒŒ 
fBuf
 
=
 
new
 
FHsmsSendBuffer
 *
(
* +
)
+ ,
;
, -
fBuf
 
.
 
genRejectReq
 !
(
! "
	sessionId
" +
,
+ ,
stype
- 2
,
2 3

reasonCode
4 >
,
> ?
systemBytes
@ K
)
K L
;
L M!
fSecsControlMessage
 #
=
$ %
new
& )!
FSecsControlMessage
* =
(
= >
this
‘‘ 
.
‘‘ 
fSecs1ToHsms
‘‘ %
,
‘‘% &%
FHsmsControlMessageType
’’ +
.
’’+ ,
	RejectReq
’’, 5
,
’’5 6
fBuf
““ 
.
““ 
	sessionId
““ "
,
““" #
fBuf
”” 
.
”” 
byte2
”” 
,
”” 
fBuf
•• 
.
•• 
byte3
•• 
,
•• 
fBuf
–– 
.
–– 
ptype
–– 
,
–– 
fBuf
—— 
.
—— 
stype
—— 
,
—— 
fBuf
˜˜ 
.
˜˜ 
systemBytes
˜˜ $
,
˜˜$ %
string
™™ 
.
™™ 
Empty
™™  
)
šš 
;
šš 
m_fTcpClient
œœ 
.
œœ 
send
œœ !
(
œœ! "
new
œœ" %
FSocketSendData
œœ& 5
(
œœ5 6
fBuf
œœ6 :
.
œœ: ;
getBinaryData
œœ; H
(
œœH I
)
œœI J
,
œœJ K!
fSecsControlMessage
œœL _
)
œœ_ `
)
œœ` a
;
œœa b
}
 
catch
 
(
 
	Exception
 
ex
 
)
  
{
ŸŸ !
procHsmsErrorRaised
   #
(
  # $
ex
  $ &
)
  & '
;
  ' (
}
¡¡ 
finally
¢¢ 
{
££ 
fBuf
¤¤ 
=
¤¤ 
null
¤¤ 
;
¤¤ !
fSecsControlMessage
¥¥ #
=
¥¥$ %
null
¥¥& *
;
¥¥* +
}
¦¦ 
}
§§ 	
private
«« 
void
«« 
sendSeparateReq
«« $
(
««$ %
)
¬¬ 
{
­­ 	
FHsmsSendBuffer
®® 
fBuf
®®  
=
®®! "
null
®®# '
;
®®' (!
FSecsControlMessage
¯¯ !
fSecsControlMessage
¯¯  3
=
¯¯4 5
null
¯¯6 :
;
¯¯: ;
try
±± 
{
²² 
fBuf
³³ 
=
³³ 
new
³³ 
FHsmsSendBuffer
³³ *
(
³³* +
)
³³+ ,
;
³³, -
fBuf
´´ 
.
´´ 
genSeparateReq
´´ #
(
´´# $
this
´´$ (
.
´´( )!
fSystemBytesPointer
´´) <
.
´´< =
uniqueId
´´= E
)
´´E F
;
´´F G!
fSecsControlMessage
¶¶ #
=
¶¶$ %
new
¶¶& )!
FSecsControlMessage
¶¶* =
(
¶¶= >
this
·· 
.
·· 
fSecs1ToHsms
·· %
,
··% &%
FHsmsControlMessageType
¸¸ +
.
¸¸+ ,
SeparateReq
¸¸, 7
,
¸¸7 8
fBuf
¹¹ 
.
¹¹ 
	sessionId
¹¹ "
,
¹¹" #
fBuf
ºº 
.
ºº 
byte2
ºº 
,
ºº 
fBuf
»» 
.
»» 
byte3
»» 
,
»» 
fBuf
¼¼ 
.
¼¼ 
ptype
¼¼ 
,
¼¼ 
fBuf
½½ 
.
½½ 
stype
½½ 
,
½½ 
fBuf
¾¾ 
.
¾¾ 
systemBytes
¾¾ $
,
¾¾$ %
string
¿¿ 
.
¿¿ 
Empty
¿¿  
)
ÀÀ 
;
ÀÀ 
m_fTcpClient
ÂÂ 
.
ÂÂ 
send
ÂÂ !
(
ÂÂ! "
new
ÂÂ" %
FSocketSendData
ÂÂ& 5
(
ÂÂ5 6
fBuf
ÂÂ6 :
.
ÂÂ: ;
getBinaryData
ÂÂ; H
(
ÂÂH I
)
ÂÂI J
,
ÂÂJ K!
fSecsControlMessage
ÂÂL _
)
ÂÂ_ `
)
ÂÂ` a
;
ÂÂa b
}
ÃÃ 
catch
ÄÄ 
(
ÄÄ 
	Exception
ÄÄ 
ex
ÄÄ 
)
ÄÄ  
{
ÅÅ !
procHsmsErrorRaised
ÆÆ #
(
ÆÆ# $
ex
ÆÆ$ &
)
ÆÆ& '
;
ÆÆ' (
}
ÇÇ 
finally
ÈÈ 
{
ÉÉ 
fBuf
ÊÊ 
=
ÊÊ 
null
ÊÊ 
;
ÊÊ !
fSecsControlMessage
ËË #
=
ËË$ %
null
ËË& *
;
ËË* +
}
ÌÌ 
}
ÍÍ 	
private
ÑÑ 
void
ÑÑ 
sendDataMessage
ÑÑ $
(
ÑÑ$ %
FSecsDataMessage
ÒÒ 
fSecsDataMessage
ÒÒ -
)
ÓÓ 
{
ÔÔ 	
try
ÕÕ 
{
ÖÖ 
m_fTcpClient
×× 
.
×× 
send
×× !
(
××! "
new
××" %
FSocketSendData
××& 5
(
××5 6
fSecsDataMessage
××6 F
.
××F G
getHsmsBinaryData
××G X
(
××X Y
true
××Y ]
)
××] ^
,
××^ _
fSecsDataMessage
××` p
)
××p q
)
××q r
;
××r s
}
ØØ 
catch
ÙÙ 
(
ÙÙ 
	Exception
ÙÙ 
ex
ÙÙ 
)
ÙÙ  
{
ÚÚ !
procHsmsErrorRaised
ÛÛ #
(
ÛÛ# $
ex
ÛÛ$ &
)
ÛÛ& '
;
ÛÛ' (
}
ÜÜ 
finally
İİ 
{
ŞŞ 
}
àà 
}
áá 	
private
åå 
void
åå 
recvSelectReq
åå "
(
åå" #
)
ææ 
{
çç 	
FResultCode
èè 
fResult
èè 
=
èè  !
FResultCode
èè" -
.
èè- .
Success
èè. 5
;
èè5 6
string
éé 
errorMessage
éé 
=
éé  !
string
éé" (
.
éé( )
Empty
éé) .
;
éé. /
byte
êê 
status
êê 
=
êê 
$num
êê 
;
êê !
FSecsControlMessage
ëë !
fSecsControlMessage
ëë  3
=
ëë4 5
null
ëë6 :
;
ëë: ;
try
íí 
{
îî 
if
ïï 
(
ïï 
this
ïï 
.
ïï 
fSecs1ToHsms
ïï %
.
ïï% &

fHsmsState
ïï& 0
==
ïï1 3!
FCommunicationState
ïï4 G
.
ïïG H
Selected
ïïH P
)
ïïP Q
{
ğğ 
fResult
ññ 
=
ññ 
FResultCode
ññ )
.
ññ) *
Warninig
ññ* 2
;
ññ2 3
status
òò 
=
òò 
$num
òò 
;
òò 
}
óó 
else
ôô 
{
õõ 
m_fTmrT7
ùù 
.
ùù 
stop
ùù !
(
ùù! "
)
ùù" #
;
ùù# $
}
úú 
errorMessage
şş 
=
şş $
getSelectStatusMessage
şş 5
(
şş5 6
status
şş6 <
)
şş< =
;
şş= >!
fSecsControlMessage
‚‚ #
=
‚‚$ %
new
‚‚& )!
FSecsControlMessage
‚‚* =
(
‚‚= >
this
ƒƒ 
.
ƒƒ 
fSecs1ToHsms
ƒƒ %
,
ƒƒ% &%
FHsmsControlMessageType
„„ +
.
„„+ ,
	SelectReq
„„, 5
,
„„5 6

m_fRecvBuf
…… 
.
…… 
	sessionId
…… (
,
……( )

m_fRecvBuf
†† 
.
†† 
byte2
†† $
,
††$ %

m_fRecvBuf
‡‡ 
.
‡‡ 
byte3
‡‡ $
,
‡‡$ %

m_fRecvBuf
ˆˆ 
.
ˆˆ 
ptype
ˆˆ $
,
ˆˆ$ %

m_fRecvBuf
‰‰ 
.
‰‰ 
stype
‰‰ $
,
‰‰$ %

m_fRecvBuf
ŠŠ 
.
ŠŠ 
systemBytes
ŠŠ *
,
ŠŠ* +
errorMessage
‹‹  
)
ŒŒ 
;
ŒŒ 
this
 
.
 
fSecs1ToHsms
 !
.
! "
fEventPusher
" .
.
. /
pushHsmsEvent
/ <
(
< =
new
 2
$FHsmsControlMessageReceivedEventArgs
 <
(
< =
this
= A
.
A B
fSecs1ToHsms
B N
,
N O
FEventId
P X
.
X Y(
HsmsControlMessageReceived
Y s
,
s t
fResult
u |
,
| }
errorMessage~ Š
,Š ‹#
fSecsControlMessageŒ Ÿ
)Ÿ  
)
 
;
 
sendSelectRsp
”” 
(
”” 

m_fRecvBuf
”” (
.
””( )
	sessionId
””) 2
,
””2 3
status
””4 :
,
””: ;

m_fRecvBuf
””< F
.
””F G
systemBytes
””G R
)
””R S
;
””S T
}
•• 
catch
–– 
(
–– 
	Exception
–– 
ex
–– 
)
––  
{
—— !
procHsmsErrorRaised
˜˜ #
(
˜˜# $
ex
˜˜$ &
)
˜˜& '
;
˜˜' (
}
™™ 
finally
šš 
{
›› !
fSecsControlMessage
œœ #
=
œœ$ %
null
œœ& *
;
œœ* +
}
 
}
 	
private
¢¢ 
void
¢¢ 
recvDeselectReq
¢¢ $
(
¢¢$ %
)
££ 
{
¤¤ 	!
FSecsControlMessage
¥¥ !
fSecsControlMessage
¥¥  3
=
¥¥4 5
null
¥¥6 :
;
¥¥: ;
try
§§ 
{
¨¨ !
fSecsControlMessage
©© #
=
©©$ %
new
©©& )!
FSecsControlMessage
©©* =
(
©©= >
this
ªª 
.
ªª 
fSecs1ToHsms
ªª %
,
ªª% &%
FHsmsControlMessageType
«« +
.
««+ ,
DeselectReq
««, 7
,
««7 8

m_fRecvBuf
¬¬ 
.
¬¬ 
	sessionId
¬¬ (
,
¬¬( )

m_fRecvBuf
­­ 
.
­­ 
byte2
­­ $
,
­­$ %

m_fRecvBuf
®® 
.
®® 
byte3
®® $
,
®®$ %

m_fRecvBuf
¯¯ 
.
¯¯ 
ptype
¯¯ $
,
¯¯$ %

m_fRecvBuf
°° 
.
°° 
stype
°° $
,
°°$ %

m_fRecvBuf
±± 
.
±± 
systemBytes
±± *
,
±±* +
string
²² 
.
²² 
Empty
²²  
)
³³ 
;
³³ 
this
µµ 
.
µµ 
fSecs1ToHsms
µµ !
.
µµ! "
fEventPusher
µµ" .
.
µµ. /
pushHsmsEvent
µµ/ <
(
µµ< =
new
¶¶ 2
$FHsmsControlMessageReceivedEventArgs
¶¶ <
(
¶¶< =
this
¶¶= A
.
¶¶A B
fSecs1ToHsms
¶¶B N
,
¶¶N O
FEventId
¶¶P X
.
¶¶X Y(
HsmsControlMessageReceived
¶¶Y s
,
¶¶s t
FResultCode¶¶u €
.¶¶€ 
Success¶¶ ˆ
,¶¶ˆ ‰
string¶¶Š 
.¶¶ ‘
Empty¶¶‘ –
,¶¶– —#
fSecsControlMessage¶¶˜ «
)¶¶« ¬
)
·· 
;
·· 
sendDeselectRsp
»» 
(
»»  

m_fRecvBuf
»»  *
.
»»* +
	sessionId
»»+ 4
,
»»4 5

m_fRecvBuf
»»6 @
.
»»@ A
systemBytes
»»A L
)
»»L M
;
»»M N
m_fTcpClient
ÂÂ 
.
ÂÂ 
close
ÂÂ "
(
ÂÂ" #
)
ÂÂ# $
;
ÂÂ$ %
}
ÃÃ 
catch
ÄÄ 
(
ÄÄ 
	Exception
ÄÄ 
ex
ÄÄ 
)
ÄÄ  
{
ÅÅ !
procHsmsErrorRaised
ÆÆ #
(
ÆÆ# $
ex
ÆÆ$ &
)
ÆÆ& '
;
ÆÆ' (
}
ÇÇ 
finally
ÈÈ 
{
ÉÉ !
fSecsControlMessage
ÊÊ #
=
ÊÊ$ %
null
ÊÊ& *
;
ÊÊ* +
}
ËË 
}
ÌÌ 	
private
ĞĞ 
void
ĞĞ 
recvSelectRsp
ĞĞ "
(
ĞĞ" #
)
ÑÑ 
{
ÒÒ 	!
FSecsControlMessage
ÓÓ !
fSecsControlMessage
ÓÓ  3
=
ÓÓ4 5
null
ÓÓ6 :
;
ÓÓ: ;
string
ÔÔ 
errorMessage
ÔÔ 
=
ÔÔ  !
string
ÔÔ" (
.
ÔÔ( )
Empty
ÔÔ) .
;
ÔÔ. /
try
ÖÖ 
{
×× 
errorMessage
ØØ 
=
ØØ $
getRejectReasonMessage
ØØ 5
(
ØØ5 6
$num
ØØ6 7
)
ØØ7 8
;
ØØ8 9!
fSecsControlMessage
ÜÜ #
=
ÜÜ$ %
new
ÜÜ& )!
FSecsControlMessage
ÜÜ* =
(
ÜÜ= >
this
İİ 
.
İİ 
fSecs1ToHsms
İİ %
,
İİ% &%
FHsmsControlMessageType
ŞŞ +
.
ŞŞ+ ,
	SelectRsp
ŞŞ, 5
,
ŞŞ5 6

m_fRecvBuf
ßß 
.
ßß 
	sessionId
ßß (
,
ßß( )

m_fRecvBuf
àà 
.
àà 
byte2
àà $
,
àà$ %

m_fRecvBuf
áá 
.
áá 
byte3
áá $
,
áá$ %

m_fRecvBuf
ââ 
.
ââ 
ptype
ââ $
,
ââ$ %

m_fRecvBuf
ãã 
.
ãã 
stype
ãã $
,
ãã$ %

m_fRecvBuf
ää 
.
ää 
systemBytes
ää *
,
ää* +
errorMessage
åå  
)
ææ 
;
ææ 
this
èè 
.
èè 
fSecs1ToHsms
èè !
.
èè! "
fEventPusher
èè" .
.
èè. /
pushHsmsEvent
èè/ <
(
èè< =
new
éé 2
$FHsmsControlMessageReceivedEventArgs
éé <
(
éé< =
this
éé= A
.
ééA B
fSecs1ToHsms
ééB N
,
ééN O
FEventId
ééP X
.
ééX Y(
HsmsControlMessageReceived
ééY s
,
éés t
FResultCodeééu €
.éé€ 
Warninigéé ‰
,éé‰ Š
errorMessageéé‹ —
,éé— ˜#
fSecsControlMessageéé™ ¬
)éé¬ ­
)
êê 
;
êê 
sendRejectReq
îî 
(
îî 

m_fRecvBuf
îî (
.
îî( )
	sessionId
îî) 2
,
îî2 3

m_fRecvBuf
îî4 >
.
îî> ?
stype
îî? D
,
îîD E
$num
îîF G
,
îîG H

m_fRecvBuf
îîI S
.
îîS T
systemBytes
îîT _
)
îî_ `
;
îî` a
}
ïï 
catch
ğğ 
(
ğğ 
	Exception
ğğ 
ex
ğğ 
)
ğğ  
{
ññ !
procHsmsErrorRaised
òò #
(
òò# $
ex
òò$ &
)
òò& '
;
òò' (
}
óó 
finally
ôô 
{
õõ !
fSecsControlMessage
öö #
=
öö$ %
null
öö& *
;
öö* +
}
÷÷ 
}
øø 	
private
üü 
void
üü 
recvDeselectRsp
üü $
(
üü$ %
)
ıı 
{
şş 	!
FSecsControlMessage
ÿÿ !
fSecsControlMessage
ÿÿ  3
=
ÿÿ4 5
null
ÿÿ6 :
;
ÿÿ: ;
string
€€ 
errorMessage
€€ 
=
€€  !
string
€€" (
.
€€( )
Empty
€€) .
;
€€. /
try
‚‚ 
{
ƒƒ 
errorMessage
„„ 
=
„„ $
getRejectReasonMessage
„„ 5
(
„„5 6
$num
„„6 7
)
„„7 8
;
„„8 9!
fSecsControlMessage
ˆˆ #
=
ˆˆ$ %
new
ˆˆ& )!
FSecsControlMessage
ˆˆ* =
(
ˆˆ= >
this
‰‰ 
.
‰‰ 
fSecs1ToHsms
‰‰ %
,
‰‰% &%
FHsmsControlMessageType
ŠŠ +
.
ŠŠ+ ,
DeselectRsp
ŠŠ, 7
,
ŠŠ7 8

m_fRecvBuf
‹‹ 
.
‹‹ 
	sessionId
‹‹ (
,
‹‹( )

m_fRecvBuf
ŒŒ 
.
ŒŒ 
byte2
ŒŒ $
,
ŒŒ$ %

m_fRecvBuf
 
.
 
byte3
 $
,
$ %

m_fRecvBuf
 
.
 
ptype
 $
,
$ %

m_fRecvBuf
 
.
 
stype
 $
,
$ %

m_fRecvBuf
 
.
 
systemBytes
 *
,
* +
errorMessage
‘‘  
)
’’ 
;
’’ 
this
”” 
.
”” 
fSecs1ToHsms
”” !
.
””! "
fEventPusher
””" .
.
””. /
pushHsmsEvent
””/ <
(
””< =
new
•• 2
$FHsmsControlMessageReceivedEventArgs
•• <
(
••< =
this
••= A
.
••A B
fSecs1ToHsms
••B N
,
••N O
FEventId
••P X
.
••X Y(
HsmsControlMessageReceived
••Y s
,
••s t
FResultCode••u €
.••€ 
Warninig•• ‰
,••‰ Š
errorMessage••‹ —
,••— ˜#
fSecsControlMessage••™ ¬
)••¬ ­
)
–– 
;
–– 
sendRejectReq
šš 
(
šš 

m_fRecvBuf
šš (
.
šš( )
	sessionId
šš) 2
,
šš2 3

m_fRecvBuf
šš4 >
.
šš> ?
stype
šš? D
,
ššD E
$num
ššF G
,
ššG H

m_fRecvBuf
ššI S
.
ššS T
systemBytes
ššT _
)
šš_ `
;
šš` a
}
›› 
catch
œœ 
(
œœ 
	Exception
œœ 
ex
œœ 
)
œœ  
{
 !
procHsmsErrorRaised
 #
(
# $
ex
$ &
)
& '
;
' (
}
ŸŸ 
finally
   
{
¡¡ !
fSecsControlMessage
¢¢ #
=
¢¢$ %
null
¢¢& *
;
¢¢* +
}
££ 
}
¤¤ 	
private
¨¨ 
void
¨¨ 
recvLinktestReq
¨¨ $
(
¨¨$ %
)
©© 
{
ªª 	!
FSecsControlMessage
«« !
fSecsControlMessage
««  3
=
««4 5
null
««6 :
;
««: ;
try
­­ 
{
®® !
fSecsControlMessage
¯¯ #
=
¯¯$ %
new
¯¯& )!
FSecsControlMessage
¯¯* =
(
¯¯= >
this
°° 
.
°° 
fSecs1ToHsms
°° %
,
°°% &%
FHsmsControlMessageType
±± +
.
±±+ ,
LinktestReq
±±, 7
,
±±7 8

m_fRecvBuf
²² 
.
²² 
	sessionId
²² (
,
²²( )

m_fRecvBuf
³³ 
.
³³ 
byte2
³³ $
,
³³$ %

m_fRecvBuf
´´ 
.
´´ 
byte3
´´ $
,
´´$ %

m_fRecvBuf
µµ 
.
µµ 
ptype
µµ $
,
µµ$ %

m_fRecvBuf
¶¶ 
.
¶¶ 
stype
¶¶ $
,
¶¶$ %

m_fRecvBuf
·· 
.
·· 
systemBytes
·· *
,
··* +
string
¸¸ 
.
¸¸ 
Empty
¸¸  
)
¹¹ 
;
¹¹ 
this
»» 
.
»» 
fSecs1ToHsms
»» !
.
»»! "
fEventPusher
»»" .
.
»». /
pushHsmsEvent
»»/ <
(
»»< =
new
¼¼ 2
$FHsmsControlMessageReceivedEventArgs
¼¼ <
(
¼¼< =
this
¼¼= A
.
¼¼A B
fSecs1ToHsms
¼¼B N
,
¼¼N O
FEventId
¼¼P X
.
¼¼X Y(
HsmsControlMessageReceived
¼¼Y s
,
¼¼s t
FResultCode¼¼u €
.¼¼€ 
Success¼¼ ˆ
,¼¼ˆ ‰
string¼¼Š 
.¼¼ ‘
Empty¼¼‘ –
,¼¼– —#
fSecsControlMessage¼¼˜ «
)¼¼« ¬
)
½½ 
;
½½ 
sendLinktestRsp
ÁÁ 
(
ÁÁ  

m_fRecvBuf
ÁÁ  *
.
ÁÁ* +
	sessionId
ÁÁ+ 4
,
ÁÁ4 5

m_fRecvBuf
ÁÁ6 @
.
ÁÁ@ A
systemBytes
ÁÁA L
)
ÁÁL M
;
ÁÁM N
}
ÂÂ 
catch
ÃÃ 
(
ÃÃ 
	Exception
ÃÃ 
ex
ÃÃ 
)
ÃÃ  
{
ÄÄ !
procHsmsErrorRaised
ÅÅ #
(
ÅÅ# $
ex
ÅÅ$ &
)
ÅÅ& '
;
ÅÅ' (
}
ÆÆ 
finally
ÇÇ 
{
ÈÈ !
fSecsControlMessage
ÉÉ #
=
ÉÉ$ %
null
ÉÉ& *
;
ÉÉ* +
}
ÊÊ 
}
ËË 	
private
ÏÏ 
void
ÏÏ 
recvLinktestRsp
ÏÏ $
(
ÏÏ$ %
)
ĞĞ 
{
ÑÑ 	!
FSecsControlMessage
ÒÒ !
fSecsControlMessage
ÒÒ  3
=
ÒÒ4 5
null
ÒÒ6 :
;
ÒÒ: ;
FResultCode
ÓÓ 
fResult
ÓÓ 
=
ÓÓ  !
FResultCode
ÓÓ" -
.
ÓÓ- .
Success
ÓÓ. 5
;
ÓÓ5 6
string
ÔÔ 
errorMessage
ÔÔ 
=
ÔÔ  !
string
ÔÔ" (
.
ÔÔ( )
Empty
ÔÔ) .
;
ÔÔ. /
try
ÖÖ 
{
×× 
if
ØØ 
(
ØØ 
!
ØØ  
m_fTranLinktestReq
ØØ '
.
ØØ' (
enabled
ØØ( /
)
ØØ/ 0
{
ÙÙ 
fResult
ÚÚ 
=
ÚÚ 
FResultCode
ÚÚ )
.
ÚÚ) *
Warninig
ÚÚ* 2
;
ÚÚ2 3
errorMessage
ÛÛ  
=
ÛÛ! "$
getRejectReasonMessage
ÛÛ# 9
(
ÛÛ9 :
$num
ÛÛ: ;
)
ÛÛ; <
;
ÛÛ< =
sendRejectReq
İİ !
(
İİ! "

m_fRecvBuf
İİ" ,
.
İİ, -
	sessionId
İİ- 6
,
İİ6 7

m_fRecvBuf
İİ8 B
.
İİB C
stype
İİC H
,
İİH I
$num
İİJ K
,
İİK L

m_fRecvBuf
İİM W
.
İİW X
systemBytes
İİX c
)
İİc d
;
İİd e
}
ŞŞ 
else
ßß 
if
ßß 
(
ßß  
m_fTranLinktestReq
ßß +
.
ßß+ ,
	sessionId
ßß, 5
!=
ßß6 8

m_fRecvBuf
ßß9 C
.
ßßC D
	sessionId
ßßD M
)
ßßM N
{
àà 
fResult
áá 
=
áá 
FResultCode
áá )
.
áá) *
Warninig
áá* 2
;
áá2 3
errorMessage
ââ  
=
ââ! "
string
ââ# )
.
ââ) *
Format
ââ* 0
(
ââ0 1

FConstants
ââ1 ;
.
ââ; <

err_m_0015
ââ< F
,
ââF G
$str
ââH g
)
ââg h
;
ââh i
}
ãã 
else
ää 
if
ää 
(
ää  
m_fTranLinktestReq
ää +
.
ää+ ,
systemBytes
ää, 7
!=
ää8 :

m_fRecvBuf
ää; E
.
ääE F
systemBytes
ääF Q
)
ääQ R
{
åå 
fResult
ææ 
=
ææ 
FResultCode
ææ )
.
ææ) *
Warninig
ææ* 2
;
ææ2 3
errorMessage
çç  
=
çç! "
string
çç# )
.
çç) *
Format
çç* 0
(
çç0 1

FConstants
çç1 ;
.
çç; <

err_m_0015
çç< F
,
ççF G
$str
ççH j
)
ççj k
;
ççk l
}
èè 
else
éé 
if
éé 
(
éé 

m_fRecvBuf
éé #
.
éé# $
byte3
éé$ )
!=
éé* ,
$num
éé- .
)
éé. /
{
êê 
fResult
ëë 
=
ëë 
FResultCode
ëë )
.
ëë) *
Warninig
ëë* 2
;
ëë2 3
errorMessage
ìì  
=
ìì! "
this
ìì# '
.
ìì' ($
getSelectStatusMessage
ìì( >
(
ìì> ?

m_fRecvBuf
ìì? I
.
ììI J
byte3
ììJ O
)
ììO P
;
ììP Q
}
íí 
else
îî 
{
ïï  
m_fTranLinktestReq
óó &
.
óó& '
reset
óó' ,
(
óó, -
)
óó- .
;
óó. /
}
ôô !
fSecsControlMessage
øø #
=
øø$ %
new
øø& )!
FSecsControlMessage
øø* =
(
øø= >
this
ùù 
.
ùù 
fSecs1ToHsms
ùù %
,
ùù% &%
FHsmsControlMessageType
úú +
.
úú+ ,
LinktestRsp
úú, 7
,
úú7 8

m_fRecvBuf
ûû 
.
ûû 
	sessionId
ûû (
,
ûû( )

m_fRecvBuf
üü 
.
üü 
byte2
üü $
,
üü$ %

m_fRecvBuf
ıı 
.
ıı 
byte3
ıı $
,
ıı$ %

m_fRecvBuf
şş 
.
şş 
ptype
şş $
,
şş$ %

m_fRecvBuf
ÿÿ 
.
ÿÿ 
stype
ÿÿ $
,
ÿÿ$ %

m_fRecvBuf
€€ 
.
€€ 
systemBytes
€€ *
,
€€* +
errorMessage
  
)
‚‚ 
;
‚‚ 
this
„„ 
.
„„ 
fSecs1ToHsms
„„ !
.
„„! "
fEventPusher
„„" .
.
„„. /
pushHsmsEvent
„„/ <
(
„„< =
new
…… 2
$FHsmsControlMessageReceivedEventArgs
…… <
(
……< =
this
……= A
.
……A B
fSecs1ToHsms
……B N
,
……N O
FEventId
……P X
.
……X Y(
HsmsControlMessageReceived
……Y s
,
……s t
fResult
……u |
,
……| }
errorMessage……~ Š
,……Š ‹#
fSecsControlMessage……Œ Ÿ
)……Ÿ  
)
†† 
;
†† 
}
‡‡ 
catch
ˆˆ 
(
ˆˆ 
	Exception
ˆˆ 
ex
ˆˆ 
)
ˆˆ  
{
‰‰ !
procHsmsErrorRaised
ŠŠ #
(
ŠŠ# $
ex
ŠŠ$ &
)
ŠŠ& '
;
ŠŠ' (
}
‹‹ 
finally
ŒŒ 
{
 !
fSecsControlMessage
 #
=
$ %
null
& *
;
* +
}
 
}
 	
private
”” 
void
”” 
recvRejectReq
”” "
(
””" #
)
•• 
{
–– 	!
FSecsControlMessage
—— !
fSecsControlMessage
——  3
=
——4 5
null
——6 :
;
——: ;
string
˜˜ 
errorMessage
˜˜ 
=
˜˜  !
string
˜˜" (
.
˜˜( )
Empty
˜˜) .
;
˜˜. /
try
šš 
{
›› 
errorMessage
œœ 
=
œœ $
getRejectReasonMessage
œœ 5
(
œœ5 6

m_fRecvBuf
œœ6 @
.
œœ@ A
byte3
œœA F
)
œœF G
;
œœG H!
fSecsControlMessage
   #
=
  $ %
new
  & )!
FSecsControlMessage
  * =
(
  = >
this
¡¡ 
.
¡¡ 
fSecs1ToHsms
¡¡ %
,
¡¡% &%
FHsmsControlMessageType
¢¢ +
.
¢¢+ ,
DeselectRsp
¢¢, 7
,
¢¢7 8

m_fRecvBuf
££ 
.
££ 
	sessionId
££ (
,
££( )

m_fRecvBuf
¤¤ 
.
¤¤ 
byte2
¤¤ $
,
¤¤$ %

m_fRecvBuf
¥¥ 
.
¥¥ 
byte3
¥¥ $
,
¥¥$ %

m_fRecvBuf
¦¦ 
.
¦¦ 
ptype
¦¦ $
,
¦¦$ %

m_fRecvBuf
§§ 
.
§§ 
stype
§§ $
,
§§$ %

m_fRecvBuf
¨¨ 
.
¨¨ 
systemBytes
¨¨ *
,
¨¨* +
errorMessage
©©  
)
ªª 
;
ªª 
this
¬¬ 
.
¬¬ 
fSecs1ToHsms
¬¬ !
.
¬¬! "
fEventPusher
¬¬" .
.
¬¬. /
pushHsmsEvent
¬¬/ <
(
¬¬< =
new
­­ 2
$FHsmsControlMessageReceivedEventArgs
­­ <
(
­­< =
this
­­= A
.
­­A B
fSecs1ToHsms
­­B N
,
­­N O
FEventId
­­P X
.
­­X Y(
HsmsControlMessageReceived
­­Y s
,
­­s t
FResultCode­­u €
.­­€ 
Warninig­­ ‰
,­­‰ Š
errorMessage­­‹ —
,­­— ˜#
fSecsControlMessage­­™ ¬
)­­¬ ­
)
®® 
;
®® 
}
¯¯ 
catch
°° 
(
°° 
	Exception
°° 
ex
°° 
)
°°  
{
±± !
procHsmsErrorRaised
²² #
(
²²# $
ex
²²$ &
)
²²& '
;
²²' (
}
³³ 
finally
´´ 
{
µµ !
fSecsControlMessage
¶¶ #
=
¶¶$ %
null
¶¶& *
;
¶¶* +
}
·· 
}
¸¸ 	
private
¼¼ 
void
¼¼ 
recvSeparateReq
¼¼ $
(
¼¼$ %
)
½½ 
{
¾¾ 	!
FSecsControlMessage
¿¿ !
fSecsControlMessage
¿¿  3
=
¿¿4 5
null
¿¿6 :
;
¿¿: ;
try
ÁÁ 
{
ÂÂ !
fSecsControlMessage
ÃÃ #
=
ÃÃ$ %
new
ÃÃ& )!
FSecsControlMessage
ÃÃ* =
(
ÃÃ= >
this
ÄÄ 
.
ÄÄ 
fSecs1ToHsms
ÄÄ %
,
ÄÄ% &%
FHsmsControlMessageType
ÅÅ +
.
ÅÅ+ ,
SeparateReq
ÅÅ, 7
,
ÅÅ7 8

m_fRecvBuf
ÆÆ 
.
ÆÆ 
	sessionId
ÆÆ (
,
ÆÆ( )

m_fRecvBuf
ÇÇ 
.
ÇÇ 
byte2
ÇÇ $
,
ÇÇ$ %

m_fRecvBuf
ÈÈ 
.
ÈÈ 
byte3
ÈÈ $
,
ÈÈ$ %

m_fRecvBuf
ÉÉ 
.
ÉÉ 
ptype
ÉÉ $
,
ÉÉ$ %

m_fRecvBuf
ÊÊ 
.
ÊÊ 
stype
ÊÊ $
,
ÊÊ$ %

m_fRecvBuf
ËË 
.
ËË 
systemBytes
ËË *
,
ËË* +
string
ÌÌ 
.
ÌÌ 
Empty
ÌÌ  
)
ÍÍ 
;
ÍÍ 
this
ÏÏ 
.
ÏÏ 
fSecs1ToHsms
ÏÏ !
.
ÏÏ! "
fEventPusher
ÏÏ" .
.
ÏÏ. /
pushHsmsEvent
ÏÏ/ <
(
ÏÏ< =
new
ĞĞ 2
$FHsmsControlMessageReceivedEventArgs
ĞĞ <
(
ĞĞ< =
this
ĞĞ= A
.
ĞĞA B
fSecs1ToHsms
ĞĞB N
,
ĞĞN O
FEventId
ĞĞP X
.
ĞĞX Y(
HsmsControlMessageReceived
ĞĞY s
,
ĞĞs t
FResultCodeĞĞu €
.ĞĞ€ 
SuccessĞĞ ˆ
,ĞĞˆ ‰
stringĞĞŠ 
.ĞĞ ‘
EmptyĞĞ‘ –
,ĞĞ– —#
fSecsControlMessageĞĞ˜ «
)ĞĞ« ¬
)
ÑÑ 
;
ÑÑ 
m_fTcpClient
ØØ 
.
ØØ 
close
ØØ "
(
ØØ" #
)
ØØ# $
;
ØØ$ %
}
ÙÙ 
catch
ÚÚ 
(
ÚÚ 
	Exception
ÚÚ 
ex
ÚÚ 
)
ÚÚ  
{
ÛÛ !
procHsmsErrorRaised
ÜÜ #
(
ÜÜ# $
ex
ÜÜ$ &
)
ÜÜ& '
;
ÜÜ' (
}
İİ 
finally
ŞŞ 
{
ßß !
fSecsControlMessage
àà #
=
àà$ %
null
àà& *
;
àà* +
}
áá 
}
ââ 	
private
ææ 
void
ææ 
recvDataMessage
ææ $
(
ææ$ %
)
çç 
{
èè 	
FResultCode
éé 
fResult
éé 
=
éé  !
FResultCode
éé" -
.
éé- .
Success
éé. 5
;
éé5 6
string
êê 
errorMessage
êê 
=
êê  !
string
êê" (
.
êê( )
Empty
êê) .
;
êê. /
FSecsDataMessage
ëë 
fSecsDataMessage
ëë -
=
ëë. /
null
ëë0 4
;
ëë4 5
try
íí 
{
îî 
if
ïï 
(
ïï 
this
ïï 
.
ïï 
fSecs1ToHsms
ïï %
.
ïï% &

fHsmsState
ïï& 0
!=
ïï1 3!
FCommunicationState
ïï4 G
.
ïïG H
Selected
ïïH P
)
ïïP Q
{
ğğ 
fResult
ññ 
=
ññ 
FResultCode
ññ )
.
ññ) *
Warninig
ññ* 2
;
ññ2 3
errorMessage
òò  
=
òò! "$
getRejectReasonMessage
òò# 9
(
òò9 :
$num
òò: ;
)
òò; <
;
òò< =
sendRejectReq
ôô !
(
ôô! "

m_fRecvBuf
ôô" ,
.
ôô, -
	sessionId
ôô- 6
,
ôô6 7

m_fRecvBuf
ôô8 B
.
ôôB C
stype
ôôC H
,
ôôH I
$num
ôôJ K
,
ôôK L

m_fRecvBuf
ôôM W
.
ôôW X
systemBytes
ôôX c
)
ôôc d
;
ôôd e
}
õõ 
fSecsDataMessage
ùù  
=
ùù! "
new
ùù# &
FSecsDataMessage
ùù' 7
(
ùù7 8
this
úú 
.
úú 
fSecs1ToHsms
úú %
,
úú% &

m_fRecvBuf
ûû 
.
ûû 
	sessionId
ûû (
,
ûû( )

m_fRecvBuf
üü 
.
üü 
wbit
üü #
,
üü# $

m_fRecvBuf
ıı 
.
ıı 
stream
ıı %
,
ıı% &

m_fRecvBuf
şş 
.
şş 
function
şş '
,
şş' (

m_fRecvBuf
ÿÿ 
.
ÿÿ 
systemBytes
ÿÿ *
,
ÿÿ* +

m_fRecvBuf
€	€	 
.
€	€	 
body
€	€	 #
.
€	€	# $
ToArray
€	€	$ +
(
€	€	+ ,
)
€	€	, -
)
		 
;
		 
this
ƒ	ƒ	 
.
ƒ	ƒ	 
fSecs1ToHsms
ƒ	ƒ	 !
.
ƒ	ƒ	! "
fEventPusher
ƒ	ƒ	" .
.
ƒ	ƒ	. /
pushHsmsEvent
ƒ	ƒ	/ <
(
ƒ	ƒ	< =
new
„	„	 /
!FHsmsDataMessageReceivedEventArgs
„	„	 9
(
„	„	9 :
this
„	„	: >
.
„	„	> ?
fSecs1ToHsms
„	„	? K
,
„	„	K L
FEventId
„	„	M U
.
„	„	U V%
HsmsDataMessageReceived
„	„	V m
,
„	„	m n
fResult
„	„	o v
,
„	„	v w
errorMessage„	„	x „
,„	„	„ … 
fSecsDataMessage„	„	† –
)„	„	– —
)
…	…	 
;
…	…	 
if
‰	‰	 
(
‰	‰	 
fResult
‰	‰	 
==
‰	‰	 
FResultCode
‰	‰	 *
.
‰	‰	* +
Success
‰	‰	+ 2
)
‰	‰	2 3
{
Š	Š	 
if
‹	‹	 
(
‹	‹	 
this
‹	‹	 
.
‹	‹	 
fSecs1ToHsms
‹	‹	 )
.
‹	‹	) *+
isHsmsInterceptingDataMessage
‹	‹	* G
(
‹	‹	G H
fSecsDataMessage
‹	‹	H X
.
‹	‹	X Y
stream
‹	‹	Y _
,
‹	‹	_ `
fSecsDataMessage
‹	‹	a q
.
‹	‹	q r
function
‹	‹	r z
)
‹	‹	z {
)
‹	‹	{ |
{
Œ	Œ	 
this
		 
.
		 
fSecs1ToHsms
		 )
.
		) *
fEventPusher
		* 6
.
		6 7
pushHsmsEvent
		7 D
(
		D E
new
		 ;
-FHsmsInterceptingDataMessageReceivedEventArgs
		  M
(
		M N
this
		  $
.
		$ %
fSecs1ToHsms
		% 1
,
		1 2
FEventId
		  (
.
		( )1
#HsmsInterceptingDataMessageReceived
		) L
,
		L M
fResult
‘	‘	  '
,
‘	‘	' (
errorMessage
’	’	  ,
,
’	’	, -
fSecsDataMessage
“	“	  0
)
”	”	  !
)
•	•	 
;
•	•	 
}
–	–	 
}
—	—	 
}
˜	˜	 
catch
™	™	 
(
™	™	 
	Exception
™	™	 
ex
™	™	 
)
™	™	  
{
š	š	 !
procHsmsErrorRaised
›	›	 #
(
›	›	# $
ex
›	›	$ &
)
›	›	& '
;
›	›	' (
}
œ	œ	 
finally
		 
{
		 
fSecsDataMessage
Ÿ	Ÿ	  
=
Ÿ	Ÿ	! "
null
Ÿ	Ÿ	# '
;
Ÿ	Ÿ	' (
}
 	 	 
}
¡	¡	 	
private
¥	¥	 
void
¥	¥	 !
procHsmsErrorRaised
¥	¥	 (
(
¥	¥	( )
	Exception
¦	¦	 
inEx
¦	¦	 
)
§	§	 
{
¨	¨	 	
try
©	©	 
{
ª	ª	 
FDebug
«	«	 
.
«	«	 
writeLog
«	«	 
(
«	«	  
inEx
«	«	  $
)
«	«	$ %
;
«	«	% &
this
­	­	 
.
­	­	 
fSecs1ToHsms
­	­	 !
.
­	­	! "
fEventPusher
­	­	" .
.
­	­	. /
pushHsmsEvent
­	­	/ <
(
­	­	< =
new
®	®	 '
FHsmsErrorRaisedEventArgs
®	®	 1
(
®	®	1 2
this
®	®	2 6
.
®	®	6 7
fSecs1ToHsms
®	®	7 C
,
®	®	C D
FEventId
®	®	E M
.
®	®	M N
HsmsErrorRaised
®	®	N ]
,
®	®	] ^
inEx
®	®	_ c
.
®	®	c d
Message
®	®	d k
)
®	®	k l
)
¯	¯	 
;
¯	¯	 
}
°	°	 
catch
±	±	 
(
±	±	 
	Exception
±	±	 
ex
±	±	 
)
±	±	  
{
²	²	 
FDebug
³	³	 
.
³	³	 
writeLog
³	³	 
(
³	³	  
ex
³	³	  "
)
³	³	" #
;
³	³	# $
}
´	´	 
finally
µ	µ	 
{
¶	¶	 
}
¸	¸	 
}
¹	¹	 	
private
½	½	 
void
½	½	 
procT7Timeout
½	½	 "
(
½	½	" #
)
¾	¾	 
{
¿	¿	 	
try
À	À	 
{
Á	Á	 
this
Â	Â	 
.
Â	Â	 
fSecs1ToHsms
Â	Â	 !
.
Â	Â	! "
fEventPusher
Â	Â	" .
.
Â	Â	. /
pushHsmsEvent
Â	Â	/ <
(
Â	Â	< =
new
Ã	Ã	 )
FHsmsTimeoutRaisedEventArgs
Ã	Ã	 3
(
Ã	Ã	3 4
this
Ã	Ã	4 8
.
Ã	Ã	8 9
fSecs1ToHsms
Ã	Ã	9 E
,
Ã	Ã	E F
FEventId
Ã	Ã	G O
.
Ã	Ã	O P
HsmsTimeoutRaised
Ã	Ã	P a
,
Ã	Ã	a b
FSecsTimeout
Ã	Ã	c o
.
Ã	Ã	o p
T7
Ã	Ã	p r
,
Ã	Ã	r s 
getTimeoutMessageÃ	Ã	t …
(Ã	Ã	… †
FSecsTimeoutÃ	Ã	† ’
.Ã	Ã	’ “
T7Ã	Ã	“ •
)Ã	Ã	• –
)Ã	Ã	– —
)
Ä	Ä	 
;
Ä	Ä	 
sendSeparateReq
Æ	Æ	 
(
Æ	Æ	  
)
Æ	Æ	  !
;
Æ	Æ	! "
m_fTcpClient
Í	Í	 
.
Í	Í	 
close
Í	Í	 "
(
Í	Í	" #
)
Í	Í	# $
;
Í	Í	$ %
}
Î	Î	 
catch
Ï	Ï	 
(
Ï	Ï	 
	Exception
Ï	Ï	 
ex
Ï	Ï	 
)
Ï	Ï	  
{
Ğ	Ğ	 
FDebug
Ñ	Ñ	 
.
Ñ	Ñ	 
throwException
Ñ	Ñ	 %
(
Ñ	Ñ	% &
ex
Ñ	Ñ	& (
)
Ñ	Ñ	( )
;
Ñ	Ñ	) *
}
Ò	Ò	 
finally
Ó	Ó	 
{
Ô	Ô	 
}
Ö	Ö	 
}
×	×	 	
private
Û	Û	 
void
Û	Û	 
procT8Timeout
Û	Û	 "
(
Û	Û	" #
)
Ü	Ü	 
{
İ	İ	 	
try
Ş	Ş	 
{
ß	ß	 
this
à	à	 
.
à	à	 
fSecs1ToHsms
à	à	 !
.
à	à	! "
fEventPusher
à	à	" .
.
à	à	. /
pushHsmsEvent
à	à	/ <
(
à	à	< =
new
á	á	 )
FHsmsTimeoutRaisedEventArgs
á	á	 3
(
á	á	3 4
this
á	á	4 8
.
á	á	8 9
fSecs1ToHsms
á	á	9 E
,
á	á	E F
FEventId
á	á	G O
.
á	á	O P
HsmsTimeoutRaised
á	á	P a
,
á	á	a b
FSecsTimeout
á	á	c o
.
á	á	o p
T8
á	á	p r
,
á	á	r s 
getTimeoutMessageá	á	t …
(á	á	… †
FSecsTimeoutá	á	† ’
.á	á	’ “
T8á	á	“ •
)á	á	• –
)á	á	– —
)
â	â	 
;
â	â	 
sendSeparateReq
ä	ä	 
(
ä	ä	  
)
ä	ä	  !
;
ä	ä	! "
m_fTcpClient
ë	ë	 
.
ë	ë	 
close
ë	ë	 "
(
ë	ë	" #
)
ë	ë	# $
;
ë	ë	$ %
}
ì	ì	 
catch
í	í	 
(
í	í	 
	Exception
í	í	 
ex
í	í	 
)
í	í	  
{
î	î	 
FDebug
ï	ï	 
.
ï	ï	 
throwException
ï	ï	 %
(
ï	ï	% &
ex
ï	ï	& (
)
ï	ï	( )
;
ï	ï	) *
}
ğ	ğ	 
finally
ñ	ñ	 
{
ò	ò	 
}
ô	ô	 
}
õ	õ	 	
private
ù	ù	 
void
ù	ù	 !
procLinktestTimeout
ù	ù	 (
(
ù	ù	( )
)
ú	ú	 
{
û	û	 	
try
ü	ü	 
{
ı	ı	 
this
ş	ş	 
.
ş	ş	 
fSecs1ToHsms
ş	ş	 !
.
ş	ş	! "
fEventPusher
ş	ş	" .
.
ş	ş	. /
pushHsmsEvent
ş	ş	/ <
(
ş	ş	< =
new
ÿ	ÿ	 )
FHsmsTimeoutRaisedEventArgs
ÿ	ÿ	 3
(
ÿ	ÿ	3 4
this
ÿ	ÿ	4 8
.
ÿ	ÿ	8 9
fSecs1ToHsms
ÿ	ÿ	9 E
,
ÿ	ÿ	E F
FEventId
ÿ	ÿ	G O
.
ÿ	ÿ	O P
HsmsTimeoutRaised
ÿ	ÿ	P a
,
ÿ	ÿ	a b
FSecsTimeout
ÿ	ÿ	c o
.
ÿ	ÿ	o p
T6
ÿ	ÿ	p r
,
ÿ	ÿ	r s 
getTimeoutMessageÿ	ÿ	t …
(ÿ	ÿ	… †
FSecsTimeoutÿ	ÿ	† ’
.ÿ	ÿ	’ “
T6ÿ	ÿ	“ •
)ÿ	ÿ	• –
)ÿ	ÿ	– —
)
€
€
 
;
€
€
 
sendSeparateReq
‚
‚
 
(
‚
‚
  
)
‚
‚
  !
;
‚
‚
! "
m_fTcpClient
‰
‰
 
.
‰
‰
 
close
‰
‰
 "
(
‰
‰
" #
)
‰
‰
# $
;
‰
‰
$ %
}
Š
Š
 
catch
‹
‹
 
(
‹
‹
 
	Exception
‹
‹
 
ex
‹
‹
 
)
‹
‹
  
{
Œ
Œ
 
FDebug


 
.


 
throwException


 %
(


% &
ex


& (
)


( )
;


) *
}


 
finally


 
{


 
}
’
’
 
}
“
“
 	
private
›
›
 
void
›
›
 (
m_fThdMain_ThreadJobCalled
›
›
 /
(
›
›
/ 0
object
œ
œ
 
sender
œ
œ
 
,
œ
œ
 
FThreadEventArgs


 
e


 
)


 
{
Ÿ
Ÿ
 	
bool
 
 
 
waited
 
 
 
=
 
 
 
false
 
 
 
;
 
 
  
try
¢
¢
 
{
£
£
 
waited
¤
¤
 
=
¤
¤
 
m_fMainSync
¤
¤
 $
.
¤
¤
$ %
tryWait
¤
¤
% ,
(
¤
¤
, -
$num
¤
¤
- .
)
¤
¤
. /
;
¤
¤
/ 0
if
¥
¥
 
(
¥
¥
 
!
¥
¥
 
waited
¥
¥
 
)
¥
¥
 
{
¦
¦
 
return
§
§
 
;
§
§
 
}
¨
¨
 
if
¯
¯
 
(
¯
¯
 '
m_fTmrHsmsPassive2Cleanup
¯
¯
 -
.
¯
¯
- .
elasped
¯
¯
. 5
(
¯
¯
5 6
true
¯
¯
6 :
)
¯
¯
: ;
)
¯
¯
; <
{
°
°
 !
cleanUpHsmsPassive2
±
±
 '
(
±
±
' (
)
±
±
( )
;
±
±
) *
}
²
²
 
if
¶
¶
 
(
¶
¶
 
m_fTcpClient
¶
¶
  
==
¶
¶
! #
null
¶
¶
$ (
||
¶
¶
) +
m_fTcpClient
¶
¶
, 8
.
¶
¶
8 9
fState
¶
¶
9 ?
!=
¶
¶
@ B
FTcpClientState
¶
¶
C R
.
¶
¶
R S
	Connected
¶
¶
S \
)
¶
¶
\ ]
{
·
·
 
e
¸
¸
 
.
¸
¸
 
sleepThread
¸
¸
 !
(
¸
¸
! "
$num
¸
¸
" #
)
¸
¸
# $
;
¸
¸
$ %
return
¹
¹
 
;
¹
¹
 
}
º
º
 
if
¼
¼
 
(
¼
¼
 
this
¼
¼
 
.
¼
¼
 
fSecs1ToHsms
¼
¼
 %
.
¼
¼
% &

fHsmsState
¼
¼
& 0
!=
¼
¼
1 3!
FCommunicationState
¼
¼
4 G
.
¼
¼
G H
	Connected
¼
¼
H Q
&&
¼
¼
R T
this
¼
¼
U Y
.
¼
¼
Y Z
fSecs1ToHsms
¼
¼
Z f
.
¼
¼
f g

fHsmsState
¼
¼
g q
!=
¼
¼
r t"
FCommunicationState¼
¼
u ˆ
.¼
¼
ˆ ‰
Selected¼
¼
‰ ‘
)¼
¼
‘ ’
{
½
½
 
e
¾
¾
 
.
¾
¾
 
sleepThread
¾
¾
 !
(
¾
¾
! "
$num
¾
¾
" #
)
¾
¾
# $
;
¾
¾
$ %
return
¿
¿
 
;
¿
¿
 
}
À
À
 
if
Ç
Ç
 
(
Ç
Ç
 
m_fTmrT7
Ç
Ç
 
.
Ç
Ç
 
elasped
Ç
Ç
 $
(
Ç
Ç
$ %
false
Ç
Ç
% *
)
Ç
Ç
* +
)
Ç
Ç
+ ,
{
È
È
 
procT7Timeout
É
É
 !
(
É
É
! "
)
É
É
" #
;
É
É
# $
return
Ê
Ê
 
;
Ê
Ê
 
}
Ë
Ë
 
if
Ò
Ò
 
(
Ò
Ò
  
m_fTranLinktestReq
Ò
Ò
 &
.
Ò
Ò
& '
timeout
Ò
Ò
' .
(
Ò
Ò
. /
)
Ò
Ò
/ 0
)
Ò
Ò
0 1
{
Ó
Ó
 !
procLinktestTimeout
Ô
Ô
 '
(
Ô
Ô
' (
)
Ô
Ô
( )
;
Ô
Ô
) *
return
Õ
Õ
 
;
Õ
Õ
 
}
Ö
Ö
 
if
İ
İ
 
(
İ
İ
 
m_fTmrT8
İ
İ
 
.
İ
İ
 
elasped
İ
İ
 $
(
İ
İ
$ %
false
İ
İ
% *
)
İ
İ
* +
)
İ
İ
+ ,
{
Ş
Ş
 
procT8Timeout
ß
ß
 !
(
ß
ß
! "
)
ß
ß
" #
;
ß
ß
# $
return
à
à
 
;
à
à
 
}
á
á
 
if
è
è
 
(
è
è
 
m_fTmrLinktest
è
è
 "
.
è
è
" #
elasped
è
è
# *
(
è
è
* +
true
è
è
+ /
)
è
è
/ 0
)
è
è
0 1
{
é
é
 
if
ê
ê
 
(
ê
ê
 
!
ê
ê
  
m_fTranLinktestReq
ê
ê
 +
.
ê
ê
+ ,
enabled
ê
ê
, 3
)
ê
ê
3 4
{
ë
ë
 
sendLinktestReq
ì
ì
 '
(
ì
ì
' (
)
ì
ì
( )
;
ì
ì
) *
}
í
í
 
}
î
î
 
e
ò
ò
 
.
ò
ò
 
sleepThread
ò
ò
 
(
ò
ò
 
$num
ò
ò
 
)
ò
ò
  
;
ò
ò
  !
}
ó
ó
 
catch
ô
ô
 
(
ô
ô
 
	Exception
ô
ô
 
ex
ô
ô
 
)
ô
ô
  
{
õ
õ
 !
procHsmsErrorRaised
ö
ö
 #
(
ö
ö
# $
ex
ö
ö
$ &
)
ö
ö
& '
;
ö
ö
' (
}
÷
÷
 
finally
ø
ø
 
{
ù
ù
 
if
ú
ú
 
(
ú
ú
 
waited
ú
ú
 
)
ú
ú
 
{
û
û
 
m_fMainSync
ü
ü
 
.
ü
ü
  
set
ü
ü
  #
(
ü
ü
# $
)
ü
ü
$ %
;
ü
ü
% &
}
ı
ı
 
}
ş
ş
 
}
ÿ
ÿ
 	
private
‡‡ 
void
‡‡ 7
)m_fTcpListener_TcpListenerAcceptCompleted
‡‡ >
(
‡‡> ?
object
ˆˆ 
sender
ˆˆ 
,
ˆˆ 2
$FTcpListenerAcceptCompletedEventArgs
‰‰ 0
e
‰‰1 2
)
ŠŠ 
{
‹‹ 	
try
ŒŒ 
{
 
m_fMainSync
 
.
 
wait
  
(
  !
)
! "
;
" #
if
’’ 
(
’’ 
this
’’ 
.
’’ 
fSecs1ToHsms
’’ %
.
’’% &

fHsmsState
’’& 0
!=
’’1 3!
FCommunicationState
’’4 G
.
’’G H
Opened
’’H N
)
’’N O
{
““ !
m_fHsmsPassive2List
”” '
.
””' (
Add
””( +
(
””+ ,
new
””, /
FHsmsPassive2
””0 =
(
””= >
this
””> B
.
””B C
fSecs1ToHsms
””C O
,
””O P
e
””Q R
.
””R S

fTcpClient
””S ]
)
””] ^
)
””^ _
;
””_ `
return
•• 
;
•• 
}
–– 
closeTcpClient
šš 
(
šš 
)
šš  
;
šš  !
this
 
.
 
localIp
 
=
 
e
  
.
  !

fTcpClient
! +
.
+ ,
localIp
, 3
;
3 4
this
ŸŸ 
.
ŸŸ 
	localPort
ŸŸ 
=
ŸŸ  
e
ŸŸ! "
.
ŸŸ" #

fTcpClient
ŸŸ# -
.
ŸŸ- .
	localPort
ŸŸ. 7
;
ŸŸ7 8
this
   
.
   
remoteIp
   
=
   
e
    !
.
  ! "

fTcpClient
  " ,
.
  , -
remoteIp
  - 5
;
  5 6
this
¡¡ 
.
¡¡ 

remotePort
¡¡ 
=
¡¡  !
e
¡¡" #
.
¡¡# $

fTcpClient
¡¡$ .
.
¡¡. /

remotePort
¡¡/ 9
;
¡¡9 :
m_fTcpClient
¥¥ 
=
¥¥ 
e
¥¥  
.
¥¥  !

fTcpClient
¥¥! +
;
¥¥+ ,
m_fTcpClient
§§ 
.
§§ #
TcpClientStateChanged
§§ 2
+=
§§3 5
new
§§6 90
"FTcpClientStateChangedEventHandler
§§: \
(
§§\ ]0
"m_fTcpClient_TcpClientStateChanged
§§] 
)§§ €
;§§€ 
m_fTcpClient
¨¨ 
.
¨¨ #
TcpClientDataReceived
¨¨ 2
+=
¨¨3 5
new
¨¨6 90
"FTcpClientDataReceivedEventHandler
¨¨: \
(
¨¨\ ]0
"m_fTcpClient_TcpClientDataReceived
¨¨] 
)¨¨ €
;¨¨€ 
m_fTcpClient
©© 
.
©© 
TcpClientDataSent
©© .
+=
©©/ 1
new
©©2 5,
FTcpClientDataSentEventHandler
©©6 T
(
©©T U,
m_fTcpClient_TcpClientDataSent
©©U s
)
©©s t
;
©©t u
m_fTcpClient
ªª 
.
ªª %
TcpClientDataSendFailed
ªª 4
+=
ªª5 7
new
ªª8 ;2
$FTcpClientDataSendFailedEventHandler
ªª< `
(
ªª` a3
$m_fTcpClient_TcpClientDataSendFailedªªa …
)ªª… †
;ªª† ‡
m_fTcpClient
«« 
.
«« "
TcpClientErrorRaised
«« 1
+=
««2 4
new
««5 8/
!FTcpClientErrorRaisedEventHandler
««9 Z
(
««Z [/
!m_fTcpClient_TcpClientErrorRaised
««[ |
)
««| }
;
««} ~
m_fTcpClient
­­ 
.
­­ 
resumeEvent
­­ (
(
­­( )
)
­­) *
;
­­* +
this
±± 
.
±± 
fSecs1ToHsms
±± !
.
±±! "
changeHsmsState
±±" 1
(
±±1 2
FConnectMode
±±2 >
.
±±> ?
Passive
±±? F
,
±±F G
this
±±H L
.
±±L M
localIp
±±M T
,
±±T U
this
±±V Z
.
±±Z [
	localPort
±±[ d
,
±±d e
this
±±f j
.
±±j k
remoteIp
±±k s
,
±±s t
this
±±u y
.
±±y z

remotePort±±z „
,±±„ …#
FCommunicationState±±† ™
.±±™ š
	Connected±±š £
)±±£ ¤
;±±¤ ¥
m_fTmrT7
¸¸ 
.
¸¸ 
start
¸¸ 
(
¸¸ 
this
¸¸ #
.
¸¸# $
fSecs1ToHsms
¸¸$ 0
.
¸¸0 1
fHsmsConfig
¸¸1 <
.
¸¸< =
	t8Timeout
¸¸= F
*
¸¸G H
$num
¸¸I M
)
¸¸M N
;
¸¸N O
}
¹¹ 
catch
ºº 
(
ºº 
	Exception
ºº 
ex
ºº 
)
ºº  
{
»» 
FDebug
¼¼ 
.
¼¼ 
writeLog
¼¼ 
(
¼¼  
ex
¼¼  "
)
¼¼" #
;
¼¼# $
}
½½ 
finally
¾¾ 
{
¿¿ 
m_fMainSync
ÀÀ 
.
ÀÀ 
set
ÀÀ 
(
ÀÀ  
)
ÀÀ  !
;
ÀÀ! "
}
ÁÁ 
}
ÂÂ 	
private
ÆÆ 
void
ÆÆ 3
%m_fTcpListener_TcpListenerErrorRaised
ÆÆ :
(
ÆÆ: ;
object
ÇÇ 
sender
ÇÇ 
,
ÇÇ .
 FTcpListenerErrorRaisedEventArgs
ÈÈ ,
e
ÈÈ- .
)
ÉÉ 
{
ÊÊ 	
try
ËË 
{
ÌÌ !
procHsmsErrorRaised
ÍÍ #
(
ÍÍ# $
e
ÍÍ$ %
.
ÍÍ% &
	exception
ÍÍ& /
)
ÍÍ/ 0
;
ÍÍ0 1
}
ÎÎ 
catch
ÏÏ 
(
ÏÏ 
	Exception
ÏÏ 
ex
ÏÏ 
)
ÏÏ  
{
ĞĞ 
FDebug
ÑÑ 
.
ÑÑ 
writeLog
ÑÑ 
(
ÑÑ  
ex
ÑÑ  "
)
ÑÑ" #
;
ÑÑ# $
}
ÒÒ 
finally
ÓÓ 
{
ÔÔ 
}
ÖÖ 
}
×× 	
private
ßß 
void
ßß 0
"m_fTcpClient_TcpClientStateChanged
ßß 7
(
ßß7 8
object
àà 
sender
àà 
,
àà -
FTcpClientStateChangedEventArgs
áá +
e
áá, -
)
ââ 
{
ãã 	
try
ää 
{
åå 
m_fMainSync
ææ 
.
ææ 
wait
ææ  
(
ææ  !
)
ææ! "
;
ææ" #
if
êê 
(
êê 
m_fTcpListener
êê "
!=
êê# %
null
êê& *
&&
êê+ -
e
êê. /
.
êê/ 0
fState
êê0 6
==
êê7 9
FTcpClientState
êê: I
.
êêI J
Closed
êêJ P
)
êêP Q
{
ëë 
this
ìì 
.
ìì 
fSecs1ToHsms
ìì %
.
ìì% &
changeHsmsState
ìì& 5
(
ìì5 6
FConnectMode
ìì6 B
.
ììB C
Passive
ììC J
,
ììJ K
this
ììL P
.
ììP Q
localIp
ììQ X
,
ììX Y
this
ììZ ^
.
ìì^ _
	localPort
ìì_ h
,
ììh i
this
ììj n
.
ììn o
remoteIp
ììo w
,
ììw x
this
ììy }
.
ìì} ~

remotePortìì~ ˆ
,ììˆ ‰#
FCommunicationStateììŠ 
.ìì 
Openedìì ¤
)ìì¤ ¥
;ìì¥ ¦
resetResource
îî !
(
îî! "
)
îî" #
;
îî# $
}
ïï 
}
ğğ 
catch
ññ 
(
ññ 
	Exception
ññ 
ex
ññ 
)
ññ  
{
òò !
procHsmsErrorRaised
óó #
(
óó# $
ex
óó$ &
)
óó& '
;
óó' (
}
ôô 
finally
õõ 
{
öö 
m_fMainSync
÷÷ 
.
÷÷ 
set
÷÷ 
(
÷÷  
)
÷÷  !
;
÷÷! "
}
øø 
}
ùù 	
private
ıı 
void
ıı 0
"m_fTcpClient_TcpClientDataReceived
ıı 7
(
ıı7 8
object
şş 
sender
şş 
,
şş -
FTcpClientDataReceivedEventArgs
ÿÿ +
e
ÿÿ, -
)
€€ 
{
 	
try
‚‚ 
{
ƒƒ 
m_fMainSync
„„ 
.
„„ 
wait
„„  
(
„„  !
)
„„! "
;
„„" #
m_fTmrT8
‹‹ 
.
‹‹ 
stop
‹‹ 
(
‹‹ 
)
‹‹ 
;
‹‹  
if
’’ 
(
’’ 
m_fTmrLinktest
’’ "
.
’’" #
enabled
’’# *
)
’’* +
{
““ 
m_fTmrLinktest
”” "
.
””" #
restart
””# *
(
””* +
this
””+ /
.
””/ 0
fSecs1ToHsms
””0 <
.
””< =
fHsmsConfig
””= H
.
””H I
linkTestPeriod
””I W
*
””X Y
$num
””Z ^
)
””^ _
;
””_ `
}
•• 

m_fRecvBuf
™™ 
.
™™ 
input
™™  
(
™™  !
e
™™! "
.
™™" #
data
™™# '
)
™™' (
;
™™( )
while
›› 
(
›› 

m_fRecvBuf
›› !
.
››! "
parse
››" '
(
››' (
)
››( )
)
››) *
{
œœ 
if
 
(
 

m_fRecvBuf
 "
.
" #
stype
# (
==
) +
$num
, -
)
- .
{
 
recvDataMessage
ŸŸ '
(
ŸŸ' (
)
ŸŸ( )
;
ŸŸ) *
}
   
else
¡¡ 
if
¡¡ 
(
¡¡ 

m_fRecvBuf
¡¡ '
.
¡¡' (
stype
¡¡( -
==
¡¡. 0
$num
¡¡1 2
)
¡¡2 3
{
¢¢ 
recvSelectReq
££ %
(
££% &
)
££& '
;
££' (
}
¤¤ 
else
¥¥ 
if
¥¥ 
(
¥¥ 

m_fRecvBuf
¥¥ '
.
¥¥' (
stype
¥¥( -
==
¥¥. 0
$num
¥¥1 2
)
¥¥2 3
{
¦¦ 
recvSelectRsp
§§ %
(
§§% &
)
§§& '
;
§§' (
}
¨¨ 
else
©© 
if
©© 
(
©© 

m_fRecvBuf
©© '
.
©©' (
stype
©©( -
==
©©. 0
$num
©©1 2
)
©©2 3
{
ªª 
recvDeselectReq
«« '
(
««' (
)
««( )
;
««) *
}
¬¬ 
else
­­ 
if
­­ 
(
­­ 

m_fRecvBuf
­­ '
.
­­' (
stype
­­( -
==
­­. 0
$num
­­1 2
)
­­2 3
{
®® 
recvDeselectRsp
¯¯ '
(
¯¯' (
)
¯¯( )
;
¯¯) *
}
°° 
else
±± 
if
±± 
(
±± 

m_fRecvBuf
±± '
.
±±' (
stype
±±( -
==
±±. 0
$num
±±1 2
)
±±2 3
{
²² 
recvLinktestReq
³³ '
(
³³' (
)
³³( )
;
³³) *
}
´´ 
else
µµ 
if
µµ 
(
µµ 

m_fRecvBuf
µµ '
.
µµ' (
stype
µµ( -
==
µµ. 0
$num
µµ1 2
)
µµ2 3
{
¶¶ 
recvLinktestRsp
·· '
(
··' (
)
··( )
;
··) *
}
¸¸ 
else
¹¹ 
if
¹¹ 
(
¹¹ 

m_fRecvBuf
¹¹ '
.
¹¹' (
stype
¹¹( -
==
¹¹. 0
$num
¹¹1 2
)
¹¹2 3
{
ºº 
recvRejectReq
»» %
(
»»% &
)
»»& '
;
»»' (
}
¼¼ 
else
½½ 
if
½½ 
(
½½ 

m_fRecvBuf
½½ '
.
½½' (
stype
½½( -
==
½½. 0
$num
½½1 2
)
½½2 3
{
¾¾ 
recvSeparateReq
¿¿ '
(
¿¿' (
)
¿¿( )
;
¿¿) *
}
ÀÀ 
else
ÁÁ 
{
ÂÂ 
sendRejectReq
ÇÇ %
(
ÇÇ% &

m_fRecvBuf
ÇÇ& 0
.
ÇÇ0 1
	sessionId
ÇÇ1 :
,
ÇÇ: ;

m_fRecvBuf
ÇÇ< F
.
ÇÇF G
stype
ÇÇG L
,
ÇÇL M
$num
ÇÇN O
,
ÇÇO P

m_fRecvBuf
ÇÇQ [
.
ÇÇ[ \
systemBytes
ÇÇ\ g
)
ÇÇg h
;
ÇÇh i
}
ÈÈ 

m_fRecvBuf
ÌÌ 
.
ÌÌ 
init
ÌÌ #
(
ÌÌ# $
)
ÌÌ$ %
;
ÌÌ% &
}
ÍÍ 
if
ÔÔ 
(
ÔÔ 
!
ÔÔ 

m_fRecvBuf
ÔÔ 
.
ÔÔ  
isCompleted
ÔÔ  +
)
ÔÔ+ ,
{
ÕÕ 
m_fTmrT8
ÖÖ 
.
ÖÖ 
start
ÖÖ "
(
ÖÖ" #
this
ÖÖ# '
.
ÖÖ' (
fSecs1ToHsms
ÖÖ( 4
.
ÖÖ4 5
fHsmsConfig
ÖÖ5 @
.
ÖÖ@ A
	t8Timeout
ÖÖA J
*
ÖÖK L
$num
ÖÖM Q
)
ÖÖQ R
;
ÖÖR S
}
×× 
}
ØØ 
catch
ÙÙ 
(
ÙÙ 
	Exception
ÙÙ 
ex
ÙÙ 
)
ÙÙ  
{
ÚÚ !
procHsmsErrorRaised
ÛÛ #
(
ÛÛ# $
ex
ÛÛ$ &
)
ÛÛ& '
;
ÛÛ' (
}
ÜÜ 
finally
İİ 
{
ŞŞ 
m_fMainSync
ßß 
.
ßß 
set
ßß 
(
ßß  
)
ßß  !
;
ßß! "
}
àà 
}
áá 	
private
åå 
void
åå ,
m_fTcpClient_TcpClientDataSent
åå 3
(
åå3 4
object
ææ 
sender
ææ 
,
ææ )
FTcpClientDataSentEventArgs
çç '
e
çç( )
)
èè 
{
éé 	!
FSecsControlMessage
êê !
fSecsControlMessage
êê  3
=
êê4 5
null
êê6 :
;
êê: ;
FSecsDataMessage
ëë 
fSecsDataMessage
ëë -
=
ëë. /
null
ëë0 4
;
ëë4 5
try
íí 
{
îî 
m_fMainSync
ïï 
.
ïï 
wait
ïï  
(
ïï  !
)
ïï! "
;
ïï" #
if
óó 
(
óó 
e
óó 
.
óó 
fData
óó 
.
óó 
state
óó !
is
óó" $!
FSecsControlMessage
óó% 8
)
óó8 9
{
ôô !
fSecsControlMessage
õõ '
=
õõ( )
(
õõ* +!
FSecsControlMessage
õõ+ >
)
õõ> ?
e
õõ? @
.
õõ@ A
fData
õõA F
.
õõF G
state
õõG L
;
õõL M
this
öö 
.
öö 
fSecs1ToHsms
öö %
.
öö% &
fEventPusher
öö& 2
.
öö2 3
pushHsmsEvent
öö3 @
(
öö@ A
new
÷÷ .
 FHsmsControlMessageSentEventArgs
÷÷ <
(
÷÷< =
this
÷÷= A
.
÷÷A B
fSecs1ToHsms
÷÷B N
,
÷÷N O
FEventId
÷÷P X
.
÷÷X Y$
HsmsControlMessageSent
÷÷Y o
,
÷÷o p
FResultCode
÷÷q |
.
÷÷| }
Success÷÷} „
,÷÷„ …
string÷÷† Œ
.÷÷Œ 
Empty÷÷ ’
,÷÷’ “#
fSecsControlMessage÷÷” §
)÷÷§ ¨
)
øø 
;
øø 
if
üü 
(
üü !
fSecsControlMessage
ıı +
.
ıı+ ,
fType
ıı, 1
==
ıı2 4%
FHsmsControlMessageType
ıı5 L
.
ııL M
	SelectRsp
ııM V
&&
ııW Y!
fSecsControlMessage
şş +
.
şş+ ,
byte3
şş, 1
==
şş2 4
$num
şş5 6
)
ÿÿ 
{
€€ 
this
 
.
 
fSecs1ToHsms
 )
.
) *
changeHsmsState
* 9
(
9 :
FConnectMode
: F
.
F G
Passive
G N
,
N O
this
P T
.
T U
localIp
U \
,
\ ]
this
^ b
.
b c
	localPort
c l
,
l m
this
n r
.
r s
remoteIp
s {
,
{ |
this} 
. ‚

remotePort‚ Œ
,Œ #
FCommunicationState ¡
.¡ ¢
Selected¢ ª
)ª «
;« ¬
if
ˆˆ 
(
ˆˆ 
this
ˆˆ  
.
ˆˆ  !
fSecs1ToHsms
ˆˆ! -
.
ˆˆ- .
fHsmsConfig
ˆˆ. 9
.
ˆˆ9 :
linkTestPeriod
ˆˆ: H
>
ˆˆI J
$num
ˆˆK L
)
ˆˆL M
{
‰‰ 
m_fTmrLinktest
ŠŠ *
.
ŠŠ* +
start
ŠŠ+ 0
(
ŠŠ0 1
this
ŠŠ1 5
.
ŠŠ5 6
fSecs1ToHsms
ŠŠ6 B
.
ŠŠB C
fHsmsConfig
ŠŠC N
.
ŠŠN O
linkTestPeriod
ŠŠO ]
*
ŠŠ^ _
$num
ŠŠ` d
)
ŠŠd e
;
ŠŠe f
}
‹‹ 
}
ŒŒ 
}
 
else
 
if
 
(
 
e
 
.
 
fData
  
.
  !
state
! &
is
' )
FSecsDataMessage
* :
)
: ;
{
 
fSecsDataMessage
 $
=
% &
(
' (
FSecsDataMessage
( 8
)
8 9
e
9 :
.
: ;
fData
; @
.
@ A
state
A F
;
F G
this
‘‘ 
.
‘‘ 
fSecs1ToHsms
‘‘ %
.
‘‘% &
fEventPusher
‘‘& 2
.
‘‘2 3
pushHsmsEvent
‘‘3 @
(
‘‘@ A
new
’’ +
FHsmsDataMessageSentEventArgs
’’ 9
(
’’9 :
this
’’: >
.
’’> ?
fSecs1ToHsms
’’? K
,
’’K L
FEventId
’’M U
.
’’U V!
HsmsDataMessageSent
’’V i
,
’’i j
FResultCode
’’k v
.
’’v w
Success
’’w ~
,
’’~ 
string’’€ †
.’’† ‡
Empty’’‡ Œ
,’’Œ  
fSecsDataMessage’’ 
)’’ Ÿ
)
““ 
;
““ 
}
”” 
}
•• 
catch
–– 
(
–– 
	Exception
–– 
ex
–– 
)
––  
{
—— !
procHsmsErrorRaised
˜˜ #
(
˜˜# $
ex
˜˜$ &
)
˜˜& '
;
˜˜' (
}
™™ 
finally
šš 
{
›› !
fSecsControlMessage
œœ #
=
œœ$ %
null
œœ& *
;
œœ* +
fSecsDataMessage
  
=
! "
null
# '
;
' (
m_fMainSync
ŸŸ 
.
ŸŸ 
set
ŸŸ 
(
ŸŸ  
)
ŸŸ  !
;
ŸŸ! "
}
   
}
¡¡ 	
private
¥¥ 
void
¥¥ 2
$m_fTcpClient_TcpClientDataSendFailed
¥¥ 9
(
¥¥9 :
object
¦¦ 
sender
¦¦ 
,
¦¦ /
!FTcpClientDataSendFailedEventArgs
§§ -
e
§§. /
)
¨¨ 
{
©© 	!
FSecsControlMessage
ªª !
fSecsControlMessage
ªª  3
=
ªª4 5
null
ªª6 :
;
ªª: ;
FSecsDataMessage
«« 
fSecsDataMessage
«« -
=
««. /
null
««0 4
;
««4 5
try
­­ 
{
®® 
m_fMainSync
¯¯ 
.
¯¯ 
wait
¯¯  
(
¯¯  !
)
¯¯! "
;
¯¯" #
if
³³ 
(
³³ 
e
³³ 
.
³³ 
fData
³³ 
.
³³ 
state
³³ !
is
³³" $!
FSecsControlMessage
³³% 8
)
³³8 9
{
´´ !
fSecsControlMessage
µµ '
=
µµ( )
(
µµ* +!
FSecsControlMessage
µµ+ >
)
µµ> ?
e
µµ? @
.
µµ@ A
fData
µµA F
.
µµF G
state
µµG L
;
µµL M
this
¶¶ 
.
¶¶ 
fSecs1ToHsms
¶¶ %
.
¶¶% &
fEventPusher
¶¶& 2
.
¶¶2 3
pushHsmsEvent
¶¶3 @
(
¶¶@ A
new
·· .
 FHsmsControlMessageSentEventArgs
·· <
(
··< =
this
··= A
.
··A B
fSecs1ToHsms
··B N
,
··N O
FEventId
··P X
.
··X Y$
HsmsControlMessageSent
··Y o
,
··o p
FResultCode
··q |
.
··| }
Error··} ‚
,··‚ ƒ
e··„ …
.··… †
message··† 
,·· #
fSecsControlMessage·· ¢
)··¢ £
)
¸¸ 
;
¸¸ 
}
¹¹ 
else
ºº 
if
ºº 
(
ºº 
e
ºº 
.
ºº 
fData
ºº  
.
ºº  !
state
ºº! &
is
ºº' )
FSecsDataMessage
ºº* :
)
ºº: ;
{
»» 
fSecsDataMessage
¼¼ $
=
¼¼% &
(
¼¼' (
FSecsDataMessage
¼¼( 8
)
¼¼8 9
e
¼¼9 :
.
¼¼: ;
fData
¼¼; @
.
¼¼@ A
state
¼¼A F
;
¼¼F G
this
½½ 
.
½½ 
fSecs1ToHsms
½½ %
.
½½% &
fEventPusher
½½& 2
.
½½2 3
pushHsmsEvent
½½3 @
(
½½@ A
new
¾¾ +
FHsmsDataMessageSentEventArgs
¾¾ 9
(
¾¾9 :
this
¾¾: >
.
¾¾> ?
fSecs1ToHsms
¾¾? K
,
¾¾K L
FEventId
¾¾M U
.
¾¾U V!
HsmsDataMessageSent
¾¾V i
,
¾¾i j
FResultCode
¾¾k v
.
¾¾v w
Error
¾¾w |
,
¾¾| }
e
¾¾~ 
.¾¾ €
message¾¾€ ‡
,¾¾‡ ˆ 
fSecsDataMessage¾¾‰ ™
)¾¾™ š
)
¿¿ 
;
¿¿ 
}
ÀÀ 
}
ÁÁ 
catch
ÂÂ 
(
ÂÂ 
	Exception
ÂÂ 
ex
ÂÂ 
)
ÂÂ  
{
ÃÃ !
procHsmsErrorRaised
ÄÄ #
(
ÄÄ# $
ex
ÄÄ$ &
)
ÄÄ& '
;
ÄÄ' (
}
ÅÅ 
finally
ÆÆ 
{
ÇÇ !
fSecsControlMessage
ÈÈ #
=
ÈÈ$ %
null
ÈÈ& *
;
ÈÈ* +
fSecsDataMessage
ÉÉ  
=
ÉÉ! "
null
ÉÉ# '
;
ÉÉ' (
m_fMainSync
ÊÊ 
.
ÊÊ 
set
ÊÊ 
(
ÊÊ  
)
ÊÊ  !
;
ÊÊ! "
}
ËË 
}
ÌÌ 	
private
ĞĞ 
void
ĞĞ /
!m_fTcpClient_TcpClientErrorRaised
ĞĞ 6
(
ĞĞ6 7
object
ÑÑ 
sender
ÑÑ 
,
ÑÑ ,
FTcpClientErrorRaisedEventArgs
ÒÒ *
e
ÒÒ+ ,
)
ÓÓ 
{
ÔÔ 	
try
ÕÕ 
{
ÖÖ !
procHsmsErrorRaised
×× #
(
××# $
e
××$ %
.
××% &
	exception
××& /
)
××/ 0
;
××0 1
}
ØØ 
catch
ÙÙ 
(
ÙÙ 
	Exception
ÙÙ 
ex
ÙÙ 
)
ÙÙ  
{
ÚÚ !
procHsmsErrorRaised
ÛÛ #
(
ÛÛ# $
ex
ÛÛ$ &
)
ÛÛ& '
;
ÛÛ' (
}
ÜÜ 
finally
İİ 
{
ŞŞ 
}
àà 
}
áá 	
}
çç 
}èè œ§
wD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Protocol\HSMS\c_FBaseHsms.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
internal 
abstract 
class 
	FBaseHsms %
:& '
IDisposable( 3
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FSecs1ToHsms 
m_fSecs1ToHsms +
=, -
null. 2
;2 3
private 
FIDPointer32 !
m_fSystemBytesPointer 2
=3 4
null5 9
;9 :
private 
string 
	m_localIp  
=! "
string# )
.) *
Empty* /
;/ 0
private 
int 
m_localPort 
=  !
$num" #
;# $
private   
string   

m_remoteIp   !
=  " #
string  $ *
.  * +
Empty  + 0
;  0 1
private!! 
int!! 
m_remotePort!!  
=!!! "
$num!!# $
;!!$ %
public'' 
	FBaseHsms'' 
('' 
FSecs1ToHsms(( 
fSecs1ToHsms(( %
))) 
{** 	
m_fSecs1ToHsms++ 
=++ 
fSecs1ToHsms++ )
;++) *!
m_fSystemBytesPointer,, !
=,," #
new,,$ '
FIDPointer32,,( 4
(,,4 5
),,5 6
;,,6 7
	m_localIp.. 
=.. 
m_fSecs1ToHsms.. &
...& '
fHsmsConfig..' 2
...2 3
localIp..3 :
;..: ;
m_localPort// 
=// 
m_fSecs1ToHsms// (
.//( )
fHsmsConfig//) 4
.//4 5
	localPort//5 >
;//> ?

m_remoteIp00 
=00 
m_fSecs1ToHsms00 '
.00' (
fHsmsConfig00( 3
.003 4
remoteIp004 <
;00< =
m_remotePort11 
=11 
m_fSecs1ToHsms11 )
.11) *
fHsmsConfig11* 5
.115 6

remotePort116 @
;11@ A
}22 	
~66 	
	FBaseHsms66	 
(66 
)77 
{88 	
	myDispose99 
(99 
false99 
)99 
;99 
}:: 	
	protected>> 
virtual>> 
void>> 
	myDispose>> (
(>>( )
bool?? 
	disposing?? 
)@@ 
{AA 	
ifBB 
(BB 
!BB 

m_disposedBB 
)BB 
{CC 
ifDD 
(DD 
	disposingDD 
)DD 
{EE 
ifFF 
(FF !
m_fSystemBytesPointerFF -
!=FF. 0
nullFF1 5
)FF5 6
{GG !
m_fSystemBytesPointerHH -
.HH- .
DisposeHH. 5
(HH5 6
)HH6 7
;HH7 8!
m_fSystemBytesPointerII -
=II. /
nullII0 4
;II4 5
}JJ 
m_fSecs1ToHsmsKK "
=KK# $
nullKK% )
;KK) *
}LL 

m_disposedNN 
=NN 
trueNN !
;NN! "
}OO 
}PP 	
publicXX 
voidXX 
DisposeXX 
(XX 
)YY 
{ZZ 	
	myDispose[[ 
([[ 
true[[ 
)[[ 
;[[ 
GC\\ 
.\\ 
SuppressFinalize\\ 
(\\  
this\\  $
)\\$ %
;\\% &
}]] 	
publicee 
FSecs1ToHsmsee 
fSecs1ToHsmsee (
{ff 	
getgg 
{hh 
tryii 
{jj 
returnkk 
m_fSecs1ToHsmskk )
;kk) *
}ll 
catchmm 
(mm 
	Exceptionmm  
exmm! #
)mm# $
{nn 
FDebugoo 
.oo 
throwExceptionoo )
(oo) *
exoo* ,
)oo, -
;oo- .
}pp 
finallyqq 
{rr 
}tt 
returnuu 
nulluu 
;uu 
}vv 
}ww 	
public{{ 
FIDPointer32{{ 
fSystemBytesPointer{{ /
{|| 	
get}} 
{~~ 
try 
{
€€ 
return
 #
m_fSystemBytesPointer
 0
;
0 1
}
‚‚ 
catch
ƒƒ 
(
ƒƒ 
	Exception
ƒƒ  
ex
ƒƒ! #
)
ƒƒ# $
{
„„ 
FDebug
…… 
.
…… 
throwException
…… )
(
……) *
ex
……* ,
)
……, -
;
……- .
}
†† 
finally
‡‡ 
{
ˆˆ 
}
ŠŠ 
return
‹‹ 
null
‹‹ 
;
‹‹ 
}
ŒŒ 
}
 	
public
‘‘ 
string
‘‘ 
localIp
‘‘ 
{
’’ 	
get
““ 
{
”” 
try
•• 
{
–– 
return
—— 
	m_localIp
—— $
;
——$ %
}
˜˜ 
catch
™™ 
(
™™ 
	Exception
™™  
ex
™™! #
)
™™# $
{
šš 
FDebug
›› 
.
›› 
throwException
›› )
(
››) *
ex
››* ,
)
››, -
;
››- .
}
œœ 
finally
 
{
 
}
   
return
¡¡ 
string
¡¡ 
.
¡¡ 
Empty
¡¡ #
;
¡¡# $
}
¢¢ 
set
¤¤ 
{
¥¥ 
try
¦¦ 
{
§§ 
	m_localIp
¨¨ 
=
¨¨ 
value
¨¨  %
;
¨¨% &
}
©© 
catch
ªª 
(
ªª 
	Exception
ªª  
ex
ªª! #
)
ªª# $
{
«« 
FDebug
¬¬ 
.
¬¬ 
throwException
¬¬ )
(
¬¬) *
ex
¬¬* ,
)
¬¬, -
;
¬¬- .
}
­­ 
finally
®® 
{
¯¯ 
}
±± 
}
²² 
}
³³ 	
public
·· 
int
·· 
	localPort
·· 
{
¸¸ 	
get
¹¹ 
{
ºº 
try
»» 
{
¼¼ 
return
½½ 
m_localPort
½½ &
;
½½& '
}
¾¾ 
catch
¿¿ 
(
¿¿ 
	Exception
¿¿  
ex
¿¿! #
)
¿¿# $
{
ÀÀ 
FDebug
ÁÁ 
.
ÁÁ 
throwException
ÁÁ )
(
ÁÁ) *
ex
ÁÁ* ,
)
ÁÁ, -
;
ÁÁ- .
}
ÂÂ 
finally
ÃÃ 
{
ÄÄ 
}
ÆÆ 
return
ÇÇ 
$num
ÇÇ 
;
ÇÇ 
}
ÈÈ 
set
ÊÊ 
{
ËË 
try
ÌÌ 
{
ÍÍ 
m_localPort
ÎÎ 
=
ÎÎ  !
value
ÎÎ" '
;
ÎÎ' (
}
ÏÏ 
catch
ĞĞ 
(
ĞĞ 
	Exception
ĞĞ  
ex
ĞĞ! #
)
ĞĞ# $
{
ÑÑ 
FDebug
ÒÒ 
.
ÒÒ 
throwException
ÒÒ )
(
ÒÒ) *
ex
ÒÒ* ,
)
ÒÒ, -
;
ÒÒ- .
}
ÓÓ 
finally
ÔÔ 
{
ÕÕ 
}
×× 
}
ØØ 
}
ÙÙ 	
public
İİ 
string
İİ 
remoteIp
İİ 
{
ŞŞ 	
get
ßß 
{
àà 
try
áá 
{
ââ 
return
ãã 

m_remoteIp
ãã %
;
ãã% &
}
ää 
catch
åå 
(
åå 
	Exception
åå  
ex
åå! #
)
åå# $
{
ææ 
FDebug
çç 
.
çç 
throwException
çç )
(
çç) *
ex
çç* ,
)
çç, -
;
çç- .
}
èè 
finally
éé 
{
êê 
}
ìì 
return
íí 
string
íí 
.
íí 
Empty
íí #
;
íí# $
}
îî 
set
ğğ 
{
ññ 
try
òò 
{
óó 

m_remoteIp
ôô 
=
ôô  
value
ôô! &
;
ôô& '
}
õõ 
catch
öö 
(
öö 
	Exception
öö  
ex
öö! #
)
öö# $
{
÷÷ 
FDebug
øø 
.
øø 
throwException
øø )
(
øø) *
ex
øø* ,
)
øø, -
;
øø- .
}
ùù 
finally
úú 
{
ûû 
}
ıı 
}
şş 
}
ÿÿ 	
public
ƒƒ 
int
ƒƒ 

remotePort
ƒƒ 
{
„„ 	
get
…… 
{
†† 
try
‡‡ 
{
ˆˆ 
return
‰‰ 
m_remotePort
‰‰ '
;
‰‰' (
}
ŠŠ 
catch
‹‹ 
(
‹‹ 
	Exception
‹‹  
ex
‹‹! #
)
‹‹# $
{
ŒŒ 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
 
{
 
}
’’ 
return
““ 
$num
““ 
;
““ 
}
”” 
set
–– 
{
—— 
try
˜˜ 
{
™™ 
m_remotePort
šš  
=
šš! "
value
šš# (
;
šš( )
}
›› 
catch
œœ 
(
œœ 
	Exception
œœ  
ex
œœ! #
)
œœ# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
ŸŸ 
finally
   
{
¡¡ 
}
££ 
}
¤¤ 
}
¥¥ 	
public
­­ 
abstract
­­ 
void
­­ 
open
­­ !
(
­­! "
)
®® 
;
®® 
public
²² 
abstract
²² 
void
²² 
close
²² "
(
²²" #
)
³³ 
;
³³ 
public
·· 
abstract
·· 
void
·· 
send
·· !
(
··! "
FSecsDataMessage
¸¸ 
fSecsDataMessage
¸¸ -
)
¹¹ 
;
¹¹ 
public
½½ 
string
½½ $
getSelectStatusMessage
½½ ,
(
½½, -
byte
¾¾ 
status
¾¾ 
)
¿¿ 
{
ÀÀ 	
try
ÁÁ 
{
ÂÂ 
if
ÃÃ 
(
ÃÃ 
status
ÃÃ 
==
ÃÃ 
$num
ÃÃ 
)
ÃÃ  
{
ÄÄ 
return
ÅÅ 
string
ÅÅ !
.
ÅÅ! "
Empty
ÅÅ" '
;
ÅÅ' (
}
ÆÆ 
else
ÇÇ 
if
ÇÇ 
(
ÇÇ 
status
ÇÇ 
==
ÇÇ  "
$num
ÇÇ# $
)
ÇÇ$ %
{
ÈÈ 
return
ÉÉ 

FConstants
ÉÉ %
.
ÉÉ% &
err_m_12001
ÉÉ& 1
;
ÉÉ1 2
}
ÊÊ 
else
ËË 
if
ËË 
(
ËË 
status
ËË 
==
ËË  "
$num
ËË# $
)
ËË$ %
{
ÌÌ 
return
ÍÍ 

FConstants
ÍÍ %
.
ÍÍ% &
err_m_12002
ÍÍ& 1
;
ÍÍ1 2
}
ÎÎ 
else
ÏÏ 
if
ÏÏ 
(
ÏÏ 
status
ÏÏ 
==
ÏÏ  "
$num
ÏÏ# $
)
ÏÏ$ %
{
ĞĞ 
return
ÑÑ 

FConstants
ÑÑ %
.
ÑÑ% &
err_m_12003
ÑÑ& 1
;
ÑÑ1 2
}
ÒÒ 
else
ÓÓ 
if
ÓÓ 
(
ÓÓ 
status
ÓÓ 
<
ÓÓ  !
$num
ÓÓ" %
)
ÓÓ% &
{
ÔÔ 
return
ÕÕ 

FConstants
ÕÕ %
.
ÕÕ% &
err_m_12004
ÕÕ& 1
;
ÕÕ1 2
}
ÖÖ 
return
×× 

FConstants
×× !
.
××! "
err_m_12128
××" -
;
××- .
}
ØØ 
catch
ÙÙ 
(
ÙÙ 
	Exception
ÙÙ 
ex
ÙÙ 
)
ÙÙ  
{
ÚÚ 
FDebug
ÛÛ 
.
ÛÛ 
throwException
ÛÛ %
(
ÛÛ% &
ex
ÛÛ& (
)
ÛÛ( )
;
ÛÛ) *
}
ÜÜ 
finally
İİ 
{
ŞŞ 
}
àà 
return
áá 
string
áá 
.
áá 
Empty
áá 
;
áá  
}
ââ 	
public
ææ 
string
ææ &
getDeselectStatusMessage
ææ .
(
ææ. /
int
çç 
status
çç 
)
èè 
{
éé 	
try
êê 
{
ëë 
if
ìì 
(
ìì 
status
ìì 
==
ìì 
$num
ìì 
)
ìì  
{
íí 
return
îî 
string
îî !
.
îî! "
Empty
îî" '
;
îî' (
}
ïï 
else
ğğ 
if
ğğ 
(
ğğ 
status
ğğ 
==
ğğ  "
$num
ğğ# $
)
ğğ$ %
{
ññ 
return
òò 

FConstants
òò %
.
òò% &
err_m_14001
òò& 1
;
òò1 2
}
óó 
else
ôô 
if
ôô 
(
ôô 
status
ôô 
==
ôô  "
$num
ôô# $
)
ôô$ %
{
õõ 
return
öö 

FConstants
öö %
.
öö% &
err_m_14002
öö& 1
;
öö1 2
}
÷÷ 
else
øø 
if
øø 
(
øø 
status
øø 
<
øø  !
$num
øø" %
)
øø% &
{
ùù 
return
úú 

FConstants
úú %
.
úú% &
err_m_14003
úú& 1
;
úú1 2
}
ûû 
return
üü 

FConstants
üü !
.
üü! "
err_m_14128
üü" -
;
üü- .
}
ıı 
catch
şş 
(
şş 
	Exception
şş 
ex
şş 
)
şş  
{
ÿÿ 
FDebug
€€ 
.
€€ 
throwException
€€ %
(
€€% &
ex
€€& (
)
€€( )
;
€€) *
}
 
finally
‚‚ 
{
ƒƒ 
}
…… 
return
†† 
string
†† 
.
†† 
Empty
†† 
;
††  
}
‡‡ 	
public
‹‹ 
string
‹‹ $
getRejectReasonMessage
‹‹ ,
(
‹‹, -
int
ŒŒ 

reasonCode
ŒŒ 
)
 
{
 	
try
 
{
 
if
‘‘ 
(
‘‘ 

reasonCode
‘‘ 
==
‘‘ !
$num
‘‘" #
)
‘‘# $
{
’’ 
return
““ 
string
““ !
.
““! "
Empty
““" '
;
““' (
}
”” 
else
•• 
if
•• 
(
•• 

reasonCode
•• #
==
••$ &
$num
••' (
)
••( )
{
–– 
return
—— 

FConstants
—— %
.
——% &
err_m_17001
——& 1
;
——1 2
}
˜˜ 
else
™™ 
if
™™ 
(
™™ 

reasonCode
™™ #
==
™™$ &
$num
™™' (
)
™™( )
{
šš 
return
›› 

FConstants
›› %
.
››% &
err_m_17002
››& 1
;
››1 2
}
œœ 
else
 
if
 
(
 

reasonCode
 #
==
$ &
$num
' (
)
( )
{
 
return
ŸŸ 

FConstants
ŸŸ %
.
ŸŸ% &
err_m_17003
ŸŸ& 1
;
ŸŸ1 2
}
   
else
¡¡ 
if
¡¡ 
(
¡¡ 

reasonCode
¡¡ #
==
¡¡$ &
$num
¡¡' (
)
¡¡( )
{
¢¢ 
return
££ 

FConstants
££ %
.
££% &
err_m_17004
££& 1
;
££1 2
}
¤¤ 
else
¥¥ 
if
¥¥ 
(
¥¥ 

reasonCode
¥¥ #
<
¥¥$ %
$num
¥¥& )
)
¥¥) *
{
¦¦ 
return
§§ 

FConstants
§§ %
.
§§% &
err_m_17128
§§& 1
;
§§1 2
}
¨¨ 
return
©© 

FConstants
©© !
.
©©! "
err_m_14128
©©" -
;
©©- .
}
ªª 
catch
«« 
(
«« 
	Exception
«« 
ex
«« 
)
««  
{
¬¬ 
FDebug
­­ 
.
­­ 
throwException
­­ %
(
­­% &
ex
­­& (
)
­­( )
;
­­) *
}
®® 
finally
¯¯ 
{
°° 
}
²² 
return
³³ 
string
³³ 
.
³³ 
Empty
³³ 
;
³³  
}
´´ 	
public
¸¸ 
string
¸¸ 
getTimeoutMessage
¸¸ '
(
¸¸' (
FSecsTimeout
¹¹ 
fTimeout
¹¹ !
)
ºº 
{
»» 	
try
¼¼ 
{
½½ 
if
¾¾ 
(
¾¾ 
fTimeout
¾¾ 
==
¾¾ 
FSecsTimeout
¾¾  ,
.
¾¾, -
T3
¾¾- /
)
¾¾/ 0
{
¿¿ 
return
ÀÀ 

FConstants
ÀÀ %
.
ÀÀ% &
err_m_20003
ÀÀ& 1
;
ÀÀ1 2
}
ÁÁ 
else
ÂÂ 
if
ÂÂ 
(
ÂÂ 
fTimeout
ÂÂ !
==
ÂÂ" $
FSecsTimeout
ÂÂ% 1
.
ÂÂ1 2
T5
ÂÂ2 4
)
ÂÂ4 5
{
ÃÃ 
return
ÄÄ 

FConstants
ÄÄ %
.
ÄÄ% &
err_m_20005
ÄÄ& 1
;
ÄÄ1 2
}
ÅÅ 
else
ÆÆ 
if
ÆÆ 
(
ÆÆ 
fTimeout
ÆÆ !
==
ÆÆ" $
FSecsTimeout
ÆÆ% 1
.
ÆÆ1 2
T6
ÆÆ2 4
)
ÆÆ4 5
{
ÇÇ 
return
ÈÈ 

FConstants
ÈÈ %
.
ÈÈ% &
err_m_20006
ÈÈ& 1
;
ÈÈ1 2
}
ÉÉ 
else
ÊÊ 
if
ÊÊ 
(
ÊÊ 
fTimeout
ÊÊ !
==
ÊÊ" $
FSecsTimeout
ÊÊ% 1
.
ÊÊ1 2
T7
ÊÊ2 4
)
ÊÊ4 5
{
ËË 
return
ÌÌ 

FConstants
ÌÌ %
.
ÌÌ% &
err_m_20007
ÌÌ& 1
;
ÌÌ1 2
}
ÍÍ 
else
ÎÎ 
if
ÎÎ 
(
ÎÎ 
fTimeout
ÎÎ !
==
ÎÎ" $
FSecsTimeout
ÎÎ% 1
.
ÎÎ1 2
T8
ÎÎ2 4
)
ÎÎ4 5
{
ÏÏ 
return
ĞĞ 

FConstants
ĞĞ %
.
ĞĞ% &
err_m_20008
ĞĞ& 1
;
ĞĞ1 2
}
ÑÑ 
return
ÒÒ 
string
ÒÒ 
.
ÒÒ 
Empty
ÒÒ #
;
ÒÒ# $
}
ÓÓ 
catch
ÔÔ 
(
ÔÔ 
	Exception
ÔÔ 
ex
ÔÔ 
)
ÔÔ  
{
ÕÕ 
FDebug
ÖÖ 
.
ÖÖ 
throwException
ÖÖ %
(
ÖÖ% &
ex
ÖÖ& (
)
ÖÖ( )
;
ÖÖ) *
}
×× 
finally
ØØ 
{
ÙÙ 
}
ÛÛ 
return
ÜÜ 
string
ÜÜ 
.
ÜÜ 
Empty
ÜÜ 
;
ÜÜ  
}
İİ 	
public
áá 
string
áá #
getTimeoutDescription
áá +
(
áá+ ,
FSecsTimeout
ââ 
fTimeout
ââ !
)
ãã 
{
ää 	
try
åå 
{
ææ 
if
çç 
(
çç 
fTimeout
çç 
==
çç 
FSecsTimeout
çç  ,
.
çç, -
T3
çç- /
)
çç/ 0
{
èè 
return
éé 

FConstants
éé %
.
éé% &
err_m_21003
éé& 1
;
éé1 2
}
êê 
else
ëë 
if
ëë 
(
ëë 
fTimeout
ëë !
==
ëë" $
FSecsTimeout
ëë% 1
.
ëë1 2
T5
ëë2 4
)
ëë4 5
{
ìì 
return
íí 

FConstants
íí %
.
íí% &
err_m_21005
íí& 1
;
íí1 2
}
îî 
else
ïï 
if
ïï 
(
ïï 
fTimeout
ïï !
==
ïï" $
FSecsTimeout
ïï% 1
.
ïï1 2
T6
ïï2 4
)
ïï4 5
{
ğğ 
return
ññ 

FConstants
ññ %
.
ññ% &
err_m_21006
ññ& 1
;
ññ1 2
}
òò 
else
óó 
if
óó 
(
óó 
fTimeout
óó !
==
óó" $
FSecsTimeout
óó% 1
.
óó1 2
T7
óó2 4
)
óó4 5
{
ôô 
return
õõ 

FConstants
õõ %
.
õõ% &
err_m_21007
õõ& 1
;
õõ1 2
}
öö 
else
÷÷ 
if
÷÷ 
(
÷÷ 
fTimeout
÷÷ !
==
÷÷" $
FSecsTimeout
÷÷% 1
.
÷÷1 2
T8
÷÷2 4
)
÷÷4 5
{
øø 
return
ùù 

FConstants
ùù %
.
ùù% &
err_m_21008
ùù& 1
;
ùù1 2
}
úú 
return
ûû 
string
ûû 
.
ûû 
Empty
ûû #
;
ûû# $
}
üü 
catch
ıı 
(
ıı 
	Exception
ıı 
ex
ıı 
)
ıı  
{
şş 
FDebug
ÿÿ 
.
ÿÿ 
throwException
ÿÿ %
(
ÿÿ% &
ex
ÿÿ& (
)
ÿÿ( )
;
ÿÿ) *
}
€€ 
finally
 
{
‚‚ 
}
„„ 
return
…… 
string
…… 
.
…… 
Empty
…… 
;
……  
}
†† 	
}
ŒŒ 
} Ş
}D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Protocol\HSMS\c_FHsmsRecvBuffer.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
internal 
class 
FHsmsRecvBuffer "
:# $
IDisposable% 0
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
List 
< 
byte 
> 
m_data !
=" #
null$ (
;( )
private 
bool 
m_isLengthComp #
=$ %
false& +
;+ ,
private 
bool 
m_isHeaderComp #
=$ %
false& +
;+ ,
private   
bool   
m_isBodyComp   !
=  " #
false  $ )
;  ) *
private!! 
bool!! 
m_isCompleted!! "
=!!# $
true!!% )
;!!) *
private## 
UInt32## 
m_length## 
=##  !
$num##" #
;### $
private$$ 
UInt16$$ 
m_sessionId$$ "
=$$# $
$num$$% &
;$$& '
private%% 
byte%% 
m_byte2%% 
=%% 
$num%%  
;%%  !
private&& 
byte&& 
m_byte3&& 
=&& 
$num&&  
;&&  !
private'' 
byte'' 
m_ptype'' 
='' 
$num''  
;''  !
private(( 
byte(( 
m_stype(( 
=(( 
$num((  
;((  !
private)) 
UInt32)) 
m_systemBytes)) $
=))% &
$num))' (
;))( )
private** 
List** 
<** 
byte** 
>** 
m_body** !
=**" #
null**$ (
;**( )
public00 
FHsmsRecvBuffer00 
(00 
)11 
{22 	
m_data33 
=33 
new33 
List33 
<33 
byte33 "
>33" #
(33# $
)33$ %
;33% &
}44 	
~88 	
FHsmsRecvBuffer88	 
(88 
)99 
{:: 	
	myDispose;; 
(;; 
false;; 
);; 
;;; 
}<< 	
	protected@@ 
void@@ 
	myDispose@@  
(@@  !
boolAA 
	disposingAA 
)BB 
{CC 	
ifDD 
(DD 
!DD 

m_disposedDD 
)DD 
{EE 
ifFF 
(FF 
	disposingFF 
)FF 
{GG 
m_dataHH 
=HH 
nullHH !
;HH! "
m_bodyII 
=II 
nullII !
;II! "
}JJ 

m_disposedKK 
=KK 
trueKK !
;KK! "
}LL 
}MM 	
publicUU 
voidUU 
DisposeUU 
(UU 
)VV 
{WW 	
	myDisposeXX 
(XX 
trueXX 
)XX 
;XX 
GCYY 
.YY 
SuppressFinalizeYY 
(YY  
thisYY  $
)YY$ %
;YY% &
}ZZ 	
publicbb 
boolbb 
isCompletedbb 
{cc 	
getdd 
{ee 
tryff 
{gg 
returnhh 
m_isCompletedhh (
;hh( )
}ii 
catchjj 
(jj 
	Exceptionjj  
exjj! #
)jj# $
{kk 
FDebugll 
.ll 
throwExceptionll )
(ll) *
exll* ,
)ll, -
;ll- .
}mm 
finallynn 
{oo 
}qq 
returnrr 
falserr 
;rr 
}ss 
}tt 	
publicxx 
UInt32xx 
lengthxx 
{yy 	
getzz 
{{{ 
try|| 
{}} 
return~~ 
m_length~~ #
;~~# $
} 
catch
€€ 
(
€€ 
	Exception
€€  
ex
€€! #
)
€€# $
{
 
FDebug
‚‚ 
.
‚‚ 
throwException
‚‚ )
(
‚‚) *
ex
‚‚* ,
)
‚‚, -
;
‚‚- .
}
ƒƒ 
finally
„„ 
{
…… 
}
‡‡ 
return
ˆˆ 
$num
ˆˆ 
;
ˆˆ 
}
‰‰ 
}
ŠŠ 	
public
 
UInt16
 
	sessionId
 
{
 	
get
 
{
‘‘ 
try
’’ 
{
““ 
return
”” 
m_sessionId
”” &
;
””& '
}
•• 
catch
–– 
(
–– 
	Exception
––  
ex
––! #
)
––# $
{
—— 
FDebug
˜˜ 
.
˜˜ 
throwException
˜˜ )
(
˜˜) *
ex
˜˜* ,
)
˜˜, -
;
˜˜- .
}
™™ 
finally
šš 
{
›› 
}
 
return
 
$num
 
;
 
}
ŸŸ 
}
   	
public
¤¤ 
byte
¤¤ 
byte2
¤¤ 
{
¥¥ 	
get
¦¦ 
{
§§ 
try
¨¨ 
{
©© 
return
ªª 
m_byte2
ªª "
;
ªª" #
}
«« 
catch
¬¬ 
(
¬¬ 
	Exception
¬¬  
ex
¬¬! #
)
¬¬# $
{
­­ 
FDebug
®® 
.
®® 
throwException
®® )
(
®®) *
ex
®®* ,
)
®®, -
;
®®- .
}
¯¯ 
finally
°° 
{
±± 
}
³³ 
return
´´ 
$num
´´ 
;
´´ 
}
µµ 
}
¶¶ 	
public
ºº 
byte
ºº 
byte3
ºº 
{
»» 	
get
¼¼ 
{
½½ 
try
¾¾ 
{
¿¿ 
return
ÀÀ 
m_byte3
ÀÀ "
;
ÀÀ" #
}
ÁÁ 
catch
ÂÂ 
(
ÂÂ 
	Exception
ÂÂ  
ex
ÂÂ! #
)
ÂÂ# $
{
ÃÃ 
FDebug
ÄÄ 
.
ÄÄ 
throwException
ÄÄ )
(
ÄÄ) *
ex
ÄÄ* ,
)
ÄÄ, -
;
ÄÄ- .
}
ÅÅ 
finally
ÆÆ 
{
ÇÇ 
}
ÉÉ 
return
ÊÊ 
$num
ÊÊ 
;
ÊÊ 
}
ËË 
}
ÌÌ 	
public
ĞĞ 
byte
ĞĞ 
ptype
ĞĞ 
{
ÑÑ 	
get
ÒÒ 
{
ÓÓ 
try
ÔÔ 
{
ÕÕ 
return
ÖÖ 
m_ptype
ÖÖ "
;
ÖÖ" #
}
×× 
catch
ØØ 
(
ØØ 
	Exception
ØØ  
ex
ØØ! #
)
ØØ# $
{
ÙÙ 
FDebug
ÚÚ 
.
ÚÚ 
throwException
ÚÚ )
(
ÚÚ) *
ex
ÚÚ* ,
)
ÚÚ, -
;
ÚÚ- .
}
ÛÛ 
finally
ÜÜ 
{
İİ 
}
ßß 
return
àà 
$num
àà 
;
àà 
}
áá 
}
ââ 	
public
ææ 
byte
ææ 
stype
ææ 
{
çç 	
get
èè 
{
éé 
try
êê 
{
ëë 
return
ìì 
m_stype
ìì "
;
ìì" #
}
íí 
catch
îî 
(
îî 
	Exception
îî  
ex
îî! #
)
îî# $
{
ïï 
FDebug
ğğ 
.
ğğ 
throwException
ğğ )
(
ğğ) *
ex
ğğ* ,
)
ğğ, -
;
ğğ- .
}
ññ 
finally
òò 
{
óó 
}
õõ 
return
öö 
$num
öö 
;
öö 
}
÷÷ 
}
øø 	
public
üü 
UInt32
üü 
systemBytes
üü !
{
ıı 	
get
şş 
{
ÿÿ 
try
€€ 
{
 
return
‚‚ 
m_systemBytes
‚‚ (
;
‚‚( )
}
ƒƒ 
catch
„„ 
(
„„ 
	Exception
„„  
ex
„„! #
)
„„# $
{
…… 
FDebug
†† 
.
†† 
throwException
†† )
(
††) *
ex
††* ,
)
††, -
;
††- .
}
‡‡ 
finally
ˆˆ 
{
‰‰ 
}
‹‹ 
return
ŒŒ 
$num
ŒŒ 
;
ŒŒ 
}
 
}
 	
public
’’ 
byte
’’ 
[
’’ 
]
’’ 
body
’’ 
{
““ 	
get
”” 
{
•• 
try
–– 
{
—— 
return
˜˜ 
m_body
˜˜ !
.
˜˜! "
ToArray
˜˜" )
(
˜˜) *
)
˜˜* +
;
˜˜+ ,
}
™™ 
catch
šš 
(
šš 
	Exception
šš  
ex
šš! #
)
šš# $
{
›› 
FDebug
œœ 
.
œœ 
throwException
œœ )
(
œœ) *
ex
œœ* ,
)
œœ, -
;
œœ- .
}
 
finally
 
{
ŸŸ 
}
¡¡ 
return
¢¢ 
null
¢¢ 
;
¢¢ 
}
££ 
}
¤¤ 	
public
¨¨ 
byte
¨¨ 
stream
¨¨ 
{
©© 	
get
ªª 
{
«« 
try
¬¬ 
{
­­ 
return
®® 
(
®® 
byte
®®  
)
®®  !
(
®®! "
m_byte2
®®" )
&
®®* +
$num
®®, 0
)
®®0 1
;
®®1 2
}
¯¯ 
catch
°° 
(
°° 
	Exception
°°  
ex
°°! #
)
°°# $
{
±± 
FDebug
²² 
.
²² 
throwException
²² )
(
²²) *
ex
²²* ,
)
²², -
;
²²- .
}
³³ 
finally
´´ 
{
µµ 
}
·· 
return
¸¸ 
$num
¸¸ 
;
¸¸ 
}
¹¹ 
}
ºº 	
public
¾¾ 
byte
¾¾ 
function
¾¾ 
{
¿¿ 	
get
ÀÀ 
{
ÁÁ 
try
ÂÂ 
{
ÃÃ 
return
ÄÄ 
m_byte3
ÄÄ "
;
ÄÄ" #
}
ÅÅ 
catch
ÆÆ 
(
ÆÆ 
	Exception
ÆÆ  
ex
ÆÆ! #
)
ÆÆ# $
{
ÇÇ 
FDebug
ÈÈ 
.
ÈÈ 
throwException
ÈÈ )
(
ÈÈ) *
ex
ÈÈ* ,
)
ÈÈ, -
;
ÈÈ- .
}
ÉÉ 
finally
ÊÊ 
{
ËË 
}
ÍÍ 
return
ÎÎ 
$num
ÎÎ 
;
ÎÎ 
}
ÏÏ 
}
ĞĞ 	
public
ÔÔ 
bool
ÔÔ 
wbit
ÔÔ 
{
ÕÕ 	
get
ÖÖ 
{
×× 
try
ØØ 
{
ÙÙ 
return
ÚÚ 
(
ÚÚ 
m_byte2
ÚÚ #
&
ÚÚ$ %
$num
ÚÚ& *
)
ÚÚ* +
==
ÚÚ, .
$num
ÚÚ/ 3
?
ÚÚ4 5
false
ÚÚ6 ;
:
ÚÚ< =
true
ÚÚ> B
;
ÚÚB C
}
ÛÛ 
catch
ÜÜ 
(
ÜÜ 
	Exception
ÜÜ  
ex
ÜÜ! #
)
ÜÜ# $
{
İİ 
FDebug
ŞŞ 
.
ŞŞ 
throwException
ŞŞ )
(
ŞŞ) *
ex
ŞŞ* ,
)
ŞŞ, -
;
ŞŞ- .
}
ßß 
finally
àà 
{
áá 
}
ãã 
return
ää 
false
ää 
;
ää 
}
åå 
}
ææ 	
public
îî 
void
îî 
init
îî 
(
îî 
)
ïï 
{
ğğ 	
try
ññ 
{
òò 
m_isLengthComp
óó 
=
óó  
false
óó! &
;
óó& '
m_isHeaderComp
ôô 
=
ôô  
false
ôô! &
;
ôô& '
m_isBodyComp
õõ 
=
õõ 
false
õõ $
;
õõ$ %
m_length
÷÷ 
=
÷÷ 
$num
÷÷ 
;
÷÷ 
m_sessionId
øø 
=
øø 
$num
øø 
;
øø  
m_byte2
ùù 
=
ùù 
$num
ùù 
;
ùù 
m_byte3
úú 
=
úú 
$num
úú 
;
úú 
m_ptype
ûû 
=
ûû 
$num
ûû 
;
ûû 
m_stype
üü 
=
üü 
$num
üü 
;
üü 
m_systemBytes
ıı 
=
ıı 
$num
ıı  !
;
ıı! "
m_body
şş 
=
şş 
new
şş 
List
şş !
<
şş! "
byte
şş" &
>
şş& '
(
şş' (
)
şş( )
;
şş) *
}
ÿÿ 
catch
€€ 
(
€€ 
	Exception
€€ 
ex
€€ 
)
€€  
{
 
FDebug
‚‚ 
.
‚‚ 
throwException
‚‚ %
(
‚‚% &
ex
‚‚& (
)
‚‚( )
;
‚‚) *
}
ƒƒ 
finally
„„ 
{
…… 
}
‡‡ 
}
ˆˆ 	
public
ŒŒ 
void
ŒŒ 
clear
ŒŒ 
(
ŒŒ 
)
 
{
 	
try
 
{
 
init
‘‘ 
(
‘‘ 
)
‘‘ 
;
‘‘ 
m_data
’’ 
.
’’ 
Clear
’’ 
(
’’ 
)
’’ 
;
’’ 
}
““ 
catch
”” 
(
”” 
	Exception
”” 
ex
”” 
)
””  
{
•• 
FDebug
–– 
.
–– 
throwException
–– %
(
––% &
ex
––& (
)
––( )
;
––) *
}
—— 
finally
˜˜ 
{
™™ 
}
›› 
}
œœ 	
public
   
void
   
input
   
(
   
byte
¡¡ 
[
¡¡ 
]
¡¡ 
data
¡¡ 
)
¢¢ 
{
££ 	
try
¤¤ 
{
¥¥ 
m_data
¦¦ 
.
¦¦ 
AddRange
¦¦ 
(
¦¦  
data
¦¦  $
)
¦¦$ %
;
¦¦% &
}
§§ 
catch
¨¨ 
(
¨¨ 
	Exception
¨¨ 
ex
¨¨ 
)
¨¨  
{
©© 
FDebug
ªª 
.
ªª 
throwException
ªª %
(
ªª% &
ex
ªª& (
)
ªª( )
;
ªª) *
}
«« 
finally
¬¬ 
{
­­ 
}
¯¯ 
}
°° 	
public
´´ 
bool
´´ 
parse
´´ 
(
´´ 
)
µµ 
{
¶¶ 	
try
·· 
{
¸¸ 
while
¹¹ 
(
¹¹ 
m_data
¹¹ 
.
¹¹ 
Count
¹¹ #
>
¹¹$ %
$num
¹¹& '
)
¹¹' (
{
ºº 
if
»» 
(
»» 
!
»» 
m_isLengthComp
»» '
)
»»' (
{
¼¼ 
m_isCompleted
½½ %
=
½½& '
false
½½( -
;
½½- .
if
¾¾ 
(
¾¾ 
m_data
¾¾ "
.
¾¾" #
Count
¾¾# (
<
¾¾) *
$num
¾¾+ ,
)
¾¾, -
{
¿¿ 
break
ÀÀ !
;
ÀÀ! "
}
ÁÁ 
m_length
ÃÃ  
=
ÃÃ! "
FByteConverter
ÃÃ# 1
.
ÃÃ1 2
toUInt32
ÃÃ2 :
(
ÃÃ: ;
m_data
ÃÃ; A
.
ÃÃA B
GetRange
ÃÃB J
(
ÃÃJ K
$num
ÃÃK L
,
ÃÃL M
$num
ÃÃN O
)
ÃÃO P
.
ÃÃP Q
ToArray
ÃÃQ X
(
ÃÃX Y
)
ÃÃY Z
,
ÃÃZ [
true
ÃÃ\ `
)
ÃÃ` a
;
ÃÃa b
m_data
ÅÅ 
.
ÅÅ 
RemoveRange
ÅÅ *
(
ÅÅ* +
$num
ÅÅ+ ,
,
ÅÅ, -
$num
ÅÅ. /
)
ÅÅ/ 0
;
ÅÅ0 1
m_isLengthComp
ÆÆ &
=
ÆÆ' (
true
ÆÆ) -
;
ÆÆ- .
}
ÇÇ 
else
ÈÈ 
if
ÈÈ 
(
ÈÈ 
!
ÈÈ 
m_isHeaderComp
ÈÈ ,
)
ÈÈ, -
{
ÉÉ 
if
ÊÊ 
(
ÊÊ 
m_data
ÊÊ "
.
ÊÊ" #
Count
ÊÊ# (
<
ÊÊ) *
$num
ÊÊ+ -
)
ÊÊ- .
{
ËË 
break
ÌÌ !
;
ÌÌ! "
}
ÍÍ 
m_sessionId
ÏÏ #
=
ÏÏ$ %
FByteConverter
ÏÏ& 4
.
ÏÏ4 5
toUInt16
ÏÏ5 =
(
ÏÏ= >
m_data
ÏÏ> D
.
ÏÏD E
GetRange
ÏÏE M
(
ÏÏM N
$num
ÏÏN O
,
ÏÏO P
$num
ÏÏQ R
)
ÏÏR S
.
ÏÏS T
ToArray
ÏÏT [
(
ÏÏ[ \
)
ÏÏ\ ]
,
ÏÏ] ^
true
ÏÏ_ c
)
ÏÏc d
;
ÏÏd e
m_byte2
ĞĞ 
=
ĞĞ  !
m_data
ĞĞ" (
[
ĞĞ( )
$num
ĞĞ) *
]
ĞĞ* +
;
ĞĞ+ ,
m_byte3
ÑÑ 
=
ÑÑ  !
m_data
ÑÑ" (
[
ÑÑ( )
$num
ÑÑ) *
]
ÑÑ* +
;
ÑÑ+ ,
m_ptype
ÒÒ 
=
ÒÒ  !
m_data
ÒÒ" (
[
ÒÒ( )
$num
ÒÒ) *
]
ÒÒ* +
;
ÒÒ+ ,
m_stype
ÓÓ 
=
ÓÓ  !
m_data
ÓÓ" (
[
ÓÓ( )
$num
ÓÓ) *
]
ÓÓ* +
;
ÓÓ+ ,
m_systemBytes
ÔÔ %
=
ÔÔ& '
FByteConverter
ÔÔ( 6
.
ÔÔ6 7
toUInt32
ÔÔ7 ?
(
ÔÔ? @
m_data
ÔÔ@ F
.
ÔÔF G
GetRange
ÔÔG O
(
ÔÔO P
$num
ÔÔP Q
,
ÔÔQ R
$num
ÔÔS T
)
ÔÔT U
.
ÔÔU V
ToArray
ÔÔV ]
(
ÔÔ] ^
)
ÔÔ^ _
,
ÔÔ_ `
true
ÔÔa e
)
ÔÔe f
;
ÔÔf g
m_data
ÖÖ 
.
ÖÖ 
RemoveRange
ÖÖ *
(
ÖÖ* +
$num
ÖÖ+ ,
,
ÖÖ, -
$num
ÖÖ. 0
)
ÖÖ0 1
;
ÖÖ1 2
m_isHeaderComp
×× &
=
××' (
true
××) -
;
××- .
if
ÜÜ 
(
ÜÜ 
m_length
ÜÜ $
==
ÜÜ% '
$num
ÜÜ( *
)
ÜÜ* +
{
İİ 
m_isBodyComp
ŞŞ (
=
ŞŞ) *
true
ŞŞ+ /
;
ŞŞ/ 0
m_isCompleted
ßß )
=
ßß* +
true
ßß, 0
;
ßß0 1
return
àà "
true
àà# '
;
àà' (
}
áá 
}
ââ 
else
ãã 
if
ãã 
(
ãã 
!
ãã 
m_isBodyComp
ãã *
)
ãã* +
{
ää 
if
åå 
(
åå 
m_data
åå "
.
åå" #
Count
åå# (
<
åå) *
m_length
åå+ 3
-
åå4 5
$num
åå6 8
)
åå8 9
{
ææ 
break
çç !
;
çç! "
}
èè 
m_body
êê 
.
êê 
AddRange
êê '
(
êê' (
m_data
êê( .
.
êê. /
GetRange
êê/ 7
(
êê7 8
$num
êê8 9
,
êê9 :
(
êê; <
int
êê< ?
)
êê? @
(
êê@ A
m_length
êêA I
-
êêJ K
$num
êêL N
)
êêN O
)
êêO P
.
êêP Q
ToArray
êêQ X
(
êêX Y
)
êêY Z
)
êêZ [
;
êê[ \
m_data
ìì 
.
ìì 
RemoveRange
ìì *
(
ìì* +
$num
ìì+ ,
,
ìì, -
(
ìì. /
int
ìì/ 2
)
ìì2 3
(
ìì3 4
m_length
ìì4 <
-
ìì= >
$num
ìì? A
)
ììA B
)
ììB C
;
ììC D
m_isBodyComp
íí $
=
íí% &
true
íí' +
;
íí+ ,
m_isCompleted
îî %
=
îî& '
true
îî( ,
;
îî, -
return
ïï 
true
ïï #
;
ïï# $
}
ğğ 
}
ññ 
return
òò 
false
òò 
;
òò 
}
óó 
catch
ôô 
(
ôô 
	Exception
ôô 
ex
ôô 
)
ôô  
{
õõ 
FDebug
öö 
.
öö 
throwException
öö %
(
öö% &
ex
öö& (
)
öö( )
;
öö) *
}
÷÷ 
finally
øø 
{
ùù 
}
ûû 
return
üü 
false
üü 
;
üü 
}
ıı 	
}
ƒƒ 
}„„ ²ë
}D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Protocol\HSMS\c_FHsmsSendBuffer.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
internal 
class 
FHsmsSendBuffer "
:# $
IDisposable% 0
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
UInt16 
m_sessionId "
=# $
$num% &
;& '
private 
byte 
m_byte2 
= 
$num  
;  !
private 
byte 
m_byte3 
= 
$num  
;  !
private   
byte   
m_ptype   
=   
$num    
;    !
private!! 
byte!! 
m_stype!! 
=!! 
$num!!  
;!!  !
private"" 
UInt32"" 
m_systemBytes"" $
=""% &
$num""' (
;""( )
private## 
List## 
<## 
byte## 
>## 
m_body## !
=##" #
null##$ (
;##( )
public)) 
FHsmsSendBuffer)) 
()) 
)** 
{++ 	
}-- 	
~11 	
FHsmsSendBuffer11	 
(11 
)22 
{33 	
	myDispose44 
(44 
false44 
)44 
;44 
}55 	
	protected99 
void99 
	myDispose99  
(99  !
bool:: 
	disposing:: 
);; 
{<< 	
if== 
(== 
!== 

m_disposed== 
)== 
{>> 
if?? 
(?? 
	disposing?? 
)?? 
{@@ 
}BB 

m_disposedCC 
=CC 
trueCC !
;CC! "
}DD 
}EE 	
publicMM 
voidMM 
DisposeMM 
(MM 
)NN 
{OO 	
	myDisposePP 
(PP 
truePP 
)PP 
;PP 
GCQQ 
.QQ 
SuppressFinalizeQQ 
(QQ  
thisQQ  $
)QQ$ %
;QQ% &
}RR 	
publicZZ 
UInt32ZZ 
lengthZZ 
{[[ 	
get\\ 
{]] 
try^^ 
{__ 
return`` 
(`` 
UInt32`` "
)``" #
(``# $
$num``$ &
+``' (
m_body``) /
.``/ 0
Count``0 5
)``5 6
;``6 7
}aa 
catchbb 
(bb 
	Exceptionbb  
exbb! #
)bb# $
{cc 
FDebugdd 
.dd 
throwExceptiondd )
(dd) *
exdd* ,
)dd, -
;dd- .
}ee 
finallyff 
{gg 
}ii 
returnjj 
$numjj 
;jj 
}kk 
}ll 	
publicpp 
UInt16pp 
	sessionIdpp 
{qq 	
getrr 
{ss 
trytt 
{uu 
returnvv 
m_sessionIdvv &
;vv& '
}ww 
catchxx 
(xx 
	Exceptionxx  
exxx! #
)xx# $
{yy 
FDebugzz 
.zz 
throwExceptionzz )
(zz) *
exzz* ,
)zz, -
;zz- .
}{{ 
finally|| 
{}} 
} 
return
€€ 
$num
€€ 
;
€€ 
}
 
set
ƒƒ 
{
„„ 
try
…… 
{
†† 
m_sessionId
‡‡ 
=
‡‡  !
value
‡‡" '
;
‡‡' (
}
ˆˆ 
catch
‰‰ 
(
‰‰ 
	Exception
‰‰  
ex
‰‰! #
)
‰‰# $
{
ŠŠ 
FDebug
‹‹ 
.
‹‹ 
throwException
‹‹ )
(
‹‹) *
ex
‹‹* ,
)
‹‹, -
;
‹‹- .
}
ŒŒ 
finally
 
{
 
}
 
}
‘‘ 
}
’’ 	
public
–– 
byte
–– 
byte2
–– 
{
—— 	
get
˜˜ 
{
™™ 
try
šš 
{
›› 
return
œœ 
m_byte2
œœ "
;
œœ" #
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
ŸŸ 
FDebug
   
.
   
throwException
   )
(
  ) *
ex
  * ,
)
  , -
;
  - .
}
¡¡ 
finally
¢¢ 
{
££ 
}
¥¥ 
return
¦¦ 
$num
¦¦ 
;
¦¦ 
}
§§ 
set
©© 
{
ªª 
try
«« 
{
¬¬ 
m_byte2
­­ 
=
­­ 
value
­­ #
;
­­# $
}
®® 
catch
¯¯ 
(
¯¯ 
	Exception
¯¯  
ex
¯¯! #
)
¯¯# $
{
°° 
FDebug
±± 
.
±± 
throwException
±± )
(
±±) *
ex
±±* ,
)
±±, -
;
±±- .
}
²² 
finally
³³ 
{
´´ 
}
¶¶ 
}
·· 
}
¸¸ 	
public
¼¼ 
byte
¼¼ 
byte3
¼¼ 
{
½½ 	
get
¾¾ 
{
¿¿ 
try
ÀÀ 
{
ÁÁ 
return
ÂÂ 
m_byte3
ÂÂ "
;
ÂÂ" #
}
ÃÃ 
catch
ÄÄ 
(
ÄÄ 
	Exception
ÄÄ  
ex
ÄÄ! #
)
ÄÄ# $
{
ÅÅ 
FDebug
ÆÆ 
.
ÆÆ 
throwException
ÆÆ )
(
ÆÆ) *
ex
ÆÆ* ,
)
ÆÆ, -
;
ÆÆ- .
}
ÇÇ 
finally
ÈÈ 
{
ÉÉ 
}
ËË 
return
ÌÌ 
$num
ÌÌ 
;
ÌÌ 
}
ÍÍ 
set
ÏÏ 
{
ĞĞ 
try
ÑÑ 
{
ÒÒ 
m_byte3
ÓÓ 
=
ÓÓ 
value
ÓÓ #
;
ÓÓ# $
}
ÔÔ 
catch
ÕÕ 
(
ÕÕ 
	Exception
ÕÕ  
ex
ÕÕ! #
)
ÕÕ# $
{
ÖÖ 
FDebug
×× 
.
×× 
throwException
×× )
(
××) *
ex
××* ,
)
××, -
;
××- .
}
ØØ 
finally
ÙÙ 
{
ÚÚ 
}
ÜÜ 
}
İİ 
}
ŞŞ 	
public
ââ 
byte
ââ 
ptype
ââ 
{
ãã 	
get
ää 
{
åå 
try
ææ 
{
çç 
return
èè 
m_ptype
èè "
;
èè" #
}
éé 
catch
êê 
(
êê 
	Exception
êê  
ex
êê! #
)
êê# $
{
ëë 
FDebug
ìì 
.
ìì 
throwException
ìì )
(
ìì) *
ex
ìì* ,
)
ìì, -
;
ìì- .
}
íí 
finally
îî 
{
ïï 
}
ññ 
return
òò 
$num
òò 
;
òò 
}
óó 
set
õõ 
{
öö 
try
÷÷ 
{
øø 
m_ptype
ùù 
=
ùù 
value
ùù #
;
ùù# $
}
úú 
catch
ûû 
(
ûû 
	Exception
ûû  
ex
ûû! #
)
ûû# $
{
üü 
FDebug
ıı 
.
ıı 
throwException
ıı )
(
ıı) *
ex
ıı* ,
)
ıı, -
;
ıı- .
}
şş 
finally
ÿÿ 
{
€€ 
}
‚‚ 
}
ƒƒ 
}
„„ 	
public
ˆˆ 
byte
ˆˆ 
stype
ˆˆ 
{
‰‰ 	
get
ŠŠ 
{
‹‹ 
try
ŒŒ 
{
 
return
 
m_stype
 "
;
" #
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
‘‘ 
FDebug
’’ 
.
’’ 
throwException
’’ )
(
’’) *
ex
’’* ,
)
’’, -
;
’’- .
}
““ 
finally
”” 
{
•• 
}
—— 
return
˜˜ 
$num
˜˜ 
;
˜˜ 
}
™™ 
set
›› 
{
œœ 
try
 
{
 
m_stype
ŸŸ 
=
ŸŸ 
value
ŸŸ #
;
ŸŸ# $
}
   
catch
¡¡ 
(
¡¡ 
	Exception
¡¡  
ex
¡¡! #
)
¡¡# $
{
¢¢ 
FDebug
££ 
.
££ 
throwException
££ )
(
££) *
ex
££* ,
)
££, -
;
££- .
}
¤¤ 
finally
¥¥ 
{
¦¦ 
}
¨¨ 
}
©© 
}
ªª 	
public
®® 
UInt32
®® 
systemBytes
®® !
{
¯¯ 	
get
°° 
{
±± 
try
²² 
{
³³ 
return
´´ 
m_systemBytes
´´ (
;
´´( )
}
µµ 
catch
¶¶ 
(
¶¶ 
	Exception
¶¶  
ex
¶¶! #
)
¶¶# $
{
·· 
FDebug
¸¸ 
.
¸¸ 
throwException
¸¸ )
(
¸¸) *
ex
¸¸* ,
)
¸¸, -
;
¸¸- .
}
¹¹ 
finally
ºº 
{
»» 
}
½½ 
return
¾¾ 
$num
¾¾ 
;
¾¾ 
}
¿¿ 
set
ÁÁ 
{
ÂÂ 
try
ÃÃ 
{
ÄÄ 
m_systemBytes
ÅÅ !
=
ÅÅ" #
value
ÅÅ$ )
;
ÅÅ) *
}
ÆÆ 
catch
ÇÇ 
(
ÇÇ 
	Exception
ÇÇ  
ex
ÇÇ! #
)
ÇÇ# $
{
ÈÈ 
FDebug
ÉÉ 
.
ÉÉ 
throwException
ÉÉ )
(
ÉÉ) *
ex
ÉÉ* ,
)
ÉÉ, -
;
ÉÉ- .
}
ÊÊ 
finally
ËË 
{
ÌÌ 
}
ÎÎ 
}
ÏÏ 
}
ĞĞ 	
public
ÔÔ 
byte
ÔÔ 
[
ÔÔ 
]
ÔÔ 
body
ÔÔ 
{
ÕÕ 	
get
ÖÖ 
{
×× 
try
ØØ 
{
ÙÙ 
return
ÚÚ 
m_body
ÚÚ !
.
ÚÚ! "
ToArray
ÚÚ" )
(
ÚÚ) *
)
ÚÚ* +
;
ÚÚ+ ,
}
ÛÛ 
catch
ÜÜ 
(
ÜÜ 
	Exception
ÜÜ  
ex
ÜÜ! #
)
ÜÜ# $
{
İİ 
FDebug
ŞŞ 
.
ŞŞ 
throwException
ŞŞ )
(
ŞŞ) *
ex
ŞŞ* ,
)
ŞŞ, -
;
ŞŞ- .
}
ßß 
finally
àà 
{
áá 
}
ãã 
return
ää 
null
ää 
;
ää 
}
åå 
set
çç 
{
èè 
try
éé 
{
êê 
if
ëë 
(
ëë 
value
ëë 
==
ëë  
null
ëë! %
)
ëë% &
{
ìì 
m_body
íí 
.
íí 
Clear
íí $
(
íí$ %
)
íí% &
;
íí& '
}
îî 
else
ïï 
{
ğğ 
m_body
ññ 
=
ññ  
new
ññ! $
List
ññ% )
<
ññ) *
byte
ññ* .
>
ññ. /
(
ññ/ 0
value
ññ0 5
)
ññ5 6
;
ññ6 7
}
òò 
}
óó 
catch
ôô 
(
ôô 
	Exception
ôô  
ex
ôô! #
)
ôô# $
{
õõ 
FDebug
öö 
.
öö 
throwException
öö )
(
öö) *
ex
öö* ,
)
öö, -
;
öö- .
}
÷÷ 
finally
øø 
{
ùù 
}
ûû 
}
üü 
}
ıı 	
public
 
int
 
stream
 
{
‚‚ 	
get
ƒƒ 
{
„„ 
try
…… 
{
†† 
return
‡‡ 
m_byte2
‡‡ "
&
‡‡# $
$num
‡‡% )
;
‡‡) *
}
ˆˆ 
catch
‰‰ 
(
‰‰ 
	Exception
‰‰  
ex
‰‰! #
)
‰‰# $
{
ŠŠ 
FDebug
‹‹ 
.
‹‹ 
throwException
‹‹ )
(
‹‹) *
ex
‹‹* ,
)
‹‹, -
;
‹‹- .
}
ŒŒ 
finally
 
{
 
}
 
return
‘‘ 
$num
‘‘ 
;
‘‘ 
}
’’ 
}
““ 	
public
—— 
int
—— 
function
—— 
{
˜˜ 	
get
™™ 
{
šš 
try
›› 
{
œœ 
return
 
m_byte3
 "
;
" #
}
 
catch
ŸŸ 
(
ŸŸ 
	Exception
ŸŸ  
ex
ŸŸ! #
)
ŸŸ# $
{
   
FDebug
¡¡ 
.
¡¡ 
throwException
¡¡ )
(
¡¡) *
ex
¡¡* ,
)
¡¡, -
;
¡¡- .
}
¢¢ 
finally
££ 
{
¤¤ 
}
¦¦ 
return
§§ 
$num
§§ 
;
§§ 
}
¨¨ 
}
©© 	
public
­­ 
bool
­­ 
wbit
­­ 
{
®® 	
get
¯¯ 
{
°° 
try
±± 
{
²² 
return
³³ 
(
³³ 
m_byte2
³³ #
&
³³$ %
$num
³³& *
)
³³* +
==
³³, .
$num
³³/ 3
?
³³4 5
false
³³6 ;
:
³³< =
true
³³> B
;
³³B C
}
´´ 
catch
µµ 
(
µµ 
	Exception
µµ  
ex
µµ! #
)
µµ# $
{
¶¶ 
FDebug
·· 
.
·· 
throwException
·· )
(
··) *
ex
··* ,
)
··, -
;
··- .
}
¸¸ 
finally
¹¹ 
{
ºº 
}
¼¼ 
return
½½ 
false
½½ 
;
½½ 
}
¾¾ 
}
¿¿ 	
public
ÇÇ 
void
ÇÇ 
init
ÇÇ 
(
ÇÇ 
)
ÈÈ 
{
ÉÉ 	
try
ÊÊ 
{
ËË 
m_sessionId
ÌÌ 
=
ÌÌ 
$num
ÌÌ 
;
ÌÌ  
m_byte2
ÍÍ 
=
ÍÍ 
$num
ÍÍ 
;
ÍÍ 
m_byte3
ÎÎ 
=
ÎÎ 
$num
ÎÎ 
;
ÎÎ 
m_ptype
ÏÏ 
=
ÏÏ 
$num
ÏÏ 
;
ÏÏ 
m_stype
ĞĞ 
=
ĞĞ 
$num
ĞĞ 
;
ĞĞ 
m_systemBytes
ÑÑ 
=
ÑÑ 
$num
ÑÑ  !
;
ÑÑ! "
m_body
ÒÒ 
=
ÒÒ 
new
ÒÒ 
List
ÒÒ !
<
ÒÒ! "
byte
ÒÒ" &
>
ÒÒ& '
(
ÒÒ' (
)
ÒÒ( )
;
ÒÒ) *
}
ÓÓ 
catch
ÔÔ 
(
ÔÔ 
	Exception
ÔÔ 
ex
ÔÔ 
)
ÔÔ  
{
ÕÕ 
FDebug
ÖÖ 
.
ÖÖ 
throwException
ÖÖ %
(
ÖÖ% &
ex
ÖÖ& (
)
ÖÖ( )
;
ÖÖ) *
}
×× 
finally
ØØ 
{
ÙÙ 
}
ÛÛ 
}
ÜÜ 	
public
àà 
void
àà 
genDataMessage
àà "
(
àà" #
UInt16
áá 
	sessionId
áá 
,
áá 
byte
ââ 
stream
ââ 
,
ââ 
byte
ãã 
function
ãã 
,
ãã 
bool
ää 
wbit
ää 
,
ää 
UInt32
åå 
systemBytes
åå 
,
åå 
byte
ææ 
[
ææ 
]
ææ 
body
ææ 
)
çç 
{
èè 	
try
éé 
{
êê 
m_sessionId
ëë 
=
ëë 
	sessionId
ëë '
;
ëë' (
m_byte2
ìì 
=
ìì 
(
ìì 
byte
ìì 
)
ìì  
(
ìì  !
stream
ìì! '
|
ìì( )
(
ìì* +
wbit
ìì+ /
?
ìì0 1
$num
ìì2 6
:
ìì7 8
$num
ìì9 =
)
ìì= >
)
ìì> ?
;
ìì? @
m_byte3
íí 
=
íí 
function
íí "
;
íí" #
m_ptype
îî 
=
îî 
$num
îî 
;
îî 
m_stype
ïï 
=
ïï 
$num
ïï 
;
ïï 
m_systemBytes
ğğ 
=
ğğ 
systemBytes
ğğ  +
;
ğğ+ ,
if
òò 
(
òò 
body
òò 
==
òò 
null
òò  
)
òò  !
{
óó 
m_body
ôô 
=
ôô 
new
ôô  
List
ôô! %
<
ôô% &
byte
ôô& *
>
ôô* +
(
ôô+ ,
)
ôô, -
;
ôô- .
}
õõ 
else
öö 
{
÷÷ 
m_body
øø 
=
øø 
new
øø  
List
øø! %
<
øø% &
byte
øø& *
>
øø* +
(
øø+ ,
body
øø, 0
)
øø0 1
;
øø1 2
}
ùù 
}
úú 
catch
ûû 
(
ûû 
	Exception
ûû 
ex
ûû 
)
ûû  
{
üü 
FDebug
ıı 
.
ıı 
throwException
ıı %
(
ıı% &
ex
ıı& (
)
ıı( )
;
ıı) *
}
şş 
finally
ÿÿ 
{
€€ 
}
‚‚ 
}
ƒƒ 	
public
‡‡ 
void
‡‡ 
genSelectReq
‡‡  
(
‡‡  !
UInt32
ˆˆ 
systemBytes
ˆˆ 
)
‰‰ 
{
ŠŠ 	
try
‹‹ 
{
ŒŒ 
m_sessionId
 
=
 
$num
 $
;
$ %
m_byte2
 
=
 
$num
 
;
 
m_byte3
 
=
 
$num
 
;
 
m_ptype
 
=
 
$num
 
;
 
m_stype
‘‘ 
=
‘‘ 
$num
‘‘ 
;
‘‘ 
m_systemBytes
’’ 
=
’’ 
systemBytes
’’  +
;
’’+ ,
m_body
““ 
=
““ 
new
““ 
List
““ !
<
““! "
byte
““" &
>
““& '
(
““' (
)
““( )
;
““) *
}
”” 
catch
•• 
(
•• 
	Exception
•• 
ex
•• 
)
••  
{
–– 
FDebug
—— 
.
—— 
throwException
—— %
(
——% &
ex
——& (
)
——( )
;
——) *
}
˜˜ 
finally
™™ 
{
šš 
}
œœ 
}
 	
public
¡¡ 
void
¡¡ 
genSelectRsp
¡¡  
(
¡¡  !
UInt16
¢¢ 
	sessionId
¢¢ 
,
¢¢ 
byte
££ 
status
££ 
,
££ 
UInt32
¤¤ 
systemBytes
¤¤ 
)
¥¥ 
{
¦¦ 	
try
§§ 
{
¨¨ 
m_sessionId
©© 
=
©© 
	sessionId
©© '
;
©©' (
m_byte2
ªª 
=
ªª 
$num
ªª 
;
ªª 
m_byte3
«« 
=
«« 
status
««  
;
««  !
m_ptype
¬¬ 
=
¬¬ 
$num
¬¬ 
;
¬¬ 
m_stype
­­ 
=
­­ 
$num
­­ 
;
­­ 
m_systemBytes
®® 
=
®® 
systemBytes
®®  +
;
®®+ ,
m_body
¯¯ 
=
¯¯ 
new
¯¯ 
List
¯¯ !
<
¯¯! "
byte
¯¯" &
>
¯¯& '
(
¯¯' (
)
¯¯( )
;
¯¯) *
}
°° 
catch
±± 
(
±± 
	Exception
±± 
ex
±± 
)
±±  
{
²² 
FDebug
³³ 
.
³³ 
throwException
³³ %
(
³³% &
ex
³³& (
)
³³( )
;
³³) *
}
´´ 
finally
µµ 
{
¶¶ 
}
¸¸ 
}
¹¹ 	
public
½½ 
void
½½ 
genDeselectRsp
½½ "
(
½½" #
UInt16
¾¾ 
	sessionId
¾¾ 
,
¾¾ 
UInt32
¿¿ 
systemBytes
¿¿ 
)
ÀÀ 
{
ÁÁ 	
try
ÂÂ 
{
ÃÃ 
m_sessionId
ÄÄ 
=
ÄÄ 
	sessionId
ÄÄ '
;
ÄÄ' (
m_byte2
ÅÅ 
=
ÅÅ 
$num
ÅÅ 
;
ÅÅ 
m_byte3
ÆÆ 
=
ÆÆ 
$num
ÆÆ 
;
ÆÆ 
m_ptype
ÇÇ 
=
ÇÇ 
$num
ÇÇ 
;
ÇÇ 
m_stype
ÈÈ 
=
ÈÈ 
$num
ÈÈ 
;
ÈÈ 
m_systemBytes
ÉÉ 
=
ÉÉ 
systemBytes
ÉÉ  +
;
ÉÉ+ ,
m_body
ÊÊ 
=
ÊÊ 
new
ÊÊ 
List
ÊÊ !
<
ÊÊ! "
byte
ÊÊ" &
>
ÊÊ& '
(
ÊÊ' (
)
ÊÊ( )
;
ÊÊ) *
}
ËË 
catch
ÌÌ 
(
ÌÌ 
	Exception
ÌÌ 
ex
ÌÌ 
)
ÌÌ  
{
ÍÍ 
FDebug
ÎÎ 
.
ÎÎ 
throwException
ÎÎ %
(
ÎÎ% &
ex
ÎÎ& (
)
ÎÎ( )
;
ÎÎ) *
}
ÏÏ 
finally
ĞĞ 
{
ÑÑ 
}
ÓÓ 
}
ÔÔ 	
public
ØØ 
void
ØØ 
genLinktestReq
ØØ "
(
ØØ" #
UInt32
ÙÙ 
systemBytes
ÙÙ 
)
ÚÚ 
{
ÛÛ 	
try
ÜÜ 
{
İİ 
m_sessionId
ŞŞ 
=
ŞŞ 
$num
ŞŞ $
;
ŞŞ$ %
m_byte2
ßß 
=
ßß 
$num
ßß 
;
ßß 
m_byte3
àà 
=
àà 
$num
àà 
;
àà 
m_ptype
áá 
=
áá 
$num
áá 
;
áá 
m_stype
ââ 
=
ââ 
$num
ââ 
;
ââ 
m_systemBytes
ãã 
=
ãã 
systemBytes
ãã  +
;
ãã+ ,
m_body
ää 
=
ää 
new
ää 
List
ää !
<
ää! "
byte
ää" &
>
ää& '
(
ää' (
)
ää( )
;
ää) *
}
åå 
catch
ææ 
(
ææ 
	Exception
ææ 
ex
ææ 
)
ææ  
{
çç 
FDebug
èè 
.
èè 
throwException
èè %
(
èè% &
ex
èè& (
)
èè( )
;
èè) *
}
éé 
finally
êê 
{
ëë 
}
íí 
}
îî 	
public
òò 
void
òò 
genLinktestRsp
òò "
(
òò" #
UInt16
óó 
	sessionId
óó 
,
óó 
UInt32
ôô 
systemBytes
ôô 
)
õõ 
{
öö 	
try
÷÷ 
{
øø 
m_sessionId
ùù 
=
ùù 
	sessionId
ùù '
;
ùù' (
m_byte2
úú 
=
úú 
$num
úú 
;
úú 
m_byte3
ûû 
=
ûû 
$num
ûû 
;
ûû 
m_ptype
üü 
=
üü 
$num
üü 
;
üü 
m_stype
ıı 
=
ıı 
$num
ıı 
;
ıı 
m_systemBytes
şş 
=
şş 
systemBytes
şş  +
;
şş+ ,
m_body
ÿÿ 
=
ÿÿ 
new
ÿÿ 
List
ÿÿ !
<
ÿÿ! "
byte
ÿÿ" &
>
ÿÿ& '
(
ÿÿ' (
)
ÿÿ( )
;
ÿÿ) *
}
€€ 
catch
 
(
 
	Exception
 
ex
 
)
  
{
‚‚ 
FDebug
ƒƒ 
.
ƒƒ 
throwException
ƒƒ %
(
ƒƒ% &
ex
ƒƒ& (
)
ƒƒ( )
;
ƒƒ) *
}
„„ 
finally
…… 
{
†† 
}
ˆˆ 
}
‰‰ 	
public
 
void
 
genRejectReq
  
(
  !
UInt16
 
	sessionId
 
,
 
byte
 
stype
 
,
 
byte
 

reasonCode
 
,
 
UInt32
‘‘ 
systemBytes
‘‘ 
)
’’ 
{
““ 	
try
”” 
{
•• 
m_sessionId
–– 
=
–– 
$num
–– $
;
––$ %
m_byte2
—— 
=
—— 
stype
—— 
;
——  
m_byte3
˜˜ 
=
˜˜ 

reasonCode
˜˜ $
;
˜˜$ %
m_ptype
™™ 
=
™™ 
$num
™™ 
;
™™ 
m_stype
šš 
=
šš 
$num
šš 
;
šš 
m_systemBytes
›› 
=
›› 
systemBytes
››  +
;
››+ ,
m_body
œœ 
=
œœ 
new
œœ 
List
œœ !
<
œœ! "
byte
œœ" &
>
œœ& '
(
œœ' (
)
œœ( )
;
œœ) *
}
 
catch
 
(
 
	Exception
 
ex
 
)
  
{
ŸŸ 
FDebug
   
.
   
throwException
   %
(
  % &
ex
  & (
)
  ( )
;
  ) *
}
¡¡ 
finally
¢¢ 
{
££ 
}
¥¥ 
}
¦¦ 	
public
ªª 
void
ªª 
genSeparateReq
ªª "
(
ªª" #
UInt32
«« 
systemBytes
«« 
)
¬¬ 
{
­­ 	
try
®® 
{
¯¯ 
m_sessionId
°° 
=
°° 
$num
°° $
;
°°$ %
m_byte2
±± 
=
±± 
$num
±± 
;
±± 
m_byte3
²² 
=
²² 
$num
²² 
;
²² 
m_ptype
³³ 
=
³³ 
$num
³³ 
;
³³ 
m_stype
´´ 
=
´´ 
$num
´´ 
;
´´ 
m_systemBytes
µµ 
=
µµ 
systemBytes
µµ  +
;
µµ+ ,
m_body
¶¶ 
=
¶¶ 
new
¶¶ 
List
¶¶ !
<
¶¶! "
byte
¶¶" &
>
¶¶& '
(
¶¶' (
)
¶¶( )
;
¶¶) *
}
·· 
catch
¸¸ 
(
¸¸ 
	Exception
¸¸ 
ex
¸¸ 
)
¸¸  
{
¹¹ 
FDebug
ºº 
.
ºº 
throwException
ºº %
(
ºº% &
ex
ºº& (
)
ºº( )
;
ºº) *
}
»» 
finally
¼¼ 
{
½½ 
}
¿¿ 
}
ÀÀ 	
public
ÄÄ 
byte
ÄÄ 
[
ÄÄ 
]
ÄÄ 
getBinaryData
ÄÄ #
(
ÄÄ# $
)
ÅÅ 
{
ÆÆ 	
UInt32
ÇÇ 
length
ÇÇ 
=
ÇÇ 
$num
ÇÇ 
;
ÇÇ 
byte
ÈÈ 
[
ÈÈ 
]
ÈÈ 
data
ÈÈ 
=
ÈÈ 
null
ÈÈ 
;
ÈÈ 
try
ÊÊ 
{
ËË 
length
ÌÌ 
=
ÌÌ 
this
ÌÌ 
.
ÌÌ 
length
ÌÌ $
;
ÌÌ$ %
data
ÍÍ 
=
ÍÍ 
new
ÍÍ 
byte
ÍÍ 
[
ÍÍ  
length
ÍÍ  &
+
ÍÍ' (
$num
ÍÍ) *
]
ÍÍ* +
;
ÍÍ+ ,
Buffer
ÔÔ 
.
ÔÔ 
	BlockCopy
ÔÔ  
(
ÔÔ  !
FByteConverter
ÔÔ! /
.
ÔÔ/ 0
getBytes
ÔÔ0 8
(
ÔÔ8 9
length
ÔÔ9 ?
,
ÔÔ? @
true
ÔÔA E
)
ÔÔE F
,
ÔÔF G
$num
ÔÔH I
,
ÔÔI J
data
ÔÔK O
,
ÔÔO P
$num
ÔÔQ R
,
ÔÔR S
$num
ÔÔT U
)
ÔÔU V
;
ÔÔV W
Buffer
ÛÛ 
.
ÛÛ 
	BlockCopy
ÛÛ  
(
ÛÛ  !
FByteConverter
ÛÛ! /
.
ÛÛ/ 0
getBytes
ÛÛ0 8
(
ÛÛ8 9
m_sessionId
ÛÛ9 D
,
ÛÛD E
true
ÛÛF J
)
ÛÛJ K
,
ÛÛK L
$num
ÛÛM N
,
ÛÛN O
data
ÛÛP T
,
ÛÛT U
$num
ÛÛV W
,
ÛÛW X
$num
ÛÛY Z
)
ÛÛZ [
;
ÛÛ[ \
data
ÜÜ 
[
ÜÜ 
$num
ÜÜ 
]
ÜÜ 
=
ÜÜ 
m_byte2
ÜÜ !
;
ÜÜ! "
data
İİ 
[
İİ 
$num
İİ 
]
İİ 
=
İİ 
m_byte3
İİ !
;
İİ! "
data
ŞŞ 
[
ŞŞ 
$num
ŞŞ 
]
ŞŞ 
=
ŞŞ 
m_ptype
ŞŞ !
;
ŞŞ! "
data
ßß 
[
ßß 
$num
ßß 
]
ßß 
=
ßß 
m_stype
ßß !
;
ßß! "
Buffer
àà 
.
àà 
	BlockCopy
àà  
(
àà  !
FByteConverter
àà! /
.
àà/ 0
getBytes
àà0 8
(
àà8 9
m_systemBytes
àà9 F
,
ààF G
true
ààH L
)
ààL M
,
ààM N
$num
ààO P
,
ààP Q
data
ààR V
,
ààV W
$num
ààX Z
,
ààZ [
$num
àà\ ]
)
àà] ^
;
àà^ _
if
çç 
(
çç 
m_body
çç 
.
çç 
Count
çç  
>
çç! "
$num
çç# $
)
çç$ %
{
èè 
Buffer
éé 
.
éé 
	BlockCopy
éé $
(
éé$ %
m_body
éé% +
.
éé+ ,
ToArray
éé, 3
(
éé3 4
)
éé4 5
,
éé5 6
$num
éé7 8
,
éé8 9
data
éé: >
,
éé> ?
$num
éé@ B
,
ééB C
m_body
ééD J
.
ééJ K
Count
ééK P
)
ééP Q
;
ééQ R
}
êê 
return
îî 
data
îî 
;
îî 
}
ïï 
catch
ğğ 
(
ğğ 
	Exception
ğğ 
ex
ğğ 
)
ğğ  
{
ññ 
FDebug
òò 
.
òò 
throwException
òò %
(
òò% &
ex
òò& (
)
òò( )
;
òò) *
}
óó 
finally
ôô 
{
õõ 
data
öö 
=
öö 
null
öö 
;
öö 
}
÷÷ 
return
øø 
null
øø 
;
øø 
}
ùù 	
}
ÿÿ 
}€€ ¨–
{D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Protocol\HSMS\c_FHsmsPassive2.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
internal 
class 
FHsmsPassive2  
:  !
	FBaseHsms" +
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 

FTcpClient 
m_fTcpClient '
=( )
null* .
;. /
private 
FHsmsRecvBuffer 

m_fRecvBuf  *
=+ ,
null- 1
;1 2
private 
	FCodeLock 
m_fMainSync %
=& '
null( ,
;, -
private 
FThread 

m_fThdMain "
=# $
null% )
;) *
private   
FStaticTimer   
m_fTmrT7   %
=  & '
null  ( ,
;  , -
private!! 
FStaticTimer!! 
m_fTmrT8!! %
=!!& '
null!!( ,
;!!, -
private"" 
FCommunicationState"" #
m_fState""$ ,
=""- .
FCommunicationState""/ B
.""B C
Closed""C I
;""I J
public(( 
FHsmsPassive2(( 
((( 
FSecs1ToHsms)) 
fSecsToHsms)) $
,))$ %

FTcpClient** 

fTcpClient** !
)++ 
:,, 
base,, 
(,, 
fSecsToHsms,, 
),, 
{-- 	
m_fTcpClient.. 
=.. 

fTcpClient.. %
;..% &
init00 
(00 
)00 
;00 
}11 	
~55 	
FHsmsPassive255	 
(55 
)66 
{77 	
	myDispose88 
(88 
false88 
)88 
;88 
}99 	
	protected== 
override== 
void== 
	myDispose==  )
(==) *
bool>> 
	disposing>> 
)?? 
{@@ 	
ifAA 
(AA 
!AA 

m_disposedAA 
)AA 
{BB 
ifCC 
(CC 
	disposingCC 
)CC 
{DD 
termEE 
(EE 
)EE 
;EE 
}FF 

m_disposedHH 
=HH 
trueHH !
;HH! "
}II 
}JJ 	
publicRR 
voidRR 
DisposeRR 
(RR 
)SS 
{TT 	
	myDisposeUU 
(UU 
trueUU 
)UU 
;UU 
GCVV 
.VV 
SuppressFinalizeVV 
(VV  
thisVV  $
)VV$ %
;VV% &
}WW 	
public__ 
FCommunicationState__ "
fState__# )
{`` 	
getaa 
{bb 
trycc 
{dd 
returnee 
m_fStateee #
;ee# $
}ff 
catchgg 
(gg 
	Exceptiongg  
exgg! #
)gg# $
{hh 
FDebugii 
.ii 
throwExceptionii )
(ii) *
exii* ,
)ii, -
;ii- .
}jj 
finallykk 
{ll 
}nn 
returnoo 
FCommunicationStateoo *
.oo* +
Closedoo+ 1
;oo1 2
}pp 
}qq 	
privateyy 
voidyy 
inityy 
(yy 
)zz 
{{{ 	
try|| 
{}} 
m_fTmrT7~~ 
=~~ 
new~~ 
FStaticTimer~~ +
(~~+ ,
)~~, -
;~~- .
m_fTmrT8 
= 
new 
FStaticTimer +
(+ ,
), -
;- .

m_fRecvBuf
€€ 
=
€€ 
new
€€  
FHsmsRecvBuffer
€€! 0
(
€€0 1
)
€€1 2
;
€€2 3
m_fMainSync
„„ 
=
„„ 
new
„„ !
	FCodeLock
„„" +
(
„„+ ,
)
„„, -
;
„„- .

m_fThdMain
…… 
=
…… 
new
……  
FThread
……! (
(
……( )
$str
……) B
)
……B C
;
……C D

m_fThdMain
†† 
.
†† 
ThreadJobCalled
†† *
+=
††+ -
new
††. 1*
FThreadJobCalledEventHandler
††2 N
(
††N O(
m_fThdMain_ThreadJobCalled
††O i
)
††i j
;
††j k

m_fThdMain
‡‡ 
.
‡‡ 
start
‡‡  
(
‡‡  !
)
‡‡! "
;
‡‡" #
this
‹‹ 
.
‹‹ 
localIp
‹‹ 
=
‹‹ 
m_fTcpClient
‹‹ +
.
‹‹+ ,
localIp
‹‹, 3
;
‹‹3 4
this
ŒŒ 
.
ŒŒ 
	localPort
ŒŒ 
=
ŒŒ  
m_fTcpClient
ŒŒ! -
.
ŒŒ- .
	localPort
ŒŒ. 7
;
ŒŒ7 8
this
 
.
 
remoteIp
 
=
 
m_fTcpClient
  ,
.
, -
remoteIp
- 5
;
5 6
this
 
.
 

remotePort
 
=
  !
m_fTcpClient
" .
.
. /

remotePort
/ 9
;
9 :
m_fState
’’ 
=
’’ !
FCommunicationState
’’ .
.
’’. /
	Connected
’’/ 8
;
’’8 9
m_fTmrT7
™™ 
.
™™ 
start
™™ 
(
™™ 
this
™™ #
.
™™# $
fSecs1ToHsms
™™$ 0
.
™™0 1
fHsmsConfig
™™1 <
.
™™< =
	t7Timeout
™™= F
*
™™G H
$num
™™I M
)
™™M N
;
™™N O
m_fTcpClient
 
.
 #
TcpClientStateChanged
 2
+=
3 5
new
6 90
"FTcpClientStateChangedEventHandler
: \
(
\ ]0
"m_fTcpClient_TcpClientStateChanged
] 
) €
;€ 
m_fTcpClient
 
.
 #
TcpClientDataReceived
 2
+=
3 5
new
6 90
"FTcpClientDataReceivedEventHandler
: \
(
\ ]0
"m_fTcpClient_TcpClientDataReceived
] 
) €
;€ 
m_fTcpClient
ŸŸ 
.
ŸŸ 
TcpClientDataSent
ŸŸ .
+=
ŸŸ/ 1
new
ŸŸ2 5,
FTcpClientDataSentEventHandler
ŸŸ6 T
(
ŸŸT U,
m_fTcpClient_TcpClientDataSent
ŸŸU s
)
ŸŸs t
;
ŸŸt u
m_fTcpClient
   
.
   %
TcpClientDataSendFailed
   4
+=
  5 7
new
  8 ;2
$FTcpClientDataSendFailedEventHandler
  < `
(
  ` a3
$m_fTcpClient_TcpClientDataSendFailed  a …
)  … †
;  † ‡
m_fTcpClient
¡¡ 
.
¡¡ "
TcpClientErrorRaised
¡¡ 1
+=
¡¡2 4
new
¡¡5 8/
!FTcpClientErrorRaisedEventHandler
¡¡9 Z
(
¡¡Z [/
!m_fTcpClient_TcpClientErrorRaised
¡¡[ |
)
¡¡| }
;
¡¡} ~
m_fTcpClient
££ 
.
££ 
resumeEvent
££ (
(
££( )
)
££) *
;
££* +
}
¤¤ 
catch
¥¥ 
(
¥¥ 
	Exception
¥¥ 
ex
¥¥ 
)
¥¥  
{
¦¦ 
FDebug
§§ 
.
§§ 
throwException
§§ %
(
§§% &
ex
§§& (
)
§§( )
;
§§) *
}
¨¨ 
finally
©© 
{
ªª 
}
¬¬ 
}
­­ 	
private
±± 
void
±± 
term
±± 
(
±± 
)
²² 
{
³³ 	
try
´´ 
{
µµ 
if
¶¶ 
(
¶¶ 

m_fThdMain
¶¶ 
!=
¶¶ !
null
¶¶" &
)
¶¶& '
{
·· 

m_fThdMain
¸¸ 
.
¸¸ 
stop
¸¸ #
(
¸¸# $
)
¸¸$ %
;
¸¸% &

m_fThdMain
¹¹ 
.
¹¹ 
Dispose
¹¹ &
(
¹¹& '
)
¹¹' (
;
¹¹( )

m_fThdMain
ºº 
.
ºº 
ThreadJobCalled
ºº .
-=
ºº/ 1
new
ºº2 5*
FThreadJobCalledEventHandler
ºº6 R
(
ººR S(
m_fThdMain_ThreadJobCalled
ººS m
)
ººm n
;
ººn o

m_fThdMain
»» 
=
»»  
null
»»! %
;
»»% &
}
¼¼ 
close
ÃÃ 
(
ÃÃ 
)
ÃÃ 
;
ÃÃ 
if
ÇÇ 
(
ÇÇ 
m_fTmrT7
ÇÇ 
!=
ÇÇ 
null
ÇÇ  $
)
ÇÇ$ %
{
ÈÈ 
m_fTmrT7
ÉÉ 
.
ÉÉ 
Dispose
ÉÉ $
(
ÉÉ$ %
)
ÉÉ% &
;
ÉÉ& '
m_fTmrT7
ÊÊ 
=
ÊÊ 
null
ÊÊ #
;
ÊÊ# $
}
ËË 
if
ÍÍ 
(
ÍÍ 
m_fTmrT8
ÍÍ 
!=
ÍÍ 
null
ÍÍ  $
)
ÍÍ$ %
{
ÎÎ 
m_fTmrT8
ÏÏ 
.
ÏÏ 
Dispose
ÏÏ $
(
ÏÏ$ %
)
ÏÏ% &
;
ÏÏ& '
m_fTmrT8
ĞĞ 
=
ĞĞ 
null
ĞĞ #
;
ĞĞ# $
}
ÑÑ 
if
ÕÕ 
(
ÕÕ 

m_fRecvBuf
ÕÕ 
!=
ÕÕ !
null
ÕÕ" &
)
ÕÕ& '
{
ÖÖ 

m_fRecvBuf
×× 
.
×× 
Dispose
×× &
(
××& '
)
××' (
;
××( )

m_fRecvBuf
ØØ 
=
ØØ  
null
ØØ! %
;
ØØ% &
}
ÙÙ 
if
ÛÛ 
(
ÛÛ 
m_fMainSync
ÛÛ 
!=
ÛÛ  "
null
ÛÛ# '
)
ÛÛ' (
{
ÜÜ 
m_fMainSync
İİ 
.
İİ  
Dispose
İİ  '
(
İİ' (
)
İİ( )
;
İİ) *
m_fMainSync
ŞŞ 
=
ŞŞ  !
null
ŞŞ" &
;
ŞŞ& '
}
ßß 
}
àà 
catch
áá 
(
áá 
	Exception
áá 
ex
áá 
)
áá  
{
ââ 
FDebug
ãã 
.
ãã 
throwException
ãã %
(
ãã% &
ex
ãã& (
)
ãã( )
;
ãã) *
}
ää 
finally
åå 
{
ææ 
}
èè 
}
éé 	
public
íí 
override
íí 
void
íí 
open
íí !
(
íí! "
)
îî 
{
ïï 	
try
ğğ 
{
ññ 
}
óó 
catch
ôô 
(
ôô 
	Exception
ôô 
ex
ôô 
)
ôô  
{
õõ 
FDebug
öö 
.
öö 
throwException
öö %
(
öö% &
ex
öö& (
)
öö( )
;
öö) *
}
÷÷ 
finally
øø 
{
ùù 
}
ûû 
}
üü 	
public
€€ 
override
€€ 
void
€€ 
close
€€ "
(
€€" #
)
 
{
‚‚ 	
try
ƒƒ 
{
„„ 
if
…… 
(
…… 
m_fTcpClient
……  
==
……! #
null
……$ (
)
……( )
{
†† 
return
‡‡ 
;
‡‡ 
}
ˆˆ 
if
ŒŒ 
(
ŒŒ 
m_fTcpClient
ŒŒ  
.
ŒŒ  !
fState
ŒŒ! '
==
ŒŒ( *
FTcpClientState
ŒŒ+ :
.
ŒŒ: ;
	Connected
ŒŒ; D
)
ŒŒD E
{
 
sendSeparateReq
 #
(
# $
)
$ %
;
% &
}
 
m_fTcpClient
““ 
.
““ 
close
““ "
(
““" #
)
““# $
;
““$ %
m_fTcpClient
”” 
.
”” 
Dispose
”” $
(
””$ %
)
””% &
;
””& '
m_fTcpClient
–– 
.
–– #
TcpClientStateChanged
–– 2
-=
––3 5
new
––6 90
"FTcpClientStateChangedEventHandler
––: \
(
––\ ]0
"m_fTcpClient_TcpClientStateChanged
––] 
)–– €
;––€ 
m_fTcpClient
—— 
.
—— #
TcpClientDataReceived
—— 2
-=
——3 5
new
——6 90
"FTcpClientDataReceivedEventHandler
——: \
(
——\ ]0
"m_fTcpClient_TcpClientDataReceived
——] 
)—— €
;——€ 
m_fTcpClient
˜˜ 
.
˜˜ 
TcpClientDataSent
˜˜ .
-=
˜˜/ 1
new
˜˜2 5,
FTcpClientDataSentEventHandler
˜˜6 T
(
˜˜T U,
m_fTcpClient_TcpClientDataSent
˜˜U s
)
˜˜s t
;
˜˜t u
m_fTcpClient
™™ 
.
™™ %
TcpClientDataSendFailed
™™ 4
-=
™™5 7
new
™™8 ;2
$FTcpClientDataSendFailedEventHandler
™™< `
(
™™` a3
$m_fTcpClient_TcpClientDataSendFailed™™a …
)™™… †
;™™† ‡
m_fTcpClient
šš 
.
šš "
TcpClientErrorRaised
šš 1
-=
šš2 4
new
šš5 8/
!FTcpClientErrorRaisedEventHandler
šš9 Z
(
ššZ [/
!m_fTcpClient_TcpClientErrorRaised
šš[ |
)
šš| }
;
šš} ~
m_fTcpClient
œœ 
=
œœ 
null
œœ #
;
œœ# $
}
 
catch
 
(
 
	Exception
 
ex
 
)
  
{
ŸŸ 
FDebug
   
.
   
throwException
   %
(
  % &
ex
  & (
)
  ( )
;
  ) *
}
¡¡ 
finally
¢¢ 
{
££ 
}
¥¥ 
}
¦¦ 	
public
ªª 
override
ªª 
void
ªª 
send
ªª !
(
ªª! "
FSecsDataMessage
«« 
fSecsDataMessage
«« -
)
¬¬ 
{
­­ 	
}
¯¯ 	
private
³³ 
void
³³ 
resetResource
³³ "
(
³³" #
)
´´ 
{
µµ 	
try
¶¶ 
{
·· 
m_fTmrT7
»» 
.
»» 
stop
»» 
(
»» 
)
»» 
;
»»  
m_fTmrT8
¼¼ 
.
¼¼ 
stop
¼¼ 
(
¼¼ 
)
¼¼ 
;
¼¼  

m_fRecvBuf
½½ 
.
½½ 
clear
½½  
(
½½  !
)
½½! "
;
½½" #
}
¾¾ 
catch
¿¿ 
(
¿¿ 
	Exception
¿¿ 
ex
¿¿ 
)
¿¿  
{
ÀÀ 
FDebug
ÁÁ 
.
ÁÁ 
throwException
ÁÁ %
(
ÁÁ% &
ex
ÁÁ& (
)
ÁÁ( )
;
ÁÁ) *
}
ÂÂ 
finally
ÃÃ 
{
ÄÄ 
}
ÆÆ 
}
ÇÇ 	
private
ËË 
void
ËË !
procHsmsErrorRaised
ËË (
(
ËË( )
	Exception
ÌÌ 
inEx
ÌÌ 
)
ÍÍ 
{
ÎÎ 	
try
ÏÏ 
{
ĞĞ 
FDebug
ÑÑ 
.
ÑÑ 
writeLog
ÑÑ 
(
ÑÑ  
inEx
ÑÑ  $
)
ÑÑ$ %
;
ÑÑ% &
this
ÓÓ 
.
ÓÓ 
fSecs1ToHsms
ÓÓ !
.
ÓÓ! "
fEventPusher
ÓÓ" .
.
ÓÓ. /
pushHsmsEvent
ÓÓ/ <
(
ÓÓ< =
new
ÔÔ '
FHsmsErrorRaisedEventArgs
ÔÔ 1
(
ÔÔ1 2
this
ÔÔ2 6
.
ÔÔ6 7
fSecs1ToHsms
ÔÔ7 C
,
ÔÔC D
FEventId
ÔÔE M
.
ÔÔM N
HsmsErrorRaised
ÔÔN ]
,
ÔÔ] ^
inEx
ÔÔ_ c
.
ÔÔc d
Message
ÔÔd k
)
ÔÔk l
)
ÕÕ 
;
ÕÕ 
}
ÖÖ 
catch
×× 
(
×× 
	Exception
×× 
ex
×× 
)
××  
{
ØØ 
FDebug
ÙÙ 
.
ÙÙ 
writeLog
ÙÙ 
(
ÙÙ  
ex
ÙÙ  "
)
ÙÙ" #
;
ÙÙ# $
}
ÚÚ 
finally
ÛÛ 
{
ÜÜ 
}
ŞŞ 
}
ßß 	
private
ãã 
void
ãã 
recvSelectReq
ãã "
(
ãã" #
)
ää 
{
åå 	
string
ææ 
errorMessage
ææ 
=
ææ  !
string
ææ" (
.
ææ( )
Empty
ææ) .
;
ææ. /!
FSecsControlMessage
çç !
fSecsControlMessage
çç  3
=
çç4 5
null
çç6 :
;
çç: ;
try
éé 
{
êê 
errorMessage
ëë 
=
ëë $
getSelectStatusMessage
ëë 5
(
ëë5 6
$num
ëë6 7
)
ëë7 8
;
ëë8 9!
fSecsControlMessage
ïï #
=
ïï$ %
new
ïï& )!
FSecsControlMessage
ïï* =
(
ïï= >
this
ğğ 
.
ğğ 
fSecs1ToHsms
ğğ %
,
ğğ% &%
FHsmsControlMessageType
ññ +
.
ññ+ ,
	SelectReq
ññ, 5
,
ññ5 6

m_fRecvBuf
òò 
.
òò 
	sessionId
òò (
,
òò( )

m_fRecvBuf
óó 
.
óó 
byte2
óó $
,
óó$ %

m_fRecvBuf
ôô 
.
ôô 
byte3
ôô $
,
ôô$ %

m_fRecvBuf
õõ 
.
õõ 
ptype
õõ $
,
õõ$ %

m_fRecvBuf
öö 
.
öö 
stype
öö $
,
öö$ %

m_fRecvBuf
÷÷ 
.
÷÷ 
systemBytes
÷÷ *
,
÷÷* +
errorMessage
øø  
)
ùù 
;
ùù 
this
ûû 
.
ûû 
fSecs1ToHsms
ûû !
.
ûû! "
fEventPusher
ûû" .
.
ûû. /
pushHsmsEvent
ûû/ <
(
ûû< =
new
üü 2
$FHsmsControlMessageReceivedEventArgs
üü <
(
üü< =
this
üü= A
.
üüA B
fSecs1ToHsms
üüB N
,
üüN O
FEventId
üüP X
.
üüX Y(
HsmsControlMessageReceived
üüY s
,
üüs t
FResultCodeüüu €
.üü€ 
Warninigüü ‰
,üü‰ Š
errorMessageüü‹ —
,üü— ˜#
fSecsControlMessageüü™ ¬
)üü¬ ­
)
ıı 
;
ıı 
sendSelectRsp
 
(
 

m_fRecvBuf
 (
.
( )
	sessionId
) 2
,
2 3
$num
4 5
,
5 6

m_fRecvBuf
7 A
.
A B
systemBytes
B M
)
M N
;
N O
}
‚‚ 
catch
ƒƒ 
(
ƒƒ 
	Exception
ƒƒ 
ex
ƒƒ 
)
ƒƒ  
{
„„ !
procHsmsErrorRaised
…… #
(
……# $
ex
……$ &
)
……& '
;
……' (
}
†† 
finally
‡‡ 
{
ˆˆ !
fSecsControlMessage
‰‰ #
=
‰‰$ %
null
‰‰& *
;
‰‰* +
}
ŠŠ 
}
‹‹ 	
private
 
void
 
recvSelectRsp
 "
(
" #
)
 
{
‘‘ 	!
FSecsControlMessage
’’ !
fSecsControlMessage
’’  3
=
’’4 5
null
’’6 :
;
’’: ;
string
““ 
errorMessage
““ 
=
““  !
string
““" (
.
““( )
Empty
““) .
;
““. /
try
•• 
{
–– 
errorMessage
—— 
=
—— $
getRejectReasonMessage
—— 5
(
——5 6
$num
——6 7
)
——7 8
;
——8 9!
fSecsControlMessage
›› #
=
››$ %
new
››& )!
FSecsControlMessage
››* =
(
››= >
this
œœ 
.
œœ 
fSecs1ToHsms
œœ %
,
œœ% &%
FHsmsControlMessageType
 +
.
+ ,
	SelectRsp
, 5
,
5 6

m_fRecvBuf
 
.
 
	sessionId
 (
,
( )

m_fRecvBuf
ŸŸ 
.
ŸŸ 
byte2
ŸŸ $
,
ŸŸ$ %

m_fRecvBuf
   
.
   
byte3
   $
,
  $ %

m_fRecvBuf
¡¡ 
.
¡¡ 
ptype
¡¡ $
,
¡¡$ %

m_fRecvBuf
¢¢ 
.
¢¢ 
stype
¢¢ $
,
¢¢$ %

m_fRecvBuf
££ 
.
££ 
systemBytes
££ *
,
££* +
errorMessage
¤¤  
)
¥¥ 
;
¥¥ 
this
§§ 
.
§§ 
fSecs1ToHsms
§§ !
.
§§! "
fEventPusher
§§" .
.
§§. /
pushHsmsEvent
§§/ <
(
§§< =
new
¨¨ 2
$FHsmsControlMessageReceivedEventArgs
¨¨ <
(
¨¨< =
this
¨¨= A
.
¨¨A B
fSecs1ToHsms
¨¨B N
,
¨¨N O
FEventId
¨¨P X
.
¨¨X Y(
HsmsControlMessageReceived
¨¨Y s
,
¨¨s t
FResultCode¨¨u €
.¨¨€ 
Warninig¨¨ ‰
,¨¨‰ Š
errorMessage¨¨‹ —
,¨¨— ˜#
fSecsControlMessage¨¨™ ¬
)¨¨¬ ­
)
©© 
;
©© 
sendRejectReq
­­ 
(
­­ 

m_fRecvBuf
­­ (
.
­­( )
	sessionId
­­) 2
,
­­2 3

m_fRecvBuf
­­4 >
.
­­> ?
stype
­­? D
,
­­D E
$num
­­F G
,
­­G H

m_fRecvBuf
­­I S
.
­­S T
systemBytes
­­T _
)
­­_ `
;
­­` a
}
®® 
catch
¯¯ 
(
¯¯ 
	Exception
¯¯ 
ex
¯¯ 
)
¯¯  
{
°° !
procHsmsErrorRaised
±± #
(
±±# $
ex
±±$ &
)
±±& '
;
±±' (
}
²² 
finally
³³ 
{
´´ !
fSecsControlMessage
µµ #
=
µµ$ %
null
µµ& *
;
µµ* +
}
¶¶ 
}
·· 	
private
»» 
void
»» 
recvDeselectReq
»» $
(
»»$ %
)
¼¼ 
{
½½ 	!
FSecsControlMessage
¾¾ !
fSecsControlMessage
¾¾  3
=
¾¾4 5
null
¾¾6 :
;
¾¾: ;
try
ÀÀ 
{
ÁÁ !
fSecsControlMessage
ÂÂ #
=
ÂÂ$ %
new
ÂÂ& )!
FSecsControlMessage
ÂÂ* =
(
ÂÂ= >
this
ÃÃ 
.
ÃÃ 
fSecs1ToHsms
ÃÃ %
,
ÃÃ% &%
FHsmsControlMessageType
ÄÄ +
.
ÄÄ+ ,
DeselectReq
ÄÄ, 7
,
ÄÄ7 8

m_fRecvBuf
ÅÅ 
.
ÅÅ 
	sessionId
ÅÅ (
,
ÅÅ( )

m_fRecvBuf
ÆÆ 
.
ÆÆ 
byte2
ÆÆ $
,
ÆÆ$ %

m_fRecvBuf
ÇÇ 
.
ÇÇ 
byte3
ÇÇ $
,
ÇÇ$ %

m_fRecvBuf
ÈÈ 
.
ÈÈ 
ptype
ÈÈ $
,
ÈÈ$ %

m_fRecvBuf
ÉÉ 
.
ÉÉ 
stype
ÉÉ $
,
ÉÉ$ %

m_fRecvBuf
ÊÊ 
.
ÊÊ 
systemBytes
ÊÊ *
,
ÊÊ* +
string
ËË 
.
ËË 
Empty
ËË  
)
ÌÌ 
;
ÌÌ 
this
ÎÎ 
.
ÎÎ 
fSecs1ToHsms
ÎÎ !
.
ÎÎ! "
fEventPusher
ÎÎ" .
.
ÎÎ. /
pushHsmsEvent
ÎÎ/ <
(
ÎÎ< =
new
ÏÏ 2
$FHsmsControlMessageReceivedEventArgs
ÏÏ <
(
ÏÏ< =
this
ÏÏ= A
.
ÏÏA B
fSecs1ToHsms
ÏÏB N
,
ÏÏN O
FEventId
ÏÏP X
.
ÏÏX Y(
HsmsControlMessageReceived
ÏÏY s
,
ÏÏs t
FResultCodeÏÏu €
.ÏÏ€ 
SuccessÏÏ ˆ
,ÏÏˆ ‰
stringÏÏŠ 
.ÏÏ ‘
EmptyÏÏ‘ –
,ÏÏ– —#
fSecsControlMessageÏÏ˜ «
)ÏÏ« ¬
)
ĞĞ 
;
ĞĞ 
sendDeselectRsp
ÔÔ 
(
ÔÔ  

m_fRecvBuf
ÔÔ  *
.
ÔÔ* +
	sessionId
ÔÔ+ 4
,
ÔÔ4 5

m_fRecvBuf
ÔÔ6 @
.
ÔÔ@ A
systemBytes
ÔÔA L
)
ÔÔL M
;
ÔÔM N
m_fTcpClient
ÛÛ 
.
ÛÛ 
close
ÛÛ "
(
ÛÛ" #
)
ÛÛ# $
;
ÛÛ$ %
}
ÜÜ 
catch
İİ 
(
İİ 
	Exception
İİ 
ex
İİ 
)
İİ  
{
ŞŞ !
procHsmsErrorRaised
ßß #
(
ßß# $
ex
ßß$ &
)
ßß& '
;
ßß' (
}
àà 
finally
áá 
{
ââ !
fSecsControlMessage
ãã #
=
ãã$ %
null
ãã& *
;
ãã* +
}
ää 
}
åå 	
private
éé 
void
éé 
recvDeselectRsp
éé $
(
éé$ %
)
êê 
{
ëë 	!
FSecsControlMessage
ìì !
fSecsControlMessage
ìì  3
=
ìì4 5
null
ìì6 :
;
ìì: ;
string
íí 
errorMessage
íí 
=
íí  !
string
íí" (
.
íí( )
Empty
íí) .
;
íí. /
try
ïï 
{
ğğ 
errorMessage
ññ 
=
ññ $
getRejectReasonMessage
ññ 5
(
ññ5 6
$num
ññ6 7
)
ññ7 8
;
ññ8 9!
fSecsControlMessage
õõ #
=
õõ$ %
new
õõ& )!
FSecsControlMessage
õõ* =
(
õõ= >
this
öö 
.
öö 
fSecs1ToHsms
öö %
,
öö% &%
FHsmsControlMessageType
÷÷ +
.
÷÷+ ,
DeselectRsp
÷÷, 7
,
÷÷7 8

m_fRecvBuf
øø 
.
øø 
	sessionId
øø (
,
øø( )

m_fRecvBuf
ùù 
.
ùù 
byte2
ùù $
,
ùù$ %

m_fRecvBuf
úú 
.
úú 
byte3
úú $
,
úú$ %

m_fRecvBuf
ûû 
.
ûû 
ptype
ûû $
,
ûû$ %

m_fRecvBuf
üü 
.
üü 
stype
üü $
,
üü$ %

m_fRecvBuf
ıı 
.
ıı 
systemBytes
ıı *
,
ıı* +
errorMessage
şş  
)
ÿÿ 
;
ÿÿ 
this
 
.
 
fSecs1ToHsms
 !
.
! "
fEventPusher
" .
.
. /
pushHsmsEvent
/ <
(
< =
new
‚‚ 2
$FHsmsControlMessageReceivedEventArgs
‚‚ <
(
‚‚< =
this
‚‚= A
.
‚‚A B
fSecs1ToHsms
‚‚B N
,
‚‚N O
FEventId
‚‚P X
.
‚‚X Y(
HsmsControlMessageReceived
‚‚Y s
,
‚‚s t
FResultCode‚‚u €
.‚‚€ 
Warninig‚‚ ‰
,‚‚‰ Š
errorMessage‚‚‹ —
,‚‚— ˜#
fSecsControlMessage‚‚™ ¬
)‚‚¬ ­
)
ƒƒ 
;
ƒƒ 
sendRejectReq
‡‡ 
(
‡‡ 

m_fRecvBuf
‡‡ (
.
‡‡( )
	sessionId
‡‡) 2
,
‡‡2 3

m_fRecvBuf
‡‡4 >
.
‡‡> ?
stype
‡‡? D
,
‡‡D E
$num
‡‡F G
,
‡‡G H

m_fRecvBuf
‡‡I S
.
‡‡S T
systemBytes
‡‡T _
)
‡‡_ `
;
‡‡` a
}
ˆˆ 
catch
‰‰ 
(
‰‰ 
	Exception
‰‰ 
ex
‰‰ 
)
‰‰  
{
ŠŠ !
procHsmsErrorRaised
‹‹ #
(
‹‹# $
ex
‹‹$ &
)
‹‹& '
;
‹‹' (
}
ŒŒ 
finally
 
{
 !
fSecsControlMessage
 #
=
$ %
null
& *
;
* +
}
 
}
‘‘ 	
private
•• 
void
•• 
recvLinktestReq
•• $
(
••$ %
)
–– 
{
—— 	!
FSecsControlMessage
˜˜ !
fSecsControlMessage
˜˜  3
=
˜˜4 5
null
˜˜6 :
;
˜˜: ;
try
šš 
{
›› !
fSecsControlMessage
œœ #
=
œœ$ %
new
œœ& )!
FSecsControlMessage
œœ* =
(
œœ= >
this
 
.
 
fSecs1ToHsms
 %
,
% &%
FHsmsControlMessageType
 +
.
+ ,
LinktestReq
, 7
,
7 8

m_fRecvBuf
ŸŸ 
.
ŸŸ 
	sessionId
ŸŸ (
,
ŸŸ( )

m_fRecvBuf
   
.
   
byte2
   $
,
  $ %

m_fRecvBuf
¡¡ 
.
¡¡ 
byte3
¡¡ $
,
¡¡$ %

m_fRecvBuf
¢¢ 
.
¢¢ 
ptype
¢¢ $
,
¢¢$ %

m_fRecvBuf
££ 
.
££ 
stype
££ $
,
££$ %

m_fRecvBuf
¤¤ 
.
¤¤ 
systemBytes
¤¤ *
,
¤¤* +
string
¥¥ 
.
¥¥ 
Empty
¥¥  
)
¦¦ 
;
¦¦ 
this
¨¨ 
.
¨¨ 
fSecs1ToHsms
¨¨ !
.
¨¨! "
fEventPusher
¨¨" .
.
¨¨. /
pushHsmsEvent
¨¨/ <
(
¨¨< =
new
©© 2
$FHsmsControlMessageReceivedEventArgs
©© <
(
©©< =
this
©©= A
.
©©A B
fSecs1ToHsms
©©B N
,
©©N O
FEventId
©©P X
.
©©X Y(
HsmsControlMessageReceived
©©Y s
,
©©s t
FResultCode©©u €
.©©€ 
Success©© ˆ
,©©ˆ ‰
string©©Š 
.©© ‘
Empty©©‘ –
,©©– —#
fSecsControlMessage©©˜ «
)©©« ¬
)
ªª 
;
ªª 
sendLinktestRsp
®® 
(
®®  

m_fRecvBuf
®®  *
.
®®* +
	sessionId
®®+ 4
,
®®4 5

m_fRecvBuf
®®6 @
.
®®@ A
systemBytes
®®A L
)
®®L M
;
®®M N
}
¯¯ 
catch
°° 
(
°° 
	Exception
°° 
ex
°° 
)
°°  
{
±± !
procHsmsErrorRaised
²² #
(
²²# $
ex
²²$ &
)
²²& '
;
²²' (
}
³³ 
finally
´´ 
{
µµ !
fSecsControlMessage
¶¶ #
=
¶¶$ %
null
¶¶& *
;
¶¶* +
}
·· 
}
¸¸ 	
private
¼¼ 
void
¼¼ 
recvLinktestRsp
¼¼ $
(
¼¼$ %
)
½½ 
{
¾¾ 	!
FSecsControlMessage
¿¿ !
fSecsControlMessage
¿¿  3
=
¿¿4 5
null
¿¿6 :
;
¿¿: ;
string
ÀÀ 
errorMessage
ÀÀ 
=
ÀÀ  !
string
ÀÀ" (
.
ÀÀ( )
Empty
ÀÀ) .
;
ÀÀ. /
try
ÂÂ 
{
ÃÃ 
errorMessage
ÄÄ 
=
ÄÄ 
this
ÄÄ #
.
ÄÄ# $$
getRejectReasonMessage
ÄÄ$ :
(
ÄÄ: ;
$num
ÄÄ; <
)
ÄÄ< =
;
ÄÄ= >!
fSecsControlMessage
ÈÈ #
=
ÈÈ$ %
new
ÈÈ& )!
FSecsControlMessage
ÈÈ* =
(
ÈÈ= >
this
ÉÉ 
.
ÉÉ 
fSecs1ToHsms
ÉÉ %
,
ÉÉ% &%
FHsmsControlMessageType
ÊÊ +
.
ÊÊ+ ,
LinktestRsp
ÊÊ, 7
,
ÊÊ7 8

m_fRecvBuf
ËË 
.
ËË 
	sessionId
ËË (
,
ËË( )

m_fRecvBuf
ÌÌ 
.
ÌÌ 
byte2
ÌÌ $
,
ÌÌ$ %

m_fRecvBuf
ÍÍ 
.
ÍÍ 
byte3
ÍÍ $
,
ÍÍ$ %

m_fRecvBuf
ÎÎ 
.
ÎÎ 
ptype
ÎÎ $
,
ÎÎ$ %

m_fRecvBuf
ÏÏ 
.
ÏÏ 
stype
ÏÏ $
,
ÏÏ$ %

m_fRecvBuf
ĞĞ 
.
ĞĞ 
systemBytes
ĞĞ *
,
ĞĞ* +
errorMessage
ÑÑ  
)
ÒÒ 
;
ÒÒ 
this
ÔÔ 
.
ÔÔ 
fSecs1ToHsms
ÔÔ !
.
ÔÔ! "
fEventPusher
ÔÔ" .
.
ÔÔ. /
pushHsmsEvent
ÔÔ/ <
(
ÔÔ< =
new
ÕÕ 2
$FHsmsControlMessageReceivedEventArgs
ÕÕ <
(
ÕÕ< =
this
ÕÕ= A
.
ÕÕA B
fSecs1ToHsms
ÕÕB N
,
ÕÕN O
FEventId
ÕÕP X
.
ÕÕX Y(
HsmsControlMessageReceived
ÕÕY s
,
ÕÕs t
FResultCodeÕÕu €
.ÕÕ€ 
WarninigÕÕ ‰
,ÕÕ‰ Š
errorMessageÕÕ‹ —
,ÕÕ— ˜#
fSecsControlMessageÕÕ™ ¬
)ÕÕ¬ ­
)
ÖÖ 
;
ÖÖ 
sendRejectReq
ÚÚ 
(
ÚÚ 

m_fRecvBuf
ÚÚ (
.
ÚÚ( )
	sessionId
ÚÚ) 2
,
ÚÚ2 3

m_fRecvBuf
ÚÚ4 >
.
ÚÚ> ?
stype
ÚÚ? D
,
ÚÚD E
$num
ÚÚF G
,
ÚÚG H

m_fRecvBuf
ÚÚI S
.
ÚÚS T
systemBytes
ÚÚT _
)
ÚÚ_ `
;
ÚÚ` a
}
ÛÛ 
catch
ÜÜ 
(
ÜÜ 
	Exception
ÜÜ 
ex
ÜÜ 
)
ÜÜ  
{
İİ !
procHsmsErrorRaised
ŞŞ #
(
ŞŞ# $
ex
ŞŞ$ &
)
ŞŞ& '
;
ŞŞ' (
}
ßß 
finally
àà 
{
áá !
fSecsControlMessage
ââ #
=
ââ$ %
null
ââ& *
;
ââ* +
}
ãã 
}
ää 	
private
èè 
void
èè 
recvRejectReq
èè "
(
èè" #
)
éé 
{
êê 	!
FSecsControlMessage
ëë !
fSecsControlMessage
ëë  3
=
ëë4 5
null
ëë6 :
;
ëë: ;
string
ìì 
errorMessage
ìì 
=
ìì  !
string
ìì" (
.
ìì( )
Empty
ìì) .
;
ìì. /
try
îî 
{
ïï 
errorMessage
ğğ 
=
ğğ $
getRejectReasonMessage
ğğ 5
(
ğğ5 6

m_fRecvBuf
ğğ6 @
.
ğğ@ A
byte3
ğğA F
)
ğğF G
;
ğğG H!
fSecsControlMessage
ôô #
=
ôô$ %
new
ôô& )!
FSecsControlMessage
ôô* =
(
ôô= >
this
õõ 
.
õõ 
fSecs1ToHsms
õõ %
,
õõ% &%
FHsmsControlMessageType
öö +
.
öö+ ,
DeselectRsp
öö, 7
,
öö7 8

m_fRecvBuf
÷÷ 
.
÷÷ 
	sessionId
÷÷ (
,
÷÷( )

m_fRecvBuf
øø 
.
øø 
byte2
øø $
,
øø$ %

m_fRecvBuf
ùù 
.
ùù 
byte3
ùù $
,
ùù$ %

m_fRecvBuf
úú 
.
úú 
ptype
úú $
,
úú$ %

m_fRecvBuf
ûû 
.
ûû 
stype
ûû $
,
ûû$ %

m_fRecvBuf
üü 
.
üü 
systemBytes
üü *
,
üü* +
errorMessage
ıı  
)
şş 
;
şş 
this
€€ 
.
€€ 
fSecs1ToHsms
€€ !
.
€€! "
fEventPusher
€€" .
.
€€. /
pushHsmsEvent
€€/ <
(
€€< =
new
 2
$FHsmsControlMessageReceivedEventArgs
 <
(
< =
this
= A
.
A B
fSecs1ToHsms
B N
,
N O
FEventId
P X
.
X Y(
HsmsControlMessageReceived
Y s
,
s t
FResultCodeu €
.€ 
Warninig ‰
,‰ Š
errorMessage‹ —
,— ˜#
fSecsControlMessage™ ¬
)¬ ­
)
‚‚ 
;
‚‚ 
}
ƒƒ 
catch
„„ 
(
„„ 
	Exception
„„ 
ex
„„ 
)
„„  
{
…… !
procHsmsErrorRaised
†† #
(
††# $
ex
††$ &
)
††& '
;
††' (
}
‡‡ 
finally
ˆˆ 
{
‰‰ !
fSecsControlMessage
ŠŠ #
=
ŠŠ$ %
null
ŠŠ& *
;
ŠŠ* +
}
‹‹ 
}
ŒŒ 	
private
 
void
 
recvSeparateReq
 $
(
$ %
)
‘‘ 
{
’’ 	!
FSecsControlMessage
““ !
fSecsControlMessage
““  3
=
““4 5
null
““6 :
;
““: ;
try
•• 
{
–– !
fSecsControlMessage
—— #
=
——$ %
new
——& )!
FSecsControlMessage
——* =
(
——= >
this
˜˜ 
.
˜˜ 
fSecs1ToHsms
˜˜ %
,
˜˜% &%
FHsmsControlMessageType
™™ +
.
™™+ ,
SeparateReq
™™, 7
,
™™7 8

m_fRecvBuf
šš 
.
šš 
	sessionId
šš (
,
šš( )

m_fRecvBuf
›› 
.
›› 
byte2
›› $
,
››$ %

m_fRecvBuf
œœ 
.
œœ 
byte3
œœ $
,
œœ$ %

m_fRecvBuf
 
.
 
ptype
 $
,
$ %

m_fRecvBuf
 
.
 
stype
 $
,
$ %

m_fRecvBuf
ŸŸ 
.
ŸŸ 
systemBytes
ŸŸ *
,
ŸŸ* +
string
   
.
   
Empty
    
)
¡¡ 
;
¡¡ 
this
££ 
.
££ 
fSecs1ToHsms
££ !
.
££! "
fEventPusher
££" .
.
££. /
pushHsmsEvent
££/ <
(
££< =
new
¤¤ 2
$FHsmsControlMessageReceivedEventArgs
¤¤ <
(
¤¤< =
this
¤¤= A
.
¤¤A B
fSecs1ToHsms
¤¤B N
,
¤¤N O
FEventId
¤¤P X
.
¤¤X Y(
HsmsControlMessageReceived
¤¤Y s
,
¤¤s t
FResultCode¤¤u €
.¤¤€ 
Success¤¤ ˆ
,¤¤ˆ ‰
string¤¤Š 
.¤¤ ‘
Empty¤¤‘ –
,¤¤– —#
fSecsControlMessage¤¤˜ «
)¤¤« ¬
)
¥¥ 
;
¥¥ 
m_fTcpClient
¬¬ 
.
¬¬ 
close
¬¬ "
(
¬¬" #
)
¬¬# $
;
¬¬$ %
}
­­ 
catch
®® 
(
®® 
	Exception
®® 
ex
®® 
)
®®  
{
¯¯ !
procHsmsErrorRaised
°° #
(
°°# $
ex
°°$ &
)
°°& '
;
°°' (
}
±± 
finally
²² 
{
³³ !
fSecsControlMessage
´´ #
=
´´$ %
null
´´& *
;
´´* +
}
µµ 
}
¶¶ 	
private
ºº 
void
ºº 
sendSelectRsp
ºº "
(
ºº" #
UInt16
»» 
	sessionId
»» 
,
»» 
byte
¼¼ 
status
¼¼ 
,
¼¼ 
UInt32
½½ 
systemBytes
½½ 
)
¾¾ 
{
¿¿ 	
FHsmsSendBuffer
ÀÀ 
fBuf
ÀÀ  
=
ÀÀ! "
null
ÀÀ# '
;
ÀÀ' (!
FSecsControlMessage
ÁÁ !
fSecsControlMessage
ÁÁ  3
=
ÁÁ4 5
null
ÁÁ6 :
;
ÁÁ: ;
try
ÃÃ 
{
ÄÄ 
fBuf
ÅÅ 
=
ÅÅ 
new
ÅÅ 
FHsmsSendBuffer
ÅÅ *
(
ÅÅ* +
)
ÅÅ+ ,
;
ÅÅ, -
fBuf
ÆÆ 
.
ÆÆ 
genSelectRsp
ÆÆ !
(
ÆÆ! "
	sessionId
ÆÆ" +
,
ÆÆ+ ,
status
ÆÆ- 3
,
ÆÆ3 4
systemBytes
ÆÆ5 @
)
ÆÆ@ A
;
ÆÆA B!
fSecsControlMessage
ÈÈ #
=
ÈÈ$ %
new
ÈÈ& )!
FSecsControlMessage
ÈÈ* =
(
ÈÈ= >
this
ÉÉ 
.
ÉÉ 
fSecs1ToHsms
ÉÉ %
,
ÉÉ% &%
FHsmsControlMessageType
ÊÊ +
.
ÊÊ+ ,
	SelectRsp
ÊÊ, 5
,
ÊÊ5 6
fBuf
ËË 
.
ËË 
	sessionId
ËË "
,
ËË" #
fBuf
ÌÌ 
.
ÌÌ 
byte2
ÌÌ 
,
ÌÌ 
fBuf
ÍÍ 
.
ÍÍ 
byte3
ÍÍ 
,
ÍÍ 
fBuf
ÎÎ 
.
ÎÎ 
ptype
ÎÎ 
,
ÎÎ 
fBuf
ÏÏ 
.
ÏÏ 
stype
ÏÏ 
,
ÏÏ 
fBuf
ĞĞ 
.
ĞĞ 
systemBytes
ĞĞ $
,
ĞĞ$ %
string
ÑÑ 
.
ÑÑ 
Empty
ÑÑ  
)
ÒÒ 
;
ÒÒ 
m_fTcpClient
ÔÔ 
.
ÔÔ 
send
ÔÔ !
(
ÔÔ! "
new
ÔÔ" %
FSocketSendData
ÔÔ& 5
(
ÔÔ5 6
fBuf
ÔÔ6 :
.
ÔÔ: ;
getBinaryData
ÔÔ; H
(
ÔÔH I
)
ÔÔI J
,
ÔÔJ K!
fSecsControlMessage
ÔÔL _
)
ÔÔ_ `
)
ÔÔ` a
;
ÔÔa b
}
ÕÕ 
catch
ÖÖ 
(
ÖÖ 
	Exception
ÖÖ 
ex
ÖÖ 
)
ÖÖ  
{
×× !
procHsmsErrorRaised
ØØ #
(
ØØ# $
ex
ØØ$ &
)
ØØ& '
;
ØØ' (
}
ÙÙ 
finally
ÚÚ 
{
ÛÛ 
fBuf
ÜÜ 
=
ÜÜ 
null
ÜÜ 
;
ÜÜ !
fSecsControlMessage
İİ #
=
İİ$ %
null
İİ& *
;
İİ* +
}
ŞŞ 
}
ßß 	
private
ãã 
void
ãã 
sendDeselectRsp
ãã $
(
ãã$ %
UInt16
ää 
	sessionId
ää 
,
ää 
UInt32
åå 
systemBytes
åå 
)
ææ 
{
çç 	
FHsmsSendBuffer
èè 
fBuf
èè  
=
èè! "
null
èè# '
;
èè' (!
FSecsControlMessage
éé !
fSecsControlMessage
éé  3
=
éé4 5
null
éé6 :
;
éé: ;
try
ëë 
{
ìì 
fBuf
íí 
=
íí 
new
íí 
FHsmsSendBuffer
íí *
(
íí* +
)
íí+ ,
;
íí, -
fBuf
îî 
.
îî 
genDeselectRsp
îî #
(
îî# $
	sessionId
îî$ -
,
îî- .
systemBytes
îî/ :
)
îî: ;
;
îî; <!
fSecsControlMessage
ğğ #
=
ğğ$ %
new
ğğ& )!
FSecsControlMessage
ğğ* =
(
ğğ= >
this
ññ 
.
ññ 
fSecs1ToHsms
ññ %
,
ññ% &%
FHsmsControlMessageType
òò +
.
òò+ ,
DeselectRsp
òò, 7
,
òò7 8
fBuf
óó 
.
óó 
	sessionId
óó "
,
óó" #
fBuf
ôô 
.
ôô 
byte2
ôô 
,
ôô 
fBuf
õõ 
.
õõ 
byte3
õõ 
,
õõ 
fBuf
öö 
.
öö 
ptype
öö 
,
öö 
fBuf
÷÷ 
.
÷÷ 
stype
÷÷ 
,
÷÷ 
fBuf
øø 
.
øø 
systemBytes
øø $
,
øø$ %
string
ùù 
.
ùù 
Empty
ùù  
)
úú 
;
úú 
m_fTcpClient
üü 
.
üü 
send
üü !
(
üü! "
new
üü" %
FSocketSendData
üü& 5
(
üü5 6
fBuf
üü6 :
.
üü: ;
getBinaryData
üü; H
(
üüH I
)
üüI J
,
üüJ K!
fSecsControlMessage
üüL _
)
üü_ `
)
üü` a
;
üüa b
}
ıı 
catch
şş 
(
şş 
	Exception
şş 
ex
şş 
)
şş  
{
ÿÿ !
procHsmsErrorRaised
€€ #
(
€€# $
ex
€€$ &
)
€€& '
;
€€' (
}
 
finally
‚‚ 
{
ƒƒ 
fBuf
„„ 
=
„„ 
null
„„ 
;
„„ !
fSecsControlMessage
…… #
=
……$ %
null
……& *
;
……* +
}
†† 
}
‡‡ 	
private
‹‹ 
void
‹‹ 
sendLinktestRsp
‹‹ $
(
‹‹$ %
UInt16
ŒŒ 
	sessionId
ŒŒ 
,
ŒŒ 
UInt32
 
systemBytes
 
)
 
{
 	
FHsmsSendBuffer
 
fBuf
  
=
! "
null
# '
;
' (!
FSecsControlMessage
‘‘ !
fSecsControlMessage
‘‘  3
=
‘‘4 5
null
‘‘6 :
;
‘‘: ;
try
““ 
{
”” 
fBuf
•• 
=
•• 
new
•• 
FHsmsSendBuffer
•• *
(
••* +
)
••+ ,
;
••, -
fBuf
–– 
.
–– 
genLinktestRsp
–– #
(
––# $
	sessionId
––$ -
,
––- .
systemBytes
––/ :
)
––: ;
;
––; <!
fSecsControlMessage
˜˜ #
=
˜˜$ %
new
˜˜& )!
FSecsControlMessage
˜˜* =
(
˜˜= >
this
™™ 
.
™™ 
fSecs1ToHsms
™™ %
,
™™% &%
FHsmsControlMessageType
šš +
.
šš+ ,
LinktestRsp
šš, 7
,
šš7 8
fBuf
›› 
.
›› 
	sessionId
›› "
,
››" #
fBuf
œœ 
.
œœ 
byte2
œœ 
,
œœ 
fBuf
 
.
 
byte3
 
,
 
fBuf
 
.
 
ptype
 
,
 
fBuf
ŸŸ 
.
ŸŸ 
stype
ŸŸ 
,
ŸŸ 
fBuf
   
.
   
systemBytes
   $
,
  $ %
string
¡¡ 
.
¡¡ 
Empty
¡¡  
)
¢¢ 
;
¢¢ 
m_fTcpClient
¤¤ 
.
¤¤ 
send
¤¤ !
(
¤¤! "
new
¤¤" %
FSocketSendData
¤¤& 5
(
¤¤5 6
fBuf
¤¤6 :
.
¤¤: ;
getBinaryData
¤¤; H
(
¤¤H I
)
¤¤I J
,
¤¤J K!
fSecsControlMessage
¤¤L _
)
¤¤_ `
)
¤¤` a
;
¤¤a b
}
¥¥ 
catch
¦¦ 
(
¦¦ 
	Exception
¦¦ 
ex
¦¦ 
)
¦¦  
{
§§ !
procHsmsErrorRaised
¨¨ #
(
¨¨# $
ex
¨¨$ &
)
¨¨& '
;
¨¨' (
}
©© 
finally
ªª 
{
«« 
fBuf
¬¬ 
=
¬¬ 
null
¬¬ 
;
¬¬ !
fSecsControlMessage
­­ #
=
­­$ %
null
­­& *
;
­­* +
}
®® 
}
¯¯ 	
private
³³ 
void
³³ 
sendRejectReq
³³ "
(
³³" #
UInt16
´´ 
	sessionId
´´ 
,
´´ 
byte
µµ 
stype
µµ 
,
µµ 
byte
¶¶ 

reasonCode
¶¶ 
,
¶¶ 
UInt32
·· 
systemBytes
·· 
)
¸¸ 
{
¹¹ 	
FHsmsSendBuffer
ºº 
fBuf
ºº  
=
ºº! "
null
ºº# '
;
ºº' (!
FSecsControlMessage
»» !
fSecsControlMessage
»»  3
=
»»4 5
null
»»6 :
;
»»: ;
try
½½ 
{
¾¾ 
fBuf
¿¿ 
=
¿¿ 
new
¿¿ 
FHsmsSendBuffer
¿¿ *
(
¿¿* +
)
¿¿+ ,
;
¿¿, -
fBuf
ÀÀ 
.
ÀÀ 
genRejectReq
ÀÀ !
(
ÀÀ! "
	sessionId
ÀÀ" +
,
ÀÀ+ ,
stype
ÀÀ- 2
,
ÀÀ2 3

reasonCode
ÀÀ4 >
,
ÀÀ> ?
systemBytes
ÀÀ@ K
)
ÀÀK L
;
ÀÀL M!
fSecsControlMessage
ÂÂ #
=
ÂÂ$ %
new
ÂÂ& )!
FSecsControlMessage
ÂÂ* =
(
ÂÂ= >
this
ÃÃ 
.
ÃÃ 
fSecs1ToHsms
ÃÃ %
,
ÃÃ% &%
FHsmsControlMessageType
ÄÄ +
.
ÄÄ+ ,
	RejectReq
ÄÄ, 5
,
ÄÄ5 6
fBuf
ÅÅ 
.
ÅÅ 
	sessionId
ÅÅ "
,
ÅÅ" #
fBuf
ÆÆ 
.
ÆÆ 
byte2
ÆÆ 
,
ÆÆ 
fBuf
ÇÇ 
.
ÇÇ 
byte3
ÇÇ 
,
ÇÇ 
fBuf
ÈÈ 
.
ÈÈ 
ptype
ÈÈ 
,
ÈÈ 
fBuf
ÉÉ 
.
ÉÉ 
stype
ÉÉ 
,
ÉÉ 
fBuf
ÊÊ 
.
ÊÊ 
systemBytes
ÊÊ $
,
ÊÊ$ %$
getRejectReasonMessage
ËË *
(
ËË* +

reasonCode
ËË+ 5
)
ËË5 6
)
ÌÌ 
;
ÌÌ 
m_fTcpClient
ÎÎ 
.
ÎÎ 
send
ÎÎ !
(
ÎÎ! "
new
ÎÎ" %
FSocketSendData
ÎÎ& 5
(
ÎÎ5 6
fBuf
ÎÎ6 :
.
ÎÎ: ;
getBinaryData
ÎÎ; H
(
ÎÎH I
)
ÎÎI J
,
ÎÎJ K!
fSecsControlMessage
ÎÎL _
)
ÎÎ_ `
)
ÎÎ` a
;
ÎÎa b
}
ÏÏ 
catch
ĞĞ 
(
ĞĞ 
	Exception
ĞĞ 
ex
ĞĞ 
)
ĞĞ  
{
ÑÑ !
procHsmsErrorRaised
ÒÒ #
(
ÒÒ# $
ex
ÒÒ$ &
)
ÒÒ& '
;
ÒÒ' (
}
ÓÓ 
finally
ÔÔ 
{
ÕÕ 
fBuf
ÖÖ 
=
ÖÖ 
null
ÖÖ 
;
ÖÖ !
fSecsControlMessage
×× #
=
××$ %
null
××& *
;
××* +
}
ØØ 
}
ÙÙ 	
private
İİ 
void
İİ 
sendSeparateReq
İİ $
(
İİ$ %
)
ŞŞ 
{
ßß 	
FHsmsSendBuffer
àà 
fBuf
àà  
=
àà! "
null
àà# '
;
àà' (!
FSecsControlMessage
áá !
fSecsControlMessage
áá  3
=
áá4 5
null
áá6 :
;
áá: ;
try
ãã 
{
ää 
fBuf
åå 
=
åå 
new
åå 
FHsmsSendBuffer
åå *
(
åå* +
)
åå+ ,
;
åå, -
fBuf
ææ 
.
ææ 
genSeparateReq
ææ #
(
ææ# $
this
ææ$ (
.
ææ( )!
fSystemBytesPointer
ææ) <
.
ææ< =
uniqueId
ææ= E
)
ææE F
;
ææF G!
fSecsControlMessage
èè #
=
èè$ %
new
èè& )!
FSecsControlMessage
èè* =
(
èè= >
this
éé 
.
éé 
fSecs1ToHsms
éé %
,
éé% &%
FHsmsControlMessageType
êê +
.
êê+ ,
SeparateReq
êê, 7
,
êê7 8
fBuf
ëë 
.
ëë 
	sessionId
ëë "
,
ëë" #
fBuf
ìì 
.
ìì 
byte2
ìì 
,
ìì 
fBuf
íí 
.
íí 
byte3
íí 
,
íí 
fBuf
îî 
.
îî 
ptype
îî 
,
îî 
fBuf
ïï 
.
ïï 
stype
ïï 
,
ïï 
fBuf
ğğ 
.
ğğ 
systemBytes
ğğ $
,
ğğ$ %
string
ññ 
.
ññ 
Empty
ññ  
)
òò 
;
òò 
m_fTcpClient
ôô 
.
ôô 
send
ôô !
(
ôô! "
new
ôô" %
FSocketSendData
ôô& 5
(
ôô5 6
fBuf
ôô6 :
.
ôô: ;
getBinaryData
ôô; H
(
ôôH I
)
ôôI J
,
ôôJ K!
fSecsControlMessage
ôôL _
)
ôô_ `
)
ôô` a
;
ôôa b
}
õõ 
catch
öö 
(
öö 
	Exception
öö 
ex
öö 
)
öö  
{
÷÷ !
procHsmsErrorRaised
øø #
(
øø# $
ex
øø$ &
)
øø& '
;
øø' (
}
ùù 
finally
úú 
{
ûû 
fBuf
üü 
=
üü 
null
üü 
;
üü !
fSecsControlMessage
ıı #
=
ıı$ %
null
ıı& *
;
ıı* +
}
şş 
}
ÿÿ 	
private
‡‡ 
void
‡‡ (
m_fThdMain_ThreadJobCalled
‡‡ /
(
‡‡/ 0
object
ˆˆ 
sender
ˆˆ 
,
ˆˆ 
FThreadEventArgs
‰‰ 
e
‰‰ 
)
ŠŠ 
{
‹‹ 	
bool
ŒŒ 
waited
ŒŒ 
=
ŒŒ 
false
ŒŒ 
;
ŒŒ  
try
 
{
 
waited
 
=
 
m_fMainSync
 $
.
$ %
tryWait
% ,
(
, -
$num
- .
)
. /
;
/ 0
if
‘‘ 
(
‘‘ 
!
‘‘ 
waited
‘‘ 
)
‘‘ 
{
’’ 
return
““ 
;
““ 
}
”” 
if
˜˜ 
(
˜˜ 
m_fTcpClient
˜˜  
==
˜˜! #
null
˜˜$ (
||
˜˜) +
m_fTcpClient
˜˜, 8
.
˜˜8 9
fState
˜˜9 ?
!=
˜˜@ B
FTcpClientState
˜˜C R
.
˜˜R S
	Connected
˜˜S \
)
˜˜\ ]
{
™™ 
e
šš 
.
šš 
sleepThread
šš !
(
šš! "
$num
šš" #
)
šš# $
;
šš$ %
return
›› 
;
›› 
}
œœ 
if
 
(
 
m_fState
 
!=
 !
FCommunicationState
  3
.
3 4
	Connected
4 =
)
= >
{
ŸŸ 
e
   
.
   
sleepThread
   !
(
  ! "
$num
  " #
)
  # $
;
  $ %
return
¡¡ 
;
¡¡ 
}
¢¢ 
if
©© 
(
©© 
m_fTmrT7
©© 
.
©© 
elasped
©© $
(
©©$ %
false
©©% *
)
©©* +
)
©©+ ,
{
ªª 
this
«« 
.
«« 
fSecs1ToHsms
«« %
.
««% &
fEventPusher
««& 2
.
««2 3
pushHsmsEvent
««3 @
(
««@ A
new
¬¬ )
FHsmsTimeoutRaisedEventArgs
¬¬ 7
(
¬¬7 8
this
¬¬8 <
.
¬¬< =
fSecs1ToHsms
¬¬= I
,
¬¬I J
FEventId
¬¬K S
.
¬¬S T
HsmsTimeoutRaised
¬¬T e
,
¬¬e f
FSecsTimeout
¬¬g s
.
¬¬s t
T7
¬¬t v
,
¬¬v w 
getTimeoutMessage¬¬x ‰
(¬¬‰ Š
FSecsTimeout¬¬Š –
.¬¬– —
T7¬¬— ™
)¬¬™ š
)¬¬š ›
)
­­ 
;
­­ 
sendSeparateReq
¯¯ #
(
¯¯# $
)
¯¯$ %
;
¯¯% &
m_fTcpClient
¶¶  
.
¶¶  !
close
¶¶! &
(
¶¶& '
)
¶¶' (
;
¶¶( )
return
·· 
;
·· 
}
¸¸ 
if
¿¿ 
(
¿¿ 
m_fTmrT8
¿¿ 
.
¿¿ 
elasped
¿¿ $
(
¿¿$ %
false
¿¿% *
)
¿¿* +
)
¿¿+ ,
{
ÀÀ 
this
ÁÁ 
.
ÁÁ 
fSecs1ToHsms
ÁÁ %
.
ÁÁ% &
fEventPusher
ÁÁ& 2
.
ÁÁ2 3
pushHsmsEvent
ÁÁ3 @
(
ÁÁ@ A
new
ÂÂ )
FHsmsTimeoutRaisedEventArgs
ÂÂ 7
(
ÂÂ7 8
this
ÂÂ8 <
.
ÂÂ< =
fSecs1ToHsms
ÂÂ= I
,
ÂÂI J
FEventId
ÂÂK S
.
ÂÂS T
HsmsTimeoutRaised
ÂÂT e
,
ÂÂe f
FSecsTimeout
ÂÂg s
.
ÂÂs t
T8
ÂÂt v
,
ÂÂv w 
getTimeoutMessageÂÂx ‰
(ÂÂ‰ Š
FSecsTimeoutÂÂŠ –
.ÂÂ– —
T8ÂÂ— ™
)ÂÂ™ š
)ÂÂš ›
)
ÃÃ 
;
ÃÃ 
sendSeparateReq
ÅÅ #
(
ÅÅ# $
)
ÅÅ$ %
;
ÅÅ% &
m_fTcpClient
ÌÌ  
.
ÌÌ  !
close
ÌÌ! &
(
ÌÌ& '
)
ÌÌ' (
;
ÌÌ( )
return
ÍÍ 
;
ÍÍ 
}
ÎÎ 
e
ÒÒ 
.
ÒÒ 
sleepThread
ÒÒ 
(
ÒÒ 
$num
ÒÒ 
)
ÒÒ  
;
ÒÒ  !
}
ÓÓ 
catch
ÔÔ 
(
ÔÔ 
	Exception
ÔÔ 
ex
ÔÔ 
)
ÔÔ  
{
ÕÕ !
procHsmsErrorRaised
ÖÖ #
(
ÖÖ# $
ex
ÖÖ$ &
)
ÖÖ& '
;
ÖÖ' (
}
×× 
finally
ØØ 
{
ÙÙ 
if
ÚÚ 
(
ÚÚ 
waited
ÚÚ 
)
ÚÚ 
{
ÛÛ 
m_fMainSync
ÜÜ 
.
ÜÜ  
set
ÜÜ  #
(
ÜÜ# $
)
ÜÜ$ %
;
ÜÜ% &
}
İİ 
}
ŞŞ 
}
ßß 	
private
çç 
void
çç 0
"m_fTcpClient_TcpClientStateChanged
çç 7
(
çç7 8
object
èè 
sender
èè 
,
èè -
FTcpClientStateChangedEventArgs
éé +
e
éé, -
)
êê 
{
ëë 	
try
ìì 
{
íí 
m_fMainSync
îî 
.
îî 
wait
îî  
(
îî  !
)
îî! "
;
îî" #
if
òò 
(
òò 
e
òò 
.
òò 
fState
òò 
==
òò 
FTcpClientState
òò  /
.
òò/ 0
Closed
òò0 6
)
òò6 7
{
óó 
m_fState
ôô 
=
ôô !
FCommunicationState
ôô 2
.
ôô2 3
Closed
ôô3 9
;
ôô9 :
this
öö 
.
öö 
fSecs1ToHsms
öö %
.
öö% &
fEventPusher
öö& 2
.
öö2 3
pushHsmsEvent
öö3 @
(
öö@ A
new
÷÷ (
FHsmsStateChangedEventArgs
÷÷ 6
(
÷÷6 7
this
øø  
.
øø  !
fSecs1ToHsms
øø! -
,
øø- .
FEventId
ùù $
.
ùù$ %
HsmsStateChanged
ùù% 5
,
ùù5 6
FResultCode
úú '
.
úú' (
Warninig
úú( 0
,
úú0 1
string
ûû "
.
ûû" #
Format
ûû# )
(
ûû) *

FConstants
ûû* 4
.
ûû4 5

err_m_0024
ûû5 ?
,
ûû? @
$str
ûûA ^
)
ûû^ _
,
ûû_ `
FConnectMode
üü (
.
üü( )
Passive
üü) 0
,
üü0 1
this
ıı  
.
ıı  !
localIp
ıı! (
,
ıı( )
this
şş  
.
şş  !
	localPort
şş! *
,
şş* +
this
ÿÿ  
.
ÿÿ  !
remoteIp
ÿÿ! )
,
ÿÿ) *
this
€€  
.
€€  !

remotePort
€€! +
,
€€+ ,
m_fState
 $
)
‚‚ 
)
ƒƒ 
;
ƒƒ 
resetResource
‡‡ !
(
‡‡! "
)
‡‡" #
;
‡‡# $
}
ˆˆ 
}
‰‰ 
catch
ŠŠ 
(
ŠŠ 
	Exception
ŠŠ 
ex
ŠŠ 
)
ŠŠ  
{
‹‹ !
procHsmsErrorRaised
ŒŒ #
(
ŒŒ# $
ex
ŒŒ$ &
)
ŒŒ& '
;
ŒŒ' (
}
 
finally
 
{
 
m_fMainSync
 
.
 
set
 
(
  
)
  !
;
! "
}
‘‘ 
}
’’ 	
private
–– 
void
–– 0
"m_fTcpClient_TcpClientDataReceived
–– 7
(
––7 8
object
—— 
sender
—— 
,
—— -
FTcpClientDataReceivedEventArgs
˜˜ +
e
˜˜, -
)
™™ 
{
šš 	
try
›› 
{
œœ 
m_fMainSync
 
.
 
wait
  
(
  !
)
! "
;
" #
m_fTmrT8
¤¤ 
.
¤¤ 
stop
¤¤ 
(
¤¤ 
)
¤¤ 
;
¤¤  

m_fRecvBuf
¨¨ 
.
¨¨ 
input
¨¨  
(
¨¨  !
e
¨¨! "
.
¨¨" #
data
¨¨# '
)
¨¨' (
;
¨¨( )
while
ªª 
(
ªª 

m_fRecvBuf
ªª !
.
ªª! "
parse
ªª" '
(
ªª' (
)
ªª( )
)
ªª) *
{
«« 
if
¬¬ 
(
¬¬ 

m_fRecvBuf
¬¬ "
.
¬¬" #
stype
¬¬# (
==
¬¬) +
$num
¬¬, -
)
¬¬- .
{
­­ 
sendRejectReq
±± %
(
±±% &

m_fRecvBuf
±±& 0
.
±±0 1
	sessionId
±±1 :
,
±±: ;

m_fRecvBuf
±±< F
.
±±F G
stype
±±G L
,
±±L M
$num
±±N O
,
±±O P

m_fRecvBuf
±±Q [
.
±±[ \
systemBytes
±±\ g
)
±±g h
;
±±h i
}
²² 
else
³³ 
if
³³ 
(
³³ 

m_fRecvBuf
³³ '
.
³³' (
stype
³³( -
==
³³. 0
$num
³³1 2
)
³³2 3
{
´´ 
recvSelectReq
µµ %
(
µµ% &
)
µµ& '
;
µµ' (
}
¶¶ 
else
·· 
if
·· 
(
·· 

m_fRecvBuf
·· '
.
··' (
stype
··( -
==
··. 0
$num
··1 2
)
··2 3
{
¸¸ 
recvSelectRsp
¹¹ %
(
¹¹% &
)
¹¹& '
;
¹¹' (
}
ºº 
else
»» 
if
»» 
(
»» 

m_fRecvBuf
»» '
.
»»' (
stype
»»( -
==
»». 0
$num
»»1 2
)
»»2 3
{
¼¼ 
recvDeselectReq
½½ '
(
½½' (
)
½½( )
;
½½) *
}
¾¾ 
else
¿¿ 
if
¿¿ 
(
¿¿ 

m_fRecvBuf
¿¿ '
.
¿¿' (
stype
¿¿( -
==
¿¿. 0
$num
¿¿1 2
)
¿¿2 3
{
ÀÀ 
recvDeselectRsp
ÁÁ '
(
ÁÁ' (
)
ÁÁ( )
;
ÁÁ) *
}
ÂÂ 
else
ÃÃ 
if
ÃÃ 
(
ÃÃ 

m_fRecvBuf
ÃÃ '
.
ÃÃ' (
stype
ÃÃ( -
==
ÃÃ. 0
$num
ÃÃ1 2
)
ÃÃ2 3
{
ÄÄ 
recvLinktestReq
ÅÅ '
(
ÅÅ' (
)
ÅÅ( )
;
ÅÅ) *
}
ÆÆ 
else
ÇÇ 
if
ÇÇ 
(
ÇÇ 

m_fRecvBuf
ÇÇ '
.
ÇÇ' (
stype
ÇÇ( -
==
ÇÇ. 0
$num
ÇÇ1 2
)
ÇÇ2 3
{
ÈÈ 
recvLinktestRsp
ÉÉ '
(
ÉÉ' (
)
ÉÉ( )
;
ÉÉ) *
}
ÊÊ 
else
ËË 
if
ËË 
(
ËË 

m_fRecvBuf
ËË '
.
ËË' (
stype
ËË( -
==
ËË. 0
$num
ËË1 2
)
ËË2 3
{
ÌÌ 
recvRejectReq
ÍÍ %
(
ÍÍ% &
)
ÍÍ& '
;
ÍÍ' (
}
ÎÎ 
else
ÏÏ 
if
ÏÏ 
(
ÏÏ 

m_fRecvBuf
ÏÏ '
.
ÏÏ' (
stype
ÏÏ( -
==
ÏÏ. 0
$num
ÏÏ1 2
)
ÏÏ2 3
{
ĞĞ 
recvSeparateReq
ÑÑ '
(
ÑÑ' (
)
ÑÑ( )
;
ÑÑ) *
}
ÒÒ 
else
ÓÓ 
{
ÔÔ 
sendRejectReq
ØØ %
(
ØØ% &

m_fRecvBuf
ØØ& 0
.
ØØ0 1
	sessionId
ØØ1 :
,
ØØ: ;

m_fRecvBuf
ØØ< F
.
ØØF G
stype
ØØG L
,
ØØL M
$num
ØØN O
,
ØØO P

m_fRecvBuf
ØØQ [
.
ØØ[ \
systemBytes
ØØ\ g
)
ØØg h
;
ØØh i
}
ÙÙ 

m_fRecvBuf
İİ 
.
İİ 
init
İİ #
(
İİ# $
)
İİ$ %
;
İİ% &
}
ŞŞ 
if
åå 
(
åå 
!
åå 

m_fRecvBuf
åå 
.
åå  
isCompleted
åå  +
)
åå+ ,
{
ææ 
m_fTmrT8
çç 
.
çç 
start
çç "
(
çç" #
this
çç# '
.
çç' (
fSecs1ToHsms
çç( 4
.
çç4 5
fHsmsConfig
çç5 @
.
çç@ A
	t8Timeout
ççA J
*
ççK L
$num
ççM Q
)
ççQ R
;
ççR S
}
èè 
}
éé 
catch
êê 
(
êê 
	Exception
êê 
ex
êê 
)
êê  
{
ëë !
procHsmsErrorRaised
ìì #
(
ìì# $
ex
ìì$ &
)
ìì& '
;
ìì' (
}
íí 
finally
îî 
{
ïï 
m_fMainSync
ğğ 
.
ğğ 
set
ğğ 
(
ğğ  
)
ğğ  !
;
ğğ! "
}
ññ 
}
òò 	
private
öö 
void
öö ,
m_fTcpClient_TcpClientDataSent
öö 3
(
öö3 4
object
÷÷ 
sender
÷÷ 
,
÷÷ )
FTcpClientDataSentEventArgs
øø '
e
øø( )
)
ùù 
{
úú 	!
FSecsControlMessage
ûû !
fSecsControlMessage
ûû  3
=
ûû4 5
null
ûû6 :
;
ûû: ;
try
ıı 
{
şş 
m_fMainSync
ÿÿ 
.
ÿÿ 
wait
ÿÿ  
(
ÿÿ  !
)
ÿÿ! "
;
ÿÿ" #
if
ƒ	ƒ	 
(
ƒ	ƒ	 
e
ƒ	ƒ	 
.
ƒ	ƒ	 
fData
ƒ	ƒ	 
.
ƒ	ƒ	 
state
ƒ	ƒ	 !
is
ƒ	ƒ	" $!
FSecsControlMessage
ƒ	ƒ	% 8
)
ƒ	ƒ	8 9
{
„	„	 !
fSecsControlMessage
…	…	 '
=
…	…	( )
(
…	…	* +!
FSecsControlMessage
…	…	+ >
)
…	…	> ?
e
…	…	? @
.
…	…	@ A
fData
…	…	A F
.
…	…	F G
state
…	…	G L
;
…	…	L M
this
†	†	 
.
†	†	 
fSecs1ToHsms
†	†	 %
.
†	†	% &
fEventPusher
†	†	& 2
.
†	†	2 3
pushHsmsEvent
†	†	3 @
(
†	†	@ A
new
‡	‡	 .
 FHsmsControlMessageSentEventArgs
‡	‡	 <
(
‡	‡	< =
this
‡	‡	= A
.
‡	‡	A B
fSecs1ToHsms
‡	‡	B N
,
‡	‡	N O
FEventId
‡	‡	P X
.
‡	‡	X Y$
HsmsControlMessageSent
‡	‡	Y o
,
‡	‡	o p
FResultCode
‡	‡	q |
.
‡	‡	| }
Success‡	‡	} „
,‡	‡	„ …
string‡	‡	† Œ
.‡	‡	Œ 
Empty‡	‡	 ’
,‡	‡	’ “#
fSecsControlMessage‡	‡	” §
)‡	‡	§ ¨
)
ˆ	ˆ	 
;
ˆ	ˆ	 
if
‹	‹	 
(
‹	‹	 !
fSecsControlMessage
‹	‹	 +
.
‹	‹	+ ,
fType
‹	‹	, 1
==
‹	‹	2 4%
FHsmsControlMessageType
‹	‹	5 L
.
‹	‹	L M
	SelectRsp
‹	‹	M V
)
‹	‹	V W
{
Œ	Œ	 
sendSeparateReq
		 '
(
		' (
)
		( )
;
		) *
m_fTcpClient
”	”	 $
.
”	”	$ %
close
”	”	% *
(
”	”	* +
)
”	”	+ ,
;
”	”	, -
}
•	•	 
}
–	–	 
}
—	—	 
catch
˜	˜	 
(
˜	˜	 
	Exception
˜	˜	 
ex
˜	˜	 
)
˜	˜	  
{
™	™	 !
procHsmsErrorRaised
š	š	 #
(
š	š	# $
ex
š	š	$ &
)
š	š	& '
;
š	š	' (
}
›	›	 
finally
œ	œ	 
{
		 !
fSecsControlMessage
		 #
=
		$ %
null
		& *
;
		* +
m_fMainSync
 	 	 
.
 	 	 
set
 	 	 
(
 	 	  
)
 	 	  !
;
 	 	! "
}
¡	¡	 
}
¢	¢	 	
private
¦	¦	 
void
¦	¦	 2
$m_fTcpClient_TcpClientDataSendFailed
¦	¦	 9
(
¦	¦	9 :
object
§	§	 
sender
§	§	 
,
§	§	 /
!FTcpClientDataSendFailedEventArgs
¨	¨	 -
e
¨	¨	. /
)
©	©	 
{
ª	ª	 	!
FSecsControlMessage
«	«	 !
fSecsControlMessage
«	«	  3
=
«	«	4 5
null
«	«	6 :
;
«	«	: ;
try
­	­	 
{
®	®	 
m_fMainSync
¯	¯	 
.
¯	¯	 
wait
¯	¯	  
(
¯	¯	  !
)
¯	¯	! "
;
¯	¯	" #
if
³	³	 
(
³	³	 
e
³	³	 
.
³	³	 
fData
³	³	 
.
³	³	 
state
³	³	 !
is
³	³	" $!
FSecsControlMessage
³	³	% 8
)
³	³	8 9
{
´	´	 !
fSecsControlMessage
µ	µ	 '
=
µ	µ	( )
(
µ	µ	* +!
FSecsControlMessage
µ	µ	+ >
)
µ	µ	> ?
e
µ	µ	? @
.
µ	µ	@ A
fData
µ	µ	A F
.
µ	µ	F G
state
µ	µ	G L
;
µ	µ	L M
this
¶	¶	 
.
¶	¶	 
fSecs1ToHsms
¶	¶	 %
.
¶	¶	% &
fEventPusher
¶	¶	& 2
.
¶	¶	2 3
pushHsmsEvent
¶	¶	3 @
(
¶	¶	@ A
new
·	·	 .
 FHsmsControlMessageSentEventArgs
·	·	 <
(
·	·	< =
this
·	·	= A
.
·	·	A B
fSecs1ToHsms
·	·	B N
,
·	·	N O
FEventId
·	·	P X
.
·	·	X Y$
HsmsControlMessageSent
·	·	Y o
,
·	·	o p
FResultCode
·	·	q |
.
·	·	| }
Error·	·	} ‚
,·	·	‚ ƒ
e·	·	„ …
.·	·	… †
message·	·	† 
,·	·	 #
fSecsControlMessage·	·	 ¢
)·	·	¢ £
)
¸	¸	 
;
¸	¸	 
}
¹	¹	 
}
º	º	 
catch
»	»	 
(
»	»	 
	Exception
»	»	 
ex
»	»	 
)
»	»	  
{
¼	¼	 !
procHsmsErrorRaised
½	½	 #
(
½	½	# $
ex
½	½	$ &
)
½	½	& '
;
½	½	' (
}
¾	¾	 
finally
¿	¿	 
{
À	À	 
m_fMainSync
Á	Á	 
.
Á	Á	 
set
Á	Á	 
(
Á	Á	  
)
Á	Á	  !
;
Á	Á	! "
}
Â	Â	 
}
Ã	Ã	 	
private
Ç	Ç	 
void
Ç	Ç	 /
!m_fTcpClient_TcpClientErrorRaised
Ç	Ç	 6
(
Ç	Ç	6 7
object
È	È	 
sender
È	È	 
,
È	È	 ,
FTcpClientErrorRaisedEventArgs
É	É	 *
e
É	É	+ ,
)
Ê	Ê	 
{
Ë	Ë	 	
try
Ì	Ì	 
{
Í	Í	 !
procHsmsErrorRaised
Î	Î	 #
(
Î	Î	# $
e
Î	Î	$ %
.
Î	Î	% &
	exception
Î	Î	& /
)
Î	Î	/ 0
;
Î	Î	0 1
}
Ï	Ï	 
catch
Ğ	Ğ	 
(
Ğ	Ğ	 
	Exception
Ğ	Ğ	 
ex
Ğ	Ğ	 
)
Ğ	Ğ	  
{
Ñ	Ñ	 !
procHsmsErrorRaised
Ò	Ò	 #
(
Ò	Ò	# $
ex
Ò	Ò	$ &
)
Ò	Ò	& '
;
Ò	Ò	' (
}
Ó	Ó	 
finally
Ô	Ô	 
{
Õ	Õ	 
}
×	×	 
}
Ø	Ø	 	
}
Ş	Ş	 
}ß	ß	 Ûè
yD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Protocol\HSMS\c_FHsmsActive.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
internal 
class 
FHsmsActive 
: 
	FBaseHsms  )
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FHsmsRecvBuffer 

m_fRecvBuf  *
=+ ,
null- 1
;1 2
private 

FTcpClient 
m_fTcpClient '
=( )
null* .
;. /
private 
	FCodeLock 
m_fMainSync %
=& '
null( ,
;, -
private 
FThread 

m_fThdMain "
=# $
null% )
;) *
private   
FStaticTimer   
m_fTmrLinktest   +
=  , -
null  . 2
;  2 3
private!! 
FStaticTimer!! 
m_fTmrT8!! %
=!!& '
null!!( ,
;!!, -
private"" *
FHsmsControlMessageTransaction"" .
m_fTranSelectReq""/ ?
=""@ A
null""B F
;""F G
private## *
FHsmsControlMessageTransaction## .
m_fTranLinktestReq##/ A
=##B C
null##D H
;##H I
public)) 
FHsmsActive)) 
()) 
FSecs1ToHsms** 
fSecs1ToHsms** %
)++ 
:,, 
base,, 
(,, 
fSecs1ToHsms,, 
),,  
{-- 	
init.. 
(.. 
).. 
;.. 
}// 	
~33 	
FHsmsActive33	 
(33 
)44 
{55 	
	myDispose66 
(66 
false66 
)66 
;66 
}77 	
	protected;; 
override;; 
void;; 
	myDispose;;  )
(;;) *
bool<< 
	disposing<< 
)== 
{>> 	
if?? 
(?? 
!?? 

m_disposed?? 
)?? 
{@@ 
ifAA 
(AA 
	disposingAA 
)AA 
{BB 
termCC 
(CC 
)CC 
;CC 
}DD 
baseHH 
.HH 
	myDisposeHH 
(HH 
	disposingHH (
)HH( )
;HH) *
}II 
}JJ 	
publicRR 
voidRR 
DisposeRR 
(RR 
)SS 
{TT 	
	myDisposeUU 
(UU 
trueUU 
)UU 
;UU 
GCVV 
.VV 
SuppressFinalizeVV 
(VV  
thisVV  $
)VV$ %
;VV% &
}WW 	
privategg 
voidgg 
initgg 
(gg 
)hh 
{ii 	
tryjj 
{kk 
m_fTmrLinktestll 
=ll  
newll! $
FStaticTimerll% 1
(ll1 2
)ll2 3
;ll3 4
m_fTmrT8mm 
=mm 
newmm 
FStaticTimermm +
(mm+ ,
)mm, -
;mm- .
m_fTranSelectReqnn  
=nn! "
newnn# &*
FHsmsControlMessageTransactionnn' E
(nnE F
thisnnF J
.nnJ K
fSecs1ToHsmsnnK W
)nnW X
;nnX Y
m_fTranLinktestReqoo "
=oo# $
newoo% (*
FHsmsControlMessageTransactionoo) G
(ooG H
thisooH L
.ooL M
fSecs1ToHsmsooM Y
)ooY Z
;ooZ [

m_fRecvBufpp 
=pp 
newpp  
FHsmsRecvBufferpp! 0
(pp0 1
)pp1 2
;pp2 3
m_fMainSynctt 
=tt 
newtt !
	FCodeLocktt" +
(tt+ ,
)tt, -
;tt- .

m_fThdMainuu 
=uu 
newuu  
FThreaduu! (
(uu( )
$struu) @
)uu@ A
;uuA B

m_fThdMainvv 
.vv 
ThreadJobCalledvv *
+=vv+ -
newvv. 1(
FThreadJobCalledEventHandlervv2 N
(vvN O&
m_fThdMain_ThreadJobCalledvvO i
)vvi j
;vvj k

m_fThdMainww 
.ww 
startww  
(ww  !
)ww! "
;ww" #
}xx 
catchyy 
(yy 
	Exceptionyy 
exyy 
)yy  
{zz 
FDebug{{ 
.{{ 
throwException{{ %
({{% &
ex{{& (
){{( )
;{{) *
}|| 
finally}} 
{~~ 
}
€€ 
}
 	
private
…… 
void
…… 
term
…… 
(
…… 
)
†† 
{
‡‡ 	
try
ˆˆ 
{
‰‰ 
if
ŠŠ 
(
ŠŠ 

m_fThdMain
ŠŠ 
!=
ŠŠ !
null
ŠŠ" &
)
ŠŠ& '
{
‹‹ 

m_fThdMain
ŒŒ 
.
ŒŒ 
stop
ŒŒ #
(
ŒŒ# $
)
ŒŒ$ %
;
ŒŒ% &

m_fThdMain
 
.
 
Dispose
 &
(
& '
)
' (
;
( )

m_fThdMain
 
.
 
ThreadJobCalled
 .
-=
/ 1
new
2 5*
FThreadJobCalledEventHandler
6 R
(
R S(
m_fThdMain_ThreadJobCalled
S m
)
m n
;
n o

m_fThdMain
 
=
  
null
! %
;
% &
}
 
if
”” 
(
”” 
m_fTcpClient
””  
!=
””! #
null
””$ (
)
””( )
{
•• 
m_fTcpClient
––  
.
––  !
close
––! &
(
––& '
)
––' (
;
––( )
m_fTcpClient
——  
.
——  !
Dispose
——! (
(
——( )
)
——) *
;
——* +
m_fTcpClient
™™  
.
™™  !#
TcpClientStateChanged
™™! 6
-=
™™7 9
new
™™: =0
"FTcpClientStateChangedEventHandler
™™> `
(
™™` a1
"m_fTcpClient_TcpClientStateChanged™™a ƒ
)™™ƒ „
;™™„ …
m_fTcpClient
šš  
.
šš  !#
TcpClientDataReceived
šš! 6
-=
šš7 9
new
šš: =0
"FTcpClientDataReceivedEventHandler
šš> `
(
šš` a1
"m_fTcpClient_TcpClientDataReceivedšša ƒ
)ššƒ „
;šš„ …
m_fTcpClient
››  
.
››  !
TcpClientDataSent
››! 2
-=
››3 5
new
››6 9,
FTcpClientDataSentEventHandler
››: X
(
››X Y,
m_fTcpClient_TcpClientDataSent
››Y w
)
››w x
;
››x y
m_fTcpClient
œœ  
.
œœ  !%
TcpClientDataSendFailed
œœ! 8
-=
œœ9 ;
new
œœ< ?2
$FTcpClientDataSendFailedEventHandler
œœ@ d
(
œœd e3
$m_fTcpClient_TcpClientDataSendFailedœœe ‰
)œœ‰ Š
;œœŠ ‹
m_fTcpClient
  
.
  !"
TcpClientErrorRaised
! 5
-=
6 8
new
9 </
!FTcpClientErrorRaisedEventHandler
= ^
(
^ _0
!m_fTcpClient_TcpClientErrorRaised_ €
)€ 
; ‚
m_fTcpClient
ŸŸ  
=
ŸŸ! "
null
ŸŸ# '
;
ŸŸ' (
}
   
if
¤¤ 
(
¤¤ 
m_fTmrLinktest
¤¤ "
!=
¤¤# %
null
¤¤& *
)
¤¤* +
{
¥¥ 
m_fTmrLinktest
¦¦ "
.
¦¦" #
Dispose
¦¦# *
(
¦¦* +
)
¦¦+ ,
;
¦¦, -
m_fTmrLinktest
§§ "
=
§§# $
null
§§% )
;
§§) *
}
¨¨ 
if
ªª 
(
ªª 
m_fTmrT8
ªª 
!=
ªª 
null
ªª  $
)
ªª$ %
{
«« 
m_fTmrT8
¬¬ 
.
¬¬ 
Dispose
¬¬ $
(
¬¬$ %
)
¬¬% &
;
¬¬& '
m_fTmrT8
­­ 
=
­­ 
null
­­ #
;
­­# $
}
®® 
if
°° 
(
°° 
m_fTranSelectReq
°° $
!=
°°% '
null
°°( ,
)
°°, -
{
±± 
m_fTranSelectReq
²² $
.
²²$ %
Dispose
²²% ,
(
²², -
)
²²- .
;
²². /
m_fTranSelectReq
³³ $
=
³³% &
null
³³' +
;
³³+ ,
}
´´ 
if
¶¶ 
(
¶¶  
m_fTranLinktestReq
¶¶ &
!=
¶¶' )
null
¶¶* .
)
¶¶. /
{
··  
m_fTranLinktestReq
¸¸ &
.
¸¸& '
Dispose
¸¸' .
(
¸¸. /
)
¸¸/ 0
;
¸¸0 1 
m_fTranLinktestReq
¹¹ &
=
¹¹' (
null
¹¹) -
;
¹¹- .
}
ºº 
if
¼¼ 
(
¼¼ 

m_fRecvBuf
¼¼ 
!=
¼¼ !
null
¼¼" &
)
¼¼& '
{
½½ 

m_fRecvBuf
¾¾ 
.
¾¾ 
Dispose
¾¾ &
(
¾¾& '
)
¾¾' (
;
¾¾( )

m_fRecvBuf
¿¿ 
=
¿¿  
null
¿¿! %
;
¿¿% &
}
ÀÀ 
if
ÂÂ 
(
ÂÂ 
m_fMainSync
ÂÂ 
!=
ÂÂ  "
null
ÂÂ# '
)
ÂÂ' (
{
ÃÃ 
m_fMainSync
ÄÄ 
.
ÄÄ  
Dispose
ÄÄ  '
(
ÄÄ' (
)
ÄÄ( )
;
ÄÄ) *
m_fMainSync
ÅÅ 
=
ÅÅ  !
null
ÅÅ" &
;
ÅÅ& '
}
ÆÆ 
}
ÇÇ 
catch
ÈÈ 
(
ÈÈ 
	Exception
ÈÈ 
ex
ÈÈ 
)
ÈÈ  
{
ÉÉ 
FDebug
ÊÊ 
.
ÊÊ 
throwException
ÊÊ %
(
ÊÊ% &
ex
ÊÊ& (
)
ÊÊ( )
;
ÊÊ) *
}
ËË 
finally
ÌÌ 
{
ÍÍ 
}
ÏÏ 
}
ĞĞ 	
public
ÔÔ 
override
ÔÔ 
void
ÔÔ 
open
ÔÔ !
(
ÔÔ! "
)
ÕÕ 
{
ÖÖ 	
try
×× 
{
ØØ 
m_fTcpClient
ÙÙ 
=
ÙÙ 
new
ÙÙ "

FTcpClient
ÙÙ# -
(
ÙÙ- .
this
ÚÚ 
.
ÚÚ 
fSecs1ToHsms
ÚÚ $
.
ÚÚ$ %
fHsmsConfig
ÚÚ% 0
.
ÚÚ0 1
localIp
ÚÚ1 8
,
ÚÚ8 9
this
ÛÛ 
.
ÛÛ 
fSecs1ToHsms
ÛÛ $
.
ÛÛ$ %
fHsmsConfig
ÛÛ% 0
.
ÛÛ0 1
remoteIp
ÛÛ1 9
,
ÛÛ9 :
this
ÜÜ 
.
ÜÜ 
fSecs1ToHsms
ÜÜ $
.
ÜÜ$ %
fHsmsConfig
ÜÜ% 0
.
ÜÜ0 1

remotePort
ÜÜ1 ;
)
İİ 
;
İİ 
m_fTcpClient
ŞŞ 
.
ŞŞ  
retryConnectPeriod
ŞŞ /
=
ŞŞ0 1
this
ŞŞ2 6
.
ŞŞ6 7
fSecs1ToHsms
ŞŞ7 C
.
ŞŞC D
fHsmsConfig
ŞŞD O
.
ŞŞO P
	t5Timeout
ŞŞP Y
*
ŞŞZ [
$num
ŞŞ\ `
;
ŞŞ` a
m_fTcpClient
àà 
.
àà #
TcpClientStateChanged
àà 2
+=
àà3 5
new
àà6 90
"FTcpClientStateChangedEventHandler
àà: \
(
àà\ ]0
"m_fTcpClient_TcpClientStateChanged
àà] 
)àà €
;àà€ 
m_fTcpClient
áá 
.
áá #
TcpClientDataReceived
áá 2
+=
áá3 5
new
áá6 90
"FTcpClientDataReceivedEventHandler
áá: \
(
áá\ ]0
"m_fTcpClient_TcpClientDataReceived
áá] 
)áá €
;áá€ 
m_fTcpClient
ââ 
.
ââ 
TcpClientDataSent
ââ .
+=
ââ/ 1
new
ââ2 5,
FTcpClientDataSentEventHandler
ââ6 T
(
ââT U,
m_fTcpClient_TcpClientDataSent
ââU s
)
ââs t
;
âât u
m_fTcpClient
ãã 
.
ãã %
TcpClientDataSendFailed
ãã 4
+=
ãã5 7
new
ãã8 ;2
$FTcpClientDataSendFailedEventHandler
ãã< `
(
ãã` a3
$m_fTcpClient_TcpClientDataSendFailedããa …
)ãã… †
;ãã† ‡
m_fTcpClient
ää 
.
ää "
TcpClientErrorRaised
ää 1
+=
ää2 4
new
ää5 8/
!FTcpClientErrorRaisedEventHandler
ää9 Z
(
ääZ [/
!m_fTcpClient_TcpClientErrorRaised
ää[ |
)
ää| }
;
ää} ~
m_fTcpClient
ææ 
.
ææ 
connect
ææ $
(
ææ$ %
)
ææ% &
;
ææ& '
}
çç 
catch
èè 
(
èè 
	Exception
èè 
ex
èè 
)
èè  
{
éé 
FDebug
êê 
.
êê 
throwException
êê %
(
êê% &
ex
êê& (
)
êê( )
;
êê) *
}
ëë 
finally
ìì 
{
íí 
}
ïï 
}
ğğ 	
public
ôô 
override
ôô 
void
ôô 
close
ôô "
(
ôô" #
)
õõ 
{
öö 	
try
÷÷ 
{
øø 
if
ùù 
(
ùù 
m_fTcpClient
ùù  
==
ùù! #
null
ùù$ (
)
ùù( )
{
úú 
return
ûû 
;
ûû 
}
üü 
if
€€ 
(
€€ 
m_fTcpClient
€€  
.
€€  !
fState
€€! '
==
€€( *
FTcpClientState
€€+ :
.
€€: ;
	Connected
€€; D
)
€€D E
{
 
if
‚‚ 
(
‚‚ 
this
‚‚ 
.
‚‚ 
fSecs1ToHsms
‚‚ )
.
‚‚) *

fHsmsState
‚‚* 4
==
‚‚5 7!
FCommunicationState
‚‚8 K
.
‚‚K L
Selected
‚‚L T
)
‚‚T U
{
ƒƒ 
while
„„ 
(
„„ 
this
„„ #
.
„„# $
fSecs1ToHsms
„„$ 0
.
„„0 1
fEventPusher
„„1 =
.
„„= >
hsmsEventCount
„„> L
>
„„M N
$num
„„O P
||
„„Q S
!
„„T U
m_fTcpClient
„„U a
.
„„a b
sendCompleted
„„b o
)
„„o p
{
…… 
if
†† 
(
††  
System
††  &
.
††& '
Windows
††' .
.
††. /
Forms
††/ 4
.
††4 5
Application
††5 @
.
††@ A
MessageLoop
††A L
)
††L M
{
‡‡ 
System
ˆˆ  &
.
ˆˆ& '
Windows
ˆˆ' .
.
ˆˆ. /
Forms
ˆˆ/ 4
.
ˆˆ4 5
Application
ˆˆ5 @
.
ˆˆ@ A
DoEvents
ˆˆA I
(
ˆˆI J
)
ˆˆJ K
;
ˆˆK L
}
‰‰ 
System
ŠŠ "
.
ŠŠ" #
	Threading
ŠŠ# ,
.
ŠŠ, -
Thread
ŠŠ- 3
.
ŠŠ3 4
Sleep
ŠŠ4 9
(
ŠŠ9 :
$num
ŠŠ: ;
)
ŠŠ; <
;
ŠŠ< =
}
‹‹ 
}
ŒŒ 
sendSeparateReq
 #
(
# $
)
$ %
;
% &
}
 
m_fTcpClient
““ 
.
““ 
close
““ "
(
““" #
)
““# $
;
““$ %
m_fTcpClient
”” 
.
”” 
Dispose
”” $
(
””$ %
)
””% &
;
””& '
m_fTcpClient
–– 
.
–– #
TcpClientStateChanged
–– 2
-=
––3 5
new
––6 90
"FTcpClientStateChangedEventHandler
––: \
(
––\ ]0
"m_fTcpClient_TcpClientStateChanged
––] 
)–– €
;––€ 
m_fTcpClient
—— 
.
—— #
TcpClientDataReceived
—— 2
-=
——3 5
new
——6 90
"FTcpClientDataReceivedEventHandler
——: \
(
——\ ]0
"m_fTcpClient_TcpClientDataReceived
——] 
)—— €
;——€ 
m_fTcpClient
˜˜ 
.
˜˜ 
TcpClientDataSent
˜˜ .
-=
˜˜/ 1
new
˜˜2 5,
FTcpClientDataSentEventHandler
˜˜6 T
(
˜˜T U,
m_fTcpClient_TcpClientDataSent
˜˜U s
)
˜˜s t
;
˜˜t u
m_fTcpClient
™™ 
.
™™ %
TcpClientDataSendFailed
™™ 4
-=
™™5 7
new
™™8 ;2
$FTcpClientDataSendFailedEventHandler
™™< `
(
™™` a3
$m_fTcpClient_TcpClientDataSendFailed™™a …
)™™… †
;™™† ‡
m_fTcpClient
šš 
.
šš "
TcpClientErrorRaised
šš 1
-=
šš2 4
new
šš5 8/
!FTcpClientErrorRaisedEventHandler
šš9 Z
(
ššZ [/
!m_fTcpClient_TcpClientErrorRaised
šš[ |
)
šš| }
;
šš} ~
m_fTcpClient
œœ 
=
œœ 
null
œœ #
;
œœ# $
}
 
catch
 
(
 
	Exception
 
ex
 
)
  
{
ŸŸ 
FDebug
   
.
   
throwException
   %
(
  % &
ex
  & (
)
  ( )
;
  ) *
}
¡¡ 
finally
¢¢ 
{
££ 
}
¥¥ 
}
¦¦ 	
public
ªª 
override
ªª 
void
ªª 
send
ªª !
(
ªª! "
FSecsDataMessage
«« 
fSecsDataMessage
«« -
)
¬¬ 
{
­­ 	
try
®® 
{
¯¯ 
sendDataMessage
°° 
(
°°  
fSecsDataMessage
°°  0
)
°°0 1
;
°°1 2
}
±± 
catch
²² 
(
²² 
	Exception
²² 
ex
²² 
)
²²  
{
³³ 
FDebug
´´ 
.
´´ 
throwException
´´ %
(
´´% &
ex
´´& (
)
´´( )
;
´´) *
}
µµ 
finally
¶¶ 
{
·· 
}
¹¹ 
}
ºº 	
private
¾¾ 
void
¾¾ 
resetResource
¾¾ "
(
¾¾" #
)
¿¿ 
{
ÀÀ 	
try
ÁÁ 
{
ÂÂ 
m_fTmrLinktest
ÆÆ 
.
ÆÆ 
stop
ÆÆ #
(
ÆÆ# $
)
ÆÆ$ %
;
ÆÆ% &
m_fTmrT8
ÇÇ 
.
ÇÇ 
stop
ÇÇ 
(
ÇÇ 
)
ÇÇ 
;
ÇÇ  
m_fTranSelectReq
ÈÈ  
.
ÈÈ  !
reset
ÈÈ! &
(
ÈÈ& '
)
ÈÈ' (
;
ÈÈ( ) 
m_fTranLinktestReq
ÉÉ "
.
ÉÉ" #
reset
ÉÉ# (
(
ÉÉ( )
)
ÉÉ) *
;
ÉÉ* +

m_fRecvBuf
ÊÊ 
.
ÊÊ 
clear
ÊÊ  
(
ÊÊ  !
)
ÊÊ! "
;
ÊÊ" #
}
ËË 
catch
ÌÌ 
(
ÌÌ 
	Exception
ÌÌ 
ex
ÌÌ 
)
ÌÌ  
{
ÍÍ 
FDebug
ÎÎ 
.
ÎÎ 
throwException
ÎÎ %
(
ÎÎ% &
ex
ÎÎ& (
)
ÎÎ( )
;
ÎÎ) *
}
ÏÏ 
finally
ĞĞ 
{
ÑÑ 
}
ÓÓ 
}
ÔÔ 	
private
ØØ 
void
ØØ 
sendSelectReq
ØØ "
(
ØØ" #
)
ÙÙ 
{
ÚÚ 	
FHsmsSendBuffer
ÛÛ 
fBuf
ÛÛ  
=
ÛÛ! "
null
ÛÛ# '
;
ÛÛ' (!
FSecsControlMessage
ÜÜ !
fSecsControlMessage
ÜÜ  3
=
ÜÜ4 5
null
ÜÜ6 :
;
ÜÜ: ;
try
ŞŞ 
{
ßß 
fBuf
àà 
=
àà 
new
àà 
FHsmsSendBuffer
àà *
(
àà* +
)
àà+ ,
;
àà, -
fBuf
áá 
.
áá 
genSelectReq
áá !
(
áá! "
this
áá" &
.
áá& '!
fSystemBytesPointer
áá' :
.
áá: ;
uniqueId
áá; C
)
ááC D
;
ááD E!
fSecsControlMessage
ãã #
=
ãã$ %
new
ãã& )!
FSecsControlMessage
ãã* =
(
ãã= >
this
ää 
.
ää 
fSecs1ToHsms
ää %
,
ää% &%
FHsmsControlMessageType
åå +
.
åå+ ,
	SelectReq
åå, 5
,
åå5 6
fBuf
ææ 
.
ææ 
	sessionId
ææ "
,
ææ" #
fBuf
çç 
.
çç 
byte2
çç 
,
çç 
fBuf
èè 
.
èè 
byte3
èè 
,
èè 
fBuf
éé 
.
éé 
ptype
éé 
,
éé 
fBuf
êê 
.
êê 
stype
êê 
,
êê 
fBuf
ëë 
.
ëë 
systemBytes
ëë $
,
ëë$ %
string
ìì 
.
ìì 
Empty
ìì  
)
íí 
;
íí 
m_fTcpClient
ïï 
.
ïï 
send
ïï !
(
ïï! "
new
ïï" %
FSocketSendData
ïï& 5
(
ïï5 6
fBuf
ïï6 :
.
ïï: ;
getBinaryData
ïï; H
(
ïïH I
)
ïïI J
,
ïïJ K!
fSecsControlMessage
ïïL _
)
ïï_ `
)
ïï` a
;
ïïa b
m_fTranSelectReq
öö  
.
öö  !
set
öö! $
(
öö$ %
fBuf
öö% )
.
öö) *
	sessionId
öö* 3
,
öö3 4
fBuf
öö5 9
.
öö9 :
systemBytes
öö: E
)
ööE F
;
ööF G
}
÷÷ 
catch
øø 
(
øø 
	Exception
øø 
ex
øø 
)
øø  
{
ùù !
procHsmsErrorRaised
úú #
(
úú# $
ex
úú$ &
)
úú& '
;
úú' (
}
ûû 
finally
üü 
{
ıı 
fBuf
şş 
=
şş 
null
şş 
;
şş !
fSecsControlMessage
ÿÿ #
=
ÿÿ$ %
null
ÿÿ& *
;
ÿÿ* +
}
€€ 
}
 	
private
…… 
void
…… 
sendDeselectRsp
…… $
(
……$ %
UInt16
†† 
	sessionId
†† 
,
†† 
UInt32
‡‡ 
systemBytes
‡‡ 
)
ˆˆ 
{
‰‰ 	
FHsmsSendBuffer
ŠŠ 
fBuf
ŠŠ  
=
ŠŠ! "
null
ŠŠ# '
;
ŠŠ' (!
FSecsControlMessage
‹‹ !
fSecsControlMessage
‹‹  3
=
‹‹4 5
null
‹‹6 :
;
‹‹: ;
try
 
{
 
fBuf
 
=
 
new
 
FHsmsSendBuffer
 *
(
* +
)
+ ,
;
, -
fBuf
 
.
 
genDeselectRsp
 #
(
# $
	sessionId
$ -
,
- .
systemBytes
/ :
)
: ;
;
; <!
fSecsControlMessage
’’ #
=
’’$ %
new
’’& )!
FSecsControlMessage
’’* =
(
’’= >
this
““ 
.
““ 
fSecs1ToHsms
““ %
,
““% &%
FHsmsControlMessageType
”” +
.
””+ ,
DeselectRsp
””, 7
,
””7 8
fBuf
•• 
.
•• 
	sessionId
•• "
,
••" #
fBuf
–– 
.
–– 
byte2
–– 
,
–– 
fBuf
—— 
.
—— 
byte3
—— 
,
—— 
fBuf
˜˜ 
.
˜˜ 
ptype
˜˜ 
,
˜˜ 
fBuf
™™ 
.
™™ 
stype
™™ 
,
™™ 
fBuf
šš 
.
šš 
systemBytes
šš $
,
šš$ %
string
›› 
.
›› 
Empty
››  
)
œœ 
;
œœ 
m_fTcpClient
 
.
 
send
 !
(
! "
new
" %
FSocketSendData
& 5
(
5 6
fBuf
6 :
.
: ;
getBinaryData
; H
(
H I
)
I J
,
J K!
fSecsControlMessage
L _
)
_ `
)
` a
;
a b
}
ŸŸ 
catch
   
(
   
	Exception
   
ex
   
)
    
{
¡¡ !
procHsmsErrorRaised
¢¢ #
(
¢¢# $
ex
¢¢$ &
)
¢¢& '
;
¢¢' (
}
££ 
finally
¤¤ 
{
¥¥ 
fBuf
¦¦ 
=
¦¦ 
null
¦¦ 
;
¦¦ !
fSecsControlMessage
§§ #
=
§§$ %
null
§§& *
;
§§* +
}
¨¨ 
}
©© 	
private
­­ 
void
­­ 
sendLinktestReq
­­ $
(
­­$ %
)
®® 
{
¯¯ 	
FHsmsSendBuffer
°° 
fBuf
°°  
=
°°! "
null
°°# '
;
°°' (!
FSecsControlMessage
±± !
fSecsControlMessage
±±  3
=
±±4 5
null
±±6 :
;
±±: ;
try
³³ 
{
´´ 
fBuf
µµ 
=
µµ 
new
µµ 
FHsmsSendBuffer
µµ *
(
µµ* +
)
µµ+ ,
;
µµ, -
fBuf
¶¶ 
.
¶¶ 
genLinktestReq
¶¶ #
(
¶¶# $
this
¶¶$ (
.
¶¶( )!
fSystemBytesPointer
¶¶) <
.
¶¶< =
uniqueId
¶¶= E
)
¶¶E F
;
¶¶F G!
fSecsControlMessage
¸¸ #
=
¸¸$ %
new
¸¸& )!
FSecsControlMessage
¸¸* =
(
¸¸= >
this
¹¹ 
.
¹¹ 
fSecs1ToHsms
¹¹ %
,
¹¹% &%
FHsmsControlMessageType
ºº +
.
ºº+ ,
LinktestReq
ºº, 7
,
ºº7 8
fBuf
»» 
.
»» 
	sessionId
»» "
,
»»" #
fBuf
¼¼ 
.
¼¼ 
byte2
¼¼ 
,
¼¼ 
fBuf
½½ 
.
½½ 
byte3
½½ 
,
½½ 
fBuf
¾¾ 
.
¾¾ 
ptype
¾¾ 
,
¾¾ 
fBuf
¿¿ 
.
¿¿ 
stype
¿¿ 
,
¿¿ 
fBuf
ÀÀ 
.
ÀÀ 
systemBytes
ÀÀ $
,
ÀÀ$ %
string
ÁÁ 
.
ÁÁ 
Empty
ÁÁ  
)
ÂÂ 
;
ÂÂ 
m_fTcpClient
ÄÄ 
.
ÄÄ 
send
ÄÄ !
(
ÄÄ! "
new
ÄÄ" %
FSocketSendData
ÄÄ& 5
(
ÄÄ5 6
fBuf
ÄÄ6 :
.
ÄÄ: ;
getBinaryData
ÄÄ; H
(
ÄÄH I
)
ÄÄI J
,
ÄÄJ K!
fSecsControlMessage
ÄÄL _
)
ÄÄ_ `
)
ÄÄ` a
;
ÄÄa b 
m_fTranLinktestReq
ËË "
.
ËË" #
set
ËË# &
(
ËË& '
fBuf
ËË' +
.
ËË+ ,
	sessionId
ËË, 5
,
ËË5 6
fBuf
ËË7 ;
.
ËË; <
systemBytes
ËË< G
)
ËËG H
;
ËËH I
}
ÌÌ 
catch
ÍÍ 
(
ÍÍ 
	Exception
ÍÍ 
ex
ÍÍ 
)
ÍÍ  
{
ÎÎ !
procHsmsErrorRaised
ÏÏ #
(
ÏÏ# $
ex
ÏÏ$ &
)
ÏÏ& '
;
ÏÏ' (
}
ĞĞ 
finally
ÑÑ 
{
ÒÒ 
fBuf
ÓÓ 
=
ÓÓ 
null
ÓÓ 
;
ÓÓ !
fSecsControlMessage
ÔÔ #
=
ÔÔ$ %
null
ÔÔ& *
;
ÔÔ* +
}
ÕÕ 
}
ÖÖ 	
private
ÚÚ 
void
ÚÚ 
sendLinktestRsp
ÚÚ $
(
ÚÚ$ %
UInt16
ÛÛ 
	sessionId
ÛÛ 
,
ÛÛ 
UInt32
ÜÜ 
systemBytes
ÜÜ 
)
İİ 
{
ŞŞ 	
FHsmsSendBuffer
ßß 
fBuf
ßß  
=
ßß! "
null
ßß# '
;
ßß' (!
FSecsControlMessage
àà !
fSecsControlMessage
àà  3
=
àà4 5
null
àà6 :
;
àà: ;
try
ââ 
{
ãã 
fBuf
ää 
=
ää 
new
ää 
FHsmsSendBuffer
ää *
(
ää* +
)
ää+ ,
;
ää, -
fBuf
åå 
.
åå 
genLinktestRsp
åå #
(
åå# $
	sessionId
åå$ -
,
åå- .
systemBytes
åå/ :
)
åå: ;
;
åå; <!
fSecsControlMessage
çç #
=
çç$ %
new
çç& )!
FSecsControlMessage
çç* =
(
çç= >
this
èè 
.
èè 
fSecs1ToHsms
èè %
,
èè% &%
FHsmsControlMessageType
éé +
.
éé+ ,
LinktestRsp
éé, 7
,
éé7 8
fBuf
êê 
.
êê 
	sessionId
êê "
,
êê" #
fBuf
ëë 
.
ëë 
byte2
ëë 
,
ëë 
fBuf
ìì 
.
ìì 
byte3
ìì 
,
ìì 
fBuf
íí 
.
íí 
ptype
íí 
,
íí 
fBuf
îî 
.
îî 
stype
îî 
,
îî 
fBuf
ïï 
.
ïï 
systemBytes
ïï $
,
ïï$ %
string
ğğ 
.
ğğ 
Empty
ğğ  
)
ññ 
;
ññ 
m_fTcpClient
óó 
.
óó 
send
óó !
(
óó! "
new
óó" %
FSocketSendData
óó& 5
(
óó5 6
fBuf
óó6 :
.
óó: ;
getBinaryData
óó; H
(
óóH I
)
óóI J
,
óóJ K!
fSecsControlMessage
óóL _
)
óó_ `
)
óó` a
;
óóa b
}
ôô 
catch
õõ 
(
õõ 
	Exception
õõ 
ex
õõ 
)
õõ  
{
öö !
procHsmsErrorRaised
÷÷ #
(
÷÷# $
ex
÷÷$ &
)
÷÷& '
;
÷÷' (
}
øø 
finally
ùù 
{
úú 
fBuf
ûû 
=
ûû 
null
ûû 
;
ûû !
fSecsControlMessage
üü #
=
üü$ %
null
üü& *
;
üü* +
}
ıı 
}
şş 	
private
‚‚ 
void
‚‚ 
sendRejectReq
‚‚ "
(
‚‚" #
UInt16
ƒƒ 
	sessionId
ƒƒ 
,
ƒƒ 
byte
„„ 
stype
„„ 
,
„„ 
byte
…… 

reasonCode
…… 
,
…… 
UInt32
†† 
systemBytes
†† 
)
‡‡ 
{
ˆˆ 	
FHsmsSendBuffer
‰‰ 
fBuf
‰‰  
=
‰‰! "
null
‰‰# '
;
‰‰' (!
FSecsControlMessage
ŠŠ !
fSecsControlMessage
ŠŠ  3
=
ŠŠ4 5
null
ŠŠ6 :
;
ŠŠ: ;
try
ŒŒ 
{
 
fBuf
 
=
 
new
 
FHsmsSendBuffer
 *
(
* +
)
+ ,
;
, -
fBuf
 
.
 
genRejectReq
 !
(
! "
	sessionId
" +
,
+ ,
stype
- 2
,
2 3

reasonCode
4 >
,
> ?
systemBytes
@ K
)
K L
;
L M!
fSecsControlMessage
‘‘ #
=
‘‘$ %
new
‘‘& )!
FSecsControlMessage
‘‘* =
(
‘‘= >
this
’’ 
.
’’ 
fSecs1ToHsms
’’ %
,
’’% &%
FHsmsControlMessageType
““ +
.
““+ ,
	RejectReq
““, 5
,
““5 6
fBuf
”” 
.
”” 
	sessionId
”” "
,
””" #
fBuf
•• 
.
•• 
byte2
•• 
,
•• 
fBuf
–– 
.
–– 
byte3
–– 
,
–– 
fBuf
—— 
.
—— 
ptype
—— 
,
—— 
fBuf
˜˜ 
.
˜˜ 
stype
˜˜ 
,
˜˜ 
fBuf
™™ 
.
™™ 
systemBytes
™™ $
,
™™$ %
string
šš 
.
šš 
Empty
šš  
)
›› 
;
›› 
m_fTcpClient
 
.
 
send
 !
(
! "
new
" %
FSocketSendData
& 5
(
5 6
fBuf
6 :
.
: ;
getBinaryData
; H
(
H I
)
I J
,
J K!
fSecsControlMessage
L _
)
_ `
)
` a
;
a b
}
 
catch
ŸŸ 
(
ŸŸ 
	Exception
ŸŸ 
ex
ŸŸ 
)
ŸŸ  
{
   !
procHsmsErrorRaised
¡¡ #
(
¡¡# $
ex
¡¡$ &
)
¡¡& '
;
¡¡' (
}
¢¢ 
finally
££ 
{
¤¤ 
fBuf
¥¥ 
=
¥¥ 
null
¥¥ 
;
¥¥ !
fSecsControlMessage
¦¦ #
=
¦¦$ %
null
¦¦& *
;
¦¦* +
}
§§ 
}
¨¨ 	
private
¬¬ 
void
¬¬ 
sendSeparateReq
¬¬ $
(
¬¬$ %
)
­­ 
{
®® 	
FHsmsSendBuffer
¯¯ 
fBuf
¯¯  
=
¯¯! "
null
¯¯# '
;
¯¯' (!
FSecsControlMessage
°° !
fSecsControlMessage
°°  3
=
°°4 5
null
°°6 :
;
°°: ;
try
²² 
{
³³ 
fBuf
´´ 
=
´´ 
new
´´ 
FHsmsSendBuffer
´´ *
(
´´* +
)
´´+ ,
;
´´, -
fBuf
µµ 
.
µµ 
genSeparateReq
µµ #
(
µµ# $
this
µµ$ (
.
µµ( )!
fSystemBytesPointer
µµ) <
.
µµ< =
uniqueId
µµ= E
)
µµE F
;
µµF G!
fSecsControlMessage
·· #
=
··$ %
new
··& )!
FSecsControlMessage
··* =
(
··= >
this
¸¸ 
.
¸¸ 
fSecs1ToHsms
¸¸ %
,
¸¸% &%
FHsmsControlMessageType
¹¹ +
.
¹¹+ ,
SeparateReq
¹¹, 7
,
¹¹7 8
fBuf
ºº 
.
ºº 
	sessionId
ºº "
,
ºº" #
fBuf
»» 
.
»» 
byte2
»» 
,
»» 
fBuf
¼¼ 
.
¼¼ 
byte3
¼¼ 
,
¼¼ 
fBuf
½½ 
.
½½ 
ptype
½½ 
,
½½ 
fBuf
¾¾ 
.
¾¾ 
stype
¾¾ 
,
¾¾ 
fBuf
¿¿ 
.
¿¿ 
systemBytes
¿¿ $
,
¿¿$ %
string
ÀÀ 
.
ÀÀ 
Empty
ÀÀ  
)
ÁÁ 
;
ÁÁ 
m_fTcpClient
ÃÃ 
.
ÃÃ 
send
ÃÃ !
(
ÃÃ! "
new
ÃÃ" %
FSocketSendData
ÃÃ& 5
(
ÃÃ5 6
fBuf
ÃÃ6 :
.
ÃÃ: ;
getBinaryData
ÃÃ; H
(
ÃÃH I
)
ÃÃI J
,
ÃÃJ K!
fSecsControlMessage
ÃÃL _
)
ÃÃ_ `
)
ÃÃ` a
;
ÃÃa b
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
	Exception
ÅÅ 
ex
ÅÅ 
)
ÅÅ  
{
ÆÆ !
procHsmsErrorRaised
ÇÇ #
(
ÇÇ# $
ex
ÇÇ$ &
)
ÇÇ& '
;
ÇÇ' (
}
ÈÈ 
finally
ÉÉ 
{
ÊÊ 
fBuf
ËË 
=
ËË 
null
ËË 
;
ËË !
fSecsControlMessage
ÌÌ #
=
ÌÌ$ %
null
ÌÌ& *
;
ÌÌ* +
}
ÍÍ 
}
ÎÎ 	
private
ÒÒ 
void
ÒÒ 
sendDataMessage
ÒÒ $
(
ÒÒ$ %
FSecsDataMessage
ÓÓ 
fSecsDataMessage
ÓÓ -
)
ÔÔ 
{
ÕÕ 	
try
ÖÖ 
{
×× 
m_fTcpClient
ØØ 
.
ØØ 
send
ØØ !
(
ØØ! "
new
ØØ" %
FSocketSendData
ØØ& 5
(
ØØ5 6
fSecsDataMessage
ØØ6 F
.
ØØF G
getHsmsBinaryData
ØØG X
(
ØØX Y
true
ØØY ]
)
ØØ] ^
,
ØØ^ _
fSecsDataMessage
ØØ` p
)
ØØp q
)
ØØq r
;
ØØr s
}
ÙÙ 
catch
ÚÚ 
(
ÚÚ 
	Exception
ÚÚ 
ex
ÚÚ 
)
ÚÚ  
{
ÛÛ !
procHsmsErrorRaised
ÜÜ #
(
ÜÜ# $
ex
ÜÜ$ &
)
ÜÜ& '
;
ÜÜ' (
}
İİ 
finally
ŞŞ 
{
ßß 
}
áá 
}
ââ 	
private
ææ 
void
ææ 
recvSelectReq
ææ "
(
ææ" #
)
çç 
{
èè 	!
FSecsControlMessage
éé !
fSecsControlMessage
éé  3
=
éé4 5
null
éé6 :
;
éé: ;
string
êê 
errorMessage
êê 
=
êê  !
string
êê" (
.
êê( )
Empty
êê) .
;
êê. /
try
ìì 
{
íí 
errorMessage
îî 
=
îî $
getRejectReasonMessage
îî 5
(
îî5 6
$num
îî6 7
)
îî7 8
;
îî8 9!
fSecsControlMessage
òò #
=
òò$ %
new
òò& )!
FSecsControlMessage
òò* =
(
òò= >
this
óó 
.
óó 
fSecs1ToHsms
óó %
,
óó% &%
FHsmsControlMessageType
ôô +
.
ôô+ ,
	SelectRsp
ôô, 5
,
ôô5 6

m_fRecvBuf
õõ 
.
õõ 
	sessionId
õõ (
,
õõ( )

m_fRecvBuf
öö 
.
öö 
byte2
öö $
,
öö$ %

m_fRecvBuf
÷÷ 
.
÷÷ 
byte3
÷÷ $
,
÷÷$ %

m_fRecvBuf
øø 
.
øø 
ptype
øø $
,
øø$ %

m_fRecvBuf
ùù 
.
ùù 
stype
ùù $
,
ùù$ %

m_fRecvBuf
úú 
.
úú 
systemBytes
úú *
,
úú* +
errorMessage
ûû  
)
üü 
;
üü 
this
şş 
.
şş 
fSecs1ToHsms
şş !
.
şş! "
fEventPusher
şş" .
.
şş. /
pushHsmsEvent
şş/ <
(
şş< =
new
ÿÿ 2
$FHsmsControlMessageReceivedEventArgs
ÿÿ <
(
ÿÿ< =
this
ÿÿ= A
.
ÿÿA B
fSecs1ToHsms
ÿÿB N
,
ÿÿN O
FEventId
ÿÿP X
.
ÿÿX Y(
HsmsControlMessageReceived
ÿÿY s
,
ÿÿs t
FResultCodeÿÿu €
.ÿÿ€ 
Warninigÿÿ ‰
,ÿÿ‰ Š
errorMessageÿÿ‹ —
,ÿÿ— ˜#
fSecsControlMessageÿÿ™ ¬
)ÿÿ¬ ­
)
€€ 
;
€€ 
sendRejectReq
„„ 
(
„„ 

m_fRecvBuf
„„ (
.
„„( )
	sessionId
„„) 2
,
„„2 3

m_fRecvBuf
„„4 >
.
„„> ?
stype
„„? D
,
„„D E
$num
„„F G
,
„„G H

m_fRecvBuf
„„I S
.
„„S T
systemBytes
„„T _
)
„„_ `
;
„„` a
}
…… 
catch
†† 
(
†† 
	Exception
†† 
ex
†† 
)
††  
{
‡‡ !
procHsmsErrorRaised
ˆˆ #
(
ˆˆ# $
ex
ˆˆ$ &
)
ˆˆ& '
;
ˆˆ' (
}
‰‰ 
finally
ŠŠ 
{
‹‹ !
fSecsControlMessage
ŒŒ #
=
ŒŒ$ %
null
ŒŒ& *
;
ŒŒ* +
}
 
}
 	
private
’’ 
void
’’ 
recvSelectRsp
’’ "
(
’’" #
)
““ 
{
”” 	!
FSecsControlMessage
•• !
fSecsControlMessage
••  3
=
••4 5
null
••6 :
;
••: ;
FResultCode
–– 
fResult
–– 
=
––  !
FResultCode
––" -
.
––- .
Success
––. 5
;
––5 6
string
—— 
errorMessage
—— 
=
——  !
string
——" (
.
——( )
Empty
——) .
;
——. /
try
™™ 
{
šš 
if
›› 
(
›› 
!
›› 
m_fTranSelectReq
›› %
.
››% &
enabled
››& -
)
››- .
{
œœ 
fResult
 
=
 
FResultCode
 )
.
) *
Warninig
* 2
;
2 3
errorMessage
  
=
! "$
getRejectReasonMessage
# 9
(
9 :
$num
: ;
)
; <
;
< =
sendRejectReq
   !
(
  ! "

m_fRecvBuf
  " ,
.
  , -
	sessionId
  - 6
,
  6 7

m_fRecvBuf
  8 B
.
  B C
stype
  C H
,
  H I
$num
  J K
,
  K L

m_fRecvBuf
  M W
.
  W X
systemBytes
  X c
)
  c d
;
  d e
}
¡¡ 
else
¢¢ 
if
¢¢ 
(
¢¢ 
m_fTranSelectReq
¢¢ )
.
¢¢) *
	sessionId
¢¢* 3
!=
¢¢4 6

m_fRecvBuf
¢¢7 A
.
¢¢A B
	sessionId
¢¢B K
)
¢¢K L
{
££ 
fResult
¤¤ 
=
¤¤ 
FResultCode
¤¤ )
.
¤¤) *
Warninig
¤¤* 2
;
¤¤2 3
errorMessage
¥¥  
=
¥¥! "
string
¥¥# )
.
¥¥) *
Format
¥¥* 0
(
¥¥0 1

FConstants
¥¥1 ;
.
¥¥; <

err_m_0015
¥¥< F
,
¥¥F G
$str
¥¥H f
)
¥¥f g
;
¥¥g h
}
¦¦ 
else
§§ 
if
§§ 
(
§§ 
m_fTranSelectReq
§§ )
.
§§) *
systemBytes
§§* 5
!=
§§6 8

m_fRecvBuf
§§9 C
.
§§C D
systemBytes
§§D O
)
§§O P
{
¨¨ 
fResult
©© 
=
©© 
FResultCode
©© )
.
©©) *
Warninig
©©* 2
;
©©2 3
errorMessage
ªª  
=
ªª! "
string
ªª# )
.
ªª) *
Format
ªª* 0
(
ªª0 1

FConstants
ªª1 ;
.
ªª; <

err_m_0015
ªª< F
,
ªªF G
$str
ªªH h
)
ªªh i
;
ªªi j
}
«« 
else
¬¬ 
if
¬¬ 
(
¬¬ 

m_fRecvBuf
¬¬ #
.
¬¬# $
byte3
¬¬$ )
!=
¬¬* ,
$num
¬¬- .
)
¬¬. /
{
­­ 
fResult
®® 
=
®® 
FResultCode
®® )
.
®®) *
Warninig
®®* 2
;
®®2 3
errorMessage
¯¯  
=
¯¯! "
this
¯¯# '
.
¯¯' ($
getSelectStatusMessage
¯¯( >
(
¯¯> ?

m_fRecvBuf
¯¯? I
.
¯¯I J
byte3
¯¯J O
)
¯¯O P
;
¯¯P Q
}
°° 
else
±± 
{
²² 
m_fTranSelectReq
¶¶ $
.
¶¶$ %
reset
¶¶% *
(
¶¶* +
)
¶¶+ ,
;
¶¶, -
}
·· !
fSecsControlMessage
»» #
=
»»$ %
new
»»& )!
FSecsControlMessage
»»* =
(
»»= >
this
¼¼ 
.
¼¼ 
fSecs1ToHsms
¼¼ %
,
¼¼% &%
FHsmsControlMessageType
½½ +
.
½½+ ,
	SelectRsp
½½, 5
,
½½5 6

m_fRecvBuf
¾¾ 
.
¾¾ 
	sessionId
¾¾ (
,
¾¾( )

m_fRecvBuf
¿¿ 
.
¿¿ 
byte2
¿¿ $
,
¿¿$ %

m_fRecvBuf
ÀÀ 
.
ÀÀ 
byte3
ÀÀ $
,
ÀÀ$ %

m_fRecvBuf
ÁÁ 
.
ÁÁ 
ptype
ÁÁ $
,
ÁÁ$ %

m_fRecvBuf
ÂÂ 
.
ÂÂ 
stype
ÂÂ $
,
ÂÂ$ %

m_fRecvBuf
ÃÃ 
.
ÃÃ 
systemBytes
ÃÃ *
,
ÃÃ* +
errorMessage
ÄÄ  
)
ÅÅ 
;
ÅÅ 
this
ÇÇ 
.
ÇÇ 
fSecs1ToHsms
ÇÇ !
.
ÇÇ! "
fEventPusher
ÇÇ" .
.
ÇÇ. /
pushHsmsEvent
ÇÇ/ <
(
ÇÇ< =
new
ÈÈ 2
$FHsmsControlMessageReceivedEventArgs
ÈÈ <
(
ÈÈ< =
this
ÈÈ= A
.
ÈÈA B
fSecs1ToHsms
ÈÈB N
,
ÈÈN O
FEventId
ÈÈP X
.
ÈÈX Y(
HsmsControlMessageReceived
ÈÈY s
,
ÈÈs t
fResult
ÈÈu |
,
ÈÈ| }
errorMessageÈÈ~ Š
,ÈÈŠ ‹#
fSecsControlMessageÈÈŒ Ÿ
)ÈÈŸ  
)
ÉÉ 
;
ÉÉ 
if
ÍÍ 
(
ÍÍ 
fResult
ÍÍ 
==
ÍÍ 
FResultCode
ÍÍ *
.
ÍÍ* +
Success
ÍÍ+ 2
)
ÍÍ2 3
{
ÎÎ 
this
ÏÏ 
.
ÏÏ 
fSecs1ToHsms
ÏÏ %
.
ÏÏ% &
changeHsmsState
ÏÏ& 5
(
ÏÏ5 6
FConnectMode
ÏÏ6 B
.
ÏÏB C
Active
ÏÏC I
,
ÏÏI J
this
ÏÏK O
.
ÏÏO P
localIp
ÏÏP W
,
ÏÏW X
this
ÏÏY ]
.
ÏÏ] ^
	localPort
ÏÏ^ g
,
ÏÏg h
this
ÏÏi m
.
ÏÏm n
remoteIp
ÏÏn v
,
ÏÏv w
this
ÏÏx |
.
ÏÏ| }

remotePortÏÏ} ‡
,ÏÏ‡ ˆ#
FCommunicationStateÏÏ‰ œ
.ÏÏœ 
SelectedÏÏ ¥
)ÏÏ¥ ¦
;ÏÏ¦ §
if
ÓÓ 
(
ÓÓ 
this
ÓÓ 
.
ÓÓ 
fSecs1ToHsms
ÓÓ )
.
ÓÓ) *
fHsmsConfig
ÓÓ* 5
.
ÓÓ5 6
linkTestPeriod
ÓÓ6 D
>
ÓÓE F
$num
ÓÓG H
)
ÓÓH I
{
ÔÔ 
m_fTmrLinktest
ÕÕ &
.
ÕÕ& '
start
ÕÕ' ,
(
ÕÕ, -
this
ÕÕ- 1
.
ÕÕ1 2
fSecs1ToHsms
ÕÕ2 >
.
ÕÕ> ?
fHsmsConfig
ÕÕ? J
.
ÕÕJ K
linkTestPeriod
ÕÕK Y
*
ÕÕZ [
$num
ÕÕ\ `
)
ÕÕ` a
;
ÕÕa b
}
ÖÖ 
}
×× 
}
ØØ 
catch
ÙÙ 
(
ÙÙ 
	Exception
ÙÙ 
ex
ÙÙ 
)
ÙÙ  
{
ÚÚ !
procHsmsErrorRaised
ÛÛ #
(
ÛÛ# $
ex
ÛÛ$ &
)
ÛÛ& '
;
ÛÛ' (
}
ÜÜ 
finally
İİ 
{
ŞŞ !
fSecsControlMessage
ßß #
=
ßß$ %
null
ßß& *
;
ßß* +
}
àà 
}
áá 	
private
åå 
void
åå 
recvDeselectReq
åå $
(
åå$ %
)
ææ 
{
çç 	!
FSecsControlMessage
èè !
fSecsControlMessage
èè  3
=
èè4 5
null
èè6 :
;
èè: ;
try
êê 
{
ëë !
fSecsControlMessage
ìì #
=
ìì$ %
new
ìì& )!
FSecsControlMessage
ìì* =
(
ìì= >
this
íí 
.
íí 
fSecs1ToHsms
íí %
,
íí% &%
FHsmsControlMessageType
îî +
.
îî+ ,
DeselectReq
îî, 7
,
îî7 8

m_fRecvBuf
ïï 
.
ïï 
	sessionId
ïï (
,
ïï( )

m_fRecvBuf
ğğ 
.
ğğ 
byte2
ğğ $
,
ğğ$ %

m_fRecvBuf
ññ 
.
ññ 
byte3
ññ $
,
ññ$ %

m_fRecvBuf
òò 
.
òò 
ptype
òò $
,
òò$ %

m_fRecvBuf
óó 
.
óó 
stype
óó $
,
óó$ %

m_fRecvBuf
ôô 
.
ôô 
systemBytes
ôô *
,
ôô* +
string
õõ 
.
õõ 
Empty
õõ  
)
öö 
;
öö 
this
øø 
.
øø 
fSecs1ToHsms
øø !
.
øø! "
fEventPusher
øø" .
.
øø. /
pushHsmsEvent
øø/ <
(
øø< =
new
ùù 2
$FHsmsControlMessageReceivedEventArgs
ùù <
(
ùù< =
this
ùù= A
.
ùùA B
fSecs1ToHsms
ùùB N
,
ùùN O
FEventId
ùùP X
.
ùùX Y(
HsmsControlMessageReceived
ùùY s
,
ùùs t
FResultCodeùùu €
.ùù€ 
Successùù ˆ
,ùùˆ ‰
stringùùŠ 
.ùù ‘
Emptyùù‘ –
,ùù– —#
fSecsControlMessageùù˜ «
)ùù« ¬
)
úú 
;
úú 
sendDeselectRsp
şş 
(
şş  

m_fRecvBuf
şş  *
.
şş* +
	sessionId
şş+ 4
,
şş4 5

m_fRecvBuf
şş6 @
.
şş@ A
systemBytes
şşA L
)
şşL M
;
şşM N
m_fTcpClient
…… 
.
…… 
	reconnect
…… &
(
……& '
)
……' (
;
……( )
}
†† 
catch
‡‡ 
(
‡‡ 
	Exception
‡‡ 
ex
‡‡ 
)
‡‡  
{
ˆˆ !
procHsmsErrorRaised
‰‰ #
(
‰‰# $
ex
‰‰$ &
)
‰‰& '
;
‰‰' (
}
ŠŠ 
finally
‹‹ 
{
ŒŒ !
fSecsControlMessage
 #
=
$ %
null
& *
;
* +
}
 
}
 	
private
““ 
void
““ 
recvDeselectRsp
““ $
(
““$ %
)
”” 
{
•• 	!
FSecsControlMessage
–– !
fSecsControlMessage
––  3
=
––4 5
null
––6 :
;
––: ;
string
—— 
errorMessage
—— 
=
——  !
string
——" (
.
——( )
Empty
——) .
;
——. /
try
™™ 
{
šš 
errorMessage
›› 
=
›› $
getRejectReasonMessage
›› 5
(
››5 6
$num
››6 7
)
››7 8
;
››8 9!
fSecsControlMessage
ŸŸ #
=
ŸŸ$ %
new
ŸŸ& )!
FSecsControlMessage
ŸŸ* =
(
ŸŸ= >
this
   
.
   
fSecs1ToHsms
   %
,
  % &%
FHsmsControlMessageType
¡¡ +
.
¡¡+ ,
DeselectRsp
¡¡, 7
,
¡¡7 8

m_fRecvBuf
¢¢ 
.
¢¢ 
	sessionId
¢¢ (
,
¢¢( )

m_fRecvBuf
££ 
.
££ 
byte2
££ $
,
££$ %

m_fRecvBuf
¤¤ 
.
¤¤ 
byte3
¤¤ $
,
¤¤$ %

m_fRecvBuf
¥¥ 
.
¥¥ 
ptype
¥¥ $
,
¥¥$ %

m_fRecvBuf
¦¦ 
.
¦¦ 
stype
¦¦ $
,
¦¦$ %

m_fRecvBuf
§§ 
.
§§ 
systemBytes
§§ *
,
§§* +
errorMessage
¨¨  
)
©© 
;
©© 
this
«« 
.
«« 
fSecs1ToHsms
«« !
.
««! "
fEventPusher
««" .
.
««. /
pushHsmsEvent
««/ <
(
««< =
new
¬¬ 2
$FHsmsControlMessageReceivedEventArgs
¬¬ <
(
¬¬< =
this
¬¬= A
.
¬¬A B
fSecs1ToHsms
¬¬B N
,
¬¬N O
FEventId
¬¬P X
.
¬¬X Y(
HsmsControlMessageReceived
¬¬Y s
,
¬¬s t
FResultCode¬¬u €
.¬¬€ 
Warninig¬¬ ‰
,¬¬‰ Š
errorMessage¬¬‹ —
,¬¬— ˜#
fSecsControlMessage¬¬™ ¬
)¬¬¬ ­
)
­­ 
;
­­ 
sendRejectReq
±± 
(
±± 

m_fRecvBuf
±± (
.
±±( )
	sessionId
±±) 2
,
±±2 3

m_fRecvBuf
±±4 >
.
±±> ?
stype
±±? D
,
±±D E
$num
±±F G
,
±±G H

m_fRecvBuf
±±I S
.
±±S T
systemBytes
±±T _
)
±±_ `
;
±±` a
}
²² 
catch
³³ 
(
³³ 
	Exception
³³ 
ex
³³ 
)
³³  
{
´´ !
procHsmsErrorRaised
µµ #
(
µµ# $
ex
µµ$ &
)
µµ& '
;
µµ' (
}
¶¶ 
finally
·· 
{
¸¸ !
fSecsControlMessage
¹¹ #
=
¹¹$ %
null
¹¹& *
;
¹¹* +
}
ºº 
}
»» 	
private
¿¿ 
void
¿¿ 
recvLinktestReq
¿¿ $
(
¿¿$ %
)
ÀÀ 
{
ÁÁ 	!
FSecsControlMessage
ÂÂ !
fSecsControlMessage
ÂÂ  3
=
ÂÂ4 5
null
ÂÂ6 :
;
ÂÂ: ;
try
ÄÄ 
{
ÅÅ !
fSecsControlMessage
ÆÆ #
=
ÆÆ$ %
new
ÆÆ& )!
FSecsControlMessage
ÆÆ* =
(
ÆÆ= >
this
ÇÇ 
.
ÇÇ 
fSecs1ToHsms
ÇÇ %
,
ÇÇ% &%
FHsmsControlMessageType
ÈÈ +
.
ÈÈ+ ,
LinktestReq
ÈÈ, 7
,
ÈÈ7 8

m_fRecvBuf
ÉÉ 
.
ÉÉ 
	sessionId
ÉÉ (
,
ÉÉ( )

m_fRecvBuf
ÊÊ 
.
ÊÊ 
byte2
ÊÊ $
,
ÊÊ$ %

m_fRecvBuf
ËË 
.
ËË 
byte3
ËË $
,
ËË$ %

m_fRecvBuf
ÌÌ 
.
ÌÌ 
ptype
ÌÌ $
,
ÌÌ$ %

m_fRecvBuf
ÍÍ 
.
ÍÍ 
stype
ÍÍ $
,
ÍÍ$ %

m_fRecvBuf
ÎÎ 
.
ÎÎ 
systemBytes
ÎÎ *
,
ÎÎ* +
string
ÏÏ 
.
ÏÏ 
Empty
ÏÏ  
)
ĞĞ 
;
ĞĞ 
this
ÒÒ 
.
ÒÒ 
fSecs1ToHsms
ÒÒ !
.
ÒÒ! "
fEventPusher
ÒÒ" .
.
ÒÒ. /
pushHsmsEvent
ÒÒ/ <
(
ÒÒ< =
new
ÓÓ 2
$FHsmsControlMessageReceivedEventArgs
ÓÓ <
(
ÓÓ< =
this
ÓÓ= A
.
ÓÓA B
fSecs1ToHsms
ÓÓB N
,
ÓÓN O
FEventId
ÓÓP X
.
ÓÓX Y(
HsmsControlMessageReceived
ÓÓY s
,
ÓÓs t
FResultCodeÓÓu €
.ÓÓ€ 
SuccessÓÓ ˆ
,ÓÓˆ ‰
stringÓÓŠ 
.ÓÓ ‘
EmptyÓÓ‘ –
,ÓÓ– —#
fSecsControlMessageÓÓ˜ «
)ÓÓ« ¬
)
ÔÔ 
;
ÔÔ 
sendLinktestRsp
ØØ 
(
ØØ  

m_fRecvBuf
ØØ  *
.
ØØ* +
	sessionId
ØØ+ 4
,
ØØ4 5

m_fRecvBuf
ØØ6 @
.
ØØ@ A
systemBytes
ØØA L
)
ØØL M
;
ØØM N
}
ÙÙ 
catch
ÚÚ 
(
ÚÚ 
	Exception
ÚÚ 
ex
ÚÚ 
)
ÚÚ  
{
ÛÛ !
procHsmsErrorRaised
ÜÜ #
(
ÜÜ# $
ex
ÜÜ$ &
)
ÜÜ& '
;
ÜÜ' (
}
İİ 
finally
ŞŞ 
{
ßß !
fSecsControlMessage
àà #
=
àà$ %
null
àà& *
;
àà* +
}
áá 
}
ââ 	
private
ææ 
void
ææ 
recvLinktestRsp
ææ $
(
ææ$ %
)
çç 
{
èè 	!
FSecsControlMessage
éé !
fSecsControlMessage
éé  3
=
éé4 5
null
éé6 :
;
éé: ;
FResultCode
êê 
fResult
êê 
=
êê  !
FResultCode
êê" -
.
êê- .
Success
êê. 5
;
êê5 6
string
ëë 
errorMessage
ëë 
=
ëë  !
string
ëë" (
.
ëë( )
Empty
ëë) .
;
ëë. /
try
íí 
{
îî 
if
ïï 
(
ïï 
!
ïï  
m_fTranLinktestReq
ïï '
.
ïï' (
enabled
ïï( /
)
ïï/ 0
{
ğğ 
fResult
ññ 
=
ññ 
FResultCode
ññ )
.
ññ) *
Warninig
ññ* 2
;
ññ2 3
errorMessage
òò  
=
òò! "$
getRejectReasonMessage
òò# 9
(
òò9 :
$num
òò: ;
)
òò; <
;
òò< =
sendRejectReq
ôô !
(
ôô! "

m_fRecvBuf
ôô" ,
.
ôô, -
	sessionId
ôô- 6
,
ôô6 7

m_fRecvBuf
ôô8 B
.
ôôB C
stype
ôôC H
,
ôôH I
$num
ôôJ K
,
ôôK L

m_fRecvBuf
ôôM W
.
ôôW X
systemBytes
ôôX c
)
ôôc d
;
ôôd e
}
õõ 
else
öö 
if
öö 
(
öö  
m_fTranLinktestReq
öö +
.
öö+ ,
	sessionId
öö, 5
!=
öö6 8

m_fRecvBuf
öö9 C
.
ööC D
	sessionId
ööD M
)
ööM N
{
÷÷ 
fResult
øø 
=
øø 
FResultCode
øø )
.
øø) *
Warninig
øø* 2
;
øø2 3
errorMessage
ùù  
=
ùù! "
string
ùù# )
.
ùù) *
Format
ùù* 0
(
ùù0 1

FConstants
ùù1 ;
.
ùù; <

err_m_0015
ùù< F
,
ùùF G
$str
ùùH g
)
ùùg h
;
ùùh i
}
úú 
else
ûû 
if
ûû 
(
ûû  
m_fTranLinktestReq
ûû +
.
ûû+ ,
systemBytes
ûû, 7
!=
ûû8 :

m_fRecvBuf
ûû; E
.
ûûE F
systemBytes
ûûF Q
)
ûûQ R
{
üü 
fResult
ıı 
=
ıı 
FResultCode
ıı )
.
ıı) *
Warninig
ıı* 2
;
ıı2 3
errorMessage
şş  
=
şş! "
string
şş# )
.
şş) *
Format
şş* 0
(
şş0 1

FConstants
şş1 ;
.
şş; <

err_m_0015
şş< F
,
şşF G
$str
şşH j
)
şşj k
;
şşk l
}
ÿÿ 
else
€€ 
if
€€ 
(
€€ 

m_fRecvBuf
€€ #
.
€€# $
byte3
€€$ )
!=
€€* ,
$num
€€- .
)
€€. /
{
 
fResult
‚‚ 
=
‚‚ 
FResultCode
‚‚ )
.
‚‚) *
Warninig
‚‚* 2
;
‚‚2 3
errorMessage
ƒƒ  
=
ƒƒ! "
this
ƒƒ# '
.
ƒƒ' ($
getSelectStatusMessage
ƒƒ( >
(
ƒƒ> ?

m_fRecvBuf
ƒƒ? I
.
ƒƒI J
byte3
ƒƒJ O
)
ƒƒO P
;
ƒƒP Q
}
„„ 
else
…… 
{
††  
m_fTranLinktestReq
ŠŠ &
.
ŠŠ& '
reset
ŠŠ' ,
(
ŠŠ, -
)
ŠŠ- .
;
ŠŠ. /
}
‹‹ !
fSecsControlMessage
 #
=
$ %
new
& )!
FSecsControlMessage
* =
(
= >
this
 
.
 
fSecs1ToHsms
 %
,
% &%
FHsmsControlMessageType
‘‘ +
.
‘‘+ ,
LinktestRsp
‘‘, 7
,
‘‘7 8

m_fRecvBuf
’’ 
.
’’ 
	sessionId
’’ (
,
’’( )

m_fRecvBuf
““ 
.
““ 
byte2
““ $
,
““$ %

m_fRecvBuf
”” 
.
”” 
byte3
”” $
,
””$ %

m_fRecvBuf
•• 
.
•• 
ptype
•• $
,
••$ %

m_fRecvBuf
–– 
.
–– 
stype
–– $
,
––$ %

m_fRecvBuf
—— 
.
—— 
systemBytes
—— *
,
——* +
errorMessage
˜˜  
)
™™ 
;
™™ 
this
›› 
.
›› 
fSecs1ToHsms
›› !
.
››! "
fEventPusher
››" .
.
››. /
pushHsmsEvent
››/ <
(
››< =
new
œœ 2
$FHsmsControlMessageReceivedEventArgs
œœ <
(
œœ< =
this
œœ= A
.
œœA B
fSecs1ToHsms
œœB N
,
œœN O
FEventId
œœP X
.
œœX Y(
HsmsControlMessageReceived
œœY s
,
œœs t
fResult
œœu |
,
œœ| }
errorMessageœœ~ Š
,œœŠ ‹#
fSecsControlMessageœœŒ Ÿ
)œœŸ  
)
 
;
 
}
 
catch
ŸŸ 
(
ŸŸ 
	Exception
ŸŸ 
ex
ŸŸ 
)
ŸŸ  
{
   !
procHsmsErrorRaised
¡¡ #
(
¡¡# $
ex
¡¡$ &
)
¡¡& '
;
¡¡' (
}
¢¢ 
finally
££ 
{
¤¤ !
fSecsControlMessage
¥¥ #
=
¥¥$ %
null
¥¥& *
;
¥¥* +
}
¦¦ 
}
§§ 	
private
«« 
void
«« 
recvRejectReq
«« "
(
««" #
)
¬¬ 
{
­­ 	!
FSecsControlMessage
®® !
fSecsControlMessage
®®  3
=
®®4 5
null
®®6 :
;
®®: ;
string
¯¯ 
errorMessage
¯¯ 
=
¯¯  !
string
¯¯" (
.
¯¯( )
Empty
¯¯) .
;
¯¯. /
try
±± 
{
²² 
errorMessage
³³ 
=
³³ $
getRejectReasonMessage
³³ 5
(
³³5 6

m_fRecvBuf
³³6 @
.
³³@ A
byte3
³³A F
)
³³F G
;
³³G H!
fSecsControlMessage
·· #
=
··$ %
new
··& )!
FSecsControlMessage
··* =
(
··= >
this
¸¸ 
.
¸¸ 
fSecs1ToHsms
¸¸ %
,
¸¸% &%
FHsmsControlMessageType
¹¹ +
.
¹¹+ ,
DeselectRsp
¹¹, 7
,
¹¹7 8

m_fRecvBuf
ºº 
.
ºº 
	sessionId
ºº (
,
ºº( )

m_fRecvBuf
»» 
.
»» 
byte2
»» $
,
»»$ %

m_fRecvBuf
¼¼ 
.
¼¼ 
byte3
¼¼ $
,
¼¼$ %

m_fRecvBuf
½½ 
.
½½ 
ptype
½½ $
,
½½$ %

m_fRecvBuf
¾¾ 
.
¾¾ 
stype
¾¾ $
,
¾¾$ %

m_fRecvBuf
¿¿ 
.
¿¿ 
systemBytes
¿¿ *
,
¿¿* +
errorMessage
ÀÀ  
)
ÁÁ 
;
ÁÁ 
this
ÃÃ 
.
ÃÃ 
fSecs1ToHsms
ÃÃ !
.
ÃÃ! "
fEventPusher
ÃÃ" .
.
ÃÃ. /
pushHsmsEvent
ÃÃ/ <
(
ÃÃ< =
new
ÄÄ 2
$FHsmsControlMessageReceivedEventArgs
ÄÄ <
(
ÄÄ< =
this
ÄÄ= A
.
ÄÄA B
fSecs1ToHsms
ÄÄB N
,
ÄÄN O
FEventId
ÄÄP X
.
ÄÄX Y(
HsmsControlMessageReceived
ÄÄY s
,
ÄÄs t
FResultCodeÄÄu €
.ÄÄ€ 
WarninigÄÄ ‰
,ÄÄ‰ Š
errorMessageÄÄ‹ —
,ÄÄ— ˜#
fSecsControlMessageÄÄ™ ¬
)ÄÄ¬ ­
)
ÅÅ 
;
ÅÅ 
}
ÆÆ 
catch
ÇÇ 
(
ÇÇ 
	Exception
ÇÇ 
ex
ÇÇ 
)
ÇÇ  
{
ÈÈ !
procHsmsErrorRaised
ÉÉ #
(
ÉÉ# $
ex
ÉÉ$ &
)
ÉÉ& '
;
ÉÉ' (
}
ÊÊ 
finally
ËË 
{
ÌÌ !
fSecsControlMessage
ÍÍ #
=
ÍÍ$ %
null
ÍÍ& *
;
ÍÍ* +
}
ÎÎ 
}
ÏÏ 	
private
ÓÓ 
void
ÓÓ 
recvSeparateReq
ÓÓ $
(
ÓÓ$ %
)
ÔÔ 
{
ÕÕ 	!
FSecsControlMessage
ÖÖ !
fSecsControlMessage
ÖÖ  3
=
ÖÖ4 5
null
ÖÖ6 :
;
ÖÖ: ;
try
ØØ 
{
ÙÙ !
fSecsControlMessage
ÚÚ #
=
ÚÚ$ %
new
ÚÚ& )!
FSecsControlMessage
ÚÚ* =
(
ÚÚ= >
this
ÛÛ 
.
ÛÛ 
fSecs1ToHsms
ÛÛ %
,
ÛÛ% &%
FHsmsControlMessageType
ÜÜ +
.
ÜÜ+ ,
SeparateReq
ÜÜ, 7
,
ÜÜ7 8

m_fRecvBuf
İİ 
.
İİ 
	sessionId
İİ (
,
İİ( )

m_fRecvBuf
ŞŞ 
.
ŞŞ 
byte2
ŞŞ $
,
ŞŞ$ %

m_fRecvBuf
ßß 
.
ßß 
byte3
ßß $
,
ßß$ %

m_fRecvBuf
àà 
.
àà 
ptype
àà $
,
àà$ %

m_fRecvBuf
áá 
.
áá 
stype
áá $
,
áá$ %

m_fRecvBuf
ââ 
.
ââ 
systemBytes
ââ *
,
ââ* +
string
ãã 
.
ãã 
Empty
ãã  
)
ää 
;
ää 
this
ææ 
.
ææ 
fSecs1ToHsms
ææ !
.
ææ! "
fEventPusher
ææ" .
.
ææ. /
pushHsmsEvent
ææ/ <
(
ææ< =
new
çç 2
$FHsmsControlMessageReceivedEventArgs
çç <
(
çç< =
this
çç= A
.
ççA B
fSecs1ToHsms
ççB N
,
ççN O
FEventId
ççP X
.
ççX Y(
HsmsControlMessageReceived
ççY s
,
ççs t
FResultCodeççu €
.çç€ 
Successçç ˆ
,ççˆ ‰
stringççŠ 
.çç ‘
Emptyçç‘ –
,çç– —#
fSecsControlMessageçç˜ «
)çç« ¬
)
èè 
;
èè 
m_fTcpClient
ïï 
.
ïï 
	reconnect
ïï &
(
ïï& '
)
ïï' (
;
ïï( )
}
ğğ 
catch
ññ 
(
ññ 
	Exception
ññ 
ex
ññ 
)
ññ  
{
òò !
procHsmsErrorRaised
óó #
(
óó# $
ex
óó$ &
)
óó& '
;
óó' (
}
ôô 
finally
õõ 
{
öö !
fSecsControlMessage
÷÷ #
=
÷÷$ %
null
÷÷& *
;
÷÷* +
}
øø 
}
ùù 	
private
ıı 
void
ıı 
recvDataMessage
ıı $
(
ıı$ %
)
şş 
{
ÿÿ 	
FResultCode
€€ 
fResult
€€ 
=
€€  !
FResultCode
€€" -
.
€€- .
Success
€€. 5
;
€€5 6
string
 
errorMessage
 
=
  !
string
" (
.
( )
Empty
) .
;
. /
FSecsDataMessage
‚‚ 
fSecsDataMessage
‚‚ -
=
‚‚. /
null
‚‚0 4
;
‚‚4 5
try
„„ 
{
…… 
if
†† 
(
†† 
this
†† 
.
†† 
fSecs1ToHsms
†† %
.
††% &

fHsmsState
††& 0
!=
††1 3!
FCommunicationState
††4 G
.
††G H
Selected
††H P
)
††P Q
{
‡‡ 
fResult
ˆˆ 
=
ˆˆ 
FResultCode
ˆˆ )
.
ˆˆ) *
Warninig
ˆˆ* 2
;
ˆˆ2 3
errorMessage
‰‰  
=
‰‰! "$
getRejectReasonMessage
‰‰# 9
(
‰‰9 :
$num
‰‰: ;
)
‰‰; <
;
‰‰< =
sendRejectReq
‹‹ !
(
‹‹! "

m_fRecvBuf
‹‹" ,
.
‹‹, -
	sessionId
‹‹- 6
,
‹‹6 7

m_fRecvBuf
‹‹8 B
.
‹‹B C
stype
‹‹C H
,
‹‹H I
$num
‹‹J K
,
‹‹K L

m_fRecvBuf
‹‹M W
.
‹‹W X
systemBytes
‹‹X c
)
‹‹c d
;
‹‹d e
}
ŒŒ 
fSecsDataMessage
  
=
! "
new
# &
FSecsDataMessage
' 7
(
7 8
this
‘‘ 
.
‘‘ 
fSecs1ToHsms
‘‘ %
,
‘‘% &

m_fRecvBuf
’’ 
.
’’ 
	sessionId
’’ (
,
’’( )

m_fRecvBuf
““ 
.
““ 
wbit
““ #
,
““# $

m_fRecvBuf
”” 
.
”” 
stream
”” %
,
””% &

m_fRecvBuf
•• 
.
•• 
function
•• '
,
••' (

m_fRecvBuf
–– 
.
–– 
systemBytes
–– *
,
––* +

m_fRecvBuf
—— 
.
—— 
body
—— #
.
——# $
ToArray
——$ +
(
——+ ,
)
——, -
)
˜˜ 
;
˜˜ 
this
šš 
.
šš 
fSecs1ToHsms
šš !
.
šš! "
fEventPusher
šš" .
.
šš. /
pushHsmsEvent
šš/ <
(
šš< =
new
›› /
!FHsmsDataMessageReceivedEventArgs
›› 9
(
››9 :
this
››: >
.
››> ?
fSecs1ToHsms
››? K
,
››K L
FEventId
››M U
.
››U V%
HsmsDataMessageReceived
››V m
,
››m n
fResult
››o v
,
››v w
errorMessage››x „
,››„ … 
fSecsDataMessage››† –
)››– —
)
œœ 
;
œœ 
if
   
(
   
fResult
   
==
   
FResultCode
   *
.
  * +
Success
  + 2
)
  2 3
{
¡¡ 
if
¢¢ 
(
¢¢ 
this
¢¢ 
.
¢¢ 
fSecs1ToHsms
¢¢ )
.
¢¢) *+
isHsmsInterceptingDataMessage
¢¢* G
(
¢¢G H
fSecsDataMessage
¢¢H X
.
¢¢X Y
stream
¢¢Y _
,
¢¢_ `
fSecsDataMessage
¢¢a q
.
¢¢q r
function
¢¢r z
)
¢¢z {
)
¢¢{ |
{
££ 
this
¤¤ 
.
¤¤ 
fSecs1ToHsms
¤¤ )
.
¤¤) *
fEventPusher
¤¤* 6
.
¤¤6 7
pushHsmsEvent
¤¤7 D
(
¤¤D E
new
¥¥ ;
-FHsmsInterceptingDataMessageReceivedEventArgs
¥¥  M
(
¥¥M N
this
¦¦  $
.
¦¦$ %
fSecs1ToHsms
¦¦% 1
,
¦¦1 2
FEventId
§§  (
.
§§( )1
#HsmsInterceptingDataMessageReceived
§§) L
,
§§L M
fResult
¨¨  '
,
¨¨' (
errorMessage
©©  ,
,
©©, -
fSecsDataMessage
ªª  0
)
««  !
)
¬¬ 
;
¬¬ 
}
­­ 
}
®® 
}
¯¯ 
catch
°° 
(
°° 
	Exception
°° 
ex
°° 
)
°°  
{
±± !
procHsmsErrorRaised
²² #
(
²²# $
ex
²²$ &
)
²²& '
;
²²' (
}
³³ 
finally
´´ 
{
µµ 
fSecsDataMessage
¶¶  
=
¶¶! "
null
¶¶# '
;
¶¶' (
}
·· 
}
¸¸ 	
private
¼¼ 
void
¼¼ !
procHsmsErrorRaised
¼¼ (
(
¼¼( )
	Exception
½½ 
inEx
½½ 
)
¾¾ 
{
¿¿ 	
try
ÀÀ 
{
ÁÁ 
FDebug
ÂÂ 
.
ÂÂ 
writeLog
ÂÂ 
(
ÂÂ  
inEx
ÂÂ  $
)
ÂÂ$ %
;
ÂÂ% &
this
ÄÄ 
.
ÄÄ 
fSecs1ToHsms
ÄÄ !
.
ÄÄ! "
fEventPusher
ÄÄ" .
.
ÄÄ. /
pushHsmsEvent
ÄÄ/ <
(
ÄÄ< =
new
ÅÅ '
FHsmsErrorRaisedEventArgs
ÅÅ 1
(
ÅÅ1 2
this
ÅÅ2 6
.
ÅÅ6 7
fSecs1ToHsms
ÅÅ7 C
,
ÅÅC D
FEventId
ÅÅE M
.
ÅÅM N
HsmsErrorRaised
ÅÅN ]
,
ÅÅ] ^
inEx
ÅÅ_ c
.
ÅÅc d
Message
ÅÅd k
)
ÅÅk l
)
ÆÆ 
;
ÆÆ 
}
ÇÇ 
catch
ÈÈ 
(
ÈÈ 
	Exception
ÈÈ 
ex
ÈÈ 
)
ÈÈ  
{
ÉÉ 
FDebug
ÊÊ 
.
ÊÊ 
writeLog
ÊÊ 
(
ÊÊ  
ex
ÊÊ  "
)
ÊÊ" #
;
ÊÊ# $
}
ËË 
finally
ÌÌ 
{
ÍÍ 
}
ÏÏ 
}
ĞĞ 	
private
ÔÔ 
void
ÔÔ 
procSelectTimeout
ÔÔ &
(
ÔÔ& '
)
ÕÕ 
{
ÖÖ 	
try
×× 
{
ØØ 
this
ÙÙ 
.
ÙÙ 
fSecs1ToHsms
ÙÙ !
.
ÙÙ! "
fEventPusher
ÙÙ" .
.
ÙÙ. /
pushHsmsEvent
ÙÙ/ <
(
ÙÙ< =
new
ÚÚ )
FHsmsTimeoutRaisedEventArgs
ÚÚ 3
(
ÚÚ3 4
this
ÚÚ4 8
.
ÚÚ8 9
fSecs1ToHsms
ÚÚ9 E
,
ÚÚE F
FEventId
ÚÚG O
.
ÚÚO P
HsmsTimeoutRaised
ÚÚP a
,
ÚÚa b
FSecsTimeout
ÚÚc o
.
ÚÚo p
T6
ÚÚp r
,
ÚÚr s 
getTimeoutMessageÚÚt …
(ÚÚ… †
FSecsTimeoutÚÚ† ’
.ÚÚ’ “
T6ÚÚ“ •
)ÚÚ• –
)ÚÚ– —
)
ÛÛ 
;
ÛÛ 
sendSeparateReq
İİ 
(
İİ  
)
İİ  !
;
İİ! "
m_fTcpClient
ää 
.
ää 
	reconnect
ää &
(
ää& '
)
ää' (
;
ää( )
}
åå 
catch
ææ 
(
ææ 
	Exception
ææ 
ex
ææ 
)
ææ  
{
çç 
FDebug
èè 
.
èè 
throwException
èè %
(
èè% &
ex
èè& (
)
èè( )
;
èè) *
}
éé 
finally
êê 
{
ëë 
}
íí 
}
îî 	
private
òò 
void
òò !
procLinktestTimeout
òò (
(
òò( )
)
óó 
{
ôô 	
try
õõ 
{
öö 
this
÷÷ 
.
÷÷ 
fSecs1ToHsms
÷÷ !
.
÷÷! "
fEventPusher
÷÷" .
.
÷÷. /
pushHsmsEvent
÷÷/ <
(
÷÷< =
new
øø )
FHsmsTimeoutRaisedEventArgs
øø 3
(
øø3 4
this
øø4 8
.
øø8 9
fSecs1ToHsms
øø9 E
,
øøE F
FEventId
øøG O
.
øøO P
HsmsTimeoutRaised
øøP a
,
øøa b
FSecsTimeout
øøc o
.
øøo p
T6
øøp r
,
øør s 
getTimeoutMessageøøt …
(øø… †
FSecsTimeoutøø† ’
.øø’ “
T6øø“ •
)øø• –
)øø– —
)
ùù 
;
ùù 
sendSeparateReq
ûû 
(
ûû  
)
ûû  !
;
ûû! "
m_fTcpClient
‚	‚	 
.
‚	‚	 
	reconnect
‚	‚	 &
(
‚	‚	& '
)
‚	‚	' (
;
‚	‚	( )
}
ƒ	ƒ	 
catch
„	„	 
(
„	„	 
	Exception
„	„	 
ex
„	„	 
)
„	„	  
{
…	…	 
FDebug
†	†	 
.
†	†	 
throwException
†	†	 %
(
†	†	% &
ex
†	†	& (
)
†	†	( )
;
†	†	) *
}
‡	‡	 
finally
ˆ	ˆ	 
{
‰	‰	 
}
‹	‹	 
}
Œ	Œ	 	
private
		 
void
		 
procT8Timeout
		 "
(
		" #
)
‘	‘	 
{
’	’	 	
try
“	“	 
{
”	”	 
this
•	•	 
.
•	•	 
fSecs1ToHsms
•	•	 !
.
•	•	! "
fEventPusher
•	•	" .
.
•	•	. /
pushHsmsEvent
•	•	/ <
(
•	•	< =
new
–	–	 )
FHsmsTimeoutRaisedEventArgs
–	–	 3
(
–	–	3 4
this
–	–	4 8
.
–	–	8 9
fSecs1ToHsms
–	–	9 E
,
–	–	E F
FEventId
–	–	G O
.
–	–	O P
HsmsTimeoutRaised
–	–	P a
,
–	–	a b
FSecsTimeout
–	–	c o
.
–	–	o p
T8
–	–	p r
,
–	–	r s 
getTimeoutMessage–	–	t …
(–	–	… †
FSecsTimeout–	–	† ’
.–	–	’ “
T8–	–	“ •
)–	–	• –
)–	–	– —
)
—	—	 
;
—	—	 
sendSeparateReq
™	™	 
(
™	™	  
)
™	™	  !
;
™	™	! "
m_fTcpClient
 	 	 
.
 	 	 
	reconnect
 	 	 &
(
 	 	& '
)
 	 	' (
;
 	 	( )
}
¡	¡	 
catch
¢	¢	 
(
¢	¢	 
	Exception
¢	¢	 
ex
¢	¢	 
)
¢	¢	  
{
£	£	 
FDebug
¤	¤	 
.
¤	¤	 
throwException
¤	¤	 %
(
¤	¤	% &
ex
¤	¤	& (
)
¤	¤	( )
;
¤	¤	) *
}
¥	¥	 
finally
¦	¦	 
{
§	§	 
}
©	©	 
}
ª	ª	 	
private
²	²	 
void
²	²	 (
m_fThdMain_ThreadJobCalled
²	²	 /
(
²	²	/ 0
object
³	³	 
sender
³	³	 
,
³	³	 
FThreadEventArgs
´	´	 
e
´	´	 
)
µ	µ	 
{
¶	¶	 	
bool
·	·	 
waited
·	·	 
=
·	·	 
false
·	·	 
;
·	·	  
try
¹	¹	 
{
º	º	 
waited
»	»	 
=
»	»	 
m_fMainSync
»	»	 $
.
»	»	$ %
tryWait
»	»	% ,
(
»	»	, -
$num
»	»	- .
)
»	»	. /
;
»	»	/ 0
if
¼	¼	 
(
¼	¼	 
!
¼	¼	 
waited
¼	¼	 
)
¼	¼	 
{
½	½	 
return
¾	¾	 
;
¾	¾	 
}
¿	¿	 
if
Ã	Ã	 
(
Ã	Ã	 
m_fTcpClient
Ã	Ã	  
==
Ã	Ã	! #
null
Ã	Ã	$ (
||
Ã	Ã	) +
m_fTcpClient
Ã	Ã	, 8
.
Ã	Ã	8 9
fState
Ã	Ã	9 ?
!=
Ã	Ã	@ B
FTcpClientState
Ã	Ã	C R
.
Ã	Ã	R S
	Connected
Ã	Ã	S \
)
Ã	Ã	\ ]
{
Ä	Ä	 
e
Å	Å	 
.
Å	Å	 
sleepThread
Å	Å	 !
(
Å	Å	! "
$num
Å	Å	" #
)
Å	Å	# $
;
Å	Å	$ %
return
Æ	Æ	 
;
Æ	Æ	 
}
Ç	Ç	 
if
É	É	 
(
É	É	 
this
É	É	 
.
É	É	 
fSecs1ToHsms
É	É	 %
.
É	É	% &

fHsmsState
É	É	& 0
!=
É	É	1 3!
FCommunicationState
É	É	4 G
.
É	É	G H
	Connected
É	É	H Q
&&
É	É	R T
this
É	É	U Y
.
É	É	Y Z
fSecs1ToHsms
É	É	Z f
.
É	É	f g

fHsmsState
É	É	g q
!=
É	É	r t"
FCommunicationStateÉ	É	u ˆ
.É	É	ˆ ‰
SelectedÉ	É	‰ ‘
)É	É	‘ ’
{
Ê	Ê	 
e
Ë	Ë	 
.
Ë	Ë	 
sleepThread
Ë	Ë	 !
(
Ë	Ë	! "
$num
Ë	Ë	" #
)
Ë	Ë	# $
;
Ë	Ë	$ %
return
Ì	Ì	 
;
Ì	Ì	 
}
Í	Í	 
if
Ô	Ô	 
(
Ô	Ô	 
m_fTranSelectReq
Ô	Ô	 $
.
Ô	Ô	$ %
timeout
Ô	Ô	% ,
(
Ô	Ô	, -
)
Ô	Ô	- .
)
Ô	Ô	. /
{
Õ	Õ	 
procSelectTimeout
Ö	Ö	 %
(
Ö	Ö	% &
)
Ö	Ö	& '
;
Ö	Ö	' (
return
×	×	 
;
×	×	 
}
Ø	Ø	 
if
ß	ß	 
(
ß	ß	  
m_fTranLinktestReq
ß	ß	 &
.
ß	ß	& '
timeout
ß	ß	' .
(
ß	ß	. /
)
ß	ß	/ 0
)
ß	ß	0 1
{
à	à	 !
procLinktestTimeout
á	á	 '
(
á	á	' (
)
á	á	( )
;
á	á	) *
return
â	â	 
;
â	â	 
}
ã	ã	 
if
ê	ê	 
(
ê	ê	 
m_fTmrT8
ê	ê	 
.
ê	ê	 
elasped
ê	ê	 $
(
ê	ê	$ %
false
ê	ê	% *
)
ê	ê	* +
)
ê	ê	+ ,
{
ë	ë	 
procT8Timeout
ì	ì	 !
(
ì	ì	! "
)
ì	ì	" #
;
ì	ì	# $
return
í	í	 
;
í	í	 
}
î	î	 
if
õ	õ	 
(
õ	õ	 
m_fTmrLinktest
õ	õ	 "
.
õ	õ	" #
elasped
õ	õ	# *
(
õ	õ	* +
true
õ	õ	+ /
)
õ	õ	/ 0
)
õ	õ	0 1
{
ö	ö	 
if
÷	÷	 
(
÷	÷	 
!
÷	÷	  
m_fTranLinktestReq
÷	÷	 +
.
÷	÷	+ ,
enabled
÷	÷	, 3
)
÷	÷	3 4
{
ø	ø	 
sendLinktestReq
ù	ù	 '
(
ù	ù	' (
)
ù	ù	( )
;
ù	ù	) *
}
ú	ú	 
}
û	û	 
e
ÿ	ÿ	 
.
ÿ	ÿ	 
sleepThread
ÿ	ÿ	 
(
ÿ	ÿ	 
$num
ÿ	ÿ	 
)
ÿ	ÿ	  
;
ÿ	ÿ	  !
}
€
€
 
catch


 
(


 
	Exception


 
ex


 
)


  
{
‚
‚
 !
procHsmsErrorRaised
ƒ
ƒ
 #
(
ƒ
ƒ
# $
ex
ƒ
ƒ
$ &
)
ƒ
ƒ
& '
;
ƒ
ƒ
' (
}
„
„
 
finally
…
…
 
{
†
†
 
if
‡
‡
 
(
‡
‡
 
waited
‡
‡
 
)
‡
‡
 
{
ˆ
ˆ
 
m_fMainSync
‰
‰
 
.
‰
‰
  
set
‰
‰
  #
(
‰
‰
# $
)
‰
‰
$ %
;
‰
‰
% &
}
Š
Š
 
}
‹
‹
 
}
Œ
Œ
 	
private
”
”
 
void
”
”
 0
"m_fTcpClient_TcpClientStateChanged
”
”
 7
(
”
”
7 8
object
•
•
 
sender
•
•
 
,
•
•
 -
FTcpClientStateChangedEventArgs
–
–
 +
e
–
–
, -
)
—
—
 
{
˜
˜
 	
try
™
™
 
{
š
š
 
m_fMainSync
›
›
 
.
›
›
 
wait
›
›
  
(
›
›
  !
)
›
›
! "
;
›
›
" #
this
Ÿ
Ÿ
 
.
Ÿ
Ÿ
 
localIp
Ÿ
Ÿ
 
=
Ÿ
Ÿ
 
e
Ÿ
Ÿ
  
.
Ÿ
Ÿ
  !
localIp
Ÿ
Ÿ
! (
;
Ÿ
Ÿ
( )
this
 
 
 
.
 
 
 
	localPort
 
 
 
=
 
 
  
e
 
 
! "
.
 
 
" #
	localPort
 
 
# ,
;
 
 
, -
this
¡
¡
 
.
¡
¡
 
remoteIp
¡
¡
 
=
¡
¡
 
e
¡
¡
  !
.
¡
¡
! "
remoteIp
¡
¡
" *
;
¡
¡
* +
this
¢
¢
 
.
¢
¢
 

remotePort
¢
¢
 
=
¢
¢
  !
e
¢
¢
" #
.
¢
¢
# $

remotePort
¢
¢
$ .
;
¢
¢
. /
if
¦
¦
 
(
¦
¦
 
e
¦
¦
 
.
¦
¦
 
fState
¦
¦
 
==
¦
¦
 
FTcpClientState
¦
¦
  /
.
¦
¦
/ 0
Opened
¦
¦
0 6
)
¦
¦
6 7
{
§
§
 
this
¨
¨
 
.
¨
¨
 
fSecs1ToHsms
¨
¨
 %
.
¨
¨
% &
changeHsmsState
¨
¨
& 5
(
¨
¨
5 6
FConnectMode
¨
¨
6 B
.
¨
¨
B C
Active
¨
¨
C I
,
¨
¨
I J
this
¨
¨
K O
.
¨
¨
O P
localIp
¨
¨
P W
,
¨
¨
W X
this
¨
¨
Y ]
.
¨
¨
] ^
	localPort
¨
¨
^ g
,
¨
¨
g h
this
¨
¨
i m
.
¨
¨
m n
remoteIp
¨
¨
n v
,
¨
¨
v w
this
¨
¨
x |
.
¨
¨
| }

remotePort¨
¨
} ‡
,¨
¨
‡ ˆ#
FCommunicationState¨
¨
‰ œ
.¨
¨
œ 
Opened¨
¨
 £
)¨
¨
£ ¤
;¨
¨
¤ ¥
resetResource
ª
ª
 !
(
ª
ª
! "
)
ª
ª
" #
;
ª
ª
# $
}
«
«
 
else
¬
¬
 
if
¬
¬
 
(
¬
¬
 
e
¬
¬
 
.
¬
¬
 
fState
¬
¬
 !
==
¬
¬
" $
FTcpClientState
¬
¬
% 4
.
¬
¬
4 5
	Connected
¬
¬
5 >
)
¬
¬
> ?
{
­
­
 
this
®
®
 
.
®
®
 
fSecs1ToHsms
®
®
 %
.
®
®
% &
changeHsmsState
®
®
& 5
(
®
®
5 6
FConnectMode
®
®
6 B
.
®
®
B C
Active
®
®
C I
,
®
®
I J
this
®
®
K O
.
®
®
O P
localIp
®
®
P W
,
®
®
W X
this
®
®
Y ]
.
®
®
] ^
	localPort
®
®
^ g
,
®
®
g h
this
®
®
i m
.
®
®
m n
remoteIp
®
®
n v
,
®
®
v w
this
®
®
x |
.
®
®
| }

remotePort®
®
} ‡
,®
®
‡ ˆ#
FCommunicationState®
®
‰ œ
.®
®
œ 
	Connected®
®
 ¦
)®
®
¦ §
;®
®
§ ¨
sendSelectReq
°
°
 !
(
°
°
! "
)
°
°
" #
;
°
°
# $
}
±
±
 
else
²
²
 
if
²
²
 
(
²
²
 
e
²
²
 
.
²
²
 
fState
²
²
 !
==
²
²
" $
FTcpClientState
²
²
% 4
.
²
²
4 5
Closed
²
²
5 ;
)
²
²
; <
{
³
³
 
this
´
´
 
.
´
´
 
fSecs1ToHsms
´
´
 %
.
´
´
% &
changeHsmsState
´
´
& 5
(
´
´
5 6
FConnectMode
´
´
6 B
.
´
´
B C
Active
´
´
C I
,
´
´
I J
this
´
´
K O
.
´
´
O P
localIp
´
´
P W
,
´
´
W X
this
´
´
Y ]
.
´
´
] ^
	localPort
´
´
^ g
,
´
´
g h
this
´
´
i m
.
´
´
m n
remoteIp
´
´
n v
,
´
´
v w
this
´
´
x |
.
´
´
| }

remotePort´
´
} ‡
,´
´
‡ ˆ#
FCommunicationState´
´
‰ œ
.´
´
œ 
Closed´
´
 £
)´
´
£ ¤
;´
´
¤ ¥
}
µ
µ
 
}
¶
¶
 
catch
·
·
 
(
·
·
 
	Exception
·
·
 
ex
·
·
 
)
·
·
  
{
¸
¸
 !
procHsmsErrorRaised
¹
¹
 #
(
¹
¹
# $
ex
¹
¹
$ &
)
¹
¹
& '
;
¹
¹
' (
}
º
º
 
finally
»
»
 
{
¼
¼
 
m_fMainSync
½
½
 
.
½
½
 
set
½
½
 
(
½
½
  
)
½
½
  !
;
½
½
! "
}
¾
¾
 
}
¿
¿
 	
private
Ã
Ã
 
void
Ã
Ã
 0
"m_fTcpClient_TcpClientDataReceived
Ã
Ã
 7
(
Ã
Ã
7 8
object
Ä
Ä
 
sender
Ä
Ä
 
,
Ä
Ä
 -
FTcpClientDataReceivedEventArgs
Å
Å
 +
e
Å
Å
, -
)
Æ
Æ
 
{
Ç
Ç
 	
try
È
È
 
{
É
É
 
m_fMainSync
Ê
Ê
 
.
Ê
Ê
 
wait
Ê
Ê
  
(
Ê
Ê
  !
)
Ê
Ê
! "
;
Ê
Ê
" #
m_fTmrT8
Ñ
Ñ
 
.
Ñ
Ñ
 
stop
Ñ
Ñ
 
(
Ñ
Ñ
 
)
Ñ
Ñ
 
;
Ñ
Ñ
  
if
Ø
Ø
 
(
Ø
Ø
 
m_fTmrLinktest
Ø
Ø
 "
.
Ø
Ø
" #
enabled
Ø
Ø
# *
)
Ø
Ø
* +
{
Ù
Ù
 
m_fTmrLinktest
Ú
Ú
 "
.
Ú
Ú
" #
restart
Ú
Ú
# *
(
Ú
Ú
* +
this
Ú
Ú
+ /
.
Ú
Ú
/ 0
fSecs1ToHsms
Ú
Ú
0 <
.
Ú
Ú
< =
fHsmsConfig
Ú
Ú
= H
.
Ú
Ú
H I
linkTestPeriod
Ú
Ú
I W
*
Ú
Ú
X Y
$num
Ú
Ú
Z ^
)
Ú
Ú
^ _
;
Ú
Ú
_ `
}
Û
Û
 

m_fRecvBuf
ß
ß
 
.
ß
ß
 
input
ß
ß
  
(
ß
ß
  !
e
ß
ß
! "
.
ß
ß
" #
data
ß
ß
# '
)
ß
ß
' (
;
ß
ß
( )
while
á
á
 
(
á
á
 

m_fRecvBuf
á
á
 !
.
á
á
! "
parse
á
á
" '
(
á
á
' (
)
á
á
( )
)
á
á
) *
{
â
â
 
if
ã
ã
 
(
ã
ã
 

m_fRecvBuf
ã
ã
 "
.
ã
ã
" #
stype
ã
ã
# (
==
ã
ã
) +
$num
ã
ã
, -
)
ã
ã
- .
{
ä
ä
 
recvDataMessage
å
å
 '
(
å
å
' (
)
å
å
( )
;
å
å
) *
}
æ
æ
 
else
ç
ç
 
if
ç
ç
 
(
ç
ç
 

m_fRecvBuf
ç
ç
 '
.
ç
ç
' (
stype
ç
ç
( -
==
ç
ç
. 0
$num
ç
ç
1 2
)
ç
ç
2 3
{
è
è
 
recvSelectReq
é
é
 %
(
é
é
% &
)
é
é
& '
;
é
é
' (
}
ê
ê
 
else
ë
ë
 
if
ë
ë
 
(
ë
ë
 

m_fRecvBuf
ë
ë
 '
.
ë
ë
' (
stype
ë
ë
( -
==
ë
ë
. 0
$num
ë
ë
1 2
)
ë
ë
2 3
{
ì
ì
 
recvSelectRsp
í
í
 %
(
í
í
% &
)
í
í
& '
;
í
í
' (
}
î
î
 
else
ï
ï
 
if
ï
ï
 
(
ï
ï
 

m_fRecvBuf
ï
ï
 '
.
ï
ï
' (
stype
ï
ï
( -
==
ï
ï
. 0
$num
ï
ï
1 2
)
ï
ï
2 3
{
ğ
ğ
 
recvDeselectReq
ñ
ñ
 '
(
ñ
ñ
' (
)
ñ
ñ
( )
;
ñ
ñ
) *
}
ò
ò
 
else
ó
ó
 
if
ó
ó
 
(
ó
ó
 

m_fRecvBuf
ó
ó
 '
.
ó
ó
' (
stype
ó
ó
( -
==
ó
ó
. 0
$num
ó
ó
1 2
)
ó
ó
2 3
{
ô
ô
 
recvDeselectRsp
õ
õ
 '
(
õ
õ
' (
)
õ
õ
( )
;
õ
õ
) *
}
ö
ö
 
else
÷
÷
 
if
÷
÷
 
(
÷
÷
 

m_fRecvBuf
÷
÷
 '
.
÷
÷
' (
stype
÷
÷
( -
==
÷
÷
. 0
$num
÷
÷
1 2
)
÷
÷
2 3
{
ø
ø
 
recvLinktestReq
ù
ù
 '
(
ù
ù
' (
)
ù
ù
( )
;
ù
ù
) *
}
ú
ú
 
else
û
û
 
if
û
û
 
(
û
û
 

m_fRecvBuf
û
û
 '
.
û
û
' (
stype
û
û
( -
==
û
û
. 0
$num
û
û
1 2
)
û
û
2 3
{
ü
ü
 
recvLinktestRsp
ı
ı
 '
(
ı
ı
' (
)
ı
ı
( )
;
ı
ı
) *
}
ş
ş
 
else
ÿ
ÿ
 
if
ÿ
ÿ
 
(
ÿ
ÿ
 

m_fRecvBuf
ÿ
ÿ
 '
.
ÿ
ÿ
' (
stype
ÿ
ÿ
( -
==
ÿ
ÿ
. 0
$num
ÿ
ÿ
1 2
)
ÿ
ÿ
2 3
{
€€ 
recvRejectReq
 %
(
% &
)
& '
;
' (
}
‚‚ 
else
ƒƒ 
if
ƒƒ 
(
ƒƒ 

m_fRecvBuf
ƒƒ '
.
ƒƒ' (
stype
ƒƒ( -
==
ƒƒ. 0
$num
ƒƒ1 2
)
ƒƒ2 3
{
„„ 
recvSeparateReq
…… '
(
……' (
)
……( )
;
……) *
}
†† 
else
‡‡ 
{
ˆˆ 
sendRejectReq
 %
(
% &

m_fRecvBuf
& 0
.
0 1
	sessionId
1 :
,
: ;

m_fRecvBuf
< F
.
F G
stype
G L
,
L M
$num
N O
,
O P

m_fRecvBuf
Q [
.
[ \
systemBytes
\ g
)
g h
;
h i
}
 

m_fRecvBuf
’’ 
.
’’ 
init
’’ #
(
’’# $
)
’’$ %
;
’’% &
}
““ 
if
šš 
(
šš 
!
šš 

m_fRecvBuf
šš 
.
šš  
isCompleted
šš  +
)
šš+ ,
{
›› 
m_fTmrT8
œœ 
.
œœ 
start
œœ "
(
œœ" #
this
œœ# '
.
œœ' (
fSecs1ToHsms
œœ( 4
.
œœ4 5
fHsmsConfig
œœ5 @
.
œœ@ A
	t8Timeout
œœA J
*
œœK L
$num
œœM Q
)
œœQ R
;
œœR S
}
 
}
 
catch
ŸŸ 
(
ŸŸ 
	Exception
ŸŸ 
ex
ŸŸ 
)
ŸŸ  
{
   !
procHsmsErrorRaised
¡¡ #
(
¡¡# $
ex
¡¡$ &
)
¡¡& '
;
¡¡' (
}
¢¢ 
finally
££ 
{
¤¤ 
m_fMainSync
¥¥ 
.
¥¥ 
set
¥¥ 
(
¥¥  
)
¥¥  !
;
¥¥! "
}
¦¦ 
}
§§ 	
private
«« 
void
«« ,
m_fTcpClient_TcpClientDataSent
«« 3
(
««3 4
object
¬¬ 
sender
¬¬ 
,
¬¬ )
FTcpClientDataSentEventArgs
­­ '
e
­­( )
)
®® 
{
¯¯ 	!
FSecsControlMessage
°° !
fSecsControlMessage
°°  3
=
°°4 5
null
°°6 :
;
°°: ;
FSecsDataMessage
±± 
fSecsDataMessage
±± -
=
±±. /
null
±±0 4
;
±±4 5
try
³³ 
{
´´ 
m_fMainSync
µµ 
.
µµ 
wait
µµ  
(
µµ  !
)
µµ! "
;
µµ" #
if
¹¹ 
(
¹¹ 
e
¹¹ 
.
¹¹ 
fData
¹¹ 
.
¹¹ 
state
¹¹ !
is
¹¹" $!
FSecsControlMessage
¹¹% 8
)
¹¹8 9
{
ºº !
fSecsControlMessage
»» '
=
»»( )
(
»»* +!
FSecsControlMessage
»»+ >
)
»»> ?
e
»»? @
.
»»@ A
fData
»»A F
.
»»F G
state
»»G L
;
»»L M
this
¼¼ 
.
¼¼ 
fSecs1ToHsms
¼¼ %
.
¼¼% &
fEventPusher
¼¼& 2
.
¼¼2 3
pushHsmsEvent
¼¼3 @
(
¼¼@ A
new
½½ .
 FHsmsControlMessageSentEventArgs
½½ <
(
½½< =
this
½½= A
.
½½A B
fSecs1ToHsms
½½B N
,
½½N O
FEventId
½½P X
.
½½X Y$
HsmsControlMessageSent
½½Y o
,
½½o p
FResultCode
½½q |
.
½½| }
Success½½} „
,½½„ …
string½½† Œ
.½½Œ 
Empty½½ ’
,½½’ “#
fSecsControlMessage½½” §
)½½§ ¨
)
¾¾ 
;
¾¾ 
}
¿¿ 
else
ÀÀ 
if
ÀÀ 
(
ÀÀ 
e
ÀÀ 
.
ÀÀ 
fData
ÀÀ  
.
ÀÀ  !
state
ÀÀ! &
is
ÀÀ' )
FSecsDataMessage
ÀÀ* :
)
ÀÀ: ;
{
ÁÁ 
fSecsDataMessage
ÂÂ $
=
ÂÂ% &
(
ÂÂ' (
FSecsDataMessage
ÂÂ( 8
)
ÂÂ8 9
e
ÂÂ9 :
.
ÂÂ: ;
fData
ÂÂ; @
.
ÂÂ@ A
state
ÂÂA F
;
ÂÂF G
this
ÃÃ 
.
ÃÃ 
fSecs1ToHsms
ÃÃ %
.
ÃÃ% &
fEventPusher
ÃÃ& 2
.
ÃÃ2 3
pushHsmsEvent
ÃÃ3 @
(
ÃÃ@ A
new
ÄÄ +
FHsmsDataMessageSentEventArgs
ÄÄ 9
(
ÄÄ9 :
this
ÄÄ: >
.
ÄÄ> ?
fSecs1ToHsms
ÄÄ? K
,
ÄÄK L
FEventId
ÄÄM U
.
ÄÄU V!
HsmsDataMessageSent
ÄÄV i
,
ÄÄi j
FResultCode
ÄÄk v
.
ÄÄv w
Success
ÄÄw ~
,
ÄÄ~ 
stringÄÄ€ †
.ÄÄ† ‡
EmptyÄÄ‡ Œ
,ÄÄŒ  
fSecsDataMessageÄÄ 
)ÄÄ Ÿ
)
ÅÅ 
;
ÅÅ 
}
ÆÆ 
}
ÇÇ 
catch
ÈÈ 
(
ÈÈ 
	Exception
ÈÈ 
ex
ÈÈ 
)
ÈÈ  
{
ÉÉ !
procHsmsErrorRaised
ÊÊ #
(
ÊÊ# $
ex
ÊÊ$ &
)
ÊÊ& '
;
ÊÊ' (
}
ËË 
finally
ÌÌ 
{
ÍÍ !
fSecsControlMessage
ÎÎ #
=
ÎÎ$ %
null
ÎÎ& *
;
ÎÎ* +
fSecsDataMessage
ÏÏ  
=
ÏÏ! "
null
ÏÏ# '
;
ÏÏ' (
m_fMainSync
ÑÑ 
.
ÑÑ 
set
ÑÑ 
(
ÑÑ  
)
ÑÑ  !
;
ÑÑ! "
}
ÒÒ 
}
ÓÓ 	
private
×× 
void
×× 2
$m_fTcpClient_TcpClientDataSendFailed
×× 9
(
××9 :
object
ØØ 
sender
ØØ 
,
ØØ /
!FTcpClientDataSendFailedEventArgs
ÙÙ -
e
ÙÙ. /
)
ÚÚ 
{
ÛÛ 	!
FSecsControlMessage
ÜÜ !
fSecsControlMessage
ÜÜ  3
=
ÜÜ4 5
null
ÜÜ6 :
;
ÜÜ: ;
FSecsDataMessage
İİ 
fSecsDataMessage
İİ -
=
İİ. /
null
İİ0 4
;
İİ4 5
try
ßß 
{
àà 
m_fMainSync
áá 
.
áá 
wait
áá  
(
áá  !
)
áá! "
;
áá" #
if
åå 
(
åå 
e
åå 
.
åå 
fData
åå 
.
åå 
state
åå !
is
åå" $!
FSecsControlMessage
åå% 8
)
åå8 9
{
ææ !
fSecsControlMessage
çç '
=
çç( )
(
çç* +!
FSecsControlMessage
çç+ >
)
çç> ?
e
çç? @
.
çç@ A
fData
ççA F
.
ççF G
state
ççG L
;
ççL M
this
èè 
.
èè 
fSecs1ToHsms
èè %
.
èè% &
fEventPusher
èè& 2
.
èè2 3
pushHsmsEvent
èè3 @
(
èè@ A
new
éé .
 FHsmsControlMessageSentEventArgs
éé <
(
éé< =
this
éé= A
.
ééA B
fSecs1ToHsms
ééB N
,
ééN O
FEventId
ééP X
.
ééX Y$
HsmsControlMessageSent
ééY o
,
ééo p
FResultCode
ééq |
.
éé| }
Erroréé} ‚
,éé‚ ƒ
eéé„ …
.éé… †
messageéé† 
,éé #
fSecsControlMessageéé ¢
)éé¢ £
)
êê 
;
êê 
}
ëë 
else
ìì 
if
ìì 
(
ìì 
e
ìì 
.
ìì 
fData
ìì  
.
ìì  !
state
ìì! &
is
ìì' )
FSecsDataMessage
ìì* :
)
ìì: ;
{
íí 
fSecsDataMessage
îî $
=
îî% &
(
îî' (
FSecsDataMessage
îî( 8
)
îî8 9
e
îî9 :
.
îî: ;
fData
îî; @
.
îî@ A
state
îîA F
;
îîF G
this
ïï 
.
ïï 
fSecs1ToHsms
ïï %
.
ïï% &
fEventPusher
ïï& 2
.
ïï2 3
pushHsmsEvent
ïï3 @
(
ïï@ A
new
ğğ +
FHsmsDataMessageSentEventArgs
ğğ 9
(
ğğ9 :
this
ğğ: >
.
ğğ> ?
fSecs1ToHsms
ğğ? K
,
ğğK L
FEventId
ğğM U
.
ğğU V!
HsmsDataMessageSent
ğğV i
,
ğği j
FResultCode
ğğk v
.
ğğv w
Error
ğğw |
,
ğğ| }
e
ğğ~ 
.ğğ €
messageğğ€ ‡
,ğğ‡ ˆ 
fSecsDataMessageğğ‰ ™
)ğğ™ š
)
ññ 
;
ññ 
}
òò 
}
óó 
catch
ôô 
(
ôô 
	Exception
ôô 
ex
ôô 
)
ôô  
{
õõ !
procHsmsErrorRaised
öö #
(
öö# $
ex
öö$ &
)
öö& '
;
öö' (
}
÷÷ 
finally
øø 
{
ùù !
fSecsControlMessage
úú #
=
úú$ %
null
úú& *
;
úú* +
fSecsDataMessage
ûû  
=
ûû! "
null
ûû# '
;
ûû' (
m_fMainSync
üü 
.
üü 
set
üü 
(
üü  
)
üü  !
;
üü! "
}
ıı 
}
şş 	
private
‚‚ 
void
‚‚ /
!m_fTcpClient_TcpClientErrorRaised
‚‚ 6
(
‚‚6 7
object
ƒƒ 
sender
ƒƒ 
,
ƒƒ ,
FTcpClientErrorRaisedEventArgs
„„ *
e
„„+ ,
)
…… 
{
†† 	
try
‡‡ 
{
ˆˆ !
procHsmsErrorRaised
‰‰ #
(
‰‰# $
e
‰‰$ %
.
‰‰% &
	exception
‰‰& /
)
‰‰/ 0
;
‰‰0 1
}
ŠŠ 
catch
‹‹ 
(
‹‹ 
	Exception
‹‹ 
ex
‹‹ 
)
‹‹  
{
ŒŒ !
procHsmsErrorRaised
 #
(
# $
ex
$ &
)
& '
;
' (
}
 
finally
 
{
 
}
’’ 
}
““ 	
}
™™ 
}šš ãˆ
uD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Protocol\SECS1\c_FSECS1.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
internal 
class 
FSECS1 
: 
IDisposable &
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FSecs1ToHsms 
m_fSecs1ToHsms +
=, -
null. 2
;2 3
private 
FSecs1RecvState 
m_fRecvState  ,
=- .
FSecs1RecvState/ >
.> ?
	Completed? H
;H I
private 
FSecs1SendState 
m_fSendState  ,
=- .
FSecs1SendState/ >
.> ?
	Completed? H
;H I
private   
FSecs1RecvBuffer    

m_fRecvBuf  ! +
=  , -
null  . 2
;  2 3
private!! 
FSecs1RecvBlock!! 
m_fRecvBlock!!  ,
=!!- .
null!!/ 3
;!!3 4
private"" 
FSecs1RecvBlockList"" #
m_fRecvBlockList""$ 4
=""5 6
null""7 ;
;""; <
private## 
FSecs1SendBlock## 
m_fSendBlock##  ,
=##- .
null##/ 3
;##3 4
private$$ 
FQueue$$ 
<$$ 
FSecs1SendBlockList$$ *
>$$* +!
m_fSendBlockListQueue$$, A
=$$B C
null$$D H
;$$H I
private%% 
FSerial%% 
	m_fSerial%% !
=%%" #
null%%$ (
;%%( )
private&& 
	FCodeLock&& 
m_fMainSync&& %
=&&& '
null&&( ,
;&&, -
private'' 
FThread'' 

m_fThdMain'' "
=''# $
null''% )
;'') *
private(( 
FStaticTimer(( 
m_fTmrT1(( %
=((& '
null((( ,
;((, -
private)) 
FStaticTimer)) 
m_fTmrT2)) %
=))& '
null))( ,
;)), -
private** 
FStaticTimer** 
m_fTmrT4Runner** +
=**, -
null**. 2
;**2 3
public00 
FSECS100 
(00 
FSecs1ToHsms11 
fSecs1ToHsms11 %
)22 
{33 	
m_fSecs1ToHsms44 
=44 
fSecs1ToHsms44 )
;44) *
init66 
(66 
)66 
;66 
}77 	
~;; 	
FSECS1;;	 
(;; 
)<< 
{== 	
	myDispose>> 
(>> 
false>> 
)>> 
;>> 
}?? 	
	protectedCC 
voidCC 
	myDisposeCC  
(CC  !
boolDD 
	disposingDD 
)EE 
{FF 	
ifGG 
(GG 
!GG 

m_disposedGG 
)GG 
{HH 
ifII 
(II 
	disposingII 
)II 
{JJ 
termKK 
(KK 
)KK 
;KK 
m_fSecs1ToHsmsMM "
=MM# $
nullMM% )
;MM) *
}NN 

m_disposedPP 
=PP 
truePP !
;PP! "
}QQ 
}RR 	
publicZZ 
voidZZ 
DisposeZZ 
(ZZ 
)[[ 
{\\ 	
	myDispose]] 
(]] 
true]] 
)]] 
;]] 
GC^^ 
.^^ 
SuppressFinalize^^ 
(^^  
this^^  $
)^^$ %
;^^% &
}__ 	
privatemm 
voidmm 
initmm 
(mm 
)nn 
{oo 	
trypp 
{qq 

m_fRecvBufrr 
=rr 
newrr  
FSecs1RecvBufferrr! 1
(rr1 2
)rr2 3
;rr3 4
m_fRecvBlockListss  
=ss! "
newss# &
FSecs1RecvBlockListss' :
(ss: ;
m_fSecs1ToHsmsss; I
)ssI J
;ssJ K!
m_fSendBlockListQueuett %
=tt& '
newtt( +
FQueuett, 2
<tt2 3
FSecs1SendBlockListtt3 F
>ttF G
(ttG H
)ttH I
;ttI J
m_fTmrT1xx 
=xx 
newxx 
FStaticTimerxx +
(xx+ ,
)xx, -
;xx- .
m_fTmrT2yy 
=yy 
newyy 
FStaticTimeryy +
(yy+ ,
)yy, -
;yy- .
m_fTmrT4Runnerzz 
=zz  
newzz! $
FStaticTimerzz% 1
(zz1 2
)zz2 3
;zz3 4
m_fTmrT4Runner{{ 
.{{ 
start{{ $
({{$ %
$num{{% )
){{) *
;{{* +
m_fMainSync 
= 
new !
	FCodeLock" +
(+ ,
), -
;- .

m_fThdMain
€€ 
=
€€ 
new
€€  
FThread
€€! (
(
€€( )
$str
€€) :
)
€€: ;
;
€€; <

m_fThdMain
 
.
 
ThreadJobCalled
 *
+=
+ -
new
. 1*
FThreadJobCalledEventHandler
2 N
(
N O(
m_fThdMain_ThreadJobCalled
O i
)
i j
;
j k

m_fThdMain
‚‚ 
.
‚‚ 
start
‚‚  
(
‚‚  !
)
‚‚! "
;
‚‚" #
}
ƒƒ 
catch
„„ 
(
„„ 
	Exception
„„ 
ex
„„ 
)
„„  
{
…… 
FDebug
†† 
.
†† 
throwException
†† %
(
††% &
ex
††& (
)
††( )
;
††) *
}
‡‡ 
finally
ˆˆ 
{
‰‰ 
}
‹‹ 
}
ŒŒ 	
private
 
void
 
term
 
(
 
)
‘‘ 
{
’’ 	
try
““ 
{
”” 
if
•• 
(
•• 

m_fThdMain
•• 
!=
•• !
null
••" &
)
••& '
{
–– 

m_fThdMain
—— 
.
—— 
stop
—— #
(
——# $
)
——$ %
;
——% &

m_fThdMain
˜˜ 
.
˜˜ 
Dispose
˜˜ &
(
˜˜& '
)
˜˜' (
;
˜˜( )

m_fThdMain
™™ 
.
™™ 
ThreadJobCalled
™™ .
-=
™™/ 1
new
™™2 5*
FThreadJobCalledEventHandler
™™6 R
(
™™R S(
m_fThdMain_ThreadJobCalled
™™S m
)
™™m n
;
™™n o

m_fThdMain
šš 
=
šš  
null
šš! %
;
šš% &
}
›› 
if
 
(
 
	m_fSerial
 
!=
  
null
! %
)
% &
{
 
	m_fSerial
ŸŸ 
.
ŸŸ 
close
ŸŸ #
(
ŸŸ# $
)
ŸŸ$ %
;
ŸŸ% &
	m_fSerial
   
.
   
Dispose
   %
(
  % &
)
  & '
;
  ' (
	m_fSerial
¢¢ 
.
¢¢  
SerialStateChanged
¢¢ 0
-=
¢¢1 3
new
¢¢4 7-
FSerialStateChangedEventHandler
¢¢8 W
(
¢¢W X*
m_fSerial_SerialStateChanged
¢¢X t
)
¢¢t u
;
¢¢u v
	m_fSerial
££ 
.
££  
SerialDataReceived
££ 0
-=
££1 3
new
££4 7-
FSerialDataReceivedEventHandler
££8 W
(
££W X*
m_fSerial_SerialDataReceived
££X t
)
££t u
;
££u v
	m_fSerial
¤¤ 
.
¤¤ 
SerialDataSent
¤¤ ,
-=
¤¤- /
new
¤¤0 3)
FSerialDataSentEventHandler
¤¤4 O
(
¤¤O P&
m_fSerial_SerialDataSent
¤¤P h
)
¤¤h i
;
¤¤i j
	m_fSerial
¥¥ 
.
¥¥ "
SerialDataSendFailed
¥¥ 2
-=
¥¥3 5
new
¥¥6 9/
!FSerialDataSendFailedEventHandler
¥¥: [
(
¥¥[ \,
m_fSerial_SerialDataSendFailed
¥¥\ z
)
¥¥z {
;
¥¥{ |
	m_fSerial
¦¦ 
.
¦¦ 
SerialErrorRaised
¦¦ /
-=
¦¦0 2
new
¦¦3 6,
FSerialErrorRaisedEventHandler
¦¦7 U
(
¦¦U V)
m_fSerial_SerialErrorRaised
¦¦V q
)
¦¦q r
;
¦¦r s
	m_fSerial
¨¨ 
=
¨¨ 
null
¨¨  $
;
¨¨$ %
}
©© 
if
«« 
(
«« 

m_fRecvBuf
«« 
!=
«« !
null
««" &
)
««& '
{
¬¬ 

m_fRecvBuf
­­ 
.
­­ 
Dispose
­­ &
(
­­& '
)
­­' (
;
­­( )

m_fRecvBuf
®® 
=
®®  
null
®®! %
;
®®% &
}
¯¯ 
if
±± 
(
±± 
m_fRecvBlockList
±± $
!=
±±% '
null
±±( ,
)
±±, -
{
²² 
m_fRecvBlockList
³³ $
.
³³$ %
Dispose
³³% ,
(
³³, -
)
³³- .
;
³³. /
m_fRecvBlockList
´´ $
=
´´% &
null
´´' +
;
´´+ ,
}
µµ 
if
·· 
(
·· 
m_fSendBlock
··  
!=
··! #
null
··$ (
)
··( )
{
¸¸ 
m_fSendBlock
¹¹  
.
¹¹  !
Dispose
¹¹! (
(
¹¹( )
)
¹¹) *
;
¹¹* +
m_fSendBlock
ºº  
=
ºº! "
null
ºº# '
;
ºº' (
}
»» 
if
½½ 
(
½½ #
m_fSendBlockListQueue
½½ )
!=
½½* ,
null
½½- 1
)
½½1 2
{
¾¾ #
m_fSendBlockListQueue
¿¿ )
.
¿¿) *
Dispose
¿¿* 1
(
¿¿1 2
)
¿¿2 3
;
¿¿3 4#
m_fSendBlockListQueue
ÀÀ )
=
ÀÀ* +
null
ÀÀ, 0
;
ÀÀ0 1
}
ÁÁ 
if
ÃÃ 
(
ÃÃ 
m_fTmrT1
ÃÃ 
!=
ÃÃ 
null
ÃÃ  $
)
ÃÃ$ %
{
ÄÄ 
m_fTmrT1
ÅÅ 
.
ÅÅ 
Dispose
ÅÅ $
(
ÅÅ$ %
)
ÅÅ% &
;
ÅÅ& '
m_fTmrT1
ÆÆ 
=
ÆÆ 
null
ÆÆ #
;
ÆÆ# $
}
ÇÇ 
if
ÉÉ 
(
ÉÉ 
m_fTmrT2
ÉÉ 
!=
ÉÉ 
null
ÉÉ  $
)
ÉÉ$ %
{
ÊÊ 
m_fTmrT2
ËË 
.
ËË 
Dispose
ËË $
(
ËË$ %
)
ËË% &
;
ËË& '
m_fTmrT2
ÌÌ 
=
ÌÌ 
null
ÌÌ #
;
ÌÌ# $
}
ÍÍ 
if
ÏÏ 
(
ÏÏ 
m_fTmrT4Runner
ÏÏ "
!=
ÏÏ# %
null
ÏÏ& *
)
ÏÏ* +
{
ĞĞ 
m_fTmrT4Runner
ÑÑ "
.
ÑÑ" #
Dispose
ÑÑ# *
(
ÑÑ* +
)
ÑÑ+ ,
;
ÑÑ, -
m_fTmrT4Runner
ÒÒ "
=
ÒÒ# $
null
ÒÒ% )
;
ÒÒ) *
}
ÓÓ 
if
ÕÕ 
(
ÕÕ 
m_fMainSync
ÕÕ 
!=
ÕÕ  "
null
ÕÕ# '
)
ÕÕ' (
{
ÖÖ 
m_fMainSync
×× 
.
××  
Dispose
××  '
(
××' (
)
××( )
;
××) *
m_fMainSync
ØØ 
=
ØØ  !
null
ØØ" &
;
ØØ& '
}
ÙÙ 
}
ÚÚ 
catch
ÛÛ 
(
ÛÛ 
	Exception
ÛÛ 
ex
ÛÛ 
)
ÛÛ  
{
ÜÜ 
FDebug
İİ 
.
İİ 
throwException
İİ %
(
İİ% &
ex
İİ& (
)
İİ( )
;
İİ) *
}
ŞŞ 
finally
ßß 
{
àà 
}
ââ 
}
ãã 	
public
çç 
void
çç 
open
çç 
(
çç 
)
èè 
{
éé 	
try
êê 
{
ëë 
	m_fSerial
ìì 
=
ìì 
new
ìì 
FSerial
ìì  '
(
ìì' (
this
íí 
.
íí 
m_fSecs1ToHsms
íí '
.
íí' (
fSecs1Config
íí( 4
.
íí4 5

serialPort
íí5 ?
,
íí? @
this
îî 
.
îî 
m_fSecs1ToHsms
îî '
.
îî' (
fSecs1Config
îî( 4
.
îî4 5
baud
îî5 9
)
ïï 
;
ïï 
	m_fSerial
ññ 
.
ññ  
SerialStateChanged
ññ ,
+=
ññ- /
new
ññ0 3-
FSerialStateChangedEventHandler
ññ4 S
(
ññS T*
m_fSerial_SerialStateChanged
ññT p
)
ññp q
;
ññq r
	m_fSerial
òò 
.
òò  
SerialDataReceived
òò ,
+=
òò- /
new
òò0 3-
FSerialDataReceivedEventHandler
òò4 S
(
òòS T*
m_fSerial_SerialDataReceived
òòT p
)
òòp q
;
òòq r
	m_fSerial
óó 
.
óó 
SerialDataSent
óó (
+=
óó) +
new
óó, /)
FSerialDataSentEventHandler
óó0 K
(
óóK L&
m_fSerial_SerialDataSent
óóL d
)
óód e
;
óóe f
	m_fSerial
ôô 
.
ôô "
SerialDataSendFailed
ôô .
+=
ôô/ 1
new
ôô2 5/
!FSerialDataSendFailedEventHandler
ôô6 W
(
ôôW X,
m_fSerial_SerialDataSendFailed
ôôX v
)
ôôv w
;
ôôw x
	m_fSerial
õõ 
.
õõ 
SerialErrorRaised
õõ +
+=
õõ, .
new
õõ/ 2,
FSerialErrorRaisedEventHandler
õõ3 Q
(
õõQ R)
m_fSerial_SerialErrorRaised
õõR m
)
õõm n
;
õõn o
	m_fSerial
÷÷ 
.
÷÷ 
open
÷÷ 
(
÷÷ 
)
÷÷  
;
÷÷  !
}
øø 
catch
ùù 
(
ùù 
	Exception
ùù 
ex
ùù 
)
ùù  
{
úú 
FDebug
ûû 
.
ûû 
throwException
ûû %
(
ûû% &
ex
ûû& (
)
ûû( )
;
ûû) *
}
üü 
finally
ıı 
{
şş 
}
€€ 
}
 	
public
…… 
void
…… 
close
…… 
(
…… 
)
†† 
{
‡‡ 	
try
ˆˆ 
{
‰‰ 
if
ŠŠ 
(
ŠŠ 
	m_fSerial
ŠŠ 
.
ŠŠ 
fState
ŠŠ $
==
ŠŠ% '
FSerialState
ŠŠ( 4
.
ŠŠ4 5
Opened
ŠŠ5 ;
)
ŠŠ; <
{
‹‹ 
while
ŒŒ 
(
ŒŒ 
m_fSecs1ToHsms
ŒŒ )
.
ŒŒ) *
fEventPusher
ŒŒ* 6
.
ŒŒ6 7
secs1EventCount
ŒŒ7 F
>
ŒŒG H
$num
ŒŒI J
||
ŒŒK M
!
ŒŒN O
	m_fSerial
ŒŒO X
.
ŒŒX Y
sendCompleted
ŒŒY f
)
ŒŒf g
{
 
if
 
(
 
System
 "
.
" #
Windows
# *
.
* +
Forms
+ 0
.
0 1
Application
1 <
.
< =
MessageLoop
= H
)
H I
{
 
System
 "
.
" #
Windows
# *
.
* +
Forms
+ 0
.
0 1
Application
1 <
.
< =
DoEvents
= E
(
E F
)
F G
;
G H
}
‘‘ 
System
’’ 
.
’’ 
	Threading
’’ (
.
’’( )
Thread
’’) /
.
’’/ 0
Sleep
’’0 5
(
’’5 6
$num
’’6 7
)
’’7 8
;
’’8 9
}
““ 
}
”” 
	m_fSerial
˜˜ 
.
˜˜ 
close
˜˜ 
(
˜˜  
)
˜˜  !
;
˜˜! "
	m_fSerial
™™ 
.
™™ 
Dispose
™™ !
(
™™! "
)
™™" #
;
™™# $
	m_fSerial
›› 
.
››  
SerialStateChanged
›› ,
-=
››- /
new
››0 3-
FSerialStateChangedEventHandler
››4 S
(
››S T*
m_fSerial_SerialStateChanged
››T p
)
››p q
;
››q r
	m_fSerial
œœ 
.
œœ  
SerialDataReceived
œœ ,
-=
œœ- /
new
œœ0 3-
FSerialDataReceivedEventHandler
œœ4 S
(
œœS T*
m_fSerial_SerialDataReceived
œœT p
)
œœp q
;
œœq r
	m_fSerial
 
.
 
SerialDataSent
 (
-=
) +
new
, /)
FSerialDataSentEventHandler
0 K
(
K L&
m_fSerial_SerialDataSent
L d
)
d e
;
e f
	m_fSerial
 
.
 "
SerialDataSendFailed
 .
-=
/ 1
new
2 5/
!FSerialDataSendFailedEventHandler
6 W
(
W X,
m_fSerial_SerialDataSendFailed
X v
)
v w
;
w x
	m_fSerial
ŸŸ 
.
ŸŸ 
SerialErrorRaised
ŸŸ +
-=
ŸŸ, .
new
ŸŸ/ 2,
FSerialErrorRaisedEventHandler
ŸŸ3 Q
(
ŸŸQ R)
m_fSerial_SerialErrorRaised
ŸŸR m
)
ŸŸm n
;
ŸŸn o
	m_fSerial
¡¡ 
=
¡¡ 
null
¡¡  
;
¡¡  !
}
¢¢ 
catch
££ 
(
££ 
	Exception
££ 
ex
££ 
)
££  
{
¤¤ 
FDebug
¥¥ 
.
¥¥ 
throwException
¥¥ %
(
¥¥% &
ex
¥¥& (
)
¥¥( )
;
¥¥) *
}
¦¦ 
finally
§§ 
{
¨¨ 
}
ªª 
}
«« 	
public
¯¯ 
void
¯¯ 
send
¯¯ 
(
¯¯ 
FSecsDataMessage
°° 
fSecsDataMessage
°° -
)
±± 
{
²² 	
try
³³ 
{
´´ #
m_fSendBlockListQueue
µµ %
.
µµ% &
enqueue
µµ& -
(
µµ- .
fSecsDataMessage
µµ. >
.
µµ> ?#
getSecs1SendBlockList
µµ? T
(
µµT U
)
µµU V
)
µµV W
;
µµW X
}
¶¶ 
catch
·· 
(
·· 
	Exception
·· 
ex
·· 
)
··  
{
¸¸ 
FDebug
¹¹ 
.
¹¹ 
throwException
¹¹ %
(
¹¹% &
ex
¹¹& (
)
¹¹( )
;
¹¹) *
}
ºº 
finally
»» 
{
¼¼ 
}
¾¾ 
}
¿¿ 	
private
ÃÃ 
void
ÃÃ 
sendHandshakeENQ
ÃÃ %
(
ÃÃ% &
)
ÄÄ 
{
ÅÅ 	%
FSecs1HandshakeSendData
ÆÆ #
fData
ÆÆ$ )
=
ÆÆ* +
null
ÆÆ, 0
;
ÆÆ0 1
try
ÈÈ 
{
ÉÉ 
m_fSendState
ÍÍ 
=
ÍÍ 
FSecs1SendState
ÍÍ .
.
ÍÍ. /
Enq
ÍÍ/ 2
;
ÍÍ2 3
m_fTmrT2
ÔÔ 
.
ÔÔ 
restart
ÔÔ  
(
ÔÔ  !
(
ÔÔ! "
int
ÔÔ" %
)
ÔÔ% &
(
ÔÔ& '
m_fSecs1ToHsms
ÔÔ' 5
.
ÔÔ5 6
fSecs1Config
ÔÔ6 B
.
ÔÔB C
	t2Timeout
ÔÔC L
*
ÔÔM N
$num
ÔÔO S
)
ÔÔS T
)
ÔÔT U
;
ÔÔU V
fData
ØØ 
=
ØØ 
new
ØØ %
FSecs1HandshakeSendData
ØØ 3
(
ØØ3 4!
FSecs1HandshakeCode
ØØ4 G
.
ØØG H
ENQ
ØØH K
)
ØØK L
;
ØØL M
	m_fSerial
ÚÚ 
.
ÚÚ 
send
ÚÚ 
(
ÚÚ 
new
ÛÛ 
FSerialSendData
ÛÛ '
(
ÛÛ' (
fData
ÛÛ( -
.
ÛÛ- .
handshakeToBytes
ÛÛ. >
(
ÛÛ> ?
)
ÛÛ? @
,
ÛÛ@ A
fData
ÛÛB G
)
ÛÛG H
)
ÜÜ 
;
ÜÜ 
}
İİ 
catch
ŞŞ 
(
ŞŞ 
	Exception
ŞŞ 
ex
ŞŞ 
)
ŞŞ  
{
ßß "
procSecs1ErrorRaised
àà $
(
àà$ %
ex
àà% '
)
àà' (
;
àà( )
}
áá 
finally
ââ 
{
ãã 
fData
ää 
=
ää 
null
ää 
;
ää 
}
åå 
}
ææ 	
private
êê 
void
êê 
sendHandshakeEOT
êê %
(
êê% &
)
ëë 
{
ìì 	%
FSecs1HandshakeSendData
íí #
fData
íí$ )
=
íí* +
null
íí, 0
;
íí0 1
try
ïï 
{
ğğ 
m_fRecvState
ôô 
=
ôô 
FSecs1RecvState
ôô .
.
ôô. /
Eot
ôô/ 2
;
ôô2 3
m_fTmrT2
ûû 
.
ûû 
restart
ûû  
(
ûû  !
(
ûû! "
int
ûû" %
)
ûû% &
(
ûû& '
m_fSecs1ToHsms
ûû' 5
.
ûû5 6
fSecs1Config
ûû6 B
.
ûûB C
	t2Timeout
ûûC L
*
ûûM N
$num
ûûO S
)
ûûS T
)
ûûT U
;
ûûU V
fData
ÿÿ 
=
ÿÿ 
new
ÿÿ %
FSecs1HandshakeSendData
ÿÿ 3
(
ÿÿ3 4!
FSecs1HandshakeCode
ÿÿ4 G
.
ÿÿG H
EOT
ÿÿH K
)
ÿÿK L
;
ÿÿL M
	m_fSerial
 
.
 
send
 
(
 
new
‚‚ 
FSerialSendData
‚‚ '
(
‚‚' (
fData
‚‚( -
.
‚‚- .
handshakeToBytes
‚‚. >
(
‚‚> ?
)
‚‚? @
,
‚‚@ A
fData
‚‚B G
)
‚‚G H
)
ƒƒ 
;
ƒƒ 
}
„„ 
catch
…… 
(
…… 
	Exception
…… 
ex
…… 
)
……  
{
†† "
procSecs1ErrorRaised
‡‡ $
(
‡‡$ %
ex
‡‡% '
)
‡‡' (
;
‡‡( )
}
ˆˆ 
finally
‰‰ 
{
ŠŠ 
fData
‹‹ 
=
‹‹ 
null
‹‹ 
;
‹‹ 
}
ŒŒ 
}
 	
private
‘‘ 
void
‘‘ 
sendHandshakeACK
‘‘ %
(
‘‘% &
FSecsDataMessage
’’ 
fSecsDataMessage
’’ -
)
““ 
{
”” 	%
FSecs1HandshakeSendData
•• #
fData
••$ )
=
••* +
null
••, 0
;
••0 1
try
—— 
{
˜˜ 
m_fRecvState
œœ 
=
œœ 
FSecs1RecvState
œœ .
.
œœ. /
	Completed
œœ/ 8
;
œœ8 9
fData
   
=
   
new
   %
FSecs1HandshakeSendData
   3
(
  3 4!
FSecs1HandshakeCode
  4 G
.
  G H
ACK
  H K
,
  K L
fSecsDataMessage
  M ]
)
  ] ^
;
  ^ _
	m_fSerial
¢¢ 
.
¢¢ 
send
¢¢ 
(
¢¢ 
new
££ 
FSerialSendData
££ '
(
££' (
fData
££( -
.
££- .
handshakeToBytes
££. >
(
££> ?
)
££? @
,
££@ A
fData
££B G
)
££G H
)
¤¤ 
;
¤¤ 
}
¥¥ 
catch
¦¦ 
(
¦¦ 
	Exception
¦¦ 
ex
¦¦ 
)
¦¦  
{
§§ "
procSecs1ErrorRaised
¨¨ $
(
¨¨$ %
ex
¨¨% '
)
¨¨' (
;
¨¨( )
}
©© 
finally
ªª 
{
«« 
fData
¬¬ 
=
¬¬ 
null
¬¬ 
;
¬¬ 
}
­­ 
}
®® 	
private
²² 
void
²² 
sendHandshakeNAK
²² %
(
²²% &
)
³³ 
{
´´ 	%
FSecs1HandshakeSendData
µµ #
fData
µµ$ )
=
µµ* +
null
µµ, 0
;
µµ0 1
try
·· 
{
¸¸ 
m_fRecvState
¼¼ 
=
¼¼ 
FSecs1RecvState
¼¼ .
.
¼¼. /
	Completed
¼¼/ 8
;
¼¼8 9
fData
ÀÀ 
=
ÀÀ 
new
ÀÀ %
FSecs1HandshakeSendData
ÀÀ 3
(
ÀÀ3 4!
FSecs1HandshakeCode
ÀÀ4 G
.
ÀÀG H
NAK
ÀÀH K
)
ÀÀK L
;
ÀÀL M
	m_fSerial
ÂÂ 
.
ÂÂ 
send
ÂÂ 
(
ÂÂ 
new
ÃÃ 
FSerialSendData
ÃÃ '
(
ÃÃ' (
fData
ÃÃ( -
.
ÃÃ- .
handshakeToBytes
ÃÃ. >
(
ÃÃ> ?
)
ÃÃ? @
,
ÃÃ@ A
fData
ÃÃB G
)
ÃÃG H
)
ÄÄ 
;
ÄÄ 
}
ÅÅ 
catch
ÆÆ 
(
ÆÆ 
	Exception
ÆÆ 
ex
ÆÆ 
)
ÆÆ  
{
ÇÇ "
procSecs1ErrorRaised
ÈÈ $
(
ÈÈ$ %
ex
ÈÈ% '
)
ÈÈ' (
;
ÈÈ( )
}
ÉÉ 
finally
ÊÊ 
{
ËË 
fData
ÌÌ 
=
ÌÌ 
null
ÌÌ 
;
ÌÌ 
}
ÍÍ 
}
ÎÎ 	
private
ÒÒ 
void
ÒÒ 
	sendBlock
ÒÒ 
(
ÒÒ 
)
ÓÓ 
{
ÔÔ 	

FSecsBlock
ÕÕ 

fSecsBlock
ÕÕ !
=
ÕÕ" #
null
ÕÕ$ (
;
ÕÕ( )
try
×× 
{
ØØ 
m_fTmrT2
ÜÜ 
.
ÜÜ 
restart
ÜÜ  
(
ÜÜ  !
(
ÜÜ! "
int
ÜÜ" %
)
ÜÜ% &
(
ÜÜ& '
m_fSecs1ToHsms
ÜÜ' 5
.
ÜÜ5 6
fSecs1Config
ÜÜ6 B
.
ÜÜB C
	t2Timeout
ÜÜC L
*
ÜÜM N
$num
ÜÜO S
)
ÜÜS T
)
ÜÜT U
;
ÜÜU V

fSecsBlock
àà 
=
àà 
new
àà  

FSecsBlock
àà! +
(
àà+ ,
m_fSecs1ToHsms
áá "
,
áá" #
m_fSendBlock
ââ  
.
ââ  !
length
ââ! '
,
ââ' (
m_fSendBlock
ãã  
.
ãã  !
	blockData
ãã! *
,
ãã* +
m_fSendBlock
ää  
.
ää  !
rbit
ää! %
,
ää% &
m_fSendBlock
åå  
.
åå  !
	sessionId
åå! *
,
åå* +
m_fSendBlock
ææ  
.
ææ  !
wbit
ææ! %
,
ææ% &
m_fSendBlock
çç  
.
çç  !
stream
çç! '
,
çç' (
m_fSendBlock
èè  
.
èè  !
function
èè! )
,
èè) *
m_fSendBlock
éé  
.
éé  !
ebit
éé! %
,
éé% &
m_fSendBlock
êê  
.
êê  !
blockNo
êê! (
,
êê( )
m_fSendBlock
ëë  
.
ëë  !
systemBytes
ëë! ,
,
ëë, -
m_fSendBlock
ìì  
.
ìì  !
body
ìì! %
,
ìì% &
m_fSendBlock
íí  
.
íí  !
checkSum
íí! )
)
îî 
;
îî 
	m_fSerial
ğğ 
.
ğğ 
send
ğğ 
(
ğğ 
new
ğğ "
FSerialSendData
ğğ# 2
(
ğğ2 3
m_fSendBlock
ğğ3 ?
.
ğğ? @
	blockData
ğğ@ I
,
ğğI J

fSecsBlock
ğğK U
)
ğğU V
)
ğğV W
;
ğğW X
}
ññ 
catch
òò 
(
òò 
	Exception
òò 
ex
òò 
)
òò  
{
óó "
procSecs1ErrorRaised
ôô $
(
ôô$ %
ex
ôô% '
)
ôô' (
;
ôô( )
}
õõ 
finally
öö 
{
÷÷ 

fSecsBlock
øø 
=
øø 
null
øø !
;
øø! "
}
ùù 
}
úú 	
private
şş 
void
şş 
retrySendBlock
şş #
(
şş# $
)
ÿÿ 
{
€€ 	
try
 
{
‚‚ 
m_fSendState
†† 
=
†† 
FSecs1SendState
†† .
.
††. /
	Completed
††/ 8
;
††8 9
if
 
(
 
m_fSendBlock
  
.
  !

retryCount
! +
<
, -
m_fSecs1ToHsms
. <
.
< =
fSecs1Config
= I
.
I J

retryLimit
J T
)
T U
{
 
m_fSendBlock
  
.
  !
addRetryCount
! .
(
. /
)
/ 0
;
0 1
m_fSendBlock
  
.
  !
isRetry
! (
=
) *
true
+ /
;
/ 0
}
‘‘ 
else
’’ 
{
““ 
m_fSecs1ToHsms
”” "
.
””" #
fEventPusher
””# /
.
””/ 0
pushSecs1Event
””0 >
(
””> ?
new
•• ,
FSecs1DataMessageSentEventArgs
•• :
(
••: ;
m_fSecs1ToHsms
–– *
,
––* +
FEventId
—— $
.
——$ %"
Secs1DataMessageSent
——% 9
,
——9 :
FResultCode
˜˜ '
.
˜˜' (
Error
˜˜( -
,
˜˜- .

FConstants
™™ &
.
™™& '
err_m_16002
™™' 2
,
™™2 3
m_fSendBlock
šš (
.
šš( )

fBlockList
šš) 3
.
šš3 4
fSecsDataMessage
šš4 D
)
›› 
)
œœ 
;
œœ 
m_fSendBlock
  
=
! "
null
# '
;
' (
}
ŸŸ 
}
   
catch
¡¡ 
(
¡¡ 
	Exception
¡¡ 
ex
¡¡ 
)
¡¡  
{
¢¢ "
procSecs1ErrorRaised
££ $
(
££$ %
ex
££% '
)
££' (
;
££( )
}
¤¤ 
finally
¥¥ 
{
¦¦ 
}
¨¨ 
}
©© 	
private
­­ 
bool
­­ 
sendDataMessage
­­ $
(
­­$ %
)
®® 
{
¯¯ 	
try
°° 
{
±± 
if
µµ 
(
µµ 
m_fRecvState
µµ  
!=
µµ! #
FSecs1RecvState
µµ$ 3
.
µµ3 4
	Completed
µµ4 =
||
µµ> @
m_fSendState
µµA M
!=
µµN P
FSecs1SendState
µµQ `
.
µµ` a
	Completed
µµa j
)
µµj k
{
¶¶ 
return
·· 
false
··  
;
··  !
}
¸¸ 
if
¼¼ 
(
¼¼ 
m_fSendBlock
¼¼  
!=
¼¼! #
null
¼¼$ (
)
¼¼( )
{
½½ 
if
¾¾ 
(
¾¾ 
m_fSendBlock
¾¾ $
.
¾¾$ %
isRetry
¾¾% ,
)
¾¾, -
{
¿¿ 
m_fSendBlock
ÃÃ $
.
ÃÃ$ %
isRetry
ÃÃ% ,
=
ÃÃ- .
false
ÃÃ/ 4
;
ÃÃ4 5
sendHandshakeENQ
ÅÅ (
(
ÅÅ( )
)
ÅÅ) *
;
ÅÅ* +
return
ÆÆ 
true
ÆÆ #
;
ÆÆ# $
}
ÇÇ 
return
ÈÈ 
false
ÈÈ  
;
ÈÈ  !
}
ÉÉ 
if
ĞĞ 
(
ĞĞ #
m_fSendBlockListQueue
ĞĞ )
.
ĞĞ) *
count
ĞĞ* /
==
ĞĞ0 2
$num
ĞĞ3 4
)
ĞĞ4 5
{
ÑÑ 
return
ÒÒ 
false
ÒÒ  
;
ÒÒ  !
}
ÓÓ 
m_fSendBlock
×× 
=
×× #
m_fSendBlockListQueue
×× 4
.
××4 5
dequeue
××5 <
(
××< =
)
××= >
.
××> ?
fCurrentBlock
××? L
;
××L M
sendHandshakeENQ
ØØ  
(
ØØ  !
)
ØØ! "
;
ØØ" #
return
ÙÙ 
true
ÙÙ 
;
ÙÙ 
}
ÚÚ 
catch
ÛÛ 
(
ÛÛ 
	Exception
ÛÛ 
ex
ÛÛ 
)
ÛÛ  
{
ÜÜ "
procSecs1ErrorRaised
İİ $
(
İİ$ %
ex
İİ% '
)
İİ' (
;
İİ( )
}
ŞŞ 
finally
ßß 
{
àà 
}
ââ 
return
ãã 
false
ãã 
;
ãã 
}
ää 	
private
èè 
void
èè  
procSecs1T1Timeout
èè '
(
èè' (
)
éé 
{
êê 	
try
ëë 
{
ìì 
m_fSecs1ToHsms
ğğ 
.
ğğ 
fEventPusher
ğğ +
.
ğğ+ ,
pushSecs1Event
ğğ, :
(
ğğ: ;
new
ññ *
FSecs1TimeoutRaisedEventArgs
ññ 4
(
ññ4 5
m_fSecs1ToHsms
ññ5 C
,
ññC D
FEventId
ññE M
.
ññM N 
Secs1TimeoutRaised
ññN `
,
ññ` a
FSecsTimeout
ññb n
.
ññn o
T1
ñño q
,
ññq r

FConstants
ññs }
.
ññ} ~
err_m_20001ññ~ ‰
)ññ‰ Š
)
òò 
;
òò 
m_fRecvBlock
ùù 
=
ùù 
null
ùù #
;
ùù# $
sendHandshakeNAK
€€  
(
€€  !
)
€€! "
;
€€" #
}
 
catch
‚‚ 
(
‚‚ 
	Exception
‚‚ 
ex
‚‚ 
)
‚‚  
{
ƒƒ 
FDebug
„„ 
.
„„ 
throwException
„„ %
(
„„% &
ex
„„& (
)
„„( )
;
„„) *
}
…… 
finally
†† 
{
‡‡ 
}
‰‰ 
}
ŠŠ 	
private
 
void
  
procSecs1T2Timeout
 '
(
' (
)
 
{
 	
try
‘‘ 
{
’’ 
m_fSecs1ToHsms
–– 
.
–– 
fEventPusher
–– +
.
––+ ,
pushSecs1Event
––, :
(
––: ;
new
—— *
FSecs1TimeoutRaisedEventArgs
—— 4
(
——4 5
m_fSecs1ToHsms
——5 C
,
——C D
FEventId
——E M
.
——M N 
Secs1TimeoutRaised
——N `
,
——` a
FSecsTimeout
——b n
.
——n o
T2
——o q
,
——q r

FConstants
——s }
.
——} ~
err_m_20002——~ ‰
)——‰ Š
)
˜˜ 
;
˜˜ 
if
œœ 
(
œœ 
m_fRecvState
œœ  
==
œœ! #
FSecs1RecvState
œœ$ 3
.
œœ3 4
Eot
œœ4 7
)
œœ7 8
{
 
sendHandshakeNAK
¡¡ $
(
¡¡$ %
)
¡¡% &
;
¡¡& '
}
¢¢ 
else
££ 
if
££ 
(
££ 
m_fSendState
¤¤  
==
¤¤! #
FSecs1SendState
¤¤$ 3
.
¤¤3 4
Enq
¤¤4 7
||
¤¤8 :
m_fSendState
¥¥  
==
¥¥! #
FSecs1SendState
¥¥$ 3
.
¥¥3 4
Eot
¥¥4 7
)
¦¦ 
{
§§ 
retrySendBlock
¨¨ "
(
¨¨" #
)
¨¨# $
;
¨¨$ %
}
©© 
}
ªª 
catch
«« 
(
«« 
	Exception
«« 
ex
«« 
)
««  
{
¬¬ 
FDebug
­­ 
.
­­ 
throwException
­­ %
(
­­% &
ex
­­& (
)
­­( )
;
­­) *
}
®® 
finally
¯¯ 
{
°° 
}
²² 
}
³³ 	
private
·· 
void
··  
procSecs1T4Timeout
·· '
(
··' ("
FSecs1T4TimeoutBlock
¸¸  
fBlock
¸¸! '
)
¹¹ 
{
ºº 	
string
»» 
errorMessage
»» 
=
»»  !
string
»»" (
.
»»( )
Empty
»») .
;
»». /
try
½½ 
{
¾¾ 
errorMessage
¿¿ 
=
¿¿ 
string
¿¿ %
.
¿¿% &
Format
¿¿& ,
(
¿¿, -

FConstants
¿¿- 7
.
¿¿7 8
err_m_20004
¿¿8 C
,
¿¿C D
fBlock
¿¿E K
.
¿¿K L
stream
¿¿L R
,
¿¿R S
fBlock
¿¿T Z
.
¿¿Z [
function
¿¿[ c
,
¿¿c d
fBlock
¿¿e k
.
¿¿k l
	sessionId
¿¿l u
,
¿¿u v
fBlock
¿¿w }
.
¿¿} ~
systemBytes¿¿~ ‰
)¿¿‰ Š
;¿¿Š ‹
m_fSecs1ToHsms
ÆÆ 
.
ÆÆ 
fEventPusher
ÆÆ +
.
ÆÆ+ ,
pushSecs1Event
ÆÆ, :
(
ÆÆ: ;
new
ÇÇ *
FSecs1TimeoutRaisedEventArgs
ÇÇ 4
(
ÇÇ4 5
m_fSecs1ToHsms
ÇÇ5 C
,
ÇÇC D
FEventId
ÇÇE M
.
ÇÇM N 
Secs1TimeoutRaised
ÇÇN `
,
ÇÇ` a
FSecsTimeout
ÇÇb n
.
ÇÇn o
T4
ÇÇo q
,
ÇÇq r
errorMessage
ÇÇs 
)ÇÇ €
)
ÈÈ 
;
ÈÈ 
}
ÉÉ 
catch
ÊÊ 
(
ÊÊ 
	Exception
ÊÊ 
ex
ÊÊ 
)
ÊÊ  
{
ËË 
FDebug
ÌÌ 
.
ÌÌ 
throwException
ÌÌ %
(
ÌÌ% &
ex
ÌÌ& (
)
ÌÌ( )
;
ÌÌ) *
}
ÍÍ 
finally
ÎÎ 
{
ÏÏ 
}
ÑÑ 
}
ÒÒ 	
private
ÖÖ 
void
ÖÖ "
procSecs1ErrorRaised
ÖÖ )
(
ÖÖ) *
	Exception
×× 
inEx
×× 
)
ØØ 
{
ÙÙ 	
try
ÚÚ 
{
ÛÛ 
FDebug
ÜÜ 
.
ÜÜ 
writeLog
ÜÜ 
(
ÜÜ  
inEx
ÜÜ  $
)
ÜÜ$ %
;
ÜÜ% &
m_fSecs1ToHsms
ŞŞ 
.
ŞŞ 
fEventPusher
ŞŞ +
.
ŞŞ+ ,
pushSecs1Event
ŞŞ, :
(
ŞŞ: ;
new
ßß (
FSecs1ErrorRaisedEventArgs
ßß 2
(
ßß2 3
m_fSecs1ToHsms
ßß3 A
,
ßßA B
FEventId
ßßC K
.
ßßK L
Secs1ErrorRaised
ßßL \
,
ßß\ ]
inEx
ßß^ b
.
ßßb c
Message
ßßc j
)
ßßj k
)
àà 
;
àà 
}
áá 
catch
ââ 
(
ââ 
	Exception
ââ 
ex
ââ 
)
ââ  
{
ãã 
FDebug
ää 
.
ää 
writeLog
ää 
(
ää  
ex
ää  "
)
ää" #
;
ää# $
}
åå 
finally
ææ 
{
çç 
}
éé 
}
êê 	
private
îî 
void
îî "
procSecs1ErrorRaised
îî )
(
îî) *
string
ïï 
errorMessage
ïï 
)
ğğ 
{
ññ 	
	Exception
òò 
inEx
òò 
=
òò 
null
òò !
;
òò! "
try
ôô 
{
õõ 
inEx
öö 
=
öö 
new
öö 
	Exception
öö $
(
öö$ %
errorMessage
öö% 1
)
öö1 2
;
öö2 3"
procSecs1ErrorRaised
øø $
(
øø$ %
inEx
øø% )
)
øø) *
;
øø* +
}
ùù 
catch
úú 
(
úú 
	Exception
úú 
ex
úú 
)
úú  
{
ûû 
FDebug
üü 
.
üü 
writeLog
üü 
(
üü  
ex
üü  "
)
üü" #
;
üü# $
}
ıı 
finally
şş 
{
ÿÿ 
}
 
}
‚‚ 	
private
ŠŠ 
void
ŠŠ (
m_fThdMain_ThreadJobCalled
ŠŠ /
(
ŠŠ/ 0
object
‹‹ 
sender
‹‹ 
,
‹‹ 
FThreadEventArgs
ŒŒ 
e
ŒŒ 
)
 
{
 	
bool
 
waited
 
=
 
false
 
;
  
try
‘‘ 
{
’’ 
waited
““ 
=
““ 
m_fMainSync
““ $
.
““$ %
tryWait
““% ,
(
““, -
$num
““- .
)
““. /
;
““/ 0
if
”” 
(
”” 
!
”” 
waited
”” 
)
”” 
{
•• 
return
–– 
;
–– 
}
—— 
if
›› 
(
›› 
	m_fSerial
›› 
==
››  
null
››! %
||
››& (
	m_fSerial
››) 2
.
››2 3
fState
››3 9
!=
››: <
FSerialState
››= I
.
››I J
Opened
››J P
||
››Q S
m_fSecs1ToHsms
››T b
.
››b c
fSecs1State
››c n
!=
››o q"
FCommunicationState››r …
.››… †
Selected››† 
)›› 
{
œœ 
e
 
.
 
sleepThread
 !
(
! "
$num
" #
)
# $
;
$ %
return
 
;
 
}
ŸŸ 
if
¦¦ 
(
¦¦ 
m_fTmrT1
¦¦ 
.
¦¦ 
elasped
¦¦ $
(
¦¦$ %
false
¦¦% *
)
¦¦* +
)
¦¦+ ,
{
§§  
procSecs1T1Timeout
¨¨ &
(
¨¨& '
)
¨¨' (
;
¨¨( )
return
©© 
;
©© 
}
ªª 
if
¯¯ 
(
¯¯ 
m_fTmrT2
¯¯ 
.
¯¯ 
elasped
¯¯ $
(
¯¯$ %
false
¯¯% *
)
¯¯* +
)
¯¯+ ,
{
°°  
procSecs1T2Timeout
±± &
(
±±& '
)
±±' (
;
±±( )
return
²² 
;
²² 
}
³³ 
if
¸¸ 
(
¸¸ 
m_fTmrT4Runner
¸¸ "
.
¸¸" #
elasped
¸¸# *
(
¸¸* +
true
¸¸+ /
)
¸¸/ 0
)
¸¸0 1
{
¹¹ 
foreach
ºº 
(
ºº "
FSecs1T4TimeoutBlock
ºº 1
b
ºº2 3
in
ºº4 6
m_fRecvBlockList
ºº7 G
.
ººG H"
removeT4TimeoutBlock
ººH \
(
ºº\ ]
)
ºº] ^
)
ºº^ _
{
»»  
procSecs1T4Timeout
¼¼ *
(
¼¼* +
b
¼¼+ ,
)
¼¼, -
;
¼¼- .
}
½½ 
}
¾¾ 
if
ÅÅ 
(
ÅÅ 
sendDataMessage
ÅÅ #
(
ÅÅ# $
)
ÅÅ$ %
)
ÅÅ% &
{
ÆÆ 
return
ÇÇ 
;
ÇÇ 
}
ÈÈ 
e
ÌÌ 
.
ÌÌ 
sleepThread
ÌÌ 
(
ÌÌ 
$num
ÌÌ 
)
ÌÌ  
;
ÌÌ  !
}
ÍÍ 
catch
ÎÎ 
(
ÎÎ 
	Exception
ÎÎ 
ex
ÎÎ 
)
ÎÎ  
{
ÏÏ "
procSecs1ErrorRaised
ĞĞ $
(
ĞĞ$ %
ex
ĞĞ% '
)
ĞĞ' (
;
ĞĞ( )
}
ÑÑ 
finally
ÒÒ 
{
ÓÓ 
if
ÔÔ 
(
ÔÔ 
waited
ÔÔ 
)
ÔÔ 
{
ÕÕ 
m_fMainSync
ÖÖ 
.
ÖÖ  
set
ÖÖ  #
(
ÖÖ# $
)
ÖÖ$ %
;
ÖÖ% &
}
×× 
}
ØØ 
}
ÙÙ 	
private
áá 
void
áá *
m_fSerial_SerialStateChanged
áá 1
(
áá1 2
object
ââ 
sender
ââ 
,
ââ *
FSerialStateChangedEventArgs
ãã (
e
ãã) *
)
ää 
{
åå 	
try
ææ 
{
çç 
m_fMainSync
èè 
.
èè 
wait
èè  
(
èè  !
)
èè! "
;
èè" #
if
ìì 
(
ìì 
e
ìì 
.
ìì 
fState
ìì 
==
ìì 
FSerialState
ìì  ,
.
ìì, -
Opened
ìì- 3
)
ìì3 4
{
íí 
m_fSecs1ToHsms
îî "
.
îî" #
changeSecs1State
îî# 3
(
îî3 4!
FCommunicationState
îî4 G
.
îîG H
Opened
îîH N
,
îîN O
m_fSecs1ToHsms
îîP ^
.
îî^ _
fSecs1Config
îî_ k
.
îîk l

serialPort
îîl v
,
îîv w
m_fSecs1ToHsmsîîx †
.îî† ‡
fSecs1Configîî‡ “
.îî“ ”
baudîî” ˜
)îî˜ ™
;îî™ š
m_fSecs1ToHsms
ïï "
.
ïï" #
changeSecs1State
ïï# 3
(
ïï3 4!
FCommunicationState
ïï4 G
.
ïïG H
	Connected
ïïH Q
,
ïïQ R
m_fSecs1ToHsms
ïïS a
.
ïïa b
fSecs1Config
ïïb n
.
ïïn o

serialPort
ïïo y
,
ïïy z
m_fSecs1ToHsmsïï{ ‰
.ïï‰ Š
fSecs1ConfigïïŠ –
.ïï– —
baudïï— ›
)ïï› œ
;ïïœ 
m_fSecs1ToHsms
ğğ "
.
ğğ" #
changeSecs1State
ğğ# 3
(
ğğ3 4!
FCommunicationState
ğğ4 G
.
ğğG H
Selected
ğğH P
,
ğğP Q
m_fSecs1ToHsms
ğğR `
.
ğğ` a
fSecs1Config
ğğa m
.
ğğm n

serialPort
ğğn x
,
ğğx y
m_fSecs1ToHsmsğğz ˆ
.ğğˆ ‰
fSecs1Configğğ‰ •
.ğğ• –
baudğğ– š
)ğğš ›
;ğğ› œ
}
ññ 
else
òò 
if
òò 
(
òò 
e
òò 
.
òò 
fState
òò !
==
òò" $
FSerialState
òò% 1
.
òò1 2
Closed
òò2 8
)
òò8 9
{
óó 
m_fSecs1ToHsms
ôô "
.
ôô" #
changeSecs1State
ôô# 3
(
ôô3 4!
FCommunicationState
ôô4 G
.
ôôG H
Closed
ôôH N
,
ôôN O
m_fSecs1ToHsms
ôôP ^
.
ôô^ _
fSecs1Config
ôô_ k
.
ôôk l

serialPort
ôôl v
,
ôôv w
m_fSecs1ToHsmsôôx †
.ôô† ‡
fSecs1Configôô‡ “
.ôô“ ”
baudôô” ˜
)ôô˜ ™
;ôô™ š
}
õõ 
}
öö 
catch
÷÷ 
(
÷÷ 
	Exception
÷÷ 
ex
÷÷ 
)
÷÷  
{
øø 
FDebug
ùù 
.
ùù 
writeLog
ùù 
(
ùù  
ex
ùù  "
)
ùù" #
;
ùù# $
}
úú 
finally
ûû 
{
üü 
m_fMainSync
ıı 
.
ıı 
set
ıı 
(
ıı  
)
ıı  !
;
ıı! "
}
şş 
}
ÿÿ 	
private
ƒƒ 
void
ƒƒ *
m_fSerial_SerialDataReceived
ƒƒ 1
(
ƒƒ1 2
object
„„ 
sender
„„ 
,
„„ *
FSerialDataReceivedEventArgs
…… (
e
……) *
)
†† 
{
‡‡ 	
byte
ˆˆ 
byteData
ˆˆ 
=
ˆˆ 
$num
ˆˆ 
;
ˆˆ 
int
‰‰ 

needLength
‰‰ 
=
‰‰ 
$num
‰‰ 
;
‰‰ 
int
ŠŠ 

copyLength
ŠŠ 
=
ŠŠ 
$num
ŠŠ 
;
ŠŠ 
FResultCode
‹‹ 
fResult
‹‹ 
=
‹‹  !
FResultCode
‹‹" -
.
‹‹- .
Success
‹‹. 5
;
‹‹5 6
string
ŒŒ 
errorMessage
ŒŒ 
=
ŒŒ  !
string
ŒŒ" (
.
ŒŒ( )
Empty
ŒŒ) .
;
ŒŒ. /

FSecsBlock
 

fSecsBlock
 !
=
" #
null
$ (
;
( )
FSecsDataMessage
 
fSecsDataMessage
 -
=
. /
null
0 4
;
4 5
try
 
{
‘‘ 
m_fMainSync
’’ 
.
’’ 
wait
’’  
(
’’  !
)
’’! "
;
’’" #

m_fRecvBuf
–– 
.
–– 
input
––  
(
––  !
e
––! "
.
––" #
data
––# '
)
––' (
;
––( )
while
˜˜ 
(
˜˜ 

m_fRecvBuf
˜˜ !
.
˜˜! "
length
˜˜" (
>
˜˜) *
$num
˜˜+ ,
)
˜˜, -
{
™™ 
if
šš 
(
šš 
m_fRecvState
šš $
==
šš% '
FSecs1RecvState
šš( 7
.
šš7 8
Enq
šš8 ;
)
šš; <
{
›› "
procSecs1ErrorRaised
¡¡ ,
(
¡¡, -
string
¡¡- 3
.
¡¡3 4
Format
¡¡4 :
(
¡¡: ;

FConstants
¡¡; E
.
¡¡E F
err_m_16001
¡¡F Q
,
¡¡Q R

m_fRecvBuf
¡¡S ]
.
¡¡] ^
output
¡¡^ d
(
¡¡d e
)
¡¡e f
)
¡¡f g
)
¡¡g h
;
¡¡h i
}
¤¤ 
else
¥¥ 
if
¥¥ 
(
¥¥ 
m_fRecvState
¥¥ )
==
¥¥* ,
FSecs1RecvState
¥¥- <
.
¥¥< =
Eot
¥¥= @
)
¥¥@ A
{
¦¦ 
if
©© 
(
©© 
m_fRecvBlock
©© (
==
©©) +
null
©©, 0
)
©©0 1
{
ªª 
byteData
®® $
=
®®% &

m_fRecvBuf
®®' 1
.
®®1 2
output
®®2 8
(
®®8 9
)
®®9 :
;
®®: ;
if
°° 
(
°°  
byteData
°°  (
<
°°) *
$num
°°+ -
||
°°. 0
byteData
°°1 9
>
°°: ;
$num
°°< ?
)
°°? @
{
±± "
procSecs1ErrorRaised
µµ  4
(
µµ4 5
string
µµ5 ;
.
µµ; <
Format
µµ< B
(
µµB C

FConstants
µµC M
.
µµM N
err_m_16012
µµN Y
,
µµY Z
byteData
µµ[ c
)
µµc d
)
µµd e
;
µµe f
continue
¶¶  (
;
¶¶( )
}
·· 
else
¸¸  
{
¹¹ 
m_fTmrT2
½½  (
.
½½( )
stop
½½) -
(
½½- .
)
½½. /
;
½½/ 0
m_fRecvBlock
¿¿  ,
=
¿¿- .
new
¿¿/ 2
FSecs1RecvBlock
¿¿3 B
(
¿¿B C
byteData
¿¿C K
)
¿¿K L
;
¿¿L M
}
ÀÀ 
}
ÁÁ 

needLength
ÈÈ "
=
ÈÈ# $
m_fRecvBlock
ÈÈ% 1
.
ÈÈ1 2!
calculateNeedLength
ÈÈ2 E
(
ÈÈE F
)
ÈÈF G
;
ÈÈG H
if
ÉÉ 
(
ÉÉ 

m_fRecvBuf
ÉÉ &
.
ÉÉ& '
length
ÉÉ' -
>
ÉÉ. /

needLength
ÉÉ0 :
)
ÉÉ: ;
{
ÊÊ 

copyLength
ËË &
=
ËË' (

needLength
ËË) 3
;
ËË3 4
}
ÌÌ 
else
ÍÍ 
{
ÎÎ 

copyLength
ÏÏ &
=
ÏÏ' (

m_fRecvBuf
ÏÏ) 3
.
ÏÏ3 4
length
ÏÏ4 :
;
ÏÏ: ;
}
ĞĞ 
m_fRecvBlock
ÑÑ $
.
ÑÑ$ %
input
ÑÑ% *
(
ÑÑ* +

m_fRecvBuf
ÑÑ+ 5
.
ÑÑ5 6
output
ÑÑ6 <
(
ÑÑ< =

copyLength
ÑÑ= G
)
ÑÑG H
)
ÑÑH I
;
ÑÑI J
m_fTmrT1
ØØ  
.
ØØ  !
stop
ØØ! %
(
ØØ% &
)
ØØ& '
;
ØØ' (
if
ßß 
(
ßß 
m_fRecvBlock
ßß (
.
ßß( )*
blockDataCollectionCompleted
ßß) E
)
ßßE F
{
àà 
m_fRecvBlock
ää (
.
ää( )
parse
ää) .
(
ää. /
)
ää/ 0
;
ää0 1
if
ëë 
(
ëë  
!
ëë  !
m_fRecvBlock
ëë! -
.
ëë- .
validateCheckSum
ëë. >
(
ëë> ?
)
ëë? @
)
ëë@ A
{
ìì 
fResult
íí  '
=
íí( )
FResultCode
íí* 5
.
íí5 6
Error
íí6 ;
;
íí; <
errorMessage
îî  ,
=
îî- .

FConstants
îî/ 9
.
îî9 :
err_m_16010
îî: E
;
îîE F
}
ïï 
else
ğğ  
if
ğğ! #
(
ğğ$ %
!
ğğ% &
m_fRecvBlock
ğğ& 2
.
ğğ2 3
validateRbit
ğğ3 ?
(
ğğ? @
m_fSecs1ToHsms
ğğ@ N
.
ğğN O
fSecs1Config
ğğO [
.
ğğ[ \
rbit
ğğ\ `
)
ğğ` a
)
ğğa b
{
ññ 
fResult
òò  '
=
òò( )
FResultCode
òò* 5
.
òò5 6
Error
òò6 ;
;
òò; <
errorMessage
óó  ,
=
óó- .
string
óó/ 5
.
óó5 6
Format
óó6 <
(
óó< =

FConstants
óó= G
.
óóG H

err_m_0061
óóH R
,
óóR S
$str
óóT [
,
óó[ \
$str
óó] d
)
óód e
;
óóe f
}
ôô 
else
õõ  
if
õõ! #
(
õõ$ %
!
õõ% &
m_fRecvBlock
õõ& 2
.
õõ2 3
validateSessionId
õõ3 D
(
õõD E
m_fSecs1ToHsms
õõE S
.
õõS T
fSecs1Config
õõT `
.
õõ` a
	sessionId
õõa j
)
õõj k
)
õõk l
{
öö 
fResult
÷÷  '
=
÷÷( )
FResultCode
÷÷* 5
.
÷÷5 6
Error
÷÷6 ;
;
÷÷; <
errorMessage
øø  ,
=
øø- .
string
øø/ 5
.
øø5 6
Format
øø6 <
(
øø< =

FConstants
øø= G
.
øøG H

err_m_0061
øøH R
,
øøR S
$str
øøT `
,
øø` a
$str
øøb i
)
øøi j
;
øøj k
}
ùù 
else
úú  
if
úú! #
(
úú$ %
!
úú% &
m_fRecvBlockList
úú& 6
.
úú6 7 
validateInterleave
úú7 I
(
úúI J
m_fRecvBlock
úúJ V
)
úúV W
)
úúW X
{
ûû 
fResult
üü  '
=
üü( )
FResultCode
üü* 5
.
üü5 6
Error
üü6 ;
;
üü; <
errorMessage
ıı  ,
=
ıı- .

FConstants
ıı/ 9
.
ıı9 :
err_m_16008
ıı: E
;
ııE F
}
şş 
else
ÿÿ  
if
ÿÿ! #
(
ÿÿ$ %
!
ÿÿ% &
m_fRecvBlockList
ÿÿ& 6
.
ÿÿ6 7
validateBlockNo
ÿÿ7 F
(
ÿÿF G
m_fRecvBlock
ÿÿG S
)
ÿÿS T
)
ÿÿT U
{
€€ 
fResult
  '
=
( )
FResultCode
* 5
.
5 6
Error
6 ;
;
; <
errorMessage
‚‚  ,
=
‚‚- .

FConstants
‚‚/ 9
.
‚‚9 :
err_m_16006
‚‚: E
;
‚‚E F
}
ƒƒ 
else
„„  
if
„„! #
(
„„$ %
!
„„% &
m_fRecvBlockList
„„& 6
.
„„6 7$
validateDuplidateBlock
„„7 M
(
„„M N
m_fRecvBlock
„„N Z
)
„„Z [
)
„„[ \
{
…… 
fResult
††  '
=
††( )
FResultCode
††* 5
.
††5 6
Error
††6 ;
;
††; <
errorMessage
‡‡  ,
=
‡‡- .

FConstants
‡‡/ 9
.
‡‡9 :
err_m_16005
‡‡: E
;
‡‡E F
}
ˆˆ 
else
‰‰  
{
ŠŠ 
fResult
‹‹  '
=
‹‹( )
FResultCode
‹‹* 5
.
‹‹5 6
Success
‹‹6 =
;
‹‹= >
}
ŒŒ 

fSecsBlock
 &
=
' (
new
) ,

FSecsBlock
- 7
(
7 8
m_fSecs1ToHsms
‘‘  .
,
‘‘. /
m_fRecvBlock
’’  ,
.
’’, -
length
’’- 3
,
’’3 4
m_fRecvBlock
““  ,
.
““, -
	blockData
““- 6
,
““6 7
m_fRecvBlock
””  ,
.
””, -
rbit
””- 1
,
””1 2
m_fRecvBlock
••  ,
.
••, -
	sessionId
••- 6
,
••6 7
m_fRecvBlock
––  ,
.
––, -
wbit
––- 1
,
––1 2
m_fRecvBlock
——  ,
.
——, -
stream
——- 3
,
——3 4
m_fRecvBlock
˜˜  ,
.
˜˜, -
function
˜˜- 5
,
˜˜5 6
m_fRecvBlock
™™  ,
.
™™, -
ebit
™™- 1
,
™™1 2
m_fRecvBlock
šš  ,
.
šš, -
blockNo
šš- 4
,
šš4 5
m_fRecvBlock
››  ,
.
››, -
systemBytes
››- 8
,
››8 9
m_fRecvBlock
œœ  ,
.
œœ, -
body
œœ- 1
,
œœ1 2
m_fRecvBlock
  ,
.
, -
checkSum
- 5
)
  !
;
! "
m_fSecs1ToHsms
   *
.
  * +
fEventPusher
  + 7
.
  7 8
pushSecs1Event
  8 F
(
  F G
new
¡¡  #*
FSecs1BlockReceivedEventArgs
¡¡$ @
(
¡¡@ A
m_fSecs1ToHsms
¡¡A O
,
¡¡O P
FEventId
¡¡Q Y
.
¡¡Y Z 
Secs1BlockReceived
¡¡Z l
,
¡¡l m
fResult
¡¡n u
,
¡¡u v
errorMessage¡¡w ƒ
,¡¡ƒ „

fSecsBlock¡¡… 
)¡¡ 
)
¢¢  !
;
¢¢! "
if
¦¦ 
(
¦¦  
fResult
¦¦  '
==
¦¦( *
FResultCode
¦¦+ 6
.
¦¦6 7
Success
¦¦7 >
)
¦¦> ?
{
§§ 
fSecsDataMessage
¨¨  0
=
¨¨1 2
m_fRecvBlockList
¨¨3 C
.
¨¨C D
addBlock
¨¨D L
(
¨¨L M
m_fRecvBlock
¨¨M Y
)
¨¨Y Z
;
¨¨Z [
sendHandshakeACK
ªª  0
(
ªª0 1
fSecsDataMessage
ªª1 A
)
ªªA B
;
ªªB C
}
«« 
else
¬¬  
{
­­ 
sendHandshakeNAK
®®  0
(
®®0 1
)
®®1 2
;
®®2 3
}
¯¯ 
m_fRecvBlock
°° (
=
°°) *
null
°°+ /
;
°°/ 0
}
±± 
else
²² 
{
³³ 
m_fTmrT1
·· $
.
··$ %
restart
··% ,
(
··, -
(
··- .
int
··. 1
)
··1 2
(
··2 3
m_fSecs1ToHsms
··3 A
.
··A B
fSecs1Config
··B N
.
··N O
	t1Timeout
··O X
*
··Y Z
$num
··[ _
)
··_ `
)
··` a
;
··a b
}
¸¸ 
}
»» 
else
¼¼ 
if
¼¼ 
(
¼¼ 
m_fSendState
¼¼ )
==
¼¼* ,
FSecs1SendState
¼¼- <
.
¼¼< =
Enq
¼¼= @
)
¼¼@ A
{
½½ 
byteData
ÀÀ  
=
ÀÀ! "

m_fRecvBuf
ÀÀ# -
.
ÀÀ- .
output
ÀÀ. 4
(
ÀÀ4 5
)
ÀÀ5 6
;
ÀÀ6 7
if
ÂÂ 
(
ÂÂ 
byteData
ÂÂ $
==
ÂÂ% '
(
ÂÂ( )
byte
ÂÂ) -
)
ÂÂ- .!
FSecs1HandshakeCode
ÂÂ. A
.
ÂÂA B
ENQ
ÂÂB E
)
ÂÂE F
{
ÃÃ 
m_fSecs1ToHsms
ÄÄ *
.
ÄÄ* +
fEventPusher
ÄÄ+ 7
.
ÄÄ7 8
pushSecs1Event
ÄÄ8 F
(
ÄÄF G
new
ÅÅ  #.
 FSecs1HandshakeReceivedEventArgs
ÅÅ$ D
(
ÅÅD E
m_fSecs1ToHsms
ÅÅE S
,
ÅÅS T
FEventId
ÅÅU ]
.
ÅÅ] ^$
Secs1HandshakeReceived
ÅÅ^ t
,
ÅÅt u
FResultCodeÅÅv 
.ÅÅ ‚
SuccessÅÅ‚ ‰
,ÅÅ‰ Š
stringÅÅ‹ ‘
.ÅÅ‘ ’
EmptyÅÅ’ —
,ÅÅ— ˜#
FSecs1HandshakeCodeÅÅ™ ¬
.ÅÅ¬ ­
ENQÅÅ­ °
)ÅÅ° ±
)
ÆÆ  !
;
ÆÆ! "
if
ÍÍ 
(
ÍÍ  
!
ÍÍ  !
m_fSecs1ToHsms
ÍÍ! /
.
ÍÍ/ 0
fSecs1Config
ÍÍ0 <
.
ÍÍ< =
rbit
ÍÍ= A
)
ÍÍA B
{
ÎÎ 
m_fTmrT2
ÒÒ  (
.
ÒÒ( )
stop
ÒÒ) -
(
ÒÒ- .
)
ÒÒ. /
;
ÒÒ/ 0
m_fSendState
ÙÙ  ,
=
ÙÙ- .
FSecs1SendState
ÙÙ/ >
.
ÙÙ> ?
	Completed
ÙÙ? H
;
ÙÙH I
m_fSendBlock
àà  ,
.
àà, -
isRetry
àà- 4
=
àà5 6
true
àà7 ;
;
àà; <
m_fRecvState
çç  ,
=
çç- .
FSecs1RecvState
çç/ >
.
çç> ?
Enq
çç? B
;
ççB C
sendHandshakeEOT
éé  0
(
éé0 1
)
éé1 2
;
éé2 3
}
êê 
}
ëë 
else
ìì 
if
ìì 
(
ìì  !
byteData
ìì! )
==
ìì* ,
(
ìì- .
byte
ìì. 2
)
ìì2 3!
FSecs1HandshakeCode
ìì3 F
.
ììF G
EOT
ììG J
)
ììJ K
{
íí 
m_fTmrT2
ññ $
.
ññ$ %
stop
ññ% )
(
ññ) *
)
ññ* +
;
ññ+ ,
m_fSendState
øø (
=
øø) *
FSecs1SendState
øø+ :
.
øø: ;
Eot
øø; >
;
øø> ?
m_fSecs1ToHsms
úú *
.
úú* +
fEventPusher
úú+ 7
.
úú7 8
pushSecs1Event
úú8 F
(
úúF G
new
ûû  #.
 FSecs1HandshakeReceivedEventArgs
ûû$ D
(
ûûD E
m_fSecs1ToHsms
ûûE S
,
ûûS T
FEventId
ûûU ]
.
ûû] ^$
Secs1HandshakeReceived
ûû^ t
,
ûût u
FResultCodeûûv 
.ûû ‚
Successûû‚ ‰
,ûû‰ Š
stringûû‹ ‘
.ûû‘ ’
Emptyûû’ —
,ûû— ˜#
FSecs1HandshakeCodeûû™ ¬
.ûû¬ ­
EOTûû­ °
)ûû° ±
)
üü  !
;
üü! "
	sendBlock
ıı %
(
ıı% &
)
ıı& '
;
ıı' (
}
şş 
else
ÿÿ 
{
€	€	 "
procSecs1ErrorRaised
		 0
(
		0 1
string
		1 7
.
		7 8
Format
		8 >
(
		> ?

FConstants
		? I
.
		I J
err_m_16001
		J U
,
		U V
byteData
		W _
)
		_ `
)
		` a
;
		a b
}
‚	‚	 
}
…	…	 
else
†	†	 
if
†	†	 
(
†	†	 
m_fSendState
†	†	 )
==
†	†	* ,
FSecs1SendState
†	†	- <
.
†	†	< =
Eot
†	†	= @
)
†	†	@ A
{
‡	‡	 
byteData
Š	Š	  
=
Š	Š	! "

m_fRecvBuf
Š	Š	# -
.
Š	Š	- .
output
Š	Š	. 4
(
Š	Š	4 5
)
Š	Š	5 6
;
Š	Š	6 7
if
Œ	Œ	 
(
Œ	Œ	 
byteData
Œ	Œ	 $
==
Œ	Œ	% '
(
Œ	Œ	( )
byte
Œ	Œ	) -
)
Œ	Œ	- .!
FSecs1HandshakeCode
Œ	Œ	. A
.
Œ	Œ	A B
ACK
Œ	Œ	B E
)
Œ	Œ	E F
{
		 
m_fTmrT2
‘	‘	 $
.
‘	‘	$ %
stop
‘	‘	% )
(
‘	‘	) *
)
‘	‘	* +
;
‘	‘	+ ,
m_fSendState
˜	˜	 (
=
˜	˜	) *
FSecs1SendState
˜	˜	+ :
.
˜	˜	: ;
	Completed
˜	˜	; D
;
˜	˜	D E
m_fSecs1ToHsms
š	š	 *
.
š	š	* +
fEventPusher
š	š	+ 7
.
š	š	7 8
pushSecs1Event
š	š	8 F
(
š	š	F G
new
›	›	  #.
 FSecs1HandshakeReceivedEventArgs
›	›	$ D
(
›	›	D E
m_fSecs1ToHsms
›	›	E S
,
›	›	S T
FEventId
›	›	U ]
.
›	›	] ^$
Secs1HandshakeReceived
›	›	^ t
,
›	›	t u
FResultCode›	›	v 
.›	›	 ‚
Success›	›	‚ ‰
,›	›	‰ Š
string›	›	‹ ‘
.›	›	‘ ’
Empty›	›	’ —
,›	›	— ˜#
FSecs1HandshakeCode›	›	™ ¬
.›	›	¬ ­
ACK›	›	­ °
)›	›	° ±
)
œ	œ	  !
;
œ	œ	! "
if
 	 	 
(
 	 	  
m_fSendBlock
 	 	  ,
.
 	 	, -

fBlockList
 	 	- 7
.
 	 	7 8
next
 	 	8 <
(
 	 	< =
)
 	 	= >
)
 	 	> ?
{
¡	¡	 
m_fSendBlock
¥	¥	  ,
=
¥	¥	- .
m_fSendBlock
¥	¥	/ ;
.
¥	¥	; <

fBlockList
¥	¥	< F
.
¥	¥	F G
fCurrentBlock
¥	¥	G T
;
¥	¥	T U
sendHandshakeENQ
¦	¦	  0
(
¦	¦	0 1
)
¦	¦	1 2
;
¦	¦	2 3
}
§	§	 
else
¨	¨	  
{
©	©	 
m_fSecs1ToHsms
­	­	  .
.
­	­	. /
fEventPusher
­	­	/ ;
.
­	­	; <
pushSecs1Event
­	­	< J
(
­	­	J K
new
®	®	$ ',
FSecs1DataMessageSentEventArgs
®	®	( F
(
®	®	F G
m_fSecs1ToHsms
®	®	G U
,
®	®	U V
FEventId
®	®	W _
.
®	®	_ `"
Secs1DataMessageSent
®	®	` t
,
®	®	t u
FResultCode®	®	v 
.®	®	 ‚
Success®	®	‚ ‰
,®	®	‰ Š
string®	®	‹ ‘
.®	®	‘ ’
Empty®	®	’ —
,®	®	— ˜
m_fSendBlock®	®	™ ¥
.®	®	¥ ¦

fBlockList®	®	¦ °
.®	®	° ± 
fSecsDataMessage®	®	± Á
)®	®	Á Â
)
¯	¯	$ %
;
¯	¯	% &
m_fSendBlock
°	°	  ,
=
°	°	- .
null
°	°	/ 3
;
°	°	3 4
}
±	±	 
}
²	²	 
else
³	³	 
if
³	³	 
(
³	³	  !
byteData
³	³	! )
==
³	³	* ,
(
³	³	- .
byte
³	³	. 2
)
³	³	2 3!
FSecs1HandshakeCode
³	³	3 F
.
³	³	F G
NAK
³	³	G J
)
³	³	J K
{
´	´	 
m_fTmrT2
¸	¸	 $
.
¸	¸	$ %
stop
¸	¸	% )
(
¸	¸	) *
)
¸	¸	* +
;
¸	¸	+ ,
m_fSecs1ToHsms
¼	¼	 *
.
¼	¼	* +
fEventPusher
¼	¼	+ 7
.
¼	¼	7 8
pushSecs1Event
¼	¼	8 F
(
¼	¼	F G
new
½	½	  #.
 FSecs1HandshakeReceivedEventArgs
½	½	$ D
(
½	½	D E
m_fSecs1ToHsms
½	½	E S
,
½	½	S T
FEventId
½	½	U ]
.
½	½	] ^$
Secs1HandshakeReceived
½	½	^ t
,
½	½	t u
FResultCode½	½	v 
.½	½	 ‚
Success½	½	‚ ‰
,½	½	‰ Š
string½	½	‹ ‘
.½	½	‘ ’
Empty½	½	’ —
,½	½	— ˜#
FSecs1HandshakeCode½	½	™ ¬
.½	½	¬ ­
NAK½	½	­ °
)½	½	° ±
)
¾	¾	  !
;
¾	¾	! "
retrySendBlock
Â	Â	 *
(
Â	Â	* +
)
Â	Â	+ ,
;
Â	Â	, -
}
Ã	Ã	 
else
Ä	Ä	 
{
Å	Å	 "
procSecs1ErrorRaised
Æ	Æ	 0
(
Æ	Æ	0 1
string
Æ	Æ	1 7
.
Æ	Æ	7 8
Format
Æ	Æ	8 >
(
Æ	Æ	> ?

FConstants
Æ	Æ	? I
.
Æ	Æ	I J
err_m_16001
Æ	Æ	J U
,
Æ	Æ	U V
byteData
Æ	Æ	W _
)
Æ	Æ	_ `
)
Æ	Æ	` a
;
Æ	Æ	a b
}
Ç	Ç	 
}
Ê	Ê	 
else
Ë	Ë	 
{
Ì	Ì	 
byteData
Ï	Ï	  
=
Ï	Ï	! "

m_fRecvBuf
Ï	Ï	# -
.
Ï	Ï	- .
output
Ï	Ï	. 4
(
Ï	Ï	4 5
)
Ï	Ï	5 6
;
Ï	Ï	6 7
if
Ñ	Ñ	 
(
Ñ	Ñ	 
byteData
Ñ	Ñ	 $
==
Ñ	Ñ	% '
(
Ñ	Ñ	( )
byte
Ñ	Ñ	) -
)
Ñ	Ñ	- .!
FSecs1HandshakeCode
Ñ	Ñ	. A
.
Ñ	Ñ	A B
ENQ
Ñ	Ñ	B E
)
Ñ	Ñ	E F
{
Ò	Ò	 
m_fRecvState
Ö	Ö	 (
=
Ö	Ö	) *
FSecs1RecvState
Ö	Ö	+ :
.
Ö	Ö	: ;
Enq
Ö	Ö	; >
;
Ö	Ö	> ?
m_fSecs1ToHsms
Ø	Ø	 *
.
Ø	Ø	* +
fEventPusher
Ø	Ø	+ 7
.
Ø	Ø	7 8
pushSecs1Event
Ø	Ø	8 F
(
Ø	Ø	F G
new
Ù	Ù	  #.
 FSecs1HandshakeReceivedEventArgs
Ù	Ù	$ D
(
Ù	Ù	D E
m_fSecs1ToHsms
Ù	Ù	E S
,
Ù	Ù	S T
FEventId
Ù	Ù	U ]
.
Ù	Ù	] ^$
Secs1HandshakeReceived
Ù	Ù	^ t
,
Ù	Ù	t u
FResultCodeÙ	Ù	v 
.Ù	Ù	 ‚
SuccessÙ	Ù	‚ ‰
,Ù	Ù	‰ Š
stringÙ	Ù	‹ ‘
.Ù	Ù	‘ ’
EmptyÙ	Ù	’ —
,Ù	Ù	— ˜#
FSecs1HandshakeCodeÙ	Ù	™ ¬
.Ù	Ù	¬ ­
ENQÙ	Ù	­ °
)Ù	Ù	° ±
)
Ú	Ú	  !
;
Ú	Ú	! "
sendHandshakeEOT
Û	Û	 ,
(
Û	Û	, -
)
Û	Û	- .
;
Û	Û	. /
}
Ü	Ü	 
else
İ	İ	 
{
Ş	Ş	 "
procSecs1ErrorRaised
ß	ß	 0
(
ß	ß	0 1
string
ß	ß	1 7
.
ß	ß	7 8
Format
ß	ß	8 >
(
ß	ß	> ?

FConstants
ß	ß	? I
.
ß	ß	I J
err_m_16001
ß	ß	J U
,
ß	ß	U V
byteData
ß	ß	W _
)
ß	ß	_ `
)
ß	ß	` a
;
ß	ß	a b
}
à	à	 
}
ã	ã	 
}
ä	ä	 
}
å	å	 
catch
æ	æ	 
(
æ	æ	 
	Exception
æ	æ	 
ex
æ	æ	 
)
æ	æ	  
{
ç	ç	 
FDebug
è	è	 
.
è	è	 
writeLog
è	è	 
(
è	è	  
ex
è	è	  "
)
è	è	" #
;
è	è	# $
}
é	é	 
finally
ê	ê	 
{
ë	ë	 

fSecsBlock
ì	ì	 
=
ì	ì	 
null
ì	ì	 !
;
ì	ì	! "
fSecsDataMessage
í	í	  
=
í	í	! "
null
í	í	# '
;
í	í	' (
m_fMainSync
ñ	ñ	 
.
ñ	ñ	 
set
ñ	ñ	 
(
ñ	ñ	  
)
ñ	ñ	  !
;
ñ	ñ	! "
}
ò	ò	 
}
ó	ó	 	
private
÷	÷	 
void
÷	÷	 &
m_fSerial_SerialDataSent
÷	÷	 -
(
÷	÷	- .
object
ø	ø	 
sender
ø	ø	 
,
ø	ø	 &
FSerialDataSentEventArgs
ù	ù	 $
e
ù	ù	% &
)
ú	ú	 
{
û	û	 	%
FSecs1HandshakeSendData
ü	ü	 #
fHandshakeData
ü	ü	$ 2
=
ü	ü	3 4
null
ü	ü	5 9
;
ü	ü	9 :
try
ş	ş	 
{
ÿ	ÿ	 
m_fMainSync
€
€
 
.
€
€
 
wait
€
€
  
(
€
€
  !
)
€
€
! "
;
€
€
" #
if
„
„
 
(
„
„
 
e
„
„
 
.
„
„
 
fData
„
„
 
.
„
„
 
state
„
„
 !
is
„
„
" $%
FSecs1HandshakeSendData
„
„
% <
)
„
„
< =
{
…
…
 
fHandshakeData
ˆ
ˆ
 "
=
ˆ
ˆ
# $
(
ˆ
ˆ
% &%
FSecs1HandshakeSendData
ˆ
ˆ
& =
)
ˆ
ˆ
= >
e
ˆ
ˆ
> ?
.
ˆ
ˆ
? @
fData
ˆ
ˆ
@ E
.
ˆ
ˆ
E F
state
ˆ
ˆ
F K
;
ˆ
ˆ
K L
if
Š
Š
 
(
Š
Š
 
fHandshakeData
Š
Š
 &
.
Š
Š
& '
fHandshakeCode
Š
Š
' 5
==
Š
Š
6 8!
FSecs1HandshakeCode
Š
Š
9 L
.
Š
Š
L M
ENQ
Š
Š
M P
)
Š
Š
P Q
{
‹
‹
 
m_fSecs1ToHsms


 &
.


& '
fEventPusher


' 3
.


3 4
pushSecs1Event


4 B
(


B C
new


 *
FSecs1HandshakeSentEventArgs


  <
(


< =
m_fSecs1ToHsms


= K
,


K L
FEventId


M U
.


U V 
Secs1HandshakeSent


V h
,


h i
FResultCode


j u
.


u v
Success


v }
,


} ~
string

 …
.

… †
Empty

† ‹
,

‹ Œ#
FSecs1HandshakeCode

  
.

  ¡
ENQ

¡ ¤
)

¤ ¥
)


 
;


 
}
“
“
 
else
”
”
 
if
”
”
 
(
”
”
 
fHandshakeData
”
”
 +
.
”
”
+ ,
fHandshakeCode
”
”
, :
==
”
”
; =!
FSecs1HandshakeCode
”
”
> Q
.
”
”
Q R
EOT
”
”
R U
)
”
”
U V
{
•
•
 
m_fSecs1ToHsms
˜
˜
 &
.
˜
˜
& '
fEventPusher
˜
˜
' 3
.
˜
˜
3 4
pushSecs1Event
˜
˜
4 B
(
˜
˜
B C
new
™
™
 *
FSecs1HandshakeSentEventArgs
™
™
  <
(
™
™
< =
m_fSecs1ToHsms
™
™
= K
,
™
™
K L
FEventId
™
™
M U
.
™
™
U V 
Secs1HandshakeSent
™
™
V h
,
™
™
h i
FResultCode
™
™
j u
.
™
™
u v
Success
™
™
v }
,
™
™
} ~
string™
™
 …
.™
™
… †
Empty™
™
† ‹
,™
™
‹ Œ#
FSecs1HandshakeCode™
™
  
.™
™
  ¡
EOT™
™
¡ ¤
)™
™
¤ ¥
)
š
š
 
;
š
š
 
}


 
else


 
if


 
(


 
fHandshakeData


 +
.


+ ,
fHandshakeCode


, :
==


; =!
FSecs1HandshakeCode


> Q
.


Q R
ACK


R U
)


U V
{
Ÿ
Ÿ
 
m_fSecs1ToHsms
¢
¢
 &
.
¢
¢
& '
fEventPusher
¢
¢
' 3
.
¢
¢
3 4
pushSecs1Event
¢
¢
4 B
(
¢
¢
B C
new
£
£
 *
FSecs1HandshakeSentEventArgs
£
£
  <
(
£
£
< =
m_fSecs1ToHsms
£
£
= K
,
£
£
K L
FEventId
£
£
M U
.
£
£
U V 
Secs1HandshakeSent
£
£
V h
,
£
£
h i
FResultCode
£
£
j u
.
£
£
u v
Success
£
£
v }
,
£
£
} ~
string£
£
 …
.£
£
… †
Empty£
£
† ‹
,£
£
‹ Œ#
FSecs1HandshakeCode£
£
  
.£
£
  ¡
ACK£
£
¡ ¤
)£
£
¤ ¥
)
¤
¤
 
;
¤
¤
 
if
¦
¦
 
(
¦
¦
 
fHandshakeData
¦
¦
 *
.
¦
¦
* +!
hasSecsDataMesssage
¦
¦
+ >
)
¦
¦
> ?
{
§
§
 
m_fSecs1ToHsms
¨
¨
 *
.
¨
¨
* +
fEventPusher
¨
¨
+ 7
.
¨
¨
7 8
pushSecs1Event
¨
¨
8 F
(
¨
¨
F G
new
©
©
  #0
"FSecs1DataMessageReceivedEventArgs
©
©
$ F
(
©
©
F G
m_fSecs1ToHsms
ª
ª
$ 2
,
ª
ª
2 3
FEventId
«
«
$ ,
.
«
«
, -&
Secs1DataMessageReceived
«
«
- E
,
«
«
E F
FResultCode
¬
¬
$ /
.
¬
¬
/ 0
Success
¬
¬
0 7
,
¬
¬
7 8
string
­
­
$ *
.
­
­
* +
Empty
­
­
+ 0
,
­
­
0 1
fHandshakeData
®
®
$ 2
.
®
®
2 3
fSecsDataMessage
®
®
3 C
)
¯
¯
$ %
)
°
°
  !
;
°
°
! "
if
´
´
 
(
´
´
  
m_fSecs1ToHsms
´
´
  .
.
´
´
. /,
isSecs1InterceptingDataMessage
´
´
/ M
(
´
´
M N
fHandshakeData
´
´
N \
.
´
´
\ ]
fSecsDataMessage
´
´
] m
.
´
´
m n
stream
´
´
n t
,
´
´
t u
fHandshakeData´
´
v „
.´
´
„ … 
fSecsDataMessage´
´
… •
.´
´
• –
function´
´
– 
)´
´
 Ÿ
)´
´
Ÿ  
{
µ
µ
 
m_fSecs1ToHsms
¶
¶
  .
.
¶
¶
. /
fEventPusher
¶
¶
/ ;
.
¶
¶
; <
pushSecs1Event
¶
¶
< J
(
¶
¶
J K
new
·
·
$ '<
.FSecs1InterceptingDataMessageReceivedEventArgs
·
·
( V
(
·
·
V W
m_fSecs1ToHsms
¸
¸
( 6
,
¸
¸
6 7
FEventId
¹
¹
( 0
.
¹
¹
0 12
$Secs1InterceptingDataMessageReceived
¹
¹
1 U
,
¹
¹
U V
FResultCode
º
º
( 3
.
º
º
3 4
Success
º
º
4 ;
,
º
º
; <
string
»
»
( .
.
»
»
. /
Empty
»
»
/ 4
,
»
»
4 5
fHandshakeData
¼
¼
( 6
.
¼
¼
6 7
fSecsDataMessage
¼
¼
7 G
)
½
½
( )
)
¾
¾
  !
;
¾
¾
! "
}
¿
¿
 
}
À
À
 
}
Ã
Ã
 
else
Ä
Ä
 
if
Ä
Ä
 
(
Ä
Ä
 
fHandshakeData
Ä
Ä
 +
.
Ä
Ä
+ ,
fHandshakeCode
Ä
Ä
, :
==
Ä
Ä
; =!
FSecs1HandshakeCode
Ä
Ä
> Q
.
Ä
Ä
Q R
NAK
Ä
Ä
R U
)
Ä
Ä
U V
{
Å
Å
 
m_fSecs1ToHsms
È
È
 &
.
È
È
& '
fEventPusher
È
È
' 3
.
È
È
3 4
pushSecs1Event
È
È
4 B
(
È
È
B C
new
É
É
 *
FSecs1HandshakeSentEventArgs
É
É
  <
(
É
É
< =
m_fSecs1ToHsms
É
É
= K
,
É
É
K L
FEventId
É
É
M U
.
É
É
U V 
Secs1HandshakeSent
É
É
V h
,
É
É
h i
FResultCode
É
É
j u
.
É
É
u v
Success
É
É
v }
,
É
É
} ~
stringÉ
É
 …
.É
É
… †
EmptyÉ
É
† ‹
,É
É
‹ Œ#
FSecs1HandshakeCodeÉ
É
  
.É
É
  ¡
NAKÉ
É
¡ ¤
)É
É
¤ ¥
)
Ê
Ê
 
;
Ê
Ê
 
}
Í
Í
 
}
Ğ
Ğ
 
else
Ñ
Ñ
 
if
Ñ
Ñ
 
(
Ñ
Ñ
 
e
Ñ
Ñ
 
.
Ñ
Ñ
 
fData
Ñ
Ñ
  
.
Ñ
Ñ
  !
state
Ñ
Ñ
! &
is
Ñ
Ñ
' )

FSecsBlock
Ñ
Ñ
* 4
)
Ñ
Ñ
4 5
{
Ò
Ò
 
m_fSecs1ToHsms
Õ
Õ
 "
.
Õ
Õ
" #
fEventPusher
Õ
Õ
# /
.
Õ
Õ
/ 0
pushSecs1Event
Õ
Õ
0 >
(
Õ
Õ
> ?
new
Ö
Ö
 &
FSecs1BlockSentEventArgs
Ö
Ö
 4
(
Ö
Ö
4 5
m_fSecs1ToHsms
Ö
Ö
5 C
,
Ö
Ö
C D
FEventId
Ö
Ö
E M
.
Ö
Ö
M N
Secs1BlockSent
Ö
Ö
N \
,
Ö
Ö
\ ]
FResultCode
Ö
Ö
^ i
.
Ö
Ö
i j
Success
Ö
Ö
j q
,
Ö
Ö
q r
string
Ö
Ö
s y
.
Ö
Ö
y z
Empty
Ö
Ö
z 
,Ö
Ö
 €
(Ö
Ö
 ‚

FSecsBlockÖ
Ö
‚ Œ
)Ö
Ö
Œ 
eÖ
Ö
 
.Ö
Ö
 
fDataÖ
Ö
 ”
.Ö
Ö
” •
stateÖ
Ö
• š
)Ö
Ö
š ›
)
×
×
 
;
×
×
 
}
Ú
Ú
 
}
Û
Û
 
catch
Ü
Ü
 
(
Ü
Ü
 
	Exception
Ü
Ü
 
ex
Ü
Ü
 
)
Ü
Ü
  
{
İ
İ
 
FDebug
Ş
Ş
 
.
Ş
Ş
 
writeLog
Ş
Ş
 
(
Ş
Ş
  
ex
Ş
Ş
  "
)
Ş
Ş
" #
;
Ş
Ş
# $
}
ß
ß
 
finally
à
à
 
{
á
á
 
fHandshakeData
â
â
 
=
â
â
  
null
â
â
! %
;
â
â
% &
m_fMainSync
æ
æ
 
.
æ
æ
 
set
æ
æ
 
(
æ
æ
  
)
æ
æ
  !
;
æ
æ
! "
}
ç
ç
 
}
è
è
 	
private
ì
ì
 
void
ì
ì
 ,
m_fSerial_SerialDataSendFailed
ì
ì
 3
(
ì
ì
3 4
object
í
í
 
sender
í
í
 
,
í
í
 ,
FSerialDataSendFailedEventArgs
î
î
 *
e
î
î
+ ,
)
ï
ï
 
{
ğ
ğ
 	%
FSecs1HandshakeSendData
ñ
ñ
 #
fHandshakeData
ñ
ñ
$ 2
=
ñ
ñ
3 4
null
ñ
ñ
5 9
;
ñ
ñ
9 :
try
ó
ó
 
{
ô
ô
 
m_fMainSync
õ
õ
 
.
õ
õ
 
wait
õ
õ
  
(
õ
õ
  !
)
õ
õ
! "
;
õ
õ
" #
if
ù
ù
 
(
ù
ù
 
e
ù
ù
 
.
ù
ù
 
fData
ù
ù
 
.
ù
ù
 
state
ù
ù
 !
is
ù
ù
" $%
FSecs1HandshakeSendData
ù
ù
% <
)
ù
ù
< =
{
ú
ú
 
fHandshakeData
ı
ı
 "
=
ı
ı
# $
(
ı
ı
% &%
FSecs1HandshakeSendData
ı
ı
& =
)
ı
ı
= >
e
ı
ı
> ?
.
ı
ı
? @
fData
ı
ı
@ E
.
ı
ı
E F
state
ı
ı
F K
;
ı
ı
K L
if
ÿ
ÿ
 
(
ÿ
ÿ
 
fHandshakeData
ÿ
ÿ
 &
.
ÿ
ÿ
& '
fHandshakeCode
ÿ
ÿ
' 5
==
ÿ
ÿ
6 8!
FSecs1HandshakeCode
ÿ
ÿ
9 L
.
ÿ
ÿ
L M
ENQ
ÿ
ÿ
M P
)
ÿ
ÿ
P Q
{
€€ 
m_fSecs1ToHsms
ƒƒ &
.
ƒƒ& '
fEventPusher
ƒƒ' 3
.
ƒƒ3 4
pushSecs1Event
ƒƒ4 B
(
ƒƒB C
new
„„ *
FSecs1HandshakeSentEventArgs
„„  <
(
„„< =
m_fSecs1ToHsms
„„= K
,
„„K L
FEventId
„„M U
.
„„U V 
Secs1HandshakeSent
„„V h
,
„„h i
FResultCode
„„j u
.
„„u v
Error
„„v {
,
„„{ |
e
„„} ~
.
„„~ 
message„„ †
,„„† ‡#
FSecs1HandshakeCode„„ˆ ›
.„„› œ
ENQ„„œ Ÿ
)„„Ÿ  
)
…… 
;
…… 
}
ˆˆ 
else
‰‰ 
if
‰‰ 
(
‰‰ 
fHandshakeData
‰‰ +
.
‰‰+ ,
fHandshakeCode
‰‰, :
==
‰‰; =!
FSecs1HandshakeCode
‰‰> Q
.
‰‰Q R
EOT
‰‰R U
)
‰‰U V
{
ŠŠ 
m_fSecs1ToHsms
 &
.
& '
fEventPusher
' 3
.
3 4
pushSecs1Event
4 B
(
B C
new
 *
FSecs1HandshakeSentEventArgs
  <
(
< =
m_fSecs1ToHsms
= K
,
K L
FEventId
M U
.
U V 
Secs1HandshakeSent
V h
,
h i
FResultCode
j u
.
u v
Error
v {
,
{ |
e
} ~
.
~ 
message †
,† ‡#
FSecs1HandshakeCodeˆ ›
.› œ
EOTœ Ÿ
)Ÿ  
)
 
;
 
}
’’ 
else
““ 
if
““ 
(
““ 
fHandshakeData
““ +
.
““+ ,
fHandshakeCode
““, :
==
““; =!
FSecs1HandshakeCode
““> Q
.
““Q R
ACK
““R U
)
““U V
{
”” 
m_fSecs1ToHsms
—— &
.
——& '
fEventPusher
——' 3
.
——3 4
pushSecs1Event
——4 B
(
——B C
new
˜˜ *
FSecs1HandshakeSentEventArgs
˜˜  <
(
˜˜< =
m_fSecs1ToHsms
˜˜= K
,
˜˜K L
FEventId
˜˜M U
.
˜˜U V 
Secs1HandshakeSent
˜˜V h
,
˜˜h i
FResultCode
˜˜j u
.
˜˜u v
Error
˜˜v {
,
˜˜{ |
e
˜˜} ~
.
˜˜~ 
message˜˜ †
,˜˜† ‡#
FSecs1HandshakeCode˜˜ˆ ›
.˜˜› œ
ACK˜˜œ Ÿ
)˜˜Ÿ  
)
™™ 
;
™™ 
if
›› 
(
›› 
fHandshakeData
›› *
.
››* +!
hasSecsDataMesssage
››+ >
)
››> ?
{
œœ 
m_fSecs1ToHsms
 *
.
* +
fEventPusher
+ 7
.
7 8
pushSecs1Event
8 F
(
F G
new
  #0
"FSecs1DataMessageReceivedEventArgs
$ F
(
F G
m_fSecs1ToHsms
G U
,
U V
FEventId
W _
.
_ `&
Secs1DataMessageReceived
` x
,
x y
FResultCodez …
.… †
Error† ‹
,‹ Œ
string “
.“ ”
Format” š
(š ›

FConstants› ¥
.¥ ¦

err_m_0062¦ °
,° ±
$str² ·
)· ¸
,¸ ¹
fHandshakeDataº È
.È É 
fSecsDataMessageÉ Ù
)Ù Ú
)
ŸŸ  !
;
ŸŸ! "
}
   
}
££ 
else
¤¤ 
if
¤¤ 
(
¤¤ 
fHandshakeData
¤¤ +
.
¤¤+ ,
fHandshakeCode
¤¤, :
==
¤¤; =!
FSecs1HandshakeCode
¤¤> Q
.
¤¤Q R
NAK
¤¤R U
)
¤¤U V
{
¥¥ 
m_fSecs1ToHsms
¨¨ &
.
¨¨& '
fEventPusher
¨¨' 3
.
¨¨3 4
pushSecs1Event
¨¨4 B
(
¨¨B C
new
©© *
FSecs1HandshakeSentEventArgs
©©  <
(
©©< =
m_fSecs1ToHsms
©©= K
,
©©K L
FEventId
©©M U
.
©©U V 
Secs1HandshakeSent
©©V h
,
©©h i
FResultCode
©©j u
.
©©u v
Error
©©v {
,
©©{ |
e
©©} ~
.
©©~ 
message©© †
,©©† ‡#
FSecs1HandshakeCode©©ˆ ›
.©©› œ
NAK©©œ Ÿ
)©©Ÿ  
)
ªª 
;
ªª 
}
­­ 
}
°° 
else
±± 
if
±± 
(
±± 
e
±± 
.
±± 
fData
±±  
.
±±  !
state
±±! &
is
±±' )

FSecsBlock
±±* 4
)
±±4 5
{
²² 
m_fSecs1ToHsms
µµ "
.
µµ" #
fEventPusher
µµ# /
.
µµ/ 0
pushSecs1Event
µµ0 >
(
µµ> ?
new
¶¶ &
FSecs1BlockSentEventArgs
¶¶ 4
(
¶¶4 5
m_fSecs1ToHsms
¶¶5 C
,
¶¶C D
FEventId
¶¶E M
.
¶¶M N
Secs1BlockSent
¶¶N \
,
¶¶\ ]
FResultCode
¶¶^ i
.
¶¶i j
Error
¶¶j o
,
¶¶o p
e
¶¶q r
.
¶¶r s
message
¶¶s z
,
¶¶z {
(
¶¶| }

FSecsBlock¶¶} ‡
)¶¶‡ ˆ
e¶¶ˆ ‰
.¶¶‰ Š
fData¶¶Š 
.¶¶ 
state¶¶ •
)¶¶• –
)
·· 
;
·· 
}
¾¾ 
}
¿¿ 
catch
ÀÀ 
(
ÀÀ 
	Exception
ÀÀ 
ex
ÀÀ 
)
ÀÀ  
{
ÁÁ 
FDebug
ÂÂ 
.
ÂÂ 
writeLog
ÂÂ 
(
ÂÂ  
ex
ÂÂ  "
)
ÂÂ" #
;
ÂÂ# $
}
ÃÃ 
finally
ÄÄ 
{
ÅÅ 
m_fMainSync
ÆÆ 
.
ÆÆ 
set
ÆÆ 
(
ÆÆ  
)
ÆÆ  !
;
ÆÆ! "
}
ÇÇ 
}
ÈÈ 	
private
ÌÌ 
void
ÌÌ )
m_fSerial_SerialErrorRaised
ÌÌ 0
(
ÌÌ0 1
object
ÍÍ 
sender
ÍÍ 
,
ÍÍ )
FSerialErrorRaisedEventArgs
ÎÎ '
e
ÎÎ( )
)
ÏÏ 
{
ĞĞ 	
try
ÑÑ 
{
ÒÒ "
procSecs1ErrorRaised
ÓÓ $
(
ÓÓ$ %
e
ÓÓ% &
.
ÓÓ& '
	exception
ÓÓ' 0
)
ÓÓ0 1
;
ÓÓ1 2
}
ÔÔ 
catch
ÕÕ 
(
ÕÕ 
	Exception
ÕÕ 
ex
ÕÕ 
)
ÕÕ  
{
ÖÖ 
FDebug
×× 
.
×× 
writeLog
×× 
(
××  
ex
××  "
)
××" #
;
××# $
}
ØØ 
finally
ÙÙ 
{
ÚÚ 
}
ÜÜ 
}
İİ 	
}
ãã 
}ää Á+
D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Protocol\SECS1\c_FSecs1RecvBuffer.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
internal 
class 
FSecs1RecvBuffer #
:# $
IDisposable% 0
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
List 
< 
byte 
> 
m_data !
=" #
null$ (
;( )
public"" 
FSecs1RecvBuffer"" 
(""  
)## 
{$$ 	
m_data%% 
=%% 
new%% 
List%% 
<%% 
byte%% "
>%%" #
(%%# $
)%%$ %
;%%% &
}&& 	
~** 	
FSecs1RecvBuffer**	 
(** 
)++ 
{,, 	
	myDispose-- 
(-- 
false-- 
)-- 
;-- 
}.. 	
	protected22 
void22 
	myDispose22  
(22  !
bool33 
	disposing33 
)44 
{55 	
if66 
(66 
!66 

m_disposed66 
)66 
{77 
if88 
(88 
	disposing88 
)88 
{99 
m_data:: 
=:: 
null:: !
;::! "
};; 

m_disposed== 
=== 
true== !
;==! "
}>> 
}?? 	
publicGG 
voidGG 
DisposeGG 
(GG 
)HH 
{II 	
	myDisposeJJ 
(JJ 
trueJJ 
)JJ 
;JJ 
GCKK 
.KK 
SuppressFinalizeKK 
(KK  
thisKK  $
)KK$ %
;KK% &
}LL 	
publicTT 
intTT 
lengthTT 
{UU 	
getVV 
{WW 
tryXX 
{YY 
returnZZ 
m_dataZZ !
.ZZ! "
CountZZ" '
;ZZ' (
}[[ 
catch\\ 
(\\ 
	Exception\\  
ex\\! #
)\\# $
{]] 
FDebug^^ 
.^^ 
throwException^^ )
(^^) *
ex^^* ,
)^^, -
;^^- .
}__ 
finally`` 
{aa 
}cc 
returndd 
$numdd 
;dd 
}ee 
}ff 	
publicnn 
voidnn 
inputnn 
(nn 
byteoo 
[oo 
]oo 
dataoo 
)pp 
{qq 	
tryrr 
{ss 
m_datatt 
.tt 
AddRangett 
(tt  
datatt  $
)tt$ %
;tt% &
}uu 
catchvv 
(vv 
	Exceptionvv 
exvv 
)vv  
{ww 
FDebugxx 
.xx 
throwExceptionxx %
(xx% &
exxx& (
)xx( )
;xx) *
}yy 
finallyzz 
{{{ 
}}} 
}~~ 	
public
‚‚ 
byte
‚‚ 
output
‚‚ 
(
‚‚ 
)
ƒƒ 
{
„„ 	
byte
…… 
data
…… 
=
…… 
$num
…… 
;
…… 
try
‡‡ 
{
ˆˆ 
data
‰‰ 
=
‰‰ 
m_data
‰‰ 
[
‰‰ 
$num
‰‰ 
]
‰‰  
;
‰‰  !
m_data
ŠŠ 
.
ŠŠ 
RemoveAt
ŠŠ 
(
ŠŠ  
$num
ŠŠ  !
)
ŠŠ! "
;
ŠŠ" #
return
ŒŒ 
data
ŒŒ 
;
ŒŒ 
}
 
catch
 
(
 
	Exception
 
ex
 
)
  
{
 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
‘‘ 
finally
’’ 
{
““ 
}
•• 
return
–– 
$num
–– 
;
–– 
}
—— 	
public
›› 
byte
›› 
[
›› 
]
›› 
output
›› 
(
›› 
int
œœ 
length
œœ 
)
 
{
 	
byte
ŸŸ 
[
ŸŸ 
]
ŸŸ 
data
ŸŸ 
=
ŸŸ 
null
ŸŸ 
;
ŸŸ 
try
¡¡ 
{
¢¢ 
data
££ 
=
££ 
m_data
££ 
.
££ 
GetRange
££ &
(
££& '
$num
££' (
,
££( )
length
££* 0
)
££0 1
.
££1 2
ToArray
££2 9
(
££9 :
)
££: ;
;
££; <
m_data
¤¤ 
.
¤¤ 
RemoveRange
¤¤ "
(
¤¤" #
$num
¤¤# $
,
¤¤$ %
length
¤¤& ,
)
¤¤, -
;
¤¤- .
return
¦¦ 
data
¦¦ 
;
¦¦ 
}
§§ 
catch
¨¨ 
(
¨¨ 
	Exception
¨¨ 
ex
¨¨ 
)
¨¨  
{
©© 
FDebug
ªª 
.
ªª 
throwException
ªª %
(
ªª% &
ex
ªª& (
)
ªª( )
;
ªª) *
}
«« 
finally
¬¬ 
{
­­ 
}
¯¯ 
return
°° 
null
°° 
;
°° 
}
±± 	
}
·· 
}¸¸ Û+
†D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Protocol\SECS1\c_FSecs1HandshakeSendData.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
internal 
class #
FSecs1HandshakeSendData *
:* +
IDisposable, 7
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FSecs1HandshakeCode #
m_fHandshakeCode$ 4
=5 6
FSecs1HandshakeCode7 J
.J K
ENQK N
;N O
private 
FSecsDataMessage  
m_fSecsDataMessage! 3
=4 5
null6 :
;: ;
public## #
FSecs1HandshakeSendData## &
(##& '
FSecs1HandshakeCode$$ 
fHandshakeCode$$  .
)%% 
{&& 	
m_fHandshakeCode'' 
='' 
fHandshakeCode'' -
;''- .
}(( 	
public,, #
FSecs1HandshakeSendData,, &
(,,& '
FSecs1HandshakeCode-- 
fHandshakeCode--  .
,--. /
FSecsDataMessage.. 
fSecsDataMessage.. -
)// 
{00 	
m_fHandshakeCode11 
=11 
fHandshakeCode11 -
;11- .
m_fSecsDataMessage22 
=22  
fSecsDataMessage22! 1
;221 2
}33 	
~77 	#
FSecs1HandshakeSendData77	  
(77  !
)88 
{99 	
	myDispose:: 
(:: 
false:: 
):: 
;:: 
};; 	
	protected?? 
void?? 
	myDispose??  
(??  !
bool@@ 
	disposing@@ 
)AA 
{BB 	
ifCC 
(CC 
!CC 

m_disposedCC 
)CC 
{DD 
ifEE 
(EE 
	disposingEE 
)EE 
{FF 
m_fSecsDataMessageGG &
=GG' (
nullGG) -
;GG- .
}HH 

m_disposedJJ 
=JJ 
trueJJ !
;JJ! "
}KK 
}LL 	
publicTT 
voidTT 
DisposeTT 
(TT 
)UU 
{VV 	
	myDisposeWW 
(WW 
trueWW 
)WW 
;WW 
GCXX 
.XX 
SuppressFinalizeXX 
(XX  
thisXX  $
)XX$ %
;XX% &
}YY 	
publicaa 
FSecs1HandshakeCodeaa "
fHandshakeCodeaa# 1
{bb 	
getcc 
{dd 
tryee 
{ff 
returngg 
m_fHandshakeCodegg +
;gg+ ,
}hh 
catchii 
(ii 
	Exceptionii  
exii! #
)ii# $
{jj 
FDebugkk 
.kk 
throwExceptionkk )
(kk) *
exkk* ,
)kk, -
;kk- .
}ll 
finallymm 
{nn 
}pp 
returnqq 
FSecs1HandshakeCodeqq *
.qq* +
ENQqq+ .
;qq. /
}rr 
}ss 	
publicww 
FSecsDataMessageww 
fSecsDataMessageww  0
{xx 	
getyy 
{zz 
try{{ 
{|| 
return}} 
m_fSecsDataMessage}} -
;}}- .
}~~ 
catch 
( 
	Exception  
ex! #
)# $
{
€€ 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
‚‚ 
finally
ƒƒ 
{
„„ 
}
†† 
return
‡‡ 
null
‡‡ 
;
‡‡ 
}
ˆˆ 
}
‰‰ 	
public
 
bool
 !
hasSecsDataMesssage
 '
{
 	
get
 
{
 
try
‘‘ 
{
’’ 
return
““  
m_fSecsDataMessage
““ -
==
““. 0
null
““1 5
?
““6 7
false
““8 =
:
““> ?
true
““@ D
;
““D E
}
”” 
catch
•• 
(
•• 
	Exception
••  
ex
••! #
)
••# $
{
–– 
FDebug
—— 
.
—— 
throwException
—— )
(
——) *
ex
——* ,
)
——, -
;
——- .
}
˜˜ 
finally
™™ 
{
šš 
}
œœ 
return
 
false
 
;
 
}
 
}
ŸŸ 	
public
§§ 
byte
§§ 
[
§§ 
]
§§ 
handshakeToBytes
§§ &
(
§§& '
)
¨¨ 
{
©© 	
try
ªª 
{
«« 
return
¬¬ 
new
¬¬ 
byte
¬¬ 
[
¬¬  
]
¬¬  !
{
¬¬" #
(
¬¬$ %
byte
¬¬% )
)
¬¬) *
m_fHandshakeCode
¬¬* :
}
¬¬; <
;
¬¬< =
}
­­ 
catch
®® 
(
®® 
	Exception
®® 
ex
®® 
)
®®  
{
¯¯ 
FDebug
°° 
.
°° 
throwException
°° %
(
°°% &
ex
°°& (
)
°°( )
;
°°) *
}
±± 
finally
²² 
{
³³ 
}
µµ 
return
¶¶ 
null
¶¶ 
;
¶¶ 
}
·· 	
}
½½ 
}¾¾ µ±
~D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Protocol\SECS1\c_FSecs1RecvBlock.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
internal 
class 
FSecs1RecvBlock "
:" #
IDisposable$ /
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
byte 
m_length 
= 
$num  !
;! "
private 
List 
< 
byte 
> 
m_blockData &
=' (
null) -
;- .
private 
bool 
m_rbit 
= 
false #
;# $
private   
UInt16   
m_sessionId   "
=  # $
$num  % &
;  & '
private!! 
bool!! 
m_wbit!! 
=!! 
false!! #
;!!# $
private"" 
byte"" 
m_stream"" 
="" 
$num""  !
;""! "
private## 
byte## 

m_function## 
=##  !
$num##" #
;### $
private$$ 
bool$$ 
m_ebit$$ 
=$$ 
false$$ #
;$$# $
private%% 
UInt16%% 
	m_blockNo%%  
=%%! "
$num%%# $
;%%$ %
private&& 
UInt32&& 
m_systemBytes&& $
=&&% &
$num&&' (
;&&( )
private'' 
List'' 
<'' 
byte'' 
>'' 
m_body'' !
=''" #
null''$ (
;''( )
private(( 
UInt16(( 

m_checkSum(( !
=((" #
$num(($ %
;((% &
public.. 
FSecs1RecvBlock.. 
(.. 
byte// 
length// 
)00 
{11 	
m_length22 
=22 
length22 
;22 
m_blockData33 
=33 
new33 
List33 "
<33" #
byte33# '
>33' (
(33( )
)33) *
;33* +
m_blockData44 
.44 
Add44 
(44 
m_length44 $
)44$ %
;44% &
}55 	
~99 	
FSecs1RecvBlock99	 
(99 
):: 
{;; 	
	myDispose<< 
(<< 
false<< 
)<< 
;<< 
}== 	
	protectedAA 
voidAA 
	myDisposeAA  
(AA  !
boolBB 
	disposingBB 
)CC 
{DD 	
ifEE 
(EE 
!EE 

m_disposedEE 
)EE 
{FF 
ifGG 
(GG 
	disposingGG 
)GG 
{HH 
m_blockDataII 
=II  !
nullII" &
;II& '
m_bodyJJ 
=JJ 
nullJJ !
;JJ! "
}KK 

m_disposedMM 
=MM 
trueMM !
;MM! "
}NN 
}OO 	
publicWW 
voidWW 
DisposeWW 
(WW 
)XX 
{YY 	
	myDisposeZZ 
(ZZ 
trueZZ 
)ZZ 
;ZZ 
GC[[ 
.[[ 
SuppressFinalize[[ 
([[  
this[[  $
)[[$ %
;[[% &
}\\ 	
publicdd 
bytedd 
lengthdd 
{ee 	
getff 
{gg 
tryhh 
{ii 
returnjj 
m_lengthjj #
;jj# $
}kk 
catchll 
(ll 
	Exceptionll  
exll! #
)ll# $
{mm 
FDebugnn 
.nn 
throwExceptionnn )
(nn) *
exnn* ,
)nn, -
;nn- .
}oo 
finallypp 
{qq 
}ss 
returntt 
$numtt 
;tt 
}uu 
}vv 	
publiczz 
bytezz 
[zz 
]zz 
	blockDatazz 
{{{ 	
get|| 
{}} 
try~~ 
{ 
return
€€ 
m_blockData
€€ &
.
€€& '
ToArray
€€' .
(
€€. /
)
€€/ 0
;
€€0 1
}
 
catch
‚‚ 
(
‚‚ 
	Exception
‚‚  
ex
‚‚! #
)
‚‚# $
{
ƒƒ 
FDebug
„„ 
.
„„ 
throwException
„„ )
(
„„) *
ex
„„* ,
)
„„, -
;
„„- .
}
…… 
finally
†† 
{
‡‡ 
}
‰‰ 
return
ŠŠ 
null
ŠŠ 
;
ŠŠ 
}
‹‹ 
}
ŒŒ 	
public
 
int
 
blockDataLength
 "
{
‘‘ 	
get
’’ 
{
““ 
try
”” 
{
•• 
return
–– 
m_blockData
–– &
.
––& '
Count
––' ,
;
––, -
}
—— 
catch
˜˜ 
(
˜˜ 
	Exception
˜˜  
ex
˜˜! #
)
˜˜# $
{
™™ 
FDebug
šš 
.
šš 
throwException
šš )
(
šš) *
ex
šš* ,
)
šš, -
;
šš- .
}
›› 
finally
œœ 
{
 
}
ŸŸ 
return
   
$num
   
;
   
}
¡¡ 
}
¢¢ 	
public
¦¦ 
bool
¦¦ *
blockDataCollectionCompleted
¦¦ 0
{
§§ 	
get
¨¨ 
{
©© 
try
ªª 
{
«« 
return
¬¬ 
this
¬¬ 
.
¬¬  !
calculateNeedLength
¬¬  3
(
¬¬3 4
)
¬¬4 5
==
¬¬6 8
$num
¬¬9 :
?
¬¬; <
true
¬¬= A
:
¬¬B C
false
¬¬D I
;
¬¬I J
}
­­ 
catch
®® 
(
®® 
	Exception
®®  
ex
®®! #
)
®®# $
{
¯¯ 
FDebug
°° 
.
°° 
throwException
°° )
(
°°) *
ex
°°* ,
)
°°, -
;
°°- .
}
±± 
finally
²² 
{
³³ 
}
µµ 
return
¶¶ 
false
¶¶ 
;
¶¶ 
}
·· 
}
¸¸ 	
public
¼¼ 
bool
¼¼ 
rbit
¼¼ 
{
½½ 	
get
¾¾ 
{
¿¿ 
try
ÀÀ 
{
ÁÁ 
return
ÂÂ 
m_rbit
ÂÂ !
;
ÂÂ! "
}
ÃÃ 
catch
ÄÄ 
(
ÄÄ 
	Exception
ÄÄ  
ex
ÄÄ! #
)
ÄÄ# $
{
ÅÅ 
FDebug
ÆÆ 
.
ÆÆ 
throwException
ÆÆ )
(
ÆÆ) *
ex
ÆÆ* ,
)
ÆÆ, -
;
ÆÆ- .
}
ÇÇ 
finally
ÈÈ 
{
ÉÉ 
}
ËË 
return
ÌÌ 
false
ÌÌ 
;
ÌÌ 
}
ÍÍ 
}
ÎÎ 	
public
ÒÒ 
UInt16
ÒÒ 
	sessionId
ÒÒ 
{
ÓÓ 	
get
ÔÔ 
{
ÕÕ 
try
ÖÖ 
{
×× 
return
ØØ 
m_sessionId
ØØ &
;
ØØ& '
}
ÙÙ 
catch
ÚÚ 
(
ÚÚ 
	Exception
ÚÚ  
ex
ÚÚ! #
)
ÚÚ# $
{
ÛÛ 
FDebug
ÜÜ 
.
ÜÜ 
throwException
ÜÜ )
(
ÜÜ) *
ex
ÜÜ* ,
)
ÜÜ, -
;
ÜÜ- .
}
İİ 
finally
ŞŞ 
{
ßß 
}
áá 
return
ââ 
$num
ââ 
;
ââ 
}
ãã 
}
ää 	
public
èè 
bool
èè 
wbit
èè 
{
éé 	
get
êê 
{
ëë 
try
ìì 
{
íí 
return
îî 
m_wbit
îî !
;
îî! "
}
ïï 
catch
ğğ 
(
ğğ 
	Exception
ğğ  
ex
ğğ! #
)
ğğ# $
{
ññ 
FDebug
òò 
.
òò 
throwException
òò )
(
òò) *
ex
òò* ,
)
òò, -
;
òò- .
}
óó 
finally
ôô 
{
õõ 
}
÷÷ 
return
øø 
false
øø 
;
øø 
}
ùù 
}
úú 	
public
şş 
byte
şş 
stream
şş 
{
ÿÿ 	
get
€€ 
{
 
try
‚‚ 
{
ƒƒ 
return
„„ 
m_stream
„„ #
;
„„# $
}
…… 
catch
†† 
(
†† 
	Exception
††  
ex
††! #
)
††# $
{
‡‡ 
FDebug
ˆˆ 
.
ˆˆ 
throwException
ˆˆ )
(
ˆˆ) *
ex
ˆˆ* ,
)
ˆˆ, -
;
ˆˆ- .
}
‰‰ 
finally
ŠŠ 
{
‹‹ 
}
 
return
 
$num
 
;
 
}
 
}
 	
public
”” 
byte
”” 
function
”” 
{
•• 	
get
–– 
{
—— 
try
˜˜ 
{
™™ 
return
šš 

m_function
šš %
;
šš% &
}
›› 
catch
œœ 
(
œœ 
	Exception
œœ  
ex
œœ! #
)
œœ# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
ŸŸ 
finally
   
{
¡¡ 
}
££ 
return
¤¤ 
$num
¤¤ 
;
¤¤ 
}
¥¥ 
}
¦¦ 	
public
ªª 
bool
ªª 
ebit
ªª 
{
«« 	
get
¬¬ 
{
­­ 
try
®® 
{
¯¯ 
return
°° 
m_ebit
°° !
;
°°! "
}
±± 
catch
²² 
(
²² 
	Exception
²²  
ex
²²! #
)
²²# $
{
³³ 
FDebug
´´ 
.
´´ 
throwException
´´ )
(
´´) *
ex
´´* ,
)
´´, -
;
´´- .
}
µµ 
finally
¶¶ 
{
·· 
}
¹¹ 
return
ºº 
false
ºº 
;
ºº 
}
»» 
}
¼¼ 	
public
ÀÀ 
UInt16
ÀÀ 
blockNo
ÀÀ 
{
ÁÁ 	
get
ÂÂ 
{
ÃÃ 
try
ÄÄ 
{
ÅÅ 
return
ÆÆ 
	m_blockNo
ÆÆ $
;
ÆÆ$ %
}
ÇÇ 
catch
ÈÈ 
(
ÈÈ 
	Exception
ÈÈ  
ex
ÈÈ! #
)
ÈÈ# $
{
ÉÉ 
FDebug
ÊÊ 
.
ÊÊ 
throwException
ÊÊ )
(
ÊÊ) *
ex
ÊÊ* ,
)
ÊÊ, -
;
ÊÊ- .
}
ËË 
finally
ÌÌ 
{
ÍÍ 
}
ÏÏ 
return
ĞĞ 
$num
ĞĞ 
;
ĞĞ 
}
ÑÑ 
}
ÒÒ 	
public
ÖÖ 
UInt32
ÖÖ 
systemBytes
ÖÖ !
{
×× 	
get
ØØ 
{
ÙÙ 
try
ÚÚ 
{
ÛÛ 
return
ÜÜ 
m_systemBytes
ÜÜ (
;
ÜÜ( )
}
İİ 
catch
ŞŞ 
(
ŞŞ 
	Exception
ŞŞ  
ex
ŞŞ! #
)
ŞŞ# $
{
ßß 
FDebug
àà 
.
àà 
throwException
àà )
(
àà) *
ex
àà* ,
)
àà, -
;
àà- .
}
áá 
finally
ââ 
{
ãã 
}
åå 
return
ææ 
$num
ææ 
;
ææ 
}
çç 
}
èè 	
public
ìì 
byte
ìì 
[
ìì 
]
ìì 
body
ìì 
{
íí 	
get
îî 
{
ïï 
try
ğğ 
{
ññ 
return
òò 
m_body
òò !
.
òò! "
ToArray
òò" )
(
òò) *
)
òò* +
;
òò+ ,
}
óó 
catch
ôô 
(
ôô 
	Exception
ôô  
ex
ôô! #
)
ôô# $
{
õõ 
FDebug
öö 
.
öö 
throwException
öö )
(
öö) *
ex
öö* ,
)
öö, -
;
öö- .
}
÷÷ 
finally
øø 
{
ùù 
}
ûû 
return
üü 
null
üü 
;
üü 
}
ıı 
}
şş 	
public
‚‚ 
UInt16
‚‚ 
checkSum
‚‚ 
{
ƒƒ 	
get
„„ 
{
…… 
try
†† 
{
‡‡ 
return
ˆˆ 

m_checkSum
ˆˆ %
;
ˆˆ% &
}
‰‰ 
catch
ŠŠ 
(
ŠŠ 
	Exception
ŠŠ  
ex
ŠŠ! #
)
ŠŠ# $
{
‹‹ 
FDebug
ŒŒ 
.
ŒŒ 
throwException
ŒŒ )
(
ŒŒ) *
ex
ŒŒ* ,
)
ŒŒ, -
;
ŒŒ- .
}
 
finally
 
{
 
}
‘‘ 
return
’’ 
$num
’’ 
;
’’ 
}
““ 
}
”” 	
public
œœ 
int
œœ !
calculateNeedLength
œœ &
(
œœ& '
)
 
{
 	
try
ŸŸ 
{
   
return
¡¡ 
this
¡¡ 
.
¡¡ 
length
¡¡ "
-
¡¡# $
this
¡¡% )
.
¡¡) *
blockDataLength
¡¡* 9
+
¡¡: ;
$num
¡¡< =
+
¡¡> ?
$num
¡¡@ A
;
¡¡A B
}
¢¢ 
catch
££ 
(
££ 
	Exception
££ 
ex
££ 
)
££  
{
¤¤ 
FDebug
¥¥ 
.
¥¥ 
throwException
¥¥ %
(
¥¥% &
ex
¥¥& (
)
¥¥( )
;
¥¥) *
}
¦¦ 
finally
§§ 
{
¨¨ 
}
ªª 
return
«« 
$num
«« 
;
«« 
}
¬¬ 	
public
°° 
void
°° 
input
°° 
(
°° 
byte
±± 
[
±± 
]
±± 
	blockData
±± 
)
²² 
{
³³ 	
try
´´ 
{
µµ 
m_blockData
¶¶ 
.
¶¶ 
AddRange
¶¶ $
(
¶¶$ %
	blockData
¶¶% .
)
¶¶. /
;
¶¶/ 0
}
·· 
catch
¸¸ 
(
¸¸ 
	Exception
¸¸ 
ex
¸¸ 
)
¸¸  
{
¹¹ 
FDebug
ºº 
.
ºº 
throwException
ºº %
(
ºº% &
ex
ºº& (
)
ºº( )
;
ºº) *
}
»» 
finally
¼¼ 
{
½½ 
}
¿¿ 
}
ÀÀ 	
public
ÄÄ 
void
ÄÄ 
parse
ÄÄ 
(
ÄÄ 
)
ÅÅ 
{
ÆÆ 	
try
ÇÇ 
{
ÈÈ 
m_rbit
ÉÉ 
=
ÉÉ 
(
ÉÉ 
m_blockData
ÉÉ %
[
ÉÉ% &
$num
ÉÉ& '
]
ÉÉ' (
&
ÉÉ) *
$num
ÉÉ+ /
)
ÉÉ/ 0
==
ÉÉ1 3
$num
ÉÉ4 5
?
ÉÉ6 7
false
ÉÉ8 =
:
ÉÉ> ?
true
ÉÉ@ D
;
ÉÉD E
m_sessionId
ÊÊ 
=
ÊÊ 
BitConverter
ÊÊ *
.
ÊÊ* +
ToUInt16
ÊÊ+ 3
(
ÊÊ3 4
new
ÊÊ4 7
byte
ÊÊ8 <
[
ÊÊ< =
]
ÊÊ= >
{
ÊÊ? @
m_blockData
ÊÊA L
[
ÊÊL M
$num
ÊÊM N
]
ÊÊN O
,
ÊÊO P
(
ÊÊQ R
byte
ÊÊR V
)
ÊÊV W
(
ÊÊW X
m_blockData
ÊÊX c
[
ÊÊc d
$num
ÊÊd e
]
ÊÊe f
&
ÊÊg h
$num
ÊÊi m
)
ÊÊm n
}
ÊÊo p
,
ÊÊp q
$num
ÊÊr s
)
ÊÊs t
;
ÊÊt u
m_wbit
ËË 
=
ËË 
(
ËË 
m_blockData
ËË %
[
ËË% &
$num
ËË& '
]
ËË' (
&
ËË) *
$num
ËË+ /
)
ËË/ 0
==
ËË1 3
$num
ËË4 5
?
ËË6 7
false
ËË8 =
:
ËË> ?
true
ËË@ D
;
ËËD E
m_stream
ÌÌ 
=
ÌÌ 
(
ÌÌ 
byte
ÌÌ  
)
ÌÌ  !
(
ÌÌ! "
m_blockData
ÌÌ" -
[
ÌÌ- .
$num
ÌÌ. /
]
ÌÌ/ 0
&
ÌÌ1 2
$num
ÌÌ3 7
)
ÌÌ7 8
;
ÌÌ8 9

m_function
ÍÍ 
=
ÍÍ 
m_blockData
ÍÍ (
[
ÍÍ( )
$num
ÍÍ) *
]
ÍÍ* +
;
ÍÍ+ ,
m_ebit
ÎÎ 
=
ÎÎ 
(
ÎÎ 
m_blockData
ÎÎ %
[
ÎÎ% &
$num
ÎÎ& '
]
ÎÎ' (
&
ÎÎ) *
$num
ÎÎ+ /
)
ÎÎ/ 0
==
ÎÎ1 3
$num
ÎÎ4 5
?
ÎÎ6 7
false
ÎÎ8 =
:
ÎÎ> ?
true
ÎÎ@ D
;
ÎÎD E
	m_blockNo
ÏÏ 
=
ÏÏ 
BitConverter
ÏÏ (
.
ÏÏ( )
ToUInt16
ÏÏ) 1
(
ÏÏ1 2
new
ÏÏ2 5
byte
ÏÏ6 :
[
ÏÏ: ;
]
ÏÏ; <
{
ÏÏ= >
m_blockData
ÏÏ? J
[
ÏÏJ K
$num
ÏÏK L
]
ÏÏL M
,
ÏÏM N
(
ÏÏO P
byte
ÏÏP T
)
ÏÏT U
(
ÏÏU V
m_blockData
ÏÏV a
[
ÏÏa b
$num
ÏÏb c
]
ÏÏc d
&
ÏÏe f
$num
ÏÏg k
)
ÏÏk l
}
ÏÏm n
,
ÏÏn o
$num
ÏÏp q
)
ÏÏq r
;
ÏÏr s
m_systemBytes
ĞĞ 
=
ĞĞ 
BitConverter
ĞĞ  ,
.
ĞĞ, -
ToUInt32
ĞĞ- 5
(
ĞĞ5 6
new
ĞĞ6 9
byte
ĞĞ: >
[
ĞĞ> ?
]
ĞĞ? @
{
ĞĞA B
m_blockData
ĞĞC N
[
ĞĞN O
$num
ĞĞO Q
]
ĞĞQ R
,
ĞĞR S
m_blockData
ĞĞT _
[
ĞĞ_ `
$num
ĞĞ` a
]
ĞĞa b
,
ĞĞb c
m_blockData
ĞĞd o
[
ĞĞo p
$num
ĞĞp q
]
ĞĞq r
,
ĞĞr s
m_blockData
ĞĞt 
[ĞĞ €
$numĞĞ€ 
]ĞĞ ‚
}ĞĞƒ „
,ĞĞ„ …
$numĞĞ† ‡
)ĞĞ‡ ˆ
;ĞĞˆ ‰
m_body
ÒÒ 
=
ÒÒ 
new
ÒÒ 
List
ÒÒ !
<
ÒÒ! "
byte
ÒÒ" &
>
ÒÒ& '
(
ÒÒ' (
)
ÒÒ( )
;
ÒÒ) *
if
ÓÓ 
(
ÓÓ 
length
ÓÓ 
>
ÓÓ 
$num
ÓÓ 
)
ÓÓ  
{
ÔÔ 
m_body
ÕÕ 
.
ÕÕ 
AddRange
ÕÕ #
(
ÕÕ# $
m_blockData
ÕÕ$ /
.
ÕÕ/ 0
GetRange
ÕÕ0 8
(
ÕÕ8 9
$num
ÕÕ9 ;
,
ÕÕ; <
length
ÕÕ= C
-
ÕÕD E
$num
ÕÕF H
)
ÕÕH I
)
ÕÕI J
;
ÕÕJ K
}
ÖÖ 

m_checkSum
ØØ 
=
ØØ 
BitConverter
ØØ )
.
ØØ) *
ToUInt16
ØØ* 2
(
ØØ2 3
new
ØØ3 6
byte
ØØ7 ;
[
ØØ; <
]
ØØ< =
{
ØØ> ?
m_blockData
ØØ@ K
[
ØØK L
m_length
ØØL T
+
ØØU V
$num
ØØW X
]
ØØX Y
,
ØØY Z
m_blockData
ØØ[ f
[
ØØf g
m_length
ØØg o
+
ØØp q
$num
ØØr s
]
ØØs t
}
ØØu v
,
ØØv w
$num
ØØx y
)
ØØy z
;
ØØz {
}
ÙÙ 
catch
ÚÚ 
(
ÚÚ 
	Exception
ÚÚ 
ex
ÚÚ 
)
ÚÚ  
{
ÛÛ 
FDebug
ÜÜ 
.
ÜÜ 
throwException
ÜÜ %
(
ÜÜ% &
ex
ÜÜ& (
)
ÜÜ( )
;
ÜÜ) *
}
İİ 
finally
ŞŞ 
{
ßß 
}
áá 
}
ââ 	
public
ææ 
bool
ææ 
validateCheckSum
ææ $
(
ææ$ %
)
çç 
{
èè 	
UInt16
éé 
sum
éé 
=
éé 
$num
éé 
;
éé 
try
ëë 
{
ìì 
for
íí 
(
íí 
int
íí 
i
íí 
=
íí 
$num
íí 
;
íí 
i
íí  !
<
íí" #
m_blockData
íí$ /
.
íí/ 0
Count
íí0 5
-
íí6 7
$num
íí8 9
;
íí9 :
i
íí; <
++
íí< >
)
íí> ?
{
îî 
sum
ïï 
+=
ïï 
m_blockData
ïï &
[
ïï& '
i
ïï' (
]
ïï( )
;
ïï) *
}
ğğ 
return
ññ 
sum
ññ 
==
ññ 

m_checkSum
ññ (
?
ññ) *
true
ññ+ /
:
ññ0 1
false
ññ2 7
;
ññ7 8
}
òò 
catch
óó 
(
óó 
	Exception
óó 
ex
óó 
)
óó  
{
ôô 
FDebug
õõ 
.
õõ 
throwException
õõ %
(
õõ% &
ex
õõ& (
)
õõ( )
;
õõ) *
}
öö 
finally
÷÷ 
{
øø 
}
úú 
return
ûû 
false
ûû 
;
ûû 
}
üü 	
public
€€ 
bool
€€ 
validateRbit
€€  
(
€€  !
bool
 
rbit
 
)
‚‚ 
{
ƒƒ 	
try
„„ 
{
…… 
return
†† 
m_rbit
†† 
==
††  
rbit
††! %
?
††& '
false
††( -
:
††. /
true
††0 4
;
††4 5
}
‡‡ 
catch
ˆˆ 
(
ˆˆ 
	Exception
ˆˆ 
ex
ˆˆ 
)
ˆˆ  
{
‰‰ 
FDebug
ŠŠ 
.
ŠŠ 
throwException
ŠŠ %
(
ŠŠ% &
ex
ŠŠ& (
)
ŠŠ( )
;
ŠŠ) *
}
‹‹ 
finally
ŒŒ 
{
 
}
 
return
 
false
 
;
 
}
‘‘ 	
public
•• 
bool
•• 
validateSessionId
•• %
(
••% &
UInt16
••& ,
	sessionId
••- 6
)
••6 7
{
–– 	
try
—— 
{
˜˜ 
return
™™ 
m_sessionId
™™ "
==
™™# %
	sessionId
™™& /
?
™™0 1
true
™™2 6
:
™™7 8
false
™™9 >
;
™™> ?
}
šš 
catch
›› 
(
›› 
	Exception
›› 
ex
›› 
)
››  
{
œœ 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
ŸŸ 
{
   
}
¢¢ 
return
££ 
false
££ 
;
££ 
}
¤¤ 	
}
ªª 
}«« ®
‚D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Protocol\SECS1\c_FSecs1RecvBlockList.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
internal 
class 
FSecs1RecvBlockList &
:& '
IDisposable( 3
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FSecs1ToHsms 
m_fSecs1ToHsms +
=, -
null. 2
;2 3
private 

Dictionary 
< 
string !
,! "

Dictionary# -
<- .
UInt16. 4
,4 5
FSecs1RecvBlock6 E
>E F
>F G
m_fSecs1BlockListH Y
=Z [
null\ `
;` a
private 

Dictionary 
< 
string !
,! "
FStaticTimer# /
>/ 0
m_fTmrT4List1 =
=> ?
null@ D
;D E
public$$ 
FSecs1RecvBlockList$$ "
($$" #
FSecs1ToHsms%% 
fSecs1ToHsms%% %
)&& 
{'' 	
m_fSecs1ToHsms(( 
=(( 
fSecs1ToHsms(( )
;(() *
m_fSecs1BlockList)) 
=)) 
new))  #

Dictionary))$ .
<)). /
string))/ 5
,))5 6

Dictionary))7 A
<))A B
UInt16))B H
,))H I
FSecs1RecvBlock))J Y
>))Y Z
>))Z [
())[ \
)))\ ]
;))] ^
m_fTmrT4List** 
=** 
new** 

Dictionary** )
<**) *
string*** 0
,**0 1
FStaticTimer**2 >
>**> ?
(**? @
)**@ A
;**A B
}++ 	
~// 	
FSecs1RecvBlockList//	 
(// 
)00 
{11 	
	myDispose22 
(22 
false22 
)22 
;22 
}33 	
	protected77 
void77 
	myDispose77  
(77  !
bool88 
	disposing88 
)99 
{:: 	
if;; 
(;; 
!;; 

m_disposed;; 
);; 
{<< 
if== 
(== 
	disposing== 
)== 
{>> 
m_fSecs1ToHsms?? "
=??# $
null??% )
;??) *
m_fSecs1BlockList@@ %
=@@& '
null@@( ,
;@@, -
}AA 

m_disposedCC 
=CC 
trueCC !
;CC! "
}DD 
}EE 	
publicMM 
voidMM 
DisposeMM 
(MM 
)NN 
{OO 	
	myDisposePP 
(PP 
truePP 
)PP 
;PP 
GCQQ 
.QQ 
SuppressFinalizeQQ 
(QQ  
thisQQ  $
)QQ$ %
;QQ% &
}RR 	
private`` 
string`` 
makeKey`` 
(`` 
byteaa 
streamaa 
,aa 
bytebb 
functionbb 
,bb 
UInt32cc 
systemBytescc 
)dd 
{ee 	
stringff 
keyff 
=ff 
stringff 
.ff  
Emptyff  %
;ff% &
tryhh 
{ii 
ifjj 
(jj 
m_fSecs1ToHsmsjj "
.jj" #
fSecs1Configjj# /
.jj/ 0
ignoreSystemBytesjj0 A
)jjA B
{kk 
keyll 
=ll 
stringll  
.ll  !
Formatll! '
(ll' (
$strll( 1
,ll1 2
streamll3 9
.ll9 :
ToStringll: B
(llB C
)llC D
,llD E
functionllF N
.llN O
ToStringllO W
(llW X
)llX Y
)llY Z
;llZ [
}mm 
elsenn 
{oo 
keypp 
=pp 
stringpp  
.pp  !
Formatpp! '
(pp' (
$strpp( 5
,pp5 6
streampp7 =
.pp= >
ToStringpp> F
(ppF G
)ppG H
,ppH I
functionppJ R
.ppR S
ToStringppS [
(pp[ \
)pp\ ]
,pp] ^
systemBytespp_ j
.ppj k
ToStringppk s
(pps t
)ppt u
)ppu v
;ppv w
}qq 
returnss 
keyss 
;ss 
}tt 
catchuu 
(uu 
	Exceptionuu 
exuu 
)uu  
{vv 
FDebugww 
.ww 
throwExceptionww %
(ww% &
exww& (
)ww( )
;ww) *
}xx 
finallyyy 
{zz 
}|| 
return}} 
string}} 
.}} 
Empty}} 
;}}  
}~~ 	
public
‚‚ 
bool
‚‚  
validateInterleave
‚‚ &
(
‚‚& '
FSecs1RecvBlock
ƒƒ 

fRecvBlock
ƒƒ &
)
„„ 
{
…… 	
string
†† 
key
†† 
=
†† 
string
†† 
.
††  
Empty
††  %
;
††% &
try
ˆˆ 
{
‰‰ 
if
 
(
 
m_fSecs1ToHsms
 "
.
" #
fSecs1Config
# /
.
/ 0

interleave
0 :
)
: ;
{
 
return
 
true
 
;
  
}
 
if
—— 
(
—— 
m_fSecs1BlockList
—— %
.
——% &
Count
——& +
==
——, .
$num
——/ 0
)
——0 1
{
˜˜ 
return
™™ 
true
™™ 
;
™™  
}
šš 
key
¡¡ 
=
¡¡ 
makeKey
¡¡ 
(
¡¡ 

fRecvBlock
¡¡ (
.
¡¡( )
stream
¡¡) /
,
¡¡/ 0

fRecvBlock
¡¡1 ;
.
¡¡; <
function
¡¡< D
,
¡¡D E

fRecvBlock
¡¡F P
.
¡¡P Q
systemBytes
¡¡Q \
)
¡¡\ ]
;
¡¡] ^
if
££ 
(
££ 
m_fSecs1BlockList
££ %
.
££% &
ContainsKey
££& 1
(
££1 2
key
££2 5
)
££5 6
)
££6 7
{
¤¤ 
return
¥¥ 
true
¥¥ 
;
¥¥  
}
¦¦ 
return
ªª 
false
ªª 
;
ªª 
}
«« 
catch
¬¬ 
(
¬¬ 
	Exception
¬¬ 
ex
¬¬ 
)
¬¬  
{
­­ 
FDebug
®® 
.
®® 
throwException
®® %
(
®®% &
ex
®®& (
)
®®( )
;
®®) *
}
¯¯ 
finally
°° 
{
±± 
}
³³ 
return
´´ 
false
´´ 
;
´´ 
}
µµ 	
public
¹¹ 
bool
¹¹ 
validateBlockNo
¹¹ #
(
¹¹# $
FSecs1RecvBlock
ºº 

fRecvBlock
ºº &
)
»» 
{
¼¼ 	
string
½½ 
key
½½ 
=
½½ 
string
½½ 
.
½½  
Empty
½½  %
;
½½% &
FSecs1RecvBlock
¾¾ 
fLastRecvBlock
¾¾ *
=
¾¾+ ,
null
¾¾- 1
;
¾¾1 2
try
ÀÀ 
{
ÁÁ 
key
ÂÂ 
=
ÂÂ 
makeKey
ÂÂ 
(
ÂÂ 

fRecvBlock
ÂÂ (
.
ÂÂ( )
stream
ÂÂ) /
,
ÂÂ/ 0

fRecvBlock
ÂÂ1 ;
.
ÂÂ; <
function
ÂÂ< D
,
ÂÂD E

fRecvBlock
ÂÂF P
.
ÂÂP Q
systemBytes
ÂÂQ \
)
ÂÂ\ ]
;
ÂÂ] ^
if
ÄÄ 
(
ÄÄ 
m_fSecs1BlockList
ÄÄ %
.
ÄÄ% &
ContainsKey
ÄÄ& 1
(
ÄÄ1 2
key
ÄÄ2 5
)
ÄÄ5 6
)
ÄÄ6 7
{
ÅÅ 
fLastRecvBlock
ÆÆ "
=
ÆÆ# $
m_fSecs1BlockList
ÆÆ% 6
[
ÆÆ6 7
key
ÆÆ7 :
]
ÆÆ: ;
.
ÆÆ; <
Last
ÆÆ< @
(
ÆÆ@ A
)
ÆÆA B
.
ÆÆB C
Value
ÆÆC H
;
ÆÆH I
}
ÇÇ 
if
ËË 
(
ËË 
fLastRecvBlock
ËË "
==
ËË# %
null
ËË& *
)
ËË* +
{
ÌÌ 
if
ĞĞ 
(
ĞĞ 

fRecvBlock
ĞĞ "
.
ĞĞ" #
blockNo
ĞĞ# *
!=
ĞĞ+ -
$num
ĞĞ. /
&&
ĞĞ0 2

fRecvBlock
ĞĞ3 =
.
ĞĞ= >
blockNo
ĞĞ> E
!=
ĞĞF H
$num
ĞĞI J
)
ĞĞJ K
{
ÑÑ 
return
ÒÒ 
false
ÒÒ $
;
ÒÒ$ %
}
ÓÓ 
}
ÔÔ 
else
ÕÕ 
{
ÖÖ 
if
ÛÛ 
(
ÛÛ 
fLastRecvBlock
ÛÛ &
.
ÛÛ& '
blockNo
ÛÛ' .
!=
ÛÛ/ 1

fRecvBlock
ÛÛ2 <
.
ÛÛ< =
blockNo
ÛÛ= D
-
ÛÛE F
$num
ÛÛG H
)
ÛÛH I
{
ÜÜ 
if
İİ 
(
İİ 
!
İİ 
m_fSecs1BlockList
İİ .
[
İİ. /
key
İİ/ 2
]
İİ2 3
.
İİ3 4
ContainsKey
İİ4 ?
(
İİ? @

fRecvBlock
İİ@ J
.
İİJ K
blockNo
İİK R
)
İİR S
)
İİS T
{
ŞŞ 
return
ßß "
false
ßß# (
;
ßß( )
}
àà 
}
áá 
}
ââ 
return
ää 
true
ää 
;
ää 
}
åå 
catch
ææ 
(
ææ 
	Exception
ææ 
ex
ææ 
)
ææ  
{
çç 
FDebug
èè 
.
èè 
throwException
èè %
(
èè% &
ex
èè& (
)
èè( )
;
èè) *
}
éé 
finally
êê 
{
ëë 
fLastRecvBlock
ìì 
=
ìì  
null
ìì! %
;
ìì% &
}
íí 
return
îî 
false
îî 
;
îî 
}
ïï 	
public
óó 
bool
óó $
validateDuplidateBlock
óó *
(
óó* +
FSecs1RecvBlock
ôô 

fRecvBlock
ôô &
)
õõ 
{
öö 	
string
÷÷ 
key
÷÷ 
=
÷÷ 
string
÷÷ 
.
÷÷  
Empty
÷÷  %
;
÷÷% &
try
ùù 
{
úú 
key
ûû 
=
ûû 
makeKey
ûû 
(
ûû 

fRecvBlock
ûû (
.
ûû( )
stream
ûû) /
,
ûû/ 0

fRecvBlock
ûû1 ;
.
ûû; <
function
ûû< D
,
ûûD E

fRecvBlock
ûûF P
.
ûûP Q
systemBytes
ûûQ \
)
ûû\ ]
;
ûû] ^
if
ıı 
(
ıı 
m_fSecs1BlockList
ıı %
.
ıı% &
ContainsKey
ıı& 1
(
ıı1 2
key
ıı2 5
)
ıı5 6
)
ıı6 7
{
şş 
if
ÿÿ 
(
ÿÿ 
m_fSecs1BlockList
ÿÿ )
[
ÿÿ) *
key
ÿÿ* -
]
ÿÿ- .
.
ÿÿ. /
ContainsKey
ÿÿ/ :
(
ÿÿ: ;

fRecvBlock
ÿÿ; E
.
ÿÿE F
blockNo
ÿÿF M
)
ÿÿM N
)
ÿÿN O
{
€€ 
if
 
(
 
m_fSecs1ToHsms
 *
.
* +
fSecs1Config
+ 7
.
7 8
duplicateError
8 F
)
F G
{
‚‚ 
return
ƒƒ "
false
ƒƒ# (
;
ƒƒ( )
}
„„ 
}
…… 
}
†† 
return
ˆˆ 
true
ˆˆ 
;
ˆˆ 
}
‰‰ 
catch
ŠŠ 
(
ŠŠ 
	Exception
ŠŠ 
ex
ŠŠ 
)
ŠŠ  
{
‹‹ 
FDebug
ŒŒ 
.
ŒŒ 
throwException
ŒŒ %
(
ŒŒ% &
ex
ŒŒ& (
)
ŒŒ( )
;
ŒŒ) *
}
 
finally
 
{
 
}
‘‘ 
return
’’ 
false
’’ 
;
’’ 
}
““ 	
public
—— 
FSecsDataMessage
—— 
addBlock
——  (
(
——( )
FSecs1RecvBlock
˜˜ 
fBlock
˜˜ "
)
™™ 
{
šš 	
string
›› 
key
›› 
=
›› 
string
›› 
.
››  
Empty
››  %
;
››% &

Dictionary
œœ 
<
œœ 
UInt16
œœ 
,
œœ 
FSecs1RecvBlock
œœ .
>
œœ. /
fSecs1Blocks
œœ0 <
=
œœ= >
null
œœ? C
;
œœC D
List
 
<
 
byte
 
>
 
body
 
=
 
null
 "
;
" #
FSecsDataMessage
 
fSecsDataMessage
 -
=
. /
null
0 4
;
4 5
FStaticTimer
ŸŸ 
fTmrT4
ŸŸ 
=
ŸŸ  !
null
ŸŸ" &
;
ŸŸ& '
try
¡¡ 
{
¢¢ 
key
££ 
=
££ 
makeKey
££ 
(
££ 
fBlock
££ $
.
££$ %
stream
££% +
,
££+ ,
fBlock
££- 3
.
££3 4
function
££4 <
,
££< =
fBlock
££> D
.
££D E
systemBytes
££E P
)
££P Q
;
££Q R
if
¥¥ 
(
¥¥ 
m_fSecs1BlockList
¥¥ %
.
¥¥% &
ContainsKey
¥¥& 1
(
¥¥1 2
key
¥¥2 5
)
¥¥5 6
)
¥¥6 7
{
¦¦ 
fSecs1Blocks
ªª  
=
ªª! "
m_fSecs1BlockList
ªª# 4
[
ªª4 5
key
ªª5 8
]
ªª8 9
;
ªª9 :
if
¬¬ 
(
¬¬ 
fSecs1Blocks
¬¬ $
.
¬¬$ %
ContainsKey
¬¬% 0
(
¬¬0 1
fBlock
¬¬1 7
.
¬¬7 8
blockNo
¬¬8 ?
)
¬¬? @
)
¬¬@ A
{
­­ 
if
±± 
(
±± 
!
±± 
m_fSecs1ToHsms
±± +
.
±±+ ,
fSecs1Config
±±, 8
.
±±8 9
duplicateError
±±9 G
)
±±G H
{
²² 
fSecs1Blocks
³³ (
[
³³( )
fBlock
³³) /
.
³³/ 0
blockNo
³³0 7
]
³³7 8
=
³³9 :
fBlock
³³; A
;
³³A B
}
´´ 
}
µµ 
else
¶¶ 
{
·· 
fSecs1Blocks
¸¸ $
.
¸¸$ %
Add
¸¸% (
(
¸¸( )
fBlock
¸¸) /
.
¸¸/ 0
blockNo
¸¸0 7
,
¸¸7 8
fBlock
¸¸9 ?
)
¸¸? @
;
¸¸@ A
}
¹¹ 
m_fTmrT4List
ÀÀ  
[
ÀÀ  !
key
ÀÀ! $
]
ÀÀ$ %
.
ÀÀ% &
restart
ÀÀ& -
(
ÀÀ- .
m_fSecs1ToHsms
ÀÀ. <
.
ÀÀ< =
fSecs1Config
ÀÀ= I
.
ÀÀI J
	t4Timeout
ÀÀJ S
*
ÀÀT U
$num
ÀÀV Z
)
ÀÀZ [
;
ÀÀ[ \
}
ÁÁ 
else
ÂÂ 
{
ÃÃ 
fSecs1Blocks
ÇÇ  
=
ÇÇ! "
new
ÇÇ# &

Dictionary
ÇÇ' 1
<
ÇÇ1 2
ushort
ÇÇ2 8
,
ÇÇ8 9
FSecs1RecvBlock
ÇÇ9 H
>
ÇÇH I
(
ÇÇI J
)
ÇÇJ K
;
ÇÇK L
fSecs1Blocks
ÈÈ  
.
ÈÈ  !
Add
ÈÈ! $
(
ÈÈ$ %
fBlock
ÈÈ% +
.
ÈÈ+ ,
blockNo
ÈÈ, 3
,
ÈÈ3 4
fBlock
ÈÈ5 ;
)
ÈÈ; <
;
ÈÈ< =
m_fSecs1BlockList
ÊÊ %
.
ÊÊ% &
Add
ÊÊ& )
(
ÊÊ) *
key
ÊÊ* -
,
ÊÊ- .
fSecs1Blocks
ÊÊ/ ;
)
ÊÊ; <
;
ÊÊ< =
fTmrT4
ÑÑ 
=
ÑÑ 
new
ÑÑ  
FStaticTimer
ÑÑ! -
(
ÑÑ- .
)
ÑÑ. /
;
ÑÑ/ 0
fTmrT4
ÒÒ 
.
ÒÒ 
start
ÒÒ  
(
ÒÒ  !
m_fSecs1ToHsms
ÒÒ! /
.
ÒÒ/ 0
fSecs1Config
ÒÒ0 <
.
ÒÒ< =
	t4Timeout
ÒÒ= F
*
ÒÒG H
$num
ÒÒI M
)
ÒÒM N
;
ÒÒN O
m_fTmrT4List
ÓÓ  
.
ÓÓ  !
Add
ÓÓ! $
(
ÓÓ$ %
key
ÓÓ% (
,
ÓÓ( )
fTmrT4
ÓÓ* 0
)
ÓÓ0 1
;
ÓÓ1 2
}
ÔÔ 
if
ØØ 
(
ØØ 
!
ØØ 
fBlock
ØØ 
.
ØØ 
ebit
ØØ  
)
ØØ  !
{
ÙÙ 
return
ÚÚ 
null
ÚÚ 
;
ÚÚ  
}
ÛÛ 
body
ßß 
=
ßß 
new
ßß 
List
ßß 
<
ßß  
byte
ßß  $
>
ßß$ %
(
ßß% &
)
ßß& '
;
ßß' (
foreach
áá 
(
áá 
FSecs1RecvBlock
áá (
b
áá) *
in
áá+ -
fSecs1Blocks
áá. :
.
áá: ;
Values
áá; A
)
ááA B
{
ââ 
body
ãã 
.
ãã 
AddRange
ãã !
(
ãã! "
b
ãã" #
.
ãã# $
body
ãã$ (
)
ãã( )
;
ãã) *
}
ää 
fSecsDataMessage
ææ  
=
ææ! "
new
ææ# &
FSecsDataMessage
ææ' 7
(
ææ7 8
m_fSecs1ToHsms
çç "
,
çç" #
fBlock
èè 
.
èè 
	sessionId
èè $
,
èè$ %
fBlock
éé 
.
éé 
wbit
éé 
,
éé  
fBlock
êê 
.
êê 
stream
êê !
,
êê! "
fBlock
ëë 
.
ëë 
function
ëë #
,
ëë# $
fBlock
ìì 
.
ìì 
systemBytes
ìì &
,
ìì& '
body
íí 
.
íí 
ToArray
íí  
(
íí  !
)
íí! "
)
îî 
;
îî 
m_fSecs1BlockList
òò !
.
òò! "
Remove
òò" (
(
òò( )
key
òò) ,
)
òò, -
;
òò- .
m_fTmrT4List
óó 
.
óó 
Remove
óó #
(
óó# $
key
óó$ '
)
óó' (
;
óó( )
return
÷÷ 
fSecsDataMessage
÷÷ '
;
÷÷' (
}
øø 
catch
ùù 
(
ùù 
	Exception
ùù 
ex
ùù 
)
ùù  
{
úú 
FDebug
ûû 
.
ûû 
throwException
ûû %
(
ûû% &
ex
ûû& (
)
ûû( )
;
ûû) *
}
üü 
finally
ıı 
{
şş 
fTmrT4
ÿÿ 
=
ÿÿ 
null
ÿÿ 
;
ÿÿ 
}
€€ 
return
 
null
 
;
 
}
‚‚ 	
public
†† "
FSecs1T4TimeoutBlock
†† #
[
††# $
]
††$ %"
removeT4TimeoutBlock
††& :
(
††: ;
)
‡‡ 
{
ˆˆ 	
List
‰‰ 
<
‰‰ 
string
‰‰ 
>
‰‰ 
keyList
‰‰  
=
‰‰! "
null
‰‰# '
;
‰‰' (
List
ŠŠ 
<
ŠŠ "
FSecs1T4TimeoutBlock
ŠŠ %
>
ŠŠ% &

fBlockList
ŠŠ' 1
=
ŠŠ2 3
null
ŠŠ4 8
;
ŠŠ8 9
FSecs1RecvBlock
‹‹ 

fRecvBlock
‹‹ &
=
‹‹' (
null
‹‹) -
;
‹‹- .
try
 
{
 
keyList
 
=
 
new
 
List
 "
<
" #
string
# )
>
) *
(
* +
)
+ ,
;
, -

fBlockList
 
=
 
new
  
List
! %
<
% &"
FSecs1T4TimeoutBlock
& :
>
: ;
(
; <
)
< =
;
= >
foreach
”” 
(
”” 
string
”” 
key
””  #
in
””$ &
m_fSecs1BlockList
””' 8
.
””8 9
Keys
””9 =
)
””= >
{
•• 
if
–– 
(
–– 
m_fTmrT4List
–– $
[
––$ %
key
––% (
]
––( )
.
––) *
elasped
––* 1
(
––1 2
false
––2 7
)
––7 8
)
––8 9
{
—— 
keyList
˜˜ 
.
˜˜  
Add
˜˜  #
(
˜˜# $
key
˜˜$ '
)
˜˜' (
;
˜˜( )
}
™™ 
}
šš 
foreach
 
(
 
string
 
key
  #
in
$ &
keyList
' .
)
. /
{
ŸŸ 

fRecvBlock
   
=
    
m_fSecs1BlockList
  ! 2
[
  2 3
key
  3 6
]
  6 7
.
  7 8
First
  8 =
(
  = >
)
  > ?
.
  ? @
Value
  @ E
;
  E F

fBlockList
¡¡ 
.
¡¡ 
Add
¡¡ "
(
¡¡" #
new
¢¢ "
FSecs1T4TimeoutBlock
¢¢ 0
(
¢¢0 1

fRecvBlock
¢¢1 ;
.
¢¢; <
	sessionId
¢¢< E
,
¢¢E F

fRecvBlock
¢¢G Q
.
¢¢Q R
stream
¢¢R X
,
¢¢X Y

fRecvBlock
¢¢Z d
.
¢¢d e
function
¢¢e m
,
¢¢m n

fRecvBlock
¢¢o y
.
¢¢y z
systemBytes¢¢z …
)¢¢… †
)
££ 
;
££ 
m_fSecs1BlockList
¥¥ %
.
¥¥% &
Remove
¥¥& ,
(
¥¥, -
key
¥¥- 0
)
¥¥0 1
;
¥¥1 2
m_fTmrT4List
¦¦  
.
¦¦  !
Remove
¦¦! '
(
¦¦' (
key
¦¦( +
)
¦¦+ ,
;
¦¦, -
}
§§ 
return
«« 

fBlockList
«« !
.
««! "
ToArray
««" )
(
««) *
)
««* +
;
««+ ,
}
¬¬ 
catch
­­ 
(
­­ 
	Exception
­­ 
ex
­­ 
)
­­  
{
®® 
FDebug
¯¯ 
.
¯¯ 
throwException
¯¯ %
(
¯¯% &
ex
¯¯& (
)
¯¯( )
;
¯¯) *
}
°° 
finally
±± 
{
²² 
keyList
³³ 
=
³³ 
null
³³ 
;
³³ 

fBlockList
´´ 
=
´´ 
null
´´ !
;
´´! "

fRecvBlock
µµ 
=
µµ 
null
µµ !
;
µµ! "
}
¶¶ 
return
·· 
null
·· 
;
·· 
}
¸¸ 	
}
¾¾ 
}¿¿ ™(
ƒD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Protocol\SECS1\c_FSecs1T4TimeoutBlock.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
internal 
class  
FSecs1T4TimeoutBlock '
:' (
IDisposable) 4
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
UInt16 
m_sessionId "
=# $
$num% &
;& '
private 
byte 
m_stream 
= 
$num  !
;! "
private 
byte 

m_function 
=  !
$num" #
;# $
private 
UInt32 
m_systemBytes $
=% &
$num' (
;( )
public%%  
FSecs1T4TimeoutBlock%% #
(%%# $
UInt16&& 
	sessionId&& 
,&& 
byte'' 
stream'' 
,'' 
byte(( 
function(( 
,(( 
UInt32)) 
systemBytes)) 
)** 
{++ 	
m_sessionId,, 
=,, 
	sessionId,, #
;,,# $
m_stream-- 
=-- 
stream-- 
;-- 

m_function.. 
=.. 
function.. !
;..! "
m_systemBytes// 
=// 
systemBytes// '
;//' (
}00 	
~44 	 
FSecs1T4TimeoutBlock44	 
(44 
)55 
{66 	
	myDispose77 
(77 
false77 
)77 
;77 
}88 	
	protected<< 
void<< 
	myDispose<<  
(<<  !
bool== 
	disposing== 
)>> 
{?? 	
if@@ 
(@@ 
!@@ 

m_disposed@@ 
)@@ 
{AA 
ifBB 
(BB 
	disposingBB 
)BB 
{CC 
}EE 

m_disposedGG 
=GG 
trueGG !
;GG! "
}HH 
}II 	
publicQQ 
voidQQ 
DisposeQQ 
(QQ 
)RR 
{SS 	
	myDisposeTT 
(TT 
trueTT 
)TT 
;TT 
GCUU 
.UU 
SuppressFinalizeUU 
(UU  
thisUU  $
)UU$ %
;UU% &
}VV 	
public^^ 
UInt16^^ 
	sessionId^^ 
{__ 	
get`` 
{aa 
trybb 
{cc 
returndd 
m_sessionIddd &
;dd& '
}ee 
catchff 
(ff 
	Exceptionff  
exff! #
)ff# $
{gg 
FDebughh 
.hh 
throwExceptionhh )
(hh) *
exhh* ,
)hh, -
;hh- .
}ii 
finallyjj 
{kk 
}mm 
returnnn 
$numnn 
;nn 
}oo 
}pp 	
publictt 
bytett 
streamtt 
{uu 	
getvv 
{ww 
tryxx 
{yy 
returnzz 
m_streamzz #
;zz# $
}{{ 
catch|| 
(|| 
	Exception||  
ex||! #
)||# $
{}} 
FDebug~~ 
.~~ 
throwException~~ )
(~~) *
ex~~* ,
)~~, -
;~~- .
} 
finally
€€ 
{
 
}
ƒƒ 
return
„„ 
$num
„„ 
;
„„ 
}
…… 
}
†† 	
public
ŠŠ 
byte
ŠŠ 
function
ŠŠ 
{
‹‹ 	
get
ŒŒ 
{
 
try
 
{
 
return
 

m_function
 %
;
% &
}
‘‘ 
catch
’’ 
(
’’ 
	Exception
’’  
ex
’’! #
)
’’# $
{
““ 
FDebug
”” 
.
”” 
throwException
”” )
(
””) *
ex
””* ,
)
””, -
;
””- .
}
•• 
finally
–– 
{
—— 
}
™™ 
return
šš 
$num
šš 
;
šš 
}
›› 
}
œœ 	
public
   
UInt32
   
systemBytes
   !
{
¡¡ 	
get
¢¢ 
{
££ 
try
¤¤ 
{
¥¥ 
return
¦¦ 
m_systemBytes
¦¦ (
;
¦¦( )
}
§§ 
catch
¨¨ 
(
¨¨ 
	Exception
¨¨  
ex
¨¨! #
)
¨¨# $
{
©© 
FDebug
ªª 
.
ªª 
throwException
ªª )
(
ªª) *
ex
ªª* ,
)
ªª, -
;
ªª- .
}
«« 
finally
¬¬ 
{
­­ 
}
¯¯ 
return
°° 
$num
°° 
;
°° 
}
±± 
}
²² 	
}
¾¾ 
}¿¿ Í­
~D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Protocol\SECS1\c_FSecs1SendBlock.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
internal 
class 
FSecs1SendBlock "
:" #
IDisposable$ /
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FSecs1SendBlockList #
m_fBlockList$ 0
=1 2
null3 7
;7 8
private 
byte 
m_length 
= 
$num  !
;! "
private 
List 
< 
byte 
> 
m_blockData &
=' (
null) -
;- .
private!! 
bool!! 
m_rbit!! 
=!! 
false!! #
;!!# $
private"" 
UInt16"" 
m_sessionId"" "
=""# $
$num""% &
;""& '
private## 
bool## 
m_wbit## 
=## 
false## #
;### $
private$$ 
byte$$ 
m_stream$$ 
=$$ 
$num$$  !
;$$! "
private%% 
byte%% 

m_function%% 
=%%  !
$num%%" #
;%%# $
private&& 
bool&& 
m_ebit&& 
=&& 
false&& #
;&&# $
private'' 
UInt16'' 
	m_blockNo''  
=''! "
$num''# $
;''$ %
private(( 
UInt32(( 
m_systemBytes(( $
=((% &
$num((' (
;((( )
private)) 
List)) 
<)) 
byte)) 
>)) 
m_body)) !
=))" #
null))$ (
;))( )
private** 
UInt16** 

m_checkSum** !
=**" #
$num**$ %
;**% &
private,, 
bool,, 
	m_isRetry,, 
=,,  
false,,! &
;,,& '
private-- 
int-- 
m_retryCount--  
=--! "
$num--# $
;--$ %
public33 
FSecs1SendBlock33 
(33 
FSecs1SendBlockList44 

fBlockList44  *
,44* +
bool55 
rbit55 
,55 
UInt1666 
	sessionId66 
,66 
bool77 
wbit77 
,77 
byte88 
stream88 
,88 
byte99 
function99 
,99 
bool:: 
ebit:: 
,:: 
UInt16;; 
blockNo;; 
,;; 
UInt32<< 
systemBytes<< 
,<< 
byte== 
[== 
]== 
body== 
)>> 
{?? 	
m_fBlockList@@ 
=@@ 

fBlockList@@ %
;@@% &
m_rbitDD 
=DD 
rbitDD 
;DD 
m_sessionIdEE 
=EE 
	sessionIdEE #
;EE# $
m_wbitFF 
=FF 
wbitFF 
;FF 
m_streamGG 
=GG 
streamGG 
;GG 

m_functionHH 
=HH 
functionHH !
;HH! "
m_ebitII 
=II 
ebitII 
;II 
	m_blockNoJJ 
=JJ 
blockNoJJ 
;JJ  
m_systemBytesKK 
=KK 
systemBytesKK '
;KK' (
ifLL 
(LL 
bodyLL 
.LL 
LengthLL 
==LL 
$numLL  
)LL  !
{MM 
m_bodyNN 
=NN 
newNN 
ListNN !
<NN! "
byteNN" &
>NN& '
(NN' (
)NN( )
;NN) *
}OO 
elsePP 
{QQ 
m_bodyRR 
=RR 
newRR 
ListRR !
<RR! "
byteRR" &
>RR& '
(RR' (
bodyRR( ,
)RR, -
;RR- .
}SS 
genBlockDataWW 
(WW 
)WW 
;WW 
}XX 	
~\\ 	
FSecs1SendBlock\\	 
(\\ 
)]] 
{^^ 	
	myDispose__ 
(__ 
false__ 
)__ 
;__ 
}`` 	
	protecteddd 
voiddd 
	myDisposedd  
(dd  !
boolee 
	disposingee 
)ff 
{gg 	
ifhh 
(hh 
!hh 

m_disposedhh 
)hh 
{ii 
ifjj 
(jj 
	disposingjj 
)jj 
{kk 
m_fBlockListll  
=ll! "
nullll# '
;ll' (
m_blockDatamm 
=mm  !
nullmm" &
;mm& '
m_bodynn 
=nn 
nullnn !
;nn! "
}oo 

m_disposedqq 
=qq 
trueqq !
;qq! "
}rr 
}ss 	
public{{ 
void{{ 
Dispose{{ 
({{ 
)|| 
{}} 	
	myDispose~~ 
(~~ 
true~~ 
)~~ 
;~~ 
GC 
. 
SuppressFinalize 
(  
this  $
)$ %
;% &
}
€€ 	
public
ˆˆ !
FSecs1SendBlockList
ˆˆ "

fBlockList
ˆˆ# -
{
‰‰ 	
get
ŠŠ 
{
‹‹ 
try
ŒŒ 
{
 
return
 
m_fBlockList
 '
;
' (
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
‘‘ 
FDebug
’’ 
.
’’ 
throwException
’’ )
(
’’) *
ex
’’* ,
)
’’, -
;
’’- .
}
““ 
finally
”” 
{
•• 
}
—— 
return
˜˜ 
null
˜˜ 
;
˜˜ 
}
™™ 
}
šš 	
public
 
byte
 
length
 
{
ŸŸ 	
get
   
{
¡¡ 
try
¢¢ 
{
££ 
return
¤¤ 
m_length
¤¤ #
;
¤¤# $
}
¥¥ 
catch
¦¦ 
(
¦¦ 
	Exception
¦¦  
ex
¦¦! #
)
¦¦# $
{
§§ 
FDebug
¨¨ 
.
¨¨ 
throwException
¨¨ )
(
¨¨) *
ex
¨¨* ,
)
¨¨, -
;
¨¨- .
}
©© 
finally
ªª 
{
«« 
}
­­ 
return
®® 
$num
®® 
;
®® 
}
¯¯ 
}
°° 	
public
´´ 
byte
´´ 
[
´´ 
]
´´ 
	blockData
´´ 
{
µµ 	
get
¶¶ 
{
·· 
try
¸¸ 
{
¹¹ 
return
ºº 
m_blockData
ºº &
.
ºº& '
ToArray
ºº' .
(
ºº. /
)
ºº/ 0
;
ºº0 1
}
»» 
catch
¼¼ 
(
¼¼ 
	Exception
¼¼  
ex
¼¼! #
)
¼¼# $
{
½½ 
FDebug
¾¾ 
.
¾¾ 
throwException
¾¾ )
(
¾¾) *
ex
¾¾* ,
)
¾¾, -
;
¾¾- .
}
¿¿ 
finally
ÀÀ 
{
ÁÁ 
}
ÃÃ 
return
ÄÄ 
null
ÄÄ 
;
ÄÄ 
}
ÅÅ 
}
ÆÆ 	
public
ÊÊ 
int
ÊÊ 
blockDataLength
ÊÊ "
{
ËË 	
get
ÌÌ 
{
ÍÍ 
try
ÎÎ 
{
ÏÏ 
return
ĞĞ 
m_blockData
ĞĞ &
.
ĞĞ& '
Count
ĞĞ' ,
;
ĞĞ, -
}
ÑÑ 
catch
ÒÒ 
(
ÒÒ 
	Exception
ÒÒ  
ex
ÒÒ! #
)
ÒÒ# $
{
ÓÓ 
FDebug
ÔÔ 
.
ÔÔ 
throwException
ÔÔ )
(
ÔÔ) *
ex
ÔÔ* ,
)
ÔÔ, -
;
ÔÔ- .
}
ÕÕ 
finally
ÖÖ 
{
×× 
}
ÙÙ 
return
ÚÚ 
$num
ÚÚ 
;
ÚÚ 
}
ÛÛ 
}
ÜÜ 	
public
àà 
bool
àà 
rbit
àà 
{
áá 	
get
ââ 
{
ãã 
try
ää 
{
åå 
return
ææ 
m_rbit
ææ !
;
ææ! "
}
çç 
catch
èè 
(
èè 
	Exception
èè  
ex
èè! #
)
èè# $
{
éé 
FDebug
êê 
.
êê 
throwException
êê )
(
êê) *
ex
êê* ,
)
êê, -
;
êê- .
}
ëë 
finally
ìì 
{
íí 
}
ïï 
return
ğğ 
false
ğğ 
;
ğğ 
}
ññ 
}
òò 	
public
öö 
UInt16
öö 
	sessionId
öö 
{
÷÷ 	
get
øø 
{
ùù 
try
úú 
{
ûû 
return
üü 
m_sessionId
üü &
;
üü& '
}
ıı 
catch
şş 
(
şş 
	Exception
şş  
ex
şş! #
)
şş# $
{
ÿÿ 
FDebug
€€ 
.
€€ 
throwException
€€ )
(
€€) *
ex
€€* ,
)
€€, -
;
€€- .
}
 
finally
‚‚ 
{
ƒƒ 
}
…… 
return
†† 
$num
†† 
;
†† 
}
‡‡ 
}
ˆˆ 	
public
ŒŒ 
bool
ŒŒ 
wbit
ŒŒ 
{
 	
get
 
{
 
try
 
{
‘‘ 
return
’’ 
m_wbit
’’ !
;
’’! "
}
““ 
catch
”” 
(
”” 
	Exception
””  
ex
””! #
)
””# $
{
•• 
FDebug
–– 
.
–– 
throwException
–– )
(
––) *
ex
––* ,
)
––, -
;
––- .
}
—— 
finally
˜˜ 
{
™™ 
}
›› 
return
œœ 
false
œœ 
;
œœ 
}
 
}
 	
public
¢¢ 
byte
¢¢ 
stream
¢¢ 
{
££ 	
get
¤¤ 
{
¥¥ 
try
¦¦ 
{
§§ 
return
¨¨ 
m_stream
¨¨ #
;
¨¨# $
}
©© 
catch
ªª 
(
ªª 
	Exception
ªª  
ex
ªª! #
)
ªª# $
{
«« 
FDebug
¬¬ 
.
¬¬ 
throwException
¬¬ )
(
¬¬) *
ex
¬¬* ,
)
¬¬, -
;
¬¬- .
}
­­ 
finally
®® 
{
¯¯ 
}
±± 
return
²² 
$num
²² 
;
²² 
}
³³ 
}
´´ 	
public
¸¸ 
byte
¸¸ 
function
¸¸ 
{
¹¹ 	
get
ºº 
{
»» 
try
¼¼ 
{
½½ 
return
¾¾ 

m_function
¾¾ %
;
¾¾% &
}
¿¿ 
catch
ÀÀ 
(
ÀÀ 
	Exception
ÀÀ  
ex
ÀÀ! #
)
ÀÀ# $
{
ÁÁ 
FDebug
ÂÂ 
.
ÂÂ 
throwException
ÂÂ )
(
ÂÂ) *
ex
ÂÂ* ,
)
ÂÂ, -
;
ÂÂ- .
}
ÃÃ 
finally
ÄÄ 
{
ÅÅ 
}
ÇÇ 
return
ÈÈ 
$num
ÈÈ 
;
ÈÈ 
}
ÉÉ 
}
ÊÊ 	
public
ÎÎ 
bool
ÎÎ 
ebit
ÎÎ 
{
ÏÏ 	
get
ĞĞ 
{
ÑÑ 
try
ÒÒ 
{
ÓÓ 
return
ÔÔ 
m_ebit
ÔÔ !
;
ÔÔ! "
}
ÕÕ 
catch
ÖÖ 
(
ÖÖ 
	Exception
ÖÖ  
ex
ÖÖ! #
)
ÖÖ# $
{
×× 
FDebug
ØØ 
.
ØØ 
throwException
ØØ )
(
ØØ) *
ex
ØØ* ,
)
ØØ, -
;
ØØ- .
}
ÙÙ 
finally
ÚÚ 
{
ÛÛ 
}
İİ 
return
ŞŞ 
false
ŞŞ 
;
ŞŞ 
}
ßß 
}
àà 	
public
ää 
UInt16
ää 
blockNo
ää 
{
åå 	
get
ææ 
{
çç 
try
èè 
{
éé 
return
êê 
	m_blockNo
êê $
;
êê$ %
}
ëë 
catch
ìì 
(
ìì 
	Exception
ìì  
ex
ìì! #
)
ìì# $
{
íí 
FDebug
îî 
.
îî 
throwException
îî )
(
îî) *
ex
îî* ,
)
îî, -
;
îî- .
}
ïï 
finally
ğğ 
{
ññ 
}
óó 
return
ôô 
$num
ôô 
;
ôô 
}
õõ 
}
öö 	
public
úú 
UInt32
úú 
systemBytes
úú !
{
ûû 	
get
üü 
{
ıı 
try
şş 
{
ÿÿ 
return
€€ 
m_systemBytes
€€ (
;
€€( )
}
 
catch
‚‚ 
(
‚‚ 
	Exception
‚‚  
ex
‚‚! #
)
‚‚# $
{
ƒƒ 
FDebug
„„ 
.
„„ 
throwException
„„ )
(
„„) *
ex
„„* ,
)
„„, -
;
„„- .
}
…… 
finally
†† 
{
‡‡ 
}
‰‰ 
return
ŠŠ 
$num
ŠŠ 
;
ŠŠ 
}
‹‹ 
}
ŒŒ 	
public
 
byte
 
[
 
]
 
body
 
{
‘‘ 	
get
’’ 
{
““ 
try
”” 
{
•• 
return
–– 
m_body
–– !
.
––! "
ToArray
––" )
(
––) *
)
––* +
;
––+ ,
}
—— 
catch
˜˜ 
(
˜˜ 
	Exception
˜˜  
ex
˜˜! #
)
˜˜# $
{
™™ 
FDebug
šš 
.
šš 
throwException
šš )
(
šš) *
ex
šš* ,
)
šš, -
;
šš- .
}
›› 
finally
œœ 
{
 
}
ŸŸ 
return
   
null
   
;
   
}
¡¡ 
}
¢¢ 	
public
¦¦ 
UInt16
¦¦ 
checkSum
¦¦ 
{
§§ 	
get
¨¨ 
{
©© 
try
ªª 
{
«« 
return
¬¬ 

m_checkSum
¬¬ %
;
¬¬% &
}
­­ 
catch
®® 
(
®® 
	Exception
®®  
ex
®®! #
)
®®# $
{
¯¯ 
FDebug
°° 
.
°° 
throwException
°° )
(
°°) *
ex
°°* ,
)
°°, -
;
°°- .
}
±± 
finally
²² 
{
³³ 
}
µµ 
return
¶¶ 
$num
¶¶ 
;
¶¶ 
}
·· 
}
¸¸ 	
public
¼¼ 
bool
¼¼ 
isRetry
¼¼ 
{
½½ 	
get
¾¾ 
{
¿¿ 
try
ÀÀ 
{
ÁÁ 
return
ÂÂ 
	m_isRetry
ÂÂ $
;
ÂÂ$ %
}
ÃÃ 
catch
ÄÄ 
(
ÄÄ 
	Exception
ÄÄ  
ex
ÄÄ! #
)
ÄÄ# $
{
ÅÅ 
FDebug
ÆÆ 
.
ÆÆ 
throwException
ÆÆ )
(
ÆÆ) *
ex
ÆÆ* ,
)
ÆÆ, -
;
ÆÆ- .
}
ÇÇ 
finally
ÈÈ 
{
ÉÉ 
}
ËË 
return
ÌÌ 
false
ÌÌ 
;
ÌÌ 
}
ÍÍ 
set
ÏÏ 
{
ĞĞ 
try
ÑÑ 
{
ÒÒ 
	m_isRetry
ÓÓ 
=
ÓÓ 
value
ÓÓ  %
;
ÓÓ% &
}
ÔÔ 
catch
ÕÕ 
(
ÕÕ 
	Exception
ÕÕ  
ex
ÕÕ! #
)
ÕÕ# $
{
ÖÖ 
FDebug
×× 
.
×× 
throwException
×× )
(
××) *
ex
××* ,
)
××, -
;
××- .
}
ØØ 
finally
ÙÙ 
{
ÚÚ 
}
ÜÜ 
}
İİ 
}
ŞŞ 	
public
ââ 
int
ââ 

retryCount
ââ 
{
ãã 	
get
ää 
{
åå 
try
ææ 
{
çç 
return
èè 
m_retryCount
èè '
;
èè' (
}
éé 
catch
êê 
(
êê 
	Exception
êê  
ex
êê! #
)
êê# $
{
ëë 
FDebug
ìì 
.
ìì 
throwException
ìì )
(
ìì) *
ex
ìì* ,
)
ìì, -
;
ìì- .
}
íí 
finally
îî 
{
ïï 
}
ññ 
return
òò 
$num
òò 
;
òò 
}
óó 
}
ôô 	
private
üü 
void
üü 
genBlockData
üü !
(
üü! "
)
ıı 
{
şş 	
byte
ÿÿ 
[
ÿÿ 
]
ÿÿ 
tmpByte
ÿÿ 
=
ÿÿ 
null
ÿÿ !
;
ÿÿ! "
try
 
{
‚‚ 
m_blockData
ƒƒ 
=
ƒƒ 
new
ƒƒ !
List
ƒƒ" &
<
ƒƒ& '
byte
ƒƒ' +
>
ƒƒ+ ,
(
ƒƒ, -
)
ƒƒ- .
;
ƒƒ. /
m_length
ŠŠ 
=
ŠŠ 
(
ŠŠ 
byte
ŠŠ  
)
ŠŠ  !
(
ŠŠ! "
$num
ŠŠ" $
+
ŠŠ% &
m_body
ŠŠ' -
.
ŠŠ- .
Count
ŠŠ. 3
)
ŠŠ3 4
;
ŠŠ4 5
m_blockData
‹‹ 
.
‹‹ 
Add
‹‹ 
(
‹‹  
m_length
‹‹  (
)
‹‹( )
;
‹‹) *
tmpByte
’’ 
=
’’ 
FByteConverter
’’ (
.
’’( )
getBytes
’’) 1
(
’’1 2
m_sessionId
’’2 =
,
’’= >
true
’’? C
)
’’C D
;
’’D E
m_blockData
““ 
.
““ 
Add
““ 
(
““  
(
““  !
byte
““! %
)
““% &
(
““& '
tmpByte
““' .
[
““. /
$num
““/ 0
]
““0 1
|
““2 3
(
““4 5
m_rbit
““5 ;
?
““< =
$num
““> B
:
““C D
$num
““E I
)
““I J
)
““J K
)
““K L
;
““L M
m_blockData
”” 
.
”” 
Add
”” 
(
””  
tmpByte
””  '
[
””' (
$num
””( )
]
””) *
)
””* +
;
””+ ,
m_blockData
•• 
.
•• 
Add
•• 
(
••  
(
••  !
byte
••! %
)
••% &
(
••& '
m_stream
••' /
|
••0 1
(
••2 3
m_wbit
••3 9
?
••: ;
$num
••< @
:
••A B
$num
••C G
)
••G H
)
••H I
)
••I J
;
••J K
m_blockData
–– 
.
–– 
Add
–– 
(
––  

m_function
––  *
)
––* +
;
––+ ,
tmpByte
—— 
=
—— 
FByteConverter
—— (
.
——( )
getBytes
——) 1
(
——1 2
	m_blockNo
——2 ;
,
——; <
true
——= A
)
——A B
;
——B C
m_blockData
˜˜ 
.
˜˜ 
Add
˜˜ 
(
˜˜  
(
˜˜  !
byte
˜˜! %
)
˜˜% &
(
˜˜& '
tmpByte
˜˜' .
[
˜˜. /
$num
˜˜/ 0
]
˜˜0 1
|
˜˜2 3
(
˜˜4 5
m_ebit
˜˜5 ;
?
˜˜< =
$num
˜˜> B
:
˜˜C D
$num
˜˜E I
)
˜˜I J
)
˜˜J K
)
˜˜K L
;
˜˜L M
m_blockData
™™ 
.
™™ 
Add
™™ 
(
™™  
tmpByte
™™  '
[
™™' (
$num
™™( )
]
™™) *
)
™™* +
;
™™+ ,
m_blockData
šš 
.
šš 
AddRange
šš $
(
šš$ %
FByteConverter
šš% 3
.
šš3 4
getBytes
šš4 <
(
šš< =
m_systemBytes
šš= J
,
ššJ K
true
ššL P
)
ššP Q
)
ššQ R
;
ššR S
if
¡¡ 
(
¡¡ 
m_body
¡¡ 
.
¡¡ 
Count
¡¡  
>
¡¡! "
$num
¡¡# $
)
¡¡$ %
{
¢¢ 
m_blockData
££ 
.
££  
AddRange
££  (
(
££( )
m_body
££) /
.
££/ 0
ToArray
££0 7
(
££7 8
)
££8 9
)
££9 :
;
££: ;
}
¤¤ 
for
«« 
(
«« 
int
«« 
i
«« 
=
«« 
$num
«« 
;
«« 
i
««  !
<
««" #
m_blockData
««$ /
.
««/ 0
Count
««0 5
;
««5 6
i
««7 8
++
««8 :
)
««: ;
{
¬¬ 

m_checkSum
­­ 
+=
­­ !
m_blockData
­­" -
[
­­- .
i
­­. /
]
­­/ 0
;
­­0 1
}
®® 
m_blockData
¯¯ 
.
¯¯ 
AddRange
¯¯ $
(
¯¯$ %
FByteConverter
¯¯% 3
.
¯¯3 4
getBytes
¯¯4 <
(
¯¯< =

m_checkSum
¯¯= G
,
¯¯G H
true
¯¯I M
)
¯¯M N
)
¯¯N O
;
¯¯O P
}
°° 
catch
±± 
(
±± 
	Exception
±± 
ex
±± 
)
±±  
{
²² 
FDebug
³³ 
.
³³ 
throwException
³³ %
(
³³% &
ex
³³& (
)
³³( )
;
³³) *
}
´´ 
finally
µµ 
{
¶¶ 
}
¸¸ 
}
¹¹ 	
public
½½ 
void
½½ 
addRetryCount
½½ !
(
½½! "
)
¾¾ 
{
¿¿ 	
try
ÀÀ 
{
ÁÁ 
m_retryCount
ÂÂ 
++
ÂÂ 
;
ÂÂ 
}
ÃÃ 
catch
ÄÄ 
(
ÄÄ 
	Exception
ÄÄ 
ex
ÄÄ 
)
ÄÄ  
{
ÅÅ 
FDebug
ÆÆ 
.
ÆÆ 
throwException
ÆÆ %
(
ÆÆ% &
ex
ÆÆ& (
)
ÆÆ( )
;
ÆÆ) *
}
ÇÇ 
finally
ÈÈ 
{
ÉÉ 
}
ËË 
}
ÌÌ 	
}
ÒÒ 
}ÓÓ ô4
‚D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\Protocol\SECS1\c_FSecs1SendBlockList.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
internal 
class 
FSecs1SendBlockList &
:& '
IDisposable( 3
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FSecs1ToHsms 
m_fSecs1ToHsms +
=, -
null. 2
;2 3
private 
FSecsDataMessage  
m_fSecsDataMessage! 3
=4 5
null6 :
;: ;
private 
List 
< 
FSecs1SendBlock $
>$ %
m_fBlockList& 2
=3 4
null5 9
;9 :
private 
int 
m_blockIndex  
=! "
$num# $
;$ %
public%% 
FSecs1SendBlockList%% "
(%%" #
FSecs1ToHsms&& 
fSecs1ToHsms&& %
,&&% &
FSecsDataMessage'' 
fSecsDataMessage'' -
)(( 
{)) 	
m_fSecs1ToHsms** 
=** 
fSecs1ToHsms** )
;**) *
m_fSecsDataMessage++ 
=++  
fSecsDataMessage++! 1
;++1 2
m_fBlockList,, 
=,, 
new,, 
List,, #
<,,# $
FSecs1SendBlock,,$ 3
>,,3 4
(,,4 5
),,5 6
;,,6 7
}-- 	
~11 	
FSecs1SendBlockList11	 
(11 
)22 
{33 	
	myDispose44 
(44 
false44 
)44 
;44 
}55 	
	protected99 
void99 
	myDispose99  
(99  !
bool:: 
	disposing:: 
);; 
{<< 	
if== 
(== 
!== 

m_disposed== 
)== 
{>> 
if?? 
(?? 
	disposing?? 
)?? 
{@@ 
m_fSecs1ToHsmsAA "
=AA# $
nullAA% )
;AA) *
m_fSecsDataMessageBB &
=BB' (
nullBB) -
;BB- .
m_fBlockListCC  
=CC! "
nullCC# '
;CC' (
}DD 

m_disposedFF 
=FF 
trueFF !
;FF! "
}GG 
}HH 	
publicPP 
voidPP 
DisposePP 
(PP 
)QQ 
{RR 	
	myDisposeSS 
(SS 
trueSS 
)SS 
;SS 
GCTT 
.TT 
SuppressFinalizeTT 
(TT  
thisTT  $
)TT$ %
;TT% &
}UU 	
public]] 
int]] 
length]] 
{^^ 	
get__ 
{`` 
tryaa 
{bb 
returncc 
m_fBlockListcc '
.cc' (
Countcc( -
;cc- .
}dd 
catchee 
(ee 
	Exceptionee  
exee! #
)ee# $
{ff 
FDebuggg 
.gg 
throwExceptiongg )
(gg) *
exgg* ,
)gg, -
;gg- .
}hh 
finallyii 
{jj 
}ll 
returnmm 
$nummm 
;mm 
}nn 
}oo 	
publicss 
FSecs1SendBlockss 
fCurrentBlockss ,
{tt 	
getuu 
{vv 
tryww 
{xx 
returnyy 
m_fBlockListyy '
[yy' (
m_blockIndexyy( 4
]yy4 5
;yy5 6
}zz 
catch{{ 
({{ 
	Exception{{  
ex{{! #
){{# $
{|| 
FDebug}} 
.}} 
throwException}} )
(}}) *
ex}}* ,
)}}, -
;}}- .
}~~ 
finally 
{
€€ 
}
‚‚ 
return
ƒƒ 
null
ƒƒ 
;
ƒƒ 
}
„„ 
}
…… 	
public
‰‰ 
FSecsDataMessage
‰‰ 
fSecsDataMessage
‰‰  0
{
ŠŠ 	
get
‹‹ 
{
ŒŒ 
try
 
{
 
return
  
m_fSecsDataMessage
 -
;
- .
}
 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘  
ex
‘‘! #
)
‘‘# $
{
’’ 
FDebug
““ 
.
““ 
throwException
““ )
(
““) *
ex
““* ,
)
““, -
;
““- .
}
”” 
finally
•• 
{
–– 
}
˜˜ 
return
™™ 
null
™™ 
;
™™ 
}
šš 
}
›› 	
public
££ 
void
££ 
addBlock
££ 
(
££ 
FSecs1SendBlock
¤¤ 
fBlock
¤¤ "
)
¥¥ 
{
¦¦ 	
try
§§ 
{
¨¨ 
m_fBlockList
©© 
.
©© 
Add
©©  
(
©©  !
fBlock
©©! '
)
©©' (
;
©©( )
}
ªª 
catch
«« 
(
«« 
	Exception
«« 
ex
«« 
)
««  
{
¬¬ 
FDebug
­­ 
.
­­ 
throwException
­­ %
(
­­% &
ex
­­& (
)
­­( )
;
­­) *
}
®® 
finally
¯¯ 
{
°° 
}
²² 
}
³³ 	
public
·· 
bool
·· 
next
·· 
(
·· 
)
¸¸ 
{
¹¹ 	
int
ºº 
index
ºº 
=
ºº 
$num
ºº 
;
ºº 
try
¼¼ 
{
½½ 
index
¾¾ 
=
¾¾ 
m_blockIndex
¾¾ $
+
¾¾% &
$num
¾¾' (
;
¾¾( )
if
¿¿ 
(
¿¿ 
index
¿¿ 
>=
¿¿ 
m_fBlockList
¿¿ )
.
¿¿) *
Count
¿¿* /
)
¿¿/ 0
{
ÀÀ 
return
ÁÁ 
false
ÁÁ  
;
ÁÁ  !
}
ÂÂ 
m_blockIndex
ÄÄ 
=
ÄÄ 
index
ÄÄ $
;
ÄÄ$ %
return
ÅÅ 
true
ÅÅ 
;
ÅÅ 
}
ÆÆ 
catch
ÇÇ 
(
ÇÇ 
	Exception
ÇÇ 
ex
ÇÇ 
)
ÇÇ  
{
ÈÈ 
FDebug
ÉÉ 
.
ÉÉ 
throwException
ÉÉ %
(
ÉÉ% &
ex
ÉÉ& (
)
ÉÉ( )
;
ÉÉ) *
}
ÊÊ 
finally
ËË 
{
ÌÌ 
}
ÎÎ 
return
ÏÏ 
false
ÏÏ 
;
ÏÏ 
}
ĞĞ 	
}
ÖÖ 
}×× Ö"
„D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\SecsMessage\c_FInterceptingDataMessage.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
public 

class $
FInterceptingDataMessage )
:) *
IDisposable+ 6
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
byte 
m_stream 
= 
$num  !
;! "
private 
byte 

m_function 
=  !
$num" #
;# $
public## $
FInterceptingDataMessage## '
(##' (
byte$$ 
stream$$ 
,$$ 
byte%% 
function%% 
)&& 
{'' 	
m_stream(( 
=(( 
stream(( 
;(( 

m_function)) 
=)) 
function)) !
;))! "
}** 	
~.. 	$
FInterceptingDataMessage..	 !
(..! "
)// 
{00 	
	myDispose11 
(11 
false11 
)11 
;11 
}22 	
	protected66 
void66 
	myDispose66  
(66  !
bool77 
	disposing77 
)88 
{99 	
if:: 
(:: 
!:: 

m_disposed:: 
):: 
{;; 
if<< 
(<< 
	disposing<< 
)<< 
{== 
}?? 

m_disposedAA 
=AA 
trueAA !
;AA! "
}BB 
}CC 	
publicKK 
voidKK 
DisposeKK 
(KK 
)LL 
{MM 	
	myDisposeNN 
(NN 
trueNN 
)NN 
;NN 
GCOO 
.OO 
SuppressFinalizeOO 
(OO  
thisOO  $
)OO$ %
;OO% &
}PP 	
publicXX 
byteXX 
streamXX 
{YY 	
getZZ 
{[[ 
try\\ 
{]] 
return^^ 
m_stream^^ #
;^^# $
}__ 
catch`` 
(`` 
	Exception``  
ex``! #
)``# $
{aa 
FDebugbb 
.bb 
throwExceptionbb )
(bb) *
exbb* ,
)bb, -
;bb- .
}cc 
finallydd 
{ee 
}gg 
returnhh 
$numhh 
;hh 
}ii 
}jj 	
publicnn 
bytenn 
functionnn 
{oo 	
getpp 
{qq 
tryrr 
{ss 
returntt 

m_functiontt %
;tt% &
}uu 
catchvv 
(vv 
	Exceptionvv  
exvv! #
)vv# $
{ww 
FDebugxx 
.xx 
throwExceptionxx )
(xx) *
exxx* ,
)xx, -
;xx- .
}yy 
finallyzz 
{{{ 
}}} 
return~~ 
$num~~ 
;~~ 
} 
}
€€ 	
internal
ˆˆ 
string
ˆˆ 
getKey
ˆˆ 
(
ˆˆ 
)
‰‰ 
{
ŠŠ 	
const
‹‹ 
string
‹‹ 
	KeyFormat
‹‹ "
=
‹‹# $
$str
‹‹% .
;
‹‹. /
try
 
{
 
return
 
string
 
.
 
Format
 $
(
$ %
	KeyFormat
% .
,
. /
m_stream
0 8
.
8 9
ToString
9 A
(
A B
)
B C
,
C D

m_function
E O
.
O P
ToString
P X
(
X Y
)
Y Z
)
Z [
;
[ \
}
 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘ 
ex
‘‘ 
)
‘‘  
{
’’ 
FDebug
““ 
.
““ 
throwException
““ %
(
““% &
ex
““& (
)
““( )
;
““) *
}
”” 
finally
•• 
{
–– 
}
˜˜ 
return
™™ 
string
™™ 
.
™™ 
Empty
™™ 
;
™™  
}
šš 	
}
   
}¡¡ ¥
|D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\SecsMessage\c_FSecsDataMessage.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
public 

class 
FSecsDataMessage !
:! "
IDisposable# .
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FSecs1ToHsms 
m_fSecs1ToHsms +
=, -
null. 2
;2 3
private 
UInt16 
m_sessionId "
=# $
$num% &
;& '
private 
bool 
m_wbit 
= 
false #
;# $
private   
byte   
m_stream   
=   
$num    !
;  ! "
private!! 
byte!! 

m_function!! 
=!!  !
$num!!" #
;!!# $
private"" 
UInt32"" 
m_systemBytes"" $
=""% &
$num""' (
;""( )
private## 
List## 
<## 
byte## 
>## 
m_body## !
=##" #
null##$ (
;##( )
internal)) 
FSecsDataMessage)) !
())! "
FSecs1ToHsms** 
fSecs1ToHsms** %
,**% &
UInt16++ 
	sessionId++ 
,++ 
bool,, 
wbit,, 
,,, 
byte-- 
stream-- 
,-- 
byte.. 
function.. 
,.. 
UInt32// 
systemBytes// 
,// 
byte00 
[00 
]00 
body00 
)11 
{22 	
m_fSecs1ToHsms33 
=33 
fSecs1ToHsms33 )
;33) *
m_sessionId55 
=55 
	sessionId55 #
;55# $
m_wbit66 
=66 
wbit66 
;66 
m_stream77 
=77 
stream77 
;77 

m_function88 
=88 
function88 !
;88! "
m_systemBytes99 
=99 
systemBytes99 '
;99' (
m_body:: 
=:: 
new:: 
List:: 
<:: 
byte:: "
>::" #
(::# $
body::$ (
)::( )
;::) *
};; 	
~?? 	
FSecsDataMessage??	 
(?? 
)@@ 
{AA 	
	myDisposeBB 
(BB 
falseBB 
)BB 
;BB 
}CC 	
	protectedGG 
voidGG 
	myDisposeGG  
(GG  !
boolHH 
	disposingHH 
)II 
{JJ 	
ifKK 
(KK 
!KK 

m_disposedKK 
)KK 
{LL 
ifMM 
(MM 
	disposingMM 
)MM 
{NN 
m_fSecs1ToHsmsOO "
=OO# $
nullOO% )
;OO) *
m_bodyPP 
=PP 
nullPP !
;PP! "
}QQ 

m_disposedSS 
=SS 
trueSS !
;SS! "
}TT 
}UU 	
public]] 
void]] 
Dispose]] 
(]] 
)^^ 
{__ 	
	myDispose`` 
(`` 
true`` 
)`` 
;`` 
GCaa 
.aa 
SuppressFinalizeaa 
(aa  
thisaa  $
)aa$ %
;aa% &
}bb 	
publicjj 
UInt32jj 
lengthjj 
{kk 	
getll 
{mm 
trynn 
{oo 
returnpp 
(pp 
UInt32pp "
)pp" #
(pp# $
$numpp$ &
+pp' (
m_bodypp) /
.pp/ 0
Countpp0 5
)pp5 6
;pp6 7
}qq 
catchrr 
(rr 
	Exceptionrr  
exrr! #
)rr# $
{ss 
FDebugtt 
.tt 
throwExceptiontt )
(tt) *
extt* ,
)tt, -
;tt- .
}uu 
finallyvv 
{ww 
}yy 
returnzz 
$numzz 
;zz 
}{{ 
}|| 	
public
€€ 
UInt16
€€ 
	sessionId
€€ 
{
 	
get
‚‚ 
{
ƒƒ 
try
„„ 
{
…… 
return
†† 
m_sessionId
†† &
;
††& '
}
‡‡ 
catch
ˆˆ 
(
ˆˆ 
	Exception
ˆˆ  
ex
ˆˆ! #
)
ˆˆ# $
{
‰‰ 
FDebug
ŠŠ 
.
ŠŠ 
throwException
ŠŠ )
(
ŠŠ) *
ex
ŠŠ* ,
)
ŠŠ, -
;
ŠŠ- .
}
‹‹ 
finally
ŒŒ 
{
 
}
 
return
 
$num
 
;
 
}
‘‘ 
}
’’ 	
public
–– 
bool
–– 
wbit
–– 
{
—— 	
get
˜˜ 
{
™™ 
try
šš 
{
›› 
return
œœ 
m_wbit
œœ !
;
œœ! "
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
ŸŸ 
FDebug
   
.
   
throwException
   )
(
  ) *
ex
  * ,
)
  , -
;
  - .
}
¡¡ 
finally
¢¢ 
{
££ 
}
¥¥ 
return
¦¦ 
false
¦¦ 
;
¦¦ 
}
§§ 
}
¨¨ 	
public
¬¬ 
byte
¬¬ 
stream
¬¬ 
{
­­ 	
get
®® 
{
¯¯ 
try
°° 
{
±± 
return
²² 
m_stream
²² #
;
²²# $
}
³³ 
catch
´´ 
(
´´ 
	Exception
´´  
ex
´´! #
)
´´# $
{
µµ 
FDebug
¶¶ 
.
¶¶ 
throwException
¶¶ )
(
¶¶) *
ex
¶¶* ,
)
¶¶, -
;
¶¶- .
}
·· 
finally
¸¸ 
{
¹¹ 
}
»» 
return
¼¼ 
$num
¼¼ 
;
¼¼ 
}
½½ 
}
¾¾ 	
public
ÂÂ 
byte
ÂÂ 
function
ÂÂ 
{
ÃÃ 	
get
ÄÄ 
{
ÅÅ 
try
ÆÆ 
{
ÇÇ 
return
ÈÈ 

m_function
ÈÈ %
;
ÈÈ% &
}
ÉÉ 
catch
ÊÊ 
(
ÊÊ 
	Exception
ÊÊ  
ex
ÊÊ! #
)
ÊÊ# $
{
ËË 
FDebug
ÌÌ 
.
ÌÌ 
throwException
ÌÌ )
(
ÌÌ) *
ex
ÌÌ* ,
)
ÌÌ, -
;
ÌÌ- .
}
ÍÍ 
finally
ÎÎ 
{
ÏÏ 
}
ÑÑ 
return
ÒÒ 
$num
ÒÒ 
;
ÒÒ 
}
ÓÓ 
}
ÔÔ 	
public
ØØ 
UInt32
ØØ 
systemBytes
ØØ !
{
ÙÙ 	
get
ÚÚ 
{
ÛÛ 
try
ÜÜ 
{
İİ 
return
ŞŞ 
m_systemBytes
ŞŞ (
;
ŞŞ( )
}
ßß 
catch
àà 
(
àà 
	Exception
àà  
ex
àà! #
)
àà# $
{
áá 
FDebug
ââ 
.
ââ 
throwException
ââ )
(
ââ) *
ex
ââ* ,
)
ââ, -
;
ââ- .
}
ãã 
finally
ää 
{
åå 
}
çç 
return
èè 
$num
èè 
;
èè 
}
éé 
}
êê 	
public
îî 
byte
îî 
[
îî 
]
îî 
body
îî 
{
ïï 	
get
ğğ 
{
ññ 
try
òò 
{
óó 
return
ôô 
m_body
ôô !
.
ôô! "
ToArray
ôô" )
(
ôô) *
)
ôô* +
;
ôô+ ,
}
õõ 
catch
öö 
(
öö 
	Exception
öö  
ex
öö! #
)
öö# $
{
÷÷ 
FDebug
øø 
.
øø 
throwException
øø )
(
øø) *
ex
øø* ,
)
øø, -
;
øø- .
}
ùù 
finally
úú 
{
ûû 
}
ıı 
return
şş 
null
şş 
;
şş 
}
ÿÿ 
}
€€ 	
internal
ˆˆ 
FSecsDataMessage
ˆˆ !
clone
ˆˆ" '
(
ˆˆ' (
)
‰‰ 
{
ŠŠ 	
try
‹‹ 
{
ŒŒ 
return
 
new
 
FSecsDataMessage
 +
(
+ ,
m_fSecs1ToHsms
 "
,
" #
m_sessionId
 
,
  
m_wbit
 
,
 
m_stream
‘‘ 
,
‘‘ 

m_function
’’ 
,
’’ 
m_systemBytes
““ !
,
““! "
m_body
”” 
.
”” 
ToArray
”” "
(
””" #
)
””# $
)
•• 
;
•• 
}
–– 
catch
—— 
(
—— 
	Exception
—— 
ex
—— 
)
——  
{
˜˜ 
FDebug
™™ 
.
™™ 
throwException
™™ %
(
™™% &
ex
™™& (
)
™™( )
;
™™) *
}
šš 
finally
›› 
{
œœ 
}
 
return
ŸŸ 
null
ŸŸ 
;
ŸŸ 
}
   	
internal
¤¤ 
byte
¤¤ 
[
¤¤ 
]
¤¤ 
getHsmsBinaryData
¤¤ )
(
¤¤) *
bool
¥¥ 
lengthInclude
¥¥ 
)
¦¦ 
{
§§ 	
byte
¨¨ 
[
¨¨ 
]
¨¨ 
binData
¨¨ 
=
¨¨ 
null
¨¨ !
;
¨¨! "
UInt32
©© 
length
©© 
=
©© 
$num
©© 
;
©© 
byte
ªª 
byte2
ªª 
=
ªª 
$num
ªª 
;
ªª 
byte
«« 
byte3
«« 
=
«« 
$num
«« 
;
«« 
byte
¬¬ 
ptype
¬¬ 
=
¬¬ 
$num
¬¬ 
;
¬¬ 
byte
­­ 
stype
­­ 
=
­­ 
$num
­­ 
;
­­ 
int
®® 
pos
®® 
=
®® 
$num
®® 
;
®® 
try
°° 
{
±± 
length
²² 
=
²² 
this
²² 
.
²² 
length
²² $
;
²²$ %
byte2
³³ 
=
³³ 
(
³³ 
byte
³³ 
)
³³ 
(
³³ 
stream
³³ %
|
³³& '
(
³³( )
wbit
³³) -
?
³³. /
$num
³³0 4
:
³³5 6
$num
³³7 ;
)
³³; <
)
³³< =
;
³³= >
byte3
´´ 
=
´´ 
function
´´  
;
´´  !
ptype
µµ 
=
µµ 
$num
µµ 
;
µµ 
stype
¶¶ 
=
¶¶ 
$num
¶¶ 
;
¶¶ 
if
ºº 
(
ºº 
lengthInclude
ºº !
)
ºº! "
{
»» 
binData
¼¼ 
=
¼¼ 
new
¼¼ !
byte
¼¼" &
[
¼¼& '
length
¼¼' -
+
¼¼. /
$num
¼¼0 1
]
¼¼1 2
;
¼¼2 3
Buffer
ÃÃ 
.
ÃÃ 
	BlockCopy
ÃÃ $
(
ÃÃ$ %
FByteConverter
ÃÃ% 3
.
ÃÃ3 4
getBytes
ÃÃ4 <
(
ÃÃ< =
length
ÃÃ= C
,
ÃÃC D
true
ÃÃE I
)
ÃÃI J
,
ÃÃJ K
$num
ÃÃL M
,
ÃÃM N
binData
ÃÃO V
,
ÃÃV W
pos
ÃÃX [
,
ÃÃ[ \
$num
ÃÃ] ^
)
ÃÃ^ _
;
ÃÃ_ `
pos
ÄÄ 
+=
ÄÄ 
$num
ÄÄ 
;
ÄÄ 
}
ÅÅ 
else
ÆÆ 
{
ÇÇ 
binData
ÈÈ 
=
ÈÈ 
new
ÈÈ !
byte
ÈÈ" &
[
ÈÈ& '
length
ÈÈ' -
]
ÈÈ- .
;
ÈÈ. /
}
ÉÉ 
Buffer
ĞĞ 
.
ĞĞ 
	BlockCopy
ĞĞ  
(
ĞĞ  !
FByteConverter
ĞĞ! /
.
ĞĞ/ 0
getBytes
ĞĞ0 8
(
ĞĞ8 9
m_sessionId
ĞĞ9 D
,
ĞĞD E
true
ĞĞF J
)
ĞĞJ K
,
ĞĞK L
$num
ĞĞM N
,
ĞĞN O
binData
ĞĞP W
,
ĞĞW X
pos
ĞĞY \
,
ĞĞ\ ]
$num
ĞĞ^ _
)
ĞĞ_ `
;
ĞĞ` a
pos
ÑÑ 
+=
ÑÑ 
$num
ÑÑ 
;
ÑÑ 
binData
ÒÒ 
[
ÒÒ 
pos
ÒÒ 
++
ÒÒ 
]
ÒÒ 
=
ÒÒ  
byte2
ÒÒ! &
;
ÒÒ& '
binData
ÓÓ 
[
ÓÓ 
pos
ÓÓ 
++
ÓÓ 
]
ÓÓ 
=
ÓÓ  
byte3
ÓÓ! &
;
ÓÓ& '
binData
ÔÔ 
[
ÔÔ 
pos
ÔÔ 
++
ÔÔ 
]
ÔÔ 
=
ÔÔ  
ptype
ÔÔ! &
;
ÔÔ& '
binData
ÕÕ 
[
ÕÕ 
pos
ÕÕ 
++
ÕÕ 
]
ÕÕ 
=
ÕÕ  
stype
ÕÕ! &
;
ÕÕ& '
Buffer
ÖÖ 
.
ÖÖ 
	BlockCopy
ÖÖ  
(
ÖÖ  !
FByteConverter
ÖÖ! /
.
ÖÖ/ 0
getBytes
ÖÖ0 8
(
ÖÖ8 9
m_systemBytes
ÖÖ9 F
,
ÖÖF G
true
ÖÖH L
)
ÖÖL M
,
ÖÖM N
$num
ÖÖO P
,
ÖÖP Q
binData
ÖÖR Y
,
ÖÖY Z
pos
ÖÖ[ ^
,
ÖÖ^ _
$num
ÖÖ` a
)
ÖÖa b
;
ÖÖb c
pos
×× 
+=
×× 
$num
×× 
;
×× 
if
ŞŞ 
(
ŞŞ 
m_body
ŞŞ 
.
ŞŞ 
Count
ŞŞ  
>
ŞŞ! "
$num
ŞŞ# $
)
ŞŞ$ %
{
ßß 
Buffer
àà 
.
àà 
	BlockCopy
àà $
(
àà$ %
m_body
àà% +
.
àà+ ,
ToArray
àà, 3
(
àà3 4
)
àà4 5
,
àà5 6
$num
àà7 8
,
àà8 9
binData
àà: A
,
ààA B
pos
ààC F
,
ààF G
m_body
ààH N
.
ààN O
Count
ààO T
)
ààT U
;
ààU V
}
áá 
return
åå 
binData
åå 
;
åå 
}
ææ 
catch
çç 
(
çç 
	Exception
çç 
ex
çç 
)
çç  
{
èè 
FDebug
éé 
.
éé 
throwException
éé %
(
éé% &
ex
éé& (
)
éé( )
;
éé) *
}
êê 
finally
ëë 
{
ìì 
}
îî 
return
ïï 
null
ïï 
;
ïï 
}
ğğ 	
internal
ôô !
FSecs1SendBlockList
ôô $#
getSecs1SendBlockList
ôô% :
(
ôô: ;
)
õõ 
{
öö 	
const
÷÷ 
int
÷÷ 
MAX_BODY_SIZE
÷÷ #
=
÷÷$ %
$num
÷÷& )
;
÷÷) *!
FSecs1SendBlockList
ùù 

fBlockList
ùù  *
=
ùù+ ,
null
ùù- 1
;
ùù1 2
FSecs1SendBlock
úú 
fBlock
úú "
=
úú# $
null
úú% )
;
úú) *
int
ûû 
blockCnt
ûû 
=
ûû 
$num
ûû 
;
ûû 
UInt16
üü 
blockNo
üü 
=
üü 
$num
üü 
;
üü 
bool
ıı 
ebit
ıı 
=
ıı 
false
ıı 
;
ıı 
byte
şş 
[
şş 
]
şş 
body
şş 
=
şş 
null
şş 
;
şş 
int
ÿÿ 
pos
ÿÿ 
=
ÿÿ 
$num
ÿÿ 
;
ÿÿ 
int
€€ 
copyLen
€€ 
=
€€ 
$num
€€ 
;
€€ 
try
‚‚ 
{
ƒƒ 

fBlockList
„„ 
=
„„ 
new
„„  !
FSecs1SendBlockList
„„! 4
(
„„4 5
m_fSecs1ToHsms
„„5 C
,
„„C D
this
„„E I
)
„„I J
;
„„J K
if
ŒŒ 
(
ŒŒ 
m_body
ŒŒ 
.
ŒŒ 
Count
ŒŒ  
==
ŒŒ! #
$num
ŒŒ$ %
)
ŒŒ% &
{
 
blockCnt
 
=
 
$num
  
;
  !
}
 
else
 
{
‘‘ 
blockCnt
’’ 
=
’’ 
m_body
’’ %
.
’’% &
Count
’’& +
/
’’, -
MAX_BODY_SIZE
’’. ;
;
’’; <
blockCnt
““ 
+=
““ 
(
““  !
m_body
““! '
.
““' (
Count
““( -
%
““. /
MAX_BODY_SIZE
““0 =
>
““> ?
$num
““@ A
?
““B C
$num
““D E
:
““F G
$num
““H I
)
““I J
;
““J K
}
”” 
for
˜˜ 
(
˜˜ 
int
˜˜ 
i
˜˜ 
=
˜˜ 
$num
˜˜ 
;
˜˜ 
i
˜˜  !
<
˜˜" #
blockCnt
˜˜$ ,
;
˜˜, -
i
˜˜. /
++
˜˜/ 1
)
˜˜1 2
{
™™ 
blockNo
šš 
++
šš 
;
šš 
if
¡¡ 
(
¡¡ 
i
¡¡ 
==
¡¡ 
blockCnt
¡¡ %
-
¡¡& '
$num
¡¡( )
)
¡¡) *
{
¢¢ 
ebit
££ 
=
££ 
true
££ #
;
££# $
if
¤¤ 
(
¤¤ 
m_body
¤¤ "
.
¤¤" #
Count
¤¤# (
==
¤¤) +
$num
¤¤, -
)
¤¤- .
{
¥¥ 
copyLen
¦¦ #
=
¦¦$ %
$num
¦¦& '
;
¦¦' (
}
§§ 
else
¨¨ 
{
©© 
copyLen
ªª #
=
ªª$ %
m_body
ªª& ,
.
ªª, -
Count
ªª- 2
%
ªª3 4
MAX_BODY_SIZE
ªª5 B
;
ªªB C
if
«« 
(
««  
copyLen
««  '
==
««( *
$num
««+ ,
)
««, -
{
¬¬ 
copyLen
­­  '
=
­­( )
MAX_BODY_SIZE
­­* 7
;
­­7 8
}
®® 
}
¯¯ 
}
°° 
else
±± 
{
²² 
ebit
³³ 
=
³³ 
false
³³ $
;
³³$ %
copyLen
´´ 
=
´´  !
MAX_BODY_SIZE
´´" /
;
´´/ 0
}
µµ 
body
¸¸ 
=
¸¸ 
m_body
¸¸ !
.
¸¸! "
GetRange
¸¸" *
(
¸¸* +
pos
¸¸+ .
,
¸¸. /
copyLen
¸¸0 7
)
¸¸7 8
.
¸¸8 9
ToArray
¸¸9 @
(
¸¸@ A
)
¸¸A B
;
¸¸B C
pos
¹¹ 
+=
¹¹ 
copyLen
¹¹ "
;
¹¹" #
fBlock
½½ 
=
½½ 
new
½½  
FSecs1SendBlock
½½! 0
(
½½0 1

fBlockList
¾¾ "
,
¾¾" #
m_fSecs1ToHsms
¿¿ &
.
¿¿& '
fSecs1Config
¿¿' 3
.
¿¿3 4
rbit
¿¿4 8
,
¿¿8 9
m_sessionId
ÀÀ #
,
ÀÀ# $
m_wbit
ÁÁ 
,
ÁÁ 
m_stream
ÂÂ  
,
ÂÂ  !

m_function
ÃÃ "
,
ÃÃ" #
ebit
ÄÄ 
,
ÄÄ 
blockNo
ÅÅ 
,
ÅÅ  
systemBytes
ÆÆ #
,
ÆÆ# $
body
ÇÇ 
)
ÈÈ 
;
ÈÈ 

fBlockList
ÊÊ 
.
ÊÊ 
addBlock
ÊÊ '
(
ÊÊ' (
fBlock
ÊÊ( .
)
ÊÊ. /
;
ÊÊ/ 0
}
ËË 
return
ÍÍ 

fBlockList
ÍÍ !
;
ÍÍ! "
}
ÎÎ 
catch
ÏÏ 
(
ÏÏ 
	Exception
ÏÏ 
ex
ÏÏ 
)
ÏÏ  
{
ĞĞ 
FDebug
ÑÑ 
.
ÑÑ 
throwException
ÑÑ %
(
ÑÑ% &
ex
ÑÑ& (
)
ÑÑ( )
;
ÑÑ) *
}
ÒÒ 
finally
ÓÓ 
{
ÔÔ 
}
ÖÖ 
return
×× 
null
×× 
;
×× 
}
ØØ 	
public
ÜÜ 
FXmlNode
ÜÜ 
convertToXmlNode
ÜÜ (
(
ÜÜ( )
)
İİ 
{
ŞŞ 	
try
ßß 
{
àà 
return
áá 
FSecsConverter
áá %
.
áá% &!
convertBinToXmlNode
áá& 9
(
áá9 :
m_sessionId
áá: E
,
ááE F
m_stream
ááG O
,
ááO P

m_function
ááQ [
,
áá[ \
m_wbit
áá] c
,
áác d
m_systemBytes
ááe r
,
áár s
m_body
áát z
.
ááz {
ToArrayáá{ ‚
(áá‚ ƒ
)ááƒ „
)áá„ …
;áá… †
}
ââ 
catch
ãã 
(
ãã 
	Exception
ãã 
ex
ãã 
)
ãã  
{
ää 
FDebug
åå 
.
åå 
throwException
åå %
(
åå% &
ex
åå& (
)
åå( )
;
åå) *
}
ææ 
finally
çç 
{
èè 
}
êê 
return
ëë 
null
ëë 
;
ëë 
}
ìì 	
}
òò 
}óó Şh
vD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\SecsMessage\c_FSecsBlock.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
public 

class 

FSecsBlock 
: 
IDisposable (
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FSecs1ToHsms 
m_fSecs1ToHsms +
=, -
null. 2
;2 3
private 
byte 
m_length 
= 
$num  !
;! "
private 
List 
< 
byte 
> 
m_blockData &
=' (
null) -
;- .
private!! 
bool!! 
m_rbit!! 
=!! 
false!! #
;!!# $
private"" 
UInt16"" 
m_sessionId"" "
=""# $
$num""% &
;""& '
private## 
bool## 
m_wbit## 
=## 
false## #
;### $
private$$ 
byte$$ 
m_stream$$ 
=$$ 
$num$$  !
;$$! "
private%% 
byte%% 

m_function%% 
=%%  !
$num%%" #
;%%# $
private&& 
bool&& 
m_ebit&& 
=&& 
false&& #
;&&# $
private'' 
UInt16'' 
	m_blockNo''  
=''! "
$num''# $
;''$ %
private(( 
UInt32(( 
m_systemBytes(( $
=((% &
$num((' (
;((( )
private)) 
List)) 
<)) 
byte)) 
>)) 
m_body)) !
=))" #
null))$ (
;))( )
private** 
UInt16** 

m_checkSum** !
=**" #
$num**$ %
;**% &
internal00 

FSecsBlock00 
(00 
FSecs1ToHsms11 
fSecs1ToHsms11 %
,11% &
byte22 
length22 
,22 
byte33 
[33 
]33 
	blockData33 
,33 
bool44 
rbit44 
,44 
UInt1655 
	sessionId55 
,55 
bool66 
wbit66 
,66 
byte77 
stream77 
,77 
byte88 
function88 
,88 
bool99 
ebit99 
,99 
UInt16:: 
blockNo:: 
,:: 
UInt32;; 
systemBytes;; 
,;; 
byte<< 
[<< 
]<< 
body<< 
,<< 
UInt16== 
checkSum== 
)>> 
{?? 	
m_fSecs1ToHsms@@ 
=@@ 
fSecs1ToHsms@@ )
;@@) *
m_lengthBB 
=BB 
lengthBB 
;BB 
m_blockDataCC 
=CC 
newCC 
ListCC "
<CC" #
byteCC# '
>CC' (
(CC( )
	blockDataCC) 2
)CC2 3
;CC3 4
m_rbitEE 
=EE 
rbitEE 
;EE 
m_sessionIdFF 
=FF 
	sessionIdFF #
;FF# $
m_wbitGG 
=GG 
wbitGG 
;GG 
m_streamHH 
=HH 
streamHH 
;HH 

m_functionII 
=II 
functionII !
;II! "
m_ebitJJ 
=JJ 
ebitJJ 
;JJ 
	m_blockNoKK 
=KK 
blockNoKK 
;KK  
m_systemBytesLL 
=LL 
systemBytesLL '
;LL' (
m_bodyMM 
=MM 
newMM 
ListMM 
<MM 
byteMM "
>MM" #
(MM# $
bodyMM$ (
)MM( )
;MM) *

m_checkSumNN 
=NN 
checkSumNN !
;NN! "
}OO 	
~SS 	

FSecsBlockSS	 
(SS 
)TT 
{UU 	
	myDisposeVV 
(VV 
falseVV 
)VV 
;VV 
}WW 	
	protected[[ 
void[[ 
	myDispose[[  
([[  !
bool\\ 
	disposing\\ 
)]] 
{^^ 	
if__ 
(__ 
!__ 

m_disposed__ 
)__ 
{`` 
ifaa 
(aa 
	disposingaa 
)aa 
{bb 
m_fSecs1ToHsmscc "
=cc# $
nullcc% )
;cc) *
m_blockDatadd 
=dd  !
nulldd" &
;dd& '
m_bodyee 
=ee 
nullee !
;ee! "
}ff 

m_disposedhh 
=hh 
truehh !
;hh! "
}ii 
}jj 	
publicrr 
voidrr 
Disposerr 
(rr 
)ss 
{tt 	
	myDisposeuu 
(uu 
trueuu 
)uu 
;uu 
GCvv 
.vv 
SuppressFinalizevv 
(vv  
thisvv  $
)vv$ %
;vv% &
}ww 	
public 
byte 
length 
{
€€ 	
get
 
{
‚‚ 
try
ƒƒ 
{
„„ 
return
…… 
m_length
…… #
;
……# $
}
†† 
catch
‡‡ 
(
‡‡ 
	Exception
‡‡  
ex
‡‡! #
)
‡‡# $
{
ˆˆ 
FDebug
‰‰ 
.
‰‰ 
throwException
‰‰ )
(
‰‰) *
ex
‰‰* ,
)
‰‰, -
;
‰‰- .
}
ŠŠ 
finally
‹‹ 
{
ŒŒ 
}
 
return
 
$num
 
;
 
}
 
}
‘‘ 	
public
•• 
byte
•• 
[
•• 
]
•• 
	blockData
•• 
{
–– 	
get
—— 
{
˜˜ 
try
™™ 
{
šš 
return
›› 
m_blockData
›› &
.
››& '
ToArray
››' .
(
››. /
)
››/ 0
;
››0 1
}
œœ 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
ŸŸ 
.
ŸŸ 
throwException
ŸŸ )
(
ŸŸ) *
ex
ŸŸ* ,
)
ŸŸ, -
;
ŸŸ- .
}
   
finally
¡¡ 
{
¢¢ 
}
¤¤ 
return
¥¥ 
null
¥¥ 
;
¥¥ 
}
¦¦ 
}
§§ 	
public
«« 
bool
«« 
rbit
«« 
{
¬¬ 	
get
­­ 
{
®® 
try
¯¯ 
{
°° 
return
±± 
m_rbit
±± !
;
±±! "
}
²² 
catch
³³ 
(
³³ 
	Exception
³³  
ex
³³! #
)
³³# $
{
´´ 
FDebug
µµ 
.
µµ 
throwException
µµ )
(
µµ) *
ex
µµ* ,
)
µµ, -
;
µµ- .
}
¶¶ 
finally
·· 
{
¸¸ 
}
ºº 
return
»» 
false
»» 
;
»» 
}
¼¼ 
}
½½ 	
public
ÁÁ 
UInt16
ÁÁ 
	sessionId
ÁÁ 
{
ÂÂ 	
get
ÃÃ 
{
ÄÄ 
try
ÅÅ 
{
ÆÆ 
return
ÇÇ 
m_sessionId
ÇÇ &
;
ÇÇ& '
}
ÈÈ 
catch
ÉÉ 
(
ÉÉ 
	Exception
ÉÉ  
ex
ÉÉ! #
)
ÉÉ# $
{
ÊÊ 
FDebug
ËË 
.
ËË 
throwException
ËË )
(
ËË) *
ex
ËË* ,
)
ËË, -
;
ËË- .
}
ÌÌ 
finally
ÍÍ 
{
ÎÎ 
}
ĞĞ 
return
ÑÑ 
$num
ÑÑ 
;
ÑÑ 
}
ÒÒ 
}
ÓÓ 	
public
×× 
bool
×× 
wbit
×× 
{
ØØ 	
get
ÙÙ 
{
ÚÚ 
try
ÛÛ 
{
ÜÜ 
return
İİ 
m_wbit
İİ !
;
İİ! "
}
ŞŞ 
catch
ßß 
(
ßß 
	Exception
ßß  
ex
ßß! #
)
ßß# $
{
àà 
FDebug
áá 
.
áá 
throwException
áá )
(
áá) *
ex
áá* ,
)
áá, -
;
áá- .
}
ââ 
finally
ãã 
{
ää 
}
ææ 
return
çç 
false
çç 
;
çç 
}
èè 
}
éé 	
public
íí 
byte
íí 
stream
íí 
{
îî 	
get
ïï 
{
ğğ 
try
ññ 
{
òò 
return
óó 
m_stream
óó #
;
óó# $
}
ôô 
catch
õõ 
(
õõ 
	Exception
õõ  
ex
õõ! #
)
õõ# $
{
öö 
FDebug
÷÷ 
.
÷÷ 
throwException
÷÷ )
(
÷÷) *
ex
÷÷* ,
)
÷÷, -
;
÷÷- .
}
øø 
finally
ùù 
{
úú 
}
üü 
return
ıı 
$num
ıı 
;
ıı 
}
şş 
}
ÿÿ 	
public
ƒƒ 
byte
ƒƒ 
function
ƒƒ 
{
„„ 	
get
…… 
{
†† 
try
‡‡ 
{
ˆˆ 
return
‰‰ 

m_function
‰‰ %
;
‰‰% &
}
ŠŠ 
catch
‹‹ 
(
‹‹ 
	Exception
‹‹  
ex
‹‹! #
)
‹‹# $
{
ŒŒ 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
 
{
 
}
’’ 
return
““ 
$num
““ 
;
““ 
}
”” 
}
•• 	
public
™™ 
bool
™™ 
ebit
™™ 
{
šš 	
get
›› 
{
œœ 
try
 
{
 
return
ŸŸ 
m_ebit
ŸŸ !
;
ŸŸ! "
}
   
catch
¡¡ 
(
¡¡ 
	Exception
¡¡  
ex
¡¡! #
)
¡¡# $
{
¢¢ 
FDebug
££ 
.
££ 
throwException
££ )
(
££) *
ex
££* ,
)
££, -
;
££- .
}
¤¤ 
finally
¥¥ 
{
¦¦ 
}
¨¨ 
return
©© 
false
©© 
;
©© 
}
ªª 
}
«« 	
public
¯¯ 
UInt16
¯¯ 
blockNo
¯¯ 
{
°° 	
get
±± 
{
²² 
try
³³ 
{
´´ 
return
µµ 
	m_blockNo
µµ $
;
µµ$ %
}
¶¶ 
catch
·· 
(
·· 
	Exception
··  
ex
··! #
)
··# $
{
¸¸ 
FDebug
¹¹ 
.
¹¹ 
throwException
¹¹ )
(
¹¹) *
ex
¹¹* ,
)
¹¹, -
;
¹¹- .
}
ºº 
finally
»» 
{
¼¼ 
}
¾¾ 
return
¿¿ 
$num
¿¿ 
;
¿¿ 
}
ÀÀ 
}
ÁÁ 	
public
ÅÅ 
UInt32
ÅÅ 
systemBytes
ÅÅ !
{
ÆÆ 	
get
ÇÇ 
{
ÈÈ 
try
ÉÉ 
{
ÊÊ 
return
ËË 
m_systemBytes
ËË (
;
ËË( )
}
ÌÌ 
catch
ÍÍ 
(
ÍÍ 
	Exception
ÍÍ  
ex
ÍÍ! #
)
ÍÍ# $
{
ÎÎ 
FDebug
ÏÏ 
.
ÏÏ 
throwException
ÏÏ )
(
ÏÏ) *
ex
ÏÏ* ,
)
ÏÏ, -
;
ÏÏ- .
}
ĞĞ 
finally
ÑÑ 
{
ÒÒ 
}
ÔÔ 
return
ÕÕ 
$num
ÕÕ 
;
ÕÕ 
}
ÖÖ 
}
×× 	
public
ÛÛ 
byte
ÛÛ 
[
ÛÛ 
]
ÛÛ 
body
ÛÛ 
{
ÜÜ 	
get
İİ 
{
ŞŞ 
try
ßß 
{
àà 
return
áá 
m_body
áá !
.
áá! "
ToArray
áá" )
(
áá) *
)
áá* +
;
áá+ ,
}
ââ 
catch
ãã 
(
ãã 
	Exception
ãã  
ex
ãã! #
)
ãã# $
{
ää 
FDebug
åå 
.
åå 
throwException
åå )
(
åå) *
ex
åå* ,
)
åå, -
;
åå- .
}
ææ 
finally
çç 
{
èè 
}
êê 
return
ëë 
null
ëë 
;
ëë 
}
ìì 
}
íí 	
public
ññ 
UInt16
ññ 
checkSum
ññ 
{
òò 	
get
óó 
{
ôô 
try
õõ 
{
öö 
return
÷÷ 

m_checkSum
÷÷ %
;
÷÷% &
}
øø 
catch
ùù 
(
ùù 
	Exception
ùù  
ex
ùù! #
)
ùù# $
{
úú 
FDebug
ûû 
.
ûû 
throwException
ûû )
(
ûû) *
ex
ûû* ,
)
ûû, -
;
ûû- .
}
üü 
finally
ıı 
{
şş 
}
€€ 
return
 
$num
 
;
 
}
‚‚ 
}
ƒƒ 	
}
 
} Êe
D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\SecsMessage\c_FSecsControlMessage.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
public 

class 
FSecsControlMessage $
:$ %
IDisposable& 1
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FSecs1ToHsms 
m_fSecs1ToHsms +
=, -
null. 2
;2 3
private #
FHsmsControlMessageType '
m_fType( /
=0 1#
FHsmsControlMessageType2 I
.I J
	SelectReqJ S
;S T
private 
UInt16 
m_sessionId "
=# $
$num% &
;& '
private   
byte   
m_byte2   
=   
$num    
;    !
private!! 
byte!! 
m_byte3!! 
=!! 
$num!!  
;!!  !
private"" 
byte"" 
m_ptype"" 
="" 
$num""  
;""  !
private## 
byte## 
m_stype## 
=## 
$num##  
;##  !
private$$ 
UInt32$$ 
m_systemBytes$$ $
=$$% &
$num$$' (
;$$( )
private%% 
string%% 
m_reason%% 
=%%  !
string%%" (
.%%( )
Empty%%) .
;%%. /
internal++ 
FSecsControlMessage++ $
(++$ %
FSecs1ToHsms,, 
fSecs1ToHsms,, %
,,,% &#
FHsmsControlMessageType-- #
fType--$ )
,--) *
UInt16.. 
	sessionId.. 
,.. 
byte// 
byte2// 
,// 
byte00 
byte300 
,00 
byte11 
ptype11 
,11 
byte22 
stype22 
,22 
UInt3233 
systemBytes33 
,33 
string44 
reason44 
)55 
{66 	
m_fSecs1ToHsms77 
=77 
fSecs1ToHsms77 )
;77) *
m_fType99 
=99 
fType99 
;99 
m_sessionId:: 
=:: 
	sessionId:: #
;::# $
m_byte2;; 
=;; 
byte2;; 
;;; 
m_byte3<< 
=<< 
byte3<< 
;<< 
m_ptype== 
=== 
ptype== 
;== 
m_stype>> 
=>> 
stype>> 
;>> 
m_systemBytes?? 
=?? 
systemBytes?? '
;??' (
m_reason@@ 
=@@ 
reason@@ 
;@@ 
}AA 	
~EE 	
FSecsControlMessageEE	 
(EE 
)FF 
{GG 	
	myDisposeHH 
(HH 
falseHH 
)HH 
;HH 
}II 	
	protectedMM 
voidMM 
	myDisposeMM  
(MM  !
boolNN 
	disposingNN 
)OO 
{PP 	
ifQQ 
(QQ 
!QQ 

m_disposedQQ 
)QQ 
{RR 
ifSS 
(SS 
	disposingSS 
)SS 
{TT 
m_fSecs1ToHsmsUU "
=UU# $
nullUU% )
;UU) *
}VV 

m_disposedXX 
=XX 
trueXX !
;XX! "
}YY 
}ZZ 	
publicbb 
voidbb 
Disposebb 
(bb 
)cc 
{dd 	
	myDisposeee 
(ee 
trueee 
)ee 
;ee 
GCff 
.ff 
SuppressFinalizeff 
(ff  
thisff  $
)ff$ %
;ff% &
}gg 	
publicoo #
FHsmsControlMessageTypeoo &
fTypeoo' ,
{pp 	
getqq 
{rr 
tryss 
{tt 
returnuu 
m_fTypeuu "
;uu" #
}vv 
catchww 
(ww 
	Exceptionww  
exww! #
)ww# $
{xx 
FDebugyy 
.yy 
throwExceptionyy )
(yy) *
exyy* ,
)yy, -
;yy- .
}zz 
finally{{ 
{|| 
}~~ 
return #
FHsmsControlMessageType .
.. /
	SelectReq/ 8
;8 9
}
€€ 
}
 	
public
…… 
int
…… 
length
…… 
{
†† 	
get
‡‡ 
{
ˆˆ 
try
‰‰ 
{
ŠŠ 
return
‹‹ 
$num
‹‹ 
;
‹‹ 
}
ŒŒ 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
‘‘ 
{
’’ 
}
”” 
return
•• 
$num
•• 
;
•• 
}
–– 
}
—— 	
public
›› 
UInt16
›› 
	sessionId
›› 
{
œœ 	
get
 
{
 
try
ŸŸ 
{
   
return
¡¡ 
m_sessionId
¡¡ &
;
¡¡& '
}
¢¢ 
catch
££ 
(
££ 
	Exception
££  
ex
££! #
)
££# $
{
¤¤ 
FDebug
¥¥ 
.
¥¥ 
throwException
¥¥ )
(
¥¥) *
ex
¥¥* ,
)
¥¥, -
;
¥¥- .
}
¦¦ 
finally
§§ 
{
¨¨ 
}
ªª 
return
«« 
$num
«« 
;
«« 
}
¬¬ 
}
­­ 	
public
±± 
byte
±± 
byte2
±± 
{
²² 	
get
³³ 
{
´´ 
try
µµ 
{
¶¶ 
return
·· 
m_byte2
·· "
;
··" #
}
¸¸ 
catch
¹¹ 
(
¹¹ 
	Exception
¹¹  
ex
¹¹! #
)
¹¹# $
{
ºº 
FDebug
»» 
.
»» 
throwException
»» )
(
»») *
ex
»»* ,
)
»», -
;
»»- .
}
¼¼ 
finally
½½ 
{
¾¾ 
}
ÀÀ 
return
ÁÁ 
$num
ÁÁ 
;
ÁÁ 
}
ÂÂ 
}
ÃÃ 	
public
ÇÇ 
byte
ÇÇ 
byte3
ÇÇ 
{
ÈÈ 	
get
ÉÉ 
{
ÊÊ 
try
ËË 
{
ÌÌ 
return
ÍÍ 
m_byte3
ÍÍ "
;
ÍÍ" #
}
ÎÎ 
catch
ÏÏ 
(
ÏÏ 
	Exception
ÏÏ  
ex
ÏÏ! #
)
ÏÏ# $
{
ĞĞ 
FDebug
ÑÑ 
.
ÑÑ 
throwException
ÑÑ )
(
ÑÑ) *
ex
ÑÑ* ,
)
ÑÑ, -
;
ÑÑ- .
}
ÒÒ 
finally
ÓÓ 
{
ÔÔ 
}
ÖÖ 
return
×× 
$num
×× 
;
×× 
}
ØØ 
}
ÙÙ 	
public
İİ 
byte
İİ 
ptype
İİ 
{
ŞŞ 	
get
ßß 
{
àà 
try
áá 
{
ââ 
return
ãã 
m_ptype
ãã "
;
ãã" #
}
ää 
catch
åå 
(
åå 
	Exception
åå  
ex
åå! #
)
åå# $
{
ææ 
FDebug
çç 
.
çç 
throwException
çç )
(
çç) *
ex
çç* ,
)
çç, -
;
çç- .
}
èè 
finally
éé 
{
êê 
}
ìì 
return
íí 
$num
íí 
;
íí 
}
îî 
}
ïï 	
public
óó 
byte
óó 
stype
óó 
{
ôô 	
get
õõ 
{
öö 
try
÷÷ 
{
øø 
return
ùù 
m_stype
ùù "
;
ùù" #
}
úú 
catch
ûû 
(
ûû 
	Exception
ûû  
ex
ûû! #
)
ûû# $
{
üü 
FDebug
ıı 
.
ıı 
throwException
ıı )
(
ıı) *
ex
ıı* ,
)
ıı, -
;
ıı- .
}
şş 
finally
ÿÿ 
{
€€ 
}
‚‚ 
return
ƒƒ 
$num
ƒƒ 
;
ƒƒ 
}
„„ 
}
…… 	
public
‰‰ 
UInt32
‰‰ 
systemBytes
‰‰ !
{
ŠŠ 	
get
‹‹ 
{
ŒŒ 
try
 
{
 
return
 
m_systemBytes
 (
;
( )
}
 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘  
ex
‘‘! #
)
‘‘# $
{
’’ 
FDebug
““ 
.
““ 
throwException
““ )
(
““) *
ex
““* ,
)
““, -
;
““- .
}
”” 
finally
•• 
{
–– 
}
˜˜ 
return
™™ 
$num
™™ 
;
™™ 
}
šš 
}
›› 	
public
ŸŸ 
string
ŸŸ 
reason
ŸŸ 
{
   	
get
¡¡ 
{
¢¢ 
try
££ 
{
¤¤ 
return
¥¥ 
m_reason
¥¥ #
;
¥¥# $
}
¦¦ 
catch
§§ 
(
§§ 
	Exception
§§  
ex
§§! #
)
§§# $
{
¨¨ 
FDebug
©© 
.
©© 
throwException
©© )
(
©©) *
ex
©©* ,
)
©©, -
;
©©- .
}
ªª 
finally
«« 
{
¬¬ 
}
®® 
return
¯¯ 
string
¯¯ 
.
¯¯ 
Empty
¯¯ #
;
¯¯# $
}
°° 
}
±± 	
internal
¹¹ 
byte
¹¹ 
[
¹¹ 
]
¹¹ 
getBinaryData
¹¹ %
(
¹¹% &
)
ºº 
{
»» 	
UInt32
¼¼ 
length
¼¼ 
=
¼¼ 
$num
¼¼ 
;
¼¼ 
byte
½½ 
[
½½ 
]
½½ 
data
½½ 
=
½½ 
null
½½ 
;
½½ 
try
¿¿ 
{
ÀÀ 
length
ÁÁ 
=
ÁÁ 
$num
ÁÁ 
;
ÁÁ 
data
ÂÂ 
=
ÂÂ 
new
ÂÂ 
byte
ÂÂ 
[
ÂÂ  
length
ÂÂ  &
+
ÂÂ' (
$num
ÂÂ) *
]
ÂÂ* +
;
ÂÂ+ ,
Buffer
ÉÉ 
.
ÉÉ 
	BlockCopy
ÉÉ  
(
ÉÉ  !
FByteConverter
ÉÉ! /
.
ÉÉ/ 0
getBytes
ÉÉ0 8
(
ÉÉ8 9
length
ÉÉ9 ?
,
ÉÉ? @
true
ÉÉA E
)
ÉÉE F
,
ÉÉF G
$num
ÉÉH I
,
ÉÉI J
data
ÉÉK O
,
ÉÉO P
$num
ÉÉQ R
,
ÉÉR S
$num
ÉÉT U
)
ÉÉU V
;
ÉÉV W
Buffer
ĞĞ 
.
ĞĞ 
	BlockCopy
ĞĞ  
(
ĞĞ  !
FByteConverter
ĞĞ! /
.
ĞĞ/ 0
getBytes
ĞĞ0 8
(
ĞĞ8 9
m_sessionId
ĞĞ9 D
,
ĞĞD E
true
ĞĞF J
)
ĞĞJ K
,
ĞĞK L
$num
ĞĞM N
,
ĞĞN O
data
ĞĞP T
,
ĞĞT U
$num
ĞĞV W
,
ĞĞW X
$num
ĞĞY Z
)
ĞĞZ [
;
ĞĞ[ \
data
ÑÑ 
[
ÑÑ 
$num
ÑÑ 
]
ÑÑ 
=
ÑÑ 
m_byte2
ÑÑ !
;
ÑÑ! "
data
ÒÒ 
[
ÒÒ 
$num
ÒÒ 
]
ÒÒ 
=
ÒÒ 
m_byte3
ÒÒ !
;
ÒÒ! "
data
ÓÓ 
[
ÓÓ 
$num
ÓÓ 
]
ÓÓ 
=
ÓÓ 
m_ptype
ÓÓ !
;
ÓÓ! "
data
ÔÔ 
[
ÔÔ 
$num
ÔÔ 
]
ÔÔ 
=
ÔÔ 
m_stype
ÔÔ !
;
ÔÔ! "
Buffer
ÕÕ 
.
ÕÕ 
	BlockCopy
ÕÕ  
(
ÕÕ  !
FByteConverter
ÕÕ! /
.
ÕÕ/ 0
getBytes
ÕÕ0 8
(
ÕÕ8 9
m_systemBytes
ÕÕ9 F
,
ÕÕF G
true
ÕÕH L
)
ÕÕL M
,
ÕÕM N
$num
ÕÕO P
,
ÕÕP Q
data
ÕÕR V
,
ÕÕV W
$num
ÕÕX Z
,
ÕÕZ [
$num
ÕÕ\ ]
)
ÕÕ] ^
;
ÕÕ^ _
return
ÙÙ 
data
ÙÙ 
;
ÙÙ 
}
ÚÚ 
catch
ÛÛ 
(
ÛÛ 
	Exception
ÛÛ 
ex
ÛÛ 
)
ÛÛ  
{
ÜÜ 
FDebug
İİ 
.
İİ 
throwException
İİ %
(
İİ% &
ex
İİ& (
)
İİ( )
;
İİ) *
}
ŞŞ 
finally
ßß 
{
àà 
data
áá 
=
áá 
null
áá 
;
áá 
}
ââ 
return
ãã 
null
ãã 
;
ãã 
}
ää 	
}
êê 
}ëë d
„D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Secs1ToHsms\SecsMessage\c_FSecsDataMessageTransfer.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSecs1ToHsms (
{ 
public 

class $
FSecsDataMessageTransfer )
:) *
IDisposable+ 6
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FSecs1ToHsms 
m_fSecs1ToHsms +
=, -
null. 2
;2 3
private 
FXmlNode 
m_fXmlNodeSmg &
=' (
null) -
;- .
public## $
FSecsDataMessageTransfer## '
(##' (
FSecs1ToHsms$$ 
fSecs1ToHsms$$ %
,$$% &
FXmlNode%% 
fXmlNodeSmg%%  
)&& 
{'' 	
m_fSecs1ToHsms(( 
=(( 
fSecs1ToHsms(( )
;(() *
m_fXmlNodeSmg)) 
=)) 
fXmlNodeSmg)) '
;))' (
validate** 
(** 
)** 
;** 
}++ 	
~// 	$
FSecsDataMessageTransfer//	 !
(//! "
)00 
{11 	
	myDispose22 
(22 
false22 
)22 
;22 
}33 	
	protected77 
void77 
	myDispose77  
(77  !
bool88 
	disposing88 
)99 
{:: 	
if;; 
(;; 
!;; 

m_disposed;; 
);; 
{<< 
if== 
(== 
	disposing== 
)== 
{>> 
m_fXmlNodeSmg?? !
=??" #
null??$ (
;??( )
m_fSecs1ToHsms@@ "
=@@# $
null@@% )
;@@) *
}AA 

m_disposedCC 
=CC 
trueCC !
;CC! "
}DD 
}EE 	
publicMM 
voidMM 
DisposeMM 
(MM 
)NN 
{OO 	
	myDisposePP 
(PP 
truePP 
)PP 
;PP 
GCQQ 
.QQ 
SuppressFinalizeQQ 
(QQ  
thisQQ  $
)QQ$ %
;QQ% &
}RR 	
publicZZ 
FXmlNodeZZ 
fXmlNodeSmgZZ #
{[[ 	
get\\ 
{]] 
try^^ 
{__ 
return`` 
m_fXmlNodeSmg`` (
;``( )
}aa 
catchbb 
(bb 
	Exceptionbb  
exbb! #
)bb# $
{cc 
FDebugdd 
.dd 
throwExceptiondd )
(dd) *
exdd* ,
)dd, -
;dd- .
}ee 
finallyff 
{gg 
}ii 
returnjj 
nulljj 
;jj 
}kk 
}ll 	
privatett 
voidtt 
validatett 
(tt 
)uu 
{vv 	
stringww 
valww 
=ww 
stringww 
.ww  
Emptyww  %
;ww% &
bytexx 
bValxx 
=xx 
$numxx 
;xx 
boolyy 
blValyy 
=yy 
falseyy 
;yy 
UInt16zz 
val16zz 
=zz 
$numzz 
;zz 
UInt32{{ 
val32{{ 
={{ 
$num{{ 
;{{ 
FFormat|| 
fFormat|| 
;|| 
FXmlNodeList}} 
fXmlNodeListSit}} (
=}}) *
null}}+ /
;}}/ 0
try 
{
€€ 
if
„„ 
(
„„ 
fXmlNodeSmg
„„ 
.
„„  
name
„„  $
!=
„„% '
FSecsTag
„„( 0
.
„„0 1
E_SecsMessage
„„1 >
)
„„> ?
{
…… 
FDebug
†† 
.
†† 
throwFException
†† *
(
††* +
$str
††+ Y
)
††Y Z
;
††Z [
}
‡‡ 
val
‰‰ 
=
‰‰ 
fXmlNodeSmg
‰‰ !
.
‰‰! "
get_attrVal
‰‰" -
(
‰‰- .
FSecsTag
‰‰. 6
.
‰‰6 7
A_SessionId
‰‰7 B
,
‰‰B C
string
‰‰D J
.
‰‰J K
Empty
‰‰K P
)
‰‰P Q
;
‰‰Q R
if
ŠŠ 
(
ŠŠ 
!
ŠŠ 
UInt16
ŠŠ 
.
ŠŠ 
TryParse
ŠŠ $
(
ŠŠ$ %
val
ŠŠ% (
,
ŠŠ( )
out
ŠŠ* -
val16
ŠŠ. 3
)
ŠŠ3 4
||
ŠŠ5 7
val16
ŠŠ8 =
>
ŠŠ> ?
$num
ŠŠ@ E
)
ŠŠE F
{
‹‹ 
FDebug
ŒŒ 
.
ŒŒ 
throwFException
ŒŒ *
(
ŒŒ* +
$str
ŒŒ+ W
)
ŒŒW X
;
ŒŒX Y
}
 
val
 
=
 
fXmlNodeSmg
 !
.
! "
get_attrVal
" -
(
- .
FSecsTag
. 6
.
6 7
A_Stream
7 ?
,
? @
string
A G
.
G H
Empty
H M
)
M N
;
N O
if
 
(
 
!
 
byte
 
.
 
TryParse
 "
(
" #
val
# &
,
& '
out
( +
bVal
, 0
)
0 1
||
2 4
bVal
5 9
<
: ;
$num
< =
||
> @
bVal
A E
>
F G
$num
H K
)
K L
{
‘‘ 
FDebug
’’ 
.
’’ 
throwFException
’’ *
(
’’* +
$str
’’+ S
)
’’S T
;
’’T U
}
““ 
val
•• 
=
•• 
fXmlNodeSmg
•• !
.
••! "
get_attrVal
••" -
(
••- .
FSecsTag
••. 6
.
••6 7

A_Function
••7 A
,
••A B
string
••C I
.
••I J
Empty
••J O
)
••O P
;
••P Q
if
–– 
(
–– 
!
–– 
byte
–– 
.
–– 
TryParse
–– "
(
––" #
val
––# &
,
––& '
out
––( +
bVal
––, 0
)
––0 1
||
––2 4
bVal
––5 9
<
––: ;
$num
––< =
||
––> @
bVal
––A E
>
––F G
$num
––H K
)
––K L
{
—— 
FDebug
˜˜ 
.
˜˜ 
throwFException
˜˜ *
(
˜˜* +
$str
˜˜+ U
)
˜˜U V
;
˜˜V W
}
™™ 
val
›› 
=
›› 
fXmlNodeSmg
›› !
.
››! "
get_attrVal
››" -
(
››- .
FSecsTag
››. 6
.
››6 7
A_WBit
››7 =
,
››= >
string
››? E
.
››E F
Empty
››F K
)
››K L
;
››L M
if
œœ 
(
œœ 
!
œœ 
bool
œœ 
.
œœ 
TryParse
œœ "
(
œœ" #
val
œœ# &
,
œœ& '
out
œœ( +
blVal
œœ, 1
)
œœ1 2
)
œœ2 3
{
 
FDebug
 
.
 
throwFException
 *
(
* +
$str
+ Q
)
Q R
;
R S
}
ŸŸ 
val
¡¡ 
=
¡¡ 
fXmlNodeSmg
¡¡ !
.
¡¡! "
get_attrVal
¡¡" -
(
¡¡- .
FSecsTag
¡¡. 6
.
¡¡6 7
A_SystemBytes
¡¡7 D
,
¡¡D E
string
¡¡F L
.
¡¡L M
Empty
¡¡M R
)
¡¡R S
;
¡¡S T
if
¢¢ 
(
¢¢ 
val
¢¢ 
!=
¢¢ 
string
¢¢ !
.
¢¢! "
Empty
¢¢" '
)
¢¢' (
{
££ 
if
¤¤ 
(
¤¤ 
!
¤¤ 
UInt32
¤¤ 
.
¤¤  
TryParse
¤¤  (
(
¤¤( )
val
¤¤) ,
,
¤¤, -
out
¤¤. 1
val32
¤¤2 7
)
¤¤7 8
)
¤¤8 9
{
¥¥ 
FDebug
¦¦ 
.
¦¦ 
throwFException
¦¦ .
(
¦¦. /
$str
¦¦/ \
)
¦¦\ ]
;
¦¦] ^
}
§§ 
}
¨¨ 
if
«« 
(
«« 
fXmlNodeSmg
«« 
.
««  
fChildNodes
««  +
.
««+ ,
count
««, 1
>
««2 3
$num
««4 5
)
««5 6
{
¬¬ 
FDebug
­­ 
.
­­ 
throwFException
­­ *
(
­­* +
$str
­­+ R
)
­­R S
;
­­S T
}
®® 
fXmlNodeListSit
µµ 
=
µµ  !
fXmlNodeSmg
µµ" -
.
µµ- .
selectNodes
µµ. 9
(
µµ9 :
$str
µµ: ?
)
µµ? @
;
µµ@ A
foreach
¶¶ 
(
¶¶ 
FXmlNode
¶¶ !
fXmlNodeSit
¶¶" -
in
¶¶. 0
fXmlNodeListSit
¶¶1 @
)
¶¶@ A
{
·· 
if
¸¸ 
(
¸¸ 
fXmlNodeSit
¸¸ #
.
¸¸# $
name
¸¸$ (
!=
¸¸) +
FSecsTag
¸¸, 4
.
¸¸4 5

E_SecsItem
¸¸5 ?
)
¸¸? @
{
¹¹ 
FDebug
ºº 
.
ºº 
throwFException
ºº .
(
ºº. /
$str
ºº/ Z
)
ººZ [
;
ºº[ \
}
»» 
val
½½ 
=
½½ 
fXmlNodeSit
½½ %
.
½½% &
get_attrVal
½½& 1
(
½½1 2
FSecsTag
½½2 :
.
½½: ;
A_Format
½½; C
,
½½C D
string
½½E K
.
½½K L
Empty
½½L Q
)
½½Q R
;
½½R S
if
¾¾ 
(
¾¾ 
!
¾¾ 
Enum
¾¾ 
.
¾¾ 
TryParse
¾¾ &
<
¾¾& '
FFormat
¾¾' .
>
¾¾. /
(
¾¾/ 0
val
¾¾0 3
,
¾¾3 4
out
¾¾5 8
fFormat
¾¾9 @
)
¾¾@ A
)
¾¾A B
{
¿¿ 
FDebug
ÀÀ 
.
ÀÀ 
throwFException
ÀÀ .
(
ÀÀ. /
$str
ÀÀ/ T
)
ÀÀT U
;
ÀÀU V
}
ÁÁ 
if
ÃÃ 
(
ÃÃ 
fFormat
ÃÃ 
!=
ÃÃ  "
FFormat
ÃÃ# *
.
ÃÃ* +
L
ÃÃ+ ,
&&
ÃÃ- /
fXmlNodeSit
ÃÃ0 ;
.
ÃÃ; <
hasChildNode
ÃÃ< H
)
ÃÃH I
{
ÄÄ 
FDebug
ÅÅ 
.
ÅÅ 
throwFException
ÅÅ .
(
ÅÅ. /
$str
ÅÅ/ T
)
ÅÅT U
;
ÅÅU V
}
ÆÆ 
}
ÇÇ 
}
ÈÈ 
catch
ÉÉ 
(
ÉÉ 
	Exception
ÉÉ 
ex
ÉÉ 
)
ÉÉ  
{
ÊÊ 
FDebug
ËË 
.
ËË 
throwException
ËË %
(
ËË% &
ex
ËË& (
)
ËË( )
;
ËË) *
}
ÌÌ 
finally
ÍÍ 
{
ÎÎ 
fXmlNodeListSit
ÏÏ 
=
ÏÏ  !
null
ÏÏ" &
;
ÏÏ& '
}
ĞĞ 
}
ÑÑ 	
internal
ÕÕ 
FSecsDataMessage
ÕÕ ! 
getSecsDataMessage
ÕÕ" 4
(
ÕÕ4 5
)
ÖÖ 
{
×× 	
try
ØØ 
{
ÙÙ 
return
ÚÚ 
FSecsConverter
ÚÚ %
.
ÚÚ% &)
convertXmlToSecsDataMessage
ÚÚ& A
(
ÚÚA B
m_fSecs1ToHsms
ÚÚB P
,
ÚÚP Q
m_fXmlNodeSmg
ÚÚR _
)
ÚÚ_ `
;
ÚÚ` a
}
ÛÛ 
catch
ÜÜ 
(
ÜÜ 
	Exception
ÜÜ 
ex
ÜÜ 
)
ÜÜ  
{
İİ 
FDebug
ŞŞ 
.
ŞŞ 
throwException
ŞŞ %
(
ŞŞ% &
ex
ŞŞ& (
)
ŞŞ( )
;
ŞŞ) *
}
ßß 
finally
àà 
{
áá 
}
ãã 
return
ää 
null
ää 
;
ää 
}
åå 	
public
éé 
void
éé 
resetSystembytes
éé $
(
éé$ %
)
êê 
{
ëë 	
try
ìì 
{
íí 
m_fXmlNodeSmg
îî 
.
îî 
set_attrVal
îî )
(
îî) *
FSecsTag
îî* 2
.
îî2 3
A_SystemBytes
îî3 @
,
îî@ A
m_fSecs1ToHsms
îîB P
.
îîP Q!
fSystemBytesPointer
îîQ d
.
îîd e
uniqueId
îîe m
.
îîm n
ToString
îîn v
(
îîv w
)
îîw x
)
îîx y
;
îîy z
}
ïï 
catch
ğğ 
(
ğğ 
	Exception
ğğ 
ex
ğğ 
)
ğğ  
{
ññ 
FDebug
òò 
.
òò 
throwException
òò %
(
òò% &
ex
òò& (
)
òò( )
;
òò) *
}
óó 
finally
ôô 
{
õõ 
}
÷÷ 
}
øø 	
}
şş 
}ÿÿ ”
iD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str :
): ;
]; <
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 E
)		E F
]		F G
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str )
)) *
]* +
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str 5
)5 6
]6 7
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str A
)A B
]B C
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str '
)' (
]( )
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## %
)##% &
]##& '
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ )
)$$) *
]$$* +‹>
xD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\SerialToEthernet\Event\c_FEventHandler.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSerialToEthernet -
{ 
public 

class 
FEventHandler 
: 
IDisposable  +
{ 
public 
event $
FEventRaisedEventHandler -
EventRaised. 9
=: ;
null< @
;@ A
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FSerialToEthernet !
m_fSerialToEthernet" 5
=6 7
null8 <
;< =
private 
Control 
	m_invoker !
=" #
null$ (
;( )
public%% 
FEventHandler%% 
(%% 
FSerialToEthernet&& 
fSerialToEthernet&& /
,&&/ 0
Control'' 
invoker'' 
)(( 
{)) 	
m_fSerialToEthernet** 
=**  !
fSerialToEthernet**" 3
;**3 4
	m_invoker++ 
=++ 
invoker++ 
;++  
init-- 
(-- 
)-- 
;-- 
}.. 	
~22 	
FEventHandler22	 
(22 
)33 
{44 	
	myDispose55 
(55 
false55 
)55 
;55 
}66 	
	protected:: 
void:: 
	myDispose::  
(::  !
bool;; 
	disposing;; 
)<< 
{== 	
if>> 
(>> 
!>> 

m_disposed>> 
)>> 
{?? 
if@@ 
(@@ 
	disposing@@ 
)@@ 
{AA 
termBB 
(BB 
)BB 
;BB 
m_fSerialToEthernetDD '
=DD( )
nullDD* .
;DD. /
	m_invokerEE 
=EE 
nullEE  $
;EE$ %
}FF 

m_disposedHH 
=HH 
trueHH !
;HH! "
}II 
}JJ 	
publicRR 
voidRR 
DisposeRR 
(RR 
)SS 
{TT 	
	myDisposeUU 
(UU 
trueUU 
)UU 
;UU 
GCVV 
.VV 
SuppressFinalizeVV 
(VV  
thisVV  $
)VV$ %
;VV% &
}WW 	
privateee 
voidee 
initee 
(ee 
)ff 
{gg 	
tryhh 
{ii 
m_fSerialToEthernetjj #
.jj# $
EventRaisedjj$ /
+=jj0 2
newjj3 6$
FEventRaisedEventHandlerjj7 O
(jjO P+
m_fSerialToEthernet_EventRaisedjjP o
)jjo p
;jjp q
}kk 
catchll 
(ll 
	Exceptionll 
exll 
)ll  
{mm 
FDebugnn 
.nn 
throwExceptionnn %
(nn% &
exnn& (
)nn( )
;nn) *
}oo 
finallypp 
{qq 
}ss 
}tt 	
privatexx 
voidxx 
termxx 
(xx 
)yy 
{zz 	
try{{ 
{|| 
m_fSerialToEthernet}} #
.}}# $
EventRaised}}$ /
-=}}0 2
new}}3 6$
FEventRaisedEventHandler}}7 O
(}}O P+
m_fSerialToEthernet_EventRaised}}P o
)}}o p
;}}p q
}~~ 
catch 
( 
	Exception 
ex 
)  
{
€€ 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
‚‚ 
finally
ƒƒ 
{
„„ 
}
†† 
}
‡‡ 	
private
‹‹ 
bool
‹‹ 
validateInvoker
‹‹ $
(
‹‹$ %
)
ŒŒ 
{
 	
try
 
{
 
if
 
(
 
	m_invoker
 
!=
  
null
! %
)
% &
{
‘‘ 
if
’’ 
(
’’ 
!
’’ 
	m_invoker
’’ "
.
’’" #
Created
’’# *
||
’’+ -
!
’’. /
	m_invoker
’’/ 8
.
’’8 9
IsHandleCreated
’’9 H
)
’’H I
{
““ 
return
”” 
false
”” $
;
””$ %
}
•• 
}
–– 
return
—— 
true
—— 
;
—— 
}
˜˜ 
catch
™™ 
(
™™ 
	Exception
™™ 
ex
™™ 
)
™™  
{
šš 
FDebug
›› 
.
›› 
throwException
›› %
(
››% &
ex
››& (
)
››( )
;
››) *
}
œœ 
finally
 
{
 
}
   
return
¡¡ 
false
¡¡ 
;
¡¡ 
}
¢¢ 	
public
¦¦ 
void
¦¦ (
waitEventHandlingCompleted
¦¦ .
(
¦¦. /
)
§§ 
{
¨¨ 	
try
©© 
{
ªª !
m_fSerialToEthernet
«« #
.
««# $
fEventPusher
««$ 0
.
««0 1(
waitEventHandlingCompleted
««1 K
(
««K L
)
««L M
;
««M N
}
¬¬ 
catch
­­ 
(
­­ 
	Exception
­­ 
ex
­­ 
)
­­  
{
®® 
FDebug
¯¯ 
.
¯¯ 
throwException
¯¯ %
(
¯¯% &
ex
¯¯& (
)
¯¯( )
;
¯¯) *
}
°° 
finally
±± 
{
²² 
}
´´ 
}
µµ 	
private
½½ 
void
½½ -
m_fSerialToEthernet_EventRaised
½½ 4
(
½½4 5
object
¾¾ 
sender
¾¾ 
,
¾¾ 
FEventArgsBase
¿¿ 
e
¿¿ 
)
ÀÀ 
{
ÁÁ 	
try
ÂÂ 
{
ÃÃ 
if
ÄÄ 
(
ÄÄ 
EventRaised
ÄÄ 
==
ÄÄ  "
null
ÄÄ# '
)
ÄÄ' (
{
ÅÅ 
return
ÆÆ 
;
ÆÆ 
}
ÇÇ 
if
ËË 
(
ËË 
!
ËË 
validateInvoker
ËË $
(
ËË$ %
)
ËË% &
)
ËË& '
{
ÌÌ 
return
ÍÍ 
;
ÍÍ 
}
ÎÎ 
if
ÒÒ 
(
ÒÒ 
	m_invoker
ÒÒ 
==
ÒÒ  
null
ÒÒ! %
||
ÒÒ& (
!
ÒÒ) *
	m_invoker
ÒÒ* 3
.
ÒÒ3 4
InvokeRequired
ÒÒ4 B
)
ÒÒB C
{
ÓÓ 
EventRaised
ÔÔ 
(
ÔÔ  
this
ÔÔ  $
,
ÔÔ$ %
e
ÔÔ& '
)
ÔÔ' (
;
ÔÔ( )
}
ÕÕ 
else
ÖÖ 
{
×× 
	m_invoker
ØØ 
.
ØØ 
Invoke
ØØ $
(
ØØ$ %
new
ØØ% (
MethodInvoker
ØØ) 6
(
ØØ6 7
delegate
ØØ7 ?
(
ØØ? @
)
ØØ@ A
{
ÙÙ 
EventRaised
ÚÚ #
(
ÚÚ# $
this
ÚÚ$ (
,
ÚÚ( )
e
ÚÚ* +
)
ÚÚ+ ,
;
ÚÚ, -
}
ÛÛ 
)
ÛÛ 
)
ÛÛ 
;
ÛÛ 
}
ÜÜ 
}
İİ 
catch
ŞŞ 
(
ŞŞ 
	Exception
ŞŞ 
ex
ŞŞ 
)
ŞŞ  
{
ßß 
if
àà 
(
àà 
ex
àà 
is
àà %
ObjectDisposedException
àà 1
)
àà1 2
{
áá 
return
ââ 
;
ââ 
}
ãã 
FDebug
ää 
.
ää 
writeLog
ää 
(
ää  
ex
ää  "
)
ää" #
;
ää# $
}
åå 
finally
ææ 
{
çç 
}
éé 
}
êê 	
}
ğğ 
}ññ Ëo
wD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\SerialToEthernet\Event\c_FEventPusher.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSerialToEthernet -
{ 
internal 
class 
FEventPusher 
:  
IDisposable! ,
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FSerialToEthernet !
m_fSerialToTcp" 0
=1 2
null3 7
;7 8
private 
FQueue 
< 
FEventArgsBase %
>% &
m_fSerialEvents' 6
=7 8
null9 =
;= >
private 
FQueue 
< 
FEventArgsBase %
>% &
m_fTcpEvents' 3
=4 5
null6 :
;: ;
private 
FThread 
m_fThdEventPusher )
=* +
null, 0
;0 1
private 
bool &
m_isCompletedEventHandling /
=0 1
false2 7
;7 8
internal$$ 
FEventPusher$$ 
($$ 
FSerialToEthernet%% 
fSerialToTcp%% *
)&& 
{'' 	
m_fSerialToTcp(( 
=(( 
fSerialToTcp(( )
;(() *
init** 
(** 
)** 
;** 
}++ 	
~// 	
FEventPusher//	 
(// 
)00 
{11 	
	myDispose22 
(22 
false22 
)22 
;22 
}33 	
	protected77 
void77 
	myDispose77  
(77  !
bool88 
	disposing88 
)99 
{:: 	
if;; 
(;; 
!;; 

m_disposed;; 
);; 
{<< 
if== 
(== 
	disposing== 
)== 
{>> 
term?? 
(?? 
)?? 
;?? 
m_fSerialToTcpAA "
=AA# $
nullAA% )
;AA) *
}BB 

m_disposedDD 
=DD 
trueDD !
;DD! "
}EE 
}FF 	
publicNN 
voidNN 
DisposeNN 
(NN 
)OO 
{PP 	
	myDisposeQQ 
(QQ 
trueQQ 
)QQ 
;QQ 
GCRR 
.RR 
SuppressFinalizeRR 
(RR  
thisRR  $
)RR$ %
;RR% &
}SS 	
public[[ 
int[[ 
serialEventCount[[ #
{\\ 	
get]] 
{^^ 
try__ 
{`` 
returnaa 
m_fSerialEventsaa *
.aa* +
countaa+ 0
;aa0 1
}bb 
catchcc 
(cc 
	Exceptioncc  
excc! #
)cc# $
{dd 
FDebugee 
.ee 
throwExceptionee )
(ee) *
exee* ,
)ee, -
;ee- .
}ff 
finallygg 
{hh 
}jj 
returnkk 
$numkk 
;kk 
}ll 
}mm 	
publicqq 
intqq 
tcpEventCountqq  
{rr 	
getss 
{tt 
tryuu 
{vv 
returnww 
m_fTcpEventsww '
.ww' (
countww( -
;ww- .
}xx 
catchyy 
(yy 
	Exceptionyy  
exyy! #
)yy# $
{zz 
FDebug{{ 
.{{ 
throwException{{ )
({{) *
ex{{* ,
){{, -
;{{- .
}|| 
finally}} 
{~~ 
}
€€ 
return
 
$num
 
;
 
}
‚‚ 
}
ƒƒ 	
public
‡‡ 
bool
‡‡ &
isCompletedEventHandling
‡‡ ,
{
ˆˆ 	
get
‰‰ 
{
ŠŠ 
try
‹‹ 
{
ŒŒ 
if
 
(
 
this
 
.
 
serialEventCount
 -
==
. 0
$num
1 2
&&
3 5
this
6 :
.
: ;
tcpEventCount
; H
==
I K
$num
L M
&&
N P(
m_isCompletedEventHandling
Q k
)
k l
{
 
return
 
true
 #
;
# $
}
 
return
‘‘ 
false
‘‘  
;
‘‘  !
}
’’ 
catch
““ 
(
““ 
	Exception
““  
ex
““! #
)
““# $
{
”” 
FDebug
•• 
.
•• 
throwException
•• )
(
••) *
ex
••* ,
)
••, -
;
••- .
}
–– 
finally
—— 
{
˜˜ 
}
šš 
return
›› 
false
›› 
;
›› 
}
œœ 
}
 	
private
¥¥ 
void
¥¥ 
init
¥¥ 
(
¥¥ 
)
¦¦ 
{
§§ 	
try
¨¨ 
{
©© 
m_fSerialEvents
ªª 
=
ªª  !
new
ªª" %
FQueue
ªª& ,
<
ªª, -
FEventArgsBase
ªª- ;
>
ªª; <
(
ªª< =
)
ªª= >
;
ªª> ?
m_fTcpEvents
«« 
=
«« 
new
«« "
FQueue
««# )
<
««) *
FEventArgsBase
««* 8
>
««8 9
(
««9 :
)
««: ;
;
««; <(
m_isCompletedEventHandling
¯¯ *
=
¯¯+ ,
true
¯¯- 1
;
¯¯1 2
m_fThdEventPusher
°° !
=
°°" #
new
°°$ '
FThread
°°( /
(
°°/ 0
$str
°°0 A
,
°°A B
false
°°C H
,
°°H I
System
°°J P
.
°°P Q
	Threading
°°Q Z
.
°°Z [
ThreadPriority
°°[ i
.
°°i j
Normal
°°j p
,
°°p q
true
°°r v
)
°°v w
;
°°w x
m_fThdEventPusher
±± !
.
±±! "
ThreadJobCalled
±±" 1
+=
±±2 4
new
±±5 8*
FThreadJobCalledEventHandler
±±9 U
(
±±U V/
!m_fThdEventPusher_ThreadJobCalled
±±V w
)
±±w x
;
±±x y
m_fThdEventPusher
²² !
.
²²! "
start
²²" '
(
²²' (
)
²²( )
;
²²) *
}
³³ 
catch
´´ 
(
´´ 
	Exception
´´ 
ex
´´ 
)
´´  
{
µµ 
FDebug
¶¶ 
.
¶¶ 
throwException
¶¶ %
(
¶¶% &
ex
¶¶& (
)
¶¶( )
;
¶¶) *
}
·· 
finally
¸¸ 
{
¹¹ 
}
»» 
}
¼¼ 	
private
ÀÀ 
void
ÀÀ 
term
ÀÀ 
(
ÀÀ 
)
ÁÁ 
{
ÂÂ 	
try
ÃÃ 
{
ÄÄ 
if
ÅÅ 
(
ÅÅ 
m_fThdEventPusher
ÅÅ %
!=
ÅÅ& (
null
ÅÅ) -
)
ÅÅ- .
{
ÆÆ 
while
ÇÇ 
(
ÇÇ 
!
ÇÇ 
this
ÇÇ  
.
ÇÇ  !&
isCompletedEventHandling
ÇÇ! 9
)
ÇÇ9 :
{
ÈÈ 
System
ÉÉ 
.
ÉÉ 
	Threading
ÉÉ (
.
ÉÉ( )
Thread
ÉÉ) /
.
ÉÉ/ 0
Sleep
ÉÉ0 5
(
ÉÉ5 6
$num
ÉÉ6 8
)
ÉÉ8 9
;
ÉÉ9 :
}
ÊÊ 
m_fThdEventPusher
ÎÎ %
.
ÎÎ% &
ThreadJobCalled
ÎÎ& 5
-=
ÎÎ6 8
new
ÎÎ9 <*
FThreadJobCalledEventHandler
ÎÎ= Y
(
ÎÎY Z/
!m_fThdEventPusher_ThreadJobCalled
ÎÎZ {
)
ÎÎ{ |
;
ÎÎ| }
m_fThdEventPusher
ÏÏ %
.
ÏÏ% &
stop
ÏÏ& *
(
ÏÏ* +
)
ÏÏ+ ,
;
ÏÏ, -
m_fThdEventPusher
ĞĞ %
.
ĞĞ% &
Dispose
ĞĞ& -
(
ĞĞ- .
)
ĞĞ. /
;
ĞĞ/ 0
m_fThdEventPusher
ÑÑ %
=
ÑÑ& '
null
ÑÑ( ,
;
ÑÑ, -
}
ÒÒ 
if
ÔÔ 
(
ÔÔ 
m_fSerialEvents
ÔÔ #
!=
ÔÔ$ &
null
ÔÔ' +
)
ÔÔ+ ,
{
ÕÕ 
m_fSerialEvents
ÖÖ #
.
ÖÖ# $
Dispose
ÖÖ$ +
(
ÖÖ+ ,
)
ÖÖ, -
;
ÖÖ- .
m_fSerialEvents
×× #
=
××$ %
null
××& *
;
××* +
}
ØØ 
if
ÚÚ 
(
ÚÚ 
m_fTcpEvents
ÚÚ  
!=
ÚÚ! #
null
ÚÚ$ (
)
ÚÚ( )
{
ÛÛ 
m_fTcpEvents
ÜÜ  
.
ÜÜ  !
Dispose
ÜÜ! (
(
ÜÜ( )
)
ÜÜ) *
;
ÜÜ* +
m_fTcpEvents
İİ  
=
İİ! "
null
İİ# '
;
İİ' (
}
ŞŞ 
}
ßß 
catch
àà 
(
àà 
	Exception
àà 
ex
àà 
)
àà  
{
áá 
FDebug
ââ 
.
ââ 
throwException
ââ %
(
ââ% &
ex
ââ& (
)
ââ( )
;
ââ) *
}
ãã 
finally
ää 
{
åå 
}
çç 
}
èè 	
public
ìì 
void
ìì 
pushSerialEvent
ìì #
(
ìì# $
FEventArgsBase
íí 
fArgs
íí  
)
îî 
{
ïï 	
try
ğğ 
{
ññ 
m_fSerialEvents
òò 
.
òò  
enqueue
òò  '
(
òò' (
fArgs
òò( -
)
òò- .
;
òò. /
}
óó 
catch
ôô 
(
ôô 
	Exception
ôô 
ex
ôô 
)
ôô  
{
õõ 
FDebug
öö 
.
öö 
throwException
öö %
(
öö% &
ex
öö& (
)
öö( )
;
öö) *
}
÷÷ 
finally
øø 
{
ùù 
}
ûû 
}
üü 	
public
€€ 
void
€€ 
pushTcpEvent
€€  
(
€€  !
FEventArgsBase
 
fArgs
  
)
‚‚ 
{
ƒƒ 	
try
„„ 
{
…… 
m_fTcpEvents
†† 
.
†† 
enqueue
†† $
(
††$ %
fArgs
††% *
)
††* +
;
††+ ,
}
‡‡ 
catch
ˆˆ 
(
ˆˆ 
	Exception
ˆˆ 
ex
ˆˆ 
)
ˆˆ  
{
‰‰ 
FDebug
ŠŠ 
.
ŠŠ 
throwException
ŠŠ %
(
ŠŠ% &
ex
ŠŠ& (
)
ŠŠ( )
;
ŠŠ) *
}
‹‹ 
finally
ŒŒ 
{
 
}
 
}
 	
public
”” 
void
”” (
waitEventHandlingCompleted
”” .
(
””. /
)
•• 
{
–– 	
try
—— 
{
˜˜ 
while
™™ 
(
™™ 
!
™™ 
this
™™ 
.
™™ &
isCompletedEventHandling
™™ 5
)
™™5 6
{
šš 
if
›› 
(
›› 
System
›› 
.
›› 
Windows
›› &
.
››& '
Forms
››' ,
.
››, -
Application
››- 8
.
››8 9
MessageLoop
››9 D
)
››D E
{
œœ 
System
 
.
 
Windows
 &
.
& '
Forms
' ,
.
, -
Application
- 8
.
8 9
DoEvents
9 A
(
A B
)
B C
;
C D
}
 
System
ŸŸ 
.
ŸŸ 
	Threading
ŸŸ $
.
ŸŸ$ %
Thread
ŸŸ% +
.
ŸŸ+ ,
Sleep
ŸŸ, 1
(
ŸŸ1 2
$num
ŸŸ2 3
)
ŸŸ3 4
;
ŸŸ4 5
}
   
}
¡¡ 
catch
¢¢ 
(
¢¢ 
	Exception
¢¢ 
ex
¢¢ 
)
¢¢  
{
££ 
FDebug
¤¤ 
.
¤¤ 
throwException
¤¤ %
(
¤¤% &
ex
¤¤& (
)
¤¤( )
;
¤¤) *
}
¥¥ 
finally
¦¦ 
{
§§ 
}
©© 
}
ªª 	
private
²² 
void
²² /
!m_fThdEventPusher_ThreadJobCalled
²² 6
(
²²6 7
object
³³ 
sender
³³ 
,
³³ 
FThreadEventArgs
´´ 
e
´´ 
)
µµ 
{
¶¶ 	
try
·· 
{
¸¸ 
if
¹¹ 
(
¹¹ 
this
¹¹ 
.
¹¹ 
serialEventCount
¹¹ )
==
¹¹* ,
$num
¹¹- .
&&
¹¹/ 1
this
¹¹2 6
.
¹¹6 7
tcpEventCount
¹¹7 D
==
¹¹E G
$num
¹¹H I
)
¹¹I J
{
ºº (
m_isCompletedEventHandling
»» .
=
»»/ 0
true
»»1 5
;
»»5 6
e
¼¼ 
.
¼¼ 
sleepThread
¼¼ !
(
¼¼! "
$num
¼¼" #
)
¼¼# $
;
¼¼$ %
return
½½ 
;
½½ 
}
¾¾ (
m_isCompletedEventHandling
¿¿ *
=
¿¿+ ,
false
¿¿- 2
;
¿¿2 3
while
ÃÃ 
(
ÃÃ 
this
ÃÃ 
.
ÃÃ 
serialEventCount
ÃÃ ,
>
ÃÃ- .
$num
ÃÃ/ 0
)
ÃÃ0 1
{
ÄÄ 
m_fSerialToTcp
ÅÅ "
.
ÅÅ" #
onEventRaised
ÅÅ# 0
(
ÅÅ0 1
m_fSerialEvents
ÅÅ1 @
.
ÅÅ@ A
dequeue
ÅÅA H
(
ÅÅH I
)
ÅÅI J
)
ÅÅJ K
;
ÅÅK L
}
ÆÆ 
while
ÊÊ 
(
ÊÊ 
this
ÊÊ 
.
ÊÊ 
tcpEventCount
ÊÊ )
>
ÊÊ* +
$num
ÊÊ, -
)
ÊÊ- .
{
ËË 
m_fSerialToTcp
ÌÌ "
.
ÌÌ" #
onEventRaised
ÌÌ# 0
(
ÌÌ0 1
m_fTcpEvents
ÌÌ1 =
.
ÌÌ= >
dequeue
ÌÌ> E
(
ÌÌE F
)
ÌÌF G
)
ÌÌG H
;
ÌÌH I
}
ÍÍ 
}
ÎÎ 
catch
ÏÏ 
(
ÏÏ 
	Exception
ÏÏ 
ex
ÏÏ 
)
ÏÏ  
{
ĞĞ 
FDebug
ÑÑ 
.
ÑÑ 
writeLog
ÑÑ 
(
ÑÑ  
ex
ÑÑ  "
)
ÑÑ" #
;
ÑÑ# $
}
ÒÒ 
finally
ÓÓ 
{
ÔÔ 
}
ÖÖ 
}
×× 	
}
İİ 
}ŞŞ Õ
ƒD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\SerialToEthernet\Event\EventArgs\c_FEventArgsBase.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSerialToEthernet -
{ 
[ 
Serializable 
] 
public 

class 
FEventArgsBase 
:  
	EventArgs! *
,* +
IDisposable, 7
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FSerialToEthernet !
m_fSerialToEthernet" 5
=6 7
null8 <
;< =
private 
FEventId 

m_fEventId #
=$ %
FEventId& .
.. /
None/ 3
;3 4
internal!! 
FEventArgsBase!! 
(!!  
FSerialToEthernet"" 
fSerialToEthernet"" /
,""/ 0
FEventId## 
fEventId## 
)$$ 
{%% 	
m_fSerialToEthernet&& 
=&&  !
fSerialToEthernet&&" 3
;&&3 4

m_fEventId'' 
='' 
fEventId'' !
;''! "
}(( 	
~,, 	
FEventArgsBase,,	 
(,, 
)-- 
{.. 	
	myDispose// 
(// 
false// 
)// 
;// 
}00 	
	protected44 
virtual44 
void44 
	myDispose44 (
(44( )
bool55 
	disposing55 
)66 
{77 	
if88 
(88 
!88 

m_disposed88 
)88 
{99 
if:: 
(:: 
	disposing:: 
):: 
{;; 
m_fSerialToEthernet<< '
=<<( )
null<<* .
;<<. /
}== 

m_disposed?? 
=?? 
true?? !
;??! "
}@@ 
}AA 	
publicII 
voidII 
DisposeII 
(II 
)JJ 
{KK 	
	myDisposeLL 
(LL 
trueLL 
)LL 
;LL 
GCMM 
.MM 
SuppressFinalizeMM 
(MM  
thisMM  $
)MM$ %
;MM% &
}NN 	
publicVV 
FSerialToEthernetVV  
fSerialToEthernetVV! 2
{WW 	
getXX 
{YY 
tryZZ 
{[[ 
return\\ 
m_fSerialToEthernet\\ .
;\\. /
}]] 
catch^^ 
(^^ 
	Exception^^  
ex^^! #
)^^# $
{__ 
FDebug`` 
.`` 
throwException`` )
(``) *
ex``* ,
)``, -
;``- .
}aa 
finallybb 
{cc 
}ee 
returnff 
nullff 
;ff 
}gg 
}hh 	
publicll 
FEventIdll 
fEventIdll  
{mm 	
getnn 
{oo 
trypp 
{qq 
returnrr 

m_fEventIdrr %
;rr% &
}ss 
catchtt 
(tt 
	Exceptiontt  
extt! #
)tt# $
{uu 
FDebugvv 
.vv 
throwExceptionvv )
(vv) *
exvv* ,
)vv, -
;vv- .
}ww 
finallyxx 
{yy 
}{{ 
return|| 
FEventId|| 
.||  
None||  $
;||$ %
}}} 
}~~ 	
}
ŠŠ 
}‹‹ Ù'
‘D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\SerialToEthernet\Event\EventArgs\c_FSocketDataReceivedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSerialToEthernet -
{ 
[ 
Serializable 
] 
public 

class (
FSocketDataReceivedEventArgs -
:. /
FEventArgsBase0 >
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FResultCode 
	m_fResult %
=& '
FResultCode( 3
.3 4
Success4 ;
;; <
private 
string 
m_errorMessage %
=& '
string( .
.. /
Empty/ 4
;4 5
private 
byte 
[ 
] 
m_bin 
= 
null #
;# $
internal"" (
FSocketDataReceivedEventArgs"" -
(""- .
FSerialToEthernet## 
fSerialToEthernet## /
,##/ 0
FEventId$$ 
fEventId$$ 
,$$ 
FResultCode%% 
fResult%% 
,%%  
string&& 
errorMessage&& 
,&&  
byte'' 
['' 
]'' 
bin'' 
)(( 
:)) 
base)) 
()) 
fSerialToEthernet)) $
,))$ %
fEventId))& .
))). /
{** 	
	m_fResult++ 
=++ 
fResult++ 
;++  
m_errorMessage,, 
=,, 
errorMessage,, )
;,,) *
m_bin-- 
=-- 
bin-- 
;-- 
}.. 	
~22 	(
FSocketDataReceivedEventArgs22	 %
(22% &
)33 
{44 	
	myDispose55 
(55 
false55 
)55 
;55 
}66 	
	protected:: 
override:: 
void:: 
	myDispose::  )
(::) *
bool;; 
	disposing;; 
)<< 
{== 	
if>> 
(>> 
!>> 

m_disposed>> 
)>> 
{?? 
if@@ 
(@@ 
	disposing@@ 
)@@ 
{AA 
m_binBB 
=BB 
nullBB  
;BB  !
}CC 

m_disposedDD 
=DD 
trueDD !
;DD! "
baseFF 
.FF 
	myDisposeFF 
(FF 
	disposingFF (
)FF( )
;FF) *
}GG 
}HH 	
publicPP 
voidPP 
DisposePP 
(PP 
)QQ 
{RR 	
	myDisposeSS 
(SS 
trueSS 
)SS 
;SS 
GCTT 
.TT 
SuppressFinalizeTT 
(TT  
thisTT  $
)TT$ %
;TT% &
}UU 	
public]] 
FResultCode]] 
fResult]] "
{^^ 	
get__ 
{`` 
tryaa 
{bb 
returncc 
	m_fResultcc $
;cc$ %
}dd 
catchee 
(ee 
	Exceptionee  
exee! #
)ee# $
{ff 
FDebuggg 
.gg 
throwExceptiongg )
(gg) *
exgg* ,
)gg, -
;gg- .
}hh 
finallyii 
{jj 
}ll 
returnmm 
FResultCodemm "
.mm" #
Successmm# *
;mm* +
}nn 
}oo 	
publicss 
stringss 
errorMessagess "
{tt 	
getuu 
{vv 
tryww 
{xx 
returnyy 
m_errorMessageyy )
;yy) *
}zz 
catch{{ 
({{ 
	Exception{{  
ex{{! #
){{# $
{|| 
FDebug}} 
.}} 
throwException}} )
(}}) *
ex}}* ,
)}}, -
;}}- .
}~~ 
finally 
{
€€ 
}
‚‚ 
return
ƒƒ 
string
ƒƒ 
.
ƒƒ 
Empty
ƒƒ #
;
ƒƒ# $
}
„„ 
}
…… 	
public
‰‰ 
byte
‰‰ 
[
‰‰ 
]
‰‰ 
fSocketData
‰‰ !
{
ŠŠ 	
get
‹‹ 
{
ŒŒ 
try
 
{
 
return
 
m_bin
  
;
  !
}
 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘  
ex
‘‘! #
)
‘‘# $
{
’’ 
FDebug
““ 
.
““ 
throwException
““ )
(
““) *
ex
““* ,
)
““, -
;
““- .
}
”” 
finally
•• 
{
–– 
}
˜˜ 
return
™™ 
null
™™ 
;
™™ 
}
šš 
}
›› 	
}
§§ 
}¨¨ ö'
—D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\SerialToEthernet\Event\EventArgs\c_FSerialPluginDataReceivedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSerialToEthernet -
{ 
[ 
Serializable 
] 
public 

class .
"FSerialPluginDataReceivedEventArgs 3
:4 5
FEventArgsBase6 D
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FResultCode 
	m_fResult %
=& '
FResultCode( 3
.3 4
Success4 ;
;; <
private 
string 
m_errorMessage %
=& '
string( .
.. /
Empty/ 4
;4 5
private !
FSerialPluginRecvData %
m_fSerialData& 3
=4 5
null6 :
;: ;
internal"" .
"FSerialPluginDataReceivedEventArgs"" 3
(""3 4
FSerialToEthernet## 
fSerialToEthernet## /
,##/ 0
FEventId$$ 
fEventId$$ 
,$$ 
FResultCode%% 
fResult%% 
,%%  
string&& 
errorMessage&& 
,&&  !
FSerialPluginRecvData'' !
fSerialData''" -
)(( 
:)) 
base)) 
()) 
fSerialToEthernet)) $
,))$ %
fEventId))& .
))). /
{** 	
	m_fResult++ 
=++ 
fResult++ 
;++  
m_errorMessage,, 
=,, 
errorMessage,, )
;,,) *
m_fSerialData-- 
=-- 
fSerialData-- '
;--' (
}.. 	
~22 	.
"FSerialPluginDataReceivedEventArgs22	 +
(22+ ,
)33 
{44 	
	myDispose55 
(55 
false55 
)55 
;55 
}66 	
	protected:: 
override:: 
void:: 
	myDispose::  )
(::) *
bool;; 
	disposing;; 
)<< 
{== 	
if>> 
(>> 
!>> 

m_disposed>> 
)>> 
{?? 
if@@ 
(@@ 
	disposing@@ 
)@@ 
{AA 
m_fSerialDataBB !
=BB" #
nullBB$ (
;BB( )
}CC 

m_disposedDD 
=DD 
trueDD !
;DD! "
baseFF 
.FF 
	myDisposeFF 
(FF 
	disposingFF (
)FF( )
;FF) *
}GG 
}HH 	
publicPP 
voidPP 
DisposePP 
(PP 
)QQ 
{RR 	
	myDisposeSS 
(SS 
trueSS 
)SS 
;SS 
GCTT 
.TT 
SuppressFinalizeTT 
(TT  
thisTT  $
)TT$ %
;TT% &
}UU 	
public]] 
FResultCode]] 
fResult]] "
{^^ 	
get__ 
{`` 
tryaa 
{bb 
returncc 
	m_fResultcc $
;cc$ %
}dd 
catchee 
(ee 
	Exceptionee  
exee! #
)ee# $
{ff 
FDebuggg 
.gg 
throwExceptiongg )
(gg) *
exgg* ,
)gg, -
;gg- .
}hh 
finallyii 
{jj 
}ll 
returnmm 
FResultCodemm "
.mm" #
Successmm# *
;mm* +
}nn 
}oo 	
publicss 
stringss 
errorMessagess "
{tt 	
getuu 
{vv 
tryww 
{xx 
returnyy 
m_errorMessageyy )
;yy) *
}zz 
catch{{ 
({{ 
	Exception{{  
ex{{! #
){{# $
{|| 
FDebug}} 
.}} 
throwException}} )
(}}) *
ex}}* ,
)}}, -
;}}- .
}~~ 
finally 
{
€€ 
}
‚‚ 
return
ƒƒ 
string
ƒƒ 
.
ƒƒ 
Empty
ƒƒ #
;
ƒƒ# $
}
„„ 
}
…… 	
public
‰‰ #
FSerialPluginRecvData
‰‰ $
fSerialData
‰‰% 0
{
ŠŠ 	
get
‹‹ 
{
ŒŒ 
try
 
{
 
return
 
m_fSerialData
 (
;
( )
}
 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘  
ex
‘‘! #
)
‘‘# $
{
’’ 
FDebug
““ 
.
““ 
throwException
““ )
(
““) *
ex
““* ,
)
““, -
;
““- .
}
”” 
finally
•• 
{
–– 
}
˜˜ 
return
™™ 
null
™™ 
;
™™ 
}
šš 
}
›› 	
}
§§ 
}¨¨ ¥
–D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\SerialToEthernet\Event\EventArgs\c_FSerialPluginErrorRaisedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSerialToEthernet -
{ 
[ 
Serializable 
] 
public 

class -
!FSerialPluginErrorRaisedEventArgs 2
:3 4
FEventArgsBase5 C
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
string 
m_errorMessage %
=& '
string( .
.. /
Empty/ 4
;4 5
internal   -
!FSerialPluginErrorRaisedEventArgs   2
(  2 3
FSerialToEthernet!! 
fSerialToEthernet!! /
,!!/ 0
FEventId"" 
fEventId"" 
,"" 
string## 
errorMessage## 
)$$ 
:%% 
base%% 
(%% 
fSerialToEthernet%% $
,%%$ %
fEventId%%& .
)%%. /
{&& 	
m_errorMessage'' 
='' 
errorMessage'' )
;'') *
}(( 	
~,, 	-
!FSerialPluginErrorRaisedEventArgs,,	 *
(,,* +
)-- 
{.. 	
	myDispose// 
(// 
false// 
)// 
;// 
}00 	
	protected44 
override44 
void44 
	myDispose44  )
(44) *
bool55 
	disposing55 
)66 
{77 	
if88 
(88 
!88 

m_disposed88 
)88 
{99 
if:: 
(:: 
	disposing:: 
):: 
{;; 
}== 

m_disposed>> 
=>> 
true>> !
;>>! "
base@@ 
.@@ 
	myDispose@@ 
(@@ 
	disposing@@ (
)@@( )
;@@) *
}AA 
}BB 	
publicJJ 
voidJJ 
DisposeJJ 
(JJ 
)KK 
{LL 	
	myDisposeMM 
(MM 
trueMM 
)MM 
;MM 
GCNN 
.NN 
SuppressFinalizeNN 
(NN  
thisNN  $
)NN$ %
;NN% &
}OO 	
publicWW 
stringWW 
errorMessageWW "
{XX 	
getYY 
{ZZ 
try[[ 
{\\ 
return]] 
m_errorMessage]] )
;]]) *
}^^ 
catch__ 
(__ 
	Exception__  
ex__! #
)__# $
{`` 
FDebugaa 
.aa 
throwExceptionaa )
(aa) *
exaa* ,
)aa, -
;aa- .
}bb 
finallycc 
{dd 
}ff 
returngg 
stringgg 
.gg 
Emptygg #
;gg# $
}hh 
}ii 	
}uu 
}vv Ø6
—D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\SerialToEthernet\Event\EventArgs\c_FSerialPluginStateChangedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSerialToEthernet -
{ 
[ 
Serializable 
] 
public 

class .
"FSerialPluginStateChangedEventArgs 3
:4 5
FEventArgsBase6 D
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FResultCode 
	m_fResult %
=& '
FResultCode( 3
.3 4
Success4 ;
;; <
private 
string 
m_errorMessage %
=& '
string( .
.. /
Empty/ 4
;4 5
private 
FCommunicationState #
m_fState$ ,
=- .
FCommunicationState/ B
.B C
ClosedC I
;I J
private 
string 
m_serialPort #
=$ %
string& ,
., -
Empty- 2
;2 3
private 
int 
m_baud 
= 
$num 
; 
internal$$ .
"FSerialPluginStateChangedEventArgs$$ 3
($$3 4
FSerialToEthernet%% 
fSerialToEthernet%% /
,%%/ 0
FEventId&& 
fEventId&& 
,&& 
FResultCode'' 
fResult'' 
,''  
string(( 
errorMessage(( 
,((  
FCommunicationState)) 
fState))  &
,))& '
string** 

serialPort** 
,** 
int++ 
baud++ 
),, 
:-- 
base-- 
(-- 
fSerialToEthernet-- $
,--$ %
fEventId--& .
)--. /
{.. 	
	m_fResult// 
=// 
fResult// 
;//  
m_errorMessage00 
=00 
errorMessage00 )
;00) *
m_fState11 
=11 
fState11 
;11 
m_serialPort22 
=22 

serialPort22 %
;22% &
m_baud33 
=33 
baud33 
;33 
}44 	
~88 	.
"FSerialPluginStateChangedEventArgs88	 +
(88+ ,
)99 
{:: 	
	myDispose;; 
(;; 
false;; 
);; 
;;; 
}<< 	
	protected@@ 
override@@ 
void@@ 
	myDispose@@  )
(@@) *
boolAA 
	disposingAA 
)BB 
{CC 	
ifDD 
(DD 
!DD 

m_disposedDD 
)DD 
{EE 
ifFF 
(FF 
	disposingFF 
)FF 
{GG 
}II 

m_disposedJJ 
=JJ 
trueJJ !
;JJ! "
baseLL 
.LL 
	myDisposeLL 
(LL 
	disposingLL (
)LL( )
;LL) *
}MM 
}NN 	
publicVV 
voidVV 
DisposeVV 
(VV 
)WW 
{XX 	
	myDisposeYY 
(YY 
trueYY 
)YY 
;YY 
GCZZ 
.ZZ 
SuppressFinalizeZZ 
(ZZ  
thisZZ  $
)ZZ$ %
;ZZ% &
}[[ 	
publiccc 
FResultCodecc 
fResultcc "
{dd 	
getee 
{ff 
trygg 
{hh 
returnii 
	m_fResultii $
;ii$ %
}jj 
catchkk 
(kk 
	Exceptionkk  
exkk! #
)kk# $
{ll 
FDebugmm 
.mm 
throwExceptionmm )
(mm) *
exmm* ,
)mm, -
;mm- .
}nn 
finallyoo 
{pp 
}rr 
returnss 
FResultCodess "
.ss" #
Successss# *
;ss* +
}tt 
}uu 	
publicyy 
stringyy 
errorMessageyy "
{zz 	
get{{ 
{|| 
try}} 
{~~ 
return 
m_errorMessage )
;) *
}
€€ 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
‚‚ 
FDebug
ƒƒ 
.
ƒƒ 
throwException
ƒƒ )
(
ƒƒ) *
ex
ƒƒ* ,
)
ƒƒ, -
;
ƒƒ- .
}
„„ 
finally
…… 
{
†† 
}
ˆˆ 
return
‰‰ 
string
‰‰ 
.
‰‰ 
Empty
‰‰ #
;
‰‰# $
}
ŠŠ 
}
‹‹ 	
public
 !
FCommunicationState
 "
fState
# )
{
 	
get
‘‘ 
{
’’ 
try
““ 
{
”” 
return
•• 
m_fState
•• #
;
••# $
}
–– 
catch
—— 
(
—— 
	Exception
——  
ex
——! #
)
——# $
{
˜˜ 
FDebug
™™ 
.
™™ 
throwException
™™ )
(
™™) *
ex
™™* ,
)
™™, -
;
™™- .
}
šš 
finally
›› 
{
œœ 
}
 
return
ŸŸ !
FCommunicationState
ŸŸ *
.
ŸŸ* +
Closed
ŸŸ+ 1
;
ŸŸ1 2
}
   
}
¡¡ 	
public
¥¥ 
string
¥¥ 

serialPort
¥¥  
{
¦¦ 	
get
§§ 
{
¨¨ 
try
©© 
{
ªª 
return
«« 
m_serialPort
«« '
;
««' (
}
¬¬ 
catch
­­ 
(
­­ 
	Exception
­­  
ex
­­! #
)
­­# $
{
®® 
FDebug
¯¯ 
.
¯¯ 
throwException
¯¯ )
(
¯¯) *
ex
¯¯* ,
)
¯¯, -
;
¯¯- .
}
°° 
finally
±± 
{
²² 
}
´´ 
return
µµ 
string
µµ 
.
µµ 
Empty
µµ #
;
µµ# $
}
¶¶ 
}
·· 	
public
»» 
int
»» 
baud
»» 
{
¼¼ 	
get
½½ 
{
¾¾ 
try
¿¿ 
{
ÀÀ 
return
ÁÁ 
m_baud
ÁÁ !
;
ÁÁ! "
}
ÂÂ 
catch
ÃÃ 
(
ÃÃ 
	Exception
ÃÃ  
ex
ÃÃ! #
)
ÃÃ# $
{
ÄÄ 
FDebug
ÅÅ 
.
ÅÅ 
throwException
ÅÅ )
(
ÅÅ) *
ex
ÅÅ* ,
)
ÅÅ, -
;
ÅÅ- .
}
ÆÆ 
finally
ÇÇ 
{
ÈÈ 
}
ÊÊ 
return
ËË 
$num
ËË 
;
ËË 
}
ÌÌ 
}
ÍÍ 	
}
ÙÙ 
}ÚÚ ´&
“D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\SerialToEthernet\Event\EventArgs\c_FSerialPluginDataSentEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSerialToEthernet -
{ 
[ 
Serializable 
] 
public 

class *
FSerialPluginDataSentEventArgs /
:0 1
FEventArgsBase2 @
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FResultCode 
	m_fResult %
=& '
FResultCode( 3
.3 4
Success4 ;
;; <
private 
string 
m_errorMessage %
=& '
string( .
.. /
Empty/ 4
;4 5
private 
FSerialSendData 
m_fSerialData  -
=. /
null0 4
;4 5
internal"" *
FSerialPluginDataSentEventArgs"" /
(""/ 0
FSerialToEthernet## 
fSerialToEthernet## /
,##/ 0
FEventId$$ 
fEventId$$ 
,$$ 
FResultCode%% 
fResult%% 
,%%  
string&& 
errorMessage&& 
,&&  
FSerialSendData'' 
fSerialData'' '
)(( 
:)) 
base)) 
()) 
fSerialToEthernet)) $
,))$ %
fEventId))& .
))). /
{** 	
m_fSerialData++ 
=++ 
fSerialData++ '
;++' (
},, 	
~00 	*
FSerialPluginDataSentEventArgs00	 '
(00' (
)11 
{22 	
	myDispose33 
(33 
false33 
)33 
;33 
}44 	
	protected88 
override88 
void88 
	myDispose88  )
(88) *
bool99 
	disposing99 
):: 
{;; 	
if<< 
(<< 
!<< 

m_disposed<< 
)<< 
{== 
if>> 
(>> 
	disposing>> 
)>> 
{?? 
m_fSerialData@@ !
=@@" #
null@@$ (
;@@( )
}AA 

m_disposedBB 
=BB 
trueBB !
;BB! "
baseDD 
.DD 
	myDisposeDD 
(DD 
	disposingDD (
)DD( )
;DD) *
}EE 
}FF 	
publicNN 
voidNN 
DisposeNN 
(NN 
)OO 
{PP 	
	myDisposeQQ 
(QQ 
trueQQ 
)QQ 
;QQ 
GCRR 
.RR 
SuppressFinalizeRR 
(RR  
thisRR  $
)RR$ %
;RR% &
}SS 	
public[[ 
FResultCode[[ 
fResult[[ "
{\\ 	
get]] 
{^^ 
try__ 
{`` 
returnaa 
	m_fResultaa $
;aa$ %
}bb 
catchcc 
(cc 
	Exceptioncc  
excc! #
)cc# $
{dd 
FDebugee 
.ee 
throwExceptionee )
(ee) *
exee* ,
)ee, -
;ee- .
}ff 
finallygg 
{hh 
}jj 
returnkk 
FResultCodekk "
.kk" #
Successkk# *
;kk* +
}ll 
}mm 	
publicqq 
stringqq 
errorMessageqq "
{rr 	
getss 
{tt 
tryuu 
{vv 
returnww 
m_errorMessageww )
;ww) *
}xx 
catchyy 
(yy 
	Exceptionyy  
exyy! #
)yy# $
{zz 
FDebug{{ 
.{{ 
throwException{{ )
({{) *
ex{{* ,
){{, -
;{{- .
}|| 
finally}} 
{~~ 
}
€€ 
return
 
string
 
.
 
Empty
 #
;
# $
}
‚‚ 
}
ƒƒ 	
public
‡‡ 
FSerialSendData
‡‡ 
fSerialData
‡‡ *
{
ˆˆ 	
get
‰‰ 
{
ŠŠ 
try
‹‹ 
{
ŒŒ 
return
 
m_fSerialData
 (
;
( )
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
‘‘ 
.
‘‘ 
throwException
‘‘ )
(
‘‘) *
ex
‘‘* ,
)
‘‘, -
;
‘‘- .
}
’’ 
finally
““ 
{
”” 
}
–– 
return
—— 
null
—— 
;
—— 
}
˜˜ 
}
™™ 	
}
¥¥ 
}¦¦ ¼'
D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\SerialToEthernet\Event\EventArgs\c_FSocketDataSentEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSerialToEthernet -
{ 
[ 
Serializable 
] 
public 

class $
FSocketDataSentEventArgs )
:* +
FEventArgsBase, :
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FResultCode 
	m_fResult %
=& '
FResultCode( 3
.3 4
Success4 ;
;; <
private 
string 
m_errorMessage %
=& '
string( .
.. /
Empty/ 4
;4 5
private 
FSocketSendData 
m_fSocketData  -
=. /
null0 4
;4 5
internal"" $
FSocketDataSentEventArgs"" )
("") *
FSerialToEthernet## 
fSerialToEthernet## /
,##/ 0
FEventId$$ 
fEventId$$ 
,$$ 
FResultCode%% 
fResult%% 
,%%  
string&& 
errorMessage&& 
,&&  
FSocketSendData'' 
fSocketData'' '
)(( 
:)) 
base)) 
()) 
fSerialToEthernet)) $
,))$ %
fEventId))& .
))). /
{** 	
	m_fResult++ 
=++ 
fResult++ 
;++  
m_errorMessage,, 
=,, 
errorMessage,, )
;,,) *
m_fSocketData-- 
=-- 
fSocketData-- '
;--' (
}.. 	
~22 	$
FSocketDataSentEventArgs22	 !
(22! "
)33 
{44 	
	myDispose55 
(55 
false55 
)55 
;55 
}66 	
	protected:: 
override:: 
void:: 
	myDispose::  )
(::) *
bool;; 
	disposing;; 
)<< 
{== 	
if>> 
(>> 
!>> 

m_disposed>> 
)>> 
{?? 
if@@ 
(@@ 
	disposing@@ 
)@@ 
{AA 
m_fSocketDataBB !
=BB" #
nullBB$ (
;BB( )
}CC 

m_disposedDD 
=DD 
trueDD !
;DD! "
baseFF 
.FF 
	myDisposeFF 
(FF 
	disposingFF (
)FF( )
;FF) *
}GG 
}HH 	
publicPP 
voidPP 
DisposePP 
(PP 
)QQ 
{RR 	
	myDisposeSS 
(SS 
trueSS 
)SS 
;SS 
GCTT 
.TT 
SuppressFinalizeTT 
(TT  
thisTT  $
)TT$ %
;TT% &
}UU 	
public]] 
FResultCode]] 
fResult]] "
{^^ 	
get__ 
{`` 
tryaa 
{bb 
returncc 
	m_fResultcc $
;cc$ %
}dd 
catchee 
(ee 
	Exceptionee  
exee! #
)ee# $
{ff 
FDebuggg 
.gg 
throwExceptiongg )
(gg) *
exgg* ,
)gg, -
;gg- .
}hh 
finallyii 
{jj 
}ll 
returnmm 
FResultCodemm "
.mm" #
Successmm# *
;mm* +
}nn 
}oo 	
publicss 
stringss 
errorMessagess "
{tt 	
getuu 
{vv 
tryww 
{xx 
returnyy 
m_errorMessageyy )
;yy) *
}zz 
catch{{ 
({{ 
	Exception{{  
ex{{! #
){{# $
{|| 
FDebug}} 
.}} 
throwException}} )
(}}) *
ex}}* ,
)}}, -
;}}- .
}~~ 
finally 
{
€€ 
}
‚‚ 
return
ƒƒ 
string
ƒƒ 
.
ƒƒ 
Empty
ƒƒ #
;
ƒƒ# $
}
„„ 
}
…… 	
public
‰‰ 
FSocketSendData
‰‰ 
fSocketData
‰‰ *
{
ŠŠ 	
get
‹‹ 
{
ŒŒ 
try
 
{
 
return
 
m_fSocketData
 (
;
( )
}
 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘  
ex
‘‘! #
)
‘‘# $
{
’’ 
FDebug
““ 
.
““ 
throwException
““ )
(
““) *
ex
““* ,
)
““, -
;
““- .
}
”” 
finally
•• 
{
–– 
}
˜˜ 
return
™™ 
null
™™ 
;
™™ 
}
šš 
}
›› 	
}
§§ 
}¨¨ 
D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\SerialToEthernet\Event\EventArgs\c_FSocketErrorRaisedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSerialToEthernet -
{ 
[ 
Serializable 
] 
public 

class '
FSocketErrorRaisedEventArgs ,
:- .
FEventArgsBase/ =
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
string 
m_errorMessage %
=& '
string( .
.. /
Empty/ 4
;4 5
internal   '
FSocketErrorRaisedEventArgs   ,
(  , -
FSerialToEthernet!! 
fSerialToEthernet!! /
,!!/ 0
FEventId"" 
fEventId"" 
,"" 
string## 
errorMessage## 
)$$ 
:%% 
base%% 
(%% 
fSerialToEthernet%% $
,%%$ %
fEventId%%& .
)%%. /
{&& 	
m_errorMessage'' 
='' 
errorMessage'' )
;'') *
}(( 	
~,, 	'
FSocketErrorRaisedEventArgs,,	 $
(,,$ %
)-- 
{.. 	
	myDispose// 
(// 
false// 
)// 
;// 
}00 	
	protected44 
override44 
void44 
	myDispose44  )
(44) *
bool55 
	disposing55 
)66 
{77 	
if88 
(88 
!88 

m_disposed88 
)88 
{99 
if:: 
(:: 
	disposing:: 
):: 
{;; 
}== 

m_disposed>> 
=>> 
true>> !
;>>! "
base@@ 
.@@ 
	myDispose@@ 
(@@ 
	disposing@@ (
)@@( )
;@@) *
}AA 
}BB 	
publicJJ 
voidJJ 
DisposeJJ 
(JJ 
)KK 
{LL 	
	myDisposeMM 
(MM 
trueMM 
)MM 
;MM 
GCNN 
.NN 
SuppressFinalizeNN 
(NN  
thisNN  $
)NN$ %
;NN% &
}OO 	
publicWW 
stringWW 
errorMessageWW "
{XX 	
getYY 
{ZZ 
try[[ 
{\\ 
return]] 
m_errorMessage]] )
;]]) *
}^^ 
catch__ 
(__ 
	Exception__  
ex__! #
)__# $
{`` 
FDebugaa 
.aa 
throwExceptionaa )
(aa) *
exaa* ,
)aa, -
;aa- .
}bb 
finallycc 
{dd 
}ff 
returngg 
stringgg 
.gg 
Emptygg #
;gg# $
}hh 
}ii 	
}uu 
}vv ÑM
‘D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\SerialToEthernet\Event\EventArgs\c_FSocketStateChangedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSerialToEthernet -
{ 
[ 
Serializable 
] 
public 

class (
FSocketStateChangedEventArgs -
:. /
FEventArgsBase0 >
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FResultCode 
	m_fResult %
=& '
FResultCode( 3
.3 4
Success4 ;
;; <
private 
string 
m_errorMessage %
=& '
string( .
.. /
Empty/ 4
;4 5
private 
FCommunicationState #
m_fState$ ,
=- .
FCommunicationState/ B
.B C
ClosedC I
;I J
private 
FConnectMode 
m_fConnectMode +
=, -
FConnectMode. :
.: ;
Passive; B
;B C
private 
string 
	m_localIp  
=! "
string# )
.) *
Empty* /
;/ 0
private 
int 
m_localPort 
=  !
$num" #
;# $
private   
string   

m_remoteIp   !
=  " #
string  $ *
.  * +
Empty  + 0
;  0 1
private!! 
int!! 
m_remotePort!!  
=!!! "
$num!!# $
;!!$ %
internal'' (
FSocketStateChangedEventArgs'' -
(''- .
FSerialToEthernet(( 
fSerialToEthernet(( /
,((/ 0
FEventId)) 
fEventId)) 
,)) 
FResultCode** 
fResult** 
,**  
string++ 
errorMessage++ 
,++  
FCommunicationState,, 
fState,,  &
,,,& '
FConnectMode-- 
fConnectMode-- %
,--% &
string.. 
localIp.. 
,.. 
int// 
	localPort// 
,// 
string00 
remoteIp00 
,00 
int11 

remotePort11 
)22 
:33 
base33 
(33 
fSerialToEthernet33 $
,33$ %
fEventId33& .
)33. /
{44 	
	m_fResult55 
=55 
fResult55 
;55  
m_errorMessage66 
=66 
errorMessage66 )
;66) *
m_fState77 
=77 
fState77 
;77 
m_fConnectMode88 
=88 
fConnectMode88 )
;88) *
	m_localIp99 
=99 
localIp99 
;99  
m_localPort:: 
=:: 
	localPort:: #
;::# $

m_remoteIp;; 
=;; 
remoteIp;; !
;;;! "
m_remotePort<< 
=<< 

remotePort<< %
;<<% &
}== 	
~AA 	(
FSocketStateChangedEventArgsAA	 %
(AA% &
)BB 
{CC 	
	myDisposeDD 
(DD 
falseDD 
)DD 
;DD 
}EE 	
	protectedII 
overrideII 
voidII 
	myDisposeII  )
(II) *
boolJJ 
	disposingJJ 
)KK 
{LL 	
ifMM 
(MM 
!MM 

m_disposedMM 
)MM 
{NN 
ifOO 
(OO 
	disposingOO 
)OO 
{PP 
}RR 

m_disposedSS 
=SS 
trueSS !
;SS! "
baseUU 
.UU 
	myDisposeUU 
(UU 
	disposingUU (
)UU( )
;UU) *
}VV 
}WW 	
public__ 
void__ 
Dispose__ 
(__ 
)`` 
{aa 	
	myDisposebb 
(bb 
truebb 
)bb 
;bb 
GCcc 
.cc 
SuppressFinalizecc 
(cc  
thiscc  $
)cc$ %
;cc% &
}dd 	
publicll 
FResultCodell 
fResultll "
{mm 	
getnn 
{oo 
trypp 
{qq 
returnrr 
	m_fResultrr $
;rr$ %
}ss 
catchtt 
(tt 
	Exceptiontt  
extt! #
)tt# $
{uu 
FDebugvv 
.vv 
throwExceptionvv )
(vv) *
exvv* ,
)vv, -
;vv- .
}ww 
finallyxx 
{yy 
}{{ 
return|| 
FResultCode|| "
.||" #
Success||# *
;||* +
}}} 
}~~ 	
public
‚‚ 
string
‚‚ 
errorMessage
‚‚ "
{
ƒƒ 	
get
„„ 
{
…… 
try
†† 
{
‡‡ 
return
ˆˆ 
m_errorMessage
ˆˆ )
;
ˆˆ) *
}
‰‰ 
catch
ŠŠ 
(
ŠŠ 
	Exception
ŠŠ  
ex
ŠŠ! #
)
ŠŠ# $
{
‹‹ 
FDebug
ŒŒ 
.
ŒŒ 
throwException
ŒŒ )
(
ŒŒ) *
ex
ŒŒ* ,
)
ŒŒ, -
;
ŒŒ- .
}
 
finally
 
{
 
}
‘‘ 
return
’’ 
string
’’ 
.
’’ 
Empty
’’ #
;
’’# $
}
““ 
}
”” 	
public
˜˜ !
FCommunicationState
˜˜ "
fState
˜˜# )
{
™™ 	
get
šš 
{
›› 
try
œœ 
{
 
return
 
m_fState
 #
;
# $
}
ŸŸ 
catch
   
(
   
	Exception
    
ex
  ! #
)
  # $
{
¡¡ 
FDebug
¢¢ 
.
¢¢ 
throwException
¢¢ )
(
¢¢) *
ex
¢¢* ,
)
¢¢, -
;
¢¢- .
}
££ 
finally
¤¤ 
{
¥¥ 
}
§§ 
return
¨¨ !
FCommunicationState
¨¨ *
.
¨¨* +
Closed
¨¨+ 1
;
¨¨1 2
}
©© 
}
ªª 	
public
®® 
FConnectMode
®® 
fConnectMode
®® (
{
¯¯ 	
get
°° 
{
±± 
try
²² 
{
³³ 
return
´´ 
m_fConnectMode
´´ )
;
´´) *
}
µµ 
catch
¶¶ 
(
¶¶ 
	Exception
¶¶  
ex
¶¶! #
)
¶¶# $
{
·· 
FDebug
¸¸ 
.
¸¸ 
throwException
¸¸ )
(
¸¸) *
ex
¸¸* ,
)
¸¸, -
;
¸¸- .
}
¹¹ 
finally
ºº 
{
»» 
}
½½ 
return
¾¾ 
FConnectMode
¾¾ #
.
¾¾# $
Active
¾¾$ *
;
¾¾* +
}
¿¿ 
}
ÀÀ 	
public
ÄÄ 
string
ÄÄ 
localIp
ÄÄ 
{
ÅÅ 	
get
ÆÆ 
{
ÇÇ 
try
ÈÈ 
{
ÉÉ 
return
ÊÊ 
	m_localIp
ÊÊ $
;
ÊÊ$ %
}
ËË 
catch
ÌÌ 
(
ÌÌ 
	Exception
ÌÌ  
ex
ÌÌ! #
)
ÌÌ# $
{
ÍÍ 
FDebug
ÎÎ 
.
ÎÎ 
throwException
ÎÎ )
(
ÎÎ) *
ex
ÎÎ* ,
)
ÎÎ, -
;
ÎÎ- .
}
ÏÏ 
finally
ĞĞ 
{
ÑÑ 
}
ÓÓ 
return
ÔÔ 
string
ÔÔ 
.
ÔÔ 
Empty
ÔÔ #
;
ÔÔ# $
}
ÕÕ 
}
ÖÖ 	
public
ÚÚ 
int
ÚÚ 
	localPort
ÚÚ 
{
ÛÛ 	
get
ÜÜ 
{
İİ 
try
ŞŞ 
{
ßß 
return
àà 
m_localPort
àà &
;
àà& '
}
áá 
catch
ââ 
(
ââ 
	Exception
ââ  
ex
ââ! #
)
ââ# $
{
ãã 
FDebug
ää 
.
ää 
throwException
ää )
(
ää) *
ex
ää* ,
)
ää, -
;
ää- .
}
åå 
finally
ææ 
{
çç 
}
éé 
return
êê 
$num
êê 
;
êê 
}
ëë 
}
ìì 	
public
ğğ 
string
ğğ 
remoteIp
ğğ 
{
ññ 	
get
òò 
{
óó 
try
ôô 
{
õõ 
return
öö 

m_remoteIp
öö %
;
öö% &
}
÷÷ 
catch
øø 
(
øø 
	Exception
øø  
ex
øø! #
)
øø# $
{
ùù 
FDebug
úú 
.
úú 
throwException
úú )
(
úú) *
ex
úú* ,
)
úú, -
;
úú- .
}
ûû 
finally
üü 
{
ıı 
}
ÿÿ 
return
€€ 
string
€€ 
.
€€ 
Empty
€€ #
;
€€# $
}
 
}
‚‚ 	
public
†† 
int
†† 

remotePort
†† 
{
‡‡ 	
get
ˆˆ 
{
‰‰ 
try
ŠŠ 
{
‹‹ 
return
ŒŒ 
m_remotePort
ŒŒ '
;
ŒŒ' (
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
‘‘ 
finally
’’ 
{
““ 
}
•• 
return
–– 
$num
–– 
;
–– 
}
—— 
}
˜˜ 	
}
¤¤ 
}¥¥ Ç
ŒD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\SerialToEthernet\Event\EventArgs\c_FLogMonitoringEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSerialToEthernet -
{ 
[ 
Serializable 
] 
public 

class #
FLogMonitoringEventArgs (
:) *
FEventArgsBase+ 9
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
string 
m_log 
= 
string %
.% &
Empty& +
;+ ,
internal   #
FLogMonitoringEventArgs   (
(  ( )
FSerialToEthernet!! 
fSerialToEthernet!! /
,!!/ 0
FEventId"" 
fEventId"" 
,"" 
string## 
log## 
)$$ 
:%% 
base%% 
(%% 
fSerialToEthernet%% $
,%%$ %
fEventId%%& .
)%%. /
{&& 	
m_log'' 
='' 
log'' 
;'' 
}(( 	
~,, 	#
FLogMonitoringEventArgs,,	  
(,,  !
)-- 
{.. 	
	myDispose// 
(// 
false// 
)// 
;// 
}00 	
	protected44 
override44 
void44 
	myDispose44  )
(44) *
bool55 
	disposing55 
)66 
{77 	
if88 
(88 
!88 

m_disposed88 
)88 
{99 
if:: 
(:: 
	disposing:: 
):: 
{;; 
}== 

m_disposed>> 
=>> 
true>> !
;>>! "
base@@ 
.@@ 
	myDispose@@ 
(@@ 
	disposing@@ (
)@@( )
;@@) *
}AA 
}BB 	
publicJJ 
voidJJ 
DisposeJJ 
(JJ 
)KK 
{LL 	
	myDisposeMM 
(MM 
trueMM 
)MM 
;MM 
GCNN 
.NN 
SuppressFinalizeNN 
(NN  
thisNN  $
)NN$ %
;NN% &
}OO 	
publicWW 
stringWW 
logWW 
{XX 	
getYY 
{ZZ 
try[[ 
{\\ 
return]] 
m_log]]  
;]]  !
}^^ 
catch__ 
(__ 
	Exception__  
ex__! #
)__# $
{`` 
FDebugaa 
.aa 
throwExceptionaa )
(aa) *
exaa* ,
)aa, -
;aa- .
}bb 
finallycc 
{dd 
}ff 
returngg 
stringgg 
.gg 
Emptygg #
;gg# $
}hh 
}ii 	
}uu 
}vv Æ
yD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\SerialToEthernet\LogWriter\c_FLogWriter.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSerialToEthernet -
{ 
internal 
class 

FLogWriter 
: 
IDisposable *
{ 
const 
string 

LogFileExt 
=  !
$str" '
;' (
private 
bool 

m_disposed 
=  !
false" '
;' (
private   
FSerialToEthernet   !
m_fRS232ToEthernet  " 4
=  5 6
null  7 ;
;  ; <
private!! 
FQueue!! 
<!! 
string!! 
>!! 
m_fLogQueue!! *
=!!+ ,
null!!- 1
;!!1 2
private"" 
FThread"" 

m_fThdMain"" "
=""# $
null""% )
;"") *
private$$ 
string$$ 
m_logFileName$$ $
=$$% &
string$$' -
.$$- .
Empty$$. 3
;$$3 4
private%% 

FileStream%% 
m_fsLogFile%% &
=%%' (
null%%) -
;%%- .
private&& 
StreamWriter&& 
m_swLogFile&& (
=&&) *
null&&+ /
;&&/ 0
private'' 
string'' 
m_logFileNameSuffix'' *
=''+ ,
string''- 3
.''3 4
Empty''4 9
;''9 :
public-- 

FLogWriter-- 
(-- 
FSerialToEthernet.. 
fRS232ToEthernet.. .
)// 
{00 	
m_fRS232ToEthernet11 
=11  
fRS232ToEthernet11! 1
;111 2
init22 
(22 
)22 
;22 
}33 	
~77 	

FLogWriter77	 
(77 
)88 
{99 	
	myDispose:: 
(:: 
false:: 
):: 
;:: 
};; 	
	protected?? 
void?? 
	myDispose??  
(??  !
bool@@ 
	disposing@@ 
)AA 
{BB 	
ifCC 
(CC 
!CC 

m_disposedCC 
)CC 
{DD 
ifEE 
(EE 
	disposingEE 
)EE 
{FF 
termGG 
(GG 
)GG 
;GG 
m_fRS232ToEthernetHH &
=HH' (
nullHH) -
;HH- .
}II 

m_disposedKK 
=KK 
trueKK !
;KK! "
}LL 
}MM 	
publicUU 
voidUU 
DisposeUU 
(UU 
)VV 
{WW 	
	myDisposeXX 
(XX 
trueXX 
)XX 
;XX 
GCYY 
.YY 
SuppressFinalizeYY 
(YY  
thisYY  $
)YY$ %
;YY% &
}ZZ 	
privatehh 
voidhh 
inithh 
(hh 
)ii 
{jj 	
trykk 
{ll 
m_fLogQueuemm 
=mm 
newmm !
FQueuemm" (
<mm( )
stringmm) /
>mm/ 0
(mm0 1
)mm1 2
;mm2 3
m_logFileNameSuffixqq #
=qq$ %
m_fRS232ToEthernetqq& 8
.qq8 9
logFileNameSuffixqq9 J
;qqJ K

m_fThdMainuu 
=uu 
newuu  
FThreaduu! (
(uu( )
$struu) :
)uu: ;
;uu; <

m_fThdMainvv 
.vv 
ThreadJobCalledvv *
+=vv+ -
newvv. 1(
FThreadJobCalledEventHandlervv2 N
(vvN O&
m_fThdMain_ThreadJobCalledvvO i
)vvi j
;vvj k

m_fThdMainww 
.ww 
startww  
(ww  !
)ww! "
;ww" #
}xx 
catchyy 
(yy 
	Exceptionyy 
exyy 
)yy  
{zz 
FDebug{{ 
.{{ 
throwException{{ %
({{% &
ex{{& (
){{( )
;{{) *
}|| 
finally}} 
{~~ 
}
€€ 
}
 	
private
…… 
void
…… 
term
…… 
(
…… 
)
†† 
{
‡‡ 	
try
ˆˆ 
{
‰‰ 
if
ŠŠ 
(
ŠŠ 

m_fThdMain
ŠŠ 
!=
ŠŠ !
null
ŠŠ" &
)
ŠŠ& '
{
‹‹ 
if
ŒŒ 
(
ŒŒ 
m_fLogQueue
ŒŒ #
!=
ŒŒ$ &
null
ŒŒ' +
)
ŒŒ+ ,
{
 
while
 
(
 
m_fLogQueue
 *
.
* +
count
+ 0
>
1 2
$num
3 4
)
4 5
{
 
System
 "
.
" #
	Threading
# ,
.
, -
Thread
- 3
.
3 4
Sleep
4 9
(
9 :
$num
: <
)
< =
;
= >
}
‘‘ 
}
’’ 

m_fThdMain
–– 
.
–– 
stop
–– #
(
––# $
)
––$ %
;
––% &

m_fThdMain
—— 
.
—— 
Dispose
—— &
(
——& '
)
——' (
;
——( )

m_fThdMain
˜˜ 
.
˜˜ 
ThreadJobCalled
˜˜ .
-=
˜˜/ 1
new
˜˜2 5*
FThreadJobCalledEventHandler
˜˜6 R
(
˜˜R S(
m_fThdMain_ThreadJobCalled
˜˜S m
)
˜˜m n
;
˜˜n o

m_fThdMain
™™ 
=
™™  
null
™™! %
;
™™% &
}
šš 
if
 
(
 
m_fLogQueue
 
!=
  "
null
# '
)
' (
{
ŸŸ 
m_fLogQueue
   
.
    
Dispose
    '
(
  ' (
)
  ( )
;
  ) *
m_fLogQueue
¡¡ 
=
¡¡  !
null
¡¡" &
;
¡¡& '
}
¢¢ 
closeLogFile
¦¦ 
(
¦¦ 
)
¦¦ 
;
¦¦ 
}
§§ 
catch
¨¨ 
(
¨¨ 
	Exception
¨¨ 
ex
¨¨ 
)
¨¨  
{
©© 
FDebug
ªª 
.
ªª 
throwException
ªª %
(
ªª% &
ex
ªª& (
)
ªª( )
;
ªª) *
}
«« 
finally
¬¬ 
{
­­ 
}
¯¯ 
}
°° 	
private
´´ 
void
´´ 
openLogFile
´´  
(
´´  !
)
µµ 
{
¶¶ 	
string
·· 
searchPattern
··  
=
··! "
string
··# )
.
··) *
Empty
··* /
;
··/ 0
string
¸¸ 
[
¸¸ 
]
¸¸ 
files
¸¸ 
=
¸¸ 
null
¸¸ !
;
¸¸! "
FileInfo
¹¹ 
fileInfo
¹¹ 
=
¹¹ 
null
¹¹  $
;
¹¹$ %
string
ºº 
newLogFileName
ºº !
=
ºº" #
string
ºº$ *
.
ºº* +
Empty
ºº+ 0
;
ºº0 1
try
¼¼ 
{
½½ 
if
¾¾ 
(
¾¾ 
!
¾¾ 
	Directory
¾¾ 
.
¾¾ 
Exists
¾¾ %
(
¾¾% & 
m_fRS232ToEthernet
¾¾& 8
.
¾¾8 9
logDirectory
¾¾9 E
)
¾¾E F
)
¾¾F G
{
¿¿ 
	Directory
ÀÀ 
.
ÀÀ 
CreateDirectory
ÀÀ -
(
ÀÀ- . 
m_fRS232ToEthernet
ÀÀ. @
.
ÀÀ@ A
logDirectory
ÀÀA M
)
ÀÀM N
;
ÀÀN O
}
ÁÁ 
if
ÅÅ 
(
ÅÅ 
m_fsLogFile
ÅÅ 
==
ÅÅ  "
null
ÅÅ# '
)
ÅÅ' (
{
ÆÆ !
m_logFileNameSuffix
ÇÇ '
=
ÇÇ( ) 
m_fRS232ToEthernet
ÇÇ* <
.
ÇÇ< =
logFileNameSuffix
ÇÇ= N
;
ÇÇN O
searchPattern
ÈÈ !
=
ÈÈ" #
$str
ÈÈ$ (
+
ÈÈ) *!
m_logFileNameSuffix
ÈÈ+ >
+
ÈÈ? @
$str
ÈÈA D
+
ÈÈE F

LogFileExt
ÈÈG Q
;
ÈÈQ R
files
ÉÉ 
=
ÉÉ 
	Directory
ÉÉ %
.
ÉÉ% &
GetFiles
ÉÉ& .
(
ÉÉ. / 
m_fRS232ToEthernet
ÉÉ/ A
.
ÉÉA B
logDirectory
ÉÉB N
,
ÉÉN O
searchPattern
ÉÉP ]
)
ÉÉ] ^
;
ÉÉ^ _
if
ËË 
(
ËË 
files
ËË 
.
ËË 
Length
ËË $
==
ËË% '
$num
ËË( )
)
ËË) *
{
ÌÌ 
m_logFileName
ÍÍ %
=
ÍÍ& '
string
ÍÍ( .
.
ÍÍ. /
Empty
ÍÍ/ 4
;
ÍÍ4 5
}
ÎÎ 
else
ÏÏ 
{
ĞĞ 
m_logFileName
ÑÑ %
=
ÑÑ& '
files
ÑÑ( -
[
ÑÑ- .
files
ÑÑ. 3
.
ÑÑ3 4
Length
ÑÑ4 :
-
ÑÑ; <
$num
ÑÑ= >
]
ÑÑ> ?
;
ÑÑ? @
fileInfo
ÒÒ  
=
ÒÒ! "
new
ÒÒ# &
FileInfo
ÒÒ' /
(
ÒÒ/ 0
m_logFileName
ÒÒ0 =
)
ÒÒ= >
;
ÒÒ> ?
if
ÓÓ 
(
ÓÓ 
fileInfo
ÓÓ $
.
ÓÓ$ %
Length
ÓÓ% +
>=
ÓÓ, .
(
ÓÓ/ 0 
m_fRS232ToEthernet
ÓÓ0 B
.
ÓÓB C
logFileMaxSize
ÓÓC Q
*
ÓÓR S
$num
ÓÓT X
*
ÓÓY Z
$num
ÓÓ[ _
)
ÓÓ_ `
)
ÓÓ` a
{
ÔÔ 
m_logFileName
ÕÕ )
=
ÕÕ* +
string
ÕÕ, 2
.
ÕÕ2 3
Empty
ÕÕ3 8
;
ÕÕ8 9
}
ÖÖ 
}
×× 
}
ØØ 
else
ÙÙ 
{
ÚÚ 
fileInfo
ÛÛ 
=
ÛÛ 
new
ÛÛ "
FileInfo
ÛÛ# +
(
ÛÛ+ ,
m_logFileName
ÛÛ, 9
)
ÛÛ9 :
;
ÛÛ: ;
if
ÜÜ 
(
ÜÜ 
fileInfo
ÜÜ  
.
ÜÜ  !
Length
ÜÜ! '
>=
ÜÜ( *
(
ÜÜ+ , 
m_fRS232ToEthernet
ÜÜ, >
.
ÜÜ> ?
logFileMaxSize
ÜÜ? M
*
ÜÜN O
$num
ÜÜP T
*
ÜÜU V
$num
ÜÜW [
)
ÜÜ[ \
)
ÜÜ\ ]
{
İİ 
closeLogFile
ŞŞ $
(
ŞŞ$ %
)
ŞŞ% &
;
ŞŞ& '
m_logFileName
ßß %
=
ßß& '
string
ßß( .
.
ßß. /
Empty
ßß/ 4
;
ßß4 5
}
àà 
else
áá 
if
áá 
(
áá !
m_logFileNameSuffix
áá 0
!=
áá1 3 
m_fRS232ToEthernet
áá4 F
.
ááF G
logFileNameSuffix
ááG X
)
ááX Y
{
ââ 
closeLogFile
ãã $
(
ãã$ %
)
ãã% &
;
ãã& '
m_logFileName
ää %
=
ää& '
string
ää( .
.
ää. /
Empty
ää/ 4
;
ää4 5
}
åå 
}
ææ 
if
êê 
(
êê 
m_swLogFile
êê 
==
êê  "
null
êê# '
)
êê' (
{
ëë 
if
ìì 
(
ìì 
m_logFileName
ìì %
==
ìì& (
string
ìì) /
.
ìì/ 0
Empty
ìì0 5
)
ìì5 6
{
íí !
m_logFileNameSuffix
îî +
=
îî, - 
m_fRS232ToEthernet
îî. @
.
îî@ A
logFileNameSuffix
îîA R
;
îîR S
m_logFileName
ïï %
=
ïï& ' 
m_fRS232ToEthernet
ïï( :
.
ïï: ;
logDirectory
ïï; G
+
ïïH I
$str
ïïJ N
+
ïïO P
DateTime
ïïQ Y
.
ïïY Z
Now
ïïZ ]
.
ïï] ^
ToString
ïï^ f
(
ïïf g
$str
ïïg z
)
ïïz {
+
ïï| }
$strïï~ 
+ïï‚ ƒ#
m_logFileNameSuffixïï„ —
+ïï˜ ™
$strïïš 
+ïï Ÿ

LogFileExtïï  ª
;ïïª «
}
ğğ 
m_fsLogFile
ññ 
=
ññ  !
new
ññ" %

FileStream
ññ& 0
(
ññ0 1
m_logFileName
ññ1 >
,
ññ> ?
FileMode
ññ@ H
.
ññH I
OpenOrCreate
ññI U
|
ññV W
FileMode
ññX `
.
ññ` a
Append
ñña g
,
ññg h

FileAccess
ññi s
.
ññs t
Write
ññt y
,
ññy z
	FileShareññ{ „
.ññ„ …
Readññ… ‰
)ññ‰ Š
;ññŠ ‹
m_swLogFile
òò 
=
òò  !
new
òò" %
StreamWriter
òò& 2
(
òò2 3
m_fsLogFile
òò3 >
,
òò> ?
Encoding
òò@ H
.
òòH I
Default
òòI P
)
òòP Q
;
òòQ R
}
óó 
}
ôô 
catch
õõ 
(
õõ 
	Exception
õõ 
ex
õõ 
)
õõ  
{
öö 
FDebug
÷÷ 
.
÷÷ 
throwException
÷÷ %
(
÷÷% &
ex
÷÷& (
)
÷÷( )
;
÷÷) *
}
øø 
finally
ùù 
{
úú 
files
ûû 
=
ûû 
null
ûû 
;
ûû 
fileInfo
üü 
=
üü 
null
üü 
;
üü  
}
ıı 
}
şş 	
private
‚‚ 
void
‚‚ 
closeLogFile
‚‚ !
(
‚‚! "
)
ƒƒ 
{
„„ 	
try
…… 
{
†† 
if
‡‡ 
(
‡‡ 
m_swLogFile
‡‡ 
!=
‡‡  "
null
‡‡# '
)
‡‡' (
{
ˆˆ 
m_swLogFile
‰‰ 
.
‰‰  
Flush
‰‰  %
(
‰‰% &
)
‰‰& '
;
‰‰' (
}
ŠŠ 
if
ŒŒ 
(
ŒŒ 
m_fsLogFile
ŒŒ 
!=
ŒŒ  "
null
ŒŒ# '
)
ŒŒ' (
{
 
m_fsLogFile
 
.
  
Flush
  %
(
% &
)
& '
;
' (
}
 
if
““ 
(
““ 
m_swLogFile
““ 
!=
““  "
null
““# '
)
““' (
{
”” 
m_swLogFile
•• 
.
••  
Close
••  %
(
••% &
)
••& '
;
••' (
m_swLogFile
–– 
.
––  
Dispose
––  '
(
––' (
)
––( )
;
––) *
m_swLogFile
—— 
=
——  !
null
——" &
;
——& '
}
˜˜ 
if
šš 
(
šš 
m_fsLogFile
šš 
!=
šš  "
null
šš# '
)
šš' (
{
›› 
m_fsLogFile
œœ 
.
œœ  
Close
œœ  %
(
œœ% &
)
œœ& '
;
œœ' (
m_fsLogFile
 
.
  
Dispose
  '
(
' (
)
( )
;
) *
m_fsLogFile
 
=
  !
null
" &
;
& '
}
ŸŸ 
}
   
catch
¡¡ 
(
¡¡ 
	Exception
¡¡ 
ex
¡¡ 
)
¡¡  
{
¢¢ 
FDebug
££ 
.
££ 
throwException
££ %
(
££% &
ex
££& (
)
££( )
;
££) *
}
¤¤ 
finally
¥¥ 
{
¦¦ 
}
¨¨ 
}
©© 	
private
­­ 
void
­­ 
writeLog
­­ 
(
­­ 
)
®® 
{
¯¯ 	
string
°° 
log
°° 
=
°° 
string
°° 
.
°°  
Empty
°°  %
;
°°% &
try
²² 
{
³³ 
openLogFile
´´ 
(
´´ 
)
´´ 
;
´´ 
while
µµ 
(
µµ 
m_fLogQueue
µµ "
.
µµ" #
count
µµ# (
>
µµ) *
$num
µµ+ ,
)
µµ, -
{
¶¶ 
log
·· 
=
·· 
m_fLogQueue
·· %
.
··% &
dequeue
··& -
(
··- .
)
··. /
;
··/ 0
m_swLogFile
¸¸ 
.
¸¸  
Write
¸¸  %
(
¸¸% &
log
¸¸& )
)
¸¸) *
;
¸¸* +
}
¹¹ 
m_swLogFile
ºº 
.
ºº 
Flush
ºº !
(
ºº! "
)
ºº" #
;
ºº# $
m_fsLogFile
»» 
.
»» 
Flush
»» !
(
»»! "
)
»»" #
;
»»# $
}
¼¼ 
catch
½½ 
(
½½ 
	Exception
½½ 
ex
½½ 
)
½½  
{
¾¾ 
FDebug
¿¿ 
.
¿¿ 
throwException
¿¿ %
(
¿¿% &
ex
¿¿& (
)
¿¿( )
;
¿¿) *
}
ÀÀ 
finally
ÁÁ 
{
ÂÂ 
}
ÄÄ 
}
ÅÅ 	
private
ÉÉ 
string
ÉÉ 
[
ÉÉ 
]
ÉÉ 
binToString
ÉÉ $
(
ÉÉ$ %
byte
ÊÊ 
[
ÊÊ 
]
ÊÊ 
byteData
ÊÊ 
)
ËË 
{
ÌÌ 	
List
ÍÍ 
<
ÍÍ 
string
ÍÍ 
>
ÍÍ 
strData
ÍÍ  
=
ÍÍ! "
null
ÍÍ# '
;
ÍÍ' (
StringBuilder
ÎÎ 
sb
ÎÎ 
=
ÎÎ 
null
ÎÎ #
;
ÎÎ# $
int
ÏÏ 
index
ÏÏ 
=
ÏÏ 
$num
ÏÏ 
;
ÏÏ 
try
ÑÑ 
{
ÒÒ 
strData
ÓÓ 
=
ÓÓ 
new
ÓÓ 
List
ÓÓ "
<
ÓÓ" #
string
ÓÓ# )
>
ÓÓ) *
(
ÓÓ* +
)
ÓÓ+ ,
;
ÓÓ, -
strData
ÔÔ 
.
ÔÔ 
Add
ÔÔ 
(
ÔÔ 
$str
ÔÔ  
)
ÔÔ  !
;
ÔÔ! "
sb
ÕÕ 
=
ÕÕ 
new
ÕÕ 
StringBuilder
ÕÕ &
(
ÕÕ& '
)
ÕÕ' (
;
ÕÕ( )
foreach
ÖÖ 
(
ÖÖ 
byte
ÖÖ 
b
ÖÖ 
in
ÖÖ  "
byteData
ÖÖ# +
)
ÖÖ+ ,
{
×× 
sb
ØØ 
.
ØØ 
Append
ØØ 
(
ØØ 
b
ØØ 
.
ØØ  
ToString
ØØ  (
(
ØØ( )
$str
ØØ) -
)
ØØ- .
+
ØØ/ 0
$str
ØØ1 4
)
ØØ4 5
;
ØØ5 6
index
ÙÙ 
++
ÙÙ 
;
ÙÙ 
if
ÚÚ 
(
ÚÚ 
index
ÚÚ 
%
ÚÚ 
$num
ÚÚ  "
==
ÚÚ# %
$num
ÚÚ& '
)
ÚÚ' (
{
ÛÛ 
strData
ÜÜ 
.
ÜÜ  
Add
ÜÜ  #
(
ÜÜ# $
sb
ÜÜ$ &
.
ÜÜ& '
ToString
ÜÜ' /
(
ÜÜ/ 0
)
ÜÜ0 1
)
ÜÜ1 2
;
ÜÜ2 3
sb
İİ 
.
İİ 
Clear
İİ  
(
İİ  !
)
İİ! "
;
İİ" #
}
ŞŞ 
}
ßß 
if
àà 
(
àà 
sb
àà 
.
àà 
Length
àà 
>
àà 
$num
àà  !
)
àà! "
{
áá 
strData
ââ 
.
ââ 
Add
ââ 
(
ââ  
sb
ââ  "
.
ââ" #
ToString
ââ# +
(
ââ+ ,
)
ââ, -
)
ââ- .
;
ââ. /
}
ãã 
return
çç 
strData
çç 
.
çç 
ToArray
çç &
(
çç& '
)
çç' (
;
çç( )
}
èè 
catch
éé 
(
éé 
	Exception
éé 
ex
éé 
)
éé  
{
êê 
FDebug
ëë 
.
ëë 
throwException
ëë %
(
ëë% &
ex
ëë& (
)
ëë( )
;
ëë) *
}
ìì 
finally
íí 
{
îî 
strData
ïï 
=
ïï 
null
ïï 
;
ïï 
sb
ğğ 
=
ğğ 
null
ğğ 
;
ğğ 
}
ññ 
return
òò 
null
òò 
;
òò 
}
óó 	
private
÷÷ 
void
÷÷ %
writeSerialStateChanged
÷÷ ,
(
÷÷, -0
"FSerialPluginStateChangedEventArgs
øø .
fArgs
øø/ 4
)
ùù 
{
úú 	
StringBuilder
ûû 
logData
ûû !
=
ûû" #
new
ûû$ '
StringBuilder
ûû( 5
(
ûû5 6
)
ûû6 7
;
ûû7 8
try
ıı 
{
şş 
logData
ÿÿ 
.
ÿÿ 

AppendLine
ÿÿ "
(
ÿÿ" #
$str
ÿÿ# &
+
ÿÿ' (
DateTime
ÿÿ) 1
.
ÿÿ1 2
Now
ÿÿ2 5
.
ÿÿ5 6
ToString
ÿÿ6 >
(
ÿÿ> ?
$str
ÿÿ? X
)
ÿÿX Y
+
ÿÿZ [
$str
ÿÿ\ _
)
ÿÿ_ `
;
ÿÿ` a
logData
ƒƒ 
.
ƒƒ 
Append
ƒƒ 
(
ƒƒ 
fArgs
ƒƒ $
.
ƒƒ$ %
fEventId
ƒƒ% -
.
ƒƒ- .
ToString
ƒƒ. 6
(
ƒƒ6 7
)
ƒƒ7 8
)
ƒƒ8 9
;
ƒƒ9 :
logData
„„ 
.
„„ 
Append
„„ 
(
„„ 
$str
„„ +
+
„„, -
fArgs
„„. 3
.
„„3 4
fResult
„„4 ;
.
„„; <
ToString
„„< D
(
„„D E
)
„„E F
+
„„G H
$str
„„I L
)
„„L M
;
„„M N
if
…… 
(
…… 
fArgs
…… 
.
…… 
fResult
…… !
!=
……" $
FResultCode
……% 0
.
……0 1
Success
……1 8
)
……8 9
{
†† 
logData
‡‡ 
.
‡‡ 
Append
‡‡ "
(
‡‡" #
$str
‡‡# 5
+
‡‡6 7
fArgs
‡‡8 =
.
‡‡= >
errorMessage
‡‡> J
+
‡‡K L
$str
‡‡M P
)
‡‡P Q
;
‡‡Q R
}
ˆˆ 
logData
‰‰ 
.
‰‰ 

AppendLine
‰‰ "
(
‰‰" #
)
‰‰# $
;
‰‰$ %
logData
 
.
 

AppendLine
 "
(
" #
fArgs
# (
.
( )
fState
) /
.
/ 0
ToString
0 8
(
8 9
)
9 :
+
; <
$str
= M
+
N O
fArgs
P U
.
U V

serialPort
V `
+
a b
$str
c n
+
o p
fArgs
q v
.
v w
baud
w {
.
{ |
ToString| „
(„ …
)… †
+‡ ˆ
$str‰ Œ
)Œ 
; 
logData
‘‘ 
.
‘‘ 

AppendLine
‘‘ "
(
‘‘" #
)
‘‘# $
;
‘‘$ %
m_fLogQueue
’’ 
.
’’ 
enqueue
’’ #
(
’’# $
logData
’’$ +
.
’’+ ,
ToString
’’, 4
(
’’4 5
)
’’5 6
)
’’6 7
;
’’7 8
}
““ 
catch
”” 
(
”” 
	Exception
”” 
ex
”” 
)
””  
{
•• 
FDebug
–– 
.
–– 
throwException
–– %
(
––% &
ex
––& (
)
––( )
;
––) *
}
—— 
finally
˜˜ 
{
™™ 
logData
šš 
=
šš 
null
šš 
;
šš 
}
›› 
}
œœ 	
private
   
void
   $
writeSerialErrorRaised
   +
(
  + ,/
!FSerialPluginErrorRaisedEventArgs
¡¡ -
fArgs
¡¡. 3
)
¢¢ 
{
££ 	
StringBuilder
¤¤ 
logData
¤¤ !
=
¤¤" #
new
¤¤$ '
StringBuilder
¤¤( 5
(
¤¤5 6
)
¤¤6 7
;
¤¤7 8
try
¦¦ 
{
§§ 
logData
¨¨ 
.
¨¨ 

AppendLine
¨¨ "
(
¨¨" #
$str
¨¨# &
+
¨¨' (
DateTime
¨¨) 1
.
¨¨1 2
Now
¨¨2 5
.
¨¨5 6
ToString
¨¨6 >
(
¨¨> ?
$str
¨¨? X
)
¨¨X Y
+
¨¨Z [
$str
¨¨\ _
)
¨¨_ `
;
¨¨` a
logData
¬¬ 
.
¬¬ 
Append
¬¬ 
(
¬¬ 
fArgs
¬¬ $
.
¬¬$ %
fEventId
¬¬% -
.
¬¬- .
ToString
¬¬. 6
(
¬¬6 7
)
¬¬7 8
)
¬¬8 9
;
¬¬9 :
logData
­­ 
.
­­ 
Append
­­ 
(
­­ 
$str
­­ 1
+
­­2 3
fArgs
­­4 9
.
­­9 :
errorMessage
­­: F
+
­­G H
$str
­­I L
)
­­L M
;
­­M N
logData
®® 
.
®® 

AppendLine
®® "
(
®®" #
)
®®# $
;
®®$ %
logData
²² 
.
²² 

AppendLine
²² "
(
²²" #
)
²²# $
;
²²$ %
m_fLogQueue
³³ 
.
³³ 
enqueue
³³ #
(
³³# $
logData
³³$ +
.
³³+ ,
ToString
³³, 4
(
³³4 5
)
³³5 6
)
³³6 7
;
³³7 8
}
´´ 
catch
µµ 
(
µµ 
	Exception
µµ 
ex
µµ 
)
µµ  
{
¶¶ 
FDebug
·· 
.
·· 
throwException
·· %
(
··% &
ex
··& (
)
··( )
;
··) *
}
¸¸ 
finally
¹¹ 
{
ºº 
logData
»» 
=
»» 
null
»» 
;
»» 
}
¼¼ 
}
½½ 	
private
ÁÁ 
void
ÁÁ %
writeSerialDataReceived
ÁÁ ,
(
ÁÁ, -0
"FSerialPluginDataReceivedEventArgs
ÂÂ .
fArgs
ÂÂ/ 4
)
ÃÃ 
{
ÄÄ 	
StringBuilder
ÅÅ 
logData
ÅÅ !
=
ÅÅ" #
new
ÅÅ$ '
StringBuilder
ÅÅ( 5
(
ÅÅ5 6
)
ÅÅ6 7
;
ÅÅ7 8
try
ÇÇ 
{
ÈÈ 
logData
ÉÉ 
.
ÉÉ 

AppendLine
ÉÉ "
(
ÉÉ" #
$str
ÉÉ# &
+
ÉÉ' (
DateTime
ÉÉ) 1
.
ÉÉ1 2
Now
ÉÉ2 5
.
ÉÉ5 6
ToString
ÉÉ6 >
(
ÉÉ> ?
$str
ÉÉ? X
)
ÉÉX Y
+
ÉÉZ [
$str
ÉÉ\ _
)
ÉÉ_ `
;
ÉÉ` a
logData
ÍÍ 
.
ÍÍ 
Append
ÍÍ 
(
ÍÍ 
fArgs
ÍÍ $
.
ÍÍ$ %
fEventId
ÍÍ% -
.
ÍÍ- .
ToString
ÍÍ. 6
(
ÍÍ6 7
)
ÍÍ7 8
)
ÍÍ8 9
;
ÍÍ9 :
logData
ÎÎ 
.
ÎÎ 
Append
ÎÎ 
(
ÎÎ 
$str
ÎÎ +
+
ÎÎ, -
fArgs
ÎÎ. 3
.
ÎÎ3 4
fResult
ÎÎ4 ;
.
ÎÎ; <
ToString
ÎÎ< D
(
ÎÎD E
)
ÎÎE F
+
ÎÎG H
$str
ÎÎI L
)
ÎÎL M
;
ÎÎM N
if
ÏÏ 
(
ÏÏ 
fArgs
ÏÏ 
.
ÏÏ 
fResult
ÏÏ !
!=
ÏÏ" $
FResultCode
ÏÏ% 0
.
ÏÏ0 1
Success
ÏÏ1 8
)
ÏÏ8 9
{
ĞĞ 
logData
ÑÑ 
.
ÑÑ 
Append
ÑÑ "
(
ÑÑ" #
$str
ÑÑ# 5
+
ÑÑ6 7
fArgs
ÑÑ8 =
.
ÑÑ= >
errorMessage
ÑÑ> J
+
ÑÑK L
$str
ÑÑM P
)
ÑÑP Q
;
ÑÑQ R
}
ÒÒ 
logData
ÓÓ 
.
ÓÓ 

AppendLine
ÓÓ "
(
ÓÓ" #
)
ÓÓ# $
;
ÓÓ$ %
if
×× 
(
×× 
fArgs
×× 
.
×× 
fSerialData
×× %
.
××% &
data
××& *
.
××* +
Length
××+ 1
>
××2 3
$num
××4 5
)
××5 6
{
ØØ 
foreach
ÙÙ 
(
ÙÙ 
string
ÙÙ #
s
ÙÙ$ %
in
ÙÙ& (
binToString
ÙÙ) 4
(
ÙÙ4 5
fArgs
ÙÙ5 :
.
ÙÙ: ;
fSerialData
ÙÙ; F
.
ÙÙF G
data
ÙÙG K
)
ÙÙK L
)
ÙÙL M
{
ÚÚ 
logData
ÛÛ 
.
ÛÛ  

AppendLine
ÛÛ  *
(
ÛÛ* +
s
ÛÛ+ ,
)
ÛÛ, -
;
ÛÛ- .
}
ÜÜ 
}
İİ 
logData
áá 
.
áá 

AppendLine
áá "
(
áá" #
)
áá# $
;
áá$ %
m_fLogQueue
ââ 
.
ââ 
enqueue
ââ #
(
ââ# $
logData
ââ$ +
.
ââ+ ,
ToString
ââ, 4
(
ââ4 5
)
ââ5 6
)
ââ6 7
;
ââ7 8
}
ãã 
catch
ää 
(
ää 
	Exception
ää 
ex
ää 
)
ää  
{
åå 
FDebug
ææ 
.
ææ 
throwException
ææ %
(
ææ% &
ex
ææ& (
)
ææ( )
;
ææ) *
}
çç 
finally
èè 
{
éé 
logData
êê 
=
êê 
null
êê 
;
êê 
}
ëë 
}
ìì 	
private
ğğ 
void
ğğ !
writeSerialDataSent
ğğ (
(
ğğ( ),
FSerialPluginDataSentEventArgs
ññ *
fArgs
ññ+ 0
)
òò 
{
óó 	
StringBuilder
ôô 
logData
ôô !
=
ôô" #
new
ôô$ '
StringBuilder
ôô( 5
(
ôô5 6
)
ôô6 7
;
ôô7 8
try
öö 
{
÷÷ 
logData
øø 
.
øø 

AppendLine
øø "
(
øø" #
$str
øø# &
+
øø' (
DateTime
øø) 1
.
øø1 2
Now
øø2 5
.
øø5 6
ToString
øø6 >
(
øø> ?
$str
øø? X
)
øøX Y
+
øøZ [
$str
øø\ _
)
øø_ `
;
øø` a
logData
üü 
.
üü 
Append
üü 
(
üü 
fArgs
üü $
.
üü$ %
fEventId
üü% -
.
üü- .
ToString
üü. 6
(
üü6 7
)
üü7 8
)
üü8 9
;
üü9 :
logData
ıı 
.
ıı 
Append
ıı 
(
ıı 
$str
ıı +
+
ıı, -
fArgs
ıı. 3
.
ıı3 4
fResult
ıı4 ;
.
ıı; <
ToString
ıı< D
(
ııD E
)
ııE F
+
ııG H
$str
ııI L
)
ııL M
;
ııM N
if
şş 
(
şş 
fArgs
şş 
.
şş 
fResult
şş !
!=
şş" $
FResultCode
şş% 0
.
şş0 1
Success
şş1 8
)
şş8 9
{
ÿÿ 
logData
€€ 
.
€€ 
Append
€€ "
(
€€" #
$str
€€# 5
+
€€6 7
fArgs
€€8 =
.
€€= >
errorMessage
€€> J
+
€€K L
$str
€€M P
)
€€P Q
;
€€Q R
}
 
logData
‚‚ 
.
‚‚ 

AppendLine
‚‚ "
(
‚‚" #
)
‚‚# $
;
‚‚$ %
if
†† 
(
†† 
fArgs
†† 
.
†† 
fSerialData
†† %
.
††% &
data
††& *
.
††* +
Length
††+ 1
>
††2 3
$num
††4 5
)
††5 6
{
‡‡ 
foreach
ˆˆ 
(
ˆˆ 
string
ˆˆ #
s
ˆˆ$ %
in
ˆˆ& (
binToString
ˆˆ) 4
(
ˆˆ4 5
fArgs
ˆˆ5 :
.
ˆˆ: ;
fSerialData
ˆˆ; F
.
ˆˆF G
data
ˆˆG K
)
ˆˆK L
)
ˆˆL M
{
‰‰ 
logData
ŠŠ 
.
ŠŠ  

AppendLine
ŠŠ  *
(
ŠŠ* +
s
ŠŠ+ ,
)
ŠŠ, -
;
ŠŠ- .
}
‹‹ 
}
ŒŒ 
logData
 
.
 

AppendLine
 "
(
" #
)
# $
;
$ %
m_fLogQueue
‘‘ 
.
‘‘ 
enqueue
‘‘ #
(
‘‘# $
logData
‘‘$ +
.
‘‘+ ,
ToString
‘‘, 4
(
‘‘4 5
)
‘‘5 6
)
‘‘6 7
;
‘‘7 8
}
’’ 
catch
““ 
(
““ 
	Exception
““ 
ex
““ 
)
““  
{
”” 
FDebug
•• 
.
•• 
throwException
•• %
(
••% &
ex
••& (
)
••( )
;
••) *
}
–– 
finally
—— 
{
˜˜ 
logData
™™ 
=
™™ 
null
™™ 
;
™™ 
}
šš 
}
›› 	
private
ŸŸ 
void
ŸŸ %
writeSocketStateChanged
ŸŸ ,
(
ŸŸ, -*
FSocketStateChangedEventArgs
   (
fArgs
  ) .
)
¡¡ 
{
¢¢ 	
StringBuilder
££ 
logData
££ !
=
££" #
new
££$ '
StringBuilder
££( 5
(
££5 6
)
££6 7
;
££7 8
try
¥¥ 
{
¦¦ 
logData
§§ 
.
§§ 

AppendLine
§§ "
(
§§" #
$str
§§# &
+
§§' (
DateTime
§§) 1
.
§§1 2
Now
§§2 5
.
§§5 6
ToString
§§6 >
(
§§> ?
$str
§§? X
)
§§X Y
+
§§Z [
$str
§§\ _
)
§§_ `
;
§§` a
logData
«« 
.
«« 
Append
«« 
(
«« 
fArgs
«« $
.
««$ %
fEventId
««% -
.
««- .
ToString
««. 6
(
««6 7
)
««7 8
)
««8 9
;
««9 :
logData
¬¬ 
.
¬¬ 
Append
¬¬ 
(
¬¬ 
$str
¬¬ +
+
¬¬, -
fArgs
¬¬. 3
.
¬¬3 4
fResult
¬¬4 ;
.
¬¬; <
ToString
¬¬< D
(
¬¬D E
)
¬¬E F
+
¬¬G H
$str
¬¬I L
)
¬¬L M
;
¬¬M N
if
­­ 
(
­­ 
fArgs
­­ 
.
­­ 
fResult
­­ !
!=
­­" $
FResultCode
­­% 0
.
­­0 1
Success
­­1 8
)
­­8 9
{
®® 
logData
¯¯ 
.
¯¯ 
Append
¯¯ "
(
¯¯" #
$str
¯¯# 5
+
¯¯6 7
fArgs
¯¯8 =
.
¯¯= >
errorMessage
¯¯> J
+
¯¯K L
$str
¯¯M P
)
¯¯P Q
;
¯¯Q R
}
°° 
logData
±± 
.
±± 

AppendLine
±± "
(
±±" #
)
±±# $
;
±±$ %
logData
µµ 
.
µµ 

AppendLine
µµ "
(
µµ" #
fArgs
µµ# (
.
µµ( )
fState
µµ) /
.
µµ/ 0
ToString
µµ0 8
(
µµ8 9
)
µµ9 :
+
µµ; <
$str
µµ= N
+
µµO P
fArgs
µµQ V
.
µµV W
fConnectMode
µµW c
+
µµd e
$str
µµf t
+
µµu v
fArgs
µµw |
.
µµ| }
localIpµµ} „
+µµ… †
$strµµ‡ —
+µµ˜ ™
fArgsµµš Ÿ
.µµŸ  
	localPortµµ  ©
.µµ© ª
ToStringµµª ²
(µµ² ³
)µµ³ ´
+µµµ ¶
$strµµ· Æ
+µµÇ È
fArgsµµÉ Î
.µµÎ Ï
remoteIpµµÏ ×
+µµØ Ù
$strµµÚ ë
+µµì í
fArgsµµî ó
.µµó ô

remotePortµµô ş
.µµş ÿ
ToStringµµÿ ‡
(µµ‡ ˆ
)µµˆ ‰
+µµŠ ‹
$strµµ‹ 
)µµ 
;µµ 
logData
¹¹ 
.
¹¹ 

AppendLine
¹¹ "
(
¹¹" #
)
¹¹# $
;
¹¹$ %
m_fLogQueue
ºº 
.
ºº 
enqueue
ºº #
(
ºº# $
logData
ºº$ +
.
ºº+ ,
ToString
ºº, 4
(
ºº4 5
)
ºº5 6
)
ºº6 7
;
ºº7 8
}
»» 
catch
¼¼ 
(
¼¼ 
	Exception
¼¼ 
ex
¼¼ 
)
¼¼  
{
½½ 
FDebug
¾¾ 
.
¾¾ 
throwException
¾¾ %
(
¾¾% &
ex
¾¾& (
)
¾¾( )
;
¾¾) *
}
¿¿ 
finally
ÀÀ 
{
ÁÁ 
logData
ÂÂ 
=
ÂÂ 
null
ÂÂ 
;
ÂÂ 
}
ÃÃ 
}
ÄÄ 	
private
ÈÈ 
void
ÈÈ $
writeSocketErrorRaised
ÈÈ +
(
ÈÈ+ ,)
FSocketErrorRaisedEventArgs
ÉÉ '
fArgs
ÉÉ( -
)
ÊÊ 
{
ËË 	
StringBuilder
ÌÌ 
logData
ÌÌ !
=
ÌÌ" #
new
ÌÌ$ '
StringBuilder
ÌÌ( 5
(
ÌÌ5 6
)
ÌÌ6 7
;
ÌÌ7 8
try
ÎÎ 
{
ÏÏ 
logData
ĞĞ 
.
ĞĞ 

AppendLine
ĞĞ "
(
ĞĞ" #
$str
ĞĞ# &
+
ĞĞ' (
DateTime
ĞĞ) 1
.
ĞĞ1 2
Now
ĞĞ2 5
.
ĞĞ5 6
ToString
ĞĞ6 >
(
ĞĞ> ?
$str
ĞĞ? X
)
ĞĞX Y
+
ĞĞZ [
$str
ĞĞ\ _
)
ĞĞ_ `
;
ĞĞ` a
logData
ÔÔ 
.
ÔÔ 
Append
ÔÔ 
(
ÔÔ 
fArgs
ÔÔ $
.
ÔÔ$ %
fEventId
ÔÔ% -
.
ÔÔ- .
ToString
ÔÔ. 6
(
ÔÔ6 7
)
ÔÔ7 8
)
ÔÔ8 9
;
ÔÔ9 :
logData
ÕÕ 
.
ÕÕ 
Append
ÕÕ 
(
ÕÕ 
$str
ÕÕ 1
+
ÕÕ2 3
fArgs
ÕÕ4 9
.
ÕÕ9 :
errorMessage
ÕÕ: F
+
ÕÕG H
$str
ÕÕI L
)
ÕÕL M
;
ÕÕM N
logData
ÖÖ 
.
ÖÖ 

AppendLine
ÖÖ "
(
ÖÖ" #
)
ÖÖ# $
;
ÖÖ$ %
logData
ÚÚ 
.
ÚÚ 

AppendLine
ÚÚ "
(
ÚÚ" #
)
ÚÚ# $
;
ÚÚ$ %
m_fLogQueue
ÛÛ 
.
ÛÛ 
enqueue
ÛÛ #
(
ÛÛ# $
logData
ÛÛ$ +
.
ÛÛ+ ,
ToString
ÛÛ, 4
(
ÛÛ4 5
)
ÛÛ5 6
)
ÛÛ6 7
;
ÛÛ7 8
}
ÜÜ 
catch
İİ 
(
İİ 
	Exception
İİ 
ex
İİ 
)
İİ  
{
ŞŞ 
FDebug
ßß 
.
ßß 
throwException
ßß %
(
ßß% &
ex
ßß& (
)
ßß( )
;
ßß) *
}
àà 
finally
áá 
{
ââ 
logData
ãã 
=
ãã 
null
ãã 
;
ãã 
}
ää 
}
åå 	
private
éé 
void
éé %
writeSocketDataReceived
éé ,
(
éé, -*
FSocketDataReceivedEventArgs
êê (
fArgs
êê) .
)
ëë 
{
ìì 	
StringBuilder
íí 
logData
íí !
=
íí" #
new
íí$ '
StringBuilder
íí( 5
(
íí5 6
)
íí6 7
;
íí7 8
try
ïï 
{
ğğ 
logData
ññ 
.
ññ 

AppendLine
ññ "
(
ññ" #
$str
ññ# &
+
ññ' (
DateTime
ññ) 1
.
ññ1 2
Now
ññ2 5
.
ññ5 6
ToString
ññ6 >
(
ññ> ?
$str
ññ? X
)
ññX Y
+
ññZ [
$str
ññ\ _
)
ññ_ `
;
ññ` a
logData
õõ 
.
õõ 
Append
õõ 
(
õõ 
fArgs
õõ $
.
õõ$ %
fEventId
õõ% -
.
õõ- .
ToString
õõ. 6
(
õõ6 7
)
õõ7 8
)
õõ8 9
;
õõ9 :
logData
öö 
.
öö 
Append
öö 
(
öö 
$str
öö +
+
öö, -
fArgs
öö. 3
.
öö3 4
fResult
öö4 ;
.
öö; <
ToString
öö< D
(
ööD E
)
ööE F
+
ööG H
$str
ööI L
)
ööL M
;
ööM N
if
÷÷ 
(
÷÷ 
fArgs
÷÷ 
.
÷÷ 
fResult
÷÷ !
!=
÷÷" $
FResultCode
÷÷% 0
.
÷÷0 1
Success
÷÷1 8
)
÷÷8 9
{
øø 
logData
ùù 
.
ùù 
Append
ùù "
(
ùù" #
$str
ùù# 5
+
ùù6 7
fArgs
ùù8 =
.
ùù= >
errorMessage
ùù> J
+
ùùK L
$str
ùùM P
)
ùùP Q
;
ùùQ R
}
úú 
logData
ûû 
.
ûû 

AppendLine
ûû "
(
ûû" #
)
ûû# $
;
ûû$ %
foreach
ÿÿ 
(
ÿÿ 
string
ÿÿ 
s
ÿÿ  !
in
ÿÿ" $
binToString
ÿÿ% 0
(
ÿÿ0 1
fArgs
ÿÿ1 6
.
ÿÿ6 7
fSocketData
ÿÿ7 B
)
ÿÿB C
)
ÿÿC D
{
€€ 
logData
 
.
 

AppendLine
 &
(
& '
s
' (
)
( )
;
) *
}
‚‚ 
logData
†† 
.
†† 

AppendLine
†† "
(
††" #
)
††# $
;
††$ %
m_fLogQueue
‡‡ 
.
‡‡ 
enqueue
‡‡ #
(
‡‡# $
logData
‡‡$ +
.
‡‡+ ,
ToString
‡‡, 4
(
‡‡4 5
)
‡‡5 6
)
‡‡6 7
;
‡‡7 8
}
ˆˆ 
catch
‰‰ 
(
‰‰ 
	Exception
‰‰ 
ex
‰‰ 
)
‰‰  
{
ŠŠ 
FDebug
‹‹ 
.
‹‹ 
throwException
‹‹ %
(
‹‹% &
ex
‹‹& (
)
‹‹( )
;
‹‹) *
}
ŒŒ 
finally
 
{
 
logData
 
=
 
null
 
;
 
}
 
}
‘‘ 	
private
•• 
void
•• !
writeSocketDataSent
•• (
(
••( )&
FSocketDataSentEventArgs
–– $
fArgs
––% *
)
—— 
{
˜˜ 	
StringBuilder
™™ 
logData
™™ !
=
™™" #
new
™™$ '
StringBuilder
™™( 5
(
™™5 6
)
™™6 7
;
™™7 8
try
›› 
{
œœ 
logData
 
.
 

AppendLine
 "
(
" #
$str
# &
+
' (
DateTime
) 1
.
1 2
Now
2 5
.
5 6
ToString
6 >
(
> ?
$str
? X
)
X Y
+
Z [
$str
\ _
)
_ `
;
` a
logData
¡¡ 
.
¡¡ 
Append
¡¡ 
(
¡¡ 
fArgs
¡¡ $
.
¡¡$ %
fEventId
¡¡% -
.
¡¡- .
ToString
¡¡. 6
(
¡¡6 7
)
¡¡7 8
)
¡¡8 9
;
¡¡9 :
logData
¢¢ 
.
¢¢ 
Append
¢¢ 
(
¢¢ 
$str
¢¢ +
+
¢¢, -
fArgs
¢¢. 3
.
¢¢3 4
fResult
¢¢4 ;
.
¢¢; <
ToString
¢¢< D
(
¢¢D E
)
¢¢E F
+
¢¢G H
$str
¢¢I L
)
¢¢L M
;
¢¢M N
if
££ 
(
££ 
fArgs
££ 
.
££ 
fResult
££ !
!=
££" $
FResultCode
££% 0
.
££0 1
Success
££1 8
)
££8 9
{
¤¤ 
logData
¥¥ 
.
¥¥ 
Append
¥¥ "
(
¥¥" #
$str
¥¥# 5
+
¥¥6 7
fArgs
¥¥8 =
.
¥¥= >
errorMessage
¥¥> J
+
¥¥K L
$str
¥¥M P
)
¥¥P Q
;
¥¥Q R
}
¦¦ 
logData
§§ 
.
§§ 

AppendLine
§§ "
(
§§" #
)
§§# $
;
§§$ %
foreach
«« 
(
«« 
string
«« 
s
««  !
in
««" $
binToString
««% 0
(
««0 1
fArgs
««1 6
.
««6 7
fSocketData
««7 B
.
««B C
data
««C G
)
««G H
)
««H I
{
¬¬ 
logData
­­ 
.
­­ 

AppendLine
­­ &
(
­­& '
s
­­' (
)
­­( )
;
­­) *
}
®® 
logData
²² 
.
²² 

AppendLine
²² "
(
²²" #
)
²²# $
;
²²$ %
m_fLogQueue
³³ 
.
³³ 
enqueue
³³ #
(
³³# $
logData
³³$ +
.
³³+ ,
ToString
³³, 4
(
³³4 5
)
³³5 6
)
³³6 7
;
³³7 8
}
´´ 
catch
µµ 
(
µµ 
	Exception
µµ 
ex
µµ 
)
µµ  
{
¶¶ 
FDebug
·· 
.
·· 
throwException
·· %
(
··% &
ex
··& (
)
··( )
;
··) *
}
¸¸ 
finally
¹¹ 
{
ºº 
logData
»» 
=
»» 
null
»» 
;
»» 
}
¼¼ 
}
½½ 	
public
ÁÁ 
void
ÁÁ 
write
ÁÁ 
(
ÁÁ 
FEventArgsBase
ÂÂ 
fArgs
ÂÂ  
)
ÃÃ 
{
ÄÄ 	
try
ÅÅ 
{
ÆÆ 
if
ÇÇ 
(
ÇÇ 
fArgs
ÇÇ 
.
ÇÇ 
fEventId
ÇÇ "
==
ÇÇ# %
FEventId
ÇÇ& .
.
ÇÇ. /
LogMonitoring
ÇÇ/ <
)
ÇÇ< =
{
ÈÈ 
return
ÉÉ 
;
ÉÉ 
}
ÊÊ 
if
ÎÎ 
(
ÎÎ 
fArgs
ÎÎ 
.
ÎÎ 
fEventId
ÎÎ "
==
ÎÎ# %
FEventId
ÎÎ& .
.
ÎÎ. / 
SerialStateChanged
ÎÎ/ A
)
ÎÎA B
{
ÏÏ %
writeSerialStateChanged
ĞĞ +
(
ĞĞ+ ,
(
ĞĞ, -0
"FSerialPluginStateChangedEventArgs
ĞĞ- O
)
ĞĞO P
fArgs
ĞĞP U
)
ĞĞU V
;
ĞĞV W
}
ÑÑ 
else
ÒÒ 
if
ÒÒ 
(
ÒÒ 
fArgs
ÒÒ 
.
ÒÒ 
fEventId
ÒÒ '
==
ÒÒ( *
FEventId
ÒÒ+ 3
.
ÒÒ3 4
SerialErrorRaised
ÒÒ4 E
)
ÒÒE F
{
ÓÓ $
writeSerialErrorRaised
ÔÔ *
(
ÔÔ* +
(
ÔÔ+ ,/
!FSerialPluginErrorRaisedEventArgs
ÔÔ, M
)
ÔÔM N
fArgs
ÔÔN S
)
ÔÔS T
;
ÔÔT U
}
ÕÕ 
else
ÖÖ 
if
ÖÖ 
(
ÖÖ 
fArgs
ÖÖ 
.
ÖÖ 
fEventId
ÖÖ '
==
ÖÖ( *
FEventId
ÖÖ+ 3
.
ÖÖ3 4 
SerialDataReceived
ÖÖ4 F
)
ÖÖF G
{
×× %
writeSerialDataReceived
ØØ +
(
ØØ+ ,
(
ØØ, -0
"FSerialPluginDataReceivedEventArgs
ØØ- O
)
ØØO P
fArgs
ØØP U
)
ØØU V
;
ØØV W
}
ÙÙ 
else
ÚÚ 
if
ÚÚ 
(
ÚÚ 
fArgs
ÚÚ 
.
ÚÚ 
fEventId
ÚÚ '
==
ÚÚ( *
FEventId
ÚÚ+ 3
.
ÚÚ3 4
SerialDataSent
ÚÚ4 B
)
ÚÚB C
{
ÛÛ !
writeSerialDataSent
ÜÜ '
(
ÜÜ' (
(
ÜÜ( ),
FSerialPluginDataSentEventArgs
ÜÜ) G
)
ÜÜG H
fArgs
ÜÜH M
)
ÜÜM N
;
ÜÜN O
}
İİ 
else
ßß 
if
ßß 
(
ßß 
fArgs
ßß 
.
ßß 
fEventId
ßß '
==
ßß( *
FEventId
ßß+ 3
.
ßß3 4 
SocketStateChanged
ßß4 F
)
ßßF G
{
àà %
writeSocketStateChanged
áá +
(
áá+ ,
(
áá, -*
FSocketStateChangedEventArgs
áá- I
)
ááI J
fArgs
ááJ O
)
ááO P
;
ááP Q
}
ââ 
else
ãã 
if
ãã 
(
ãã 
fArgs
ãã 
.
ãã 
fEventId
ãã '
==
ãã( *
FEventId
ãã+ 3
.
ãã3 4
SocketErrorRaised
ãã4 E
)
ããE F
{
ää $
writeSocketErrorRaised
åå *
(
åå* +
(
åå+ ,)
FSocketErrorRaisedEventArgs
åå, G
)
ååG H
fArgs
ååH M
)
ååM N
;
ååN O
}
ææ 
else
çç 
if
çç 
(
çç 
fArgs
çç 
.
çç 
fEventId
çç '
==
çç( *
FEventId
çç+ 3
.
çç3 4 
SocketDataReceived
çç4 F
)
ççF G
{
èè %
writeSocketDataReceived
éé +
(
éé+ ,
(
éé, -*
FSocketDataReceivedEventArgs
éé- I
)
ééI J
fArgs
ééJ O
)
ééO P
;
ééP Q
}
êê 
else
ëë 
if
ëë 
(
ëë 
fArgs
ëë 
.
ëë 
fEventId
ëë '
==
ëë( *
FEventId
ëë+ 3
.
ëë3 4
SocketDataSent
ëë4 B
)
ëëB C
{
ìì !
writeSocketDataSent
íí '
(
íí' (
(
íí( )&
FSocketDataSentEventArgs
íí) A
)
ííA B
fArgs
ííB G
)
ííG H
;
ííH I
}
îî 
}
ïï 
catch
ğğ 
(
ğğ 
	Exception
ğğ 
ex
ğğ 
)
ğğ  
{
ññ 
FDebug
òò 
.
òò 
writeLog
òò 
(
òò  
ex
òò  "
)
òò" #
;
òò# $
}
óó 
finally
ôô 
{
õõ 
}
÷÷ 
}
øø 	
public
üü 
void
üü 
write
üü 
(
üü 
string
ıı 
log
ıı 
)
şş 
{
ÿÿ 	
StringBuilder
€€ 
logData
€€ !
=
€€" #
new
€€$ '
StringBuilder
€€( 5
(
€€5 6
)
€€6 7
;
€€7 8
try
‚‚ 
{
ƒƒ 
logData
„„ 
.
„„ 

AppendLine
„„ "
(
„„" #
$str
„„# &
+
„„' (
DateTime
„„) 1
.
„„1 2
Now
„„2 5
.
„„5 6
ToString
„„6 >
(
„„> ?
$str
„„? X
)
„„X Y
+
„„Z [
$str
„„\ _
)
„„_ `
;
„„` a
logData
…… 
.
…… 
Append
…… 
(
…… 
log
…… "
)
……" #
;
……# $
m_fLogQueue
†† 
.
†† 
enqueue
†† #
(
††# $
logData
††$ +
.
††+ ,
ToString
††, 4
(
††4 5
)
††5 6
)
††6 7
;
††7 8
}
‡‡ 
catch
ˆˆ 
(
ˆˆ 
	Exception
ˆˆ 
ex
ˆˆ 
)
ˆˆ  
{
‰‰ 
FDebug
ŠŠ 
.
ŠŠ 
throwException
ŠŠ %
(
ŠŠ% &
ex
ŠŠ& (
)
ŠŠ( )
;
ŠŠ) *
}
‹‹ 
finally
ŒŒ 
{
 
logData
 
=
 
null
 
;
 
}
 
}
 	
private
˜˜ 
void
˜˜ (
m_fThdMain_ThreadJobCalled
˜˜ /
(
˜˜/ 0
object
™™ 
sender
™™ 
,
™™ 
FThreadEventArgs
šš 
e
šš 
)
›› 
{
œœ 	
try
 
{
 
if
ŸŸ 
(
ŸŸ 
m_fLogQueue
ŸŸ 
.
ŸŸ  
count
ŸŸ  %
==
ŸŸ& (
$num
ŸŸ) *
)
ŸŸ* +
{
   
e
¡¡ 
.
¡¡ 
sleepThread
¡¡ !
(
¡¡! "
$num
¡¡" #
)
¡¡# $
;
¡¡$ %
return
¢¢ 
;
¢¢ 
}
££ 
writeLog
¤¤ 
(
¤¤ 
)
¤¤ 
;
¤¤ 
}
¥¥ 
catch
¦¦ 
(
¦¦ 
	Exception
¦¦ 
ex
¦¦ 
)
¦¦  
{
§§ 
FDebug
¨¨ 
.
¨¨ 
writeLog
¨¨ 
(
¨¨  
ex
¨¨  "
)
¨¨" #
;
¨¨# $
e
©© 
.
©© 
sleepThread
©© 
(
©© 
$num
©© 
)
©©  
;
©©  !
}
ªª 
finally
«« 
{
¬¬ 
}
®® 
}
¯¯ 	
}
µµ 
}¶¶ —[
’D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\SerialToEthernet\Protocol\Serial\c_FSerialPluginSerialRecvBuffer.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSerialToEthernet -
{ 
public 

class #
FSerialPluginRecvBuffer (
:( )
IDisposable* 5
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
List 
< 
Byte 
> 
m_data !
=" #
null$ (
;( )
private 
byte 
[ 
] 
m_suffix 
=  !
new" %
byte& *
[* +
]+ ,
{- .
$num/ 3
,3 4
$num5 9
}: ;
;; <
private 
byte 
[ 
] 
m_bin 
= 
null #
;# $
public$$ #
FSerialPluginRecvBuffer$$ &
($$& '
)%% 
{&& 	
m_data'' 
='' 
new'' 
List'' 
<'' 
Byte'' "
>''" #
(''# $
)''$ %
;''% &
}(( 	
public++ #
FSerialPluginRecvBuffer++ &
(++& '
byte,, 
[,, 
],, 
suffix,, 
)-- 
:-- 
this-- 
(-- 
)-- 
{.. 	
m_suffix// 
=// 
suffix// 
;// 
}00 	
~44 	#
FSerialPluginRecvBuffer44	  
(44  !
)55 
{66 	
	myDispose77 
(77 
false77 
)77 
;77 
}88 	
	protected<< 
void<< 
	myDispose<<  
(<<  !
bool== 
	disposing== 
)>> 
{?? 	
if@@ 
(@@ 
!@@ 

m_disposed@@ 
)@@ 
{AA 
ifBB 
(BB 
	disposingBB 
)BB 
{CC 
m_dataDD 
=DD 
nullDD !
;DD! "
}EE 

m_disposedGG 
=GG 
trueGG !
;GG! "
}HH 
}II 	
publicQQ 
voidQQ 
DisposeQQ 
(QQ 
)RR 
{SS 	
	myDisposeTT 
(TT 
trueTT 
)TT 
;TT 
GCUU 
.UU 
SuppressFinalizeUU 
(UU  
thisUU  $
)UU$ %
;UU% &
}VV 	
public^^ 
bool^^ 
isCompleted^^ 
{__ 	
get`` 
{aa 
intbb 
etxPtrbb 
=bb 
$numbb 
;bb 
trydd 
{ee 
ifff 
(ff 
m_suffixff  
==ff! #
nullff$ (
)ff( )
{gg 
returnhh 
truehh #
;hh# $
}ii 
etxPtrmm 
=mm 
m_datamm #
.mm# $
IndexOfmm$ +
(mm+ ,
m_suffixmm, 4
[mm4 5
$nummm5 6
]mm6 7
)mm7 8
;mm8 9
ifnn 
(nn 
etxPtrnn 
!=nn !
-nn" #
$numnn# $
&&nn% '
m_datann( .
.nn. /
Countnn/ 4
>=nn5 7
etxPtrnn8 >
+nn? @
m_suffixnnA I
.nnI J
LengthnnJ P
)nnP Q
{oo 
forpp 
(pp 
intpp  
ipp! "
=pp# $
$numpp% &
;pp& '
ipp( )
<pp* +
m_suffixpp, 4
.pp4 5
Lengthpp5 ;
-pp< =
$numpp> ?
;pp? @
ippA B
++ppB D
)ppD E
{qq 
ifrr 
(rr  
m_suffixrr  (
[rr( )
irr) *
]rr* +
!=rr, .
(rr/ 0
byterr0 4
)rr4 5
m_datarr5 ;
[rr; <
etxPtrrr< B
+rrC D
irrE F
]rrF G
)rrG H
{ss 
returntt  &
falsett' ,
;tt, -
}uu 
}vv 
returnww 
trueww #
;ww# $
}xx 
}yy 
catchzz 
(zz 
	Exceptionzz  
exzz! #
)zz# $
{{{ 
FDebug|| 
.|| 
throwException|| )
(||) *
ex||* ,
)||, -
;||- .
}}} 
finally~~ 
{ 
}
 
return
‚‚ 
false
‚‚ 
;
‚‚ 
}
ƒƒ 
}
„„ 	
public
ˆˆ 
byte
ˆˆ 
[
ˆˆ 
]
ˆˆ 
binData
ˆˆ 
{
‰‰ 	
get
ŠŠ 
{
‹‹ 
try
ŒŒ 
{
 
return
 
m_data
 !
.
! "
ToArray
" )
(
) *
)
* +
;
+ ,
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
‘‘ 
FDebug
’’ 
.
’’ 
throwException
’’ )
(
’’) *
ex
’’* ,
)
’’, -
;
’’- .
}
““ 
finally
”” 
{
•• 
}
—— 
return
˜˜ 
null
˜˜ 
;
˜˜ 
}
™™ 
}
šš 	
public
 
string
 
binToString
 !
{
ŸŸ 	
get
   
{
¡¡ 
try
¢¢ 
{
££ 
return
¤¤ 
Encoding
¤¤ #
.
¤¤# $
Default
¤¤$ +
.
¤¤+ ,
	GetString
¤¤, 5
(
¤¤5 6
m_bin
¤¤6 ;
)
¤¤; <
;
¤¤< =
}
¥¥ 
catch
¦¦ 
(
¦¦ 
	Exception
¦¦  
ex
¦¦! #
)
¦¦# $
{
§§ 
FDebug
¨¨ 
.
¨¨ 
throwException
¨¨ )
(
¨¨) *
ex
¨¨* ,
)
¨¨, -
;
¨¨- .
}
©© 
finally
ªª 
{
«« 
}
­­ 
return
®® 
string
®® 
.
®® 
Empty
®® #
;
®®# $
}
¯¯ 
}
°° 	
public
¸¸ 
void
¸¸ 
init
¸¸ 
(
¸¸ 
)
¹¹ 
{
ºº 	
try
»» 
{
¼¼ 
m_bin
½½ 
=
½½ 
null
½½ 
;
½½ 
}
¾¾ 
catch
¿¿ 
(
¿¿ 
	Exception
¿¿ 
ex
¿¿ 
)
¿¿  
{
ÀÀ 
FDebug
ÁÁ 
.
ÁÁ 
throwException
ÁÁ %
(
ÁÁ% &
ex
ÁÁ& (
)
ÁÁ( )
;
ÁÁ) *
}
ÂÂ 
finally
ÃÃ 
{
ÄÄ 
}
ÆÆ 
}
ÇÇ 	
public
ËË 
void
ËË 
clear
ËË 
(
ËË 
)
ÌÌ 
{
ÍÍ 	
try
ÎÎ 
{
ÏÏ 
init
ĞĞ 
(
ĞĞ 
)
ĞĞ 
;
ĞĞ 
m_data
ÑÑ 
.
ÑÑ 
Clear
ÑÑ 
(
ÑÑ 
)
ÑÑ 
;
ÑÑ 
}
ÒÒ 
catch
ÓÓ 
(
ÓÓ 
	Exception
ÓÓ 
ex
ÓÓ 
)
ÓÓ  
{
ÔÔ 
FDebug
ÕÕ 
.
ÕÕ 
throwException
ÕÕ %
(
ÕÕ% &
ex
ÕÕ& (
)
ÕÕ( )
;
ÕÕ) *
}
ÖÖ 
finally
×× 
{
ØØ 
}
ÚÚ 
}
ÛÛ 	
public
ßß 
void
ßß 
input
ßß 
(
ßß 
byte
àà 
[
àà 
]
àà 
data
àà 
)
áá 
{
ââ 	
try
ãã 
{
ää 
m_data
åå 
.
åå 
AddRange
åå 
(
åå  
data
åå  $
)
åå$ %
;
åå% &
}
ææ 
catch
çç 
(
çç 
	Exception
çç 
ex
çç 
)
çç  
{
èè 
FDebug
éé 
.
éé 
throwException
éé %
(
éé% &
ex
éé& (
)
éé( )
;
éé) *
}
êê 
finally
ëë 
{
ìì 
}
îî 
}
ïï 	
public
óó 
bool
óó 
parse
óó 
(
óó 
)
ôô 
{
õõ 	
int
öö 
etxPtr
öö 
=
öö 
$num
öö 
;
öö 
try
øø 
{
ùù 
if
úú 
(
úú 
m_data
úú 
.
úú 
Count
úú  
==
úú! #
$num
úú$ %
)
úú% &
{
ûû 
return
üü 
false
üü  
;
üü  !
}
ıı 
if
 
(
 
m_suffix
 
==
 
null
  $
)
$ %
{
‚‚ 
etxPtr
ƒƒ 
=
ƒƒ 
m_data
ƒƒ #
.
ƒƒ# $
Count
ƒƒ$ )
;
ƒƒ) *
}
„„ 
else
…… 
{
†† 
etxPtr
‡‡ 
=
‡‡ 
m_data
‡‡ #
.
‡‡# $
IndexOf
‡‡$ +
(
‡‡+ ,
m_suffix
‡‡, 4
[
‡‡4 5
$num
‡‡5 6
]
‡‡6 7
)
‡‡7 8
;
‡‡8 9
if
‰‰ 
(
‰‰ 
etxPtr
‰‰ 
==
‰‰ !
-
‰‰" #
$num
‰‰# $
)
‰‰$ %
{
ŠŠ 
return
‹‹ 
false
‹‹ $
;
‹‹$ %
}
ŒŒ 
for
 
(
 
int
 
i
 
=
  
$num
! "
;
" #
i
$ %
<
& '
m_suffix
( 0
.
0 1
Length
1 7
-
8 9
$num
: ;
;
; <
i
= >
++
> @
)
@ A
{
 
if
 
(
 
m_suffix
 $
[
$ %
i
% &
]
& '
!=
( *
(
+ ,
byte
, 0
)
0 1
m_data
1 7
[
7 8
etxPtr
8 >
+
? @
i
A B
]
B C
)
C D
{
‘‘ 
return
’’ "
false
’’# (
;
’’( )
}
““ 
}
”” 
}
•• 
m_bin
™™ 
=
™™ 
m_data
™™ 
.
™™ 
GetRange
™™ '
(
™™' (
$num
™™( )
,
™™) *
etxPtr
™™+ 1
)
™™1 2
.
™™2 3
ToArray
™™3 :
(
™™: ;
)
™™; <
;
™™< =
m_data
   
.
   
RemoveRange
   "
(
  " #
$num
  # $
,
  $ %
etxPtr
  & ,
+
  - .
(
  / 0
m_suffix
  0 8
!=
  9 ;
null
  < @
?
  A B
m_suffix
  C K
.
  K L
Length
  L R
:
  S T
$num
  U V
)
  V W
)
  W X
;
  X Y
return
¡¡ 
true
¡¡ 
;
¡¡ 
}
¢¢ 
catch
££ 
(
££ 
	Exception
££ 
ex
££ 
)
££  
{
¤¤ 
FDebug
¥¥ 
.
¥¥ 
throwException
¥¥ %
(
¥¥% &
ex
¥¥& (
)
¥¥( )
;
¥¥) *
}
¦¦ 
finally
§§ 
{
¨¨ 
}
ªª 
return
«« 
false
«« 
;
«« 
}
¬¬ 	
}
²² 
}³³ Œè
‚D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\SerialToEthernet\Protocol\Serial\c_FSerialPlugin.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSerialToEthernet -
{ 
internal 
class 
FSerialPlugin  
:  !
IDisposable" -
{ 
private 
const 
int 
AutoCycleRunTime *
=+ ,
$num- /
;/ 0
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FSerialToEthernet !
m_fSerialToEthernet" 5
=6 7
null8 <
;< =
private 
FSerial 
	m_fSerial !
=" #
null$ (
;( )
private   
string   

m_portName   !
=  " #
string  $ *
.  * +
Empty  + 0
;  0 1
private!! 
int!! 

m_baudRate!! 
=!!  
$num!!! %
;!!% &
private## 
	FCodeLock## 
m_fMainSync## %
=##& '
null##( ,
;##, -
private$$ 
FThread$$ 

m_fThdMain$$ "
=$$# $
null$$% )
;$$) *
private%% 
FStaticTimer%% 
m_fTmrAutoCycle%% ,
=%%- .
null%%/ 3
;%%3 4
private&& #
FSerialPluginRecvBuffer&& '
m_fRecvBuffer&&( 5
=&&6 7
null&&8 <
;&&< =
public,, 
FSerialPlugin,, 
(,, 
FSerialToEthernet-- 
fSerialToEthernet-- /
).. 
{// 	
m_fSerialToEthernet00 
=00  !
fSerialToEthernet00" 3
;003 4

m_portName11 
=11 
fSerialToEthernet11 *
.11* +
fSerialConfig11+ 8
.118 9

serialPort119 C
;11C D

m_baudRate22 
=22 
fSerialToEthernet22 *
.22* +
fSerialConfig22+ 8
.228 9
baud229 =
;22= >
init44 
(44 
)44 
;44 
}55 	
~99 	
FSerialPlugin99	 
(99 
):: 
{;; 	
	myDispose<< 
(<< 
false<< 
)<< 
;<< 
}== 	
	protectedAA 
voidAA 
	myDisposeAA  
(AA  !
boolBB 
	disposingBB 
)CC 
{DD 	
ifEE 
(EE 
!EE 

m_disposedEE 
)EE 
{FF 
ifGG 
(GG 
	disposingGG 
)GG 
{HH 
termII 
(II 
)II 
;II 
m_fSerialToEthernetKK '
=KK( )
nullKK* .
;KK. /
}LL 

m_disposedNN 
=NN 
trueNN !
;NN! "
}OO 
}PP 	
publicXX 
voidXX 
DisposeXX 
(XX 
)YY 
{ZZ 	
	myDispose[[ 
([[ 
true[[ 
)[[ 
;[[ 
GC\\ 
.\\ 
SuppressFinalize\\ 
(\\  
this\\  $
)\\$ %
;\\% &
}]] 	
privatekk 
voidkk 
initkk 
(kk 
)ll 
{mm 	
trynn 
{oo 
	m_fSerialpp 
=pp 
newpp 
FSerialpp  '
(pp' (
m_fSerialToEthernetqq '
.qq' (
fSerialConfigqq( 5
.qq5 6

serialPortqq6 @
,qq@ A
m_fSerialToEthernetrr '
.rr' (
fSerialConfigrr( 5
.rr5 6
baudrr6 :
,rr: ;
m_fSerialToEthernetss '
.ss' (
fSerialConfigss( 5
.ss5 6
parityss6 <
,ss< =
m_fSerialToEthernettt '
.tt' (
fSerialConfigtt( 5
.tt5 6
dataBitstt6 >
,tt> ?
m_fSerialToEthernetuu '
.uu' (
fSerialConfiguu( 5
.uu5 6
stopBitsuu6 >
)vv 
;vv 
	m_fSerialxx 
.xx 
SerialStateChangedxx ,
+=xx- /
newxx0 3+
FSerialStateChangedEventHandlerxx4 S
(xxS T(
m_fSerial_SerialStateChangedxxT p
)xxp q
;xxq r
	m_fSerialyy 
.yy 
SerialDataReceivedyy ,
+=yy- /
newyy0 3+
FSerialDataReceivedEventHandleryy4 S
(yyS T(
m_fSerial_SerialDataReceivedyyT p
)yyp q
;yyq r
	m_fSerialzz 
.zz 
SerialDataSentzz (
+=zz) +
newzz, /'
FSerialDataSentEventHandlerzz0 K
(zzK L$
m_fSerial_SerialDataSentzzL d
)zzd e
;zze f
	m_fSerial{{ 
.{{  
SerialDataSendFailed{{ .
+={{/ 1
new{{2 5-
!FSerialDataSendFailedEventHandler{{6 W
({{W X*
m_fSerial_SerialDataSendFailed{{X v
){{v w
;{{w x
	m_fSerial|| 
.|| 
SerialErrorRaised|| +
+=||, .
new||/ 2*
FSerialErrorRaisedEventHandler||3 Q
(||Q R'
m_fSerial_SerialErrorRaised||R m
)||m n
;||n o
m_fTmrAutoCycle
€€ 
=
€€  !
new
€€" %
FStaticTimer
€€& 2
(
€€2 3
)
€€3 4
;
€€4 5
m_fMainSync
 
=
 
new
 !
	FCodeLock
" +
(
+ ,
)
, -
;
- .

m_fThdMain
‚‚ 
=
‚‚ 
new
‚‚  
FThread
‚‚! (
(
‚‚( )
$str
‚‚) ;
)
‚‚; <
;
‚‚< =

m_fThdMain
ƒƒ 
.
ƒƒ 
ThreadJobCalled
ƒƒ *
+=
ƒƒ+ -
new
ƒƒ. 1*
FThreadJobCalledEventHandler
ƒƒ2 N
(
ƒƒN O(
m_fThdMain_ThreadJobCalled
ƒƒO i
)
ƒƒi j
;
ƒƒj k

m_fThdMain
„„ 
.
„„ 
start
„„  
(
„„  !
)
„„! "
;
„„" #
}
…… 
catch
†† 
(
†† 
	Exception
†† 
ex
†† 
)
††  
{
‡‡ 
FDebug
ˆˆ 
.
ˆˆ 
throwException
ˆˆ %
(
ˆˆ% &
ex
ˆˆ& (
)
ˆˆ( )
;
ˆˆ) *
}
‰‰ 
finally
ŠŠ 
{
‹‹ 
}
 
}
 	
private
’’ 
void
’’ 
term
’’ 
(
’’ 
)
““ 
{
”” 	
try
•• 
{
–– 
if
—— 
(
—— 

m_fThdMain
—— 
!=
—— !
null
——" &
)
——& '
{
˜˜ 

m_fThdMain
™™ 
.
™™ 
stop
™™ #
(
™™# $
)
™™$ %
;
™™% &

m_fThdMain
šš 
.
šš 
Dispose
šš &
(
šš& '
)
šš' (
;
šš( )

m_fThdMain
›› 
.
›› 
ThreadJobCalled
›› .
-=
››/ 1
new
››2 5*
FThreadJobCalledEventHandler
››6 R
(
››R S(
m_fThdMain_ThreadJobCalled
››S m
)
››m n
;
››n o

m_fThdMain
œœ 
=
œœ  
null
œœ! %
;
œœ% &
}
 
if
ŸŸ 
(
ŸŸ 
	m_fSerial
ŸŸ 
!=
ŸŸ  
null
ŸŸ! %
)
ŸŸ% &
{
   
	m_fSerial
¡¡ 
.
¡¡ 
close
¡¡ #
(
¡¡# $
)
¡¡$ %
;
¡¡% &
	m_fSerial
¢¢ 
.
¢¢ 
Dispose
¢¢ %
(
¢¢% &
)
¢¢& '
;
¢¢' (
	m_fSerial
¤¤ 
.
¤¤  
SerialStateChanged
¤¤ 0
-=
¤¤1 3
new
¤¤4 7-
FSerialStateChangedEventHandler
¤¤8 W
(
¤¤W X*
m_fSerial_SerialStateChanged
¤¤X t
)
¤¤t u
;
¤¤u v
	m_fSerial
¥¥ 
.
¥¥  
SerialDataReceived
¥¥ 0
-=
¥¥1 3
new
¥¥4 7-
FSerialDataReceivedEventHandler
¥¥8 W
(
¥¥W X*
m_fSerial_SerialDataReceived
¥¥X t
)
¥¥t u
;
¥¥u v
	m_fSerial
¦¦ 
.
¦¦ 
SerialDataSent
¦¦ ,
-=
¦¦- /
new
¦¦0 3)
FSerialDataSentEventHandler
¦¦4 O
(
¦¦O P&
m_fSerial_SerialDataSent
¦¦P h
)
¦¦h i
;
¦¦i j
	m_fSerial
§§ 
.
§§ "
SerialDataSendFailed
§§ 2
-=
§§3 5
new
§§6 9/
!FSerialDataSendFailedEventHandler
§§: [
(
§§[ \,
m_fSerial_SerialDataSendFailed
§§\ z
)
§§z {
;
§§{ |
	m_fSerial
¨¨ 
.
¨¨ 
SerialErrorRaised
¨¨ /
-=
¨¨0 2
new
¨¨3 6,
FSerialErrorRaisedEventHandler
¨¨7 U
(
¨¨U V)
m_fSerial_SerialErrorRaised
¨¨V q
)
¨¨q r
;
¨¨r s
	m_fSerial
ªª 
=
ªª 
null
ªª  $
;
ªª$ %
}
«« 
if
¯¯ 
(
¯¯ 
m_fTmrAutoCycle
¯¯ #
!=
¯¯$ &
null
¯¯' +
)
¯¯+ ,
{
°° 
m_fTmrAutoCycle
±± #
.
±±# $
Dispose
±±$ +
(
±±+ ,
)
±±, -
;
±±- .
m_fTmrAutoCycle
²² #
=
²²$ %
null
²²& *
;
²²* +
}
³³ 
if
µµ 
(
µµ 
m_fMainSync
µµ 
!=
µµ  "
null
µµ# '
)
µµ' (
{
¶¶ 
m_fMainSync
·· 
.
··  
Dispose
··  '
(
··' (
)
··( )
;
··) *
m_fMainSync
¸¸ 
=
¸¸  !
null
¸¸" &
;
¸¸& '
}
¹¹ 
}
ºº 
catch
»» 
(
»» 
	Exception
»» 
ex
»» 
)
»»  
{
¼¼ 
FDebug
½½ 
.
½½ 
throwException
½½ %
(
½½% &
ex
½½& (
)
½½( )
;
½½) *
}
¾¾ 
finally
¿¿ 
{
ÀÀ 
}
ÂÂ 
}
ÃÃ 	
public
ÇÇ 
void
ÇÇ 
open
ÇÇ 
(
ÇÇ 
)
ÈÈ 
{
ÉÉ 	
try
ÊÊ 
{
ËË  
procSerialPortOpen
ÌÌ "
(
ÌÌ" #
)
ÌÌ# $
;
ÌÌ$ %!
m_fSerialToEthernet
ĞĞ #
.
ĞĞ# $
changeSerialState
ĞĞ$ 5
(
ĞĞ5 6!
FCommunicationState
ĞĞ6 I
.
ĞĞI J
Opened
ĞĞJ P
,
ĞĞP Q

m_portName
ĞĞR \
,
ĞĞ\ ]

m_baudRate
ĞĞ^ h
)
ĞĞh i
;
ĞĞi j
}
ØØ 
catch
ÙÙ 
(
ÙÙ 
	Exception
ÙÙ 
ex
ÙÙ 
)
ÙÙ  
{
ÚÚ 
FDebug
ÛÛ 
.
ÛÛ 
throwException
ÛÛ %
(
ÛÛ% &
ex
ÛÛ& (
)
ÛÛ( )
;
ÛÛ) *
}
ÜÜ 
finally
İİ 
{
ŞŞ 
}
àà 
}
áá 	
public
åå 
void
åå 
close
åå 
(
åå 
)
ææ 
{
çç 	
try
èè 
{
éé !
procSerialPortClose
êê #
(
êê# $
)
êê$ %
;
êê% &!
m_fSerialToEthernet
îî #
.
îî# $
changeSerialState
îî$ 5
(
îî5 6!
FCommunicationState
îî6 I
.
îîI J
Closed
îîJ P
,
îîP Q

m_portName
îîR \
,
îî\ ]

m_baudRate
îî^ h
)
îîh i
;
îîi j
}
ïï 
catch
ğğ 
(
ğğ 
	Exception
ğğ 
ex
ğğ 
)
ğğ  
{
ññ 
FDebug
òò 
.
òò 
throwException
òò %
(
òò% &
ex
òò& (
)
òò( )
;
òò) *
}
óó 
finally
ôô 
{
õõ 
}
÷÷ 
}
øø 	
public
üü 
void
üü 
send
üü 
(
üü 
FSerialSendData
ıı 
fSerialSendData
ıı +
)
şş 
{
ÿÿ 	
try
€€ 
{
 
sendData
‚‚ 
(
‚‚ 
fSerialSendData
‚‚ (
)
‚‚( )
;
‚‚) *
}
ƒƒ 
catch
„„ 
(
„„ 
	Exception
„„ 
ex
„„ 
)
„„  
{
…… 
FDebug
†† 
.
†† 
throwException
†† %
(
††% &
ex
††& (
)
††( )
;
††) *
}
‡‡ 
finally
ˆˆ 
{
‰‰ 
}
‹‹ 
}
ŒŒ 	
private
 
void
 
sendData
 
(
 
FSerialSendData
‘‘ 
fSerialSendData
‘‘ +
)
’’ 
{
““ 	
try
”” 
{
•• 
	m_fSerial
–– 
.
–– 
send
–– 
(
–– 
fSerialSendData
–– .
)
––. /
;
––/ 0
}
—— 
catch
˜˜ 
(
˜˜ 
	Exception
˜˜ 
ex
˜˜ 
)
˜˜  
{
™™ #
procSerialErrorRaised
šš %
(
šš% &
ex
šš& (
)
šš( )
;
šš) *
}
›› 
finally
œœ 
{
 
}
ŸŸ 
}
   	
private
¤¤ 
void
¤¤  
procSerialPortOpen
¤¤ '
(
¤¤' (
)
¥¥ 
{
¦¦ 	
try
§§ 
{
¨¨ 
	m_fSerial
©© 
.
©© 
open
©© 
(
©© 
)
©©  
;
©©  !
}
ªª 
catch
«« 
(
«« 
	Exception
«« 
ex
«« 
)
««  
{
¬¬ #
procSerialErrorRaised
­­ %
(
­­% &
ex
­­& (
)
­­( )
;
­­) *
}
®® 
finally
¯¯ 
{
°° 
}
²² 
}
³³ 	
private
·· 
void
·· !
procSerialPortClose
·· (
(
··( )
)
¸¸ 
{
¹¹ 	
try
ºº 
{
»» 
if
¼¼ 
(
¼¼ 
	m_fSerial
¼¼ 
==
¼¼  
null
¼¼! %
)
¼¼% &
{
½½ 
return
¾¾ 
;
¾¾ 
}
¿¿ 
if
ÃÃ 
(
ÃÃ 
	m_fSerial
ÃÃ 
.
ÃÃ 
fState
ÃÃ $
==
ÃÃ% '
FSerialState
ÃÃ( 4
.
ÃÃ4 5
Opened
ÃÃ5 ;
)
ÃÃ; <
{
ÄÄ 
while
ÅÅ 
(
ÅÅ !
m_fSerialToEthernet
ÅÅ .
.
ÅÅ. /
fEventPusher
ÅÅ/ ;
.
ÅÅ; <
serialEventCount
ÅÅ< L
>
ÅÅM N
$num
ÅÅO P
||
ÅÅQ S
!
ÅÅT U
	m_fSerial
ÅÅU ^
.
ÅÅ^ _
sendCompleted
ÅÅ_ l
)
ÅÅl m
{
ÆÆ 
if
ÇÇ 
(
ÇÇ 
System
ÇÇ "
.
ÇÇ" #
Windows
ÇÇ# *
.
ÇÇ* +
Forms
ÇÇ+ 0
.
ÇÇ0 1
Application
ÇÇ1 <
.
ÇÇ< =
MessageLoop
ÇÇ= H
)
ÇÇH I
{
ÈÈ 
System
ÉÉ "
.
ÉÉ" #
Windows
ÉÉ# *
.
ÉÉ* +
Forms
ÉÉ+ 0
.
ÉÉ0 1
Application
ÉÉ1 <
.
ÉÉ< =
DoEvents
ÉÉ= E
(
ÉÉE F
)
ÉÉF G
;
ÉÉG H
}
ÊÊ 
System
ËË 
.
ËË 
	Threading
ËË (
.
ËË( )
Thread
ËË) /
.
ËË/ 0
Sleep
ËË0 5
(
ËË5 6
$num
ËË6 7
)
ËË7 8
;
ËË8 9
}
ÌÌ 
}
ÍÍ 
	m_fSerial
ÑÑ 
.
ÑÑ 
close
ÑÑ 
(
ÑÑ  
)
ÑÑ  !
;
ÑÑ! "
}
ÚÚ 
catch
ÛÛ 
(
ÛÛ 
	Exception
ÛÛ 
ex
ÛÛ 
)
ÛÛ  
{
ÜÜ #
procSerialErrorRaised
İİ %
(
İİ% &
ex
İİ& (
)
İİ( )
;
İİ) *
}
ŞŞ 
finally
ßß 
{
àà 
}
ââ 
}
ãã 	
private
çç 
void
çç &
procSerialStateConnected
çç -
(
çç- .
)
èè 
{
éé 	
try
êê 
{
ëë !
m_fSerialToEthernet
ìì #
.
ìì# $
changeSerialState
ìì$ 5
(
ìì5 6!
FCommunicationState
ìì6 I
.
ììI J
	Connected
ììJ S
,
ììS T

m_portName
ììU _
,
ìì_ `

m_baudRate
ììa k
)
ììk l
;
ììl m
}
ôô 
catch
õõ 
(
õõ 
	Exception
õõ 
ex
õõ 
)
õõ  
{
öö #
procSerialErrorRaised
÷÷ %
(
÷÷% &
ex
÷÷& (
)
÷÷( )
;
÷÷) *
}
øø 
finally
ùù 
{
úú 
}
üü 
}
ıı 	
private
 
void
 #
procSerialErrorRaised
 *
(
* +
	Exception
‚‚ 
inEx
‚‚ 
)
ƒƒ 
{
„„ 	
try
…… 
{
†† 
FDebug
‡‡ 
.
‡‡ 
writeLog
‡‡ 
(
‡‡  
inEx
‡‡  $
)
‡‡$ %
;
‡‡% &!
m_fSerialToEthernet
‰‰ #
.
‰‰# $
fEventPusher
‰‰$ 0
.
‰‰0 1
pushSerialEvent
‰‰1 @
(
‰‰@ A
new
ŠŠ /
!FSerialPluginErrorRaisedEventArgs
ŠŠ 9
(
ŠŠ9 :!
m_fSerialToEthernet
ŠŠ: M
,
ŠŠM N
FEventId
ŠŠO W
.
ŠŠW X
SerialErrorRaised
ŠŠX i
,
ŠŠi j
inEx
ŠŠk o
.
ŠŠo p
Message
ŠŠp w
)
ŠŠw x
)
‹‹ 
;
‹‹ 
}
ŒŒ 
catch
 
(
 
	Exception
 
ex
 
)
  
{
 
FDebug
 
.
 
writeLog
 
(
  
ex
  "
)
" #
;
# $
}
 
finally
‘‘ 
{
’’ 
}
”” 
}
•• 	
private
 
void
 (
m_fThdMain_ThreadJobCalled
 /
(
/ 0
object
 
sender
 
,
 
FThreadEventArgs
ŸŸ 
e
ŸŸ 
)
   
{
¡¡ 	
bool
¢¢ 
waited
¢¢ 
=
¢¢ 
false
¢¢ 
;
¢¢  
try
¤¤ 
{
¥¥ 
waited
¦¦ 
=
¦¦ 
m_fMainSync
¦¦ $
.
¦¦$ %
tryWait
¦¦% ,
(
¦¦, -
$num
¦¦- .
)
¦¦. /
;
¦¦/ 0
if
§§ 
(
§§ 
!
§§ 
waited
§§ 
)
§§ 
{
¨¨ 
return
©© 
;
©© 
}
ªª 
if
®® 
(
®® !
m_fSerialToEthernet
®® '
.
®®' (
fSerialState
®®( 4
==
®®5 7!
FCommunicationState
®®8 K
.
®®K L
	Connected
®®L U
)
®®U V
{
¯¯ 
e
°° 
.
°° 
sleepThread
°° !
(
°°! "
$num
°°" #
)
°°# $
;
°°$ %
return
±± 
;
±± 
}
²² 
if
¹¹ 
(
¹¹ 
m_fTmrAutoCycle
¹¹ #
.
¹¹# $
elasped
¹¹$ +
(
¹¹+ ,
true
¹¹, 0
)
¹¹0 1
)
¹¹1 2
{
ºº 
try
»» 
{
¼¼  
procSerialPortOpen
¾¾ *
(
¾¾* +
)
¾¾+ ,
;
¾¾, -
m_fTmrAutoCycle
¿¿ '
.
¿¿' (
stop
¿¿( ,
(
¿¿, -
)
¿¿- .
;
¿¿. /
}
ÀÀ 
catch
ÁÁ 
(
ÁÁ 
	Exception
ÁÁ $
ex
ÁÁ% '
)
ÁÁ' (
{
ÂÂ 
System
ÃÃ 
.
ÃÃ 
Diagnostics
ÃÃ *
.
ÃÃ* +
Debug
ÃÃ+ 0
.
ÃÃ0 1
	WriteLine
ÃÃ1 :
(
ÃÃ: ;
ex
ÄÄ 
.
ÄÄ 
Message
ÄÄ &
)
ÅÅ 
;
ÅÅ 
}
ÆÆ 
}
ÇÇ 
e
ËË 
.
ËË 
sleepThread
ËË 
(
ËË 
$num
ËË 
)
ËË  
;
ËË  !
}
ÌÌ 
catch
ÍÍ 
(
ÍÍ 
	Exception
ÍÍ 
ex
ÍÍ 
)
ÍÍ  
{
ÎÎ #
procSerialErrorRaised
ÏÏ %
(
ÏÏ% &
ex
ÏÏ& (
)
ÏÏ( )
;
ÏÏ) *
}
ĞĞ 
finally
ÑÑ 
{
ÒÒ 
if
ÓÓ 
(
ÓÓ 
waited
ÓÓ 
)
ÓÓ 
{
ÔÔ 
m_fMainSync
ÕÕ 
.
ÕÕ  
set
ÕÕ  #
(
ÕÕ# $
)
ÕÕ$ %
;
ÕÕ% &
}
ÖÖ 
}
×× 
}
ØØ 	
private
àà 
void
àà *
m_fSerial_SerialStateChanged
àà 1
(
àà1 2
object
áá 
sender
áá 
,
áá *
FSerialStateChangedEventArgs
ââ (
e
ââ) *
)
ãã 
{
ää 	
try
åå 
{
ææ 
m_fMainSync
çç 
.
çç 
wait
çç  
(
çç  !
)
çç! "
;
çç" #
if
ëë 
(
ëë 
e
ëë 
.
ëë 
fState
ëë 
==
ëë 
FSerialState
ëë  ,
.
ëë, -
Opened
ëë- 3
)
ëë3 4
{
ìì &
procSerialStateConnected
íí ,
(
íí, -
)
íí- .
;
íí. /
}
îî 
else
ïï 
if
ïï 
(
ïï 
e
ïï 
.
ïï 
fState
ïï !
==
ïï" $
FSerialState
ïï% 1
.
ïï1 2
Closed
ïï2 8
)
ïï8 9
{
ğğ 
}
òò 
}
óó 
catch
ôô 
(
ôô 
	Exception
ôô 
ex
ôô 
)
ôô  
{
õõ #
procSerialErrorRaised
öö %
(
öö% &
ex
öö& (
)
öö( )
;
öö) *
}
÷÷ 
finally
øø 
{
ùù 
m_fMainSync
úú 
.
úú 
set
úú 
(
úú  
)
úú  !
;
úú! "
}
ûû 
}
üü 	
private
€€ 
void
€€ *
m_fSerial_SerialDataReceived
€€ 1
(
€€1 2
object
 
sender
 
,
 *
FSerialDataReceivedEventArgs
‚‚ (
e
‚‚) *
)
ƒƒ 
{
„„ 	#
FSerialPluginRecvData
…… !
fSerialData
……" -
=
……. /
null
……0 4
;
……4 5
try
‡‡ 
{
ˆˆ 
m_fMainSync
‰‰ 
.
‰‰ 
wait
‰‰  
(
‰‰  !
)
‰‰! "
;
‰‰" #
if
 
(
 
e
 
.
 

dataLength
  
>
! "
$num
# $
)
$ %
{
 
if
 
(
 
m_fRecvBuffer
 %
==
& (
null
) -
)
- .
{
 
m_fRecvBuffer
‘‘ %
=
‘‘& '
new
‘‘( +%
FSerialPluginRecvBuffer
‘‘, C
(
‘‘C D!
m_fSerialToEthernet
‘‘D W
.
‘‘W X
fSerialConfig
‘‘X e
.
‘‘e f
suffix
‘‘f l
)
‘‘l m
;
‘‘m n
}
’’ 
m_fRecvBuffer
–– !
.
––! "
input
––" '
(
––' (
e
––( )
.
––) *
data
––* .
)
––. /
;
––/ 0
if
šš 
(
šš 
m_fRecvBuffer
šš %
.
šš% &
isCompleted
šš& 1
)
šš1 2
{
›› 
fSerialData
œœ #
=
œœ$ %
new
œœ& )#
FSerialPluginRecvData
œœ* ?
(
œœ? @!
m_fSerialToEthernet
œœ@ S
,
œœS T
m_fRecvBuffer
œœU b
.
œœb c
binData
œœc j
)
œœj k
;
œœk l!
m_fSerialToEthernet
 +
.
+ ,
fEventPusher
, 8
.
8 9
pushSerialEvent
9 H
(
H I
new
 0
"FSerialPluginDataReceivedEventArgs
  B
(
B C!
m_fSerialToEthernet
ŸŸ  3
,
ŸŸ3 4
FEventId
    (
.
  ( ) 
SerialDataReceived
  ) ;
,
  ; <
FResultCode
¡¡  +
.
¡¡+ ,
Success
¡¡, 3
,
¡¡3 4
string
¢¢  &
.
¢¢& '
Empty
¢¢' ,
,
¢¢, -
fSerialData
££  +
)
¤¤  !
)
¥¥ 
;
¥¥ 
m_fRecvBuffer
§§ %
=
§§& '
null
§§( ,
;
§§, -
}
¨¨ 
}
ªª 
}
«« 
catch
¬¬ 
(
¬¬ 
	Exception
¬¬ 
ex
¬¬ 
)
¬¬  
{
­­ 
FDebug
®® 
.
®® 
writeLog
®® 
(
®®  
ex
®®  "
)
®®" #
;
®®# $
}
¯¯ 
finally
°° 
{
±± 
m_fMainSync
²² 
.
²² 
set
²² 
(
²²  
)
²²  !
;
²²! "
}
³³ 
}
´´ 	
private
¸¸ 
void
¸¸ &
m_fSerial_SerialDataSent
¸¸ -
(
¸¸- .
object
¹¹ 
sender
¹¹ 
,
¹¹ &
FSerialDataSentEventArgs
ºº $
e
ºº% &
)
»» 
{
¼¼ 	
try
½½ 
{
¾¾ 
m_fMainSync
¿¿ 
.
¿¿ 
wait
¿¿  
(
¿¿  !
)
¿¿! "
;
¿¿" #!
m_fSerialToEthernet
ÃÃ #
.
ÃÃ# $
fEventPusher
ÃÃ$ 0
.
ÃÃ0 1
pushSerialEvent
ÃÃ1 @
(
ÃÃ@ A
new
ÄÄ ,
FSerialPluginDataSentEventArgs
ÄÄ 6
(
ÄÄ6 7!
m_fSerialToEthernet
ÅÅ +
,
ÅÅ+ ,
FEventId
ÆÆ  
.
ÆÆ  !
SerialDataSent
ÆÆ! /
,
ÆÆ/ 0
FResultCode
ÇÇ #
.
ÇÇ# $
Success
ÇÇ$ +
,
ÇÇ+ ,
string
ÈÈ 
.
ÈÈ 
Empty
ÈÈ $
,
ÈÈ$ %
new
ÉÉ 
FSerialSendData
ÉÉ +
(
ÉÉ+ ,
e
ÉÉ, -
.
ÉÉ- .
data
ÉÉ. 2
)
ÉÉ2 3
)
ÊÊ 
)
ËË 
;
ËË 
}
ÌÌ 
catch
ÍÍ 
(
ÍÍ 
	Exception
ÍÍ 
ex
ÍÍ 
)
ÍÍ  
{
ÎÎ 
FDebug
ÏÏ 
.
ÏÏ 
writeLog
ÏÏ 
(
ÏÏ  
ex
ÏÏ  "
)
ÏÏ" #
;
ÏÏ# $
}
ĞĞ 
finally
ÑÑ 
{
ÒÒ 
m_fMainSync
ÓÓ 
.
ÓÓ 
set
ÓÓ 
(
ÓÓ  
)
ÓÓ  !
;
ÓÓ! "
}
ÔÔ 
}
ÕÕ 	
private
ÙÙ 
void
ÙÙ ,
m_fSerial_SerialDataSendFailed
ÙÙ 3
(
ÙÙ3 4
object
ÚÚ 
sender
ÚÚ 
,
ÚÚ ,
FSerialDataSendFailedEventArgs
ÛÛ *
e
ÛÛ+ ,
)
ÜÜ 
{
İİ 	
try
ŞŞ 
{
ßß 
m_fMainSync
àà 
.
àà 
wait
àà  
(
àà  !
)
àà! "
;
àà" #!
m_fSerialToEthernet
ää #
.
ää# $
fEventPusher
ää$ 0
.
ää0 1
pushSerialEvent
ää1 @
(
ää@ A
new
åå ,
FSerialPluginDataSentEventArgs
åå 6
(
åå6 7!
m_fSerialToEthernet
ææ +
,
ææ+ ,
FEventId
çç  
.
çç  !
SerialDataSent
çç! /
,
çç/ 0
FResultCode
èè #
.
èè# $
Error
èè$ )
,
èè) *
string
éé 
.
éé 
Empty
éé $
,
éé$ %
new
êê 
FSerialSendData
êê +
(
êê+ ,
e
êê, -
.
êê- .
data
êê. 2
)
êê2 3
)
ëë 
)
ìì 
;
ìì 
}
íí 
catch
îî 
(
îî 
	Exception
îî 
ex
îî 
)
îî  
{
ïï 
FDebug
ğğ 
.
ğğ 
writeLog
ğğ 
(
ğğ  
ex
ğğ  "
)
ğğ" #
;
ğğ# $
}
ññ 
finally
òò 
{
óó 
m_fMainSync
ôô 
.
ôô 
set
ôô 
(
ôô  
)
ôô  !
;
ôô! "
}
õõ 
}
öö 	
private
úú 
void
úú )
m_fSerial_SerialErrorRaised
úú 0
(
úú0 1
object
ûû 
sender
ûû 
,
ûû )
FSerialErrorRaisedEventArgs
üü '
e
üü( )
)
ıı 
{
şş 	
try
ÿÿ 
{
€€ #
procSerialErrorRaised
 %
(
% &
e
& '
.
' (
	exception
( 1
)
1 2
;
2 3!
procSerialPortClose
‚‚ #
(
‚‚# $
)
‚‚$ %
;
‚‚% &!
m_fSerialToEthernet
†† #
.
††# $
changeSerialState
††$ 5
(
††5 6!
FCommunicationState
††6 I
.
††I J
Opened
††J P
,
††P Q

m_portName
††R \
,
††\ ]

m_baudRate
††^ h
)
††h i
;
††i j
m_fTmrAutoCycle
 
.
  
start
  %
(
% &
AutoCycleRunTime
& 6
)
6 7
;
7 8
}
 
catch
 
(
 
	Exception
 
ex
 
)
  
{
 
FDebug
‘‘ 
.
‘‘ 
writeLog
‘‘ 
(
‘‘  
ex
‘‘  "
)
‘‘" #
;
‘‘# $
}
’’ 
finally
““ 
{
”” 
}
–– 
}
—— 	
}
 
} ÉF
}D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\SerialToEthernet\Protocol\Socket\c_FBaseTcp.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSerialToEthernet -
{ 
internal 
abstract 
class 
FBaseTcp $
:% &
IDisposable' 2
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FSerialToEthernet !
m_fSerialToEthernet" 5
=6 7
null8 <
;< =
private 
string 
	m_localIp  
=! "
string# )
.) *
Empty* /
;/ 0
private 
int 
m_localPort 
=  !
$num" #
;# $
private 
string 

m_remoteIp !
=" #
string$ *
.* +
Empty+ 0
;0 1
private 
int 
m_remotePort  
=! "
$num# $
;$ %
public## 
FBaseTcp## 
(## 
FSerialToEthernet$$ 
fSerialToEthernet$$ /
)%% 
{&& 	
m_fSerialToEthernet'' 
=''  !
fSerialToEthernet''" 3
;''3 4
	m_localIp)) 
=)) 
m_fSerialToEthernet)) +
.))+ ,
fSocketConfig)), 9
.))9 :
localIp)): A
;))A B
m_localPort** 
=** 
m_fSerialToEthernet** -
.**- .
fSocketConfig**. ;
.**; <
	localPort**< E
;**E F

m_remoteIp++ 
=++ 
m_fSerialToEthernet++ ,
.++, -
fSocketConfig++- :
.++: ;
remoteIp++; C
;++C D
m_remotePort,, 
=,, 
m_fSerialToEthernet,, .
.,,. /
fSocketConfig,,/ <
.,,< =

remotePort,,= G
;,,G H
}-- 	
~11 	
FBaseTcp11	 
(11 
)22 
{33 	
	myDispose44 
(44 
false44 
)44 
;44 
}55 	
	protected99 
virtual99 
void99 
	myDispose99 (
(99( )
bool:: 
	disposing:: 
);; 
{<< 	
if== 
(== 
!== 

m_disposed== 
)== 
{>> 
if?? 
(?? 
	disposing?? 
)?? 
{@@ 
m_fSerialToEthernetAA '
=AA( )
nullAA* .
;AA. /
}BB 

m_disposedDD 
=DD 
trueDD !
;DD! "
}EE 
}FF 	
publicNN 
voidNN 
DisposeNN 
(NN 
)OO 
{PP 	
	myDisposeQQ 
(QQ 
trueQQ 
)QQ 
;QQ 
GCRR 
.RR 
SuppressFinalizeRR 
(RR  
thisRR  $
)RR$ %
;RR% &
}SS 	
public[[ 
FSerialToEthernet[[  
fSerialToEthernet[[! 2
{\\ 	
get]] 
{^^ 
try__ 
{`` 
returnaa 
m_fSerialToEthernetaa .
;aa. /
}bb 
catchcc 
(cc 
	Exceptioncc  
excc! #
)cc# $
{dd 
FDebugee 
.ee 
throwExceptionee )
(ee) *
exee* ,
)ee, -
;ee- .
}ff 
finallygg 
{hh 
}jj 
returnkk 
nullkk 
;kk 
}ll 
}mm 	
publicqq 
stringqq 
localIpqq 
{rr 	
getss 
{tt 
tryuu 
{vv 
returnww 
	m_localIpww $
;ww$ %
}xx 
catchyy 
(yy 
	Exceptionyy  
exyy! #
)yy# $
{zz 
FDebug{{ 
.{{ 
throwException{{ )
({{) *
ex{{* ,
){{, -
;{{- .
}|| 
finally}} 
{~~ 
}
€€ 
return
 
string
 
.
 
Empty
 #
;
# $
}
‚‚ 
set
„„ 
{
…… 
try
†† 
{
‡‡ 
	m_localIp
ˆˆ 
=
ˆˆ 
value
ˆˆ  %
;
ˆˆ% &
}
‰‰ 
catch
ŠŠ 
(
ŠŠ 
	Exception
ŠŠ  
ex
ŠŠ! #
)
ŠŠ# $
{
‹‹ 
FDebug
ŒŒ 
.
ŒŒ 
throwException
ŒŒ )
(
ŒŒ) *
ex
ŒŒ* ,
)
ŒŒ, -
;
ŒŒ- .
}
 
finally
 
{
 
}
‘‘ 
}
’’ 
}
““ 	
public
—— 
int
—— 
	localPort
—— 
{
˜˜ 	
get
™™ 
{
šš 
try
›› 
{
œœ 
return
 
m_localPort
 &
;
& '
}
 
catch
ŸŸ 
(
ŸŸ 
	Exception
ŸŸ  
ex
ŸŸ! #
)
ŸŸ# $
{
   
FDebug
¡¡ 
.
¡¡ 
throwException
¡¡ )
(
¡¡) *
ex
¡¡* ,
)
¡¡, -
;
¡¡- .
}
¢¢ 
finally
££ 
{
¤¤ 
}
¦¦ 
return
§§ 
$num
§§ 
;
§§ 
}
¨¨ 
set
ªª 
{
«« 
try
¬¬ 
{
­­ 
m_localPort
®® 
=
®®  !
value
®®" '
;
®®' (
}
¯¯ 
catch
°° 
(
°° 
	Exception
°°  
ex
°°! #
)
°°# $
{
±± 
FDebug
²² 
.
²² 
throwException
²² )
(
²²) *
ex
²²* ,
)
²², -
;
²²- .
}
³³ 
finally
´´ 
{
µµ 
}
·· 
}
¸¸ 
}
¹¹ 	
public
½½ 
string
½½ 
remoteIp
½½ 
{
¾¾ 	
get
¿¿ 
{
ÀÀ 
try
ÁÁ 
{
ÂÂ 
return
ÃÃ 

m_remoteIp
ÃÃ %
;
ÃÃ% &
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
	Exception
ÅÅ  
ex
ÅÅ! #
)
ÅÅ# $
{
ÆÆ 
FDebug
ÇÇ 
.
ÇÇ 
throwException
ÇÇ )
(
ÇÇ) *
ex
ÇÇ* ,
)
ÇÇ, -
;
ÇÇ- .
}
ÈÈ 
finally
ÉÉ 
{
ÊÊ 
}
ÌÌ 
return
ÍÍ 
string
ÍÍ 
.
ÍÍ 
Empty
ÍÍ #
;
ÍÍ# $
}
ÎÎ 
set
ĞĞ 
{
ÑÑ 
try
ÒÒ 
{
ÓÓ 

m_remoteIp
ÔÔ 
=
ÔÔ  
value
ÔÔ! &
;
ÔÔ& '
}
ÕÕ 
catch
ÖÖ 
(
ÖÖ 
	Exception
ÖÖ  
ex
ÖÖ! #
)
ÖÖ# $
{
×× 
FDebug
ØØ 
.
ØØ 
throwException
ØØ )
(
ØØ) *
ex
ØØ* ,
)
ØØ, -
;
ØØ- .
}
ÙÙ 
finally
ÚÚ 
{
ÛÛ 
}
İİ 
}
ŞŞ 
}
ßß 	
public
ãã 
int
ãã 

remotePort
ãã 
{
ää 	
get
åå 
{
ææ 
try
çç 
{
èè 
return
éé 
m_remotePort
éé '
;
éé' (
}
êê 
catch
ëë 
(
ëë 
	Exception
ëë  
ex
ëë! #
)
ëë# $
{
ìì 
FDebug
íí 
.
íí 
throwException
íí )
(
íí) *
ex
íí* ,
)
íí, -
;
íí- .
}
îî 
finally
ïï 
{
ğğ 
}
òò 
return
óó 
$num
óó 
;
óó 
}
ôô 
set
öö 
{
÷÷ 
try
øø 
{
ùù 
m_remotePort
úú  
=
úú! "
value
úú# (
;
úú( )
}
ûû 
catch
üü 
(
üü 
	Exception
üü  
ex
üü! #
)
üü# $
{
ıı 
FDebug
şş 
.
şş 
throwException
şş )
(
şş) *
ex
şş* ,
)
şş, -
;
şş- .
}
ÿÿ 
finally
€€ 
{
 
}
ƒƒ 
}
„„ 
}
…… 	
public
 
abstract
 
void
 
open
 !
(
! "
)
 
;
 
public
’’ 
abstract
’’ 
void
’’ 
close
’’ "
(
’’" #
)
““ 
;
““ 
public
—— 
abstract
—— 
void
—— 
send
—— !
(
——! "
FSocketSendData
˜˜ 
fSocketSendData
˜˜ +
)
™™ 
;
™™ 
}
ŸŸ 
}   Ÿ[
‚D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\SerialToEthernet\Protocol\c_FCustom001RecvBuffer.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSerialToEthernet -
{ 
internal 
class 
FTcpRecvBuffer !
:" #
IDisposable$ /
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
List 
< 
byte 
> 
m_data !
=" #
null$ (
;( )
private 
bool 
m_isCompleted "
=# $
true% )
;) *
private 
UInt32 
m_length 
=  !
$num" #
;# $
private 
byte 
[ 
] 
m_bin 
= 
null #
;# $
private 
FXmlNode 
	m_fXmlMsg "
=# $
null% )
;) *
private   
bool   
m_isParseSuccess   %
=  & '
false  ( -
;  - .
public&& 
FTcpRecvBuffer&& 
(&& 
)'' 
{(( 	
m_data)) 
=)) 
new)) 
List)) 
<)) 
byte)) "
>))" #
())# $
)))$ %
;))% &
}** 	
~.. 	
FTcpRecvBuffer..	 
(.. 
)// 
{00 	
	myDispose11 
(11 
false11 
)11 
;11 
}22 	
	protected66 
void66 
	myDispose66  
(66  !
bool77 
	disposing77 
)88 
{99 	
if:: 
(:: 
!:: 

m_disposed:: 
):: 
{;; 
if<< 
(<< 
	disposing<< 
)<< 
{== 
m_data>> 
=>> 
null>> !
;>>! "
m_bin?? 
=?? 
null??  
;??  !
}@@ 

m_disposedAA 
=AA 
trueAA !
;AA! "
}BB 
}CC 	
publicKK 
voidKK 
DisposeKK 
(KK 
)LL 
{MM 	
	myDisposeNN 
(NN 
trueNN 
)NN 
;NN 
GCOO 
.OO 
SuppressFinalizeOO 
(OO  
thisOO  $
)OO$ %
;OO% &
}PP 	
publicXX 
boolXX 
isCompletedXX 
{YY 	
getZZ 
{[[ 
try\\ 
{]] 
return^^ 
m_isCompleted^^ (
;^^( )
}__ 
catch`` 
(`` 
	Exception``  
ex``! #
)``# $
{aa 
FDebugbb 
.bb 
throwExceptionbb )
(bb) *
exbb* ,
)bb, -
;bb- .
}cc 
finallydd 
{ee 
}gg 
returnhh 
falsehh 
;hh 
}ii 
}jj 	
publicnn 
UInt32nn 
lengthnn 
{oo 	
getpp 
{qq 
tryrr 
{ss 
returntt 
m_lengthtt #
;tt# $
}uu 
catchvv 
(vv 
	Exceptionvv  
exvv! #
)vv# $
{ww 
FDebugxx 
.xx 
throwExceptionxx )
(xx) *
exxx* ,
)xx, -
;xx- .
}yy 
finallyzz 
{{{ 
}}} 
return~~ 
$num~~ 
;~~ 
} 
}
€€ 	
public
„„ 
byte
„„ 
[
„„ 
]
„„ 
bin
„„ 
{
…… 	
get
†† 
{
‡‡ 
try
ˆˆ 
{
‰‰ 
return
ŠŠ 
m_bin
ŠŠ  
;
ŠŠ  !
}
‹‹ 
catch
ŒŒ 
(
ŒŒ 
	Exception
ŒŒ  
ex
ŒŒ! #
)
ŒŒ# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
 
{
‘‘ 
}
““ 
return
”” 
null
”” 
;
”” 
}
•• 
}
–– 	
public
šš 
bool
šš 
isParseSuccess
šš "
{
›› 	
get
œœ 
{
 
try
 
{
ŸŸ 
return
   
m_isParseSuccess
   +
;
  + ,
}
¡¡ 
catch
¢¢ 
(
¢¢ 
	Exception
¢¢  
ex
¢¢! #
)
¢¢# $
{
££ 
FDebug
¤¤ 
.
¤¤ 
throwException
¤¤ )
(
¤¤) *
ex
¤¤* ,
)
¤¤, -
;
¤¤- .
}
¥¥ 
finally
¦¦ 
{
§§ 
}
©© 
return
ªª 
false
ªª 
;
ªª 
}
«« 
}
¬¬ 	
public
°° 
FXmlNode
°° 
fXmlMsg
°° 
{
±± 	
get
²² 
{
³³ 
try
´´ 
{
µµ 
return
¶¶ 
	m_fXmlMsg
¶¶ $
;
¶¶$ %
}
·· 
catch
¸¸ 
(
¸¸ 
	Exception
¸¸  
ex
¸¸! #
)
¸¸# $
{
¹¹ 
FDebug
ºº 
.
ºº 
throwException
ºº )
(
ºº) *
ex
ºº* ,
)
ºº, -
;
ºº- .
}
»» 
finally
¼¼ 
{
½½ 
}
¿¿ 
return
ÀÀ 
null
ÀÀ 
;
ÀÀ 
}
ÁÁ 
}
ÂÂ 	
public
ÊÊ 
void
ÊÊ 
init
ÊÊ 
(
ÊÊ 
)
ËË 
{
ÌÌ 	
try
ÍÍ 
{
ÎÎ 
m_length
ÏÏ 
=
ÏÏ 
$num
ÏÏ 
;
ÏÏ 
m_bin
ĞĞ 
=
ĞĞ 
null
ĞĞ 
;
ĞĞ 
	m_fXmlMsg
ÑÑ 
=
ÑÑ 
null
ÑÑ  
;
ÑÑ  !
m_isParseSuccess
ÒÒ  
=
ÒÒ! "
false
ÒÒ# (
;
ÒÒ( )
}
ÓÓ 
catch
ÔÔ 
(
ÔÔ 
	Exception
ÔÔ 
ex
ÔÔ 
)
ÔÔ  
{
ÕÕ 
FDebug
ÖÖ 
.
ÖÖ 
throwException
ÖÖ %
(
ÖÖ% &
ex
ÖÖ& (
)
ÖÖ( )
;
ÖÖ) *
}
×× 
finally
ØØ 
{
ÙÙ 
}
ÛÛ 
}
ÜÜ 	
public
àà 
void
àà 
clear
àà 
(
àà 
)
áá 
{
ââ 	
try
ãã 
{
ää 
init
åå 
(
åå 
)
åå 
;
åå 
m_data
ææ 
.
ææ 
Clear
ææ 
(
ææ 
)
ææ 
;
ææ 
}
çç 
catch
èè 
(
èè 
	Exception
èè 
ex
èè 
)
èè  
{
éé 
FDebug
êê 
.
êê 
throwException
êê %
(
êê% &
ex
êê& (
)
êê( )
;
êê) *
}
ëë 
finally
ìì 
{
íí 
}
ïï 
}
ğğ 	
public
ôô 
void
ôô 
input
ôô 
(
ôô 
byte
õõ 
[
õõ 
]
õõ 
data
õõ 
)
öö 
{
÷÷ 	
try
øø 
{
ùù 
m_data
úú 
.
úú 
AddRange
úú 
(
úú  
data
úú  $
)
úú$ %
;
úú% &
}
ûû 
catch
üü 
(
üü 
	Exception
üü 
ex
üü 
)
üü  
{
ıı 
FDebug
şş 
.
şş 
throwException
şş %
(
şş% &
ex
şş& (
)
şş( )
;
şş) *
}
ÿÿ 
finally
€€ 
{
 
}
ƒƒ 
}
„„ 	
public
ˆˆ 
bool
ˆˆ 
parse
ˆˆ 
(
ˆˆ 
)
‰‰ 
{
ŠŠ 	
int
‹‹ 
etxPtr
‹‹ 
=
‹‹ 
$num
‹‹ 
;
‹‹ 
int
ŒŒ 
index
ŒŒ 
=
ŒŒ 
$num
ŒŒ 
;
ŒŒ 
try
 
{
 
if
 
(
 
m_data
 
.
 
Count
  
==
! #
$num
$ %
)
% &
{
‘‘ 
m_isCompleted
’’ !
=
’’" #
true
’’$ (
;
’’( )
return
““ 
false
““  
;
““  !
}
”” 
etxPtr
˜˜ 
=
˜˜ 
-
˜˜ 
$num
˜˜ 
;
˜˜ 
while
™™ 
(
™™ 
index
™™ 
<
™™ 
m_data
™™ %
.
™™% &
Count
™™& +
)
™™+ ,
{
šš 
etxPtr
›› 
=
›› 
m_data
›› #
.
››# $
IndexOf
››$ +
(
››+ ,
(
››, -
byte
››- 1
)
››1 2
$num
››2 6
,
››6 7
index
››8 =
)
››= >
;
››> ?
if
œœ 
(
œœ 
etxPtr
œœ 
==
œœ !
-
œœ" #
$num
œœ# $
)
œœ$ %
{
 
break
 
;
 
}
ŸŸ 
if
¡¡ 
(
¡¡ 
etxPtr
¡¡ 
+
¡¡  
$num
¡¡! "
<
¡¡# $
m_data
¡¡% +
.
¡¡+ ,
Count
¡¡, 1
&&
¡¡2 4
(
¡¡5 6
byte
¡¡6 :
)
¡¡: ;
m_data
¡¡; A
[
¡¡A B
etxPtr
¡¡B H
+
¡¡I J
$num
¡¡K L
]
¡¡L M
==
¡¡N P
$num
¡¡Q U
)
¡¡U V
{
¢¢ 
break
££ 
;
££ 
}
¤¤ 
index
¥¥ 
=
¥¥ 
etxPtr
¥¥ "
+
¥¥# $
$num
¥¥% &
;
¥¥& '
}
¦¦ 
if
¨¨ 
(
¨¨ 
etxPtr
¨¨ 
==
¨¨ 
-
¨¨ 
$num
¨¨  
)
¨¨  !
{
©© 
m_isCompleted
ªª !
=
ªª" #
false
ªª$ )
;
ªª) *
return
«« 
false
««  
;
««  !
}
¬¬ 
m_length
´´ 
=
´´ 
(
´´ 
UInt32
´´ "
)
´´" #
etxPtr
´´# )
+
´´* +
$num
´´, -
;
´´- .
m_bin
µµ 
=
µµ 
m_data
µµ 
.
µµ 
GetRange
µµ '
(
µµ' (
$num
µµ( )
,
µµ) *
etxPtr
µµ+ 1
)
µµ1 2
.
µµ2 3
ToArray
µµ3 :
(
µµ: ;
)
µµ; <
;
µµ< =
m_data
¼¼ 
.
¼¼ 
RemoveRange
¼¼ "
(
¼¼" #
$num
¼¼# $
,
¼¼$ %
etxPtr
¼¼& ,
+
¼¼- .
$num
¼¼/ 0
)
¼¼0 1
;
¼¼1 2
m_isCompleted
½½ 
=
½½ 
true
½½  $
;
½½$ %
return
¾¾ 
true
¾¾ 
;
¾¾ 
}
¿¿ 
catch
ÀÀ 
(
ÀÀ 
	Exception
ÀÀ 
ex
ÀÀ 
)
ÀÀ  
{
ÁÁ 
FDebug
ÂÂ 
.
ÂÂ 
throwException
ÂÂ %
(
ÂÂ% &
ex
ÂÂ& (
)
ÂÂ( )
;
ÂÂ) *
}
ÃÃ 
finally
ÄÄ 
{
ÅÅ 
}
ÇÇ 
return
ÈÈ 
false
ÈÈ 
;
ÈÈ 
}
ÉÉ 	
}
ÏÏ 
}ĞĞ ÙÈ
D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\SerialToEthernet\Protocol\Socket\c_FTcpActive.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSerialToEthernet -
{ 
internal 
class 

FTcpActive 
: 
FBaseTcp '
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 

FTcpClient 
m_fTcpClient '
=( )
null* .
;. /
private 
	FCodeLock 
m_fMainSync %
=& '
null( ,
;, -
private 
FThread 

m_fThdMain "
=# $
null% )
;) *
public!! 

FTcpActive!! 
(!! 
FSerialToEthernet"" 
fSerialToTcp"" *
)## 
:$$ 
base$$ 
($$ 
fSerialToTcp$$ 
)$$  
{%% 	
init&& 
(&& 
)&& 
;&& 
}'' 	
~++ 	

FTcpActive++	 
(++ 
),, 
{-- 	
	myDispose.. 
(.. 
false.. 
).. 
;.. 
}// 	
	protected33 
override33 
void33 
	myDispose33  )
(33) *
bool44 
	disposing44 
)55 
{66 	
if77 
(77 
!77 

m_disposed77 
)77 
{88 
if99 
(99 
	disposing99 
)99 
{:: 
term;; 
(;; 
);; 
;;; 
}<< 
base@@ 
.@@ 
	myDispose@@ 
(@@ 
	disposing@@ (
)@@( )
;@@) *
}AA 
}BB 	
publicJJ 
voidJJ 
DisposeJJ 
(JJ 
)KK 
{LL 	
	myDisposeMM 
(MM 
trueMM 
)MM 
;MM 
GCNN 
.NN 
SuppressFinalizeNN 
(NN  
thisNN  $
)NN$ %
;NN% &
}OO 	
private]] 
void]] 
init]] 
(]] 
)^^ 
{__ 	
try`` 
{aa 
m_fMainSyncbb 
=bb 
newbb !
	FCodeLockbb" +
(bb+ ,
)bb, -
;bb- .

m_fThdMaincc 
=cc 
newcc  
FThreadcc! (
(cc( )
$strcc) ?
)cc? @
;cc@ A

m_fThdMaindd 
.dd 
ThreadJobCalleddd *
+=dd+ -
newdd. 1(
FThreadJobCalledEventHandlerdd2 N
(ddN O&
m_fThdMain_ThreadJobCalledddO i
)ddi j
;ddj k

m_fThdMainee 
.ee 
startee  
(ee  !
)ee! "
;ee" #
}ff 
catchgg 
(gg 
	Exceptiongg 
exgg 
)gg  
{hh 
FDebugii 
.ii 
throwExceptionii %
(ii% &
exii& (
)ii( )
;ii) *
}jj 
finallykk 
{ll 
}nn 
}oo 	
privatess 
voidss 
termss 
(ss 
)tt 
{uu 	
tryvv 
{ww 
ifxx 
(xx 

m_fThdMainxx 
!=xx !
nullxx" &
)xx& '
{yy 

m_fThdMainzz 
.zz 
stopzz #
(zz# $
)zz$ %
;zz% &

m_fThdMain{{ 
.{{ 
Dispose{{ &
({{& '
){{' (
;{{( )

m_fThdMain|| 
.|| 
ThreadJobCalled|| .
-=||/ 1
new||2 5(
FThreadJobCalledEventHandler||6 R
(||R S&
m_fThdMain_ThreadJobCalled||S m
)||m n
;||n o

m_fThdMain}} 
=}}  
null}}! %
;}}% &
}~~ 
if
‚‚ 
(
‚‚ 
m_fTcpClient
‚‚  
!=
‚‚! #
null
‚‚$ (
)
‚‚( )
{
ƒƒ 
m_fTcpClient
„„  
.
„„  !
close
„„! &
(
„„& '
)
„„' (
;
„„( )
m_fTcpClient
……  
.
……  !
Dispose
……! (
(
……( )
)
……) *
;
……* +
m_fTcpClient
‡‡  
.
‡‡  !#
TcpClientStateChanged
‡‡! 6
-=
‡‡7 9
new
‡‡: =0
"FTcpClientStateChangedEventHandler
‡‡> `
(
‡‡` a1
"m_fTcpClient_TcpClientStateChanged‡‡a ƒ
)‡‡ƒ „
;‡‡„ …
m_fTcpClient
ˆˆ  
.
ˆˆ  !
TcpClientDataSent
ˆˆ! 2
-=
ˆˆ3 5
new
ˆˆ6 9,
FTcpClientDataSentEventHandler
ˆˆ: X
(
ˆˆX Y,
m_fTcpClient_TcpClientDataSent
ˆˆY w
)
ˆˆw x
;
ˆˆx y
m_fTcpClient
‰‰  
.
‰‰  !%
TcpClientDataSendFailed
‰‰! 8
-=
‰‰9 ;
new
‰‰< ?2
$FTcpClientDataSendFailedEventHandler
‰‰@ d
(
‰‰d e3
$m_fTcpClient_TcpClientDataSendFailed‰‰e ‰
)‰‰‰ Š
;‰‰Š ‹
m_fTcpClient
ŠŠ  
.
ŠŠ  !"
TcpClientErrorRaised
ŠŠ! 5
-=
ŠŠ6 8
new
ŠŠ9 </
!FTcpClientErrorRaisedEventHandler
ŠŠ= ^
(
ŠŠ^ _0
!m_fTcpClient_TcpClientErrorRaisedŠŠ_ €
)ŠŠ€ 
;ŠŠ ‚
m_fTcpClient
ŒŒ  
=
ŒŒ! "
null
ŒŒ# '
;
ŒŒ' (
}
 
if
‘‘ 
(
‘‘ 
m_fMainSync
‘‘ 
!=
‘‘  "
null
‘‘# '
)
‘‘' (
{
’’ 
m_fMainSync
““ 
.
““  
Dispose
““  '
(
““' (
)
““( )
;
““) *
m_fMainSync
”” 
=
””  !
null
””" &
;
””& '
}
•• 
}
–– 
catch
—— 
(
—— 
	Exception
—— 
ex
—— 
)
——  
{
˜˜ 
FDebug
™™ 
.
™™ 
throwException
™™ %
(
™™% &
ex
™™& (
)
™™( )
;
™™) *
}
šš 
finally
›› 
{
œœ 
}
 
}
ŸŸ 	
public
££ 
override
££ 
void
££ 
open
££ !
(
££! "
)
¤¤ 
{
¥¥ 	
try
¦¦ 
{
§§ 
m_fTcpClient
¨¨ 
=
¨¨ 
new
¨¨ "

FTcpClient
¨¨# -
(
¨¨- .
this
©© 
.
©© 
fSerialToEthernet
©© )
.
©©) *
fSocketConfig
©©* 7
.
©©7 8
localIp
©©8 ?
,
©©? @
this
ªª 
.
ªª 
fSerialToEthernet
ªª )
.
ªª) *
fSocketConfig
ªª* 7
.
ªª7 8
remoteIp
ªª8 @
,
ªª@ A
this
«« 
.
«« 
fSerialToEthernet
«« )
.
««) *
fSocketConfig
««* 7
.
««7 8

remotePort
««8 B
)
¬¬ 
;
¬¬ 
m_fTcpClient
­­ 
.
­­  
retryConnectPeriod
­­ /
=
­­0 1
this
­­2 6
.
­­6 7
fSerialToEthernet
­­7 H
.
­­H I
fSocketConfig
­­I V
.
­­V W 
retryConnectPeriod
­­W i
*
­­j k
$num
­­l p
;
­­p q
m_fTcpClient
¯¯ 
.
¯¯ #
TcpClientStateChanged
¯¯ 2
+=
¯¯3 5
new
¯¯6 90
"FTcpClientStateChangedEventHandler
¯¯: \
(
¯¯\ ]0
"m_fTcpClient_TcpClientStateChanged
¯¯] 
)¯¯ €
;¯¯€ 
m_fTcpClient
°° 
.
°° 
TcpClientDataSent
°° .
+=
°°/ 1
new
°°2 5,
FTcpClientDataSentEventHandler
°°6 T
(
°°T U,
m_fTcpClient_TcpClientDataSent
°°U s
)
°°s t
;
°°t u
m_fTcpClient
±± 
.
±± %
TcpClientDataSendFailed
±± 4
+=
±±5 7
new
±±8 ;2
$FTcpClientDataSendFailedEventHandler
±±< `
(
±±` a3
$m_fTcpClient_TcpClientDataSendFailed±±a …
)±±… †
;±±† ‡
m_fTcpClient
²² 
.
²² "
TcpClientErrorRaised
²² 1
+=
²²2 4
new
²²5 8/
!FTcpClientErrorRaisedEventHandler
²²9 Z
(
²²Z [/
!m_fTcpClient_TcpClientErrorRaised
²²[ |
)
²²| }
;
²²} ~
m_fTcpClient
´´ 
.
´´ 
connect
´´ $
(
´´$ %
)
´´% &
;
´´& '
}
µµ 
catch
¶¶ 
(
¶¶ 
	Exception
¶¶ 
ex
¶¶ 
)
¶¶  
{
·· 
FDebug
¸¸ 
.
¸¸ 
throwException
¸¸ %
(
¸¸% &
ex
¸¸& (
)
¸¸( )
;
¸¸) *
}
¹¹ 
finally
ºº 
{
»» 
}
½½ 
}
¾¾ 	
public
ÂÂ 
override
ÂÂ 
void
ÂÂ 
close
ÂÂ "
(
ÂÂ" #
)
ÃÃ 
{
ÄÄ 	
try
ÅÅ 
{
ÆÆ 
if
ÇÇ 
(
ÇÇ 
m_fTcpClient
ÇÇ  
==
ÇÇ! #
null
ÇÇ$ (
)
ÇÇ( )
{
ÈÈ 
return
ÉÉ 
;
ÉÉ 
}
ÊÊ 
if
ÎÎ 
(
ÎÎ 
m_fTcpClient
ÏÏ  
.
ÏÏ  !
fState
ÏÏ! '
==
ÏÏ( *
FTcpClientState
ÏÏ+ :
.
ÏÏ: ;
	Connected
ÏÏ; D
&&
ÏÏE G
this
ĞĞ 
.
ĞĞ 
fSerialToEthernet
ĞĞ *
.
ĞĞ* +
fSocketState
ĞĞ+ 7
==
ĞĞ8 :!
FCommunicationState
ĞĞ; N
.
ĞĞN O
	Connected
ĞĞO X
)
ÑÑ 
{
ÒÒ 
while
ÓÓ 
(
ÓÓ 
this
ÓÓ 
.
ÓÓ  
fSerialToEthernet
ÓÓ  1
.
ÓÓ1 2
fEventPusher
ÓÓ2 >
.
ÓÓ> ?
tcpEventCount
ÓÓ? L
>
ÓÓM N
$num
ÓÓO P
||
ÓÓQ S
!
ÓÓT U
m_fTcpClient
ÓÓU a
.
ÓÓa b
sendCompleted
ÓÓb o
)
ÓÓo p
{
ÔÔ 
if
ÕÕ 
(
ÕÕ 
System
ÕÕ "
.
ÕÕ" #
Windows
ÕÕ# *
.
ÕÕ* +
Forms
ÕÕ+ 0
.
ÕÕ0 1
Application
ÕÕ1 <
.
ÕÕ< =
MessageLoop
ÕÕ= H
)
ÕÕH I
{
ÖÖ 
System
×× "
.
××" #
Windows
××# *
.
××* +
Forms
××+ 0
.
××0 1
Application
××1 <
.
××< =
DoEvents
××= E
(
××E F
)
××F G
;
××G H
}
ØØ 
System
ÙÙ 
.
ÙÙ 
	Threading
ÙÙ (
.
ÙÙ( )
Thread
ÙÙ) /
.
ÙÙ/ 0
Sleep
ÙÙ0 5
(
ÙÙ5 6
$num
ÙÙ6 7
)
ÙÙ7 8
;
ÙÙ8 9
}
ÚÚ 
}
ÛÛ 
m_fTcpClient
ßß 
.
ßß 
close
ßß "
(
ßß" #
)
ßß# $
;
ßß$ %
m_fTcpClient
àà 
.
àà 
Dispose
àà $
(
àà$ %
)
àà% &
;
àà& '
m_fTcpClient
ââ 
.
ââ #
TcpClientStateChanged
ââ 2
-=
ââ3 5
new
ââ6 90
"FTcpClientStateChangedEventHandler
ââ: \
(
ââ\ ]0
"m_fTcpClient_TcpClientStateChanged
ââ] 
)ââ €
;ââ€ 
m_fTcpClient
ãã 
.
ãã 
TcpClientDataSent
ãã .
-=
ãã/ 1
new
ãã2 5,
FTcpClientDataSentEventHandler
ãã6 T
(
ããT U,
m_fTcpClient_TcpClientDataSent
ããU s
)
ããs t
;
ããt u
m_fTcpClient
ää 
.
ää %
TcpClientDataSendFailed
ää 4
-=
ää5 7
new
ää8 ;2
$FTcpClientDataSendFailedEventHandler
ää< `
(
ää` a3
$m_fTcpClient_TcpClientDataSendFailedääa …
)ää… †
;ää† ‡
m_fTcpClient
åå 
.
åå "
TcpClientErrorRaised
åå 1
-=
åå2 4
new
åå5 8/
!FTcpClientErrorRaisedEventHandler
åå9 Z
(
ååZ [/
!m_fTcpClient_TcpClientErrorRaised
åå[ |
)
åå| }
;
åå} ~
m_fTcpClient
çç 
=
çç 
null
çç #
;
çç# $
}
èè 
catch
éé 
(
éé 
	Exception
éé 
ex
éé 
)
éé  
{
êê 
FDebug
ëë 
.
ëë 
throwException
ëë %
(
ëë% &
ex
ëë& (
)
ëë( )
;
ëë) *
}
ìì 
finally
íí 
{
îî 
}
ğğ 
}
ññ 	
public
õõ 
override
õõ 
void
õõ 
send
õõ !
(
õõ! "
FSocketSendData
öö 
fSocketSendData
öö +
)
÷÷ 
{
øø 	
try
ùù 
{
úú 
sendData
ûû 
(
ûû 
fSocketSendData
ûû (
)
ûû( )
;
ûû) *
}
üü 
catch
ıı 
(
ıı 
	Exception
ıı 
ex
ıı 
)
ıı  
{
şş 
FDebug
ÿÿ 
.
ÿÿ 
throwException
ÿÿ %
(
ÿÿ% &
ex
ÿÿ& (
)
ÿÿ( )
;
ÿÿ) *
}
€€ 
finally
 
{
‚‚ 
}
„„ 
}
…… 	
private
‰‰ 
void
‰‰ 
sendData
‰‰ 
(
‰‰ 
FSocketSendData
ŠŠ 
fSocketSendData
ŠŠ +
)
‹‹ 
{
ŒŒ 	
try
 
{
 
m_fTcpClient
 
.
 
send
 !
(
! "
fSocketSendData
" 1
)
1 2
;
2 3
}
 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘ 
ex
‘‘ 
)
‘‘  
{
’’  
procTcpErrorRaised
““ "
(
““" #
ex
““# %
)
““% &
;
““& '
}
”” 
finally
•• 
{
–– 
}
˜˜ 
}
™™ 	
private
 
void
  
procTcpErrorRaised
 '
(
' (
	Exception
 
inEx
 
)
ŸŸ 
{
   	
try
¡¡ 
{
¢¢ 
FDebug
££ 
.
££ 
writeLog
££ 
(
££  
inEx
££  $
)
££$ %
;
££% &
this
¥¥ 
.
¥¥ 
fSerialToEthernet
¥¥ &
.
¥¥& '
fEventPusher
¥¥' 3
.
¥¥3 4
pushTcpEvent
¥¥4 @
(
¥¥@ A
new
¦¦ )
FSocketErrorRaisedEventArgs
¦¦ 3
(
¦¦3 4
this
¦¦4 8
.
¦¦8 9
fSerialToEthernet
¦¦9 J
,
¦¦J K
FEventId
¦¦L T
.
¦¦T U
SocketErrorRaised
¦¦U f
,
¦¦f g
inEx
¦¦h l
.
¦¦l m
Message
¦¦m t
)
¦¦t u
)
§§ 
;
§§ 
}
¨¨ 
catch
©© 
(
©© 
	Exception
©© 
ex
©© 
)
©©  
{
ªª 
FDebug
«« 
.
«« 
writeLog
«« 
(
««  
ex
««  "
)
««" #
;
««# $
}
¬¬ 
finally
­­ 
{
®® 
}
°° 
}
±± 	
private
¹¹ 
void
¹¹ (
m_fThdMain_ThreadJobCalled
¹¹ /
(
¹¹/ 0
object
ºº 
sender
ºº 
,
ºº 
FThreadEventArgs
»» 
e
»» 
)
¼¼ 
{
½½ 	
bool
¾¾ 
waited
¾¾ 
=
¾¾ 
false
¾¾ 
;
¾¾  
try
ÀÀ 
{
ÁÁ 
waited
ÂÂ 
=
ÂÂ 
m_fMainSync
ÂÂ $
.
ÂÂ$ %
tryWait
ÂÂ% ,
(
ÂÂ, -
$num
ÂÂ- .
)
ÂÂ. /
;
ÂÂ/ 0
if
ÃÃ 
(
ÃÃ 
!
ÃÃ 
waited
ÃÃ 
)
ÃÃ 
{
ÄÄ 
return
ÅÅ 
;
ÅÅ 
}
ÆÆ 
if
ÊÊ 
(
ÊÊ 
m_fTcpClient
ËË  
==
ËË! #
null
ËË$ (
||
ËË) +
m_fTcpClient
ÌÌ  
.
ÌÌ  !
fState
ÌÌ! '
!=
ÌÌ( *
FTcpClientState
ÌÌ+ :
.
ÌÌ: ;
	Connected
ÌÌ; D
||
ÌÌE G
this
ÍÍ 
.
ÍÍ 
fSerialToEthernet
ÍÍ *
.
ÍÍ* +
fSocketState
ÍÍ+ 7
!=
ÍÍ8 :!
FCommunicationState
ÍÍ; N
.
ÍÍN O
	Connected
ÍÍO X
)
ÎÎ 
{
ÏÏ 
e
ĞĞ 
.
ĞĞ 
sleepThread
ĞĞ !
(
ĞĞ! "
$num
ĞĞ" #
)
ĞĞ# $
;
ĞĞ$ %
return
ÑÑ 
;
ÑÑ 
}
ÒÒ 
e
ÖÖ 
.
ÖÖ 
sleepThread
ÖÖ 
(
ÖÖ 
$num
ÖÖ 
)
ÖÖ  
;
ÖÖ  !
}
×× 
catch
ØØ 
(
ØØ 
	Exception
ØØ 
ex
ØØ 
)
ØØ  
{
ÙÙ  
procTcpErrorRaised
ÚÚ "
(
ÚÚ" #
ex
ÚÚ# %
)
ÚÚ% &
;
ÚÚ& '
}
ÛÛ 
finally
ÜÜ 
{
İİ 
if
ŞŞ 
(
ŞŞ 
waited
ŞŞ 
)
ŞŞ 
{
ßß 
m_fMainSync
àà 
.
àà  
set
àà  #
(
àà# $
)
àà$ %
;
àà% &
}
áá 
}
ââ 
}
ãã 	
private
ëë 
void
ëë 0
"m_fTcpClient_TcpClientStateChanged
ëë 7
(
ëë7 8
object
ìì 
sender
ìì 
,
ìì -
FTcpClientStateChangedEventArgs
íí +
e
íí, -
)
îî 
{
ïï 	
try
ğğ 
{
ññ 
m_fMainSync
òò 
.
òò 
wait
òò  
(
òò  !
)
òò! "
;
òò" #
this
öö 
.
öö 
localIp
öö 
=
öö 
e
öö  
.
öö  !
localIp
öö! (
;
öö( )
this
÷÷ 
.
÷÷ 
	localPort
÷÷ 
=
÷÷  
e
÷÷! "
.
÷÷" #
	localPort
÷÷# ,
;
÷÷, -
this
øø 
.
øø 
remoteIp
øø 
=
øø 
e
øø  !
.
øø! "
remoteIp
øø" *
;
øø* +
this
ùù 
.
ùù 

remotePort
ùù 
=
ùù  !
e
ùù" #
.
ùù# $

remotePort
ùù$ .
;
ùù. /
if
ıı 
(
ıı 
e
ıı 
.
ıı 
fState
ıı 
==
ıı 
FTcpClientState
ıı  /
.
ıı/ 0
Opened
ıı0 6
)
ıı6 7
{
şş 
this
ÿÿ 
.
ÿÿ 
fSerialToEthernet
ÿÿ *
.
ÿÿ* +
changeTcpState
ÿÿ+ 9
(
ÿÿ9 :!
FCommunicationState
ÿÿ: M
.
ÿÿM N
Opened
ÿÿN T
,
ÿÿT U
FConnectMode
ÿÿV b
.
ÿÿb c
Active
ÿÿc i
,
ÿÿi j
this
ÿÿk o
.
ÿÿo p
localIp
ÿÿp w
,
ÿÿw x
this
ÿÿy }
.
ÿÿ} ~
	localPortÿÿ~ ‡
,ÿÿ‡ ˆ
thisÿÿ‰ 
.ÿÿ 
remoteIpÿÿ –
,ÿÿ– —
thisÿÿ˜ œ
.ÿÿœ 

remotePortÿÿ §
)ÿÿ§ ¨
;ÿÿ¨ ©
}
€€ 
else
 
if
 
(
 
e
 
.
 
fState
 !
==
" $
FTcpClientState
% 4
.
4 5
	Connected
5 >
)
> ?
{
‚‚ 
this
ƒƒ 
.
ƒƒ 
fSerialToEthernet
ƒƒ *
.
ƒƒ* +
changeTcpState
ƒƒ+ 9
(
ƒƒ9 :!
FCommunicationState
ƒƒ: M
.
ƒƒM N
	Connected
ƒƒN W
,
ƒƒW X
FConnectMode
ƒƒY e
.
ƒƒe f
Active
ƒƒf l
,
ƒƒl m
this
ƒƒn r
.
ƒƒr s
localIp
ƒƒs z
,
ƒƒz {
thisƒƒ| €
.ƒƒ€ 
	localPortƒƒ Š
,ƒƒŠ ‹
thisƒƒŒ 
.ƒƒ ‘
remoteIpƒƒ‘ ™
,ƒƒ™ š
thisƒƒ› Ÿ
.ƒƒŸ  

remotePortƒƒ  ª
)ƒƒª «
;ƒƒ« ¬
}
„„ 
else
…… 
if
…… 
(
…… 
e
…… 
.
…… 
fState
…… !
==
……" $
FTcpClientState
……% 4
.
……4 5
Closed
……5 ;
)
……; <
{
†† 
this
‡‡ 
.
‡‡ 
fSerialToEthernet
‡‡ *
.
‡‡* +
changeTcpState
‡‡+ 9
(
‡‡9 :!
FCommunicationState
‡‡: M
.
‡‡M N
Closed
‡‡N T
,
‡‡T U
FConnectMode
‡‡V b
.
‡‡b c
Active
‡‡c i
,
‡‡i j
this
‡‡k o
.
‡‡o p
localIp
‡‡p w
,
‡‡w x
this
‡‡y }
.
‡‡} ~
	localPort‡‡~ ‡
,‡‡‡ ˆ
this‡‡‰ 
.‡‡ 
remoteIp‡‡ –
,‡‡– —
this‡‡˜ œ
.‡‡œ 

remotePort‡‡ §
)‡‡§ ¨
;‡‡¨ ©
}
ˆˆ 
}
‰‰ 
catch
ŠŠ 
(
ŠŠ 
	Exception
ŠŠ 
ex
ŠŠ 
)
ŠŠ  
{
‹‹  
procTcpErrorRaised
ŒŒ "
(
ŒŒ" #
ex
ŒŒ# %
)
ŒŒ% &
;
ŒŒ& '
}
 
finally
 
{
 
m_fMainSync
 
.
 
set
 
(
  
)
  !
;
! "
}
‘‘ 
}
’’ 	
private
–– 
void
–– ,
m_fTcpClient_TcpClientDataSent
–– 3
(
––3 4
object
—— 
sender
—— 
,
—— )
FTcpClientDataSentEventArgs
˜˜ '
e
˜˜( )
)
™™ 
{
šš 	
try
›› 
{
œœ 
m_fMainSync
 
.
 
wait
  
(
  !
)
! "
;
" #
this
¡¡ 
.
¡¡ 
fSerialToEthernet
¡¡ &
.
¡¡& '
fEventPusher
¡¡' 3
.
¡¡3 4
pushTcpEvent
¡¡4 @
(
¡¡@ A
new
¢¢ &
FSocketDataSentEventArgs
¢¢ 0
(
¢¢0 1
this
¢¢1 5
.
¢¢5 6
fSerialToEthernet
¢¢6 G
,
¢¢G H
FEventId
¢¢I Q
.
¢¢Q R
SocketDataSent
¢¢R `
,
¢¢` a
FResultCode
¢¢b m
.
¢¢m n
Success
¢¢n u
,
¢¢u v
string
¢¢w }
.
¢¢} ~
Empty¢¢~ ƒ
,¢¢ƒ „
e¢¢… †
.¢¢† ‡
fData¢¢‡ Œ
)¢¢Œ 
)
££ 
;
££ 
}
¤¤ 
catch
¥¥ 
(
¥¥ 
	Exception
¥¥ 
ex
¥¥ 
)
¥¥  
{
¦¦  
procTcpErrorRaised
§§ "
(
§§" #
ex
§§# %
)
§§% &
;
§§& '
}
¨¨ 
finally
©© 
{
ªª 
m_fMainSync
«« 
.
«« 
set
«« 
(
««  
)
««  !
;
««! "
}
¬¬ 
}
­­ 	
private
±± 
void
±± 2
$m_fTcpClient_TcpClientDataSendFailed
±± 9
(
±±9 :
object
²² 
sender
²² 
,
²² /
!FTcpClientDataSendFailedEventArgs
³³ -
e
³³. /
)
´´ 
{
µµ 	
try
¶¶ 
{
·· 
m_fMainSync
¸¸ 
.
¸¸ 
wait
¸¸  
(
¸¸  !
)
¸¸! "
;
¸¸" #
this
¼¼ 
.
¼¼ 
fSerialToEthernet
¼¼ &
.
¼¼& '
fEventPusher
¼¼' 3
.
¼¼3 4
pushTcpEvent
¼¼4 @
(
¼¼@ A
new
½½ &
FSocketDataSentEventArgs
½½ 0
(
½½0 1
this
½½1 5
.
½½5 6
fSerialToEthernet
½½6 G
,
½½G H
FEventId
½½I Q
.
½½Q R"
SocketDataSendFailed
½½R f
,
½½f g
FResultCode
½½h s
.
½½s t
Error
½½t y
,
½½y z
e
½½{ |
.
½½| }
message½½} „
,½½„ …
e½½† ‡
.½½‡ ˆ
fData½½ˆ 
)½½ 
)
¾¾ 
;
¾¾ 
}
¿¿ 
catch
ÀÀ 
(
ÀÀ 
	Exception
ÀÀ 
ex
ÀÀ 
)
ÀÀ  
{
ÁÁ  
procTcpErrorRaised
ÂÂ "
(
ÂÂ" #
ex
ÂÂ# %
)
ÂÂ% &
;
ÂÂ& '
}
ÃÃ 
finally
ÄÄ 
{
ÅÅ 
m_fMainSync
ÆÆ 
.
ÆÆ 
set
ÆÆ 
(
ÆÆ  
)
ÆÆ  !
;
ÆÆ! "
}
ÇÇ 
}
ÈÈ 	
private
ÌÌ 
void
ÌÌ /
!m_fTcpClient_TcpClientErrorRaised
ÌÌ 6
(
ÌÌ6 7
object
ÍÍ 
sender
ÍÍ 
,
ÍÍ ,
FTcpClientErrorRaisedEventArgs
ÎÎ *
e
ÎÎ+ ,
)
ÏÏ 
{
ĞĞ 	
try
ÑÑ 
{
ÒÒ  
procTcpErrorRaised
ÓÓ "
(
ÓÓ" #
e
ÓÓ# $
.
ÓÓ$ %
	exception
ÓÓ% .
)
ÓÓ. /
;
ÓÓ/ 0
}
ÔÔ 
catch
ÕÕ 
(
ÕÕ 
	Exception
ÕÕ 
ex
ÕÕ 
)
ÕÕ  
{
ÖÖ  
procTcpErrorRaised
×× "
(
××" #
ex
××# %
)
××% &
;
××& '
}
ØØ 
finally
ÙÙ 
{
ÚÚ 
}
ÜÜ 
}
İİ 	
}
ãã 
}ää £—
€D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\SerialToEthernet\Protocol\Socket\c_FTcpPassive.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSerialToEthernet -
{ 
internal 
class 
FTcpPassive 
:  
FBaseTcp! )
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FTcpRecvBuffer 

m_fRecvBuf )
=* +
null, 0
;0 1
private 
FTcpListener 
m_fTcpListener +
=, -
null. 2
;2 3
private 

FTcpClient 
m_fTcpClient '
=( )
null* .
;. /
private 
	FCodeLock 
m_fMainSync %
=& '
null( ,
;, -
public## 
FTcpPassive## 
(## 
FSerialToEthernet$$ 
fSerialToTcp$$ *
)%% 
:&& 
base&& 
(&& 
fSerialToTcp&& 
)&&  
{'' 	
init(( 
((( 
)(( 
;(( 
})) 	
~-- 	
FTcpPassive--	 
(-- 
).. 
{// 	
	myDispose00 
(00 
false00 
)00 
;00 
}11 	
	protected55 
override55 
void55 
	myDispose55  )
(55) *
bool66 
	disposing66 
)77 
{88 	
if99 
(99 
!99 

m_disposed99 
)99 
{:: 
if;; 
(;; 
	disposing;; 
);; 
{<< 
term== 
(== 
)== 
;== 
}>> 

m_disposed?? 
=?? 
true?? !
;??! "
baseCC 
.CC 
	myDisposeCC 
(CC 
	disposingCC (
)CC( )
;CC) *
}DD 
}EE 	
publicMM 
voidMM 
DisposeMM 
(MM 
)NN 
{OO 	
	myDisposePP 
(PP 
truePP 
)PP 
;PP 
GCQQ 
.QQ 
SuppressFinalizeQQ 
(QQ  
thisQQ  $
)QQ$ %
;QQ% &
}RR 	
private`` 
void`` 
init`` 
(`` 
)aa 
{bb 	
trycc 
{dd 

m_fRecvBufee 
=ee 
newee  
FTcpRecvBufferee! /
(ee/ 0
)ee0 1
;ee1 2
m_fMainSyncii 
=ii 
newii !
	FCodeLockii" +
(ii+ ,
)ii, -
;ii- .
}mm 
catchnn 
(nn 
	Exceptionnn 
exnn 
)nn  
{oo 
FDebugpp 
.pp 
throwExceptionpp %
(pp% &
expp& (
)pp( )
;pp) *
}qq 
finallyrr 
{ss 
}uu 
}vv 	
privatezz 
voidzz 
termzz 
(zz 
){{ 
{|| 	
try}} 
{~~ 
if
‡‡ 
(
‡‡ 
m_fTcpListener
‡‡ "
!=
‡‡# %
null
‡‡& *
)
‡‡* +
{
ˆˆ 
m_fTcpListener
‰‰ "
.
‰‰" #
stop
‰‰# '
(
‰‰' (
)
‰‰( )
;
‰‰) *
m_fTcpListener
ŠŠ "
.
ŠŠ" #
Dispose
ŠŠ# *
(
ŠŠ* +
)
ŠŠ+ ,
;
ŠŠ, -
m_fTcpListener
ŒŒ "
.
ŒŒ" #(
TcpListenerAcceptCompleted
ŒŒ# =
-=
ŒŒ> @
new
ŒŒA D5
'FTcpListenerAcceptCompletedEventHandler
ŒŒE l
(
ŒŒl m8
)m_fTcpListener_TcpListenerAcceptCompletedŒŒm –
)ŒŒ– —
;ŒŒ— ˜
m_fTcpListener
 "
.
" #$
TcpListenerErrorRaised
# 9
-=
: <
new
= @1
#FTcpListenerErrorRaisedEventHandler
A d
(
d e4
%m_fTcpListener_TcpListenerErrorRaisede Š
)Š ‹
;‹ Œ
m_fTcpListener
 "
=
# $
null
% )
;
) *
}
 
if
’’ 
(
’’ 
m_fTcpClient
’’  
!=
’’! #
null
’’$ (
)
’’( )
{
““ 
m_fTcpClient
””  
.
””  !
close
””! &
(
””& '
)
””' (
;
””( )
m_fTcpClient
••  
.
••  !
Dispose
••! (
(
••( )
)
••) *
;
••* +
m_fTcpClient
——  
.
——  !#
TcpClientStateChanged
——! 6
-=
——7 9
new
——: =0
"FTcpClientStateChangedEventHandler
——> `
(
——` a1
"m_fTcpClient_TcpClientStateChanged——a ƒ
)——ƒ „
;——„ …
m_fTcpClient
˜˜  
.
˜˜  !#
TcpClientDataReceived
˜˜! 6
-=
˜˜7 9
new
˜˜: =0
"FTcpClientDataReceivedEventHandler
˜˜> `
(
˜˜` a1
"m_fTcpClient_TcpClientDataReceived˜˜a ƒ
)˜˜ƒ „
;˜˜„ …
m_fTcpClient
™™  
.
™™  !
TcpClientDataSent
™™! 2
-=
™™3 5
new
™™6 9,
FTcpClientDataSentEventHandler
™™: X
(
™™X Y,
m_fTcpClient_TcpClientDataSent
™™Y w
)
™™w x
;
™™x y
m_fTcpClient
šš  
.
šš  !%
TcpClientDataSendFailed
šš! 8
-=
šš9 ;
new
šš< ?2
$FTcpClientDataSendFailedEventHandler
šš@ d
(
ššd e3
$m_fTcpClient_TcpClientDataSendFailedšše ‰
)šš‰ Š
;ššŠ ‹
m_fTcpClient
››  
.
››  !"
TcpClientErrorRaised
››! 5
-=
››6 8
new
››9 </
!FTcpClientErrorRaisedEventHandler
››= ^
(
››^ _0
!m_fTcpClient_TcpClientErrorRaised››_ €
)››€ 
;›› ‚
m_fTcpClient
  
=
! "
null
# '
;
' (
}
 
if
¢¢ 
(
¢¢ 

m_fRecvBuf
¢¢ 
!=
¢¢ !
null
¢¢" &
)
¢¢& '
{
££ 

m_fRecvBuf
¤¤ 
.
¤¤ 
Dispose
¤¤ &
(
¤¤& '
)
¤¤' (
;
¤¤( )

m_fRecvBuf
¥¥ 
=
¥¥  
null
¥¥! %
;
¥¥% &
}
¦¦ 
if
¨¨ 
(
¨¨ 
m_fMainSync
¨¨ 
!=
¨¨  "
null
¨¨# '
)
¨¨' (
{
©© 
m_fMainSync
ªª 
.
ªª  
Dispose
ªª  '
(
ªª' (
)
ªª( )
;
ªª) *
m_fMainSync
«« 
=
««  !
null
««" &
;
««& '
}
¬¬ 
}
­­ 
catch
®® 
(
®® 
	Exception
®® 
ex
®® 
)
®®  
{
¯¯ 
FDebug
°° 
.
°° 
throwException
°° %
(
°°% &
ex
°°& (
)
°°( )
;
°°) *
}
±± 
finally
²² 
{
³³ 
}
µµ 
}
¶¶ 	
private
ºº 
void
ºº 
sendData
ºº 
(
ºº 
FSocketSendData
»» 
fSocketSendData
»» +
)
¼¼ 
{
½½ 	
try
¾¾ 
{
¿¿ 
m_fTcpClient
ÀÀ 
.
ÀÀ 
send
ÀÀ !
(
ÀÀ! "
fSocketSendData
ÀÀ" 1
)
ÀÀ1 2
;
ÀÀ2 3
}
ÁÁ 
catch
ÂÂ 
(
ÂÂ 
	Exception
ÂÂ 
ex
ÂÂ 
)
ÂÂ  
{
ÃÃ 
FDebug
ÄÄ 
.
ÄÄ 
throwException
ÄÄ %
(
ÄÄ% &
ex
ÄÄ& (
)
ÄÄ( )
;
ÄÄ) *
}
ÅÅ 
finally
ÆÆ 
{
ÇÇ 
}
ÉÉ 
}
ÊÊ 	
private
ÎÎ 
void
ÎÎ 
recvData
ÎÎ 
(
ÎÎ 
)
ÏÏ 
{
ĞĞ 	
try
ÑÑ 
{
ÒÒ 
this
ÓÓ 
.
ÓÓ 
fSerialToEthernet
ÓÓ &
.
ÓÓ& '
fEventPusher
ÓÓ' 3
.
ÓÓ3 4
pushTcpEvent
ÓÓ4 @
(
ÓÓ@ A
new
ÔÔ *
FSocketDataReceivedEventArgs
ÔÔ 4
(
ÔÔ4 5
this
ÔÔ5 9
.
ÔÔ9 :
fSerialToEthernet
ÔÔ: K
,
ÔÔK L
FEventId
ÔÔM U
.
ÔÔU V 
SocketDataReceived
ÔÔV h
,
ÔÔh i
FResultCode
ÔÔj u
.
ÔÔu v
Success
ÔÔv }
,
ÔÔ} ~
stringÔÔ …
.ÔÔ… †
EmptyÔÔ† ‹
,ÔÔ‹ Œ

m_fRecvBufÔÔ —
.ÔÔ— ˜
binÔÔ˜ ›
)ÔÔ› œ
)
ÕÕ 
;
ÕÕ 
}
ÖÖ 
catch
×× 
(
×× 
	Exception
×× 
ex
×× 
)
××  
{
ØØ #
procSocketErrorRaised
ÙÙ %
(
ÙÙ% &
ex
ÙÙ& (
)
ÙÙ( )
;
ÙÙ) *
}
ÚÚ 
finally
ÛÛ 
{
ÜÜ 
}
ŞŞ 
}
ßß 	
private
ãã 
void
ãã 
resetResource
ãã "
(
ãã" #
)
ää 
{
åå 	
try
ææ 
{
çç 

m_fRecvBuf
èè 
.
èè 
clear
èè  
(
èè  !
)
èè! "
;
èè" #
}
éé 
catch
êê 
(
êê 
	Exception
êê 
ex
êê 
)
êê  
{
ëë 
FDebug
ìì 
.
ìì 
throwException
ìì %
(
ìì% &
ex
ìì& (
)
ìì( )
;
ìì) *
}
íí 
finally
îî 
{
ïï 
}
ññ 
}
òò 	
private
öö 
void
öö 
closeTcpClient
öö #
(
öö# $
)
÷÷ 
{
øø 	
try
ùù 
{
úú 
if
ûû 
(
ûû 
m_fTcpClient
ûû  
==
ûû! #
null
ûû$ (
)
ûû( )
{
üü 
return
ıı 
;
ıı 
}
şş 
if
‚‚ 
(
‚‚ 
m_fTcpClient
ƒƒ  
.
ƒƒ  !
fState
ƒƒ! '
==
ƒƒ( *
FTcpClientState
ƒƒ+ :
.
ƒƒ: ;
	Connected
ƒƒ; D
&&
ƒƒE G
this
„„ 
.
„„ 
fSerialToEthernet
„„ *
.
„„* +
fSocketState
„„+ 7
==
„„8 :!
FCommunicationState
„„; N
.
„„N O
	Connected
„„O X
)
…… 
{
†† 
while
‡‡ 
(
‡‡ 
this
‡‡ 
.
‡‡  
fSerialToEthernet
‡‡  1
.
‡‡1 2
fEventPusher
‡‡2 >
.
‡‡> ?
tcpEventCount
‡‡? L
>
‡‡M N
$num
‡‡O P
||
‡‡Q S
!
‡‡T U
m_fTcpClient
‡‡U a
.
‡‡a b
sendCompleted
‡‡b o
)
‡‡o p
{
ˆˆ 
if
‰‰ 
(
‰‰ 
System
‰‰ "
.
‰‰" #
Windows
‰‰# *
.
‰‰* +
Forms
‰‰+ 0
.
‰‰0 1
Application
‰‰1 <
.
‰‰< =
MessageLoop
‰‰= H
)
‰‰H I
{
ŠŠ 
System
‹‹ "
.
‹‹" #
Windows
‹‹# *
.
‹‹* +
Forms
‹‹+ 0
.
‹‹0 1
Application
‹‹1 <
.
‹‹< =
DoEvents
‹‹= E
(
‹‹E F
)
‹‹F G
;
‹‹G H
}
ŒŒ 
System
 
.
 
	Threading
 (
.
( )
Thread
) /
.
/ 0
Sleep
0 5
(
5 6
$num
6 7
)
7 8
;
8 9
}
 
}
 
m_fTcpClient
““ 
.
““ 
close
““ "
(
““" #
)
““# $
;
““$ %
m_fTcpClient
”” 
.
”” 
Dispose
”” $
(
””$ %
)
””% &
;
””& '
m_fTcpClient
–– 
.
–– #
TcpClientStateChanged
–– 2
-=
––3 5
new
––6 90
"FTcpClientStateChangedEventHandler
––: \
(
––\ ]0
"m_fTcpClient_TcpClientStateChanged
––] 
)–– €
;––€ 
m_fTcpClient
—— 
.
—— #
TcpClientDataReceived
—— 2
-=
——3 5
new
——6 90
"FTcpClientDataReceivedEventHandler
——: \
(
——\ ]0
"m_fTcpClient_TcpClientDataReceived
——] 
)—— €
;——€ 
m_fTcpClient
˜˜ 
.
˜˜ 
TcpClientDataSent
˜˜ .
-=
˜˜/ 1
new
˜˜2 5,
FTcpClientDataSentEventHandler
˜˜6 T
(
˜˜T U,
m_fTcpClient_TcpClientDataSent
˜˜U s
)
˜˜s t
;
˜˜t u
m_fTcpClient
™™ 
.
™™ %
TcpClientDataSendFailed
™™ 4
-=
™™5 7
new
™™8 ;2
$FTcpClientDataSendFailedEventHandler
™™< `
(
™™` a3
$m_fTcpClient_TcpClientDataSendFailed™™a …
)™™… †
;™™† ‡
m_fTcpClient
šš 
.
šš "
TcpClientErrorRaised
šš 1
-=
šš2 4
new
šš5 8/
!FTcpClientErrorRaisedEventHandler
šš9 Z
(
ššZ [/
!m_fTcpClient_TcpClientErrorRaised
šš[ |
)
šš| }
;
šš} ~
m_fTcpClient
œœ 
=
œœ 
null
œœ #
;
œœ# $
}
 
catch
 
(
 
	Exception
 
ex
 
)
  
{
ŸŸ 
FDebug
   
.
   
throwException
   %
(
  % &
ex
  & (
)
  ( )
;
  ) *
}
¡¡ 
finally
¢¢ 
{
££ 
}
¥¥ 
}
¦¦ 	
public
ªª 
override
ªª 
void
ªª 
open
ªª !
(
ªª! "
)
«« 
{
¬¬ 	
try
­­ 
{
®® 
m_fTcpListener
¯¯ 
=
¯¯  
new
¯¯! $
FTcpListener
¯¯% 1
(
¯¯1 2
this
¯¯2 6
.
¯¯6 7
fSerialToEthernet
¯¯7 H
.
¯¯H I
fSocketConfig
¯¯I V
.
¯¯V W
localIp
¯¯W ^
,
¯¯^ _
this
¯¯` d
.
¯¯d e
fSerialToEthernet
¯¯e v
.
¯¯v w
fSocketConfig¯¯w „
.¯¯„ …
	localPort¯¯… 
,¯¯ 
$num¯¯ ‘
)¯¯‘ ’
;¯¯’ “
m_fTcpListener
±± 
.
±± (
TcpListenerAcceptCompleted
±± 9
+=
±±: <
new
±±= @5
'FTcpListenerAcceptCompletedEventHandler
±±A h
(
±±h i8
)m_fTcpListener_TcpListenerAcceptCompleted±±i ’
)±±’ “
;±±“ ”
m_fTcpListener
²² 
.
²² $
TcpListenerErrorRaised
²² 5
+=
²²6 8
new
²²9 <1
#FTcpListenerErrorRaisedEventHandler
²²= `
(
²²` a4
%m_fTcpListener_TcpListenerErrorRaised²²a †
)²²† ‡
;²²‡ ˆ
m_fTcpListener
´´ 
.
´´ 
start
´´ $
(
´´$ %
)
´´% &
;
´´& '
this
¸¸ 
.
¸¸ 
fSerialToEthernet
¸¸ &
.
¸¸& '
changeTcpState
¸¸' 5
(
¸¸5 6!
FCommunicationState
¸¸6 I
.
¸¸I J
Opened
¸¸J P
,
¸¸P Q
FConnectMode
¸¸R ^
.
¸¸^ _
Passive
¸¸_ f
,
¸¸f g
this
¸¸h l
.
¸¸l m
localIp
¸¸m t
,
¸¸t u
this
¸¸v z
.
¸¸z {
	localPort¸¸{ „
,¸¸„ …
this¸¸† Š
.¸¸Š ‹
remoteIp¸¸‹ “
,¸¸“ ”
this¸¸• ™
.¸¸™ š

remotePort¸¸š ¤
)¸¸¤ ¥
;¸¸¥ ¦
}
¹¹ 
catch
ºº 
(
ºº 
	Exception
ºº 
ex
ºº 
)
ºº  
{
»» 
FDebug
¼¼ 
.
¼¼ 
throwException
¼¼ %
(
¼¼% &
ex
¼¼& (
)
¼¼( )
;
¼¼) *
}
½½ 
finally
¾¾ 
{
¿¿ 
}
ÁÁ 
}
ÂÂ 	
public
ÆÆ 
override
ÆÆ 
void
ÆÆ 
close
ÆÆ "
(
ÆÆ" #
)
ÇÇ 
{
ÈÈ 	
try
ÉÉ 
{
ÊÊ 
m_fTcpListener
ËË 
.
ËË 
stop
ËË #
(
ËË# $
)
ËË$ %
;
ËË% &
m_fTcpListener
ÌÌ 
.
ÌÌ 
Dispose
ÌÌ &
(
ÌÌ& '
)
ÌÌ' (
;
ÌÌ( )
m_fTcpListener
ÎÎ 
.
ÎÎ (
TcpListenerAcceptCompleted
ÎÎ 9
-=
ÎÎ: <
new
ÎÎ= @5
'FTcpListenerAcceptCompletedEventHandler
ÎÎA h
(
ÎÎh i8
)m_fTcpListener_TcpListenerAcceptCompletedÎÎi ’
)ÎÎ’ “
;ÎÎ“ ”
m_fTcpListener
ÏÏ 
.
ÏÏ $
TcpListenerErrorRaised
ÏÏ 5
-=
ÏÏ6 8
new
ÏÏ9 <1
#FTcpListenerErrorRaisedEventHandler
ÏÏ= `
(
ÏÏ` a4
%m_fTcpListener_TcpListenerErrorRaisedÏÏa †
)ÏÏ† ‡
;ÏÏ‡ ˆ
m_fTcpListener
ÑÑ 
=
ÑÑ  
null
ÑÑ! %
;
ÑÑ% &
closeTcpClient
ÕÕ 
(
ÕÕ 
)
ÕÕ  
;
ÕÕ  !
this
ÙÙ 
.
ÙÙ 
fSerialToEthernet
ÙÙ &
.
ÙÙ& '
changeTcpState
ÙÙ' 5
(
ÙÙ5 6!
FCommunicationState
ÙÙ6 I
.
ÙÙI J
Closed
ÙÙJ P
,
ÙÙP Q
FConnectMode
ÙÙR ^
.
ÙÙ^ _
Passive
ÙÙ_ f
,
ÙÙf g
this
ÙÙh l
.
ÙÙl m
localIp
ÙÙm t
,
ÙÙt u
this
ÙÙv z
.
ÙÙz {
	localPortÙÙ{ „
,ÙÙ„ …
thisÙÙ† Š
.ÙÙŠ ‹
remoteIpÙÙ‹ “
,ÙÙ“ ”
thisÙÙ• ™
.ÙÙ™ š

remotePortÙÙš ¤
)ÙÙ¤ ¥
;ÙÙ¥ ¦
}
ÚÚ 
catch
ÛÛ 
(
ÛÛ 
	Exception
ÛÛ 
ex
ÛÛ 
)
ÛÛ  
{
ÜÜ 
FDebug
İİ 
.
İİ 
throwException
İİ %
(
İİ% &
ex
İİ& (
)
İİ( )
;
İİ) *
}
ŞŞ 
finally
ßß 
{
àà 
}
ââ 
}
ãã 	
public
çç 
override
çç 
void
çç 
send
çç !
(
çç! "
FSocketSendData
èè 
fSocketSendData
èè +
)
éé 
{
êê 	
try
ëë 
{
ìì 
sendData
íí 
(
íí 
fSocketSendData
íí (
)
íí( )
;
íí) *
}
îî 
catch
ïï 
(
ïï 
	Exception
ïï 
ex
ïï 
)
ïï  
{
ğğ 
FDebug
ññ 
.
ññ 
throwException
ññ %
(
ññ% &
ex
ññ& (
)
ññ( )
;
ññ) *
}
òò 
finally
óó 
{
ôô 
}
öö 
}
÷÷ 	
private
ûû 
void
ûû #
procSocketErrorRaised
ûû *
(
ûû* +
	Exception
üü 
inEx
üü 
)
ıı 
{
şş 	
try
ÿÿ 
{
€€ 
FDebug
 
.
 
writeLog
 
(
  
inEx
  $
)
$ %
;
% &
this
ƒƒ 
.
ƒƒ 
fSerialToEthernet
ƒƒ &
.
ƒƒ& '
fEventPusher
ƒƒ' 3
.
ƒƒ3 4
pushTcpEvent
ƒƒ4 @
(
ƒƒ@ A
new
„„ )
FSocketErrorRaisedEventArgs
„„ 3
(
„„3 4
this
„„4 8
.
„„8 9
fSerialToEthernet
„„9 J
,
„„J K
FEventId
„„L T
.
„„T U
SocketErrorRaised
„„U f
,
„„f g
inEx
„„h l
.
„„l m
Message
„„m t
)
„„t u
)
…… 
;
…… 
}
†† 
catch
‡‡ 
(
‡‡ 
	Exception
‡‡ 
ex
‡‡ 
)
‡‡  
{
ˆˆ 
FDebug
‰‰ 
.
‰‰ 
writeLog
‰‰ 
(
‰‰  
ex
‰‰  "
)
‰‰" #
;
‰‰# $
}
ŠŠ 
finally
‹‹ 
{
ŒŒ 
}
 
}
 	
private
—— 
void
—— (
m_fThdMain_ThreadJobCalled
—— /
(
——/ 0
object
˜˜ 
sender
˜˜ 
,
˜˜ 
FThreadEventArgs
™™ 
e
™™ 
)
šš 
{
›› 	
bool
œœ 
waited
œœ 
=
œœ 
false
œœ 
;
œœ  
try
 
{
ŸŸ 
waited
   
=
   
m_fMainSync
   $
.
  $ %
tryWait
  % ,
(
  , -
$num
  - .
)
  . /
;
  / 0
if
¡¡ 
(
¡¡ 
!
¡¡ 
waited
¡¡ 
)
¡¡ 
{
¢¢ 
return
££ 
;
££ 
}
¤¤ 
if
¨¨ 
(
¨¨ 
m_fTcpListener
¨¨ !
.
¨¨! "
started
¨¨" )
)
¨¨) *
{
©© 
if
ªª 
(
ªª 
this
ªª 
.
ªª 
fSerialToEthernet
ªª .
.
ªª. /
fSerialState
ªª/ ;
!=
ªª< >!
FCommunicationState
ªª? R
.
ªªR S
	Connected
ªªS \
)
ªª\ ]
{
«« 
m_fTcpListener
¬¬ &
.
¬¬& '
stop
¬¬' +
(
¬¬+ ,
)
¬¬, -
;
¬¬- .
this
­­ 
.
­­ 
fSerialToEthernet
­­ .
.
­­. /
changeTcpState
­­/ =
(
­­= >!
FCommunicationState
­­> Q
.
­­Q R
Opened
­­R X
,
­­X Y
FConnectMode
­­Z f
.
­­f g
Passive
­­g n
,
­­n o
this
­­p t
.
­­t u
localIp
­­u |
,
­­| }
this­­~ ‚
.­­‚ ƒ
	localPort­­ƒ Œ
,­­Œ 
this­­ ’
.­­’ “
remoteIp­­“ ›
,­­› œ
this­­ ¡
.­­¡ ¢

remotePort­­¢ ¬
)­­¬ ­
;­­­ ®
}
®® 
}
¯¯ 
else
°° 
{
±± 
if
²² 
(
²² 
this
²² 
.
²² 
fSerialToEthernet
²² .
.
²². /
fSerialState
²²/ ;
==
²²< >!
FCommunicationState
²²? R
.
²²R S
	Connected
²²S \
)
²²\ ]
{
³³ 
m_fTcpListener
´´ &
.
´´& '
start
´´' ,
(
´´, -
)
´´- .
;
´´. /
}
µµ 
}
¶¶ 
e
ºº 
.
ºº 
sleepThread
ºº 
(
ºº 
$num
ºº 
)
ºº  
;
ºº  !
}
»» 
catch
¼¼ 
(
¼¼ 
	Exception
¼¼ 
ex
¼¼ 
)
¼¼  
{
½½ #
procSocketErrorRaised
¾¾ %
(
¾¾% &
ex
¾¾& (
)
¾¾( )
;
¾¾) *
}
¿¿ 
finally
ÀÀ 
{
ÁÁ 
if
ÂÂ 
(
ÂÂ 
waited
ÂÂ 
)
ÂÂ 
{
ÃÃ 
m_fMainSync
ÄÄ 
.
ÄÄ  
set
ÄÄ  #
(
ÄÄ# $
)
ÄÄ$ %
;
ÄÄ% &
}
ÅÅ 
}
ÆÆ 
}
ÇÇ 	
private
ÏÏ 
void
ÏÏ 7
)m_fTcpListener_TcpListenerAcceptCompleted
ÏÏ >
(
ÏÏ> ?
object
ĞĞ 
sender
ĞĞ 
,
ĞĞ 2
$FTcpListenerAcceptCompletedEventArgs
ÑÑ 0
e
ÑÑ1 2
)
ÒÒ 
{
ÓÓ 	
try
ÔÔ 
{
ÕÕ 
m_fMainSync
ÖÖ 
.
ÖÖ 
wait
ÖÖ  
(
ÖÖ  !
)
ÖÖ! "
;
ÖÖ" #
closeTcpClient
ÚÚ 
(
ÚÚ 
)
ÚÚ  
;
ÚÚ  !
this
ŞŞ 
.
ŞŞ 
localIp
ŞŞ 
=
ŞŞ 
e
ŞŞ  
.
ŞŞ  !

fTcpClient
ŞŞ! +
.
ŞŞ+ ,
localIp
ŞŞ, 3
;
ŞŞ3 4
this
ßß 
.
ßß 
	localPort
ßß 
=
ßß  
e
ßß! "
.
ßß" #

fTcpClient
ßß# -
.
ßß- .
	localPort
ßß. 7
;
ßß7 8
this
àà 
.
àà 
remoteIp
àà 
=
àà 
e
àà  !
.
àà! "

fTcpClient
àà" ,
.
àà, -
remoteIp
àà- 5
;
àà5 6
this
áá 
.
áá 

remotePort
áá 
=
áá  !
e
áá" #
.
áá# $

fTcpClient
áá$ .
.
áá. /

remotePort
áá/ 9
;
áá9 :
m_fTcpClient
åå 
=
åå 
e
åå  
.
åå  !

fTcpClient
åå! +
;
åå+ ,
m_fTcpClient
çç 
.
çç #
TcpClientStateChanged
çç 2
+=
çç3 5
new
çç6 90
"FTcpClientStateChangedEventHandler
çç: \
(
çç\ ]0
"m_fTcpClient_TcpClientStateChanged
çç] 
)çç €
;çç€ 
m_fTcpClient
èè 
.
èè #
TcpClientDataReceived
èè 2
+=
èè3 5
new
èè6 90
"FTcpClientDataReceivedEventHandler
èè: \
(
èè\ ]0
"m_fTcpClient_TcpClientDataReceived
èè] 
)èè €
;èè€ 
m_fTcpClient
éé 
.
éé 
TcpClientDataSent
éé .
+=
éé/ 1
new
éé2 5,
FTcpClientDataSentEventHandler
éé6 T
(
ééT U,
m_fTcpClient_TcpClientDataSent
ééU s
)
éés t
;
éét u
m_fTcpClient
êê 
.
êê %
TcpClientDataSendFailed
êê 4
+=
êê5 7
new
êê8 ;2
$FTcpClientDataSendFailedEventHandler
êê< `
(
êê` a3
$m_fTcpClient_TcpClientDataSendFailedêêa …
)êê… †
;êê† ‡
m_fTcpClient
ëë 
.
ëë "
TcpClientErrorRaised
ëë 1
+=
ëë2 4
new
ëë5 8/
!FTcpClientErrorRaisedEventHandler
ëë9 Z
(
ëëZ [/
!m_fTcpClient_TcpClientErrorRaised
ëë[ |
)
ëë| }
;
ëë} ~
m_fTcpClient
íí 
.
íí 
resumeEvent
íí (
(
íí( )
)
íí) *
;
íí* +
this
ññ 
.
ññ 
fSerialToEthernet
ññ &
.
ññ& '
changeTcpState
ññ' 5
(
ññ5 6!
FCommunicationState
ññ6 I
.
ññI J
	Connected
ññJ S
,
ññS T
FConnectMode
ññU a
.
ñña b
Passive
ññb i
,
ññi j
this
ññk o
.
ñño p
localIp
ññp w
,
ññw x
this
ññy }
.
ññ} ~
	localPortññ~ ‡
,ññ‡ ˆ
thisññ‰ 
.ññ 
remoteIpññ –
,ññ– —
thisññ˜ œ
.ññœ 

remotePortññ §
)ññ§ ¨
;ññ¨ ©
}
òò 
catch
óó 
(
óó 
	Exception
óó 
ex
óó 
)
óó  
{
ôô 
FDebug
õõ 
.
õõ 
writeLog
õõ 
(
õõ  
ex
õõ  "
)
õõ" #
;
õõ# $
}
öö 
finally
÷÷ 
{
øø 
m_fMainSync
ùù 
.
ùù 
set
ùù 
(
ùù  
)
ùù  !
;
ùù! "
}
úú 
}
ûû 	
private
ÿÿ 
void
ÿÿ 3
%m_fTcpListener_TcpListenerErrorRaised
ÿÿ :
(
ÿÿ: ;
object
€€ 
sender
€€ 
,
€€ .
 FTcpListenerErrorRaisedEventArgs
 ,
e
- .
)
‚‚ 
{
ƒƒ 	
try
„„ 
{
…… #
procSocketErrorRaised
†† %
(
††% &
e
††& '
.
††' (
	exception
††( 1
)
††1 2
;
††2 3
}
‡‡ 
catch
ˆˆ 
(
ˆˆ 
	Exception
ˆˆ 
ex
ˆˆ 
)
ˆˆ  
{
‰‰ 
FDebug
ŠŠ 
.
ŠŠ 
writeLog
ŠŠ 
(
ŠŠ  
ex
ŠŠ  "
)
ŠŠ" #
;
ŠŠ# $
}
‹‹ 
finally
ŒŒ 
{
 
}
 
}
 	
private
˜˜ 
void
˜˜ 0
"m_fTcpClient_TcpClientStateChanged
˜˜ 7
(
˜˜7 8
object
™™ 
sender
™™ 
,
™™ -
FTcpClientStateChangedEventArgs
šš +
e
šš, -
)
›› 
{
œœ 	
try
 
{
 
m_fMainSync
ŸŸ 
.
ŸŸ 
wait
ŸŸ  
(
ŸŸ  !
)
ŸŸ! "
;
ŸŸ" #
if
££ 
(
££ 
m_fTcpListener
££ "
!=
££# %
null
££& *
&&
££+ -
e
££. /
.
££/ 0
fState
££0 6
==
££7 9
FTcpClientState
££: I
.
££I J
Closed
££J P
)
££P Q
{
¤¤ 
this
¥¥ 
.
¥¥ 
fSerialToEthernet
¥¥ *
.
¥¥* +
changeTcpState
¥¥+ 9
(
¥¥9 :!
FCommunicationState
¥¥: M
.
¥¥M N
Opened
¥¥N T
,
¥¥T U
FConnectMode
¥¥V b
.
¥¥b c
Passive
¥¥c j
,
¥¥j k
this
¥¥l p
.
¥¥p q
localIp
¥¥q x
,
¥¥x y
this
¥¥z ~
.
¥¥~ 
	localPort¥¥ ˆ
,¥¥ˆ ‰
this¥¥Š 
.¥¥ 
remoteIp¥¥ —
,¥¥— ˜
this¥¥™ 
.¥¥ 

remotePort¥¥ ¨
)¥¥¨ ©
;¥¥© ª
resetResource
§§ !
(
§§! "
)
§§" #
;
§§# $
}
¨¨ 
}
©© 
catch
ªª 
(
ªª 
	Exception
ªª 
ex
ªª 
)
ªª  
{
«« #
procSocketErrorRaised
¬¬ %
(
¬¬% &
ex
¬¬& (
)
¬¬( )
;
¬¬) *
}
­­ 
finally
®® 
{
¯¯ 
m_fMainSync
°° 
.
°° 
set
°° 
(
°°  
)
°°  !
;
°°! "
}
±± 
}
²² 	
private
¶¶ 
void
¶¶ 0
"m_fTcpClient_TcpClientDataReceived
¶¶ 7
(
¶¶7 8
object
·· 
sender
·· 
,
·· -
FTcpClientDataReceivedEventArgs
¸¸ +
e
¸¸, -
)
¹¹ 
{
ºº 	
try
»» 
{
¼¼ 
m_fMainSync
½½ 
.
½½ 
wait
½½  
(
½½  !
)
½½! "
;
½½" #
if
ÁÁ 
(
ÁÁ 
e
ÁÁ 
.
ÁÁ 

dataLength
ÁÁ  
>
ÁÁ! "
$num
ÁÁ# $
)
ÁÁ$ %
{
ÂÂ 

m_fRecvBuf
ÃÃ 
.
ÃÃ 
input
ÃÃ $
(
ÃÃ$ %
e
ÃÃ% &
.
ÃÃ& '
data
ÃÃ' +
)
ÃÃ+ ,
;
ÃÃ, -
while
ÇÇ 
(
ÇÇ 

m_fRecvBuf
ÇÇ %
.
ÇÇ% &
parse
ÇÇ& +
(
ÇÇ+ ,
)
ÇÇ, -
)
ÇÇ- .
{
ÈÈ 
recvData
ÉÉ  
(
ÉÉ  !
)
ÉÉ! "
;
ÉÉ" #

m_fRecvBuf
ÍÍ "
.
ÍÍ" #
init
ÍÍ# '
(
ÍÍ' (
)
ÍÍ( )
;
ÍÍ) *
}
ÎÎ 
}
ÏÏ 
}
ĞĞ 
catch
ÑÑ 
(
ÑÑ 
	Exception
ÑÑ 
ex
ÑÑ 
)
ÑÑ  
{
ÒÒ #
procSocketErrorRaised
ÓÓ %
(
ÓÓ% &
ex
ÓÓ& (
)
ÓÓ( )
;
ÓÓ) *
}
ÔÔ 
finally
ÕÕ 
{
ÖÖ 
m_fMainSync
×× 
.
×× 
set
×× 
(
××  
)
××  !
;
××! "
}
ØØ 
}
ÙÙ 	
private
İİ 
void
İİ ,
m_fTcpClient_TcpClientDataSent
İİ 3
(
İİ3 4
object
ŞŞ 
sender
ŞŞ 
,
ŞŞ )
FTcpClientDataSentEventArgs
ßß '
e
ßß( )
)
àà 
{
áá 	
try
ââ 
{
ãã 
m_fMainSync
ää 
.
ää 
wait
ää  
(
ää  !
)
ää! "
;
ää" #
this
èè 
.
èè 
fSerialToEthernet
èè &
.
èè& '
fEventPusher
èè' 3
.
èè3 4
pushTcpEvent
èè4 @
(
èè@ A
new
éé &
FSocketDataSentEventArgs
éé 0
(
éé0 1
this
êê 
.
êê 
fSerialToEthernet
êê .
,
êê. /
FEventId
ëë  
.
ëë  !
SocketDataSent
ëë! /
,
ëë/ 0
FResultCode
ìì #
.
ìì# $
Success
ìì$ +
,
ìì+ ,
string
íí 
.
íí 
Empty
íí $
,
íí$ %
e
îî 
.
îî 
fData
îî 
)
ïï 
)
ğğ 
;
ğğ 
}
ññ 
catch
òò 
(
òò 
	Exception
òò 
ex
òò 
)
òò  
{
óó #
procSocketErrorRaised
ôô %
(
ôô% &
ex
ôô& (
)
ôô( )
;
ôô) *
}
õõ 
finally
öö 
{
÷÷ 
m_fMainSync
øø 
.
øø 
set
øø 
(
øø  
)
øø  !
;
øø! "
}
ùù 
}
úú 	
private
şş 
void
şş 2
$m_fTcpClient_TcpClientDataSendFailed
şş 9
(
şş9 :
object
ÿÿ 
sender
ÿÿ 
,
ÿÿ /
!FTcpClientDataSendFailedEventArgs
€€ -
e
€€. /
)
 
{
‚‚ 	
try
ƒƒ 
{
„„ 
m_fMainSync
…… 
.
…… 
wait
……  
(
……  !
)
……! "
;
……" #
this
‰‰ 
.
‰‰ 
fSerialToEthernet
‰‰ &
.
‰‰& '
fEventPusher
‰‰' 3
.
‰‰3 4
pushTcpEvent
‰‰4 @
(
‰‰@ A
new
ŠŠ &
FSocketDataSentEventArgs
ŠŠ 0
(
ŠŠ0 1
this
‹‹ 
.
‹‹ 
fSerialToEthernet
‹‹ .
,
‹‹. /
FEventId
ŒŒ  
.
ŒŒ  !
SocketDataSent
ŒŒ! /
,
ŒŒ/ 0
FResultCode
 #
.
# $
Error
$ )
,
) *
e
 
.
 
message
 !
,
! "
e
 
.
 
fData
 
)
 
)
‘‘ 
;
‘‘ 
}
’’ 
catch
““ 
(
““ 
	Exception
““ 
ex
““ 
)
““  
{
”” #
procSocketErrorRaised
•• %
(
••% &
ex
••& (
)
••( )
;
••) *
}
–– 
finally
—— 
{
˜˜ 
m_fMainSync
™™ 
.
™™ 
set
™™ 
(
™™  
)
™™  !
;
™™! "
}
šš 
}
›› 	
private
ŸŸ 
void
ŸŸ /
!m_fTcpClient_TcpClientErrorRaised
ŸŸ 6
(
ŸŸ6 7
object
   
sender
   
,
   ,
FTcpClientErrorRaisedEventArgs
¡¡ *
e
¡¡+ ,
)
¢¢ 
{
££ 	
try
¤¤ 
{
¥¥ #
procSocketErrorRaised
¦¦ %
(
¦¦% &
e
¦¦& '
.
¦¦' (
	exception
¦¦( 1
)
¦¦1 2
;
¦¦2 3
}
§§ 
catch
¨¨ 
(
¨¨ 
	Exception
¨¨ 
ex
¨¨ 
)
¨¨  
{
©© #
procSocketErrorRaised
ªª %
(
ªª% &
ex
ªª& (
)
ªª( )
;
ªª) *
}
«« 
finally
¬¬ 
{
­­ 
}
¯¯ 
}
°° 	
}
¶¶ 
}·· ­	
~D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\SerialToEthernet\Protocol\c_FXmlTagCustom001.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSerialToEthernet -
{ 
public 

static 
class 
FXmlSocketTag %
{ 
public)) 
const)) 
string)) 
	E_MESSAGE)) %
=))& '
$str))( 1
;))1 2
public** 
const** 
string** 
E_HEADER** $
=**% &
$str**' /
;**/ 0
public++ 
const++ 
string++ 
E_MSG_ID++ $
=++% &
$str++' /
;++/ 0
public,, 
const,, 
string,, 

E_EQUIP_ID,, &
=,,' (
$str,,) 3
;,,3 4
public-- 
const-- 
string-- 
E_DATE-- "
=--# $
$str--% +
;--+ ,
public.. 
const.. 
string.. 
E_BODY.. "
=..# $
$str..% +
;..+ ,
}22 
}33 ©B
ŠD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\SerialToEthernet\Protocol\Serial\c_FSerialPluginRecvData.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSerialToEthernet -
{ 
public 

class !
FSerialPluginRecvData &
:& '
IDisposable( 3
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FSerialToEthernet !
m_fSerialToEthernet" 5
=6 7
null8 <
;< =
private 
List 
< 
byte 
> 
m_data !
=" #
null$ (
;( )
internal## !
FSerialPluginRecvData## &
(##& '
FSerialToEthernet$$ 
fSerialToEthernet$$ /
,$$/ 0
byte%% 
[%% 
]%% 
data%% 
)&& 
{'' 	
m_fSerialToEthernet(( 
=((  !
fSerialToEthernet((" 3
;((3 4
m_data** 
=** 
new** 
List** 
<** 
byte** "
>**" #
(**# $
data**$ (
)**( )
;**) *
}++ 	
~// 	!
FSerialPluginRecvData//	 
(// 
)00 
{11 	
	myDispose22 
(22 
false22 
)22 
;22 
}33 	
	protected77 
void77 
	myDispose77  
(77  !
bool88 
	disposing88 
)99 
{:: 	
if;; 
(;; 
!;; 

m_disposed;; 
);; 
{<< 
if== 
(== 
	disposing== 
)== 
{>> 
m_fSerialToEthernet?? '
=??( )
null??* .
;??. /
m_data@@ 
=@@ 
null@@ !
;@@! "
}AA 

m_disposedCC 
=CC 
trueCC !
;CC! "
}DD 
}EE 	
publicMM 
voidMM 
DisposeMM 
(MM 
)NN 
{OO 	
	myDisposePP 
(PP 
truePP 
)PP 
;PP 
GCQQ 
.QQ 
SuppressFinalizeQQ 
(QQ  
thisQQ  $
)QQ$ %
;QQ% &
}RR 	
publicZZ 
UInt32ZZ 
lengthZZ 
{[[ 	
get\\ 
{]] 
try^^ 
{__ 
return`` 
(`` 
UInt32`` "
)``" #
(``# $
$num``$ &
+``' (
m_data``) /
.``/ 0
Count``0 5
)``5 6
;``6 7
}aa 
catchbb 
(bb 
	Exceptionbb  
exbb! #
)bb# $
{cc 
FDebugdd 
.dd 
throwExceptiondd )
(dd) *
exdd* ,
)dd, -
;dd- .
}ee 
finallyff 
{gg 
}ii 
returnjj 
$numjj 
;jj 
}kk 
}ll 	
publicpp 
bytepp 
[pp 
]pp 
datapp 
{qq 	
getrr 
{ss 
trytt 
{uu 
returnvv 
m_datavv !
.vv! "
ToArrayvv" )
(vv) *
)vv* +
;vv+ ,
}ww 
catchxx 
(xx 
	Exceptionxx  
exxx! #
)xx# $
{yy 
FDebugzz 
.zz 
throwExceptionzz )
(zz) *
exzz* ,
)zz, -
;zz- .
}{{ 
finally|| 
{}} 
} 
return
€€ 
null
€€ 
;
€€ 
}
 
}
‚‚ 	
public
†† 
string
†† 
dataToString
†† "
{
‡‡ 	
get
ˆˆ 
{
‰‰ 
try
ŠŠ 
{
‹‹ 
return
ŒŒ 
Encoding
ŒŒ #
.
ŒŒ# $
Default
ŒŒ$ +
.
ŒŒ+ ,
	GetString
ŒŒ, 5
(
ŒŒ5 6
m_data
ŒŒ6 <
.
ŒŒ< =
ToArray
ŒŒ= D
(
ŒŒD E
)
ŒŒE F
)
ŒŒF G
;
ŒŒG H
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
‘‘ 
finally
’’ 
{
““ 
}
•• 
return
–– 
string
–– 
.
–– 
Empty
–– #
;
––# $
}
—— 
}
˜˜ 	
internal
   #
FSerialPluginRecvData
   &
clone
  ' ,
(
  , -
)
¡¡ 
{
¢¢ 	
try
££ 
{
¤¤ 
return
¥¥ 
new
¥¥ #
FSerialPluginRecvData
¥¥ 0
(
¥¥0 1!
m_fSerialToEthernet
¦¦ '
,
¦¦' (
m_data
§§ 
.
§§ 
ToArray
§§ "
(
§§" #
)
§§# $
)
¨¨ 
;
¨¨ 
}
©© 
catch
ªª 
(
ªª 
	Exception
ªª 
ex
ªª 
)
ªª  
{
«« 
FDebug
¬¬ 
.
¬¬ 
throwException
¬¬ %
(
¬¬% &
ex
¬¬& (
)
¬¬( )
;
¬¬) *
}
­­ 
finally
®® 
{
¯¯ 
}
±± 
return
²² 
null
²² 
;
²² 
}
³³ 	
internal
·· 
byte
·· 
[
·· 
]
·· 
getTcpBinaryData
·· (
(
··( )
bool
¸¸ 
lengthInclude
¸¸ 
)
¹¹ 
{
ºº 	
byte
»» 
[
»» 
]
»» 
binData
»» 
=
»» 
null
»» !
;
»»! "
UInt32
¼¼ 
length
¼¼ 
=
¼¼ 
$num
¼¼ 
;
¼¼ 
int
½½ 
pos
½½ 
=
½½ 
$num
½½ 
;
½½ 
try
¿¿ 
{
ÀÀ 
length
ÁÁ 
=
ÁÁ 
this
ÁÁ 
.
ÁÁ 
length
ÁÁ $
;
ÁÁ$ %
if
ÅÅ 
(
ÅÅ 
lengthInclude
ÅÅ !
)
ÅÅ! "
{
ÆÆ 
binData
ÇÇ 
=
ÇÇ 
new
ÇÇ !
byte
ÇÇ" &
[
ÇÇ& '
length
ÇÇ' -
+
ÇÇ. /
$num
ÇÇ0 1
]
ÇÇ1 2
;
ÇÇ2 3
Buffer
ÎÎ 
.
ÎÎ 
	BlockCopy
ÎÎ $
(
ÎÎ$ %
FByteConverter
ÎÎ% 3
.
ÎÎ3 4
getBytes
ÎÎ4 <
(
ÎÎ< =
length
ÎÎ= C
,
ÎÎC D
true
ÎÎE I
)
ÎÎI J
,
ÎÎJ K
$num
ÎÎL M
,
ÎÎM N
binData
ÎÎO V
,
ÎÎV W
pos
ÎÎX [
,
ÎÎ[ \
$num
ÎÎ] ^
)
ÎÎ^ _
;
ÎÎ_ `
pos
ÏÏ 
+=
ÏÏ 
$num
ÏÏ 
;
ÏÏ 
}
ĞĞ 
else
ÑÑ 
{
ÒÒ 
binData
ÓÓ 
=
ÓÓ 
new
ÓÓ !
byte
ÓÓ" &
[
ÓÓ& '
length
ÓÓ' -
]
ÓÓ- .
;
ÓÓ. /
}
ÔÔ 
if
ÛÛ 
(
ÛÛ 
m_data
ÛÛ 
.
ÛÛ 
Count
ÛÛ  
>
ÛÛ! "
$num
ÛÛ# $
)
ÛÛ$ %
{
ÜÜ 
Buffer
İİ 
.
İİ 
	BlockCopy
İİ $
(
İİ$ %
m_data
İİ% +
.
İİ+ ,
ToArray
İİ, 3
(
İİ3 4
)
İİ4 5
,
İİ5 6
$num
İİ7 8
,
İİ8 9
binData
İİ: A
,
İİA B
pos
İİC F
,
İİF G
m_data
İİH N
.
İİN O
Count
İİO T
)
İİT U
;
İİU V
}
ŞŞ 
return
ââ 
binData
ââ 
;
ââ 
}
ãã 
catch
ää 
(
ää 
	Exception
ää 
ex
ää 
)
ää  
{
åå 
FDebug
ææ 
.
ææ 
throwException
ææ %
(
ææ% &
ex
ææ& (
)
ææ( )
;
ææ) *
}
çç 
finally
èè 
{
éé 
}
ëë 
return
ìì 
null
ìì 
;
ìì 
}
íí 	
}
óó 
}ôô —E
‚D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.MC.Core.Converter\SerialToEthernet\Protocol\c_FCustom001SendBuffer.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaSerialToEthernet -
{ 
public 

class %
FSerialPluginDataTransfer *
:* +
IDisposable, 7
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FXmlNode 
m_fXmlNodeMsg &
=' (
null) -
;- .
private 
string 
m_xml 
= 
string %
.% &
Empty& +
;+ ,
public"" %
FSerialPluginDataTransfer"" (
(""( )
)## 
{$$ 	
}&& 	
~** 	%
FSerialPluginDataTransfer**	 "
(**" #
)++ 
{,, 	
	myDispose-- 
(-- 
false-- 
)-- 
;-- 
}.. 	
	protected22 
void22 
	myDispose22  
(22  !
bool33 
	disposing33 
)44 
{55 	
if66 
(66 
!66 

m_disposed66 
)66 
{77 
if88 
(88 
	disposing88 
)88 
{99 
m_fXmlNodeMsg:: !
=::" #
null::$ (
;::( )
};; 

m_disposed== 
=== 
true== !
;==! "
}>> 
}?? 	
publicGG 
voidGG 
DisposeGG 
(GG 
)HH 
{II 	
	myDisposeJJ 
(JJ 
trueJJ 
)JJ 
;JJ 
GCKK 
.KK 
SuppressFinalizeKK 
(KK  
thisKK  $
)KK$ %
;KK% &
}LL 	
publicTT 
FXmlNodeTT 
fMsgTT 
{UU 	
getVV 
{WW 
tryXX 
{YY 
returnZZ 
m_fXmlNodeMsgZZ (
;ZZ( )
}[[ 
catch\\ 
(\\ 
	Exception\\  
ex\\! #
)\\# $
{]] 
FDebug^^ 
.^^ 
throwException^^ )
(^^) *
ex^^* ,
)^^, -
;^^- .
}__ 
finally`` 
{aa 
}cc 
returndd 
nulldd 
;dd 
}ee 
}ff 	
privatenn 
voidnn 
validatenn 
(nn 
)oo 
{pp 	
stringqq 
xpathqq 
=qq 
stringqq !
.qq! "
Emptyqq" '
;qq' (
tryss 
{tt 
ifxx 
(xx 
m_fXmlNodeMsgxx !
.xx! "
namexx" &
!=xx' )
FXmlSocketTagxx* 7
.xx7 8
	E_MESSAGExx8 A
)xxA B
{yy 
FDebugzz 
.zz 
throwFExceptionzz *
(zz* +
stringzz+ 1
.zz1 2
Formatzz2 8
(zz8 9

FConstantszz9 C
.zzC D

err_m_0016zzD N
,zzN O
$strzzP a
)zza b
)zzb c
;zzc d
}{{ 
xpath}} 
=}} 
FXmlSocketTag}} %
.}}% &
E_HEADER}}& .
+}}/ 0
$str}}1 4
+}}5 6
FXmlSocketTag}}7 D
.}}D E
E_MSG_ID}}E M
;}}M N
if~~ 
(~~ 
m_fXmlNodeMsg~~ !
.~~! "
selectSingleNode~~" 2
(~~2 3
xpath~~3 8
)~~8 9
==~~: <
null~~= A
)~~A B
{ 
FDebug
€€ 
.
€€ 
throwFException
€€ *
(
€€* +
string
€€+ 1
.
€€1 2
Format
€€2 8
(
€€8 9

FConstants
€€9 C
.
€€C D

err_m_0016
€€D N
,
€€N O
$str
€€P `
)
€€` a
)
€€a b
;
€€b c
}
 
xpath
ƒƒ 
=
ƒƒ 
FXmlSocketTag
ƒƒ %
.
ƒƒ% &
E_HEADER
ƒƒ& .
+
ƒƒ/ 0
$str
ƒƒ1 4
+
ƒƒ5 6
FXmlSocketTag
ƒƒ7 D
.
ƒƒD E

E_EQUIP_ID
ƒƒE O
;
ƒƒO P
if
„„ 
(
„„ 
m_fXmlNodeMsg
„„ !
.
„„! "
selectSingleNode
„„" 2
(
„„2 3
xpath
„„3 8
)
„„8 9
==
„„: <
null
„„= A
)
„„A B
{
…… 
FDebug
†† 
.
†† 
throwFException
†† *
(
††* +
string
††+ 1
.
††1 2
Format
††2 8
(
††8 9

FConstants
††9 C
.
††C D

err_m_0016
††D N
,
††N O
$str
††P b
)
††b c
)
††c d
;
††d e
}
‡‡ 
}
ˆˆ 
catch
‰‰ 
(
‰‰ 
	Exception
‰‰ 
ex
‰‰ 
)
‰‰  
{
ŠŠ 
FDebug
‹‹ 
.
‹‹ 
throwException
‹‹ %
(
‹‹% &
ex
‹‹& (
)
‹‹( )
;
‹‹) *
}
ŒŒ 
finally
 
{
 
}
 
}
‘‘ 	
public
•• 
void
•• 
getDataMessage
•• "
(
••" #
FXmlNode
–– 
fXmlNodeMsg
––  
)
—— 
{
˜˜ 	
try
™™ 
{
šš 
m_fXmlNodeMsg
›› 
=
›› 
fXmlNodeMsg
››  +
;
››+ ,
m_xml
œœ 
=
œœ 
m_fXmlNodeMsg
œœ %
.
œœ% &
xmlToString
œœ& 1
(
œœ1 2
true
œœ2 6
)
œœ6 7
;
œœ7 8
validate
 
(
 
)
 
;
 
}
ŸŸ 
catch
   
(
   
	Exception
   
ex
   
)
    
{
¡¡ 
FDebug
¢¢ 
.
¢¢ 
throwException
¢¢ %
(
¢¢% &
ex
¢¢& (
)
¢¢( )
;
¢¢) *
}
££ 
finally
¤¤ 
{
¥¥ 
}
§§ 
}
¨¨ 	
internal
¬¬ 
byte
¬¬ 
[
¬¬ 
]
¬¬ 
getBinaryData
¬¬ %
(
¬¬% &
)
­­ 
{
®® 	
byte
¯¯ 
[
¯¯ 
]
¯¯ 
btEtx
¯¯ 
=
¯¯ 
new
¯¯ 
byte
¯¯ #
[
¯¯# $
]
¯¯$ %
{
¯¯& '
$num
¯¯( ,
,
¯¯, -
$num
¯¯. 2
}
¯¯3 4
;
¯¯4 5
	ArrayList
°° 
bin
°° 
=
°° 
null
°°  
;
°°  !
try
²² 
{
³³ 
bin
´´ 
=
´´ 
new
´´ 
	ArrayList
´´ #
(
´´# $
)
´´$ %
;
´´% &
bin
µµ 
.
µµ 
AddRange
µµ 
(
µµ 
Encoding
µµ %
.
µµ% &
Default
µµ& -
.
µµ- .
GetBytes
µµ. 6
(
µµ6 7
m_xml
µµ7 <
)
µµ< =
)
µµ= >
;
µµ> ?
bin
¶¶ 
.
¶¶ 
AddRange
¶¶ 
(
¶¶ 
btEtx
¶¶ "
)
¶¶" #
;
¶¶# $
return
¸¸ 
(
¸¸ 
byte
¸¸ 
[
¸¸ 
]
¸¸ 
)
¸¸ 
bin
¸¸ "
.
¸¸" #
ToArray
¸¸# *
(
¸¸* +
typeof
¸¸+ 1
(
¸¸1 2
byte
¸¸2 6
)
¸¸6 7
)
¸¸7 8
;
¸¸8 9
}
¹¹ 
catch
ºº 
(
ºº 
	Exception
ºº 
ex
ºº 
)
ºº  
{
»» 
FDebug
¼¼ 
.
¼¼ 
throwException
¼¼ %
(
¼¼% &
ex
¼¼& (
)
¼¼( )
;
¼¼) *
}
½½ 
finally
¾¾ 
{
¿¿ 
}
ÁÁ 
return
ÂÂ 
null
ÂÂ 
;
ÂÂ 
}
ÃÃ 	
internal
ÇÇ 
FSocketSendData
ÇÇ  
getSerialData
ÇÇ! .
(
ÇÇ. /
)
ÈÈ 
{
ÉÉ 	
try
ÊÊ 
{
ËË 
return
ÌÌ 
new
ÌÌ 
FSocketSendData
ÌÌ *
(
ÌÌ* +
getBinaryData
ÍÍ !
(
ÍÍ! "
)
ÍÍ" #
)
ÎÎ 
;
ÎÎ 
}
ÏÏ 
catch
ĞĞ 
(
ĞĞ 
	Exception
ĞĞ 
ex
ĞĞ 
)
ĞĞ  
{
ÑÑ 
FDebug
ÒÒ 
.
ÒÒ 
throwException
ÒÒ %
(
ÒÒ% &
ex
ÒÒ& (
)
ÒÒ( )
;
ÒÒ) *
}
ÓÓ 
finally
ÔÔ 
{
ÕÕ 
}
×× 
return
ØØ 
null
ØØ 
;
ØØ 
}
ÙÙ 	
}
ßß 
}àà 