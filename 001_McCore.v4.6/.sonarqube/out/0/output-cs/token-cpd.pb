«‡
VD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Common\e_FEnum.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

enum 
FDebugLogCategory !
:" #
int$ '
{ 
Information 
, 

FException 
, 
	Exception 
} 
public"" 

enum"" 
FDbProvider"" 
:"" 
int"" !
{## 
MsSqlServer$$ 
,$$ 
Oracle%% 
,%% 
OracleEx&& 
,&& 
MySql'' 
,'' 
MariaDb(( 
,(( 

PostgreSql)) 
}** 
public.. 

enum.. 
FSqlErrorType.. 
:.. 
int..  #
{// 
Normal00 
,00 
Warning11 
,11 
Critical22 
}33 
public77 

enum77 
FDmlType77 
:77 
int77 
{88 
Select99 
,99 
Insert:: 
,:: 
Update;; 
,;; 
Delete<< 
,<< 
Unknown== 
}>> 
publicBB 

enumBB 
FSocketTypeBB 
:BB 
intBB !
{CC 
ListenerDD 
,DD 
ClientEE 
}FF 
internalJJ 
enumJJ 
FSocketEventIdJJ  
:JJ! "
intJJ# &
{KK 
NoneLL 
,LL &
TcpListenerAcceptCompletedNN "
,NN" #"
TcpListenerErrorRaisedOO 
,OO !
TcpClientStateChangedQQ 
,QQ !
TcpClientDataReceivedRR 
,RR 
TcpClientDataSentSS 
,SS #
TcpClientDataSendFailedTT 
,TT   
TcpClientErrorRaisedUU 
}VV 
publicZZ 

enumZZ 
FTcpClientModeZZ 
:ZZ  
intZZ! $
{[[ 
Server\\ 
,\\ 
Client]] 
}^^ 
publicbb 

enumbb 
FTcpClientStatebb 
:bb  !
intbb" %
{cc 
Openeddd 
,dd 
	Connectedee 
,ee 
Closedff 
}gg 
publickk 

enumkk 
FVolumnOptionkk 
:kk 
intkk  #
{ll 
Automm 
,mm 
Bytenn 
,nn 
KiloByteoo 
,oo 
MegaBytepp 
,pp 
GigaByteqq 
,qq 
TeraByterr 
}ss 
publicww 

enumww 
	FPipeTypeww 
:ww 
intww 
{xx 
Serveryy 
,yy 
Clientzz 
}{{ 
public 

enum 

FPipeState 
: 
int  
{
€€ 
Closed
 
,
 
Opened
‚‚ 
,
‚‚ 
	Connected
ƒƒ 
}
„„ 
internal
ˆˆ 
enum
ˆˆ 
FPipeEventId
ˆˆ 
:
ˆˆ  
int
ˆˆ! $
{
‰‰ 
None
ŠŠ 
,
ŠŠ 
PipeStateChanged
ŒŒ 
,
ŒŒ 
PipeDataReceived
 
,
 
PipeDataSent
 
,
  
PipeDataSendFailed
 
,
 
PipeErrorRaised
 
}
‘‘ 
public
•• 

enum
•• 
FSerialState
•• 
:
•• 
int
•• "
{
–– 
Closed
—— 
,
—— 
Opened
˜˜ 
}
™™ 
public
 

enum
 
FSerialType
 
:
 
int
  
{
 
Active
ŸŸ 
,
ŸŸ 
Passive
   
}
¡¡ 
internal
¥¥ 
enum
¥¥ 
FSerialEventId
¥¥  
:
¥¥! "
int
¥¥# &
{
¦¦ 
None
§§ 
,
§§  
SerialStateChanged
©© 
,
©©  
SerialDataReceived
ªª 
,
ªª 
SerialDataSent
«« 
,
«« "
SerialDataSendFailed
¬¬ 
,
¬¬ 
SerialErrorRaised
­­ 
}
®® 
public
²² 

enum
²² #
FServiceTraceCategory
²² %
:
²²& '
int
²²( +
{
³³ 
Information
´´ 
,
´´ 
Warning
µµ 
,
µµ 
Error
¶¶ 
}
·· 
public
»» 

enum
»» !
FServiceLogCategory
»» #
:
»»$ %
int
»»& )
{
¼¼ 
Information
½½ 
,
½½ 
Warning
¾¾ 
,
¾¾ 
Error
¿¿ 
}
ÀÀ 
public
ÄÄ 

enum
ÄÄ 
FH101StationMode
ÄÄ  
:
ÄÄ! "
int
ÄÄ# &
{
ÅÅ 
Inner
ÆÆ 
,
ÆÆ 
Inter
ÇÇ 
}
ÈÈ 
public
ÌÌ 

enum
ÌÌ 
FH101DeliveryType
ÌÌ !
:
ÌÌ" #
int
ÌÌ$ '
{
ÍÍ 
Request
ÎÎ 
,
ÎÎ 
Reply
ÏÏ 
,
ÏÏ 
Unicast
ĞĞ 
,
ĞĞ 
GuaranteedUnicast
ÑÑ 
,
ÑÑ 
	Mulitcast
ÒÒ 
,
ÒÒ !
GuaranteedMulticast
ÓÓ 
}
ÔÔ 
public
ØØ 

enum
ØØ 
FBoolean
ØØ 
:
ØØ 
int
ØØ 
{
ÙÙ 
False
ÚÚ 
=
ÚÚ 
$num
ÚÚ 
,
ÚÚ 
True
ÛÛ 
=
ÛÛ 
$num
ÛÛ 
}
ÜÜ 
public
àà 

enum
àà 
FYesNo
àà 
{
áá 
No
ââ 

=
ââ 
$num
ââ 
,
ââ 
Yes
ãã 
=
ãã 
$num
ãã 
,
ãã 
}
ää 
internal
èè 
enum
èè 
FTelnetEventId
èè  
:
èè! "
int
èè# &
{
éé 
None
êê 
,
êê  
TelnetStateChanged
ìì 
,
ìì "
TelnetPacketReceived
íí 
,
íí 
TelnetPacketSent
îî 
}
ïï 
public
óó 

static
óó 
class
óó 

FAsciiByte
óó "
{
ôô 
public
õõ 
const
õõ 
byte
õõ 
NUL
õõ 
=
õõ 
$num
õõ  !
;
õõ! "
public
öö 
const
öö 
byte
öö 
BEL
öö 
=
öö 
$num
öö  !
;
öö! "
public
÷÷ 
const
÷÷ 
byte
÷÷ 
BS
÷÷ 
=
÷÷ 
$num
÷÷  
;
÷÷  !
public
øø 
const
øø 
byte
øø 
HT
øø 
=
øø 
$num
øø  
;
øø  !
public
ùù 
const
ùù 
byte
ùù 
LF
ùù 
=
ùù 
$num
ùù !
;
ùù! "
public
úú 
const
úú 
byte
úú 
VT
úú 
=
úú 
$num
úú !
;
úú! "
public
ûû 
const
ûû 
byte
ûû 
FF
ûû 
=
ûû 
$num
ûû !
;
ûû! "
public
üü 
const
üü 
byte
üü 
CR
üü 
=
üü 
$num
üü !
;
üü! "
public
ıı 
const
ıı 
byte
ıı 
SP
ıı 
=
ıı 
$num
ıı !
;
ıı! "
}
şş 
public
‚‚ 

enum
‚‚  
FTelnetParserState
‚‚ "
:
‚‚# $
int
‚‚% (
{
ƒƒ 
Data
„„ 
,
„„ $
ReceivedCarriageReturn
…… 
,
…… 
ReceivedIAC
†† 
,
†† 

ReceivedDo
‡‡ 
,
‡‡ 
ReceivedDont
ˆˆ 
,
ˆˆ 
ReceivedWill
‰‰ 
,
‰‰ 
ReceivedWont
ŠŠ 
}
‹‹ 
public
 

enum
 
FTelnetPacketType
 !
{
 
Data
‘‘ 
,
‘‘ 
Command
’’ 
,
’’ 
Option
““ 
,
““ 
Subnegotiation
”” 
}
•• 
public
™™ 

enum
™™ 
FTelnetCommand
™™ 
:
™™  
byte
™™! %
{
šš 
EndSubnegotiation
›› 
=
›› 
$num
›› 
,
››  
NoOperation
œœ 
=
œœ 
$num
œœ 
,
œœ 
DataMark
 
=
 
$num
 
,
 
Break
 
=
 
$num
 
,
 
InterruptProcess
ŸŸ 
=
ŸŸ 
$num
ŸŸ 
,
ŸŸ 
AbortOutput
   
=
   
$num
   
,
   
AreYouThere
¡¡ 
=
¡¡ 
$num
¡¡ 
,
¡¡ 
EraseCharacter
¢¢ 
=
¢¢ 
$num
¢¢ 
,
¢¢ 
	EraseLine
££ 
=
££ 
$num
££ 
,
££ 
GoAhead
¤¤ 
=
¤¤ 
$num
¤¤ 
,
¤¤ 
Subnegotiation
¥¥ 
=
¥¥ 
$num
¥¥ 
,
¥¥ 
Will
§§ 
=
§§ 
$num
§§ 
,
§§ 
Wont
¨¨ 
=
¨¨ 
$num
¨¨ 
,
¨¨ 
Do
©© 

=
©© 
$num
©© 
,
©© 
Dont
ªª 
=
ªª 
$num
ªª 
,
ªª 
Iac
¬¬ 
=
¬¬ 
$num
¬¬ 
}
­­ 
public
±± 

enum
±± 
FTelnetOption
±± 
:
±± 
byte
±±  $
{
²² 
TransmitBinary
·· 
=
·· 
$num
·· 
,
·· 
Echo
¸¸ 
=
¸¸ 
$num
¸¸ 
,
¸¸ 
Reconnection
¹¹ 
=
¹¹ 
$num
¹¹ 
,
¹¹ 
SuppressGoAhead
ºº 
=
ºº 
$num
ºº 
,
ºº /
!ApproximateMessageSizeNegotiation
»» )
=
»»* +
$num
»», -
,
»»- .
Status
¼¼ 
=
¼¼ 
$num
¼¼ 
,
¼¼ 

TimingMark
½½ 
=
½½ 
$num
½½ 
,
½½ 
Rcte
¾¾ 
=
¾¾ 
$num
¾¾ 
,
¾¾ 
OutputLineWidth
¿¿ 
=
¿¿ 
$num
¿¿ 
,
¿¿ 
OutputPageSize
ÀÀ 
=
ÀÀ 
$num
ÀÀ 
,
ÀÀ -
OutputCarriageReturnDisposition
ÁÁ '
=
ÁÁ( )
$num
ÁÁ* ,
,
ÁÁ, -&
OutputHorizontalTabStops
ÂÂ  
=
ÂÂ! "
$num
ÂÂ# %
,
ÂÂ% &,
OutputHorizontalTabDisposition
ÃÃ &
=
ÃÃ' (
$num
ÃÃ) +
,
ÃÃ+ ,'
OutputFormfeedDisposition
ÄÄ !
=
ÄÄ" #
$num
ÄÄ$ &
,
ÄÄ& '$
OutputVerticalTabStops
ÅÅ 
=
ÅÅ  
$num
ÅÅ! #
,
ÅÅ# $*
OutputVerticalTabDisposition
ÆÆ $
=
ÆÆ% &
$num
ÆÆ' )
,
ÆÆ) *'
OutputLinefeedDisposition
ÇÇ !
=
ÇÇ" #
$num
ÇÇ$ &
,
ÇÇ& '
ExtendedAscii
ÈÈ 
=
ÈÈ 
$num
ÈÈ 
,
ÈÈ 
Logout
ÉÉ 
=
ÉÉ 
$num
ÉÉ 
,
ÉÉ 
	ByteMacro
ÊÊ 
=
ÊÊ 
$num
ÊÊ 
,
ÊÊ 
DataEntryTerminal
ËË 
=
ËË 
$num
ËË 
,
ËË 
SUPDUP
ÌÌ 
=
ÌÌ 
$num
ÌÌ 
,
ÌÌ 
SupdupOutput
ÍÍ 
=
ÍÍ 
$num
ÍÍ 
,
ÍÍ 
SendLocation
ÎÎ 
=
ÎÎ 
$num
ÎÎ 
,
ÎÎ 
TerminalType
ÏÏ 
=
ÏÏ 
$num
ÏÏ 
,
ÏÏ 
EndOfRecord
ĞĞ 
=
ĞĞ 
$num
ĞĞ 
,
ĞĞ 
TacacsUserId
ÑÑ 
=
ÑÑ 
$num
ÑÑ 
,
ÑÑ 
OutputMarking
ÒÒ 
=
ÒÒ 
$num
ÒÒ 
,
ÒÒ 
TerminalLocation
ÓÓ 
=
ÓÓ 
$num
ÓÓ 
,
ÓÓ 
Ibm3270Regime
ÔÔ 
=
ÔÔ 
$num
ÔÔ 
,
ÔÔ 
X3Pad
ÕÕ 
=
ÕÕ 
$num
ÕÕ 
,
ÕÕ 
NAWS
ÖÖ 
=
ÖÖ 
$num
ÖÖ 
,
ÖÖ 
TerminalSpeed
×× 
=
×× 
$num
×× 
,
×× 
ToggleFlowControl
ØØ 
=
ØØ 
$num
ØØ 
,
ØØ 
LineMode
ÙÙ 
=
ÙÙ 
$num
ÙÙ 
,
ÙÙ 
XDisplayLocation
ÚÚ 
=
ÚÚ 
$num
ÚÚ 
,
ÚÚ 
Environment
ÛÛ 
=
ÛÛ 
$num
ÛÛ 
,
ÛÛ 
Authentication
ÜÜ 
=
ÜÜ 
$num
ÜÜ 
,
ÜÜ 

Encryption
İİ 
=
İİ 
$num
İİ 
,
İİ 
NewEnvironment
ŞŞ 
=
ŞŞ 
$num
ŞŞ 
,
ŞŞ 
TN3270E
ßß 
=
ßß 
$num
ßß 
,
ßß 
XAUTH
àà 
=
àà 
$num
àà 
,
àà 
CharacterSet
áá 
=
áá 
$num
áá 
,
áá 
RemoteSerialPort
ââ 
=
ââ 
$num
ââ 
,
ââ 
ComPort
ãã 
=
ãã 
$num
ãã 
,
ãã 
SuppressLocalEcho
ää 
=
ää 
$num
ää 
,
ää 
StartTLS
åå 
=
åå 
$num
åå 
,
åå 
Kermit
ææ 
=
ææ 
$num
ææ 
,
ææ 
SendUrl
çç 
=
çç 
$num
çç 
,
çç 
ForwardX
èè 
=
èè 
$num
èè 
,
èè 
TeloptPragmaLogon
êê 
=
êê 
$num
êê 
,
êê  
TeloptSspiLogon
ëë 
=
ëë 
$num
ëë 
,
ëë #
TeloptPragmaHeartBeat
ìì 
=
ìì 
$num
ìì  #
,
ìì# $!
ExtendedOptionsList
îî 
=
îî 
$num
îî !
}
ïï 
public
óó 

enum
óó 
FTelnetPosition
óó 
:
óó  !
byte
óó" &
{
ôô 
Local
õõ 
=
õõ 
$num
õõ 
,
õõ 
Remote
öö 
=
öö 
$num
öö 
}
÷÷ 
public
ûû 

enum
ûû  
FTelnetOptionState
ûû "
:
ûû# $
byte
ûû% )
{
üü 
Off
ıı 
=
ıı 
$num
ıı 
,
ıı 
On
şş 

=
şş 
$num
şş 
}
ÿÿ 
public
ƒƒ 

enum
ƒƒ 
FOsGroup
ƒƒ 
{
„„ 

XpAndBelow
…… 
,
…… 
VistaAndAbove
†† 
,
†† 
UnKnown
‡‡ 
}
ˆˆ 
public
ŒŒ 

enum
ŒŒ 
FDbType
ŒŒ 
{
 
Int16
 
,
 
Int32
 
,
 
Int64
 
,
 
Double
’’ 
,
’’ 
Char
”” 
,
”” 
VarChar
•• 
,
•• 
NChar
–– 
,
–– 
NVarChar
—— 
,
—— 
	RefCursor
™™ 
}
šš 
public
 

enum
 
FOutputType
 
{
ŸŸ 
DataSet
   
,
   
String
¡¡ 
,
¡¡ 
Number
¢¢ 
}
££ 
public
§§ 

enum
§§ 
FXmlNodeType
§§ 
{
¨¨ 
None
©© 
=
©© 
$num
©© 
,
©© 
Element
ªª 
=
ªª 
$num
ªª 
,
ªª 
	Attribute
«« 
=
«« 
$num
«« 
,
«« 
Text
¬¬ 
=
¬¬ 
$num
¬¬ 
,
¬¬ 
CDATA
­­ 
=
­­ 
$num
­­ 
,
­­ 
EntityReference
®® 
=
®® 
$num
®® 
,
®® 
Entity
¯¯ 
=
¯¯ 
$num
¯¯ 
,
¯¯ #
ProcessingInstruction
°° 
=
°° 
$num
°°  !
,
°°! "
Comment
±± 
=
±± 
$num
±± 
,
±± 
Document
²² 
=
²² 
$num
²² 
,
²² 
DocumentType
³³ 
=
³³ 
$num
³³ 
,
³³ 
DocumentFragment
´´ 
=
´´ 
$num
´´ 
,
´´ 
Notation
µµ 
=
µµ 
$num
µµ 
,
µµ 

Whitespace
¶¶ 
=
¶¶ 
$num
¶¶ 
,
¶¶ #
SignificantWhitespace
·· 
=
·· 
$num
··  "
,
··" #

EndElement
¸¸ 
=
¸¸ 
$num
¸¸ 
,
¸¸ 
	EndEntity
¹¹ 
=
¹¹ 
$num
¹¹ 
,
¹¹ 
XmlDeclaration
ºº 
=
ºº 
$num
ºº 
,
ºº 
}
»» 
}¿¿ œ
pD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Comparer\c_FFileModifiedTimeDescComparer.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
class 	)
FFileModifiedTimeDescComparer
 '
:( )
	IComparer* 3
,3 4
IDisposable5 @
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
public )
FFileModifiedTimeDescComparer ,
(, -
) 
{   	
}"" 	
~&& 	)
FFileModifiedTimeDescComparer&&	 &
(&&& '
)'' 
{(( 	
	myDispose)) 
()) 
false)) 
))) 
;)) 
}** 	
private.. 
void.. 
	myDispose.. 
(.. 
bool// 
	disposing// 
)00 
{11 	
if22 
(22 
!22 

m_disposed22 
)22 
{33 
if44 
(44 
	disposing44 
)44 
{55 
}77 

m_disposed88 
=88 
true88 !
;88! "
}99 
}:: 	
publicBB 
voidBB 
DisposeBB 
(BB 
)CC 
{DD 	
	myDisposeEE 
(EE 
trueEE 
)EE 
;EE 
GCFF 
.FF 
SuppressFinalizeFF 
(FF  
thisFF  $
)FF$ %
;FF% &
}GG 	
publicUU 
intUU 
CompareUU 
(UU 
objectVV 
obj1VV 
,VV 
objectWW 
obj2WW 
)XX 
{YY 	
tryZZ 
{[[ 
if\\ 
(\\ 
(\\ 
(\\ 
FileInfo\\ 
)\\ 
obj1\\ #
)\\# $
.\\$ %
LastWriteTime\\% 2
.\\2 3
ToBinary\\3 ;
(\\; <
)\\< =
>\\> ?
(\\@ A
(\\A B
FileInfo\\B J
)\\J K
obj2\\K O
)\\O P
.\\P Q
LastWriteTime\\Q ^
.\\^ _
ToBinary\\_ g
(\\g h
)\\h i
)\\i j
{]] 
return^^ 
-^^ 
$num^^ 
;^^ 
}__ 
else`` 
if`` 
(`` 
(`` 
(`` 
FileInfo`` #
)``# $
obj1``$ (
)``( )
.``) *
LastWriteTime``* 7
.``7 8
ToBinary``8 @
(``@ A
)``A B
<``C D
(``E F
(``F G
FileInfo``G O
)``O P
obj2``P T
)``T U
.``U V
LastWriteTime``V c
.``c d
ToBinary``d l
(``l m
)``m n
)``n o
{aa 
returnbb 
$numbb 
;bb 
}cc 
returndd 
$numdd 
;dd 
}ee 
catchff 
(ff 
	Exceptionff 
exff 
)ff  
{gg 
FDebughh 
.hh 
throwExceptionhh %
(hh% &
exhh& (
)hh( )
;hh) *
}ii 
finallyjj 
{kk 
}mm 
returnnn 
$numnn 
;nn 
}oo 	
}uu 
}vv ”
oD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Comparer\c_FFileCreatedTimeDescComparer.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
class 	(
FFileCreatedTimeDescComparer
 &
:' (
	IComparer) 2
,2 3
IDisposable4 ?
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
public (
FFileCreatedTimeDescComparer +
(+ ,
) 
{   	
}"" 	
~&& 	(
FFileCreatedTimeDescComparer&&	 %
(&&% &
)'' 
{(( 	
	myDispose)) 
()) 
false)) 
))) 
;)) 
}** 	
private.. 
void.. 
	myDispose.. 
(.. 
bool// 
	disposing// 
)00 
{11 	
if22 
(22 
!22 

m_disposed22 
)22 
{33 
if44 
(44 
	disposing44 
)44 
{55 
}77 

m_disposed88 
=88 
true88 !
;88! "
}99 
}:: 	
publicBB 
voidBB 
DisposeBB 
(BB 
)CC 
{DD 	
	myDisposeEE 
(EE 
trueEE 
)EE 
;EE 
GCFF 
.FF 
SuppressFinalizeFF 
(FF  
thisFF  $
)FF$ %
;FF% &
}GG 	
publicUU 
intUU 
CompareUU 
(UU 
objectVV 
obj1VV 
,VV 
objectWW 
obj2WW 
)XX 
{YY 	
tryZZ 
{[[ 
if\\ 
(\\ 
(\\ 
(\\ 
FileInfo\\ 
)\\ 
obj1\\ #
)\\# $
.\\$ %
CreationTime\\% 1
.\\1 2
ToBinary\\2 :
(\\: ;
)\\; <
>\\= >
(\\? @
(\\@ A
FileInfo\\A I
)\\I J
obj2\\J N
)\\N O
.\\O P
CreationTime\\P \
.\\\ ]
ToBinary\\] e
(\\e f
)\\f g
)\\g h
{]] 
return^^ 
-^^ 
$num^^ 
;^^ 
}__ 
else`` 
if`` 
(`` 
(`` 
(`` 
FileInfo`` #
)``# $
obj1``$ (
)``( )
.``) *
CreationTime``* 6
.``6 7
ToBinary``7 ?
(``? @
)``@ A
<``B C
(``D E
(``E F
FileInfo``F N
)``N O
obj2``O S
)``S T
.``T U
CreationTime``U a
.``a b
ToBinary``b j
(``j k
)``k l
)``l m
{aa 
returnbb 
$numbb 
;bb 
}cc 
returndd 
$numdd 
;dd 
}ee 
catchff 
(ff 
	Exceptionff 
exff 
)ff  
{gg 
FDebughh 
.hh 
throwExceptionhh %
(hh% &
exhh& (
)hh( )
;hh) *
}ii 
finallyjj 
{kk 
}mm 
returnnn 
$numnn 
;nn 
}oo 	
}uu 
}vv Ğ
eD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Comparer\c_FDoubleAscComparer.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FDoubleAscComparer #
:$ %
	IComparer& /
,/ 0
IDisposable1 <
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
public 
FDoubleAscComparer !
(! "
) 
{ 	
}!! 	
~%% 	
FDoubleAscComparer%%	 
(%% 
)&& 
{'' 	
	myDispose(( 
((( 
false(( 
)(( 
;(( 
})) 	
private-- 
void-- 
	myDispose-- 
(-- 
bool.. 
	disposing.. 
)// 
{00 	
if11 
(11 
!11 

m_disposed11 
)11 
{22 
if33 
(33 
	disposing33 
)33 
{44 
}66 

m_disposed77 
=77 
true77 !
;77! "
}88 
}99 	
publicAA 
voidAA 
DisposeAA 
(AA 
)BB 
{CC 	
	myDisposeDD 
(DD 
trueDD 
)DD 
;DD 
GCEE 
.EE 
SuppressFinalizeEE 
(EE  
thisEE  $
)EE$ %
;EE% &
}FF 	
publicTT 
intTT 
CompareTT 
(TT 
objectUU 
obj1UU 
,UU 
objectVV 
obj2VV 
)WW 
{XX 	
tryYY 
{ZZ 
if[[ 
([[ 
([[ 
double[[ 
)[[ 
obj1[[  
>[[! "
([[# $
double[[$ *
)[[* +
obj2[[+ /
)[[/ 0
{\\ 
return]] 
-]] 
$num]] 
;]] 
}^^ 
else__ 
if__ 
(__ 
(__ 
double__  
)__  !
obj1__! %
<__& '
(__( )
double__) /
)__/ 0
obj2__0 4
)__4 5
{`` 
returnaa 
$numaa 
;aa 
}bb 
returncc 
$numcc 
;cc 
}dd 
catchee 
(ee 
	Exceptionee 
exee 
)ee  
{ff 
FDebuggg 
.gg 
throwExceptiongg %
(gg% &
exgg& (
)gg( )
;gg) *
}hh 
finallyii 
{jj 
}ll 
returnmm 
$nummm 
;mm 
}nn 	
}tt 
}uu Ô
fD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Comparer\c_FDoubleDescComparer.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FDoubleDescComparer $
:% &
	IComparer' 0
,0 1
IDisposable2 =
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
public 
FDoubleDescComparer "
(" #
) 
{ 	
}!! 	
~%% 	
FDoubleDescComparer%%	 
(%% 
)&& 
{'' 	
	myDispose(( 
((( 
false(( 
)(( 
;(( 
})) 	
private-- 
void-- 
	myDispose-- 
(-- 
bool.. 
	disposing.. 
)// 
{00 	
if11 
(11 
!11 

m_disposed11 
)11 
{22 
if33 
(33 
	disposing33 
)33 
{44 
}66 

m_disposed77 
=77 
true77 !
;77! "
}88 
}99 	
publicAA 
voidAA 
DisposeAA 
(AA 
)BB 
{CC 	
	myDisposeDD 
(DD 
trueDD 
)DD 
;DD 
GCEE 
.EE 
SuppressFinalizeEE 
(EE  
thisEE  $
)EE$ %
;EE% &
}FF 	
publicTT 
intTT 
CompareTT 
(TT 
objectUU 
obj1UU 
,UU 
objectVV 
obj2VV 
)WW 
{XX 	
tryYY 
{ZZ 
if[[ 
([[ 
([[ 
double[[ 
)[[ 
obj1[[  
>[[! "
([[# $
double[[$ *
)[[* +
obj2[[+ /
)[[/ 0
{\\ 
return]] 
$num]] 
;]] 
}^^ 
else__ 
if__ 
(__ 
(__ 
double__  
)__  !
obj1__! %
<__& '
(__( )
double__) /
)__/ 0
obj2__0 4
)__4 5
{`` 
returnaa 
-aa 
$numaa 
;aa 
}bb 
returncc 
$numcc 
;cc 
}dd 
catchee 
(ee 
	Exceptionee 
exee 
)ee  
{ff 
FDebuggg 
.gg 
throwExceptiongg %
(gg% &
exgg& (
)gg( )
;gg) *
}hh 
finallyii 
{jj 
}ll 
returnmm 
$nummm 
;mm 
}nn 	
}tt 
}uu ¤
nD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Comparer\c_FFileCreatedTimeAscComparer.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class '
FFileCreatedTimeAscComparer ,
:- .
	IComparer/ 8
,8 9
IDisposable: E
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
public '
FFileCreatedTimeAscComparer *
(* +
) 
{   	
}"" 	
~&& 	'
FFileCreatedTimeAscComparer&&	 $
(&&$ %
)'' 
{(( 	
	myDispose)) 
()) 
false)) 
))) 
;)) 
}** 	
private.. 
void.. 
	myDispose.. 
(.. 
bool// 
	disposing// 
)00 
{11 	
if22 
(22 
!22 

m_disposed22 
)22 
{33 
if44 
(44 
	disposing44 
)44 
{55 
}77 

m_disposed88 
=88 
true88 !
;88! "
}99 
}:: 	
publicBB 
voidBB 
DisposeBB 
(BB 
)CC 
{DD 	
	myDisposeEE 
(EE 
trueEE 
)EE 
;EE 
GCFF 
.FF 
SuppressFinalizeFF 
(FF  
thisFF  $
)FF$ %
;FF% &
}GG 	
publicUU 
intUU 
CompareUU 
(UU 
objectVV 
obj1VV 
,VV 
objectWW 
obj2WW 
)XX 
{YY 	
tryZZ 
{[[ 
if\\ 
(\\ 
(\\ 
(\\ 
FileInfo\\ 
)\\ 
obj1\\ #
)\\# $
.\\$ %
CreationTime\\% 1
.\\1 2
ToBinary\\2 :
(\\: ;
)\\; <
>\\= >
(\\? @
(\\@ A
FileInfo\\A I
)\\I J
obj2\\J N
)\\N O
.\\O P
CreationTime\\P \
.\\\ ]
ToBinary\\] e
(\\e f
)\\f g
)\\g h
{]] 
return^^ 
$num^^ 
;^^ 
}__ 
else`` 
if`` 
(`` 
(`` 
(`` 
FileInfo`` #
)``# $
obj1``$ (
)``( )
.``) *
CreationTime``* 6
.``6 7
ToBinary``7 ?
(``? @
)``@ A
<``B C
(``D E
(``E F
FileInfo``F N
)``N O
obj2``O S
)``S T
.``T U
CreationTime``U a
.``a b
ToBinary``b j
(``j k
)``k l
)``l m
{aa 
returnbb 
-bb 
$numbb 
;bb 
}cc 
returndd 
$numdd 
;dd 
}ee 
catchff 
(ff 
	Exceptionff 
exff 
)ff  
{gg 
FDebughh 
.hh 
throwExceptionhh %
(hh% &
exhh& (
)hh( )
;hh) *
}ii 
finallyjj 
{kk 
}mm 
returnnn 
$numnn 
;nn 
}oo 	
}uu 
}vv ˜
oD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Comparer\c_FFileModifiedTimeAscComparer.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
class 	(
FFileModifiedTimeAscComparer
 &
:' (
	IComparer) 2
,2 3
IDisposable4 ?
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
public (
FFileModifiedTimeAscComparer +
(+ ,
) 
{   	
}"" 	
~&& 	(
FFileModifiedTimeAscComparer&&	 %
(&&% &
)'' 
{(( 	
	myDispose)) 
()) 
false)) 
))) 
;)) 
}** 	
private.. 
void.. 
	myDispose.. 
(.. 
bool// 
	disposing// 
)00 
{11 	
if22 
(22 
!22 

m_disposed22 
)22 
{33 
if44 
(44 
	disposing44 
)44 
{55 
}77 

m_disposed88 
=88 
true88 !
;88! "
}99 
}:: 	
publicBB 
voidBB 
DisposeBB 
(BB 
)CC 
{DD 	
	myDisposeEE 
(EE 
trueEE 
)EE 
;EE 
GCFF 
.FF 
SuppressFinalizeFF 
(FF  
thisFF  $
)FF$ %
;FF% &
}GG 	
publicUU 
intUU 
CompareUU 
(UU 
objectVV 
obj1VV 
,VV 
objectWW 
obj2WW 
)XX 
{YY 	
tryZZ 
{[[ 
if\\ 
(\\ 
(\\ 
(\\ 
FileInfo\\ 
)\\ 
obj1\\ #
)\\# $
.\\$ %
LastWriteTime\\% 2
.\\2 3
ToBinary\\3 ;
(\\; <
)\\< =
>\\> ?
(\\@ A
(\\A B
FileInfo\\B J
)\\J K
obj2\\K O
)\\O P
.\\P Q
LastWriteTime\\Q ^
.\\^ _
ToBinary\\_ g
(\\g h
)\\h i
)\\i j
{]] 
return^^ 
$num^^ 
;^^ 
}__ 
else`` 
if`` 
(`` 
(`` 
(`` 
FileInfo`` #
)``# $
obj1``$ (
)``( )
.``) *
LastWriteTime``* 7
.``7 8
ToBinary``8 @
(``@ A
)``A B
<``C D
(``E F
(``F G
FileInfo``G O
)``O P
obj2``P T
)``T U
.``U V
LastWriteTime``V c
.``c d
ToBinary``d l
(``l m
)``m n
)``n o
{aa 
returnbb 
-bb 
$numbb 
;bb 
}cc 
returndd 
$numdd 
;dd 
}ee 
catchff 
(ff 
	Exceptionff 
exff 
)ff  
{gg 
FDebughh 
.hh 
throwExceptionhh %
(hh% &
exhh& (
)hh( )
;hh) *
}ii 
finallyjj 
{kk 
}mm 
returnnn 
$numnn 
;nn 
}oo 	
}uu 
}vv ¤
bD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Comparer\c_FIntAscComparer.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
class 	
FIntAscComparer
 
: 
	IComparer %
,% &
IDisposable' 2
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
public 
FIntAscComparer 
( 
) 
{ 	
}!! 	
~%% 	
FIntAscComparer%%	 
(%% 
)&& 
{'' 	
	myDispose(( 
((( 
false(( 
)(( 
;(( 
})) 	
private-- 
void-- 
	myDispose-- 
(-- 
bool.. 
	disposing.. 
)// 
{00 	
if11 
(11 
!11 

m_disposed11 
)11 
{22 
if33 
(33 
	disposing33 
)33 
{44 
}66 

m_disposed77 
=77 
true77 !
;77! "
}88 
}99 	
publicAA 
voidAA 
DisposeAA 
(AA 
)BB 
{CC 	
	myDisposeDD 
(DD 
trueDD 
)DD 
;DD 
GCEE 
.EE 
SuppressFinalizeEE 
(EE  
thisEE  $
)EE$ %
;EE% &
}FF 	
publicTT 
intTT 
CompareTT 
(TT 
objectUU 
obj1UU 
,UU 
objectVV 
obj2VV 
)WW 
{XX 	
tryYY 
{ZZ 
if[[ 
([[ 
([[ 
int[[ 
)[[ 
obj1[[ 
>[[ 
([[  !
int[[! $
)[[$ %
obj2[[% )
)[[) *
{\\ 
return]] 
$num]] 
;]] 
}^^ 
else__ 
if__ 
(__ 
(__ 
int__ 
)__ 
obj1__ "
<__# $
(__% &
int__& )
)__) *
obj2__* .
)__. /
{`` 
returnaa 
-aa 
$numaa 
;aa 
}bb 
returncc 
$numcc 
;cc 
}dd 
catchee 
(ee 
	Exceptionee 
exee 
)ee  
{ff 
FDebuggg 
.gg 
throwExceptiongg %
(gg% &
exgg& (
)gg( )
;gg) *
}hh 
finallyii 
{jj 
}ll 
returnmm 
$nummm 
;mm 
}nn 	
}tt 
}uu ¨
cD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Comparer\c_FIntDescComparer.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
class 	
FIntDescComparer
 
: 
	IComparer %
,% &
IDisposable' 2
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
public 
FIntDescComparer 
(  
) 
{ 	
}!! 	
~%% 	
FIntDescComparer%%	 
(%% 
)&& 
{'' 	
	myDispose(( 
((( 
false(( 
)(( 
;(( 
})) 	
private-- 
void-- 
	myDispose-- 
(-- 
bool.. 
	disposing.. 
)// 
{00 	
if11 
(11 
!11 

m_disposed11 
)11 
{22 
if33 
(33 
	disposing33 
)33 
{44 
}66 

m_disposed77 
=77 
true77 !
;77! "
}88 
}99 	
publicAA 
voidAA 
DisposeAA 
(AA 
)BB 
{CC 	
	myDisposeDD 
(DD 
trueDD 
)DD 
;DD 
GCEE 
.EE 
SuppressFinalizeEE 
(EE  
thisEE  $
)EE$ %
;EE% &
}FF 	
publicTT 
intTT 
CompareTT 
(TT 
objectUU 
obj1UU 
,UU 
objectVV 
obj2VV 
)WW 
{XX 	
tryYY 
{ZZ 
if[[ 
([[ 
([[ 
int[[ 
)[[ 
obj1[[ 
>[[ 
([[  !
int[[! $
)[[$ %
obj2[[% )
)[[) *
{\\ 
return]] 
-]] 
$num]] 
;]] 
}^^ 
else__ 
if__ 
(__ 
(__ 
int__ 
)__ 
obj1__ "
<__# $
(__% &
int__& )
)__) *
obj2__* .
)__. /
{`` 
returnaa 
$numaa 
;aa 
}bb 
returncc 
$numcc 
;cc 
}dd 
catchee 
(ee 
	Exceptionee 
exee 
)ee  
{ff 
FDebuggg 
.gg 
throwExceptiongg %
(gg% &
exgg& (
)gg( )
;gg) *
}hh 
finallyii 
{jj 
}ll 
returnmm 
$nummm 
;mm 
}nn 	
}tt 
}uu Ù
fD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Comparer\c_FStringDescComparer.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
class 	
FStringDescComparer
 
: 
	IComparer  )
,) *
IDisposable+ 6
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
public   
FStringDescComparer   "
(  " #
)!! 
{"" 	
}$$ 	
~(( 	
FStringDescComparer((	 
((( 
))) 
{** 	
	myDispose++ 
(++ 
false++ 
)++ 
;++ 
},, 	
private00 
void00 
	myDispose00 
(00 
bool11 
	disposing11 
)22 
{33 	
if44 
(44 
!44 

m_disposed44 
)44 
{55 
if66 
(66 
	disposing66 
)66 
{77 
}99 

m_disposed:: 
=:: 
true:: !
;::! "
};; 
}<< 	
publicDD 
voidDD 
DisposeDD 
(DD 
)EE 
{FF 	
	myDisposeGG 
(GG 
trueGG 
)GG 
;GG 
GCHH 
.HH 
SuppressFinalizeHH 
(HH  
thisHH  $
)HH$ %
;HH% &
}II 	
publicWW 
intWW 
CompareWW 
(WW 
objectXX 
obj1XX 
,XX 
objectYY 
obj2YY 
)ZZ 
{[[ 	
try\\ 
{]] 
return^^ 
-^^ 
String^^ 
.^^ 
Compare^^ &
(^^& '
(^^' (
string^^( .
)^^. /
obj1^^/ 3
,^^3 4
(^^5 6
string^^6 <
)^^< =
obj2^^= A
)^^A B
;^^B C
}__ 
catch`` 
(`` 
	Exception`` 
ex`` 
)``  
{aa 
FDebugbb 
.bb 
throwExceptionbb %
(bb% &
exbb& (
)bb( )
;bb) *
}cc 
finallydd 
{ee 
}gg 
returnhh 
$numhh 
;hh 
}ii 	
}oo 
}pp Æ
eD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Comparer\c_FStringAscComparer.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
class 	
FStringAscComparer
 
: 
	IComparer (
,( )
IDisposable* 5
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
public 
FStringAscComparer !
(! "
) 
{ 	
}!! 	
~%% 	
FStringAscComparer%%	 
(%% 
)&& 
{'' 	
	myDispose(( 
((( 
false(( 
)(( 
;(( 
})) 	
private-- 
void-- 
	myDispose-- 
(-- 
bool.. 
	disposing.. 
)// 
{00 	
if11 
(11 
!11 

m_disposed11 
)11 
{22 
if33 
(33 
	disposing33 
)33 
{44 
}66 

m_disposed77 
=77 
true77 !
;77! "
}88 
}99 	
publicAA 
voidAA 
DisposeAA 
(AA 
)BB 
{CC 	
	myDisposeDD 
(DD 
trueDD 
)DD 
;DD 
GCEE 
.EE 
SuppressFinalizeEE 
(EE  
thisEE  $
)EE$ %
;EE% &
}FF 	
publicTT 
intTT 
CompareTT 
(TT 
objectUU 
obj1UU 
,UU 
objectVV 
obj2VV 
)WW 
{XX 	
tryYY 
{ZZ 
return[[ 
String[[ 
.[[ 
Compare[[ %
([[% &
([[& '
string[[' -
)[[- .
obj1[[. 2
,[[2 3
([[4 5
string[[5 ;
)[[; <
obj2[[< @
)[[@ A
;[[A B
}\\ 
catch]] 
(]] 
	Exception]] 
ex]] 
)]]  
{^^ 
FDebug__ 
.__ 
throwException__ %
(__% &
ex__& (
)__( )
;__) *
}`` 
finallyaa 
{bb 
}dd 
returnee 
$numee 
;ee 
}ff 	
}ll 
}mm ²ò
\D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\c_FDbWizard.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
	FDbWizard 
: 
IDisposable (
{ 
private 
const 
int 
MAX_LEN !
=" #
$num$ +
;+ ,
private 
const 
char 
ROW_SEPARATOR (
=) *
(+ ,
char, 0
)0 1
$num1 5
;5 6
private 
const 
char 
COL_SEPARATOR (
=) *
(+ ,
char, 0
)0 1
$num1 5
;5 6
private!! 
bool!! 

m_disposed!! 
=!!  !
false!!" '
;!!' (
private## 
	FILicCore## 

m_fLicCore## $
=##% &
null##' +
;##+ ,
private$$ 
string$$ 
m_licenseFile$$ $
=$$% &
string$$' -
.$$- .
Empty$$. 3
;$$3 4
private%% 
string%% 
m_sqlCodeFileName%% (
=%%) *
string%%+ 1
.%%1 2
Empty%%2 7
;%%7 8
private&& 
string&& 
m_system&& 
=&&  !
string&&" (
.&&( )
Empty&&) .
;&&. /
private'' 
FDbProvider'' 
m_fDbProvider'' )
=''* +
FDbProvider'', 7
.''7 8
MsSqlServer''8 C
;''C D
private(( 
string(( 
m_connectString(( &
=((' (
string(() /
.((/ 0
Empty((0 5
;((5 6
private** 
FXmlDocument** 
m_fXmlDocSqlCode** -
=**. /
null**0 4
;**4 5
private++ 
FXmlNode++ 
m_fXmlNodeSystem++ )
=++* +
null++, 0
;++0 1
private,, 
FLicChecker,, 
m_fLicChecker,, )
=,,* +
null,,, 0
;,,0 1
public22 
	FDbWizard22 
(22 
string33 
sqlCodeFileName33 "
,33" #
string44 
system44 
,44 
FDbProvider55 
fDbProvider55 #
)66 
{77 	
m_sqlCodeFileName88 
=88 
sqlCodeFileName88  /
;88/ 0
m_system99 
=99 
system99 
;99 
m_fDbProvider:: 
=:: 
fDbProvider:: '
;::' (
init<< 
(<< 
)<< 
;<< 
}== 	
publicAA 
	FDbWizardAA 
(AA 
	FILicCoreBB 
fLicCoreBB 
,BB 
stringCC 
licFileCC 
,CC 
stringDD 
sqlCodeFileNameDD "
,DD" #
stringEE 
systemEE 
,EE 
FDbProviderFF 
fDbProviderFF #
,FF# $
stringGG 
connectStringGG  
)HH 
{II 	

m_fLicCoreJJ 
=JJ 
fLicCoreJJ !
;JJ! "
m_licenseFileKK 
=KK 
licFileKK #
;KK# $
m_sqlCodeFileNameLL 
=LL 
sqlCodeFileNameLL  /
;LL/ 0
m_systemMM 
=MM 
systemMM 
;MM 
m_fDbProviderNN 
=NN 
fDbProviderNN '
;NN' (
m_connectStringOO 
=OO 
connectStringOO +
;OO+ ,
initQQ 
(QQ 
)QQ 
;QQ 
}RR 	
~VV 	
	FDbWizardVV	 
(VV 
)WW 
{XX 	
	myDisposeYY 
(YY 
falseYY 
)YY 
;YY 
}ZZ 	
	protected^^ 
void^^ 
	myDispose^^  
(^^  !
bool__ 
	disposing__ 
)`` 
{aa 	
ifbb 
(bb 
!bb 

m_disposedbb 
)bb 
{cc 
ifdd 
(dd 
	disposingdd 
)dd 
{ee 
termff 
(ff 
)ff 
;ff 
}gg 

m_disposedii 
=ii 
trueii !
;ii! "
}jj 
}kk 	
publicss 
voidss 
Disposess 
(ss 
)tt 
{uu 	
	myDisposevv 
(vv 
truevv 
)vv 
;vv 
GCww 
.ww 
SuppressFinalizeww 
(ww  
thisww  $
)ww$ %
;ww% &
}xx 	
public
€€ 
string
€€ 
sqlCodeFileName
€€ %
{
 	
get
‚‚ 
{
ƒƒ 
try
„„ 
{
…… 
return
†† 
m_sqlCodeFileName
†† ,
;
††, -
}
‡‡ 
catch
ˆˆ 
(
ˆˆ 
	Exception
ˆˆ  
ex
ˆˆ! #
)
ˆˆ# $
{
‰‰ 
FDebug
ŠŠ 
.
ŠŠ 
throwException
ŠŠ )
(
ŠŠ) *
ex
ŠŠ* ,
)
ŠŠ, -
;
ŠŠ- .
}
‹‹ 
finally
ŒŒ 
{
 
}
 
return
 
string
 
.
 
Empty
 #
;
# $
}
‘‘ 
}
’’ 	
public
–– 
FDbProvider
–– 
fDbProvider
–– &
{
—— 	
get
˜˜ 
{
™™ 
try
šš 
{
›› 
return
œœ 
m_fDbProvider
œœ (
;
œœ( )
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
ŸŸ 
FDebug
   
.
   
throwException
   )
(
  ) *
ex
  * ,
)
  , -
;
  - .
}
¡¡ 
finally
¢¢ 
{
££ 
}
¥¥ 
return
¦¦ 
FDbProvider
¦¦ "
.
¦¦" #
MsSqlServer
¦¦# .
;
¦¦. /
}
§§ 
}
¨¨ 	
private
°° 
void
°° 
init
°° 
(
°° 
)
±± 
{
²² 	
string
³³ 
xpath
³³ 
=
³³ 
string
³³ !
.
³³! "
Empty
³³" '
;
³³' (
try
µµ 
{
¶¶ 
if
·· 
(
·· 
!
·· 
string
·· 
.
··  
IsNullOrWhiteSpace
·· .
(
··. /
m_licenseFile
··/ <
)
··< =
)
··= >
{
¸¸ 
m_fLicChecker
¹¹ !
=
¹¹" #
new
¹¹$ '
FLicChecker
¹¹( 3
(
¹¹3 4

m_fLicCore
¹¹4 >
,
¹¹> ?
m_licenseFile
¹¹@ M
,
¹¹M N
m_fDbProvider
¹¹O \
,
¹¹\ ]
m_connectString
¹¹^ m
)
¹¹m n
;
¹¹n o
}
ºº 
m_fXmlDocSqlCode
¾¾  
=
¾¾! "
new
¾¾# &
FXmlDocument
¾¾' 3
(
¾¾3 4
)
¾¾4 5
;
¾¾5 6
m_fXmlDocSqlCode
¿¿  
.
¿¿  ! 
preserveWhiteSpace
¿¿! 3
=
¿¿4 5
false
¿¿6 ;
;
¿¿; <
m_fXmlDocSqlCode
ÀÀ  
.
ÀÀ  !
load
ÀÀ! %
(
ÀÀ% &
m_sqlCodeFileName
ÀÀ& 7
)
ÀÀ7 8
;
ÀÀ8 9
xpath
ÂÂ 
=
ÂÂ 
FXmlTagFAMate
ÃÃ !
.
ÃÃ! "
E_FAMate
ÃÃ" *
+
ÃÃ+ ,
$str
ÄÄ 
+
ÄÄ 
FXmlTagSystem
ÄÄ '
.
ÄÄ' (
E_System
ÄÄ( 0
+
ÄÄ1 2
$str
ÄÄ3 7
+
ÄÄ8 9
FXmlTagSystem
ÄÄ: G
.
ÄÄG H
A_System
ÄÄH P
+
ÄÄQ R
$str
ÄÄS W
+
ÄÄX Y
m_system
ÄÄZ b
+
ÄÄc d
$str
ÄÄe i
;
ÄÄi j
m_fXmlNodeSystem
ÅÅ  
=
ÅÅ! "
m_fXmlDocSqlCode
ÅÅ# 3
.
ÅÅ3 4
selectSingleNode
ÅÅ4 D
(
ÅÅD E
xpath
ÅÅE J
)
ÅÅJ K
;
ÅÅK L
}
ÆÆ 
catch
ÇÇ 
(
ÇÇ 
	Exception
ÇÇ 
ex
ÇÇ 
)
ÇÇ  
{
ÈÈ 
FDebug
ÉÉ 
.
ÉÉ 
throwException
ÉÉ %
(
ÉÉ% &
ex
ÉÉ& (
)
ÉÉ( )
;
ÉÉ) *
}
ÊÊ 
finally
ËË 
{
ÌÌ 
}
ÎÎ 
}
ÏÏ 	
private
ÓÓ 
void
ÓÓ 
term
ÓÓ 
(
ÓÓ 
)
ÔÔ 
{
ÕÕ 	
try
ÖÖ 
{
×× 
if
ØØ 
(
ØØ 
m_fXmlNodeSystem
ØØ $
!=
ØØ% '
null
ØØ( ,
)
ØØ, -
{
ÙÙ 
m_fXmlNodeSystem
ÚÚ $
=
ÚÚ% &
null
ÚÚ' +
;
ÚÚ+ ,
}
ÛÛ 
if
İİ 
(
İİ 
m_fXmlDocSqlCode
İİ $
!=
İİ% '
null
İİ( ,
)
İİ, -
{
ŞŞ 
m_fXmlDocSqlCode
ßß $
.
ßß$ %
Dispose
ßß% ,
(
ßß, -
)
ßß- .
;
ßß. /
m_fXmlDocSqlCode
àà $
=
àà% &
null
àà' +
;
àà+ ,
}
áá 
if
ãã 
(
ãã 
m_fLicChecker
ãã !
!=
ãã" $
null
ãã% )
)
ãã) *
{
ää 
m_fLicChecker
åå !
.
åå! "
Dispose
åå" )
(
åå) *
)
åå* +
;
åå+ ,
m_fLicChecker
ææ !
=
ææ" #
null
ææ$ (
;
ææ( )
}
çç 
}
èè 
catch
éé 
(
éé 
	Exception
éé 
ex
éé 
)
éé  
{
êê 
FDebug
ëë 
.
ëë 
throwException
ëë %
(
ëë% &
ex
ëë& (
)
ëë( )
;
ëë) *
}
ìì 
finally
íí 
{
îî 
}
ğğ 
}
ññ 	
public
õõ 
FSql
õõ 
generateQuery
õõ !
(
õõ! "
string
öö 
module
öö 
,
öö 
string
÷÷ 
function
÷÷ 
,
÷÷ 
string
øø 
sqlCode
øø 
,
øø 
string
ùù 
sqlName
ùù 
)
úú 
{
ûû 	
FSql
üü 
fSql
üü 
=
üü 
null
üü 
;
üü 
FXmlNode
ıı 
fXmlNodeSql
ıı  
=
ıı! "
null
ıı# '
;
ıı' (
string
şş 
xpath
şş 
=
şş 
null
şş 
;
şş  
try
€€ 
{
 
xpath
‚‚ 
=
‚‚ 
FXmlTagModule
ƒƒ !
.
ƒƒ! "
E_Module
ƒƒ" *
+
ƒƒ+ ,
$str
ƒƒ- 1
+
ƒƒ2 3
FXmlTagModule
ƒƒ4 A
.
ƒƒA B
A_Module
ƒƒB J
+
ƒƒK L
$str
ƒƒM Q
+
ƒƒR S
module
ƒƒT Z
+
ƒƒ[ \
$str
ƒƒ] a
+
ƒƒb c
$str
„„ 
+
„„ 
FXmlTagFunction
„„ )
.
„„) *

E_Function
„„* 4
+
„„5 6
$str
„„7 ;
+
„„< =
FXmlTagFunction
„„> M
.
„„M N

A_Function
„„N X
+
„„Y Z
$str
„„[ _
+
„„` a
function
„„b j
+
„„k l
$str
„„m q
+
„„r s
$str
…… 
+
…… 
FXmlTagSqlCode
…… (
.
……( )
	E_SqlCode
……) 2
+
……3 4
$str
……5 9
+
……: ;
FXmlTagSqlCode
……< J
.
……J K
	A_SqlCode
……K T
+
……U V
$str
……W [
+
……\ ]
sqlCode
……^ e
+
……f g
$str
……h l
+
……m n
$str
†† 
+
†† 
FXmlTagSqlQuery
†† )
.
††) *

E_SqlQuery
††* 4
+
††5 6
$str
††7 ;
+
††< =
FXmlTagSqlQuery
††> M
.
††M N
A_DbProvider
††N Z
+
††[ \
$str
††] a
+
††b c
(
††d e
m_fDbProvider
††e r
==
††s u
FDbProvider††v 
.†† ‚
OracleEx††‚ Š
?††‹ Œ
FDbProvider†† ˜
.††˜ ™
Oracle††™ Ÿ
.††Ÿ  
ToString††  ¨
(††¨ ©
)††© ª
:††« ¬
m_fDbProvider††­ º
.††º »
ToString††» Ã
(††Ã Ä
)††Ä Å
)††Å Æ
+††Ç È
$str††É Í
;††Í Î
fXmlNodeSql
ˆˆ 
=
ˆˆ 
m_fXmlNodeSystem
ˆˆ .
.
ˆˆ. /
selectSingleNode
ˆˆ/ ?
(
ˆˆ@ A
xpath
ˆˆA F
)
ˆˆF G
;
ˆˆG H
if
ŒŒ 
(
ŒŒ 
fXmlNodeSql
ŒŒ 
==
ŒŒ  "
null
ŒŒ# '
)
ŒŒ' (
{
 
FDebug
 
.
 
throwFException
 *
(
* +
string
 
.
 
Format
 %
(
% &
$str
& x
,
x y
m_systemz ‚
,‚ ƒ
module„ Š
,Š ‹
functionŒ ”
,” •
sqlCode– 
) 
)
 
;
 
}
‘‘ 
if
•• 
(
•• 
sqlName
•• 
==
•• 
string
•• %
.
••% &
Empty
••& +
)
••+ ,
{
–– 
fSql
—— 
=
—— 
new
—— 
FSql
—— #
(
——# $
m_system
——$ ,
,
——, -
module
——. 4
,
——4 5
function
——6 >
,
——> ?
sqlCode
——@ G
)
——G H
;
——H I
}
˜˜ 
else
™™ 
{
šš 
fSql
›› 
=
›› 
new
›› 
FSql
›› #
(
››# $
sqlName
››$ +
,
››+ ,
m_system
››- 5
,
››5 6
module
››7 =
,
››= >
function
››? G
,
››G H
sqlCode
››I P
)
››P Q
;
››Q R
}
œœ 
fSql
 
.
 
sql
 
=
 
fXmlNodeSql
 &
.
& '
get_attrVal
' 2
(
2 3
FXmlTagSqlQuery
3 B
.
B C

A_SqlQuery
C M
,
M N
FXmlTagSqlQuery
O ^
.
^ _

D_SqlQuery
_ i
)
i j
;
j k
return
¡¡ 
fSql
¡¡ 
;
¡¡ 
}
¢¢ 
catch
££ 
(
££ 
	Exception
££ 
ex
££ 
)
££  
{
¤¤ 
FDebug
¥¥ 
.
¥¥ 
throwException
¥¥ %
(
¥¥% &
ex
¥¥& (
)
¥¥( )
;
¥¥) *
}
¦¦ 
finally
§§ 
{
¨¨ 
fXmlNodeSql
©© 
=
©© 
null
©© "
;
©©" #
}
ªª 
return
«« 
null
«« 
;
«« 
}
¬¬ 	
public
°° 
FSql
°° 
generateQuery
°° !
(
°°! "
string
±± 
module
±± 
,
±± 
string
²² 
function
²² 
,
²² 
string
³³ 
sqlCode
³³ 
)
´´ 
{
µµ 	
try
¶¶ 
{
·· 
return
¸¸ 
generateQuery
¸¸ %
(
¸¸% &
module
¸¸& ,
,
¸¸, -
function
¸¸. 6
,
¸¸6 7
sqlCode
¸¸8 ?
,
¸¸? @
string
¸¸A G
.
¸¸G H
Empty
¸¸H M
)
¸¸M N
;
¸¸N O
}
¹¹ 
catch
ºº 
(
ºº 
	Exception
ºº 
ex
ºº 
)
ºº  
{
»» 
FDebug
¼¼ 
.
¼¼ 
throwException
¼¼ %
(
¼¼% &
ex
¼¼& (
)
¼¼( )
;
¼¼) *
}
½½ 
finally
¾¾ 
{
¿¿ 
}
ÁÁ 
return
ÂÂ 
null
ÂÂ 
;
ÂÂ 
}
ÃÃ 	
public
ÇÇ 
static
ÇÇ 
string
ÇÇ %
dataTableToColumnString
ÇÇ 4
(
ÇÇ4 5
	DataTable
ÈÈ 
dt
ÈÈ 
)
ÉÉ 
{
ÊÊ 	
StringBuilder
ËË 
ret
ËË 
=
ËË 
null
ËË  $
;
ËË$ %
try
ÍÍ 
{
ÎÎ 
ret
ÏÏ 
=
ÏÏ 
new
ÏÏ 
StringBuilder
ÏÏ '
(
ÏÏ' (
)
ÏÏ( )
;
ÏÏ) *
foreach
ĞĞ 
(
ĞĞ 

DataColumn
ĞĞ #
dc
ĞĞ$ &
in
ĞĞ' )
dt
ĞĞ* ,
.
ĞĞ, -
Columns
ĞĞ- 4
)
ĞĞ4 5
{
ÑÑ 
ret
ÒÒ 
.
ÒÒ 
Append
ÒÒ 
(
ÒÒ 
dc
ÒÒ !
.
ÒÒ! "
Caption
ÒÒ" )
)
ÒÒ) *
;
ÒÒ* +
ret
ÓÓ 
.
ÓÓ 
Append
ÓÓ 
(
ÓÓ 
COL_SEPARATOR
ÓÓ ,
)
ÓÓ, -
;
ÓÓ- .
}
ÔÔ 
if
ØØ 
(
ØØ 
ret
ØØ 
.
ØØ 
Length
ØØ 
>
ØØ  
$num
ØØ! "
)
ØØ" #
{
ÙÙ 
ret
ÚÚ 
.
ÚÚ 
Remove
ÚÚ 
(
ÚÚ 
ret
ÚÚ "
.
ÚÚ" #
Length
ÚÚ# )
-
ÚÚ* +
$num
ÚÚ, -
,
ÚÚ- .
$num
ÚÚ/ 0
)
ÚÚ0 1
;
ÚÚ1 2
}
ÛÛ 
return
ÜÜ 
ret
ÜÜ 
.
ÜÜ 
ToString
ÜÜ #
(
ÜÜ# $
)
ÜÜ$ %
;
ÜÜ% &
}
İİ 
catch
ŞŞ 
(
ŞŞ 
	Exception
ŞŞ 
ex
ŞŞ 
)
ŞŞ  
{
ßß 
FDebug
àà 
.
àà 
throwException
àà %
(
àà% &
ex
àà& (
)
àà( )
;
àà) *
}
áá 
finally
ââ 
{
ãã 
}
åå 
return
ææ 
string
ææ 
.
ææ 
Empty
ææ 
;
ææ  
}
çç 	
public
ëë 
static
ëë 
string
ëë "
dataTableToRowString
ëë 1
(
ëë1 2
	DataTable
ìì 
dt
ìì 
,
ìì 
ref
íí 
int
íí 
rowCount
íí 
,
íí 
ref
îî 
int
îî 
nextRowNumber
îî !
)
ïï 
{
ğğ 	
try
ññ 
{
òò 
return
óó "
dataTableToRowString
óó +
(
óó+ ,
dt
óó, .
,
óó. /
ref
óó0 3
rowCount
óó4 <
,
óó< =
ref
óó> A
nextRowNumber
óóB O
,
óóO P
true
óóQ U
)
óóU V
;
óóV W
}
ôô 
catch
õõ 
(
õõ 
	Exception
õõ 
ex
õõ 
)
õõ  
{
öö 
FDebug
÷÷ 
.
÷÷ 
throwException
÷÷ %
(
÷÷% &
ex
÷÷& (
)
÷÷( )
;
÷÷) *
}
øø 
finally
ùù 
{
úú 
}
üü 
return
ıı 
string
ıı 
.
ıı 
Empty
ıı 
;
ıı  
}
şş 	
public
‚‚ 
static
‚‚ 
string
‚‚ "
dataTableToRowString
‚‚ 1
(
‚‚1 2
	DataTable
ƒƒ 
dt
ƒƒ 
,
ƒƒ 
ref
„„ 
int
„„ 
rowCount
„„ 
,
„„ 
ref
…… 
int
…… 
nextRowNumber
…… !
,
……! "
bool
†† 
isTrim
†† 
)
‡‡ 
{
ˆˆ 	
StringBuilder
‰‰ 
col
‰‰ 
=
‰‰ 
null
‰‰  $
;
‰‰$ %
StringBuilder
ŠŠ 
ret
ŠŠ 
=
ŠŠ 
null
ŠŠ  $
;
ŠŠ$ %
int
‹‹ 
retNextRowNumber
‹‹  
=
‹‹! "
$num
‹‹# $
;
‹‹$ %
try
 
{
 
col
 
=
 
new
 
StringBuilder
 '
(
' (
)
( )
;
) *
ret
 
=
 
new
 
StringBuilder
 '
(
' (
)
( )
;
) *
rowCount
‘‘ 
=
‘‘ 
$num
‘‘ 
;
‘‘ 
retNextRowNumber
’’  
=
’’! "
-
’’# $
$num
’’$ %
;
’’% &
for
–– 
(
–– 
int
–– 
i
–– 
=
–– 
nextRowNumber
–– *
;
––* +
i
––, -
<
––. /
dt
––0 2
.
––2 3
Rows
––3 7
.
––7 8
Count
––8 =
;
––= >
i
––? @
++
––@ B
)
––B C
{
—— 
col
˜˜ 
.
˜˜ 
Clear
˜˜ 
(
˜˜ 
)
˜˜ 
;
˜˜  
if
œœ 
(
œœ 
isTrim
œœ 
)
œœ 
{
 
for
 
(
 
int
  
j
! "
=
# $
$num
% &
;
& '
j
( )
<
* +
dt
, .
.
. /
Columns
/ 6
.
6 7
Count
7 <
;
< =
j
> ?
++
? A
)
A B
{
ŸŸ 
col
   
.
    
Append
    &
(
  & '
dt
  ' )
.
  ) *
Rows
  * .
[
  . /
i
  / 0
]
  0 1
[
  1 2
j
  2 3
]
  3 4
.
  4 5
ToString
  5 =
(
  = >
)
  > ?
.
  ? @
Trim
  @ D
(
  D E
)
  E F
)
  F G
;
  G H
col
¡¡ 
.
¡¡  
Append
¡¡  &
(
¡¡& '
COL_SEPARATOR
¡¡' 4
)
¡¡4 5
;
¡¡5 6
}
¢¢ 
}
££ 
else
¤¤ 
{
¥¥ 
for
¦¦ 
(
¦¦ 
int
¦¦  
j
¦¦! "
=
¦¦# $
$num
¦¦% &
;
¦¦& '
j
¦¦( )
<
¦¦* +
dt
¦¦, .
.
¦¦. /
Columns
¦¦/ 6
.
¦¦6 7
Count
¦¦7 <
;
¦¦< =
j
¦¦> ?
++
¦¦? A
)
¦¦A B
{
§§ 
col
¨¨ 
.
¨¨  
Append
¨¨  &
(
¨¨& '
dt
¨¨' )
.
¨¨) *
Rows
¨¨* .
[
¨¨. /
i
¨¨/ 0
]
¨¨0 1
[
¨¨1 2
j
¨¨2 3
]
¨¨3 4
.
¨¨4 5
ToString
¨¨5 =
(
¨¨= >
)
¨¨> ?
)
¨¨? @
;
¨¨@ A
col
©© 
.
©©  
Append
©©  &
(
©©& '
COL_SEPARATOR
©©' 4
)
©©4 5
;
©©5 6
}
ªª 
}
«« 
if
¯¯ 
(
¯¯ 
col
¯¯ 
.
¯¯ 
Length
¯¯ "
>
¯¯# $
$num
¯¯% &
)
¯¯& '
{
°° 
col
±± 
.
±± 
Remove
±± "
(
±±" #
col
±±# &
.
±±& '
Length
±±' -
-
±±. /
$num
±±0 1
,
±±1 2
$num
±±3 4
)
±±4 5
;
±±5 6
}
²² 
if
¶¶ 
(
¶¶ 
ret
¶¶ 
.
¶¶ 
Length
¶¶ "
+
¶¶# $
col
¶¶% (
.
¶¶( )
Length
¶¶) /
>
¶¶0 1
MAX_LEN
¶¶2 9
)
¶¶9 :
{
·· 
retNextRowNumber
¸¸ (
=
¸¸) *
i
¸¸+ ,
;
¸¸, -
break
¹¹ 
;
¹¹ 
}
ºº 
ret
¾¾ 
.
¾¾ 
Append
¾¾ 
(
¾¾ 
col
¾¾ "
.
¾¾" #
ToString
¾¾# +
(
¾¾+ ,
)
¾¾, -
)
¾¾- .
;
¾¾. /
ret
¿¿ 
.
¿¿ 
Append
¿¿ 
(
¿¿ 
ROW_SEPARATOR
¿¿ ,
)
¿¿, -
;
¿¿- .
rowCount
ÃÃ 
++
ÃÃ 
;
ÃÃ 
}
ÄÄ 
nextRowNumber
ÈÈ 
=
ÈÈ 
retNextRowNumber
ÈÈ  0
;
ÈÈ0 1
if
ÉÉ 
(
ÉÉ 
ret
ÉÉ 
.
ÉÉ 
Length
ÉÉ 
>
ÉÉ  
$num
ÉÉ! "
)
ÉÉ" #
{
ÊÊ 
ret
ËË 
.
ËË 
Remove
ËË 
(
ËË 
ret
ËË "
.
ËË" #
Length
ËË# )
-
ËË* +
$num
ËË, -
,
ËË- .
$num
ËË/ 0
)
ËË0 1
;
ËË1 2
}
ÌÌ 
return
ÍÍ 
ret
ÍÍ 
.
ÍÍ 
ToString
ÍÍ #
(
ÍÍ# $
)
ÍÍ$ %
;
ÍÍ% &
}
ÎÎ 
catch
ÏÏ 
(
ÏÏ 
	Exception
ÏÏ 
ex
ÏÏ 
)
ÏÏ  
{
ĞĞ 
FDebug
ÑÑ 
.
ÑÑ 
throwException
ÑÑ %
(
ÑÑ% &
ex
ÑÑ& (
)
ÑÑ( )
;
ÑÑ) *
}
ÒÒ 
finally
ÓÓ 
{
ÔÔ 
col
ÕÕ 
=
ÕÕ 
null
ÕÕ 
;
ÕÕ 
}
ÖÖ 
return
×× 
string
×× 
.
×× 
Empty
×× 
;
××  
}
ØØ 	
public
ÜÜ 
static
ÜÜ 
	DataTable
ÜÜ 
stringToDataTable
ÜÜ  1
(
ÜÜ1 2
string
İİ 
columns
İİ 
,
İİ 
string
ŞŞ 
rows
ŞŞ 
)
ßß 
{
àà 	
	DataTable
áá 
dt
áá 
=
áá 
null
áá 
;
áá  
string
ãã 
[
ãã 
]
ãã 
rowArray
ãã 
=
ãã 
null
ãã  $
;
ãã$ %
string
ää 
[
ää 
]
ää 
colArray
ää 
=
ää 
null
ää  $
;
ää$ %
try
ææ 
{
çç 
dt
èè 
=
èè 
new
èè 
	DataTable
èè "
(
èè" #
)
èè# $
;
èè$ %
colArray
ìì 
=
ìì 
columns
ìì "
.
ìì" #
Split
ìì# (
(
ìì( )
COL_SEPARATOR
ìì) 6
)
ìì6 7
;
ìì7 8
foreach
íí 
(
íí 
string
íí 
c
íí  !
in
íí" $
colArray
íí% -
)
íí- .
{
îî 
dt
ïï 
.
ïï 
Columns
ïï 
.
ïï 
Add
ïï "
(
ïï" #
c
ïï# $
)
ïï$ %
;
ïï% &
}
ğğ 
rowArray
ôô 
=
ôô 
rows
ôô 
.
ôô  
Split
ôô  %
(
ôô% &
new
ôô& )
char
ôô* .
[
ôô. /
]
ôô/ 0
{
ôô1 2
ROW_SEPARATOR
ôô3 @
}
ôôA B
,
ôôB C 
StringSplitOptions
ôôD V
.
ôôV W 
RemoveEmptyEntries
ôôW i
)
ôôi j
;
ôôj k
foreach
õõ 
(
õõ 
string
õõ 
r
õõ  !
in
õõ" $
rowArray
õõ% -
)
õõ- .
{
öö 
dt
÷÷ 
.
÷÷ 
Rows
÷÷ 
.
÷÷ 
Add
÷÷ 
(
÷÷  
r
÷÷  !
.
÷÷! "
Split
÷÷" '
(
÷÷' (
COL_SEPARATOR
÷÷( 5
)
÷÷5 6
)
÷÷6 7
;
÷÷7 8
}
øø 
return
üü 
dt
üü 
;
üü 
}
ıı 
catch
şş 
(
şş 
	Exception
şş 
ex
şş 
)
şş  
{
ÿÿ 
FDebug
€€ 
.
€€ 
throwException
€€ %
(
€€% &
ex
€€& (
)
€€( )
;
€€) *
}
 
finally
‚‚ 
{
ƒƒ 
}
…… 
return
†† 
null
†† 
;
†† 
}
‡‡ 	
public
‹‹ 
static
‹‹ 
	DataTable
‹‹ 
stringToDataTable
‹‹  1
(
‹‹1 2
string
ŒŒ 
rows
ŒŒ 
)
 
{
 	
	DataTable
 
dt
 
=
 
null
 
;
  
string
 
[
 
]
 
rowArray
 
=
 
null
  $
;
$ %
string
‘‘ 
[
‘‘ 
]
‘‘ 
colArray
‘‘ 
=
‘‘ 
null
‘‘  $
;
‘‘$ %
try
““ 
{
”” 
dt
•• 
=
•• 
new
•• 
	DataTable
•• "
(
••" #
)
••# $
;
••$ %
rowArray
™™ 
=
™™ 
rows
™™ 
.
™™  
Split
™™  %
(
™™% &
new
™™& )
char
™™* .
[
™™. /
]
™™/ 0
{
™™1 2
ROW_SEPARATOR
™™3 @
}
™™A B
,
™™B C 
StringSplitOptions
™™D V
.
™™V W 
RemoveEmptyEntries
™™W i
)
™™i j
;
™™j k
if
šš 
(
šš 
rowArray
šš 
.
šš 
Length
šš #
==
šš$ &
$num
šš' (
)
šš( )
{
›› 
return
œœ 
dt
œœ 
;
œœ 
}
 
colArray
¡¡ 
=
¡¡ 
rowArray
¡¡ #
[
¡¡# $
$num
¡¡$ %
]
¡¡% &
.
¡¡& '
Split
¡¡' ,
(
¡¡, -
COL_SEPARATOR
¡¡- :
)
¡¡: ;
;
¡¡; <
for
¢¢ 
(
¢¢ 
int
¢¢ 
i
¢¢ 
=
¢¢ 
$num
¢¢ 
;
¢¢ 
i
¢¢  !
<
¢¢" #
colArray
¢¢$ ,
.
¢¢, -
Length
¢¢- 3
;
¢¢3 4
i
¢¢5 6
++
¢¢6 8
)
¢¢8 9
{
££ 
dt
¤¤ 
.
¤¤ 
Columns
¤¤ 
.
¤¤ 
Add
¤¤ "
(
¤¤" #
i
¤¤# $
.
¤¤$ %
ToString
¤¤% -
(
¤¤- .
)
¤¤. /
)
¤¤/ 0
;
¤¤0 1
}
¥¥ 
foreach
©© 
(
©© 
string
©© 
r
©©  !
in
©©" $
rowArray
©©% -
)
©©- .
{
ªª 
dt
«« 
.
«« 
Rows
«« 
.
«« 
Add
«« 
(
««  
r
««  !
.
««! "
Split
««" '
(
««' (
COL_SEPARATOR
««( 5
)
««5 6
)
««6 7
;
««7 8
}
¬¬ 
return
°° 
dt
°° 
;
°° 
}
±± 
catch
²² 
(
²² 
	Exception
²² 
ex
²² 
)
²²  
{
³³ 
FDebug
´´ 
.
´´ 
throwException
´´ %
(
´´% &
ex
´´& (
)
´´( )
;
´´) *
}
µµ 
finally
¶¶ 
{
·· 
}
¹¹ 
return
ºº 
null
ºº 
;
ºº 
}
»» 	
}
ÁÁ 
}ÂÂ ¿ 
]D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\c_FProcedure.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 

FProcedure 
: 
IDisposable )
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
string 
	m_command  
=! "
string# )
.) *
Empty* /
;/ 0
private $
FProcParameterCollection (
m_fParameters) 6
=7 8
null9 =
;= >
public%% 

FProcedure%% 
(%% 
)&& 
{'' 	
m_fParameters(( 
=(( 
new(( $
FProcParameterCollection((  8
(((8 9
)((9 :
;((: ;
})) 	
public-- 

FProcedure-- 
(-- 
string.. 
command.. 
)// 
:00 
this00 
(00 
)00 
{11 	
	m_command22 
=22 
command22 
;22  
}33 	
~77 	

FProcedure77	 
(77 
)88 
{99 	
	myDispose:: 
(:: 
false:: 
):: 
;:: 
};; 	
	protected?? 
virtual?? 
void?? 
	myDispose?? (
(??( )
bool@@ 
	disposing@@ 
)AA 
{BB 	
ifCC 
(CC 
!CC 

m_disposedCC 
)CC 
{DD 
ifEE 
(EE 
	disposingEE 
)EE 
{FF 
m_fParametersGG !
=GG" #
nullGG$ (
;GG( )
}HH 
}II 

m_disposedJJ 
=JJ 
trueJJ 
;JJ 
}LL 	
publicTT 
voidTT 
DisposeTT 
(TT 
)UU 
{VV 	
	myDisposeWW 
(WW 
trueWW 
)WW 
;WW 
GCXX 
.XX 
SuppressFinalizeXX 
(XX  
thisXX  $
)XX$ %
;XX% &
}YY 	
publicaa 
stringaa 
commandaa 
{bb 	
getcc 
{dd 
tryee 
{ff 
returngg 
	m_commandgg $
;gg$ %
}hh 
catchii 
(ii 
	Exceptionii  
exii! #
)ii# $
{jj 
FDebugkk 
.kk 
throwExceptionkk &
(kk& '
exkk' )
)kk) *
;kk* +
}ll 
finallymm 
{nn 
}pp 
returnqq 
stringqq 
.qq 
Emptyqq #
;qq# $
}rr 
settt 
{uu 
tryvv 
{ww 
	m_commandxx 
=xx 
valuexx  %
;xx% &
}yy 
catchzz 
(zz 
	Exceptionzz  
exzz! #
)zz# $
{{{ 
FDebug|| 
.|| 
throwException|| )
(||) *
ex||* ,
)||, -
;||- .
}}} 
finally~~ 
{ 
}
 
}
‚‚ 
}
ƒƒ 	
public
‡‡ &
FProcParameterCollection
‡‡ '
fParameters
‡‡( 3
{
ˆˆ 	
get
‰‰ 
{
ŠŠ 
try
‹‹ 
{
ŒŒ 
return
 
m_fParameters
 (
;
( )
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
‘‘ 
.
‘‘ 
throwException
‘‘ &
(
‘‘& '
ex
‘‘' )
)
‘‘) *
;
‘‘* +
}
’’ 
finally
““ 
{
”” 
}
–– 
return
—— 
null
—— 
;
—— 
}
˜˜ 
}
™™ 	
}
ŸŸ 
}   ÈØ
aD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\c_FProcParameter.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FProcParameter 
:  !
IDisposable" -
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
string 
m_name 
= 
string  &
.& '
Empty' ,
;, -
private   
object   
m_value   
=    
DBNull  ! '
.  ' (
Value  ( -
;  - .
private!! 
FDbType!! 
	m_fDbType!! !
=!!" #
FDbType!!$ +
.!!+ ,
NVarChar!!, 4
;!!4 5
private"" 
ParameterDirection"" "
m_direction""# .
=""/ 0
ParameterDirection""1 C
.""C D
Input""D I
;""I J
private## 
int## 
m_size## 
=## 
$num## 
;## 
private%% 
string%% 
m_aliasName%% "
=%%# $
string%%% +
.%%+ ,
Empty%%, 1
;%%1 2
public++ 
FProcParameter++ 
(++ 
),, 
{-- 	
}// 	
public33 
FProcParameter33 
(33 
string44 
name44 
,44 
object55 
value55 
,55 
string66 
	aliasName66 
=66 
$str66 !
)77 
{88 	
m_name99 
=99 
name99 
;99 
m_value:: 
=:: 
value:: 
;:: 
m_aliasName;; 
=;; 
	aliasName;; #
;;;# $
}<< 	
public@@ 
FProcParameter@@ 
(@@ 
stringAA 
nameAA 
,AA 
FDbTypeBB 
fDbTypeBB 
,BB 
ParameterDirectionCC 
	directionCC (
,CC( )
stringDD 
	aliasNameDD 
=DD 
$strDD !
)EE 
:FF 
thisFF 
(FF 
nameFF 
,FF 
fDbTypeFF  
,FF  !
$numFF" #
,FF# $
nullFF% )
,FF) *
	directionFF+ 4
,FF4 5
	aliasNameFF6 ?
)FF? @
{GG 	
}II 	
publicMM 
FProcParameterMM 
(MM 
stringNN 
nameNN 
,NN 
FDbTypeOO 
fDbTypeOO 
,OO 
intPP 
sizePP 
,PP 
ParameterDirectionQQ 
	directionQQ (
,QQ( )
stringRR 
	aliasNameRR 
=RR 
$strRR !
)SS 
:TT 
thisTT 
(TT 
nameTT 
,TT 
fDbTypeTT  
,TT  !
sizeTT" &
,TT& '
nullTT( ,
,TT, -
	directionTT. 7
,TT7 8
	aliasNameTT9 B
)TTB C
{UU 	
}WW 	
public[[ 
FProcParameter[[ 
([[ 
string\\ 
name\\ 
,\\ 
FDbType]] 
fDbType]] 
,]] 
object^^ 
value^^ 
,^^ 
ParameterDirection__ 
	direction__ (
,__( )
string`` 
	aliasName`` 
=`` 
$str`` !
)aa 
:bb 
thisbb 
(bb 
namebb 
,bb 
fDbTypebb  
,bb  !
$numbb" #
,bb# $
valuebb% *
,bb* +
	directionbb, 5
,bb5 6
	aliasNamebb7 @
)bb@ A
{cc 	
}ee 	
publicii 
FProcParameterii 
(ii 
stringjj 
namejj 
,jj 
FDbTypekk 
fDbTypekk 
,kk 
intll 
sizell 
,ll 
objectmm 
valuemm 
,mm 
ParameterDirectionnn 
	directionnn (
,nn( )
stringoo 
	aliasNameoo 
=oo 
$stroo !
)pp 
{qq 	
m_namerr 
=rr 
namerr 
;rr 
	m_fDbTypess 
=ss 
fDbTypess 
;ss  
m_sizett 
=tt 
sizett 
;tt 
m_valueuu 
=uu 
valueuu 
;uu 
m_directionvv 
=vv 
	directionvv #
;vv# $
m_aliasNameww 
=ww 
	aliasNameww #
;ww# $
}xx 	
~|| 	
FProcParameter||	 
(|| 
)}} 
{~~ 	
	myDispose 
( 
false 
) 
; 
}
€€ 	
	protected
„„ 
virtual
„„ 
void
„„ 
	myDispose
„„ (
(
„„( )
bool
…… 
	disposing
…… 
)
†† 
{
‡‡ 	
if
ˆˆ 
(
ˆˆ 
!
ˆˆ 

m_disposed
ˆˆ 
)
ˆˆ 
{
‰‰ 
if
ŠŠ 
(
ŠŠ 
	disposing
ŠŠ 
)
ŠŠ 
{
‹‹ 
}
 
}
 

m_disposed
 
=
 
true
 
;
 
}
 	
public
˜˜ 
void
˜˜ 
Dispose
˜˜ 
(
˜˜ 
)
™™ 
{
šš 	
	myDispose
›› 
(
›› 
true
›› 
)
›› 
;
›› 
GC
œœ 
.
œœ 
SuppressFinalize
œœ 
(
œœ  
this
œœ  $
)
œœ$ %
;
œœ% &
}
 	
public
¥¥ 
string
¥¥ 
name
¥¥ 
{
¦¦ 	
get
§§ 
{
¨¨ 
try
©© 
{
ªª 
return
«« 
m_name
«« !
;
««! "
}
¬¬ 
catch
­­ 
(
­­ 
	Exception
­­  
ex
­­! #
)
­­# $
{
®® 
FDebug
¯¯ 
.
¯¯ 
throwException
¯¯ )
(
¯¯) *
ex
¯¯* ,
)
¯¯, -
;
¯¯- .
}
°° 
finally
±± 
{
²² 
}
´´ 
return
µµ 
string
µµ 
.
µµ 
Empty
µµ #
;
µµ# $
}
¶¶ 
set
¸¸ 
{
¹¹ 
try
ºº 
{
»» 
m_name
¼¼ 
=
¼¼ 
value
¼¼ "
;
¼¼" #
}
½½ 
catch
¾¾ 
(
¾¾ 
	Exception
¾¾  
ex
¾¾! #
)
¾¾# $
{
¿¿ 
FDebug
ÀÀ 
.
ÀÀ 
throwException
ÀÀ )
(
ÀÀ) *
ex
ÀÀ* ,
)
ÀÀ, -
;
ÀÀ- .
}
ÁÁ 
finally
ÂÂ 
{
ÃÃ 
}
ÅÅ 
}
ÆÆ 
}
ÇÇ 	
public
ËË 
bool
ËË 
isNull
ËË 
{
ÌÌ 	
get
ÍÍ 
{
ÎÎ 
try
ÏÏ 
{
ĞĞ 
return
ÑÑ 
value
ÑÑ  
==
ÑÑ! #
DBNull
ÑÑ$ *
.
ÑÑ* +
Value
ÑÑ+ 0
?
ÑÑ1 2
true
ÑÑ3 7
:
ÑÑ8 9
false
ÑÑ: ?
;
ÑÑ? @
}
ÒÒ 
catch
ÓÓ 
(
ÓÓ 
	Exception
ÓÓ  
ex
ÓÓ! #
)
ÓÓ# $
{
ÔÔ 
FDebug
ÕÕ 
.
ÕÕ 
throwException
ÕÕ )
(
ÕÕ) *
ex
ÕÕ* ,
)
ÕÕ, -
;
ÕÕ- .
}
ÖÖ 
finally
×× 
{
ØØ 
}
ÚÚ 
return
ÛÛ 
false
ÛÛ 
;
ÛÛ 
}
ÜÜ 
}
İİ 	
public
áá 
object
áá 
value
áá 
{
ââ 	
get
ãã 
{
ää 
try
åå 
{
ææ 
return
çç 
m_value
çç "
;
çç" #
}
èè 
catch
éé 
(
éé 
	Exception
éé  
ex
éé! #
)
éé# $
{
êê 
FDebug
ëë 
.
ëë 
throwException
ëë )
(
ëë) *
ex
ëë* ,
)
ëë, -
;
ëë- .
}
ìì 
finally
íí 
{
îî 
}
ğğ 
return
ññ 
null
ññ 
;
ññ 
}
òò 
set
ôô 
{
õõ 
try
öö 
{
÷÷ 
m_value
øø 
=
øø 
value
øø #
;
øø# $
}
ùù 
catch
úú 
(
úú 
	Exception
úú  
ex
úú! #
)
úú# $
{
ûû 
FDebug
üü 
.
üü 
throwException
üü )
(
üü) *
ex
üü* ,
)
üü, -
;
üü- .
}
ıı 
finally
şş 
{
ÿÿ 
}
 
}
‚‚ 
}
ƒƒ 	
public
‡‡ 
FDbType
‡‡ 
fDbType
‡‡ 
{
ˆˆ 	
get
‰‰ 
{
ŠŠ 
try
‹‹ 
{
ŒŒ 
return
 
	m_fDbType
 $
;
$ %
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
‘‘ 
.
‘‘ 
throwException
‘‘ )
(
‘‘) *
ex
‘‘* ,
)
‘‘, -
;
‘‘- .
}
’’ 
finally
““ 
{
”” 
}
–– 
return
—— 
FDbType
—— 
.
—— 
NVarChar
—— '
;
——' (
}
˜˜ 
set
šš 
{
›› 
try
œœ 
{
 
	m_fDbType
 
=
 
value
  %
;
% &
}
ŸŸ 
catch
   
(
   
	Exception
    
ex
  ! #
)
  # $
{
¡¡ 
FDebug
¢¢ 
.
¢¢ 
throwException
¢¢ )
(
¢¢) *
ex
¢¢* ,
)
¢¢, -
;
¢¢- .
}
££ 
finally
¤¤ 
{
¥¥ 
}
§§ 
}
¨¨ 
}
©© 	
public
­­  
ParameterDirection
­­ !
	direction
­­" +
{
®® 	
get
¯¯ 
{
°° 
try
±± 
{
²² 
return
³³ 
m_direction
³³ &
;
³³& '
}
´´ 
catch
µµ 
(
µµ 
	Exception
µµ  
ex
µµ! #
)
µµ# $
{
¶¶ 
FDebug
·· 
.
·· 
throwException
·· )
(
··) *
ex
··* ,
)
··, -
;
··- .
}
¸¸ 
finally
¹¹ 
{
ºº 
}
¼¼ 
return
½½  
ParameterDirection
½½ )
.
½½) *
Input
½½* /
;
½½/ 0
}
¾¾ 
set
ÀÀ 
{
ÁÁ 
try
ÂÂ 
{
ÃÃ 
m_direction
ÄÄ 
=
ÄÄ  !
value
ÄÄ" '
;
ÄÄ' (
}
ÅÅ 
catch
ÆÆ 
(
ÆÆ 
	Exception
ÆÆ  
ex
ÆÆ! #
)
ÆÆ# $
{
ÇÇ 
FDebug
ÈÈ 
.
ÈÈ 
throwException
ÈÈ )
(
ÈÈ) *
ex
ÈÈ* ,
)
ÈÈ, -
;
ÈÈ- .
}
ÉÉ 
finally
ÊÊ 
{
ËË 
}
ÍÍ 
}
ÎÎ 
}
ÏÏ 	
public
ÓÓ 
int
ÓÓ 
size
ÓÓ 
{
ÔÔ 	
get
ÕÕ 
{
ÖÖ 
try
×× 
{
ØØ 
return
ÙÙ 
m_size
ÙÙ !
;
ÙÙ! "
}
ÚÚ 
catch
ÛÛ 
(
ÛÛ 
	Exception
ÛÛ  
ex
ÛÛ! #
)
ÛÛ# $
{
ÜÜ 
FDebug
İİ 
.
İİ 
throwException
İİ )
(
İİ) *
ex
İİ* ,
)
İİ, -
;
İİ- .
}
ŞŞ 
finally
ßß 
{
àà 
}
ââ 
return
ãã 
$num
ãã 
;
ãã 
}
ää 
set
ææ 
{
çç 
try
èè 
{
éé 
if
êê 
(
êê 
value
êê 
<
êê 
$num
êê  !
)
êê! "
{
ëë 
FDebug
ìì 
.
ìì 
throwFException
ìì .
(
ìì. /
string
ìì/ 5
.
ìì5 6
Format
ìì6 <
(
ìì< =

FConstants
ìì= G
.
ììG H

err_m_0005
ììH R
,
ììR S
$str
ììT d
)
ììd e
)
ììe f
;
ììf g
}
íí 
m_size
îî 
=
îî 
value
îî "
;
îî" #
}
ïï 
catch
ğğ 
(
ğğ 
	Exception
ğğ  
ex
ğğ! #
)
ğğ# $
{
ññ 
FDebug
òò 
.
òò 
throwException
òò )
(
òò) *
ex
òò* ,
)
òò, -
;
òò- .
}
óó 
finally
ôô 
{
õõ 
}
÷÷ 
}
øø 
}
ùù 	
public
ıı 
string
ıı 
	aliasName
ıı 
{
şş 	
get
ÿÿ 
{
€€ 
try
 
{
‚‚ 
return
ƒƒ 
string
ƒƒ !
.
ƒƒ! " 
IsNullOrWhiteSpace
ƒƒ" 4
(
ƒƒ4 5
m_aliasName
ƒƒ5 @
)
ƒƒ@ A
?
ƒƒB C
name
ƒƒD H
:
ƒƒI J
m_aliasName
ƒƒK V
;
ƒƒV W
}
„„ 
catch
…… 
(
…… 
	Exception
……  
ex
……! #
)
……# $
{
†† 
FDebug
‡‡ 
.
‡‡ 
throwException
‡‡ )
(
‡‡) *
ex
‡‡* ,
)
‡‡, -
;
‡‡- .
}
ˆˆ 
finally
‰‰ 
{
ŠŠ 
}
ŒŒ 
return
 
string
 
.
 
Empty
 #
;
# $
}
 
set
 
{
‘‘ 
try
’’ 
{
““ 
m_aliasName
”” 
=
””  !
value
””" '
;
””' (
}
•• 
catch
–– 
(
–– 
	Exception
––  
ex
––! #
)
––# $
{
—— 
FDebug
˜˜ 
.
˜˜ 
throwException
˜˜ )
(
˜˜) *
ex
˜˜* ,
)
˜˜, -
;
˜˜- .
}
™™ 
finally
šš 
{
›› 
}
 
}
 
}
ŸŸ 	
internal
££ 
SqlParameter
££ 
sqlParameter
££ *
{
¤¤ 	
get
¥¥ 
{
¦¦ 
SqlParameter
§§ 
sqlPar
§§ #
=
§§$ %
null
§§& *
;
§§* +
try
©© 
{
ªª 
sqlPar
«« 
=
«« 
new
««  
SqlParameter
««! -
(
««- .
)
««. /
;
««/ 0
sqlPar
¬¬ 
.
¬¬ 
ParameterName
¬¬ (
=
¬¬) *
m_name
¬¬+ 1
;
¬¬1 2
sqlPar
­­ 
.
­­ 
Value
­­  
=
­­! "
m_value
­­# *
;
­­* +
sqlPar
®® 
.
®® 
	Direction
®® $
=
®®% &
m_direction
®®' 2
;
®®2 3
sqlPar
¯¯ 
.
¯¯ 
Size
¯¯ 
=
¯¯  !
m_size
¯¯" (
;
¯¯( )
sqlPar
°° 
.
°° 
	SqlDbType
°° $
=
°°% &
toSqlDbType
°°' 2
(
°°2 3
fDbType
°°3 :
)
°°: ;
;
°°; <
return
±± 
sqlPar
±± !
;
±±! "
}
²² 
catch
³³ 
(
³³ 
	Exception
³³  
ex
³³! #
)
³³# $
{
´´ 
FDebug
µµ 
.
µµ 
throwException
µµ )
(
µµ) *
ex
µµ* ,
)
µµ, -
;
µµ- .
}
¶¶ 
finally
·· 
{
¸¸ 
}
ºº 
return
»» 
null
»» 
;
»» 
}
¼¼ 
}
½½ 	
internal
ÁÁ 
System
ÁÁ 
.
ÁÁ 
Data
ÁÁ 
.
ÁÁ 
OracleClient
ÁÁ )
.
ÁÁ) *
OracleParameter
ÁÁ* 9
oracleParameter
ÁÁ: I
{
ÂÂ 	
get
ÃÃ 
{
ÄÄ 
System
ÅÅ 
.
ÅÅ 
Data
ÅÅ 
.
ÅÅ 
OracleClient
ÅÅ (
.
ÅÅ( )
OracleParameter
ÅÅ) 8
oraPar
ÅÅ9 ?
=
ÅÅ@ A
null
ÅÅB F
;
ÅÅF G
try
ÇÇ 
{
ÈÈ 
oraPar
ÉÉ 
=
ÉÉ 
new
ÉÉ  
System
ÉÉ! '
.
ÉÉ' (
Data
ÉÉ( ,
.
ÉÉ, -
OracleClient
ÉÉ- 9
.
ÉÉ9 :
OracleParameter
ÉÉ: I
(
ÉÉI J
)
ÉÉJ K
;
ÉÉK L
oraPar
ÊÊ 
.
ÊÊ 
ParameterName
ÊÊ (
=
ÊÊ) *
m_name
ÊÊ+ 1
;
ÊÊ1 2
oraPar
ËË 
.
ËË 
Value
ËË  
=
ËË! "
m_value
ËË# *
;
ËË* +
oraPar
ÌÌ 
.
ÌÌ 
	Direction
ÌÌ $
=
ÌÌ% &
m_direction
ÌÌ' 2
;
ÌÌ2 3
oraPar
ÍÍ 
.
ÍÍ 
Size
ÍÍ 
=
ÍÍ  !
m_size
ÍÍ" (
;
ÍÍ( )
oraPar
ÎÎ 
.
ÎÎ 
DbType
ÎÎ !
=
ÎÎ" #
toOracleDbType
ÎÎ$ 2
(
ÎÎ2 3
fDbType
ÎÎ3 :
)
ÎÎ: ;
;
ÎÎ; <
return
ÏÏ 
oraPar
ÏÏ !
;
ÏÏ! "
}
ĞĞ 
catch
ÑÑ 
(
ÑÑ 
	Exception
ÑÑ  
ex
ÑÑ! #
)
ÑÑ# $
{
ÒÒ 
FDebug
ÓÓ 
.
ÓÓ 
throwException
ÓÓ )
(
ÓÓ) *
ex
ÓÓ* ,
)
ÓÓ, -
;
ÓÓ- .
}
ÔÔ 
finally
ÕÕ 
{
ÖÖ 
}
ØØ 
return
ÙÙ 
null
ÙÙ 
;
ÙÙ 
}
ÚÚ 
}
ÛÛ 	
internal
ßß 
Oracle
ßß 
.
ßß 
ManagedDataAccess
ßß )
.
ßß) *
Client
ßß* 0
.
ßß0 1
OracleParameter
ßß1 @
oracleExParameter
ßßA R
{
àà 	
get
áá 
{
ââ 
Oracle
ãã 
.
ãã 
ManagedDataAccess
ãã (
.
ãã( )
Client
ãã) /
.
ãã/ 0
OracleParameter
ãã0 ?
odpPar
ãã@ F
=
ããG H
null
ããI M
;
ããM N
try
åå 
{
ææ 
odpPar
çç 
=
çç 
new
çç  
Oracle
çç! '
.
çç' (
ManagedDataAccess
çç( 9
.
çç9 :
Client
çç: @
.
çç@ A
OracleParameter
ççA P
(
ççP Q
)
ççQ R
;
ççR S
odpPar
èè 
.
èè 
ParameterName
èè (
=
èè) *
m_name
èè+ 1
;
èè1 2
odpPar
éé 
.
éé 
Value
éé  
=
éé! "
m_value
éé# *
;
éé* +
odpPar
êê 
.
êê 
	Direction
êê $
=
êê% &
m_direction
êê' 2
;
êê2 3
odpPar
ëë 
.
ëë 
Size
ëë 
=
ëë  !
m_size
ëë" (
;
ëë( )
odpPar
ìì 
.
ìì 
OracleDbType
ìì '
=
ìì( )
toOracleExDbType
ìì* :
(
ìì: ;
fDbType
ìì; B
)
ììB C
;
ììC D
return
íí 
odpPar
íí !
;
íí! "
}
îî 
catch
ïï 
(
ïï 
	Exception
ïï  
ex
ïï! #
)
ïï# $
{
ğğ 
FDebug
ññ 
.
ññ 
throwException
ññ )
(
ññ) *
ex
ññ* ,
)
ññ, -
;
ññ- .
}
òò 
finally
óó 
{
ôô 
}
öö 
return
÷÷ 
null
÷÷ 
;
÷÷ 
}
øø 
}
ùù 	
internal
ıı 
MySqlParameter
ıı 
mySqlParameter
ıı  .
{
şş 	
get
ÿÿ 
{
€€ 
MySqlParameter
 
mysPar
 %
=
& '
null
( ,
;
, -
try
ƒƒ 
{
„„ 
mysPar
…… 
=
…… 
new
……  
MySqlParameter
……! /
(
……/ 0
)
……0 1
;
……1 2
mysPar
†† 
.
†† 
ParameterName
†† (
=
††) *
m_name
††+ 1
;
††1 2
mysPar
‡‡ 
.
‡‡ 
Value
‡‡  
=
‡‡! "
m_value
‡‡# *
;
‡‡* +
mysPar
ˆˆ 
.
ˆˆ 
	Direction
ˆˆ $
=
ˆˆ% &
m_direction
ˆˆ' 2
;
ˆˆ2 3
mysPar
‰‰ 
.
‰‰ 
Size
‰‰ 
=
‰‰  !
m_size
‰‰" (
;
‰‰( )
mysPar
ŠŠ 
.
ŠŠ 
MySqlDbType
ŠŠ &
=
ŠŠ' (
toMySqlDbType
ŠŠ) 6
(
ŠŠ6 7
fDbType
ŠŠ7 >
)
ŠŠ> ?
;
ŠŠ? @
return
‹‹ 
mysPar
‹‹ !
;
‹‹! "
}
ŒŒ 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
‘‘ 
{
’’ 
}
”” 
return
•• 
null
•• 
;
•• 
}
–– 
}
—— 	
internal
›› 
MySqlParameter
›› 
mariaDbParameter
››  0
{
œœ 	
get
 
{
 
MySqlParameter
ŸŸ 
marPar
ŸŸ %
=
ŸŸ& '
null
ŸŸ( ,
;
ŸŸ, -
try
¡¡ 
{
¢¢ 
marPar
££ 
=
££ 
new
££  
MySqlParameter
££! /
(
££/ 0
)
££0 1
;
££1 2
marPar
¤¤ 
.
¤¤ 
ParameterName
¤¤ (
=
¤¤) *
m_name
¤¤+ 1
;
¤¤1 2
marPar
¥¥ 
.
¥¥ 
Value
¥¥  
=
¥¥! "
m_value
¥¥# *
;
¥¥* +
marPar
¦¦ 
.
¦¦ 
	Direction
¦¦ $
=
¦¦% &
m_direction
¦¦' 2
;
¦¦2 3
marPar
§§ 
.
§§ 
Size
§§ 
=
§§  !
m_size
§§" (
;
§§( )
marPar
¨¨ 
.
¨¨ 
MySqlDbType
¨¨ &
=
¨¨' (
toMariaDbType
¨¨) 6
(
¨¨6 7
fDbType
¨¨7 >
)
¨¨> ?
;
¨¨? @
return
©© 
marPar
©© !
;
©©! "
}
ªª 
catch
«« 
(
«« 
	Exception
««  
ex
««! #
)
««# $
{
¬¬ 
FDebug
­­ 
.
­­ 
throwException
­­ )
(
­­) *
ex
­­* ,
)
­­, -
;
­­- .
}
®® 
finally
¯¯ 
{
°° 
}
²² 
return
³³ 
null
³³ 
;
³³ 
}
´´ 
}
µµ 	
internal
¹¹ 
NpgsqlParameter
¹¹  
pgSqlParameter
¹¹! /
{
ºº 	
get
»» 
{
¼¼ 
NpgsqlParameter
½½ 
pgsPar
½½  &
=
½½' (
null
½½) -
;
½½- .
try
¿¿ 
{
ÀÀ 
pgsPar
ÁÁ 
=
ÁÁ 
new
ÁÁ  
NpgsqlParameter
ÁÁ! 0
(
ÁÁ0 1
)
ÁÁ1 2
;
ÁÁ2 3
pgsPar
ÂÂ 
.
ÂÂ 
ParameterName
ÂÂ (
=
ÂÂ) *
m_name
ÂÂ+ 1
;
ÂÂ1 2
pgsPar
ÃÃ 
.
ÃÃ 
Value
ÃÃ  
=
ÃÃ! "
m_value
ÃÃ# *
;
ÃÃ* +
pgsPar
ÄÄ 
.
ÄÄ 
	Direction
ÄÄ $
=
ÄÄ% &
m_direction
ÄÄ' 2
;
ÄÄ2 3
pgsPar
ÅÅ 
.
ÅÅ 
Size
ÅÅ 
=
ÅÅ  !
m_size
ÅÅ" (
;
ÅÅ( )
pgsPar
ÆÆ 
.
ÆÆ 
DbType
ÆÆ !
=
ÆÆ" #
toNpgsqlDbType
ÆÆ$ 2
(
ÆÆ2 3
fDbType
ÆÆ3 :
)
ÆÆ: ;
;
ÆÆ; <
return
ÇÇ 
pgsPar
ÇÇ !
;
ÇÇ! "
}
ÈÈ 
catch
ÉÉ 
(
ÉÉ 
	Exception
ÉÉ  
ex
ÉÉ! #
)
ÉÉ# $
{
ÊÊ 
FDebug
ËË 
.
ËË 
throwException
ËË )
(
ËË) *
ex
ËË* ,
)
ËË, -
;
ËË- .
}
ÌÌ 
finally
ÍÍ 
{
ÎÎ 
}
ĞĞ 
return
ÑÑ 
null
ÑÑ 
;
ÑÑ 
}
ÒÒ 
}
ÓÓ 	
private
ÛÛ 
DbType
ÛÛ 
toDbType
ÛÛ 
(
ÛÛ  
FDbType
ÜÜ 
fDbType
ÜÜ 
)
İİ 
{
ŞŞ 	
DbType
ßß 
type
ßß 
=
ßß 
DbType
ßß  
.
ßß  !
String
ßß! '
;
ßß' (
try
áá 
{
ââ 
if
ãã 
(
ãã 
fDbType
ãã 
==
ãã 
FDbType
ãã &
.
ãã& '
Int16
ãã' ,
)
ãã, -
{
ää 
type
åå 
=
åå 
DbType
åå !
.
åå! "
Int16
åå" '
;
åå' (
}
ææ 
else
çç 
if
çç 
(
çç 
fDbType
çç  
==
çç! #
FDbType
çç$ +
.
çç+ ,
Int32
çç, 1
)
çç1 2
{
èè 
type
éé 
=
éé 
DbType
éé !
.
éé! "
Int32
éé" '
;
éé' (
}
êê 
else
ëë 
if
ëë 
(
ëë 
fDbType
ëë  
==
ëë! #
FDbType
ëë$ +
.
ëë+ ,
Int64
ëë, 1
)
ëë1 2
{
ìì 
type
íí 
=
íí 
DbType
íí !
.
íí! "
Int64
íí" '
;
íí' (
}
îî 
else
ïï 
if
ïï 
(
ïï 
fDbType
ïï  
==
ïï! #
FDbType
ïï$ +
.
ïï+ ,
Double
ïï, 2
)
ïï2 3
{
ğğ 
type
ññ 
=
ññ 
DbType
ññ !
.
ññ! "
Double
ññ" (
;
ññ( )
}
òò 
else
óó 
if
óó 
(
óó 
fDbType
óó  
==
óó! #
FDbType
óó$ +
.
óó+ ,
Char
óó, 0
)
óó0 1
{
ôô 
type
õõ 
=
õõ 
DbType
õõ !
.
õõ! "#
AnsiStringFixedLength
õõ" 7
;
õõ7 8
}
öö 
else
÷÷ 
if
÷÷ 
(
÷÷ 
fDbType
÷÷  
==
÷÷! #
FDbType
÷÷$ +
.
÷÷+ ,
VarChar
÷÷, 3
)
÷÷3 4
{
øø 
type
ùù 
=
ùù 
DbType
ùù !
.
ùù! "

AnsiString
ùù" ,
;
ùù, -
}
úú 
else
ûû 
if
ûû 
(
ûû 
fDbType
ûû  
==
ûû! #
FDbType
ûû$ +
.
ûû+ ,
NChar
ûû, 1
)
ûû1 2
{
üü 
type
ıı 
=
ıı 
DbType
ıı !
.
ıı! "
StringFixedLength
ıı" 3
;
ıı3 4
}
şş 
else
ÿÿ 
if
ÿÿ 
(
ÿÿ 
fDbType
ÿÿ  
==
ÿÿ! #
FDbType
ÿÿ$ +
.
ÿÿ+ ,
NVarChar
ÿÿ, 4
)
ÿÿ4 5
{
€€ 
type
 
=
 
DbType
 !
.
! "
String
" (
;
( )
}
‚‚ 
else
ƒƒ 
if
ƒƒ 
(
ƒƒ 
fDbType
ƒƒ  
==
ƒƒ! #
FDbType
ƒƒ$ +
.
ƒƒ+ ,
	RefCursor
ƒƒ, 5
)
ƒƒ5 6
{
„„ 
throw
…… 
new
…… #
NotSupportedException
…… 3
(
……3 4
)
……4 5
;
……5 6
}
†† 
return
‡‡ 
type
‡‡ 
;
‡‡ 
}
ˆˆ 
catch
‰‰ 
(
‰‰ 
	Exception
‰‰ 
ex
‰‰ 
)
‰‰  
{
ŠŠ 
FDebug
‹‹ 
.
‹‹ 
throwException
‹‹ %
(
‹‹% &
ex
‹‹& (
)
‹‹( )
;
‹‹) *
}
ŒŒ 
finally
 
{
 
}
 
return
‘‘ 
type
‘‘ 
;
‘‘ 
}
’’ 	
private
–– 
	SqlDbType
–– 
toSqlDbType
–– %
(
––% &
FDbType
—— 
fDbType
—— 
)
˜˜ 
{
™™ 	
	SqlDbType
šš 
type
šš 
=
šš 
	SqlDbType
šš &
.
šš& '
NVarChar
šš' /
;
šš/ 0
try
œœ 
{
 
if
 
(
 
fDbType
 
==
 
FDbType
 &
.
& '
Int16
' ,
)
, -
{
ŸŸ 
type
   
=
   
	SqlDbType
   $
.
  $ %
SmallInt
  % -
;
  - .
}
¡¡ 
else
¢¢ 
if
¢¢ 
(
¢¢ 
fDbType
¢¢  
==
¢¢! #
FDbType
¢¢$ +
.
¢¢+ ,
Int32
¢¢, 1
)
¢¢1 2
{
££ 
type
¤¤ 
=
¤¤ 
	SqlDbType
¤¤ $
.
¤¤$ %
Int
¤¤% (
;
¤¤( )
}
¥¥ 
else
¦¦ 
if
¦¦ 
(
¦¦ 
fDbType
¦¦  
==
¦¦! #
FDbType
¦¦$ +
.
¦¦+ ,
Int64
¦¦, 1
)
¦¦1 2
{
§§ 
type
¨¨ 
=
¨¨ 
	SqlDbType
¨¨ $
.
¨¨$ %
BigInt
¨¨% +
;
¨¨+ ,
}
©© 
else
ªª 
if
ªª 
(
ªª 
fDbType
ªª  
==
ªª! #
FDbType
ªª$ +
.
ªª+ ,
Double
ªª, 2
)
ªª2 3
{
«« 
type
¬¬ 
=
¬¬ 
	SqlDbType
¬¬ $
.
¬¬$ %
Float
¬¬% *
;
¬¬* +
}
­­ 
else
®® 
if
®® 
(
®® 
fDbType
®®  
==
®®! #
FDbType
®®$ +
.
®®+ ,
Char
®®, 0
)
®®0 1
{
¯¯ 
type
°° 
=
°° 
	SqlDbType
°° $
.
°°$ %
Char
°°% )
;
°°) *
}
±± 
else
²² 
if
²² 
(
²² 
fDbType
²²  
==
²²! #
FDbType
²²$ +
.
²²+ ,
VarChar
²², 3
)
²²3 4
{
³³ 
type
´´ 
=
´´ 
	SqlDbType
´´ $
.
´´$ %
VarChar
´´% ,
;
´´, -
}
µµ 
else
¶¶ 
if
¶¶ 
(
¶¶ 
fDbType
¶¶  
==
¶¶! #
FDbType
¶¶$ +
.
¶¶+ ,
NChar
¶¶, 1
)
¶¶1 2
{
·· 
type
¸¸ 
=
¸¸ 
	SqlDbType
¸¸ $
.
¸¸$ %
NChar
¸¸% *
;
¸¸* +
}
¹¹ 
else
ºº 
if
ºº 
(
ºº 
fDbType
ºº  
==
ºº! #
FDbType
ºº$ +
.
ºº+ ,
NVarChar
ºº, 4
)
ºº4 5
{
»» 
type
¼¼ 
=
¼¼ 
	SqlDbType
¼¼ $
.
¼¼$ %
NVarChar
¼¼% -
;
¼¼- .
}
½½ 
else
¾¾ 
if
¾¾ 
(
¾¾ 
fDbType
¾¾  
==
¾¾! #
FDbType
¾¾$ +
.
¾¾+ ,
	RefCursor
¾¾, 5
)
¾¾5 6
{
¿¿ 
throw
ÀÀ 
new
ÀÀ #
NotSupportedException
ÀÀ 3
(
ÀÀ3 4
)
ÀÀ4 5
;
ÀÀ5 6
}
ÁÁ 
return
ÂÂ 
type
ÂÂ 
;
ÂÂ 
}
ÃÃ 
catch
ÄÄ 
(
ÄÄ 
	Exception
ÄÄ 
ex
ÄÄ 
)
ÄÄ  
{
ÅÅ 
FDebug
ÆÆ 
.
ÆÆ 
throwException
ÆÆ %
(
ÆÆ% &
ex
ÆÆ& (
)
ÆÆ( )
;
ÆÆ) *
}
ÇÇ 
finally
ÈÈ 
{
ÉÉ 
}
ËË 
return
ÌÌ 
type
ÌÌ 
;
ÌÌ 
}
ÍÍ 	
private
ÑÑ 
DbType
ÑÑ 
toOracleDbType
ÑÑ %
(
ÑÑ% &
FDbType
ÒÒ 
fDbType
ÒÒ 
)
ÓÓ 
{
ÔÔ 	
try
ÕÕ 
{
ÖÖ 
return
×× 
toDbType
×× 
(
××  
fDbType
××  '
)
××' (
;
××( )
}
ØØ 
catch
ÙÙ 
(
ÙÙ 
	Exception
ÙÙ 
ex
ÙÙ 
)
ÙÙ  
{
ÚÚ 
FDebug
ÛÛ 
.
ÛÛ 
throwException
ÛÛ %
(
ÛÛ% &
ex
ÛÛ& (
)
ÛÛ( )
;
ÛÛ) *
}
ÜÜ 
finally
İİ 
{
ŞŞ 
}
àà 
return
áá 
DbType
áá 
.
áá 

AnsiString
áá $
;
áá$ %
}
ââ 	
private
ææ 
OracleDbType
ææ 
toOracleExDbType
ææ -
(
ææ- .
FDbType
çç 
fDbType
çç 
)
èè 
{
éé 	
OracleDbType
êê 
type
êê 
=
êê 
OracleDbType
êê  ,
.
êê, -
	NVarchar2
êê- 6
;
êê6 7
try
ìì 
{
íí 
if
îî 
(
îî 
fDbType
îî 
==
îî 
FDbType
îî &
.
îî& '
Int16
îî' ,
)
îî, -
{
ïï 
type
ğğ 
=
ğğ 
OracleDbType
ğğ '
.
ğğ' (
Int16
ğğ( -
;
ğğ- .
}
ññ 
else
òò 
if
òò 
(
òò 
fDbType
òò  
==
òò! #
FDbType
òò$ +
.
òò+ ,
Int32
òò, 1
)
òò1 2
{
óó 
type
ôô 
=
ôô 
OracleDbType
ôô '
.
ôô' (
Int32
ôô( -
;
ôô- .
}
õõ 
else
öö 
if
öö 
(
öö 
fDbType
öö  
==
öö! #
FDbType
öö$ +
.
öö+ ,
Int64
öö, 1
)
öö1 2
{
÷÷ 
type
øø 
=
øø 
OracleDbType
øø '
.
øø' (
Int64
øø( -
;
øø- .
}
ùù 
else
úú 
if
úú 
(
úú 
fDbType
úú  
==
úú! #
FDbType
úú$ +
.
úú+ ,
Double
úú, 2
)
úú2 3
{
ûû 
type
üü 
=
üü 
OracleDbType
üü '
.
üü' (
Double
üü( .
;
üü. /
}
ıı 
else
şş 
if
şş 
(
şş 
fDbType
şş  
==
şş! #
FDbType
şş$ +
.
şş+ ,
Char
şş, 0
)
şş0 1
{
ÿÿ 
type
€€ 
=
€€ 
OracleDbType
€€ '
.
€€' (
Char
€€( ,
;
€€, -
}
 
else
‚‚ 
if
‚‚ 
(
‚‚ 
fDbType
‚‚  
==
‚‚! #
FDbType
‚‚$ +
.
‚‚+ ,
VarChar
‚‚, 3
)
‚‚3 4
{
ƒƒ 
type
„„ 
=
„„ 
OracleDbType
„„ '
.
„„' (
Varchar2
„„( 0
;
„„0 1
}
…… 
else
†† 
if
†† 
(
†† 
fDbType
††  
==
††! #
FDbType
††$ +
.
††+ ,
NChar
††, 1
)
††1 2
{
‡‡ 
type
ˆˆ 
=
ˆˆ 
OracleDbType
ˆˆ '
.
ˆˆ' (
NChar
ˆˆ( -
;
ˆˆ- .
}
‰‰ 
else
ŠŠ 
if
ŠŠ 
(
ŠŠ 
fDbType
ŠŠ  
==
ŠŠ! #
FDbType
ŠŠ$ +
.
ŠŠ+ ,
NVarChar
ŠŠ, 4
)
ŠŠ4 5
{
‹‹ 
type
ŒŒ 
=
ŒŒ 
OracleDbType
ŒŒ '
.
ŒŒ' (
	NVarchar2
ŒŒ( 1
;
ŒŒ1 2
}
 
else
 
if
 
(
 
fDbType
  
==
! #
FDbType
$ +
.
+ ,
	RefCursor
, 5
)
5 6
{
 
type
 
=
 
OracleDbType
 '
.
' (
	RefCursor
( 1
;
1 2
}
‘‘ 
return
’’ 
type
’’ 
;
’’ 
}
““ 
catch
”” 
(
”” 
	Exception
”” 
ex
”” 
)
””  
{
•• 
FDebug
–– 
.
–– 
throwException
–– %
(
––% &
ex
––& (
)
––( )
;
––) *
}
—— 
finally
˜˜ 
{
™™ 
}
›› 
return
œœ 
type
œœ 
;
œœ 
}
 	
private
¡¡ 
MySqlDbType
¡¡ 
toMySqlDbType
¡¡ )
(
¡¡) *
FDbType
¢¢ 
fDbType
¢¢ 
)
££ 
{
¤¤ 	
MySqlDbType
¥¥ 
type
¥¥ 
=
¥¥ 
MySqlDbType
¥¥ *
.
¥¥* +
	VarString
¥¥+ 4
;
¥¥4 5
try
§§ 
{
¨¨ 
if
©© 
(
©© 
fDbType
©© 
==
©© 
FDbType
©© &
.
©©& '
Int16
©©' ,
)
©©, -
{
ªª 
type
«« 
=
«« 
MySqlDbType
«« &
.
««& '
Int16
««' ,
;
««, -
}
¬¬ 
else
­­ 
if
­­ 
(
­­ 
fDbType
­­  
==
­­! #
FDbType
­­$ +
.
­­+ ,
Int32
­­, 1
)
­­1 2
{
®® 
type
¯¯ 
=
¯¯ 
MySqlDbType
¯¯ &
.
¯¯& '
Int32
¯¯' ,
;
¯¯, -
}
°° 
else
±± 
if
±± 
(
±± 
fDbType
±±  
==
±±! #
FDbType
±±$ +
.
±±+ ,
Int64
±±, 1
)
±±1 2
{
²² 
type
³³ 
=
³³ 
MySqlDbType
³³ &
.
³³& '
Int64
³³' ,
;
³³, -
}
´´ 
else
µµ 
if
µµ 
(
µµ 
fDbType
µµ  
==
µµ! #
FDbType
µµ$ +
.
µµ+ ,
Double
µµ, 2
)
µµ2 3
{
¶¶ 
type
·· 
=
·· 
MySqlDbType
·· &
.
··& '
Double
··' -
;
··- .
}
¸¸ 
else
¹¹ 
if
¹¹ 
(
¹¹ 
fDbType
ºº 
==
ºº 
FDbType
ºº &
.
ºº& '
Char
ºº' +
||
ºº, .
fDbType
»» 
==
»» 
FDbType
»» &
.
»»& '
VarChar
»»' .
||
»»/ 1
fDbType
¼¼ 
==
¼¼ 
FDbType
¼¼ &
.
¼¼& '
NChar
¼¼' ,
||
¼¼- /
fDbType
½½ 
==
½½ 
FDbType
½½ &
.
½½& '
NVarChar
½½' /
)
¾¾ 
{
¿¿ 
type
ÀÀ 
=
ÀÀ 
MySqlDbType
ÀÀ &
.
ÀÀ& '
	VarString
ÀÀ' 0
;
ÀÀ0 1
}
ÁÁ 
else
ÂÂ 
if
ÂÂ 
(
ÂÂ 
fDbType
ÂÂ  
==
ÂÂ! #
FDbType
ÂÂ$ +
.
ÂÂ+ ,
	RefCursor
ÂÂ, 5
)
ÂÂ5 6
{
ÃÃ 
throw
ÄÄ 
new
ÄÄ #
NotSupportedException
ÄÄ 3
(
ÄÄ3 4
)
ÄÄ4 5
;
ÄÄ5 6
}
ÅÅ 
return
ÆÆ 
type
ÆÆ 
;
ÆÆ 
}
ÇÇ 
catch
ÈÈ 
(
ÈÈ 
	Exception
ÈÈ 
ex
ÈÈ 
)
ÈÈ  
{
ÉÉ 
FDebug
ÊÊ 
.
ÊÊ 
throwException
ÊÊ %
(
ÊÊ% &
ex
ÊÊ& (
)
ÊÊ( )
;
ÊÊ) *
}
ËË 
finally
ÌÌ 
{
ÍÍ 
}
ÏÏ 
return
ĞĞ 
type
ĞĞ 
;
ĞĞ 
}
ÑÑ 	
private
ÕÕ 
MySqlDbType
ÕÕ 
toMariaDbType
ÕÕ )
(
ÕÕ) *
FDbType
ÖÖ 
fDbType
ÖÖ 
)
×× 
{
ØØ 	
MySqlDbType
ÙÙ 
type
ÙÙ 
=
ÙÙ 
MySqlDbType
ÙÙ *
.
ÙÙ* +
	VarString
ÙÙ+ 4
;
ÙÙ4 5
try
ÛÛ 
{
ÜÜ 
if
İİ 
(
İİ 
fDbType
İİ 
==
İİ 
FDbType
İİ &
.
İİ& '
Int16
İİ' ,
)
İİ, -
{
ŞŞ 
type
ßß 
=
ßß 
MySqlDbType
ßß &
.
ßß& '
Int16
ßß' ,
;
ßß, -
}
àà 
else
áá 
if
áá 
(
áá 
fDbType
áá  
==
áá! #
FDbType
áá$ +
.
áá+ ,
Int32
áá, 1
)
áá1 2
{
ââ 
type
ãã 
=
ãã 
MySqlDbType
ãã &
.
ãã& '
Int32
ãã' ,
;
ãã, -
}
ää 
else
åå 
if
åå 
(
åå 
fDbType
åå  
==
åå! #
FDbType
åå$ +
.
åå+ ,
Int64
åå, 1
)
åå1 2
{
ææ 
type
çç 
=
çç 
MySqlDbType
çç &
.
çç& '
Int64
çç' ,
;
çç, -
}
èè 
else
éé 
if
éé 
(
éé 
fDbType
éé  
==
éé! #
FDbType
éé$ +
.
éé+ ,
Double
éé, 2
)
éé2 3
{
êê 
type
ëë 
=
ëë 
MySqlDbType
ëë &
.
ëë& '
Double
ëë' -
;
ëë- .
}
ìì 
else
íí 
if
íí 
(
íí 
fDbType
îî 
==
îî 
FDbType
îî &
.
îî& '
Char
îî' +
||
îî, .
fDbType
ïï 
==
ïï 
FDbType
ïï &
.
ïï& '
VarChar
ïï' .
||
ïï/ 1
fDbType
ğğ 
==
ğğ 
FDbType
ğğ &
.
ğğ& '
NChar
ğğ' ,
||
ğğ- /
fDbType
ññ 
==
ññ 
FDbType
ññ &
.
ññ& '
NVarChar
ññ' /
)
òò 
{
óó 
type
ôô 
=
ôô 
MySqlDbType
ôô &
.
ôô& '
	VarString
ôô' 0
;
ôô0 1
}
õõ 
else
öö 
if
öö 
(
öö 
fDbType
öö  
==
öö! #
FDbType
öö$ +
.
öö+ ,
	RefCursor
öö, 5
)
öö5 6
{
÷÷ 
throw
øø 
new
øø #
NotSupportedException
øø 3
(
øø3 4
)
øø4 5
;
øø5 6
}
ùù 
return
úú 
type
úú 
;
úú 
}
ûû 
catch
üü 
(
üü 
	Exception
üü 
ex
üü 
)
üü  
{
ıı 
FDebug
şş 
.
şş 
throwException
şş %
(
şş% &
ex
şş& (
)
şş( )
;
şş) *
}
ÿÿ 
finally
€€ 
{
 
}
ƒƒ 
return
„„ 
type
„„ 
;
„„ 
}
…… 	
private
‰‰ 
DbType
‰‰ 
toNpgsqlDbType
‰‰ %
(
‰‰% &
FDbType
ŠŠ 
fDbType
ŠŠ 
)
‹‹ 
{
ŒŒ 	
try
 
{
 
return
 
toDbType
 
(
  
fDbType
  '
)
' (
;
( )
}
 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘ 
ex
‘‘ 
)
‘‘  
{
’’ 
FDebug
““ 
.
““ 
throwException
““ %
(
““% &
ex
““& (
)
““( )
;
““) *
}
”” 
finally
•• 
{
–– 
}
˜˜ 
return
™™ 
DbType
™™ 
.
™™ 

AnsiString
™™ $
;
™™$ %
}
šš 	
}
   
}¡¡ õ¬
kD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\c_FProcParameterCollection.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class $
FProcParameterCollection )
:* +
IDisposable+ 6
,6 7
IEnumerable8 C
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 

Dictionary 
< 
string !
,! "
FProcParameter# 1
>1 2
m_fParameterDict3 C
=D E
nullF J
;J K
private 
List 
< 
FProcParameter #
># $
m_fParameterList% 5
=6 7
null8 <
;< =
internal## $
FProcParameterCollection## )
(##) *
)$$ 
{%% 	
m_fParameterDict&& 
=&& 
new&& "

Dictionary&&# -
<&&- .
string&&. 4
,&&4 5
FProcParameter&&6 D
>&&D E
(&&E F
)&&F G
;&&G H
m_fParameterList'' 
='' 
new'' "
List''# '
<''' (
FProcParameter''( 6
>''6 7
(''7 8
)''8 9
;''9 :
}(( 	
~,, 	$
FProcParameterCollection,,	 !
(,,! "
)-- 
{.. 	
	myDispose// 
(// 
false// 
)// 
;// 
}00 	
	protected44 
void44 
	myDispose44  
(44  !
bool55 
	disposing55 
)66 
{77 	
if88 
(88 
!88 

m_disposed88 
)88 
{99 
if:: 
(:: 
	disposing:: 
):: 
{;; 
m_fParameterDict<< $
=<<% &
null<<' +
;<<+ ,
m_fParameterList== $
===% &
null==' +
;==+ ,
}>> 
}?? 

m_disposedAA 
=AA 
trueAA 
;AA 
}BB 	
publicJJ 
voidJJ 
DisposeJJ 
(JJ 
)KK 
{LL 	
	myDisposeMM 
(MM 
trueMM 
)MM 
;MM 
GCNN 
.NN 
SuppressFinalizeNN 
(NN  
thisNN  $
)NN$ %
;NN% &
}OO 	
publicWW 
IEnumeratorWW 
GetEnumeratorWW (
(WW( )
)XX 
{YY 	
tryZZ 
{[[ 
return\\ 
new\\ .
"FProcParameterCollectionEnumerator\\ =
(\\= >
this\\> B
)\\B C
;\\C D
}]] 
catch^^ 
(^^ 
	Exception^^ 
ex^^ 
)^^  
{__ 
FDebug`` 
.`` 
throwException`` %
(``% &
ex``& (
)``( )
;``) *
}aa 
finallybb 
{cc 
}dd 
returnee 
nullee 
;ee 
}ff 	
publicjj 
intjj 
countjj 
{kk 	
getll 
{mm 
trynn 
{oo 
returnpp 
m_fParameterListpp +
.pp+ ,
Countpp, 1
;pp1 2
}qq 
catchrr 
(rr 
	Exceptionrr  
exrr! #
)rr# $
{ss 
FDebugtt 
.tt 
throwExceptiontt )
(tt) *
extt* ,
)tt, -
;tt- .
}uu 
finallyvv 
{ww 
}yy 
returnzz 
$numzz 
;zz 
}{{ 
}|| 	
public
€€ 
FProcParameter
€€ 
this
€€ "
[
€€" #
int
€€# &
i
€€' (
]
€€( )
{
 	
get
‚‚ 
{
ƒƒ 
try
„„ 
{
…… 
if
†† 
(
†† 
i
†† 
<
†† 
$num
†† 
||
††  
i
††! "
>=
††# %
m_fParameterList
††& 6
.
††6 7
Count
††7 <
)
††< =
{
‡‡ 
return
ˆˆ 
null
ˆˆ #
;
ˆˆ# $
}
‰‰ 
return
ŠŠ 
m_fParameterList
ŠŠ +
[
ŠŠ+ ,
i
ŠŠ, -
]
ŠŠ- .
;
ŠŠ. /
}
‹‹ 
catch
ŒŒ 
(
ŒŒ 
	Exception
ŒŒ  
ex
ŒŒ! #
)
ŒŒ# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
 
{
‘‘ 
}
““ 
return
”” 
null
”” 
;
”” 
}
•• 
}
–– 	
public
šš 
FProcParameter
šš 
this
šš "
[
šš" #
string
šš# )
name
šš* .
]
šš. /
{
›› 	
get
œœ 
{
 
try
 
{
ŸŸ 
if
   
(
   
!
   
m_fParameterDict
   )
.
  ) *
ContainsKey
  * 5
(
  5 6
name
  6 :
)
  : ;
)
  ; <
{
¡¡ 
return
¢¢ 
null
¢¢ #
;
¢¢# $
}
££ 
return
¤¤ 
m_fParameterDict
¤¤ +
[
¤¤+ ,
name
¤¤, 0
]
¤¤0 1
;
¤¤1 2
}
¥¥ 
catch
¦¦ 
(
¦¦ 
	Exception
¦¦  
ex
¦¦! #
)
¦¦# $
{
§§ 
FDebug
¨¨ 
.
¨¨ 
throwException
¨¨ )
(
¨¨) *
ex
¨¨* ,
)
¨¨, -
;
¨¨- .
}
©© 
finally
ªª 
{
«« 
}
­­ 
return
®® 
null
®® 
;
®® 
}
¯¯ 
}
°° 	
public
¸¸ 
FProcParameter
¸¸ 
add
¸¸ !
(
¸¸! "
string
¹¹ 
name
¹¹ 
,
¹¹ 
object
ºº 
value
ºº 
,
ºº 
string
»» 
	aliasName
»» 
=
»» 
$str
»» !
)
¼¼ 
{
½½ 	
try
¾¾ 
{
¿¿ 
return
ÀÀ 
add
ÀÀ 
(
ÀÀ 
name
ÀÀ 
,
ÀÀ  
FDbType
ÀÀ! (
.
ÀÀ( )
NVarChar
ÀÀ) 1
,
ÀÀ1 2
$num
ÀÀ3 4
,
ÀÀ4 5
value
ÀÀ6 ;
,
ÀÀ; < 
ParameterDirection
ÀÀ= O
.
ÀÀO P
Input
ÀÀP U
,
ÀÀU V
	aliasName
ÀÀW `
)
ÀÀ` a
;
ÀÀa b
}
ÁÁ 
catch
ÂÂ 
(
ÂÂ 
	Exception
ÂÂ 
ex
ÂÂ 
)
ÂÂ  
{
ÃÃ 
FDebug
ÄÄ 
.
ÄÄ 
throwException
ÄÄ %
(
ÄÄ% &
ex
ÄÄ& (
)
ÄÄ( )
;
ÄÄ) *
}
ÅÅ 
finally
ÆÆ 
{
ÇÇ 
}
ÉÉ 
return
ÊÊ 
null
ÊÊ 
;
ÊÊ 
}
ËË 	
public
ÏÏ 
FProcParameter
ÏÏ 
add
ÏÏ !
(
ÏÏ! "
string
ĞĞ 
name
ĞĞ 
,
ĞĞ 
FDbType
ÑÑ 
fDbType
ÑÑ 
,
ÑÑ  
ParameterDirection
ÒÒ 
	direction
ÒÒ (
,
ÒÒ( )
string
ÓÓ 
	aliasName
ÓÓ 
=
ÓÓ 
$str
ÓÓ !
)
ÔÔ 
{
ÕÕ 	
try
ÖÖ 
{
×× 
return
ØØ 
add
ØØ 
(
ØØ 
name
ØØ 
,
ØØ  
fDbType
ØØ! (
,
ØØ( )
$num
ØØ* +
,
ØØ+ ,
null
ØØ- 1
,
ØØ1 2
	direction
ØØ3 <
,
ØØ< =
	aliasName
ØØ> G
)
ØØG H
;
ØØH I
}
ÙÙ 
catch
ÚÚ 
(
ÚÚ 
	Exception
ÚÚ 
ex
ÚÚ 
)
ÚÚ  
{
ÛÛ 
FDebug
ÜÜ 
.
ÜÜ 
throwException
ÜÜ %
(
ÜÜ% &
ex
ÜÜ& (
)
ÜÜ( )
;
ÜÜ) *
}
İİ 
finally
ŞŞ 
{
ßß 
}
áá 
return
ââ 
null
ââ 
;
ââ 
}
ãã 	
public
çç 
FProcParameter
çç 
add
çç !
(
çç! "
string
èè 
name
èè 
,
èè 
FDbType
éé 
fDbType
éé 
,
éé 
int
êê 
size
êê 
,
êê  
ParameterDirection
ëë 
	direction
ëë (
,
ëë( )
string
ìì 
	aliasName
ìì 
=
ìì 
$str
ìì !
)
íí 
{
îî 	
try
ïï 
{
ğğ 
return
ññ 
add
ññ 
(
ññ 
name
ññ 
,
ññ  
fDbType
ññ! (
,
ññ( )
size
ññ* .
,
ññ. /
null
ññ0 4
,
ññ4 5
	direction
ññ6 ?
,
ññ? @
	aliasName
ññA J
)
ññJ K
;
ññK L
}
òò 
catch
óó 
(
óó 
	Exception
óó 
ex
óó 
)
óó  
{
ôô 
FDebug
õõ 
.
õõ 
throwException
õõ %
(
õõ% &
ex
õõ& (
)
õõ( )
;
õõ) *
}
öö 
finally
÷÷ 
{
øø 
}
úú 
return
ûû 
null
ûû 
;
ûû 
}
üü 	
public
€€ 
FProcParameter
€€ 
add
€€ !
(
€€! "
string
 
name
 
,
 
FDbType
‚‚ 
fDbType
‚‚ 
,
‚‚ 
object
ƒƒ 
value
ƒƒ 
,
ƒƒ  
ParameterDirection
„„ 
	direction
„„ '
,
„„' (
string
…… 
	aliasName
…… 
=
…… 
$str
……  
)
†† 
{
‡‡ 	
try
ˆˆ 
{
‰‰ 
return
ŠŠ 
add
ŠŠ 
(
ŠŠ 
name
ŠŠ 
,
ŠŠ  
fDbType
ŠŠ! (
,
ŠŠ( )
$num
ŠŠ* +
,
ŠŠ+ ,
value
ŠŠ- 2
,
ŠŠ2 3
	direction
ŠŠ4 =
,
ŠŠ= >
	aliasName
ŠŠ? H
)
ŠŠH I
;
ŠŠI J
}
‹‹ 
catch
ŒŒ 
(
ŒŒ 
	Exception
ŒŒ 
ex
ŒŒ 
)
ŒŒ  
{
 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
 
{
‘‘ 
}
““ 
return
”” 
null
”” 
;
”” 
}
•• 	
public
™™ 
FProcParameter
™™ 
add
™™ !
(
™™! "
string
šš 
name
šš 
,
šš 
FDbType
›› 
fDbType
›› 
,
›› 
int
œœ 
size
œœ 
,
œœ 
object
 
value
 
,
  
ParameterDirection
 
	direction
 (
,
( )
string
ŸŸ 
	aliasName
ŸŸ 
=
ŸŸ 
$str
ŸŸ !
)
   
{
¡¡ 	
try
¢¢ 
{
££ 
if
¤¤ 
(
¤¤ 
contains
¤¤ 
(
¤¤ 
name
¤¤ !
)
¤¤! "
)
¤¤" #
{
¥¥ 
FDebug
¦¦ 
.
¦¦ 
throwFException
¦¦ *
(
¦¦* +
string
¦¦+ 1
.
¦¦1 2
Format
¦¦2 8
(
¦¦8 9

FConstants
¦¦9 C
.
¦¦C D

err_m_0004
¦¦D N
,
¦¦N O
$str
¦¦P `
)
¦¦` a
)
¦¦a b
;
¦¦b c
}
§§ 
using
«« 
(
«« 
FProcParameter
«« %

fParameter
««& 0
=
««1 2
new
««3 6
FProcParameter
««7 E
(
««E F
name
««F J
,
««J K
fDbType
««L S
,
««S T
size
««U Y
,
««Y Z
value
««[ `
,
««` a
	direction
««b k
,
««k l
	aliasName
««m v
)
««v w
)
««w x
{
¬¬ 
m_fParameterDict
­­ $
.
­­$ %
Add
­­% (
(
­­( )
name
­­) -
,
­­- .

fParameter
­­/ 9
)
­­9 :
;
­­: ;
m_fParameterList
®® $
.
®®$ %
Add
®®% (
(
®®( )

fParameter
®®) 3
)
®®3 4
;
®®4 5
}
¯¯ 
}
°° 
catch
±± 
(
±± 
	Exception
±± 
ex
±± 
)
±±  
{
²² 
FDebug
³³ 
.
³³ 
throwException
³³ %
(
³³% &
ex
³³& (
)
³³( )
;
³³) *
}
´´ 
finally
µµ 
{
¶¶ 
}
¸¸ 
return
¹¹ 
null
¹¹ 
;
¹¹ 
}
ºº 	
public
¾¾ 
FProcParameter
¾¾ 
add
¾¾ !
(
¾¾! "
FProcParameter
¿¿ 

fParameter
¿¿ %
)
ÀÀ 
{
ÁÁ 	
try
ÂÂ 
{
ÃÃ 
if
ÄÄ 
(
ÄÄ 
contains
ÄÄ 
(
ÄÄ 

fParameter
ÄÄ '
.
ÄÄ' (
name
ÄÄ( ,
)
ÄÄ, -
)
ÄÄ- .
{
ÅÅ 
FDebug
ÆÆ 
.
ÆÆ 
throwFException
ÆÆ *
(
ÆÆ* +
string
ÆÆ+ 1
.
ÆÆ1 2
Format
ÆÆ2 8
(
ÆÆ8 9

FConstants
ÆÆ9 C
.
ÆÆC D

err_m_0004
ÆÆD N
,
ÆÆN O
$str
ÆÆP `
)
ÆÆ` a
)
ÆÆa b
;
ÆÆb c
}
ÇÇ 
m_fParameterDict
ËË  
.
ËË  !
Add
ËË! $
(
ËË$ %

fParameter
ËË% /
.
ËË/ 0
name
ËË0 4
,
ËË4 5

fParameter
ËË6 @
)
ËË@ A
;
ËËA B
m_fParameterList
ÌÌ  
.
ÌÌ  !
Add
ÌÌ! $
(
ÌÌ$ %

fParameter
ÌÌ% /
)
ÌÌ/ 0
;
ÌÌ0 1
}
ÍÍ 
catch
ÎÎ 
(
ÎÎ 
	Exception
ÎÎ 
ex
ÎÎ 
)
ÎÎ  
{
ÏÏ 
FDebug
ĞĞ 
.
ĞĞ 
throwException
ĞĞ %
(
ĞĞ% &
ex
ĞĞ& (
)
ĞĞ( )
;
ĞĞ) *
}
ÑÑ 
finally
ÒÒ 
{
ÓÓ 
}
ÕÕ 
return
ÖÖ 
null
ÖÖ 
;
ÖÖ 
}
×× 	
public
ÛÛ 
FProcParameter
ÛÛ 
insert
ÛÛ $
(
ÛÛ$ %
int
ÜÜ 
index
ÜÜ 
,
ÜÜ 
FProcParameter
İİ 

fParameter
İİ %
)
ŞŞ 
{
ßß 	
try
àà 
{
áá 
if
ââ 
(
ââ 
contains
ââ 
(
ââ 

fParameter
ââ '
.
ââ' (
name
ââ( ,
)
ââ, -
)
ââ- .
{
ãã 
FDebug
ää 
.
ää 
throwFException
ää *
(
ää* +
string
ää+ 1
.
ää1 2
Format
ää2 8
(
ää8 9

FConstants
ää9 C
.
ääC D

err_m_0004
ääD N
,
ääN O
$str
ääP `
)
ää` a
)
ääa b
;
ääb c
}
åå 
m_fParameterDict
éé  
.
éé  !
Add
éé! $
(
éé$ %

fParameter
éé% /
.
éé/ 0
name
éé0 4
,
éé4 5

fParameter
éé6 @
)
éé@ A
;
ééA B
m_fParameterList
êê  
.
êê  !
Insert
êê! '
(
êê' (
index
êê( -
,
êê- .

fParameter
êê/ 9
)
êê9 :
;
êê: ;
}
ëë 
catch
ìì 
(
ìì 
	Exception
ìì 
ex
ìì 
)
ìì  
{
íí 
FDebug
îî 
.
îî 
throwException
îî %
(
îî% &
ex
îî& (
)
îî( )
;
îî) *
}
ïï 
finally
ğğ 
{
ññ 
}
óó 
return
ôô 
null
ôô 
;
ôô 
}
õõ 	
public
ùù 
void
ùù 
clear
ùù 
(
ùù 
)
úú 
{
ûû 	
try
üü 
{
ıı 
m_fParameterDict
şş  
.
şş  !
Clear
şş! &
(
şş& '
)
şş' (
;
şş( )
m_fParameterList
ÿÿ  
.
ÿÿ  !
Clear
ÿÿ! &
(
ÿÿ& '
)
ÿÿ' (
;
ÿÿ( )
}
€€ 
catch
 
(
 
	Exception
 
ex
 
)
  
{
‚‚ 
FDebug
ƒƒ 
.
ƒƒ 
throwException
ƒƒ %
(
ƒƒ% &
ex
ƒƒ& (
)
ƒƒ( )
;
ƒƒ) *
}
„„ 
finally
…… 
{
†† 
}
ˆˆ 
}
‰‰ 	
public
 
int
 
indexOf
 
(
 
string
 
name
 
)
 
{
 	
int
‘‘ 
index
‘‘ 
=
‘‘ 
-
‘‘ 
$num
‘‘ 
;
‘‘ 
try
““ 
{
”” 
if
•• 
(
•• 
!
•• 
contains
•• 
(
•• 
name
•• !
)
••! "
)
••" #
{
–– 
return
—— 
-
—— 
$num
—— 
;
—— 
}
˜˜ 
for
œœ 
(
œœ 
int
œœ 
i
œœ 
=
œœ 
$num
œœ 
;
œœ 
i
œœ  !
<
œœ" #
m_fParameterList
œœ$ 4
.
œœ4 5
Count
œœ5 :
;
œœ: ;
i
œœ< =
++
œœ= ?
)
œœ? @
{
 
if
 
(
 
name
 
.
 
Equals
 #
(
# $
m_fParameterList
$ 4
[
4 5
i
5 6
]
6 7
.
7 8
name
8 <
)
< =
)
= >
{
ŸŸ 
index
   
=
   
i
    !
;
  ! "
break
¡¡ 
;
¡¡ 
}
¢¢ 
}
££ 
return
¤¤ 
index
¤¤ 
;
¤¤ 
}
¥¥ 
catch
¦¦ 
(
¦¦ 
	Exception
¦¦ 
ex
¦¦ 
)
¦¦  
{
§§ 
FDebug
¨¨ 
.
¨¨ 
throwException
¨¨ %
(
¨¨% &
ex
¨¨& (
)
¨¨( )
;
¨¨) *
}
©© 
finally
ªª 
{
«« 
}
­­ 
return
®® 
-
®® 
$num
®® 
;
®® 
}
¯¯ 	
public
³³ 
bool
³³ 
contains
³³ 
(
³³ 
string
´´ 
name
´´ 
)
µµ 
{
¶¶ 	
try
·· 
{
¸¸ 
return
¹¹ 
m_fParameterDict
¹¹ '
.
¹¹' (
ContainsKey
¹¹( 3
(
¹¹3 4
name
¹¹4 8
)
¹¹8 9
;
¹¹9 :
}
ºº 
catch
»» 
(
»» 
	Exception
»» 
ex
»» 
)
»»  
{
¼¼ 
FDebug
½½ 
.
½½ 
throwException
½½ %
(
½½% &
ex
½½& (
)
½½( )
;
½½) *
}
¾¾ 
finally
¿¿ 
{
ÀÀ 
}
ÂÂ 
return
ÃÃ 
false
ÃÃ 
;
ÃÃ 
}
ÄÄ 	
public
ÈÈ 
void
ÈÈ 
removeAt
ÈÈ 
(
ÈÈ 
int
ÉÉ 
index
ÉÉ 
)
ÊÊ 
{
ËË 	
FProcParameter
ÌÌ 

fParameter
ÌÌ %
=
ÌÌ& '
null
ÌÌ( ,
;
ÌÌ, -
try
ÎÎ 
{
ÏÏ 

fParameter
ĞĞ 
=
ĞĞ 
this
ĞĞ !
[
ĞĞ! "
index
ĞĞ" '
]
ĞĞ' (
;
ĞĞ( )
if
ÑÑ 
(
ÑÑ 

fParameter
ÑÑ 
!=
ÑÑ !
null
ÑÑ" &
)
ÑÑ& '
{
ÒÒ 
m_fParameterDict
ÓÓ $
.
ÓÓ$ %
Remove
ÓÓ% +
(
ÓÓ+ ,
this
ÓÓ, 0
[
ÓÓ0 1
index
ÓÓ1 6
]
ÓÓ6 7
.
ÓÓ7 8
name
ÓÓ8 <
)
ÓÓ< =
;
ÓÓ= >
m_fParameterList
ÔÔ $
.
ÔÔ$ %
RemoveAt
ÔÔ% -
(
ÔÔ- .
index
ÔÔ. 3
)
ÔÔ3 4
;
ÔÔ4 5
}
ÕÕ 
}
ÖÖ 
catch
×× 
(
×× 
	Exception
×× 
ex
×× 
)
××  
{
ØØ 
FDebug
ÙÙ 
.
ÙÙ 
throwException
ÙÙ %
(
ÙÙ% &
ex
ÙÙ& (
)
ÙÙ( )
;
ÙÙ) *
}
ÚÚ 
finally
ÛÛ 
{
ÜÜ 

fParameter
İİ 
=
İİ 
null
İİ !
;
İİ! "
}
ŞŞ 
}
ßß 	
public
ãã 
void
ãã 
removeAt
ãã 
(
ãã 
string
ää 
name
ää 
)
åå 
{
ææ 	
int
çç 
index
çç 
=
çç 
$num
çç 
;
çç 
try
éé 
{
êê 
index
ëë 
=
ëë 
indexOf
ëë 
(
ëë  
name
ëë  $
)
ëë$ %
;
ëë% &
if
ìì 
(
ìì 
index
ìì 
>=
ìì 
$num
ìì 
)
ìì 
{
íí 
removeAt
îî 
(
îî 
index
îî "
)
îî" #
;
îî# $
}
ïï 
}
ğğ 
catch
ññ 
(
ññ 
	Exception
ññ 
ex
ññ 
)
ññ  
{
òò 
FDebug
óó 
.
óó 
throwException
óó %
(
óó% &
ex
óó& (
)
óó( )
;
óó) *
}
ôô 
finally
õõ 
{
öö 
}
øø 
}
ùù 	
}
ÿÿ 
}€€ Ø
uD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\c_FProcParameterCollectionEnumerator.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class .
"FProcParameterCollectionEnumerator 3
:4 5
IEnumerator6 A
,A B
IDisposableC N
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
int 
m_index 
= 
- 
$num  
;  !
private $
FProcParameterCollection (
m_fProcParameters) :
=; <
null= A
;A B
public## .
"FProcParameterCollectionEnumerator## 1
(##1 2$
FProcParameterCollection$$ $
fProcParameters$$% 4
)%% 
{&& 	
m_fProcParameters'' 
='' 
fProcParameters''  /
;''/ 0
}(( 	
~,, 	.
"FProcParameterCollectionEnumerator,,	 +
(,,+ ,
)-- 
{.. 	
}00 	
	protected44 
void44 
	myDispose44  
(44  !
bool55 
	disposing55 
)66 
{77 	
if88 
(88 
!88 

m_disposed88 
)88 
{99 
if:: 
(:: 
	disposing:: 
):: 
{;; 
m_fProcParameters<< %
=<<& '
null<<( ,
;<<, -
}== 
}>> 

m_disposed?? 
=?? 
true?? 
;?? 
}@@ 	
publicHH 
voidHH 
DisposeHH 
(HH 
)II 
{JJ 	
	myDisposeKK 
(KK 
trueKK 
)KK 
;KK 
}LL 	
publicTT 
objectTT 
CurrentTT 
{UU 	
getVV 
{WW 
tryXX 
{YY 
returnZZ 
m_fProcParametersZZ ,
[ZZ, -
m_indexZZ- 4
]ZZ4 5
;ZZ5 6
}[[ 
catch\\ 
(\\ 
	Exception\\  
ex\\! #
)\\# $
{]] 
FDebug^^ 
.^^ 
throwException^^ )
(^^) *
ex^^* ,
)^^, -
;^^- .
}__ 
finally`` 
{aa 
}cc 
returndd 
nulldd 
;dd 
}ee 
}ff 	
publicjj 
booljj 
MoveNextjj 
(jj 
)kk 
{ll 	
trymm 
{nn 
m_indexoo 
++oo 
;oo 
returnpp 
(pp 
m_indexpp 
<pp  !
m_fProcParameterspp" 3
.pp3 4
countpp4 9
)pp9 :
;pp: ;
}qq 
catchrr 
(rr 
Systemrr 
.rr 
	Exceptionrr #
exrr$ &
)rr& '
{ss 
FDebugtt 
.tt 
throwExceptiontt %
(tt% &
extt& (
)tt( )
;tt) *
}uu 
finallyvv 
{ww 
}yy 
returnzz 
falsezz 
;zz 
}{{ 	
public 
void 
Reset 
( 
)
€€ 
{
 	
try
‚‚ 
{
ƒƒ 
m_index
„„ 
=
„„ 
-
„„ 
$num
„„ 
;
„„ 
}
…… 
catch
†† 
(
†† 
System
†† 
.
†† 
	Exception
†† #
ex
††$ &
)
††& '
{
‡‡ 
FDebug
ˆˆ 
.
ˆˆ 
throwException
ˆˆ %
(
ˆˆ% &
ex
ˆˆ& (
)
ˆˆ( )
;
ˆˆ) *
}
‰‰ 
finally
ŠŠ 
{
‹‹ 
}
 
}
 	
}
”” 
}•• Õ§
qD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\OracleEx\c_FOdpProcedureExecutor.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class !
FOdpProcedureExecutor &
:' (
FIProcedureExecutor) <
,< =
IDisposable> I
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
string 
m_connectionString )
=* +
string, 2
.2 3
Empty3 8
;8 9
private   
int   
	m_timeout   
=   
$num    "
;  " #
internal&& !
FOdpProcedureExecutor&& &
(&&& '
)'' 
{(( 	
}** 	
public.. !
FOdpProcedureExecutor.. $
(..$ %
string// 
connectionString// #
)00 
{11 	
m_connectionString22 
=22  
connectionString22! 1
;221 2
}33 	
~77 	!
FOdpProcedureExecutor77	 
(77 
)88 
{99 	
	myDispose:: 
(:: 
false:: 
):: 
;:: 
};; 	
private?? 
void?? 
	myDispose?? 
(?? 
bool@@ 
	disposing@@ 
)AA 
{BB 	
ifCC 
(CC 
!CC 

m_disposedCC 
)CC 
{DD 
ifEE 
(EE 
	disposingEE 
)EE 
{FF 
}HH 

m_disposedII 
=II 
trueII !
;II! "
}JJ 
}KK 	
publicSS 
voidSS 
DisposeSS 
(SS 
)TT 
{UU 	
	myDisposeVV 
(VV 
trueVV 
)VV 
;VV 
GCWW 
.WW 
SuppressFinalizeWW 
(WW  
thisWW  $
)WW$ %
;WW% &
}XX 	
public`` 
string`` 
connectionString`` &
{aa 	
getbb 
{cc 
trydd 
{ee 
returnff 
m_connectionStringff -
;ff- .
}gg 
catchhh 
(hh 
	Exceptionhh  
exhh! #
)hh# $
{ii 
FDebugjj 
.jj 
throwExceptionjj )
(jj) *
exjj* ,
)jj, -
;jj- .
}kk 
finallyll 
{mm 
}oo 
returnpp 
stringpp 
.pp 
Emptypp #
;pp# $
}qq 
setss 
{tt 
tryuu 
{vv 
m_connectionStringww &
=ww' (
valueww) .
;ww. /
}xx 
catchyy 
(yy 
	Exceptionyy  
exyy! #
)yy# $
{zz 
FDebug{{ 
.{{ 
throwException{{ )
({{) *
ex{{* ,
){{, -
;{{- .
}|| 
finally}} 
{~~ 
}
€€ 
}
 
}
‚‚ 	
public
†† 
int
†† 
timeout
†† 
{
‡‡ 	
get
ˆˆ 
{
‰‰ 
try
ŠŠ 
{
‹‹ 
return
ŒŒ 
	m_timeout
ŒŒ $
;
ŒŒ$ %
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
‘‘ 
finally
’’ 
{
““ 
}
•• 
return
–– 
$num
–– 
;
–– 
}
—— 
set
™™ 
{
šš 
try
›› 
{
œœ 
	m_timeout
 
=
 
(
  !
value
! &
>
' (
$num
) *
)
* +
?
, -
value
. 3
:
4 5
$num
6 8
;
8 9
}
 
catch
ŸŸ 
(
ŸŸ 
	Exception
ŸŸ  
ex
ŸŸ! #
)
ŸŸ# $
{
   
FDebug
¡¡ 
.
¡¡ 
throwException
¡¡ )
(
¡¡) *
ex
¡¡* ,
)
¡¡, -
;
¡¡- .
}
¢¢ 
finally
££ 
{
¤¤ 
}
¦¦ 
}
§§ 
}
¨¨ 	
public
°° !
FDbOutputCollection
°° "
execute
°°# *
(
°°* +

FProcedure
±± 

fProcedure
±± !
)
²² 
{
³³ 	
try
´´ 
{
µµ 
return
¶¶ 
execute
¶¶ 
(
¶¶ 

fProcedure
¶¶ )
,
¶¶) *
timeout
¶¶+ 2
)
¶¶2 3
;
¶¶3 4
}
·· 
catch
¸¸ 
(
¸¸ 
	Exception
¸¸ 
ex
¸¸ 
)
¸¸  
{
¹¹ 
FDebug
ºº 
.
ºº 
throwException
ºº %
(
ºº% &
ex
ºº& (
)
ºº( )
;
ºº) *
}
»» 
finally
¼¼ 
{
½½ 
}
¿¿ 
return
ÀÀ 
null
ÀÀ 
;
ÀÀ 
}
ÁÁ 	
public
ÅÅ !
FDbOutputCollection
ÅÅ "
execute
ÅÅ# *
(
ÅÅ* +

FProcedure
ÆÆ 

fProcedure
ÆÆ !
,
ÆÆ! "
int
ÇÇ 
timeout
ÇÇ 
)
ÈÈ 
{
ÉÉ 	
OracleConnection
ÊÊ 
oraCon
ÊÊ #
=
ÊÊ$ %
null
ÊÊ& *
;
ÊÊ* +
OracleCommand
ËË 
oraCmd
ËË  
=
ËË! "
null
ËË# '
;
ËË' (
int
ÌÌ 
retryCnt
ÌÌ 
=
ÌÌ 
$num
ÌÌ 
;
ÌÌ !
FSqlErrorCollection
ÍÍ 

fSqlErrors
ÍÍ  *
=
ÍÍ+ ,
null
ÍÍ- 1
;
ÍÍ1 2
FSqlErrorType
ÎÎ 
fSqlErrorType
ÎÎ '
=
ÎÎ( )
FSqlErrorType
ÎÎ* 7
.
ÎÎ7 8
Normal
ÎÎ8 >
;
ÎÎ> ?
OracleDataAdapter
ÏÏ 
dataAdt
ÏÏ %
=
ÏÏ& '
null
ÏÏ( ,
;
ÏÏ, -!
FDbOutputCollection
ĞĞ 
fOutputs
ĞĞ  (
=
ĞĞ) *
null
ĞĞ+ /
;
ĞĞ/ 0
List
ÑÑ 
<
ÑÑ 
string
ÑÑ 
>
ÑÑ 
list
ÑÑ 
=
ÑÑ 
null
ÑÑ  $
;
ÑÑ$ %
DataSet
ÒÒ 
dataSet
ÒÒ 
=
ÒÒ 
null
ÒÒ "
;
ÒÒ" #
string
ÔÔ 
errorMessage
ÔÔ 
=
ÔÔ  !
string
ÔÔ" (
.
ÔÔ( )
Empty
ÔÔ) .
;
ÔÔ. /
using
ÖÖ 
(
ÖÖ 
oraCon
ÖÖ 
=
ÖÖ 
new
ÖÖ 
OracleConnection
ÖÖ  0
(
ÖÖ0 1
connectionString
ÖÖ1 A
)
ÖÖA B
)
ÖÖB C
{
×× 
try
ØØ 
{
ÙÙ 
oraCon
ÚÚ 
.
ÚÚ 
Open
ÚÚ 
(
ÚÚ  
)
ÚÚ  !
;
ÚÚ! "
while
ÛÛ 
(
ÛÛ 
true
ÛÛ 
)
ÛÛ  
{
ÜÜ 
oraCmd
İİ 
=
İİ  
oraCon
İİ! '
.
İİ' (
CreateCommand
İİ( 5
(
İİ5 6
)
İİ6 7
;
İİ7 8
oraCmd
ŞŞ 
.
ŞŞ 

Connection
ŞŞ )
=
ŞŞ* +
oraCon
ŞŞ, 2
;
ŞŞ2 3
try
ßß 
{
àà 
oraCmd
áá "
.
áá" #
CommandTimeout
áá# 1
=
áá2 3
timeout
áá4 ;
;
áá; <
oraCmd
ââ "
.
ââ" #
CommandType
ââ# .
=
ââ/ 0
CommandType
ââ1 <
.
ââ< =
StoredProcedure
ââ= L
;
ââL M
oraCmd
ææ "
.
ææ" #
CommandText
ææ# .
=
ææ/ 0

fProcedure
ææ1 ;
.
ææ; <
command
ææ< C
;
ææC D
foreach
çç #
(
çç$ %
FProcParameter
çç% 3

fParameter
çç4 >
in
çç? A

fProcedure
ççB L
.
ççL M
fParameters
ççM X
)
ççX Y
{
èè 
oraCmd
éé  &
.
éé& '

Parameters
éé' 1
.
éé1 2
Add
éé2 5
(
éé5 6

fParameter
éé6 @
.
éé@ A
oracleExParameter
ééA R
)
ééR S
;
ééS T
}
êê 
oraCmd
ëë "
.
ëë" #
ExecuteNonQuery
ëë# 2
(
ëë2 3
)
ëë3 4
;
ëë4 5
list
òò  
=
òò! "
new
òò# &
List
òò' +
<
òò+ ,
string
òò, 2
>
òò2 3
(
òò3 4
)
òò4 5
;
òò5 6
fOutputs
óó $
=
óó% &
new
óó' *!
FDbOutputCollection
óó+ >
(
óó> ?
)
óó? @
;
óó@ A
foreach
ôô #
(
ôô$ %
FProcParameter
ôô% 3

fParameter
ôô4 >
in
ôô? A

fProcedure
ôôB L
.
ôôL M
fParameters
ôôM X
)
ôôX Y
{
õõ 
if
öö  "
(
öö# $

fParameter
÷÷$ .
.
÷÷. /
	direction
÷÷/ 8
==
÷÷9 ; 
ParameterDirection
÷÷< N
.
÷÷N O
InputOutput
÷÷O Z
||
÷÷[ ]

fParameter
øø$ .
.
øø. /
	direction
øø/ 8
==
øø9 ; 
ParameterDirection
øø< N
.
øøN O
Output
øøO U
)
ùù$ %
{
úú  !
if
ûû$ &
(
ûû& '

fParameter
üü( 2
.
üü2 3
fDbType
üü3 :
==
üü; =
FDbType
üü> E
.
üüE F
Char
üüF J
||
üüK M

fParameter
ıı( 2
.
ıı2 3
fDbType
ıı3 :
==
ıı; =
FDbType
ıı> E
.
ııE F
VarChar
ııF M
||
ııN P

fParameter
şş( 2
.
şş2 3
fDbType
şş3 :
==
şş; =
FDbType
şş> E
.
şşE F
NChar
şşF K
||
şşL N

fParameter
ÿÿ( 2
.
ÿÿ2 3
fDbType
ÿÿ3 :
==
ÿÿ; =
FDbType
ÿÿ> E
.
ÿÿE F
NVarChar
ÿÿF N
)
€€( )
{
$ %
fOutputs
‚‚( 0
.
‚‚0 1
add
‚‚1 4
(
‚‚4 5
new
ƒƒ, /
	FDbString
ƒƒ0 9
(
ƒƒ9 :

fParameter
ƒƒ: D
.
ƒƒD E
	aliasName
ƒƒE N
,
ƒƒN O
oraCmd
ƒƒP V
.
ƒƒV W

Parameters
ƒƒW a
[
ƒƒa b

fParameter
ƒƒb l
.
ƒƒl m
name
ƒƒm q
]
ƒƒq r
.
ƒƒr s
Value
ƒƒs x
.
ƒƒx y
ToStringƒƒy 
(ƒƒ ‚
)ƒƒ‚ ƒ
)ƒƒƒ „
)
„„, -
;
„„- .
}
……$ %
else
††$ (
if
††) +
(
††+ ,

fParameter
‡‡( 2
.
‡‡2 3
fDbType
‡‡3 :
==
‡‡; =
FDbType
‡‡> E
.
‡‡E F
Int16
‡‡F K
||
‡‡L N

fParameter
ˆˆ( 2
.
ˆˆ2 3
fDbType
ˆˆ3 :
==
ˆˆ; =
FDbType
ˆˆ> E
.
ˆˆE F
Int32
ˆˆF K
||
ˆˆL N

fParameter
‰‰( 2
.
‰‰2 3
fDbType
‰‰3 :
==
‰‰; =
FDbType
‰‰> E
.
‰‰E F
Int64
‰‰F K
)
ŠŠ( )
{
‹‹$ %
fOutputs
ŒŒ( 0
.
ŒŒ0 1
add
ŒŒ1 4
(
ŒŒ4 5
new
, /
	FDbNumber
0 9
(
9 :

fParameter
: D
.
D E
	aliasName
E N
,
N O
oraCmd
P V
.
V W

Parameters
W a
[
a b

fParameter
b l
.
l m
name
m q
]
q r
.
r s
Value
s x
.
x y
ToStringy 
( ‚
)‚ ƒ
)ƒ „
)
, -
;
- .
}
$ %
else
$ (
if
) +
(
, -

fParameter
‘‘( 2
.
‘‘2 3
fDbType
‘‘3 :
==
‘‘; =
FDbType
‘‘> E
.
‘‘E F
Double
‘‘F L
)
’’( )
{
““$ %
fOutputs
””( 0
.
””0 1
add
””1 4
(
””4 5
new
••, /
	FDbNumber
••0 9
(
••9 :

fParameter
••: D
.
••D E
	aliasName
••E N
,
••N O
oraCmd
••P V
.
••V W

Parameters
••W a
[
••a b

fParameter
••b l
.
••l m
name
••m q
]
••q r
.
••r s
Value
••s x
.
••x y
ToString••y 
(•• ‚
)••‚ ƒ
,••ƒ „
$num••… †
)••† ‡
)
––, -
;
––- .
}
——$ %
else
˜˜$ (
if
˜˜) +
(
˜˜, -

fParameter
™™( 2
.
™™2 3
fDbType
™™3 :
==
™™; =
FDbType
™™> E
.
™™E F
	RefCursor
™™F O
)
šš( )
{
››$ %
list
œœ( ,
.
œœ, -
Add
œœ- 0
(
œœ0 1

fParameter
œœ1 ;
.
œœ; <
name
œœ< @
)
œœ@ A
;
œœA B
}
$ %
}
  !
}
ŸŸ 
dataSet
¦¦ #
=
¦¦$ %
new
¦¦& )
DataSet
¦¦* 1
(
¦¦1 2
)
¦¦2 3
;
¦¦3 4
dataAdt
§§ #
=
§§$ %
new
§§& )
OracleDataAdapter
§§* ;
(
§§; <
oraCmd
§§< B
)
§§B C
;
§§C D
string
¨¨ "
	sourTable
¨¨# ,
;
¨¨, -
for
©© 
(
©©  
int
©©  #
i
©©$ %
=
©©& '
$num
©©( )
;
©©* +
i
©©, -
<
©©. /
list
©©0 4
.
©©4 5
Count
©©5 :
;
©©; <
i
©©= >
++
©©> @
)
©©@ A
{
ªª 
	sourTable
««  )
=
««* +
(
««, -
i
««- .
==
««/ 1
$num
««2 3
)
««3 4
?
««5 6
OracleDataAdapter
««7 H
.
««H I$
DefaultSourceTableName
««I _
:
««` a
OracleDataAdapter
««b s
.
««s t%
DefaultSourceTableName««t Š
+««‹ Œ
i«« 
;«« 
dataAdt
¬¬  '
.
¬¬' (
TableMappings
¬¬( 5
.
¬¬5 6
Add
¬¬6 9
(
¬¬9 :
	sourTable
¬¬: C
,
¬¬C D

fProcedure
¬¬E O
.
¬¬O P
fParameters
¬¬P [
[
¬¬[ \
list
¬¬\ `
[
¬¬` a
i
¬¬a b
]
¬¬b c
]
¬¬c d
.
¬¬d e
	aliasName
¬¬e n
)
¬¬n o
;
¬¬o p
}
­­ 
dataAdt
®® #
.
®®# $
Fill
®®$ (
(
®®( )
dataSet
®®) 0
)
®®0 1
;
®®1 2
fOutputs
²² $
.
²²$ %
add
²²% (
(
²²( )
new
³³  #

FDbDataSet
³³$ .
(
³³. /
dataSet
³³/ 6
)
³³6 7
)
´´  !
;
´´! "
return
¸¸ "
fOutputs
¸¸# +
;
¸¸+ ,
}
¹¹ 
catch
ºº 
(
ºº 
OracleException
ºº .
oraEx
ºº/ 4
)
ºº4 5
{
»» 
FDebug
¼¼ "
.
¼¼" #
writeLog
¼¼# +
(
¼¼+ ,
oraEx
¼¼, 1
)
¼¼1 2
;
¼¼2 3

fSqlErrors
ÀÀ &
=
ÀÀ' (

FDbAdapter
ÀÀ) 3
.
ÀÀ3 4
createSqlErrors
ÀÀ4 C
(
ÀÀC D
oraEx
ÀÀD I
)
ÀÀI J
;
ÀÀJ K
if
ÈÈ 
(
ÈÈ  

fSqlErrors
ÈÈ  *
.
ÈÈ* +
containsErrorCode
ÈÈ+ <
(
ÈÈ< =
FDbErrorCode
ÈÈ= I
.
ÈÈI J
	ORA_00060
ÈÈJ S
)
ÈÈS T
&&
ÈÈU W
retryCnt
ÈÈX `
<
ÈÈa b
$num
ÈÈc e
)
ÈÈe f
{
ÉÉ 
System
ÊÊ  &
.
ÊÊ& '
Diagnostics
ÊÊ' 2
.
ÊÊ2 3
Debug
ÊÊ3 8
.
ÊÊ8 9
	WriteLine
ÊÊ9 B
(
ÊÊB C
$str
ÊÊC R
)
ÊÊR S
;
ÊÊS T
if
ÎÎ  "
(
ÎÎ# $
oraCmd
ÎÎ$ *
.
ÎÎ* +
Transaction
ÎÎ+ 6
!=
ÎÎ7 9
null
ÎÎ: >
)
ÎÎ> ?
{
ÏÏ  !
oraCmd
ĞĞ$ *
.
ĞĞ* +
Transaction
ĞĞ+ 6
.
ĞĞ6 7
Rollback
ĞĞ7 ?
(
ĞĞ? @
)
ĞĞ@ A
;
ĞĞA B
}
ÑÑ  !
oraCmd
ÕÕ  &
.
ÕÕ& '
Dispose
ÕÕ' .
(
ÕÕ. /
)
ÕÕ/ 0
;
ÕÕ0 1
oraCmd
ÖÖ  &
=
ÖÖ' (
null
ÖÖ) -
;
ÖÖ- .
retryCnt
ÚÚ  (
++
ÚÚ( *
;
ÚÚ* +
System
ÛÛ  &
.
ÛÛ& '
	Threading
ÛÛ' 0
.
ÛÛ0 1
Thread
ÛÛ1 7
.
ÛÛ7 8
Sleep
ÛÛ8 =
(
ÛÛ= >
$num
ÛÛ> @
)
ÛÛ@ A
;
ÛÛA B
}
ÜÜ 
else
İİ  
{
ŞŞ 
fSqlErrorType
ßß  -
=
ßß. /

FDbAdapter
ßß0 :
.
ßß: ;*
getSqlErrorTypeOfMsSqlServer
ßß; W
(
ßßW X

fSqlErrors
ßßX b
)
ßßb c
;
ßßc d
errorMessage
áá  ,
=
áá- .
oraEx
ââ$ )
.
ââ) *
Message
ââ* 1
+
ââ2 3
Environment
ââ4 ?
.
ââ? @
NewLine
ââ@ G
+
ââH I
$str
ãã$ /
+
ãã0 1

fProcedure
ãã2 <
.
ãã< =
command
ãã= D
+
ããE F
$str
ããG J
;
ããJ K
FDebug
åå  &
.
åå& '
throwException
åå' 5
(
åå5 6
new
åå6 9
FDbException
åå: F
(
ååF G
fSqlErrorType
ååG T
,
ååT U

fSqlErrors
ååV `
,
åå` a
errorMessage
ååb n
,
åån o
oraEx
ååp u
)
ååu v
)
ååv w
;
ååw x
}
ææ 
}
çç 
catch
èè 
(
èè 
	Exception
èè (
ex
èè) +
)
èè+ ,
{
éé 
FDebug
êê "
.
êê" #
throwException
êê# 1
(
êê1 2
ex
êê2 4
)
êê4 5
;
êê5 6
}
ëë 
finally
ìì 
{
íí 
}
ïï 
}
ğğ 
}
ññ 
catch
òò 
(
òò 
	Exception
òò  
ex
òò! #
)
òò# $
{
óó 
if
ôô 
(
ôô 
ex
ôô 
is
ôô 
FDbException
ôô *
||
ôô+ -
ex
ôô. 0
is
ôô1 3
OracleException
ôô4 C
)
ôôC D
{
õõ 
try
öö 
{
÷÷ 
if
øø 
(
øø  
oraCmd
øø  &
!=
øø' )
null
øø* .
&&
øø/ 1
oraCmd
øø2 8
.
øø8 9
Transaction
øø9 D
!=
øøE G
null
øøH L
)
øøL M
{
ùù 
oraCmd
úú  &
.
úú& '
Transaction
úú' 2
.
úú2 3
Rollback
úú3 ;
(
úú; <
)
úú< =
;
úú= >
}
ûû 
}
üü 
catch
ıı 
(
ıı 
	Exception
ıı (
inEx
ıı) -
)
ıı- .
{
şş 
FDebug
ÿÿ "
.
ÿÿ" #
writeLog
ÿÿ# +
(
ÿÿ+ ,
inEx
ÿÿ, 0
)
ÿÿ0 1
;
ÿÿ1 2
}
€€ 
}
 
FDebug
…… 
.
…… 
throwException
…… )
(
……) *
ex
……* ,
)
……, -
;
……- .
}
†† 
finally
‡‡ 
{
ˆˆ 
if
‰‰ 
(
‰‰ 
oraCmd
‰‰ 
!=
‰‰ !
null
‰‰" &
)
‰‰& '
{
ŠŠ 
if
‹‹ 
(
‹‹ 
oraCmd
‹‹ "
.
‹‹" #
Transaction
‹‹# .
!=
‹‹/ 1
null
‹‹2 6
)
‹‹6 7
{
ŒŒ 
oraCmd
 "
.
" #
Transaction
# .
.
. /
Dispose
/ 6
(
6 7
)
7 8
;
8 9
oraCmd
 "
.
" #
Transaction
# .
=
/ 0
null
1 5
;
5 6
}
 
oraCmd
““ 
.
““ 
Dispose
““ &
(
““& '
)
““' (
;
““( )
oraCmd
”” 
=
””  
null
””! %
;
””% &
}
•• 
if
—— 
(
—— 
oraCon
—— 
!=
—— !
null
——" &
)
——& '
{
˜˜ 
if
™™ 
(
™™ 
oraCon
™™ "
.
™™" #
State
™™# (
!=
™™) +
ConnectionState
™™, ;
.
™™; <
Closed
™™< B
)
™™B C
{
šš 
oraCon
›› "
.
››" #
Close
››# (
(
››( )
)
››) *
;
››* +
}
œœ 
oraCon
 
.
 
Dispose
 &
(
& '
)
' (
;
( )
oraCon
 
=
  
null
! %
;
% &
}
ŸŸ 

fSqlErrors
¡¡ 
=
¡¡  
null
¡¡! %
;
¡¡% &
}
¢¢ 
}
££ 
return
¤¤ 
null
¤¤ 
;
¤¤ 
}
¥¥ 	
}
«« 
}¬¬ İ+
dD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\Output\c_FDbDataSet.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 

FDbDataSet 
: 

FIDbOutput (
,( )
IDisposable* 5
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
DataSet 
	m_dataSet !
=" #
null$ (
;( )
public$$ 

FDbDataSet$$ 
($$ 
)%% 
{&& 	
}(( 	
public,, 

FDbDataSet,, 
(,, 
DataSet-- 
dataSet-- 
).. 
{// 	
	m_dataSet00 
=00 
dataSet00 
;00  
}11 	
~55 	

FDbDataSet55	 
(55 
)66 
{77 	
	myDispose88 
(88 
false88 
)88 
;88 
}99 	
	protected== 
virtual== 
void== 
	myDispose== (
(==( )
bool>> 
	disposing>> 
)?? 
{@@ 	
ifAA 
(AA 
!AA 

m_disposedAA 
)AA 
{BB 
ifCC 
(CC 
	disposingCC 
)CC 
{DD 
}FF 
}GG 

m_disposedHH 
=HH 
trueHH 
;HH 
}II 	
publicQQ 
voidQQ 
DisposeQQ 
(QQ 
)RR 
{SS 	
	myDisposeTT 
(TT 
trueTT 
)TT 
;TT 
GCUU 
.UU 
SuppressFinalizeUU 
(UU  
thisUU  $
)UU$ %
;UU% &
}VV 	
public^^ 
string^^ 
name^^ 
{__ 	
get`` 
{aa 
trybb 
{cc 
returndd 
$strdd $
;dd$ %
}ee 
catchff 
(ff 
	Exceptionff  
exff! #
)ff# $
{gg 
FDebughh 
.hh 
throwExceptionhh )
(hh) *
exhh* ,
)hh, -
;hh- .
}ii 
finallyjj 
{kk 
}mm 
returnnn 
stringnn 
.nn 
Emptynn #
;nn# $
}oo 
}pp 	
publictt 
FOutputTypett 
fTypett  
{uu 	
getvv 
{ww 
tryxx 
{yy 
returnzz 
FOutputTypezz &
.zz& '
DataSetzz' .
;zz. /
}{{ 
catch|| 
(|| 
	Exception||  
ex||! #
)||# $
{}} 
FDebug~~ 
.~~ 
throwException~~ )
(~~) *
ex~~* ,
)~~, -
;~~- .
}
€€ 
finally
 
{
‚‚ 
}
„„ 
return
…… 
FOutputType
…… "
.
……" #
DataSet
……# *
;
……* +
}
†† 
}
‡‡ 	
public
‹‹ 
DataSet
‹‹ 
dataSet
‹‹ 
{
ŒŒ 	
get
 
{
 
try
 
{
 
return
‘‘ 
	m_dataSet
‘‘ $
;
‘‘$ %
}
’’ 
catch
““ 
(
““ 
	Exception
““  
ex
““! #
)
““# $
{
”” 
FDebug
•• 
.
•• 
throwException
•• )
(
••) *
ex
••* ,
)
••, -
;
••- .
}
–– 
finally
—— 
{
˜˜ 
}
šš 
return
›› 
null
›› 
;
›› 
}
œœ 
set
 
{
ŸŸ 
try
   
{
¡¡ 
	m_dataSet
¢¢ 
=
¢¢ 
value
¢¢  %
;
¢¢% &
}
££ 
catch
¤¤ 
(
¤¤ 
	Exception
¤¤  
ex
¤¤! #
)
¤¤# $
{
¥¥ 
FDebug
¦¦ 
.
¦¦ 
throwException
¦¦ )
(
¦¦) *
ex
¦¦* ,
)
¦¦, -
;
¦¦- .
}
§§ 
finally
¨¨ 
{
©© 
}
«« 
}
¬¬ 
}
­­ 	
public
±± 
	DataTable
±± 
this
±± 
[
±± 
string
±± $
name
±±% )
]
±±) *
{
²² 	
get
³³ 
{
´´ 
try
µµ 
{
¶¶ 
if
·· 
(
·· 
	m_dataSet
·· !
.
··! "
Tables
··" (
.
··( )
Contains
··) 1
(
··1 2
name
··2 6
)
··6 7
)
··7 8
{
¸¸ 
return
¹¹ 
	m_dataSet
¹¹ (
.
¹¹( )
Tables
¹¹) /
[
¹¹/ 0
name
¹¹0 4
]
¹¹4 5
;
¹¹5 6
}
ºº 
return
»» 
null
»» 
;
»»  
}
¼¼ 
catch
½½ 
(
½½ 
	Exception
½½ 
ex
½½  "
)
½½" #
{
¾¾ 
FDebug
¿¿ 
.
¿¿ 
throwException
¿¿ )
(
¿¿) *
ex
¿¿* ,
)
¿¿, -
;
¿¿- .
}
ÀÀ 
finally
ÁÁ 
{
ÂÂ 
}
ÄÄ 
return
ÅÅ 
null
ÅÅ 
;
ÅÅ 
}
ÆÆ 
}
ÇÇ 	
}
ÓÓ 
}ÔÔ ¢5
cD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\Output\c_FDbNumber.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
	FDbNumber 
: 

FIDbOutput '
,' (
IDisposable) 4
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
string 
m_name 
= 
string  &
.& '
Empty' ,
;, -
private 
double 
m_value 
=  
double! '
.' (
NaN( +
;+ ,
private 
int 

m_floating 
=  
$num! "
;" #
public%% 
	FDbNumber%% 
(%% 
string&& 
name&& 
)'' 
:(( 
this(( 
((( 
name(( 
,(( 
$str(( 
)(( 
{)) 	
}++ 	
public// 
	FDbNumber// 
(// 
string00 
name00 
,00 
string11 
value11 
,11 
int22 
floating22 
=22 
$num22 
)33 
{44 	
double55 
tryVal55 
=55 
$num55 
;55 
m_name66 
=66 
name66 
;66 
m_value77 
=77 
double77 
.77 
TryParse77 %
(77% &
value77& +
,77+ ,
out77- 0
tryVal771 7
)777 8
?779 :
tryVal77; A
:77B C
$num77D E
;77E F

m_floating88 
=88 
floating88 !
;88! "
}99 	
~== 	
	FDbNumber==	 
(== 
)>> 
{?? 	
	myDispose@@ 
(@@ 
false@@ 
)@@ 
;@@ 
}AA 	
	protectedEE 
virtualEE 
voidEE 
	myDisposeEE (
(EE( )
boolFF 
	disposingFF 
)GG 
{HH 	
ifII 
(II 
!II 

m_disposedII 
)II 
{JJ 
ifKK 
(KK 
	disposingKK 
)KK 
{LL 
}NN 
}OO 

m_disposedPP 
=PP 
truePP 
;PP 
}QQ 	
publicYY 
voidYY 
DisposeYY 
(YY 
)ZZ 
{[[ 	
	myDispose\\ 
(\\ 
true\\ 
)\\ 
;\\ 
GC]] 
.]] 
SuppressFinalize]] 
(]]  
this]]  $
)]]$ %
;]]% &
}^^ 	
publicff 
stringff 
nameff 
{gg 	
gethh 
{ii 
tryjj 
{kk 
returnll 
m_namell !
;ll! "
}mm 
catchnn 
(nn 
	Exceptionnn  
exnn! #
)nn# $
{oo 
FDebugpp 
.pp 
throwExceptionpp )
(pp) *
expp* ,
)pp, -
;pp- .
}qq 
finallyrr 
{ss 
}uu 
returnvv 
stringvv 
.vv 
Emptyvv #
;vv# $
}ww 
setyy 
{zz 
try{{ 
{|| 
m_name}} 
=}} 
value}} "
;}}" #
}~~ 
catch 
( 
	Exception  
ex! #
)# $
{
€€ 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
‚‚ 
finally
ƒƒ 
{
„„ 
}
†† 
}
‡‡ 
}
ˆˆ 	
public
ŒŒ 
FOutputType
ŒŒ 
fType
ŒŒ  
{
 	
get
 
{
 
try
 
{
‘‘ 
return
’’ 
FOutputType
’’ &
.
’’& '
Number
’’' -
;
’’- .
}
““ 
catch
”” 
(
”” 
	Exception
””  
ex
””! #
)
””# $
{
•• 
FDebug
–– 
.
–– 
throwException
–– )
(
––) *
ex
––* ,
)
––, -
;
––- .
}
—— 
finally
˜˜ 
{
™™ 
}
›› 
return
œœ 
FOutputType
œœ "
.
œœ" #
Number
œœ# )
;
œœ) *
}
 
}
 	
public
¢¢ 
double
¢¢ 
value
¢¢ 
{
££ 	
get
¤¤ 
{
¥¥ 
try
¦¦ 
{
§§ 
return
¨¨ 
m_value
¨¨ "
;
¨¨" #
}
©© 
catch
ªª 
(
ªª 
	Exception
ªª  
ex
ªª! #
)
ªª# $
{
«« 
FDebug
¬¬ 
.
¬¬ 
throwException
¬¬ )
(
¬¬) *
ex
¬¬* ,
)
¬¬, -
;
¬¬- .
}
­­ 
finally
®® 
{
¯¯ 
}
±± 
return
²² 
$num
²² 
;
²² 
}
³³ 
set
µµ 
{
¶¶ 
try
·· 
{
¸¸ 
m_value
¹¹ 
=
¹¹ 
value
¹¹ #
;
¹¹# $
}
ºº 
catch
»» 
(
»» 
	Exception
»»  
ex
»»! #
)
»»# $
{
¼¼ 
FDebug
½½ 
.
½½ 
throwException
½½ )
(
½½) *
ex
½½* ,
)
½½, -
;
½½- .
}
¾¾ 
finally
¿¿ 
{
ÀÀ 
}
ÂÂ 
}
ÃÃ 
}
ÄÄ 	
public
ÌÌ 
string
ÌÌ 
toString
ÌÌ 
(
ÌÌ 
)
ÍÍ 
{
ÎÎ 	
try
ÏÏ 
{
ĞĞ 
return
ÑÑ 
m_value
ÑÑ 
.
ÑÑ 
ToString
ÑÑ '
(
ÑÑ' (
$str
ÑÑ( +
+
ÑÑ, -

m_floating
ÑÑ. 8
)
ÑÑ8 9
;
ÑÑ9 :
}
ÒÒ 
catch
ÓÓ 
(
ÓÓ 
	Exception
ÓÓ 
ex
ÓÓ 
)
ÓÓ 
{
ÔÔ 
FDebug
ÕÕ 
.
ÕÕ 
throwException
ÕÕ %
(
ÕÕ% &
ex
ÕÕ& (
)
ÕÕ( )
;
ÕÕ) *
}
ÖÖ 
finally
×× 
{
ØØ 
}
ÚÚ 
return
ÛÛ 
string
ÛÛ 
.
ÛÛ 
Empty
ÛÛ 
;
ÛÛ  
}
ÜÜ 	
}
ââ 
}ãã òV
mD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\Output\c_FDbOutputCollection.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FDbOutputCollection $
:% &
IDisposable' 2
,2 3
IEnumerable4 ?
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 

Dictionary 
< 
string !
,! "

FIDbOutput# -
>- .
m_fOutputDict/ <
== >
null? C
;C D
private 
List 
< 

FIDbOutput 
>  
m_fOutputList! .
=/ 0
null1 5
;5 6
internal$$ 
FDbOutputCollection$$ $
($$$ %
)%% 
{&& 	
m_fOutputDict'' 
='' 
new'' 

Dictionary''  *
<''* +
string''+ 1
,''1 2

FIDbOutput''3 =
>''= >
(''> ?
)''? @
;''@ A
m_fOutputList(( 
=(( 
new(( 
List((  $
<(($ %

FIDbOutput((% /
>((/ 0
(((0 1
)((1 2
;((2 3
})) 	
internal-- 
FDbOutputCollection-- $
(--$ %
List.. 
<.. 

FIDbOutput.. 
>.. 
fOutputList.. (
)// 
{00 	
m_fOutputDict11 
=11 
new11 

Dictionary11  *
<11* +
string11+ 1
,111 2

FIDbOutput113 =
>11= >
(11> ?
)11? @
;11@ A
foreach22 
(22 

FIDbOutput22 
fOutput22  '
in22( *
fOutputList22+ 6
)226 7
{33 
m_fOutputDict44 
.44 
Add44 !
(44! "
fOutput44" )
.44) *
name44* .
,44. /
fOutput440 7
)447 8
;448 9
}55 
}66 	
~:: 	
FDbOutputCollection::	 
(:: 
);; 
{<< 	
	myDispose== 
(== 
false== 
)== 
;== 
}>> 	
	protectedBB 
voidBB 
	myDisposeBB  
(BB  !
boolCC 
	disposingCC 
)CC 
{DD 	
ifEE 
(EE 
!EE 

m_disposedEE 
)EE 
{FF 
ifGG 
(GG 
	disposingGG 
)GG 
{HH 
m_fOutputDictII !
=II" #
nullII$ (
;II( )
m_fOutputListJJ !
=JJ" #
nullJJ$ (
;JJ( )
}KK 
}LL 

m_disposedMM 
=MM 
trueMM 
;MM 
}NN 	
publicVV 
voidVV 
DisposeVV 
(VV 
)WW 
{XX 	
	myDisposeYY 
(YY 
trueYY 
)YY 
;YY 
GCZZ 
.ZZ 
SuppressFinalizeZZ 
(ZZ  
thisZZ  $
)ZZ$ %
;ZZ% &
}[[ 	
publiccc 
IEnumeratorcc 
GetEnumeratorcc (
(cc( )
)dd 
{ee 	
tryff 
{gg 
returnhh 
newhh )
FDbOutputCollectionEnumeratorhh 8
(hh8 9
thishh9 =
)hh= >
;hh> ?
}ii 
catchjj 
(jj 
	Exceptionjj 
exjj 
)jj  
{kk 
FDebugll 
.ll 
throwExceptionll %
(ll% &
exll& (
)ll( )
;ll) *
}mm 
finallynn 
{oo 
}qq 
returnrr 
nullrr 
;rr 
}ss 	
publicww 
intww 
countww 
{xx 	
getyy 
{zz 
try{{ 
{|| 
return}} 
m_fOutputList}} (
.}}( )
Count}}) .
;}}. /
}~~ 
catch 
( 
System 
. 
	Exception '
ex( *
)* +
{
€€ 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
‚‚ 
finally
ƒƒ 
{
„„ 
}
†† 
return
‡‡ 
$num
‡‡ 
;
‡‡ 
}
ˆˆ 
}
‰‰ 	
public
 

FIDbOutput
 
this
 
[
 
int
 "
i
# $
]
$ %
{
 	
get
 
{
 
try
‘‘ 
{
’’ 
if
““ 
(
““ 
i
““ 
<
““ 
$num
““ 
||
““  
i
““! "
>=
““# %
m_fOutputList
““& 3
.
““3 4
Count
““4 9
)
““9 :
{
”” 
return
•• 
null
•• #
;
••# $
}
–– 
return
—— 
m_fOutputList
—— (
[
——( )
i
——) *
]
——* +
;
——+ ,
}
˜˜ 
catch
™™ 
(
™™ 
	Exception
™™  
ex
™™! #
)
™™# $
{
šš 
FDebug
›› 
.
›› 
throwException
›› )
(
››) *
ex
››* ,
)
››, -
;
››- .
}
œœ 
finally
 
{
 
}
   
return
¡¡ 
null
¡¡ 
;
¡¡ 
}
¢¢ 
}
££ 	
public
§§ 

FIDbOutput
§§ 
this
§§ 
[
§§ 
string
§§ %
name
§§& *
]
§§* +
{
¨¨ 	
get
©© 
{
ªª 
try
«« 
{
¬¬ 
if
­­ 
(
­­ 
!
­­ 
m_fOutputDict
­­ &
.
­­& '
ContainsKey
­­' 2
(
­­2 3
name
­­3 7
)
­­7 8
)
­­8 9
{
®® 
return
¯¯ 
null
¯¯ #
;
¯¯# $
}
°° 
return
±± 
m_fOutputDict
±± (
[
±±( )
name
±±) -
]
±±- .
;
±±. /
}
²² 
catch
³³ 
(
³³ 
	Exception
³³  
ex
³³! #
)
³³# $
{
´´ 
FDebug
µµ 
.
µµ 
throwException
µµ )
(
µµ) *
ex
µµ* ,
)
µµ, -
;
µµ- .
}
¶¶ 
finally
·· 
{
¸¸ 
}
ºº 
return
»» 
null
»» 
;
»» 
}
¼¼ 
}
½½ 	
public
ÁÁ 
DataSet
ÁÁ 
dataSet
ÁÁ 
{
ÂÂ 	
get
ÃÃ 
{
ÄÄ 
try
ÅÅ 
{
ÆÆ 
if
ÇÇ 
(
ÇÇ 
m_fOutputDict
ÇÇ $
.
ÇÇ$ %
ContainsKey
ÇÇ% 0
(
ÇÇ0 1
$str
ÇÇ1 :
)
ÇÇ: ;
)
ÇÇ; <
{
ÈÈ 
return
ÉÉ 
(
ÉÉ  
(
ÉÉ  !

FDbDataSet
ÉÉ! +
)
ÉÉ+ ,
this
ÉÉ, 0
[
ÉÉ0 1
$str
ÉÉ1 :
]
ÉÉ: ;
)
ÉÉ; <
.
ÉÉ< =
dataSet
ÉÉ= D
;
ÉÉD E
}
ÊÊ 
return
ËË 
null
ËË 
;
ËË  
}
ÌÌ 
catch
ÍÍ 
(
ÍÍ 
	Exception
ÍÍ  
ex
ÍÍ! #
)
ÍÍ# $
{
ÎÎ 
FDebug
ÏÏ 
.
ÏÏ 
throwException
ÏÏ )
(
ÏÏ) *
ex
ÏÏ* ,
)
ÏÏ, -
;
ÏÏ- .
}
ĞĞ 
finally
ÑÑ 
{
ÒÒ 
}
ÔÔ 
return
ÕÕ 
null
ÕÕ 
;
ÕÕ 
}
ÖÖ 
}
ØØ 	
public
àà 
void
àà 
add
àà 
(
àà 

FIDbOutput
áá 
fOutput
áá 
)
ââ 
{
ãã 	
try
ää 
{
åå 
if
ææ 
(
ææ 
m_fOutputDict
ææ !
.
ææ! "
ContainsKey
ææ" -
(
ææ- .
fOutput
ææ. 5
.
ææ5 6
name
ææ6 :
)
ææ: ;
)
ææ; <
{
çç 
FDebug
èè 
.
èè 
throwFException
èè *
(
èè* +
string
èè+ 1
.
èè1 2
Format
èè2 8
(
èè8 9

FConstants
èè9 C
.
èèC D

err_m_0005
èèD N
,
èèN O
$str
èèP n
)
èèn o
)
èèo p
;
èèp q
}
éé 
m_fOutputDict
êê 
.
êê 
Add
êê !
(
êê! "
fOutput
êê" )
.
êê) *
name
êê* .
,
êê. /
fOutput
êê0 7
)
êê7 8
;
êê8 9
m_fOutputList
ëë 
.
ëë 
Add
ëë !
(
ëë! "
fOutput
ëë" )
)
ëë) *
;
ëë* +
}
ìì 
catch
íí 
(
íí 
	Exception
íí 
ex
íí 
)
íí  
{
îî 
FDebug
ïï 
.
ïï 
throwException
ïï %
(
ïï% &
ex
ïï& (
)
ïï( )
;
ïï) *
}
ğğ 
finally
ññ 
{
òò 
}
ôô 
}
õõ 	
public
ùù 
void
ùù 
remove
ùù 
(
ùù 
string
úú 
name
úú 
)
ûû 
{
üü 	
try
ıı 
{
şş 
if
ÿÿ 
(
ÿÿ 
m_fOutputDict
ÿÿ !
.
ÿÿ! "
ContainsKey
ÿÿ" -
(
ÿÿ- .
name
ÿÿ. 2
)
ÿÿ2 3
)
ÿÿ3 4
{
€€ 
m_fOutputDict
 !
.
! "
Remove
" (
(
( )
name
) -
)
- .
;
. /
}
‚‚ 
}
ƒƒ 
catch
„„ 
(
„„ 
	Exception
„„ 
ex
„„ 
)
„„  
{
…… 
FDebug
†† 
.
†† 
throwException
†† %
(
††% &
ex
††& (
)
††( )
;
††) *
}
‡‡ 
finally
ˆˆ 
{
‰‰ 
}
‹‹ 
}
ŒŒ 	
public
 
void
 
remove
 
(
 

FIDbOutput
‘‘ 
fOutput
‘‘ 
)
’’ 
{
““ 	
try
”” 
{
•• 
remove
–– 
(
–– 
fOutput
–– 
.
–– 
name
–– #
)
––# $
;
––$ %
}
—— 
catch
˜˜ 
(
˜˜ 
	Exception
˜˜ 
ex
˜˜ 
)
˜˜  
{
™™ 
FDebug
šš 
.
šš 
throwException
šš %
(
šš% &
ex
šš& (
)
šš( )
;
šš) *
}
›› 
finally
œœ 
{
 
}
ŸŸ 
}
   	
}
¦¦ 
}§§ ¡ 
wD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\Output\c_FDbOutputCollectionEnumerator.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class )
FDbOutputCollectionEnumerator .
:/ 0
IEnumerator1 <
,< =
IDisposable> I
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
int 
m_index 
= 
- 
$num  
;  !
private 
FDbOutputCollection #

m_fOutputs$ .
=/ 0
null1 5
;5 6
public## )
FDbOutputCollectionEnumerator## ,
(##, -
FDbOutputCollection$$ 
fResults$$  (
)%% 
{&& 	

m_fOutputs'' 
='' 
fResults'' !
;''! "
}(( 	
~,, 	)
FDbOutputCollectionEnumerator,,	 &
(,,& '
)-- 
{.. 	
	myDispose// 
(// 
false// 
)// 
;// 
}00 	
	protected44 
void44 
	myDispose44  
(44  !
bool55 
	disposing55 
)66 
{77 	
if88 
(88 
!88 

m_disposed88 
)88 
{99 
if:: 
(:: 
	disposing:: 
):: 
{;; 

m_fOutputs<< 
=<<  
null<<! %
;<<% &
}== 
}>> 

m_disposed?? 
=?? 
true?? 
;?? 
}@@ 	
publicHH 
voidHH 
DisposeHH 
(HH 
)II 
{JJ 	
	myDisposeKK 
(KK 
trueKK 
)KK 
;KK 
GCLL 
.LL 
SuppressFinalizeLL 
(LL  
thisLL  $
)LL$ %
;LL% &
}MM 	
publicUU 
objectUU 
CurrentUU 
{VV 	
getWW 
{XX 
tryYY 
{ZZ 
return[[ 

m_fOutputs[[ %
[[[% &
m_index[[& -
][[- .
;[[. /
}\\ 
catch]] 
(]] 
	Exception]]  
ex]]! #
)]]# $
{^^ 
FDebug__ 
.__ 
throwException__ )
(__) *
ex__* ,
)__, -
;__- .
}`` 
finallyaa 
{bb 
}dd 
returnee 
nullee 
;ee 
}ff 
}gg 	
publickk 
boolkk 
MoveNextkk 
(kk 
)ll 
{mm 	
trynn 
{oo 
m_indexpp 
++pp 
;pp 
returnqq 
(qq 
m_indexqq 
<qq  !

m_fOutputsqq" ,
.qq, -
countqq- 2
)qq2 3
;qq3 4
}rr 
catchss 
(ss 
	Exceptionss 
exss 
)ss  
{tt 
FDebuguu 
.uu 
throwExceptionuu %
(uu% &
exuu& (
)uu( )
;uu) *
}vv 
finallyww 
{xx 
}zz 
return{{ 
false{{ 
;{{ 
}|| 	
public
€€ 
void
€€ 
Reset
€€ 
(
€€ 
)
 
{
‚‚ 	
try
ƒƒ 
{
„„ 
m_index
…… 
=
…… 
-
…… 
$num
…… 
;
…… 
}
†† 
catch
‡‡ 
(
‡‡ 
	Exception
‡‡ 
ex
‡‡ 
)
‡‡  
{
ˆˆ 
FDebug
‰‰ 
.
‰‰ 
throwException
‰‰ %
(
‰‰% &
ex
‰‰& (
)
‰‰( )
;
‰‰) *
}
ŠŠ 
finally
‹‹ 
{
ŒŒ 
}
 
}
 	
}
•• 
}–– õ*
cD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\Output\c_FDbString.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
	FDbString 
: 

FIDbOutput '
,' (
IDisposable) 4
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
string 
m_name 
= 
string  &
.& '
Empty' ,
;, -
private 
string 
m_value 
=  
string! '
.' (
Empty( -
;- .
public$$ 
	FDbString$$ 
($$ 
string%% 
name%% 
)&& 
:'' 
this'' 
('' 
name'' 
,'' 
string'' 
.''  
Empty''  %
)''% &
{(( 	
}** 	
public.. 
	FDbString.. 
(.. 
string// 
name// 
,// 
string00 
value00 
)11 
{22 	
m_name33 
=33 
name33 
;33 
m_value44 
=44 
value44 
;44 
}55 	
~99 	
	FDbString99	 
(99 
):: 
{;; 	
	myDispose<< 
(<< 
false<< 
)<< 
;<< 
}== 	
	protectedAA 
virtualAA 
voidAA 
	myDisposeAA (
(AA( )
boolBB 
	disposingBB 
)CC 
{DD 	
ifEE 
(EE 
!EE 

m_disposedEE 
)EE 
{FF 
ifGG 
(GG 
	disposingGG 
)GG 
{HH 
}JJ 
}KK 

m_disposedLL 
=LL 
trueLL 
;LL 
}MM 	
publicUU 
voidUU 
DisposeUU 
(UU 
)VV 
{WW 	
	myDisposeXX 
(XX 
trueXX 
)XX 
;XX 
GCYY 
.YY 
SuppressFinalizeYY 
(YY  
thisYY  $
)YY$ %
;YY% &
}ZZ 	
publicbb 
stringbb 
namebb 
{cc 	
getdd 
{ee 
tryff 
{gg 
returnhh 
m_namehh !
;hh! "
}ii 
catchjj 
(jj 
	Exceptionjj  
exjj! #
)jj# $
{kk 
FDebugll 
.ll 
throwExceptionll )
(ll) *
exll* ,
)ll, -
;ll- .
}mm 
finallynn 
{oo 
}qq 
returnrr 
stringrr 
.rr 
Emptyrr #
;rr# $
}ss 
setuu 
{vv 
tryww 
{xx 
m_nameyy 
=yy 
valueyy "
;yy" #
}zz 
catch{{ 
({{ 
	Exception{{  
ex{{! #
){{# $
{|| 
FDebug}} 
.}} 
throwException}} )
(}}) *
ex}}* ,
)}}, -
;}}- .
}~~ 
finally 
{
€€ 
}
‚‚ 
}
ƒƒ 
}
„„ 	
public
ˆˆ 
FOutputType
ˆˆ 
fType
ˆˆ  
{
‰‰ 	
get
ŠŠ 
{
‹‹ 
try
ŒŒ 
{
 
return
 
FOutputType
 &
.
& '
String
' -
;
- .
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
‘‘ 
FDebug
’’ 
.
’’ 
throwException
’’ )
(
’’) *
ex
’’* ,
)
’’, -
;
’’- .
}
““ 
finally
”” 
{
•• 
}
—— 
return
˜˜ 
FOutputType
˜˜ "
.
˜˜" #
String
˜˜# )
;
˜˜) *
}
™™ 
}
šš 	
public
 
string
 
value
 
{
ŸŸ 	
get
   
{
¡¡ 
try
¢¢ 
{
££ 
return
¤¤ 
m_value
¤¤ "
;
¤¤" #
}
¥¥ 
catch
¦¦ 
(
¦¦ 
	Exception
¦¦  
ex
¦¦! #
)
¦¦# $
{
§§ 
FDebug
¨¨ 
.
¨¨ 
throwException
¨¨ )
(
¨¨) *
ex
¨¨* ,
)
¨¨, -
;
¨¨- .
}
©© 
finally
ªª 
{
«« 
}
­­ 
return
®® 
string
®® 
.
®® 
Empty
®® #
;
®®# $
}
¯¯ 
set
±± 
{
²² 
try
³³ 
{
´´ 
m_value
µµ 
=
µµ 
value
µµ #
;
µµ# $
}
¶¶ 
catch
·· 
(
·· 
	Exception
··  
ex
··! #
)
··# $
{
¸¸ 
FDebug
¹¹ 
.
¹¹ 
throwException
¹¹ )
(
¹¹) *
ex
¹¹* ,
)
¹¹, -
;
¹¹- .
}
ºº 
finally
»» 
{
¼¼ 
}
¾¾ 
}
¿¿ 
}
ÀÀ 	
}
ÌÌ 
}ÍÍ ë
fD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\i_FIProcedureExecutor.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

	interface 
FIProcedureExecutor (
{ 
string 
connectionString 
{ 	
get 
; 
set 
; 
} 	
int   
timeout   
{!! 	
get"" 
;"" 
set## 
;## 
}$$ 	
FDbOutputCollection,, 
execute,, #
(,,# $

FProcedure-- 

fProcedure-- !
).. 
;.. 
FDbOutputCollection22 
execute22 #
(22# $

FProcedure33 

fProcedure33 !
,33! "
int44 
timeout44 
)55 
;55 
};; 
}<< ¿
dD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\Output\i_FIDbOutput.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

	interface 

FIDbOutput 
{ 
string 
name 
{ 	
get 
; 
} 	
FOutputType 
fType 
{   	
get!! 
;!! 
}"" 	
}.. 
}// ìj
lD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\MariaDb\c_FMarQueryExecutor.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FMarQueryExecutor "
:# $
FBaseExecutor% 2
,2 3
FIQueryExecutor4 C
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
internal   
FMarQueryExecutor   "
(  " #
)!! 
:"" 
base"" 
("" 
)"" 
{## 	
}%% 	
internal)) 
FMarQueryExecutor)) "
())" #
string** 
connectString**  
)++ 
:,, 
base,, 
(,, 
connectString,,  
),,  !
{-- 	
}// 	
~33 	
FMarQueryExecutor33	 
(33 
)44 
{55 	
	myDispose66 
(66 
false66 
)66 
;66 
}77 	
	protected;; 
override;; 
void;; 
	myDispose;;  )
(;;) *
bool;;* .
	disposing;;/ 8
);;8 9
{<< 	
if== 
(== 
!== 

m_disposed== 
)== 
{>> 
if?? 
(?? 
	disposing?? 
)?? 
{@@ 
}BB 

m_disposedCC 
=CC 
trueCC !
;CC! "
baseGG 
.GG 
	myDisposeGG 
(GG 
	disposingGG (
)GG( )
;GG) *
}HH 
}II 	
publicWW 
DataSetWW 
executeWW 
(WW 
intXX 
timeoutXX 
,XX 
boolYY 
sqlClearYY 
)ZZ 
{[[ 	
MySqlConnection\\ 
marCon\\ "
=\\# $
null\\% )
;\\) *
MySqlCommand]] 
marCmd]] 
=]]  !
null]]" &
;]]& '
MySqlDataAdapter^^ 
marAdt^^ #
=^^$ %
null^^& *
;^^* +
DataSet__ 
tempDs__ 
=__ 
null__ !
;__! "
DataSet`` 
ds`` 
=`` 
null`` 
;`` 
	DataTableaa 
dtaa 
=aa 
nullaa 
;aa  
FSqlErrorCollectionbb 

fSqlErrorsbb  *
=bb+ ,
nullbb- 1
;bb1 2
FSqlErrorTypecc 
fSqlErrorTypecc '
=cc( )
FSqlErrorTypecc* 7
.cc7 8
Normalcc8 >
;cc> ?
stringee 
systemee 
=ee 
stringee "
.ee" #
Emptyee# (
;ee( )
stringff 
moduleff 
=ff 
stringff "
.ff" #
Emptyff# (
;ff( )
stringgg 
functiongg 
=gg 
stringgg $
.gg$ %
Emptygg% *
;gg* +
stringhh 
sqlCodehh 
=hh 
stringhh #
.hh# $
Emptyhh$ )
;hh) *
stringii 
errorMessageii 
=ii  !
stringii" (
.ii( )
Emptyii) .
;ii. /
usingkk 
(kk 
marConkk 
=kk 
newkk 
MySqlConnectionkk  /
(kk/ 0
basekk0 4
.kk4 5
connectionStringkk5 E
)kkE F
)kkF G
{ll 
trymm 
{nn 
ifoo 
(oo 
baseoo 
.oo 
sqlListoo #
.oo# $
Countoo$ )
==oo) +
$numoo+ ,
)oo, -
{pp 
FDebugqq 
.qq 
throwFExceptionqq .
(qq. /
stringqq/ 5
.qq5 6
Formatqq6 <
(qq< =

FConstantsqq= G
.qqG H

err_m_0003qqH R
,qqR S
$strqqS ]
)qq] ^
)qq^ _
;qq_ `
}rr 
marCmdvv 
=vv 
marConvv #
.vv# $
CreateCommandvv$ 1
(vv1 2
)vv2 3
;vv3 4
marCmdww 
.ww 
CommandTimeoutww )
=ww* +
timeoutww, 3
;ww3 4
marCmdxx 
.xx 

Connectionxx %
=xx& '
marConxx( .
;xx. /
dsyy 
=yy 
newyy 
DataSetyy $
(yy$ %
)yy% &
;yy& '
tempDszz 
=zz 
newzz  
DataSetzz! (
(zz( )
)zz) *
;zz* +
foreach~~ 
(~~ 
FSql~~ !
fsql~~" &
in~~' )
base~~* .
.~~. /
sqlList~~/ 6
)~~6 7
{ 
system
€€ 
=
€€  
fsql
€€! %
.
€€% &
system
€€& ,
;
€€, -
module
 
=
  
fsql
! %
.
% &
module
& ,
;
, -
function
‚‚  
=
‚‚! "
fsql
‚‚# '
.
‚‚' (
function
‚‚( 0
;
‚‚0 1
sqlCode
ƒƒ 
=
ƒƒ  !
fsql
ƒƒ" &
.
ƒƒ& '
sqlCode
ƒƒ' .
;
ƒƒ. /
marCmd
‹‹ 
.
‹‹ 
CommandText
‹‹ *
=
‹‹+ ,
fsql
‹‹- 1
.
‹‹1 2
sqlEx
‹‹2 7
;
‹‹7 8
foreach
ŒŒ 
(
ŒŒ  !
FSqlParameter
ŒŒ! .
sqlPar
ŒŒ/ 5
in
ŒŒ6 8
fsql
ŒŒ9 =
.
ŒŒ= >$
sqlParameterCollection
ŒŒ> T
)
ŒŒT U
{
 
marCmd
 "
.
" #

Parameters
# -
.
- .
Add
. 1
(
1 2
sqlPar
2 8
.
8 9
mariaDbParameter
9 I
)
I J
;
J K
}
 
marAdt
 
=
  
new
! $
MySqlDataAdapter
% 5
(
5 6
marCmd
6 <
)
< =
;
= >
marAdt
‘‘ 
.
‘‘ 
Fill
‘‘ #
(
‘‘# $
tempDs
‘‘$ *
)
‘‘* +
;
‘‘+ ,
marCmd
’’ 
.
’’ 

Parameters
’’ )
.
’’) *
Clear
’’* /
(
’’/ 0
)
’’0 1
;
’’1 2
dt
–– 
=
–– 
tempDs
–– #
.
––# $
Tables
––$ *
[
––* +
$num
––+ ,
]
––, -
;
––- .
tempDs
—— 
.
—— 
Tables
—— %
.
——% &
Remove
——& ,
(
——, -
dt
——- /
)
——/ 0
;
——0 1
tempDs
˜˜ 
.
˜˜ 
Clear
˜˜ $
(
˜˜$ %
)
˜˜% &
;
˜˜& '
dt
œœ 
.
œœ 
	TableName
œœ $
=
œœ% &
fsql
œœ' +
.
œœ+ ,
name
œœ, 0
;
œœ0 1
ds
 
.
 
Tables
 !
.
! "
Add
" %
(
% &
dt
& (
)
( )
;
) *
}
 
if
¢¢ 
(
¢¢ 
sqlClear
¢¢  
)
¢¢  !
{
££ 
base
¤¤ 
.
¤¤ 
clearSql
¤¤ %
(
¤¤% &
)
¤¤& '
;
¤¤' (
}
¥¥ 
return
¦¦ 
ds
¦¦ 
;
¦¦ 
}
§§ 
catch
¨¨ 
(
¨¨ 
MySqlException
¨¨ $
maEx
¨¨% )
)
¨¨) *
{
©© 
FDebug
ªª 
.
ªª 
writeLog
ªª #
(
ªª# $
maEx
ªª$ (
)
ªª( )
;
ªª) *

fSqlErrors
®® 
=
®®  

FDbAdapter
®®! +
.
®®+ ,
createSqlErrors
®®, ;
(
®®; <
maEx
®®< @
)
®®@ A
;
®®A B
fSqlErrorType
¯¯ !
=
¯¯" #

FDbAdapter
¯¯$ .
.
¯¯. /&
getSqlErrorTypeOfMariaDb
¯¯/ G
(
¯¯G H

fSqlErrors
¯¯H R
)
¯¯R S
;
¯¯S T
errorMessage
±±  
=
±±! "
maEx
²² 
.
²² 
Message
²² $
+
²²% &
Environment
²²' 2
.
²²2 3
NewLine
²²3 :
+
²²; <
$str
³³ "
+
³³# $
system
³³% +
+
³³, -
$str
³³. ;
+
³³< =
module
³³> D
+
³³E F
$str
³³G V
+
³³W X
function
³³Y a
+
³³b c
$str
³³d r
+
³³s t
sqlCode
³³u |
+
³³} ~
$str³³ ‚
;³³‚ ƒ
FDebug
µµ 
.
µµ 
throwException
µµ )
(
µµ) *
new
µµ* -
FDbException
µµ. :
(
µµ: ;
fSqlErrorType
µµ; H
,
µµH I

fSqlErrors
µµJ T
,
µµT U
errorMessage
µµV b
,
µµb c
maEx
µµd h
)
µµh i
)
µµi j
;
µµj k
}
¶¶ 
catch
·· 
(
·· 
	Exception
·· 
ex
··  "
)
··" #
{
¸¸ 
FDebug
¹¹ 
.
¹¹ 
throwException
¹¹ )
(
¹¹) *
ex
¹¹* ,
)
¹¹, -
;
¹¹- .
}
ºº 
finally
»» 
{
¼¼ 
if
½½ 
(
½½ 
marAdt
½½ 
!=
½½ !
null
½½" &
)
½½& '
{
¾¾ 
marAdt
¿¿ 
.
¿¿ 
Dispose
¿¿ &
(
¿¿& '
)
¿¿' (
;
¿¿( )
marAdt
ÀÀ 
=
ÀÀ  
null
ÀÀ! %
;
ÀÀ% &
}
ÁÁ 
if
ÃÃ 
(
ÃÃ 
marCmd
ÃÃ 
!=
ÃÃ !
null
ÃÃ" &
)
ÃÃ& '
{
ÄÄ 
marCmd
ÅÅ 
.
ÅÅ 
Dispose
ÅÅ &
(
ÅÅ& '
)
ÅÅ' (
;
ÅÅ( )
marCmd
ÆÆ 
=
ÆÆ  
null
ÆÆ! %
;
ÆÆ% &
}
ÇÇ 
if
ÉÉ 
(
ÉÉ 
tempDs
ÉÉ 
!=
ÉÉ !
null
ÉÉ" &
)
ÉÉ& '
{
ÊÊ 
tempDs
ËË 
.
ËË 
Dispose
ËË &
(
ËË& '
)
ËË' (
;
ËË( )
tempDs
ÌÌ 
=
ÌÌ  
null
ÌÌ! %
;
ÌÌ% &
}
ÍÍ 
if
ÏÏ 
(
ÏÏ 
marCon
ÏÏ 
!=
ÏÏ !
null
ÏÏ" &
)
ÏÏ& '
{
ĞĞ 
if
ÑÑ 
(
ÑÑ 
marCon
ÑÑ "
.
ÑÑ" #
State
ÑÑ# (
!=
ÑÑ) +
ConnectionState
ÑÑ, ;
.
ÑÑ; <
Closed
ÑÑ< B
)
ÑÑB C
{
ÒÒ 
marCon
ÓÓ "
.
ÓÓ" #
Close
ÓÓ# (
(
ÓÓ( )
)
ÓÓ) *
;
ÓÓ* +
}
ÔÔ 
marCon
ÕÕ 
.
ÕÕ 
Dispose
ÕÕ &
(
ÕÕ& '
)
ÕÕ' (
;
ÕÕ( )
marCon
ÖÖ 
=
ÖÖ  
null
ÖÖ! %
;
ÖÖ% &
}
×× 

fSqlErrors
ÙÙ 
=
ÙÙ  
null
ÙÙ! %
;
ÙÙ% &
}
ÚÚ 
return
ÛÛ 
null
ÛÛ 
;
ÛÛ 
}
ÜÜ 
}
İİ 	
public
áá 
DataSet
áá 
execute
áá 
(
áá 
int
ââ 
timeout
ââ 
)
ãã 
{
ää 	
try
åå 
{
ææ 
return
çç 
execute
çç 
(
çç 
timeout
çç &
,
çç& '
true
çç( ,
)
çç, -
;
çç- .
}
èè 
catch
éé 
(
éé 
	Exception
éé 
ex
éé 
)
éé  
{
êê 
FDebug
ëë 
.
ëë 
throwException
ëë %
(
ëë% &
ex
ëë& (
)
ëë( )
;
ëë) *
}
ìì 
finally
íí 
{
îî 
}
ğğ 
return
ññ 
null
ññ 
;
ññ 
}
òò 	
public
öö 
DataSet
öö 
execute
öö 
(
öö 
bool
÷÷ 
sqlClear
÷÷ 
)
øø 
{
ùù 	
try
úú 
{
ûû 
return
üü 
execute
üü 
(
üü 
base
üü #
.
üü# $
timeout
üü$ +
,
üü+ ,
sqlClear
üü- 5
)
üü5 6
;
üü6 7
}
ıı 
catch
şş 
(
şş 
	Exception
şş 
ex
şş 
)
şş  
{
ÿÿ 
FDebug
€€ 
.
€€ 
throwException
€€ %
(
€€% &
ex
€€& (
)
€€( )
;
€€) *
}
 
finally
‚‚ 
{
ƒƒ 
}
…… 
return
†† 
null
†† 
;
†† 
}
‡‡ 	
public
‹‹ 
DataSet
‹‹ 
execute
‹‹ 
(
‹‹ 
)
ŒŒ 
{
 	
try
 
{
 
return
 
execute
 
(
 
base
 #
.
# $
timeout
$ +
,
+ ,
true
- 1
)
1 2
;
2 3
}
‘‘ 
catch
’’ 
(
’’ 
	Exception
’’ 
ex
’’ 
)
’’  
{
““ 
FDebug
”” 
.
”” 
throwException
”” %
(
””% &
ex
””& (
)
””( )
;
””) *
}
•• 
finally
–– 
{
—— 
}
™™ 
return
šš 
null
šš 
;
šš 
}
œœ 	
}
¢¢ 
}££ m
oD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\MariaDb\c_FMarTransactExecutor.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class  
FMarTransactExecutor %
:& '
FBaseExecutor( 5
,5 6
FITransactExecutor7 I
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
internal!!  
FMarTransactExecutor!! %
(!!% &
)"" 
:## 
base## 
(## 
)## 
{$$ 	
}&& 	
internal**  
FMarTransactExecutor** %
(**% &
string++ 
connectionString++ #
),, 
:-- 
base-- 
(-- 
connectionString-- "
)--" #
{.. 	
}00 	
~44 	 
FMarTransactExecutor44	 
(44 
)55 
{66 	
	myDispose77 
(77 
false77 
)77 
;77 
}88 	
	protected<< 
override<< 
void<< 
	myDispose<<  )
(<<) *
bool== 
	disposing== 
)>> 
{?? 	
if@@ 
(@@ 
!@@ 

m_disposed@@ 
)@@ 
{AA 
ifBB 
(BB 
	disposingBB 
)BB 
{CC 
}EE 

m_disposedFF 
=FF 
trueFF !
;FF! "
baseJJ 
.JJ 
	myDisposeJJ 
(JJ 
	disposingJJ (
)JJ( )
;JJ) *
}KK 
}LL 	
publicZZ 
intZZ 
executeZZ 
(ZZ 
int[[ 
timeout[[ 
,[[ 
bool\\ 
sqlClear\\ 
)]] 
{^^ 	
MySqlConnection__ 
marCon__ "
=__# $
null__% )
;__) *
MySqlTransaction`` 
marTran`` $
=``% &
null``' +
;``+ ,
MySqlCommandaa 
marCmdaa 
=aa  !
nullaa" &
;aa& '
intbb 
rowCountbb 
=bb 
$numbb 
;bb 
FSqlErrorCollectioncc 

fSqlErrorscc  *
=cc+ ,
nullcc- 1
;cc1 2
FSqlErrorTypedd 
fSqlErrorTypedd '
=dd( )
FSqlErrorTypedd* 7
.dd7 8
Normaldd8 >
;dd> ?
stringff 
systemff 
=ff 
stringff "
.ff" #
Emptyff# (
;ff( )
stringgg 
modulegg 
=gg 
stringgg "
.gg" #
Emptygg# (
;gg( )
stringhh 
functionhh 
=hh 
stringhh $
.hh$ %
Emptyhh% *
;hh* +
stringii 
sqlCodeii 
=ii 
stringii #
.ii# $
Emptyii$ )
;ii) *
stringjj 
errorMessagejj 
=jj  !
stringjj" (
.jj( )
Emptyjj) .
;jj. /
usingll 
(ll 
marConll 
=ll 
newll 
MySqlConnectionll  /
(ll/ 0
basell0 4
.ll4 5
connectionStringll5 E
)llE F
)llF G
{mm 
trynn 
{oo 
ifpp 
(pp 
basepp 
.pp 
sqlListpp $
.pp$ %
Countpp% *
==pp+ -
$numpp. /
)pp/ 0
{qq 
FDebugrr 
.rr 
throwFExceptionrr .
(rr. /
stringrr/ 5
.rr5 6
Formatrr6 <
(rr< =

FConstantsrr= G
.rrG H

err_m_0003rrH R
,rrR S
$strrrT ^
)rr^ _
)rr_ `
;rr` a
}ss 
marConww 
.ww 
Openww 
(ww  
)ww  !
;ww! "
whilexx 
(xx 
truexx 
)xx  
{yy 
tryzz 
{{{ 
rowCount|| $
=||% &
$num||' (
;||( )
marTran}} #
=}}$ %
marCon}}& ,
.}}, -
BeginTransaction}}- =
(}}= >
)}}> ?
;}}? @
marCmd~~ "
=~~# $
marCon~~% +
.~~+ ,
CreateCommand~~, 9
(~~9 :
)~~: ;
;~~; <
marCmd "
." #

Connection# -
=. /
marCon0 6
;6 7
marCmd
€€ "
.
€€" #
Transaction
€€# .
=
€€/ 0
marTran
€€1 8
;
€€8 9
marCmd
 "
.
" #
CommandTimeout
# 1
=
2 3
timeout
4 ;
;
; <
foreach
…… #
(
……$ %
FSql
……% )
fsql
……* .
in
……/ 1
base
……2 6
.
……6 7
sqlList
……7 >
)
……> ?
{
†† 
system
‡‡  &
=
‡‡' (
fsql
‡‡) -
.
‡‡- .
system
‡‡. 4
;
‡‡4 5
module
ˆˆ  &
=
ˆˆ' (
fsql
ˆˆ) -
.
ˆˆ- .
module
ˆˆ. 4
;
ˆˆ4 5
function
‰‰  (
=
‰‰) *
fsql
‰‰+ /
.
‰‰/ 0
function
‰‰0 8
;
‰‰8 9
sqlCode
ŠŠ  '
=
ŠŠ( )
fsql
ŠŠ* .
.
ŠŠ. /
sqlCode
ŠŠ/ 6
;
ŠŠ6 7
marCmd
’’  &
.
’’& '
CommandText
’’' 2
=
’’3 4
fsql
’’5 9
.
’’9 :
sqlEx
’’: ?
;
’’? @
foreach
““  '
(
““( )
FSqlParameter
““) 6
sqlPar
““7 =
in
““> @
fsql
““A E
.
““E F$
sqlParameterCollection
““F \
)
““\ ]
{
””  !
marCmd
••$ *
.
••* +

Parameters
••+ 5
.
••5 6
Add
••6 9
(
••9 :
sqlPar
••: @
.
••@ A
mariaDbParameter
••A Q
)
••Q R
;
••R S
}
––  !
rowCount
——  (
+=
——) +
marCmd
——, 2
.
——2 3
ExecuteNonQuery
——3 B
(
——B C
)
——C D
;
——D E
marCmd
˜˜  &
.
˜˜& '

Parameters
˜˜' 1
.
˜˜1 2
Clear
˜˜2 7
(
˜˜7 8
)
˜˜8 9
;
˜˜9 :
}
™™ 
marTran
 #
.
# $
Commit
$ *
(
* +
)
+ ,
;
, -
break
 !
;
! "
}
ŸŸ 
catch
   
(
   
MySqlException
   -
marEx
  . 3
)
  3 4
{
¡¡ 
FDebug
¢¢ "
.
¢¢" #
writeLog
¢¢# +
(
¢¢+ ,
marEx
¢¢, 1
)
¢¢1 2
;
¢¢2 3

fSqlErrors
¦¦ &
=
¦¦' (

FDbAdapter
¦¦) 3
.
¦¦3 4
createSqlErrors
¦¦4 C
(
¦¦C D
marEx
¦¦D I
)
¦¦I J
;
¦¦J K
fSqlErrorType
§§ )
=
§§* +

FDbAdapter
§§, 6
.
§§6 7&
getSqlErrorTypeOfMariaDb
§§7 O
(
§§O P

fSqlErrors
§§P Z
)
§§Z [
;
§§[ \
errorMessage
©© (
=
©©) *
marEx
ªª  %
.
ªª% &
Message
ªª& -
+
ªª. /
Environment
ªª0 ;
.
ªª; <
NewLine
ªª< C
+
ªªD E
$str
««  *
+
««+ ,
system
««- 3
+
««4 5
$str
««6 C
+
««D E
module
««F L
+
««M N
$str
««O ^
+
««_ `
function
««a i
+
««j k
$str
««l z
+
««{ |
sqlCode««} „
+««… †
$str««‡ Š
;««Š ‹
FDebug
­­ "
.
­­" #
throwException
­­# 1
(
­­1 2
new
­­2 5
FDbException
­­6 B
(
­­B C
fSqlErrorType
­­C P
,
­­P Q

fSqlErrors
­­R \
,
­­\ ]
errorMessage
­­^ j
,
­­j k
marEx
­­l q
)
­­q r
)
­­r s
;
­­s t
}
®® 
catch
¯¯ 
(
¯¯ 
	Exception
¯¯ (
ex
¯¯) +
)
¯¯+ ,
{
°° 
FDebug
±± "
.
±±" #
throwException
±±# 1
(
±±1 2
ex
±±2 4
)
±±4 5
;
±±5 6
}
²² 
finally
³³ 
{
´´ 
}
¶¶ 
}
·· 
if
»» 
(
»» 
sqlClear
»»  
)
»»  !
{
¼¼ 
base
½½ 
.
½½ 
clearSql
½½ %
(
½½% &
)
½½& '
;
½½' (
}
¾¾ 
return
¿¿ 
rowCount
¿¿ #
;
¿¿# $
}
ÀÀ 
catch
ÁÁ 
(
ÁÁ 
	Exception
ÁÁ  
ex
ÁÁ! #
)
ÁÁ# $
{
ÂÂ 
if
ÃÃ 
(
ÃÃ 
ex
ÃÃ 
is
ÃÃ 
FDbException
ÃÃ *
||
ÃÃ+ -
ex
ÃÃ. 0
is
ÃÃ1 3
MySqlException
ÃÃ4 B
)
ÃÃB C
{
ÄÄ 
try
ÅÅ 
{
ÆÆ 
if
ÇÇ 
(
ÇÇ  
marTran
ÇÇ  '
!=
ÇÇ( *
null
ÇÇ+ /
)
ÇÇ/ 0
{
ÈÈ 
marTran
ÌÌ  '
.
ÌÌ' (
Rollback
ÌÌ( 0
(
ÌÌ0 1
)
ÌÌ1 2
;
ÌÌ2 3
}
ÍÍ 
}
ÎÎ 
catch
ÏÏ 
(
ÏÏ 
	Exception
ÏÏ (
inEx
ÏÏ) -
)
ÏÏ- .
{
ĞĞ 
FDebug
ÑÑ "
.
ÑÑ" #
writeLog
ÑÑ# +
(
ÑÑ+ ,
inEx
ÑÑ, 0
)
ÑÑ0 1
;
ÑÑ1 2
}
ÒÒ 
}
ÓÓ 
FDebug
×× 
.
×× 
throwException
×× )
(
××) *
ex
××* ,
)
××, -
;
××- .
}
ØØ 
finally
ÙÙ 
{
ÚÚ 
if
ÛÛ 
(
ÛÛ 
marTran
ÛÛ 
!=
ÛÛ  "
null
ÛÛ# '
)
ÛÛ' (
{
ÜÜ 
marTran
İİ 
.
İİ  
Dispose
İİ  '
(
İİ' (
)
İİ( )
;
İİ) *
marTran
ŞŞ 
=
ŞŞ  !
null
ŞŞ" &
;
ŞŞ& '
}
ßß 
if
áá 
(
áá 
marCmd
áá 
!=
áá !
null
áá" &
)
áá& '
{
ââ 
marCmd
ãã 
.
ãã 
Dispose
ãã &
(
ãã& '
)
ãã' (
;
ãã( )
marCmd
ää 
=
ää  
null
ää! %
;
ää% &
}
åå 
if
çç 
(
çç 
marCon
çç 
!=
çç !
null
çç" &
)
çç& '
{
èè 
if
éé 
(
éé 
marCon
éé "
.
éé" #
State
éé# (
!=
éé) +
ConnectionState
éé, ;
.
éé; <
Closed
éé< B
)
ééB C
{
êê 
marCon
ëë "
.
ëë" #
Close
ëë# (
(
ëë( )
)
ëë) *
;
ëë* +
}
ìì 
marCon
íí 
.
íí 
Dispose
íí &
(
íí& '
)
íí' (
;
íí( )
marCon
îî 
=
îî  
null
îî! %
;
îî% &
}
ïï 

fSqlErrors
ññ 
=
ññ  
null
ññ! %
;
ññ% &
}
òò 
}
óó 
return
ôô 
$num
ôô 
;
ôô 
}
õõ 	
public
ùù 
int
ùù 
execute
ùù 
(
ùù 
int
úú 
timeout
úú 
)
ûû 
{
üü 	
try
ıı 
{
şş 
return
ÿÿ 
execute
ÿÿ 
(
ÿÿ 
timeout
ÿÿ &
,
ÿÿ& '
true
ÿÿ( ,
)
ÿÿ, -
;
ÿÿ- .
}
€€ 
catch
 
(
 
	Exception
 
ex
 
)
  
{
‚‚ 
FDebug
ƒƒ 
.
ƒƒ 
throwException
ƒƒ %
(
ƒƒ% &
ex
ƒƒ& (
)
ƒƒ( )
;
ƒƒ) *
}
„„ 
finally
…… 
{
†† 
}
ˆˆ 
return
‰‰ 
$num
‰‰ 
;
‰‰ 
}
ŠŠ 	
public
 
int
 
execute
 
(
 
bool
 
sqlClear
 
)
 
{
‘‘ 	
try
’’ 
{
““ 
return
”” 
execute
”” 
(
”” 
base
”” #
.
””# $
timeout
””$ +
,
””+ ,
sqlClear
””- 5
)
””5 6
;
””6 7
}
•• 
catch
–– 
(
–– 
	Exception
–– 
ex
–– 
)
––  
{
—— 
FDebug
˜˜ 
.
˜˜ 
throwException
˜˜ %
(
˜˜% &
ex
˜˜& (
)
˜˜( )
;
˜˜) *
}
™™ 
finally
šš 
{
›› 
}
 
return
 
$num
 
;
 
}
ŸŸ 	
public
££ 
int
££ 
execute
££ 
(
££ 
)
¤¤ 
{
¥¥ 	
try
¦¦ 
{
§§ 
return
¨¨ 
execute
¨¨ 
(
¨¨ 
base
¨¨ #
.
¨¨# $
timeout
¨¨$ +
,
¨¨+ ,
true
¨¨- 1
)
¨¨1 2
;
¨¨2 3
}
©© 
catch
ªª 
(
ªª 
	Exception
ªª 
ex
ªª 
)
ªª  
{
«« 
FDebug
¬¬ 
.
¬¬ 
throwException
¬¬ %
(
¬¬% &
ex
¬¬& (
)
¬¬( )
;
¬¬) *
}
­­ 
finally
®® 
{
¯¯ 
}
±± 
return
²² 
$num
²² 
;
²² 
}
³³ 	
}
¹¹ 
}ºº ëj
jD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\MySql\c_FMysQueryExecutor.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FMysQueryExecutor "
:# $
FBaseExecutor% 2
,2 3
FIQueryExecutor4 C
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
internal   
FMysQueryExecutor   "
(  " #
)!! 
:"" 
base"" 
("" 
)"" 
{## 	
}%% 	
internal)) 
FMysQueryExecutor)) "
())" #
string** 
connectString**  
)++ 
:,, 
base,, 
(,, 
connectString,,  
),,  !
{-- 	
}// 	
~33 	
FMysQueryExecutor33	 
(33 
)44 
{55 	
	myDispose66 
(66 
false66 
)66 
;66 
}77 	
	protected;; 
override;; 
void;; 
	myDispose;;  )
(;;) *
bool;;* .
	disposing;;/ 8
);;8 9
{<< 	
if== 
(== 
!== 

m_disposed== 
)== 
{>> 
if?? 
(?? 
	disposing?? 
)?? 
{@@ 
}BB 

m_disposedCC 
=CC 
trueCC !
;CC! "
baseGG 
.GG 
	myDisposeGG 
(GG 
	disposingGG (
)GG( )
;GG) *
}HH 
}II 	
publicWW 
DataSetWW 
executeWW 
(WW 
intXX 
timeoutXX 
,XX 
boolYY 
sqlClearYY 
)ZZ 
{[[ 	
MySqlConnection\\ 
mysCon\\ "
=\\# $
null\\% )
;\\) *
MySqlCommand]] 
mysCmd]] 
=]]  !
null]]" &
;]]& '
MySqlDataAdapter^^ 
mysAdt^^ #
=^^$ %
null^^& *
;^^* +
DataSet__ 
tempDs__ 
=__ 
null__ !
;__! "
DataSet`` 
ds`` 
=`` 
null`` 
;`` 
	DataTableaa 
dtaa 
=aa 
nullaa 
;aa  
FSqlErrorCollectionbb 

fSqlErrorsbb  *
=bb+ ,
nullbb- 1
;bb1 2
FSqlErrorTypecc 
fSqlErrorTypecc '
=cc( )
FSqlErrorTypecc* 7
.cc7 8
Normalcc8 >
;cc> ?
stringee 
systemee 
=ee 
stringee "
.ee" #
Emptyee# (
;ee( )
stringff 
moduleff 
=ff 
stringff "
.ff" #
Emptyff# (
;ff( )
stringgg 
functiongg 
=gg 
stringgg $
.gg$ %
Emptygg% *
;gg* +
stringhh 
sqlCodehh 
=hh 
stringhh #
.hh# $
Emptyhh$ )
;hh) *
stringii 
errorMessageii 
=ii  !
stringii" (
.ii( )
Emptyii) .
;ii. /
usingkk 
(kk 
mysConkk 
=kk 
newkk 
MySqlConnectionkk  /
(kk/ 0
basekk0 4
.kk4 5
connectionStringkk5 E
)kkE F
)kkF G
{ll 
trymm 
{nn 
ifoo 
(oo 
baseoo 
.oo 
sqlListoo #
.oo# $
Countoo$ )
==oo) +
$numoo+ ,
)oo, -
{pp 
FDebugqq 
.qq 
throwFExceptionqq .
(qq. /
stringqq/ 5
.qq5 6
Formatqq6 <
(qq< =

FConstantsqq= G
.qqG H

err_m_0003qqH R
,qqR S
$strqqS ]
)qq] ^
)qq^ _
;qq_ `
}rr 
mysCmdvv 
=vv 
mysConvv #
.vv# $
CreateCommandvv$ 1
(vv1 2
)vv2 3
;vv3 4
mysCmdww 
.ww 
CommandTimeoutww )
=ww* +
timeoutww, 3
;ww3 4
mysCmdxx 
.xx 

Connectionxx %
=xx& '
mysConxx( .
;xx. /
dsyy 
=yy 
newyy 
DataSetyy $
(yy$ %
)yy% &
;yy& '
tempDszz 
=zz 
newzz  
DataSetzz! (
(zz( )
)zz) *
;zz* +
foreach~~ 
(~~ 
FSql~~ !
fsql~~" &
in~~' )
base~~* .
.~~. /
sqlList~~/ 6
)~~6 7
{ 
system
€€ 
=
€€  
fsql
€€! %
.
€€% &
system
€€& ,
;
€€, -
module
 
=
  
fsql
! %
.
% &
module
& ,
;
, -
function
‚‚  
=
‚‚! "
fsql
‚‚# '
.
‚‚' (
function
‚‚( 0
;
‚‚0 1
sqlCode
ƒƒ 
=
ƒƒ  !
fsql
ƒƒ" &
.
ƒƒ& '
sqlCode
ƒƒ' .
;
ƒƒ. /
mysCmd
‹‹ 
.
‹‹ 
CommandText
‹‹ *
=
‹‹+ ,
fsql
‹‹- 1
.
‹‹1 2
sqlEx
‹‹2 7
;
‹‹7 8
foreach
ŒŒ 
(
ŒŒ  !
FSqlParameter
ŒŒ! .
sqlPar
ŒŒ/ 5
in
ŒŒ6 8
fsql
ŒŒ9 =
.
ŒŒ= >$
sqlParameterCollection
ŒŒ> T
)
ŒŒT U
{
 
mysCmd
 "
.
" #

Parameters
# -
.
- .
Add
. 1
(
1 2
sqlPar
2 8
.
8 9
mySqlParameter
9 G
)
G H
;
H I
}
 
mysAdt
 
=
  
new
! $
MySqlDataAdapter
% 5
(
5 6
mysCmd
6 <
)
< =
;
= >
mysAdt
‘‘ 
.
‘‘ 
Fill
‘‘ #
(
‘‘# $
tempDs
‘‘$ *
)
‘‘* +
;
‘‘+ ,
mysCmd
’’ 
.
’’ 

Parameters
’’ )
.
’’) *
Clear
’’* /
(
’’/ 0
)
’’0 1
;
’’1 2
dt
–– 
=
–– 
tempDs
–– #
.
––# $
Tables
––$ *
[
––* +
$num
––+ ,
]
––, -
;
––- .
tempDs
—— 
.
—— 
Tables
—— %
.
——% &
Remove
——& ,
(
——, -
dt
——- /
)
——/ 0
;
——0 1
tempDs
˜˜ 
.
˜˜ 
Clear
˜˜ $
(
˜˜$ %
)
˜˜% &
;
˜˜& '
dt
œœ 
.
œœ 
	TableName
œœ $
=
œœ% &
fsql
œœ' +
.
œœ+ ,
name
œœ, 0
;
œœ0 1
ds
 
.
 
Tables
 !
.
! "
Add
" %
(
% &
dt
& (
)
( )
;
) *
}
 
if
¢¢ 
(
¢¢ 
sqlClear
¢¢  
)
¢¢  !
{
££ 
base
¤¤ 
.
¤¤ 
clearSql
¤¤ %
(
¤¤% &
)
¤¤& '
;
¤¤' (
}
¥¥ 
return
¦¦ 
ds
¦¦ 
;
¦¦ 
}
§§ 
catch
¨¨ 
(
¨¨ 
MySqlException
¨¨ $
mysEx
¨¨% *
)
¨¨* +
{
©© 
FDebug
ªª 
.
ªª 
writeLog
ªª #
(
ªª# $
mysEx
ªª$ )
)
ªª) *
;
ªª* +

fSqlErrors
®® 
=
®®  

FDbAdapter
®®! +
.
®®+ ,
createSqlErrors
®®, ;
(
®®; <
mysEx
®®< A
)
®®A B
;
®®B C
fSqlErrorType
¯¯ !
=
¯¯" #

FDbAdapter
¯¯$ .
.
¯¯. /$
getSqlErrorTypeOfMySql
¯¯/ E
(
¯¯E F

fSqlErrors
¯¯F P
)
¯¯P Q
;
¯¯Q R
errorMessage
±±  
=
±±! "
mysEx
²² 
.
²² 
Message
²² %
+
²²& '
Environment
²²( 3
.
²²3 4
NewLine
²²4 ;
+
²²< =
$str
³³ "
+
³³# $
system
³³% +
+
³³, -
$str
³³. ;
+
³³< =
module
³³> D
+
³³E F
$str
³³G V
+
³³W X
function
³³Y a
+
³³b c
$str
³³d r
+
³³s t
sqlCode
³³u |
+
³³} ~
$str³³ ‚
;³³‚ ƒ
FDebug
µµ 
.
µµ 
throwException
µµ )
(
µµ) *
new
µµ* -
FDbException
µµ. :
(
µµ: ;
fSqlErrorType
µµ; H
,
µµH I

fSqlErrors
µµJ T
,
µµT U
errorMessage
µµV b
,
µµb c
mysEx
µµd i
)
µµi j
)
µµj k
;
µµk l
}
¶¶ 
catch
·· 
(
·· 
	Exception
·· 
ex
··  "
)
··" #
{
¸¸ 
FDebug
¹¹ 
.
¹¹ 
throwException
¹¹ )
(
¹¹) *
ex
¹¹* ,
)
¹¹, -
;
¹¹- .
}
ºº 
finally
»» 
{
¼¼ 
if
½½ 
(
½½ 
mysAdt
½½ 
!=
½½ !
null
½½" &
)
½½& '
{
¾¾ 
mysAdt
¿¿ 
.
¿¿ 
Dispose
¿¿ &
(
¿¿& '
)
¿¿' (
;
¿¿( )
mysAdt
ÀÀ 
=
ÀÀ  
null
ÀÀ! %
;
ÀÀ% &
}
ÁÁ 
if
ÃÃ 
(
ÃÃ 
mysCmd
ÃÃ 
!=
ÃÃ !
null
ÃÃ" &
)
ÃÃ& '
{
ÄÄ 
mysCmd
ÅÅ 
.
ÅÅ 
Dispose
ÅÅ &
(
ÅÅ& '
)
ÅÅ' (
;
ÅÅ( )
mysCmd
ÆÆ 
=
ÆÆ  
null
ÆÆ! %
;
ÆÆ% &
}
ÇÇ 
if
ÉÉ 
(
ÉÉ 
tempDs
ÉÉ 
!=
ÉÉ !
null
ÉÉ" &
)
ÉÉ& '
{
ÊÊ 
tempDs
ËË 
.
ËË 
Dispose
ËË &
(
ËË& '
)
ËË' (
;
ËË( )
tempDs
ÌÌ 
=
ÌÌ  
null
ÌÌ! %
;
ÌÌ% &
}
ÍÍ 
if
ÏÏ 
(
ÏÏ 
mysCon
ÏÏ 
!=
ÏÏ !
null
ÏÏ" &
)
ÏÏ& '
{
ĞĞ 
if
ÑÑ 
(
ÑÑ 
mysCon
ÑÑ "
.
ÑÑ" #
State
ÑÑ# (
!=
ÑÑ) +
ConnectionState
ÑÑ, ;
.
ÑÑ; <
Closed
ÑÑ< B
)
ÑÑB C
{
ÒÒ 
mysCon
ÓÓ "
.
ÓÓ" #
Close
ÓÓ# (
(
ÓÓ( )
)
ÓÓ) *
;
ÓÓ* +
}
ÔÔ 
mysCon
ÕÕ 
.
ÕÕ 
Dispose
ÕÕ &
(
ÕÕ& '
)
ÕÕ' (
;
ÕÕ( )
mysCon
ÖÖ 
=
ÖÖ  
null
ÖÖ! %
;
ÖÖ% &
}
×× 

fSqlErrors
ÙÙ 
=
ÙÙ  
null
ÙÙ! %
;
ÙÙ% &
}
ÚÚ 
return
ÛÛ 
null
ÛÛ 
;
ÛÛ 
}
ÜÜ 
}
İİ 	
public
áá 
DataSet
áá 
execute
áá 
(
áá 
int
ââ 
timeout
ââ 
)
ãã 
{
ää 	
try
åå 
{
ææ 
return
çç 
execute
çç 
(
çç 
timeout
çç &
,
çç& '
true
çç( ,
)
çç, -
;
çç- .
}
èè 
catch
éé 
(
éé 
	Exception
éé 
ex
éé 
)
éé  
{
êê 
FDebug
ëë 
.
ëë 
throwException
ëë %
(
ëë% &
ex
ëë& (
)
ëë( )
;
ëë) *
}
ìì 
finally
íí 
{
îî 
}
ğğ 
return
ññ 
null
ññ 
;
ññ 
}
òò 	
public
öö 
DataSet
öö 
execute
öö 
(
öö 
bool
÷÷ 
sqlClear
÷÷ 
)
øø 
{
ùù 	
try
úú 
{
ûû 
return
üü 
execute
üü 
(
üü 
base
üü #
.
üü# $
timeout
üü$ +
,
üü+ ,
sqlClear
üü- 5
)
üü5 6
;
üü6 7
}
ıı 
catch
şş 
(
şş 
	Exception
şş 
ex
şş 
)
şş  
{
ÿÿ 
FDebug
€€ 
.
€€ 
throwException
€€ %
(
€€% &
ex
€€& (
)
€€( )
;
€€) *
}
 
finally
‚‚ 
{
ƒƒ 
}
…… 
return
†† 
null
†† 
;
†† 
}
‡‡ 	
public
‹‹ 
DataSet
‹‹ 
execute
‹‹ 
(
‹‹ 
)
ŒŒ 
{
 	
try
 
{
 
return
 
execute
 
(
 
base
 #
.
# $
timeout
$ +
,
+ ,
true
- 1
)
1 2
;
2 3
}
‘‘ 
catch
’’ 
(
’’ 
	Exception
’’ 
ex
’’ 
)
’’  
{
““ 
FDebug
”” 
.
”” 
throwException
”” %
(
””% &
ex
””& (
)
””( )
;
””) *
}
•• 
finally
–– 
{
—— 
}
™™ 
return
šš 
null
šš 
;
šš 
}
œœ 	
}
¢¢ 
}££ ˜m
mD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\MySql\c_FMysTransactExecutor.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class  
FMysTransactExecutor %
:& '
FBaseExecutor( 5
,5 6
FITransactExecutor7 I
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
internal!!  
FMysTransactExecutor!! %
(!!% &
)"" 
:## 
base## 
(## 
)## 
{$$ 	
}&& 	
internal**  
FMysTransactExecutor** %
(**% &
string++ 
connectionString++ #
),, 
:-- 
base-- 
(-- 
connectionString-- "
)--" #
{.. 	
}00 	
~44 	 
FMysTransactExecutor44	 
(44 
)55 
{66 	
	myDispose77 
(77 
false77 
)77 
;77 
}88 	
	protected<< 
override<< 
void<< 
	myDispose<<  )
(<<) *
bool== 
	disposing== 
)>> 
{?? 	
if@@ 
(@@ 
!@@ 

m_disposed@@ 
)@@ 
{AA 
ifBB 
(BB 
	disposingBB 
)BB 
{CC 
}EE 

m_disposedFF 
=FF 
trueFF !
;FF! "
baseJJ 
.JJ 
	myDisposeJJ 
(JJ 
	disposingJJ (
)JJ( )
;JJ) *
}KK 
}LL 	
publicZZ 
intZZ 
executeZZ 
(ZZ 
int[[ 
timeout[[ 
,[[ 
bool\\ 
sqlClear\\ 
)]] 
{^^ 	
MySqlConnection__ 
mysCon__ "
=__# $
null__% )
;__) *
MySqlTransaction`` 
mysTran`` $
=``% &
null``' +
;``+ ,
MySqlCommandaa 
mysCmdaa 
=aa  !
nullaa" &
;aa& '
intbb 
rowCountbb 
=bb 
$numbb 
;bb 
FSqlErrorCollectioncc 

fSqlErrorscc  *
=cc+ ,
nullcc- 1
;cc1 2
FSqlErrorTypedd 
fSqlErrorTypedd '
=dd( )
FSqlErrorTypedd* 7
.dd7 8
Normaldd8 >
;dd> ?
stringff 
systemff 
=ff 
stringff "
.ff" #
Emptyff# (
;ff( )
stringgg 
modulegg 
=gg 
stringgg "
.gg" #
Emptygg# (
;gg( )
stringhh 
functionhh 
=hh 
stringhh $
.hh$ %
Emptyhh% *
;hh* +
stringii 
sqlCodeii 
=ii 
stringii #
.ii# $
Emptyii$ )
;ii) *
stringjj 
errorMessagejj 
=jj  !
stringjj" (
.jj( )
Emptyjj) .
;jj. /
usingll 
(ll 
mysConll 
=ll 
newll 
MySqlConnectionll  /
(ll/ 0
basell0 4
.ll4 5
connectionStringll5 E
)llE F
)llF G
{mm 
trynn 
{oo 
ifpp 
(pp 
basepp 
.pp 
sqlListpp $
.pp$ %
Countpp% *
==pp+ -
$numpp. /
)pp/ 0
{qq 
FDebugrr 
.rr 
throwFExceptionrr .
(rr. /
stringrr/ 5
.rr5 6
Formatrr6 <
(rr< =

FConstantsrr= G
.rrG H

err_m_0003rrH R
,rrR S
$strrrT ^
)rr^ _
)rr_ `
;rr` a
}ss 
mysConww 
.ww 
Openww 
(ww  
)ww  !
;ww! "
whilexx 
(xx 
truexx 
)xx  
{yy 
tryzz 
{{{ 
rowCount|| $
=||% &
$num||' (
;||( )
mysTran}} #
=}}$ %
mysCon}}& ,
.}}, -
BeginTransaction}}- =
(}}= >
)}}> ?
;}}? @
mysCmd~~ "
=~~# $
mysCon~~% +
.~~+ ,
CreateCommand~~, 9
(~~9 :
)~~: ;
;~~; <
mysCmd "
." #

Connection# -
=. /
mysCon0 6
;6 7
mysCmd
€€ "
.
€€" #
Transaction
€€# .
=
€€/ 0
mysTran
€€1 8
;
€€8 9
mysCmd
 "
.
" #
CommandTimeout
# 1
=
2 3
timeout
4 ;
;
; <
foreach
…… #
(
……$ %
FSql
……% )
fsql
……* .
in
……/ 1
base
……2 6
.
……6 7
sqlList
……7 >
)
……> ?
{
†† 
system
‡‡  &
=
‡‡' (
fsql
‡‡) -
.
‡‡- .
system
‡‡. 4
;
‡‡4 5
module
ˆˆ  &
=
ˆˆ' (
fsql
ˆˆ) -
.
ˆˆ- .
module
ˆˆ. 4
;
ˆˆ4 5
function
‰‰  (
=
‰‰) *
fsql
‰‰+ /
.
‰‰/ 0
function
‰‰0 8
;
‰‰8 9
sqlCode
ŠŠ  '
=
ŠŠ( )
fsql
ŠŠ* .
.
ŠŠ. /
sqlCode
ŠŠ/ 6
;
ŠŠ6 7
mysCmd
’’  &
.
’’& '
CommandText
’’' 2
=
’’3 4
fsql
’’5 9
.
’’9 :
sqlEx
’’: ?
;
’’? @
foreach
““  '
(
““( )
FSqlParameter
““) 6
sqlPar
““7 =
in
““> @
fsql
““A E
.
““E F$
sqlParameterCollection
““F \
)
““\ ]
{
””  !
mysCmd
••$ *
.
••* +

Parameters
••+ 5
.
••5 6
Add
••6 9
(
••9 :
sqlPar
••: @
.
••@ A
mySqlParameter
••A O
)
••O P
;
••P Q
}
––  !
rowCount
——  (
+=
——) +
mysCmd
——, 2
.
——2 3
ExecuteNonQuery
——3 B
(
——B C
)
——C D
;
——D E
mysCmd
˜˜  &
.
˜˜& '

Parameters
˜˜' 1
.
˜˜1 2
Clear
˜˜2 7
(
˜˜7 8
)
˜˜8 9
;
˜˜9 :
}
™™ 
mysTran
 #
.
# $
Commit
$ *
(
* +
)
+ ,
;
, -
break
 !
;
! "
}
ŸŸ 
catch
   
(
   
MySqlException
   -
mysEx
  . 3
)
  3 4
{
¡¡ 
FDebug
¢¢ "
.
¢¢" #
writeLog
¢¢# +
(
¢¢+ ,
mysEx
¢¢, 1
)
¢¢1 2
;
¢¢2 3

fSqlErrors
¦¦ &
=
¦¦' (

FDbAdapter
¦¦) 3
.
¦¦3 4
createSqlErrors
¦¦4 C
(
¦¦C D
mysEx
¦¦D I
)
¦¦I J
;
¦¦J K
fSqlErrorType
§§ )
=
§§* +

FDbAdapter
§§, 6
.
§§6 7$
getSqlErrorTypeOfMySql
§§7 M
(
§§M N

fSqlErrors
§§N X
)
§§X Y
;
§§Y Z
errorMessage
©© (
=
©©) *
mysEx
ªª  %
.
ªª% &
Message
ªª& -
+
ªª. /
Environment
ªª0 ;
.
ªª; <
NewLine
ªª< C
+
ªªD E
$str
««  *
+
««+ ,
system
««- 3
+
««4 5
$str
««6 C
+
««D E
module
««F L
+
««M N
$str
««O ^
+
««_ `
function
««a i
+
««j k
$str
««l z
+
««{ |
sqlCode««} „
+««… †
$str««‡ Š
;««Š ‹
FDebug
­­ "
.
­­" #
throwException
­­# 1
(
­­1 2
new
­­2 5
FDbException
­­6 B
(
­­B C
fSqlErrorType
­­C P
,
­­P Q

fSqlErrors
­­R \
,
­­\ ]
errorMessage
­­^ j
,
­­j k
mysEx
­­l q
)
­­q r
)
­­r s
;
­­s t
}
®® 
catch
¯¯ 
(
¯¯ 
	Exception
¯¯ (
ex
¯¯) +
)
¯¯+ ,
{
°° 
FDebug
±± "
.
±±" #
throwException
±±# 1
(
±±1 2
ex
±±2 4
)
±±4 5
;
±±5 6
}
²² 
finally
³³ 
{
´´ 
}
¶¶ 
}
·· 
if
»» 
(
»» 
sqlClear
»»  
)
»»  !
{
¼¼ 
base
½½ 
.
½½ 
clearSql
½½ %
(
½½% &
)
½½& '
;
½½' (
}
¾¾ 
return
¿¿ 
rowCount
¿¿ #
;
¿¿# $
}
ÀÀ 
catch
ÁÁ 
(
ÁÁ 
	Exception
ÁÁ  
ex
ÁÁ! #
)
ÁÁ# $
{
ÂÂ 
if
ÃÃ 
(
ÃÃ 
ex
ÃÃ 
is
ÃÃ 
FDbException
ÃÃ *
||
ÃÃ+ -
ex
ÃÃ. 0
is
ÃÃ1 3
MySqlException
ÃÃ4 B
)
ÃÃB C
{
ÄÄ 
try
ÅÅ 
{
ÆÆ 
if
ÇÇ 
(
ÇÇ  
mysTran
ÇÇ  '
!=
ÇÇ( *
null
ÇÇ+ /
)
ÇÇ/ 0
{
ÈÈ 
mysTran
ÌÌ  '
.
ÌÌ' (
Rollback
ÌÌ( 0
(
ÌÌ0 1
)
ÌÌ1 2
;
ÌÌ2 3
}
ÍÍ 
}
ÎÎ 
catch
ÏÏ 
(
ÏÏ 
	Exception
ÏÏ (
inEx
ÏÏ) -
)
ÏÏ- .
{
ĞĞ 
FDebug
ÑÑ "
.
ÑÑ" #
writeLog
ÑÑ# +
(
ÑÑ+ ,
inEx
ÑÑ, 0
)
ÑÑ0 1
;
ÑÑ1 2
}
ÒÒ 
}
ÓÓ 
FDebug
×× 
.
×× 
throwException
×× )
(
××) *
ex
××* ,
)
××, -
;
××- .
}
ØØ 
finally
ÙÙ 
{
ÚÚ 
if
ÛÛ 
(
ÛÛ 
mysTran
ÛÛ 
!=
ÛÛ  "
null
ÛÛ# '
)
ÛÛ' (
{
ÜÜ 
mysTran
İİ 
.
İİ  
Dispose
İİ  '
(
İİ' (
)
İİ( )
;
İİ) *
mysTran
ŞŞ 
=
ŞŞ  !
null
ŞŞ" &
;
ŞŞ& '
}
ßß 
if
áá 
(
áá 
mysCmd
áá 
!=
áá !
null
áá" &
)
áá& '
{
ââ 
mysCmd
ãã 
.
ãã 
Dispose
ãã &
(
ãã& '
)
ãã' (
;
ãã( )
mysCmd
ää 
=
ää  
null
ää! %
;
ää% &
}
åå 
if
çç 
(
çç 
mysCon
çç 
!=
çç !
null
çç" &
)
çç& '
{
èè 
if
éé 
(
éé 
mysCon
éé "
.
éé" #
State
éé# (
!=
éé) +
ConnectionState
éé, ;
.
éé; <
Closed
éé< B
)
ééB C
{
êê 
mysCon
ëë "
.
ëë" #
Close
ëë# (
(
ëë( )
)
ëë) *
;
ëë* +
}
ìì 
mysCon
íí 
.
íí 
Dispose
íí &
(
íí& '
)
íí' (
;
íí( )
mysCon
îî 
=
îî  
null
îî! %
;
îî% &
}
ïï 

fSqlErrors
ññ 
=
ññ  
null
ññ! %
;
ññ% &
}
òò 
}
óó 
return
ôô 
$num
ôô 
;
ôô 
}
õõ 	
public
ùù 
int
ùù 
execute
ùù 
(
ùù 
int
úú 
timeout
úú 
)
ûû 
{
üü 	
try
ıı 
{
şş 
return
ÿÿ 
execute
ÿÿ 
(
ÿÿ 
timeout
ÿÿ &
,
ÿÿ& '
true
ÿÿ( ,
)
ÿÿ, -
;
ÿÿ- .
}
€€ 
catch
 
(
 
	Exception
 
ex
 
)
  
{
‚‚ 
FDebug
ƒƒ 
.
ƒƒ 
throwException
ƒƒ %
(
ƒƒ% &
ex
ƒƒ& (
)
ƒƒ( )
;
ƒƒ) *
}
„„ 
finally
…… 
{
†† 
}
ˆˆ 
return
‰‰ 
$num
‰‰ 
;
‰‰ 
}
ŠŠ 	
public
 
int
 
execute
 
(
 
bool
 
sqlClear
 
)
 
{
‘‘ 	
try
’’ 
{
““ 
return
”” 
execute
”” 
(
”” 
base
”” #
.
””# $
timeout
””$ +
,
””+ ,
sqlClear
””- 5
)
””5 6
;
””6 7
}
•• 
catch
–– 
(
–– 
	Exception
–– 
ex
–– 
)
––  
{
—— 
FDebug
˜˜ 
.
˜˜ 
throwException
˜˜ %
(
˜˜% &
ex
˜˜& (
)
˜˜( )
;
˜˜) *
}
™™ 
finally
šš 
{
›› 
}
 
return
 
$num
 
;
 
}
ŸŸ 	
public
££ 
int
££ 
execute
££ 
(
££ 
)
¤¤ 
{
¥¥ 	
try
¦¦ 
{
§§ 
return
¨¨ 
execute
¨¨ 
(
¨¨ 
base
¨¨ #
.
¨¨# $
timeout
¨¨$ +
,
¨¨+ ,
true
¨¨- 1
)
¨¨1 2
;
¨¨2 3
}
©© 
catch
ªª 
(
ªª 
	Exception
ªª 
ex
ªª 
)
ªª  
{
«« 
FDebug
¬¬ 
.
¬¬ 
throwException
¬¬ %
(
¬¬% &
ex
¬¬& (
)
¬¬( )
;
¬¬) *
}
­­ 
finally
®® 
{
¯¯ 
}
±± 
return
²² 
$num
²² 
;
²² 
}
³³ 	
}
¹¹ 
}ºº ûj
oD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\PostgreSql\c_FPgsQueryExecutor.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FPgsQueryExecutor "
:# $
FBaseExecutor% 2
,2 3
FIQueryExecutor4 C
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
internal   
FPgsQueryExecutor   "
(  " #
)!! 
:"" 
base"" 
("" 
)"" 
{## 	
}%% 	
internal)) 
FPgsQueryExecutor)) "
())" #
string** 
connectString**  
)++ 
:,, 
base,, 
(,, 
connectString,,  
),,  !
{-- 	
}// 	
~33 	
FPgsQueryExecutor33	 
(33 
)44 
{55 	
	myDispose66 
(66 
false66 
)66 
;66 
}77 	
	protected;; 
override;; 
void;; 
	myDispose;;  )
(;;) *
bool;;* .
	disposing;;/ 8
);;8 9
{<< 	
if== 
(== 
!== 

m_disposed== 
)== 
{>> 
if?? 
(?? 
	disposing?? 
)?? 
{@@ 
}BB 

m_disposedCC 
=CC 
trueCC !
;CC! "
baseGG 
.GG 
	myDisposeGG 
(GG 
	disposingGG (
)GG( )
;GG) *
}HH 
}II 	
publicWW 
DataSetWW 
executeWW 
(WW 
intXX 
timeoutXX 
,XX 
boolYY 
sqlClearYY 
)ZZ 
{[[ 	
NpgsqlConnection\\ 
pgsCon\\ #
=\\$ %
null\\& *
;\\* +
NpgsqlCommand]] 
pgsCmd]]  
=]]! "
null]]# '
;]]' (
NpgsqlDataAdapter^^ 
pgsAdt^^ $
=^^% &
null^^' +
;^^+ ,
DataSet__ 
tempDs__ 
=__ 
null__ !
;__! "
DataSet`` 
ds`` 
=`` 
null`` 
;`` 
	DataTableaa 
dtaa 
=aa 
nullaa 
;aa  
FSqlErrorCollectionbb 

fSqlErrorsbb  *
=bb+ ,
nullbb- 1
;bb1 2
FSqlErrorTypecc 
fSqlErrorTypecc '
=cc( )
FSqlErrorTypecc* 7
.cc7 8
Normalcc8 >
;cc> ?
stringee 
systemee 
=ee 
stringee "
.ee" #
Emptyee# (
;ee( )
stringff 
moduleff 
=ff 
stringff "
.ff" #
Emptyff# (
;ff( )
stringgg 
functiongg 
=gg 
stringgg $
.gg$ %
Emptygg% *
;gg* +
stringhh 
sqlCodehh 
=hh 
stringhh #
.hh# $
Emptyhh$ )
;hh) *
stringii 
errorMessageii 
=ii  !
stringii" (
.ii( )
Emptyii) .
;ii. /
usingkk 
(kk 
pgsConkk 
=kk 
newkk 
NpgsqlConnectionkk  0
(kk0 1
basekk1 5
.kk5 6
connectionStringkk6 F
)kkF G
)kkG H
{ll 
trymm 
{nn 
ifoo 
(oo 
baseoo 
.oo 
sqlListoo #
.oo# $
Countoo$ )
==oo) +
$numoo+ ,
)oo, -
{pp 
FDebugqq 
.qq 
throwFExceptionqq .
(qq. /
stringqq/ 5
.qq5 6
Formatqq6 <
(qq< =

FConstantsqq= G
.qqG H

err_m_0003qqH R
,qqR S
$strqqS ]
)qq] ^
)qq^ _
;qq_ `
}rr 
pgsCmdvv 
=vv 
pgsConvv #
.vv# $
CreateCommandvv$ 1
(vv1 2
)vv2 3
;vv3 4
pgsCmdww 
.ww 
CommandTimeoutww )
=ww* +
timeoutww, 3
;ww3 4
pgsCmdxx 
.xx 

Connectionxx %
=xx& '
pgsConxx( .
;xx. /
dsyy 
=yy 
newyy 
DataSetyy $
(yy$ %
)yy% &
;yy& '
tempDszz 
=zz 
newzz  
DataSetzz! (
(zz( )
)zz) *
;zz* +
foreach~~ 
(~~ 
FSql~~ !
fsql~~" &
in~~' )
base~~* .
.~~. /
sqlList~~/ 6
)~~6 7
{ 
system
€€ 
=
€€  
fsql
€€! %
.
€€% &
system
€€& ,
;
€€, -
module
 
=
  
fsql
! %
.
% &
module
& ,
;
, -
function
‚‚  
=
‚‚! "
fsql
‚‚# '
.
‚‚' (
function
‚‚( 0
;
‚‚0 1
sqlCode
ƒƒ 
=
ƒƒ  !
fsql
ƒƒ" &
.
ƒƒ& '
sqlCode
ƒƒ' .
;
ƒƒ. /
pgsCmd
‹‹ 
.
‹‹ 
CommandText
‹‹ *
=
‹‹+ ,
fsql
‹‹- 1
.
‹‹1 2
sqlEx
‹‹2 7
;
‹‹7 8
foreach
ŒŒ 
(
ŒŒ  !
FSqlParameter
ŒŒ! .
sqlPar
ŒŒ/ 5
in
ŒŒ6 8
fsql
ŒŒ9 =
.
ŒŒ= >$
sqlParameterCollection
ŒŒ> T
)
ŒŒT U
{
 
pgsCmd
 "
.
" #

Parameters
# -
.
- .
Add
. 1
(
1 2
sqlPar
2 8
.
8 9
pgSqlParameter
9 G
)
G H
;
H I
}
 
pgsAdt
 
=
  
new
! $
NpgsqlDataAdapter
% 6
(
6 7
pgsCmd
7 =
)
= >
;
> ?
pgsAdt
‘‘ 
.
‘‘ 
Fill
‘‘ #
(
‘‘# $
tempDs
‘‘$ *
)
‘‘* +
;
‘‘+ ,
pgsCmd
’’ 
.
’’ 

Parameters
’’ )
.
’’) *
Clear
’’* /
(
’’/ 0
)
’’0 1
;
’’1 2
dt
–– 
=
–– 
tempDs
–– #
.
––# $
Tables
––$ *
[
––* +
$num
––+ ,
]
––, -
;
––- .
tempDs
—— 
.
—— 
Tables
—— %
.
——% &
Remove
——& ,
(
——, -
dt
——- /
)
——/ 0
;
——0 1
tempDs
˜˜ 
.
˜˜ 
Clear
˜˜ $
(
˜˜$ %
)
˜˜% &
;
˜˜& '
dt
œœ 
.
œœ 
	TableName
œœ $
=
œœ% &
fsql
œœ' +
.
œœ+ ,
name
œœ, 0
;
œœ0 1
ds
 
.
 
Tables
 !
.
! "
Add
" %
(
% &
dt
& (
)
( )
;
) *
}
 
if
¢¢ 
(
¢¢ 
sqlClear
¢¢  
)
¢¢  !
{
££ 
base
¤¤ 
.
¤¤ 
clearSql
¤¤ %
(
¤¤% &
)
¤¤& '
;
¤¤' (
}
¥¥ 
return
¦¦ 
ds
¦¦ 
;
¦¦ 
}
§§ 
catch
¨¨ 
(
¨¨ 
NpgsqlException
¨¨ %
pgsEx
¨¨& +
)
¨¨+ ,
{
©© 
FDebug
ªª 
.
ªª 
writeLog
ªª #
(
ªª# $
pgsEx
ªª$ )
)
ªª) *
;
ªª* +

fSqlErrors
®® 
=
®®  

FDbAdapter
®®! +
.
®®+ ,
createSqlErrors
®®, ;
(
®®; <
pgsEx
®®< A
)
®®A B
;
®®B C
fSqlErrorType
¯¯ !
=
¯¯" #

FDbAdapter
¯¯$ .
.
¯¯. /)
getSqlErrorTypeOfPostgreSql
¯¯/ J
(
¯¯J K

fSqlErrors
¯¯K U
)
¯¯U V
;
¯¯V W
errorMessage
±±  
=
±±! "
pgsEx
²² 
.
²² 
Message
²² %
+
²²& '
Environment
²²( 3
.
²²3 4
NewLine
²²4 ;
+
²²< =
$str
³³ "
+
³³# $
system
³³% +
+
³³, -
$str
³³. ;
+
³³< =
module
³³> D
+
³³E F
$str
³³G V
+
³³W X
function
³³Y a
+
³³b c
$str
³³d r
+
³³s t
sqlCode
³³u |
+
³³} ~
$str³³ ‚
;³³‚ ƒ
FDebug
µµ 
.
µµ 
throwException
µµ )
(
µµ) *
new
µµ* -
FDbException
µµ. :
(
µµ: ;
fSqlErrorType
µµ; H
,
µµH I

fSqlErrors
µµJ T
,
µµT U
errorMessage
µµV b
,
µµb c
pgsEx
µµd i
)
µµi j
)
µµj k
;
µµk l
}
¶¶ 
catch
·· 
(
·· 
	Exception
·· 
ex
··  "
)
··" #
{
¸¸ 
FDebug
¹¹ 
.
¹¹ 
throwException
¹¹ )
(
¹¹) *
ex
¹¹* ,
)
¹¹, -
;
¹¹- .
}
ºº 
finally
»» 
{
¼¼ 
if
½½ 
(
½½ 
pgsAdt
½½ 
!=
½½ !
null
½½" &
)
½½& '
{
¾¾ 
pgsAdt
¿¿ 
.
¿¿ 
Dispose
¿¿ &
(
¿¿& '
)
¿¿' (
;
¿¿( )
pgsAdt
ÀÀ 
=
ÀÀ  
null
ÀÀ! %
;
ÀÀ% &
}
ÁÁ 
if
ÃÃ 
(
ÃÃ 
pgsCmd
ÃÃ 
!=
ÃÃ !
null
ÃÃ" &
)
ÃÃ& '
{
ÄÄ 
pgsCmd
ÅÅ 
.
ÅÅ 
Dispose
ÅÅ &
(
ÅÅ& '
)
ÅÅ' (
;
ÅÅ( )
pgsCmd
ÆÆ 
=
ÆÆ  
null
ÆÆ! %
;
ÆÆ% &
}
ÇÇ 
if
ÉÉ 
(
ÉÉ 
tempDs
ÉÉ 
!=
ÉÉ !
null
ÉÉ" &
)
ÉÉ& '
{
ÊÊ 
tempDs
ËË 
.
ËË 
Dispose
ËË &
(
ËË& '
)
ËË' (
;
ËË( )
tempDs
ÌÌ 
=
ÌÌ  
null
ÌÌ! %
;
ÌÌ% &
}
ÍÍ 
if
ÏÏ 
(
ÏÏ 
pgsCon
ÏÏ 
!=
ÏÏ !
null
ÏÏ" &
)
ÏÏ& '
{
ĞĞ 
if
ÑÑ 
(
ÑÑ 
pgsCon
ÑÑ "
.
ÑÑ" #
State
ÑÑ# (
!=
ÑÑ) +
ConnectionState
ÑÑ, ;
.
ÑÑ; <
Closed
ÑÑ< B
)
ÑÑB C
{
ÒÒ 
pgsCon
ÓÓ "
.
ÓÓ" #
Close
ÓÓ# (
(
ÓÓ( )
)
ÓÓ) *
;
ÓÓ* +
}
ÔÔ 
pgsCon
ÕÕ 
.
ÕÕ 
Dispose
ÕÕ &
(
ÕÕ& '
)
ÕÕ' (
;
ÕÕ( )
pgsCon
ÖÖ 
=
ÖÖ  
null
ÖÖ! %
;
ÖÖ% &
}
×× 

fSqlErrors
ÙÙ 
=
ÙÙ  
null
ÙÙ! %
;
ÙÙ% &
}
ÚÚ 
return
ÛÛ 
null
ÛÛ 
;
ÛÛ 
}
ÜÜ 
}
İİ 	
public
áá 
DataSet
áá 
execute
áá 
(
áá 
int
ââ 
timeout
ââ 
)
ãã 
{
ää 	
try
åå 
{
ææ 
return
çç 
execute
çç 
(
çç 
timeout
çç &
,
çç& '
true
çç( ,
)
çç, -
;
çç- .
}
èè 
catch
éé 
(
éé 
	Exception
éé 
ex
éé 
)
éé  
{
êê 
FDebug
ëë 
.
ëë 
throwException
ëë %
(
ëë% &
ex
ëë& (
)
ëë( )
;
ëë) *
}
ìì 
finally
íí 
{
îî 
}
ğğ 
return
ññ 
null
ññ 
;
ññ 
}
òò 	
public
öö 
DataSet
öö 
execute
öö 
(
öö 
bool
÷÷ 
sqlClear
÷÷ 
)
øø 
{
ùù 	
try
úú 
{
ûû 
return
üü 
execute
üü 
(
üü 
base
üü #
.
üü# $
timeout
üü$ +
,
üü+ ,
sqlClear
üü- 5
)
üü5 6
;
üü6 7
}
ıı 
catch
şş 
(
şş 
	Exception
şş 
ex
şş 
)
şş  
{
ÿÿ 
FDebug
€€ 
.
€€ 
throwException
€€ %
(
€€% &
ex
€€& (
)
€€( )
;
€€) *
}
 
finally
‚‚ 
{
ƒƒ 
}
…… 
return
†† 
null
†† 
;
†† 
}
‡‡ 	
public
‹‹ 
DataSet
‹‹ 
execute
‹‹ 
(
‹‹ 
)
ŒŒ 
{
 	
try
 
{
 
return
 
execute
 
(
 
base
 #
.
# $
timeout
$ +
,
+ ,
true
- 1
)
1 2
;
2 3
}
‘‘ 
catch
’’ 
(
’’ 
	Exception
’’ 
ex
’’ 
)
’’  
{
““ 
FDebug
”” 
.
”” 
throwException
”” %
(
””% &
ex
””& (
)
””( )
;
””) *
}
•• 
finally
–– 
{
—— 
}
™™ 
return
šš 
null
šš 
;
šš 
}
œœ 	
}
¢¢ 
}££ ¨m
rD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\PostgreSql\c_FPgsTransactExecutor.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class  
FPgsTransactExecutor %
:& '
FBaseExecutor( 5
,5 6
FITransactExecutor7 I
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
internal!!  
FPgsTransactExecutor!! %
(!!% &
)"" 
:## 
base## 
(## 
)## 
{$$ 	
}&& 	
internal**  
FPgsTransactExecutor** %
(**% &
string++ 
connectionString++ #
),, 
:-- 
base-- 
(-- 
connectionString-- "
)--" #
{.. 	
}00 	
~44 	 
FPgsTransactExecutor44	 
(44 
)55 
{66 	
	myDispose77 
(77 
false77 
)77 
;77 
}88 	
	protected<< 
override<< 
void<< 
	myDispose<<  )
(<<) *
bool== 
	disposing== 
)>> 
{?? 	
if@@ 
(@@ 
!@@ 

m_disposed@@ 
)@@ 
{AA 
ifBB 
(BB 
	disposingBB 
)BB 
{CC 
}EE 

m_disposedFF 
=FF 
trueFF !
;FF! "
baseJJ 
.JJ 
	myDisposeJJ 
(JJ 
	disposingJJ (
)JJ( )
;JJ) *
}KK 
}LL 	
publicZZ 
intZZ 
executeZZ 
(ZZ 
int[[ 
timeout[[ 
,[[ 
bool\\ 
sqlClear\\ 
)]] 
{^^ 	
NpgsqlConnection__ 
pgsCon__ #
=__$ %
null__& *
;__* +
NpgsqlTransaction`` 
pgsTran`` %
=``& '
null``( ,
;``, -
NpgsqlCommandaa 
pgsCmdaa  
=aa! "
nullaa# '
;aa' (
intbb 
rowCountbb 
=bb 
$numbb 
;bb 
FSqlErrorCollectioncc 

fSqlErrorscc  *
=cc+ ,
nullcc- 1
;cc1 2
FSqlErrorTypedd 
fSqlErrorTypedd '
=dd( )
FSqlErrorTypedd* 7
.dd7 8
Normaldd8 >
;dd> ?
stringff 
systemff 
=ff 
stringff "
.ff" #
Emptyff# (
;ff( )
stringgg 
modulegg 
=gg 
stringgg "
.gg" #
Emptygg# (
;gg( )
stringhh 
functionhh 
=hh 
stringhh $
.hh$ %
Emptyhh% *
;hh* +
stringii 
sqlCodeii 
=ii 
stringii #
.ii# $
Emptyii$ )
;ii) *
stringjj 
errorMessagejj 
=jj  !
stringjj" (
.jj( )
Emptyjj) .
;jj. /
usingll 
(ll 
pgsConll 
=ll 
newll 
NpgsqlConnectionll  0
(ll0 1
basell1 5
.ll5 6
connectionStringll6 F
)llF G
)llG H
{mm 
trynn 
{oo 
ifpp 
(pp 
basepp 
.pp 
sqlListpp $
.pp$ %
Countpp% *
==pp+ -
$numpp. /
)pp/ 0
{qq 
FDebugrr 
.rr 
throwFExceptionrr .
(rr. /
stringrr/ 5
.rr5 6
Formatrr6 <
(rr< =

FConstantsrr= G
.rrG H

err_m_0003rrH R
,rrR S
$strrrT ^
)rr^ _
)rr_ `
;rr` a
}ss 
pgsConww 
.ww 
Openww 
(ww  
)ww  !
;ww! "
whilexx 
(xx 
truexx 
)xx  
{yy 
tryzz 
{{{ 
rowCount|| $
=||% &
$num||' (
;||( )
pgsTran}} #
=}}$ %
pgsCon}}& ,
.}}, -
BeginTransaction}}- =
(}}= >
)}}> ?
;}}? @
pgsCmd~~ "
=~~# $
pgsCon~~% +
.~~+ ,
CreateCommand~~, 9
(~~9 :
)~~: ;
;~~; <
pgsCmd "
." #

Connection# -
=. /
pgsCon0 6
;6 7
pgsCmd
€€ "
.
€€" #
Transaction
€€# .
=
€€/ 0
pgsTran
€€1 8
;
€€8 9
pgsCmd
 "
.
" #
CommandTimeout
# 1
=
2 3
timeout
4 ;
;
; <
foreach
…… #
(
……$ %
FSql
……% )
fsql
……* .
in
……/ 1
base
……2 6
.
……6 7
sqlList
……7 >
)
……> ?
{
†† 
system
‡‡  &
=
‡‡' (
fsql
‡‡) -
.
‡‡- .
system
‡‡. 4
;
‡‡4 5
module
ˆˆ  &
=
ˆˆ' (
fsql
ˆˆ) -
.
ˆˆ- .
module
ˆˆ. 4
;
ˆˆ4 5
function
‰‰  (
=
‰‰) *
fsql
‰‰+ /
.
‰‰/ 0
function
‰‰0 8
;
‰‰8 9
sqlCode
ŠŠ  '
=
ŠŠ( )
fsql
ŠŠ* .
.
ŠŠ. /
sqlCode
ŠŠ/ 6
;
ŠŠ6 7
pgsCmd
’’  &
.
’’& '
CommandText
’’' 2
=
’’3 4
fsql
’’5 9
.
’’9 :
sqlEx
’’: ?
;
’’? @
foreach
““  '
(
““( )
FSqlParameter
““) 6
sqlPar
““7 =
in
““> @
fsql
““A E
.
““E F$
sqlParameterCollection
““F \
)
““\ ]
{
””  !
pgsCmd
••$ *
.
••* +

Parameters
••+ 5
.
••5 6
Add
••6 9
(
••9 :
sqlPar
••: @
.
••@ A
pgSqlParameter
••A O
)
••O P
;
••P Q
}
––  !
rowCount
——  (
+=
——) +
pgsCmd
——, 2
.
——2 3
ExecuteNonQuery
——3 B
(
——B C
)
——C D
;
——D E
pgsCmd
˜˜  &
.
˜˜& '

Parameters
˜˜' 1
.
˜˜1 2
Clear
˜˜2 7
(
˜˜7 8
)
˜˜8 9
;
˜˜9 :
}
™™ 
pgsTran
 #
.
# $
Commit
$ *
(
* +
)
+ ,
;
, -
break
 !
;
! "
}
ŸŸ 
catch
   
(
   
NpgsqlException
   .
pgsEx
  / 4
)
  4 5
{
¡¡ 
FDebug
¢¢ "
.
¢¢" #
writeLog
¢¢# +
(
¢¢+ ,
pgsEx
¢¢, 1
)
¢¢1 2
;
¢¢2 3

fSqlErrors
¦¦ &
=
¦¦' (

FDbAdapter
¦¦) 3
.
¦¦3 4
createSqlErrors
¦¦4 C
(
¦¦C D
pgsEx
¦¦D I
)
¦¦I J
;
¦¦J K
fSqlErrorType
§§ )
=
§§* +

FDbAdapter
§§, 6
.
§§6 7)
getSqlErrorTypeOfPostgreSql
§§7 R
(
§§R S

fSqlErrors
§§S ]
)
§§] ^
;
§§^ _
errorMessage
©© (
=
©©) *
pgsEx
ªª  %
.
ªª% &
Message
ªª& -
+
ªª. /
Environment
ªª0 ;
.
ªª; <
NewLine
ªª< C
+
ªªD E
$str
««  *
+
««+ ,
system
««- 3
+
««4 5
$str
««6 C
+
««D E
module
««F L
+
««M N
$str
««O ^
+
««_ `
function
««a i
+
««j k
$str
««l z
+
««{ |
sqlCode««} „
+««… †
$str««‡ Š
;««Š ‹
FDebug
­­ "
.
­­" #
throwException
­­# 1
(
­­1 2
new
­­2 5
FDbException
­­6 B
(
­­B C
fSqlErrorType
­­C P
,
­­P Q

fSqlErrors
­­R \
,
­­\ ]
errorMessage
­­^ j
,
­­j k
pgsEx
­­l q
)
­­q r
)
­­r s
;
­­s t
}
®® 
catch
¯¯ 
(
¯¯ 
	Exception
¯¯ (
ex
¯¯) +
)
¯¯+ ,
{
°° 
FDebug
±± "
.
±±" #
throwException
±±# 1
(
±±1 2
ex
±±2 4
)
±±4 5
;
±±5 6
}
²² 
finally
³³ 
{
´´ 
}
¶¶ 
}
·· 
if
»» 
(
»» 
sqlClear
»»  
)
»»  !
{
¼¼ 
base
½½ 
.
½½ 
clearSql
½½ %
(
½½% &
)
½½& '
;
½½' (
}
¾¾ 
return
¿¿ 
rowCount
¿¿ #
;
¿¿# $
}
ÀÀ 
catch
ÁÁ 
(
ÁÁ 
	Exception
ÁÁ  
ex
ÁÁ! #
)
ÁÁ# $
{
ÂÂ 
if
ÃÃ 
(
ÃÃ 
ex
ÃÃ 
is
ÃÃ 
FDbException
ÃÃ *
||
ÃÃ+ -
ex
ÃÃ. 0
is
ÃÃ1 3
NpgsqlException
ÃÃ4 C
)
ÃÃC D
{
ÄÄ 
try
ÅÅ 
{
ÆÆ 
if
ÇÇ 
(
ÇÇ  
pgsTran
ÇÇ  '
!=
ÇÇ( *
null
ÇÇ+ /
)
ÇÇ/ 0
{
ÈÈ 
pgsTran
ÌÌ  '
.
ÌÌ' (
Rollback
ÌÌ( 0
(
ÌÌ0 1
)
ÌÌ1 2
;
ÌÌ2 3
}
ÍÍ 
}
ÎÎ 
catch
ÏÏ 
(
ÏÏ 
	Exception
ÏÏ (
inEx
ÏÏ) -
)
ÏÏ- .
{
ĞĞ 
FDebug
ÑÑ "
.
ÑÑ" #
writeLog
ÑÑ# +
(
ÑÑ+ ,
inEx
ÑÑ, 0
)
ÑÑ0 1
;
ÑÑ1 2
}
ÒÒ 
}
ÓÓ 
FDebug
×× 
.
×× 
throwException
×× )
(
××) *
ex
××* ,
)
××, -
;
××- .
}
ØØ 
finally
ÙÙ 
{
ÚÚ 
if
ÛÛ 
(
ÛÛ 
pgsTran
ÛÛ 
!=
ÛÛ  "
null
ÛÛ# '
)
ÛÛ' (
{
ÜÜ 
pgsTran
İİ 
.
İİ  
Dispose
İİ  '
(
İİ' (
)
İİ( )
;
İİ) *
pgsTran
ŞŞ 
=
ŞŞ  !
null
ŞŞ" &
;
ŞŞ& '
}
ßß 
if
áá 
(
áá 
pgsCmd
áá 
!=
áá !
null
áá" &
)
áá& '
{
ââ 
pgsCmd
ãã 
.
ãã 
Dispose
ãã &
(
ãã& '
)
ãã' (
;
ãã( )
pgsCmd
ää 
=
ää  
null
ää! %
;
ää% &
}
åå 
if
çç 
(
çç 
pgsCon
çç 
!=
çç !
null
çç" &
)
çç& '
{
èè 
if
éé 
(
éé 
pgsCon
éé "
.
éé" #
State
éé# (
!=
éé) +
ConnectionState
éé, ;
.
éé; <
Closed
éé< B
)
ééB C
{
êê 
pgsCon
ëë "
.
ëë" #
Close
ëë# (
(
ëë( )
)
ëë) *
;
ëë* +
}
ìì 
pgsCon
íí 
.
íí 
Dispose
íí &
(
íí& '
)
íí' (
;
íí( )
pgsCon
îî 
=
îî  
null
îî! %
;
îî% &
}
ïï 

fSqlErrors
ññ 
=
ññ  
null
ññ! %
;
ññ% &
}
òò 
}
óó 
return
ôô 
$num
ôô 
;
ôô 
}
õõ 	
public
ùù 
int
ùù 
execute
ùù 
(
ùù 
int
úú 
timeout
úú 
)
ûû 
{
üü 	
try
ıı 
{
şş 
return
ÿÿ 
execute
ÿÿ 
(
ÿÿ 
timeout
ÿÿ &
,
ÿÿ& '
true
ÿÿ( ,
)
ÿÿ, -
;
ÿÿ- .
}
€€ 
catch
 
(
 
	Exception
 
ex
 
)
  
{
‚‚ 
FDebug
ƒƒ 
.
ƒƒ 
throwException
ƒƒ %
(
ƒƒ% &
ex
ƒƒ& (
)
ƒƒ( )
;
ƒƒ) *
}
„„ 
finally
…… 
{
†† 
}
ˆˆ 
return
‰‰ 
$num
‰‰ 
;
‰‰ 
}
ŠŠ 	
public
 
int
 
execute
 
(
 
bool
 
sqlClear
 
)
 
{
‘‘ 	
try
’’ 
{
““ 
return
”” 
execute
”” 
(
”” 
base
”” #
.
””# $
timeout
””$ +
,
””+ ,
sqlClear
””- 5
)
””5 6
;
””6 7
}
•• 
catch
–– 
(
–– 
	Exception
–– 
ex
–– 
)
––  
{
—— 
FDebug
˜˜ 
.
˜˜ 
throwException
˜˜ %
(
˜˜% &
ex
˜˜& (
)
˜˜( )
;
˜˜) *
}
™™ 
finally
šš 
{
›› 
}
 
return
 
$num
 
;
 
}
ŸŸ 	
public
££ 
int
££ 
execute
££ 
(
££ 
)
¤¤ 
{
¥¥ 	
try
¦¦ 
{
§§ 
return
¨¨ 
execute
¨¨ 
(
¨¨ 
base
¨¨ #
.
¨¨# $
timeout
¨¨$ +
,
¨¨+ ,
true
¨¨- 1
)
¨¨1 2
;
¨¨2 3
}
©© 
catch
ªª 
(
ªª 
	Exception
ªª 
ex
ªª 
)
ªª  
{
«« 
FDebug
¬¬ 
.
¬¬ 
throwException
¬¬ %
(
¬¬% &
ex
¬¬& (
)
¬¬( )
;
¬¬) *
}
­­ 
finally
®® 
{
¯¯ 
}
±± 
return
²² 
$num
²² 
;
²² 
}
³³ 	
}
¹¹ 
}ºº î
gD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\XmlTag\c_FXmlTagFAMate.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

static 
class 
FXmlTagFAMate %
{ 
public 
const 
string 
E_FAMate $
=% &
$str' ,
;, -
public 
const 
string 
A_FileFormat (
=) *
$str+ 0
;0 1
public 
const 
string 
A_FileVersion )
=* +
$str, 1
;1 2
public   
const   
string   
A_FileCreationTime   .
=  / 0
$str  1 6
;  6 7
public!! 
const!! 
string!! 
A_FileUpdateTime!! ,
=!!- .
$str!!/ 4
;!!4 5
public"" 
const"" 
string"" 
A_FileDescription"" -
="". /
$str""0 5
;""5 6
public## 
const## 
string## 
A_UniqueIdPointer## -
=##. /
$str##0 5
;##5 6
public%% 
const%% 
string%% 
D_FileFormat%% (
=%%) *
$str%%+ -
;%%- .
public&& 
const&& 
string&& 
D_FileVersion&& )
=&&* +
$str&&, .
;&&. /
public'' 
const'' 
string'' 
D_FileCreationTime'' .
=''/ 0
$str''1 3
;''3 4
public(( 
const(( 
string(( 
D_FileUpdateTime(( ,
=((- .
$str((/ 1
;((1 2
public)) 
const)) 
string)) 
D_FileDescription)) -
=)). /
$str))0 2
;))2 3
public** 
const** 
string** 
D_UniqueIdPointer** -
=**. /
$str**0 3
;**3 4
}.. 
}// ¦

iD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\XmlTag\c_FXmlTagFunction.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

static 
class 
FXmlTagFunction '
{ 
public 
const 
string 

E_Function &
=' (
$str) .
;. /
public 
const 
string 

A_UniqueId &
=' (
$str) ,
;, -
public 
const 
string 

A_Function &
=' (
$str) .
;. /
public   
const   
string   
A_Description   )
=  * +
$str  , /
;  / 0
public"" 
const"" 
string"" 

D_UniqueId"" &
=""' (
$str"") +
;""+ ,
public## 
const## 
string## 

D_Function## &
=##' (
$str##) +
;##+ ,
public$$ 
const$$ 
string$$ 
D_Description$$ )
=$$* +
$str$$, .
;$$. /
}(( 
})) œ

gD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\XmlTag\c_FXmlTagModule.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

static 
class 
FXmlTagModule %
{ 
public 
const 
string 
E_Module $
=% &
$str' ,
;, -
public 
const 
string 

A_UniqueId &
=' (
$str) ,
;, -
public 
const 
string 
A_Module $
=% &
$str' ,
;, -
public   
const   
string   
A_Description   )
=  * +
$str  , /
;  / 0
public"" 
const"" 
string"" 

D_UniqueId"" &
=""' (
$str"") +
;""+ ,
public## 
const## 
string## 
D_Module## $
=##% &
$str##' )
;##) *
public$$ 
const$$ 
string$$ 
D_Description$$ )
=$$* +
$str$$, .
;$$. /
}(( 
})) ¨
mD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\XmlTag\c_FXmlTagSqlParameter.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

static 
class 
FXmlTagSqlParameter +
{ 
public 
const 
string 
E_SqlParameter *
=+ ,
$str- 2
;2 3
public 
const 
string 
A_SqlParameter *
=+ ,
$str- 2
;2 3
public 
const 
string 
D_SqlParameter *
=+ ,
$str- /
;/ 0
}## 
}$$ ã!
hD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\XmlTag\c_FXmlTagSqlCode.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

static 
class 
FXmlTagSqlCode &
{ 
public 
const 
string 
	E_SqlCode %
=& '
$str( -
;- .
public   
const   
string   

A_UniqueId   &
=  ' (
$str  ) ,
;  , -
public!! 
const!! 
string!! 
	A_SqlCode!! %
=!!& '
$str!!( -
;!!- .
public"" 
const"" 
string"" 
A_Description"" )
=""* +
$str"", /
;""/ 0
public## 
const## 
string## 
A_UsedSqlMigration## .
=##/ 0
$str##1 6
;##6 7
public$$ 
const$$ 
string$$ 
A_MsSqlQuery$$ (
=$$) *
$str$$+ 0
;$$0 1
public%% 
const%% 
string%% 
A_MsSqlParameter%% ,
=%%- .
$str%%/ 4
;%%4 5
public&& 
const&& 
string&& 
A_OracleQuery&& )
=&&* +
$str&&, 1
;&&1 2
public'' 
const'' 
string'' 
A_OracleParameter'' -
=''. /
$str''0 5
;''5 6
public(( 
const(( 
string(( 
A_MySqlQuery(( (
=(() *
$str((+ 0
;((0 1
public)) 
const)) 
string)) 
A_MySqlParameter)) ,
=))- .
$str))/ 4
;))4 5
public** 
const** 
string** 
A_MariaDbQuery** *
=**+ ,
$str**- 2
;**2 3
public++ 
const++ 
string++ 
A_MariaDbParameter++ .
=++/ 0
$str++1 6
;++6 7
public,, 
const,, 
string,, 
A_PostgreSqlQuery,, -
=,,. /
$str,,0 5
;,,5 6
public-- 
const-- 
string-- !
A_PostgreSqlParameter-- 1
=--2 3
$str--4 9
;--9 :
public11 
const11 
string11 

D_UniqueId11 &
=11' (
$str11) +
;11+ ,
public22 
const22 
string22 
	D_SqlCode22 %
=22& '
$str22( *
;22* +
public33 
const33 
string33 
D_Description33 )
=33* +
$str33, .
;33. /
public44 
const44 
string44 
D_UsedSqlMigration44 .
=44/ 0
$str441 6
;446 7
public55 
const55 
string55 
D_MsSqlQuery55 (
=55) *
$str55+ -
;55- .
public66 
const66 
string66 
D_MsSqlParameter66 ,
=66- .
$str66/ 1
;661 2
public77 
const77 
string77 
D_OracleQuery77 )
=77* +
$str77, .
;77. /
public88 
const88 
string88 
D_OracleParameter88 -
=88. /
$str880 2
;882 3
public99 
const99 
string99 
D_MySqlQuery99 (
=99) *
$str99+ -
;99- .
public:: 
const:: 
string:: 
D_MySqlParameter:: ,
=::- .
$str::/ 1
;::1 2
public;; 
const;; 
string;; 
D_MariaDbQuery;; *
=;;+ ,
$str;;- /
;;;/ 0
public<< 
const<< 
string<< 
D_MariaDbParameter<< .
=<</ 0
$str<<1 3
;<<3 4
public== 
const== 
string== 
D_PostgreSqlQuery== -
===. /
$str==0 2
;==2 3
public>> 
const>> 
string>> !
D_PostgreSqlParameter>> 1
=>>2 3
$str>>4 6
;>>6 7
}BB 
}CC ²
gD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\XmlTag\c_FXmlTagSystem.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

static 
class 
FXmlTagSystem %
{ 
public 
const 
string 
E_System $
=% &
$str' ,
;, -
public 
const 
string 

A_UniqueId &
=' (
$str) ,
;, -
public 
const 
string 
A_System $
=% &
$str' ,
;, -
public   
const   
string   
A_Description   )
=  * +
$str  , /
;  / 0
public!! 
const!! 
string!! 
A_StandardDatabase!! .
=!!/ 0
$str!!1 6
;!!6 7
public## 
const## 
string## 

D_UniqueId## &
=##' (
$str##) +
;##+ ,
public$$ 
const$$ 
string$$ 
D_System$$ $
=$$% &
$str$$' )
;$$) *
public%% 
const%% 
string%% 
D_Description%% )
=%%* +
$str%%, .
;%%. /
public&& 
const&& 
string&& 
D_StandardDatabase&& .
=&&/ 0
$str&&1 >
;&&> ?
}** 
}++ 
iD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\XmlTag\c_FXmlTagSqlQuery.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

static 
class 
FXmlTagSqlQuery '
{ 
public 
const 
string 

E_SqlQuery &
=' (
$str) .
;. /
public 
const 
string 
A_DbProvider (
=) *
$str+ 0
;0 1
public 
const 
string 

A_SqlQuery &
=' (
$str) .
;. /
public!! 
const!! 
string!! 
D_DbProvider!! (
=!!) *
$str!!+ -
;!!- .
public"" 
const"" 
string"" 

D_SqlQuery"" &
=""' (
$str"") +
;""+ ,
}&& 
}'' ›
\D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\c_FSqlError.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
	FSqlError 
: 
IDisposable (
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
int 
m_errorCode 
=  !
$num" #
;# $
private 
string 
m_errorMessage %
=& '
string( .
.. /
Empty/ 4
;4 5
internal## 
	FSqlError## 
(## 
int$$ 
	errorCode$$ 
,$$ 
string%% 
errorMessage%% 
)&& 
{'' 	
m_errorCode(( 
=(( 
	errorCode(( #
;((# $
m_errorMessage)) 
=)) 
errorMessage)) )
;))) *
}** 	
~.. 	
	FSqlError..	 
(.. 
)// 
{00 	
	myDispose11 
(11 
false11 
)11 
;11 
}22 	
	protected66 
virtual66 
void66 
	myDispose66 (
(66( )
bool77 
	disposing77 
)88 
{99 	
if:: 
(:: 
!:: 

m_disposed:: 
):: 
{;; 
if<< 
(<< 
	disposing<< 
)<< 
{== 
}?? 
}@@ 

m_disposedAA 
=AA 
trueAA 
;AA 
}BB 	
publicJJ 
voidJJ 
DisposeJJ 
(JJ 
)KK 
{LL 	
	myDisposeMM 
(MM 
trueMM 
)MM 
;MM 
GCNN 
.NN 
SuppressFinalizeNN 
(NN  
thisNN  $
)NN$ %
;NN% &
}OO 	
publicWW 
intWW 
	errorCodeWW 
{XX 	
getYY 
{ZZ 
try[[ 
{\\ 
return]] 
m_errorCode]] &
;]]& '
}^^ 
catch__ 
(__ 
	Exception__  
ex__! #
)__# $
{`` 
FDebugaa 
.aa 
throwExceptionaa )
(aa) *
exaa* ,
)aa, -
;aa- .
}bb 
finallycc 
{dd 
}ff 
returngg 
$numgg 
;gg 
}hh 
}ii 	
publicmm 
stringmm 
errorMessagemm "
{nn 	
getoo 
{pp 
tryqq 
{rr 
returnss 
m_errorMessagess )
;ss) *
}tt 
catchuu 
(uu 
	Exceptionuu  
exuu! #
)uu# $
{vv 
FDebugww 
.ww 
throwExceptionww )
(ww) *
exww* ,
)ww, -
;ww- .
}xx 
finallyyy 
{zz 
}|| 
return}} 
string}} 
.}} 
Empty}} #
;}}# $
}~~ 
} 	
}
‹‹ 
}ŒŒ Ó1
fD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\c_FSqlErrorCollection.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FSqlErrorCollection $
:% &
IDisposable' 2
,2 3
IEnumerable4 ?
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
List 
< 
	FSqlError 
> 
m_fSqlErrorList  /
=0 1
null2 6
;6 7
internal"" 
FSqlErrorCollection"" $
(""$ %
List## 
<## 
	FSqlError## 
>## 
fSqlErrorList## )
)$$ 
{%% 	
m_fSqlErrorList&& 
=&& 
fSqlErrorList&& +
;&&+ ,
}'' 	
~++ 	
FSqlErrorCollection++	 
(++ 
),, 
{-- 	
	myDispose.. 
(.. 
false.. 
).. 
;.. 
}// 	
	protected33 
void33 
	myDispose33  
(33  !
bool44 
	disposing44 
)44 
{55 	
if66 
(66 
!66 

m_disposed66 
)66 
{77 
if88 
(88 
	disposing88 
)88 
{99 
m_fSqlErrorList:: #
=::$ %
null::& *
;::* +
};; 
}<< 

m_disposed>> 
=>> 
true>> 
;>> 
}?? 	
publicGG 
voidGG 
DisposeGG 
(GG 
)HH 
{II 	
	myDisposeJJ 
(JJ 
trueJJ 
)JJ 
;JJ 
GCKK 
.KK 
SuppressFinalizeKK 
(KK  
thisKK  $
)KK$ %
;KK% &
}LL 	
publicTT 
IEnumeratorTT 
GetEnumeratorTT (
(TT( )
)UU 
{VV 	
tryWW 
{XX 
returnYY 
newYY )
FSqlErrorCollectionEnumeratorYY 8
(YY8 9
thisYY9 =
)YY= >
;YY> ?
}ZZ 
catch[[ 
([[ 
	Exception[[ 
ex[[ 
)[[  
{\\ 
FDebug]] 
.]] 
throwException]] %
(]]% &
ex]]& (
)]]( )
;]]) *
}^^ 
finally__ 
{`` 
}bb 
returncc 
nullcc 
;cc 
}dd 	
publichh 
inthh 
counthh 
{ii 	
getjj 
{kk 
tryll 
{mm 
returnnn 
m_fSqlErrorListnn *
.nn* +
Countnn+ 0
;nn0 1
}oo 
catchpp 
(pp 
Systempp 
.pp 
	Exceptionpp '
expp( *
)pp* +
{qq 
FDebugrr 
.rr 
throwExceptionrr )
(rr) *
exrr* ,
)rr, -
;rr- .
}ss 
finallytt 
{uu 
}ww 
returnxx 
$numxx 
;xx 
}yy 
}zz 	
public~~ 
	FSqlError~~ 
this~~ 
[~~ 
int~~ !
i~~" #
]~~# $
{ 	
get
€€ 
{
 
try
‚‚ 
{
ƒƒ 
if
„„ 
(
„„ 
i
„„ 
<
„„ 
$num
„„ 
||
„„  
i
„„! "
>=
„„# %
m_fSqlErrorList
„„& 5
.
„„5 6
Count
„„6 ;
)
„„; <
{
…… 
return
†† 
null
†† #
;
††# $
}
‡‡ 
return
ˆˆ 
m_fSqlErrorList
ˆˆ *
[
ˆˆ* +
i
ˆˆ+ ,
]
ˆˆ, -
;
ˆˆ- .
}
‰‰ 
catch
ŠŠ 
(
ŠŠ 
	Exception
ŠŠ  
ex
ŠŠ! #
)
ŠŠ# $
{
‹‹ 
FDebug
ŒŒ 
.
ŒŒ 
throwException
ŒŒ )
(
ŒŒ) *
ex
ŒŒ* ,
)
ŒŒ, -
;
ŒŒ- .
}
 
finally
 
{
 
}
‘‘ 
return
’’ 
null
’’ 
;
’’ 
}
““ 
}
”” 	
public
œœ 
object
œœ 
item
œœ 
(
œœ 
int
 
index
 
)
 
{
ŸŸ 	
try
   
{
¡¡ 
return
¢¢ 
this
¢¢ 
[
¢¢ 
index
¢¢ !
]
¢¢! "
;
¢¢" #
}
££ 
catch
¤¤ 
(
¤¤ 
	Exception
¤¤ 
ex
¤¤ 
)
¤¤  
{
¥¥ 
FDebug
¦¦ 
.
¦¦ 
throwException
¦¦ %
(
¦¦% &
ex
¦¦& (
)
¦¦( )
;
¦¦) *
}
§§ 
finally
¨¨ 
{
©© 
}
«« 
return
¬¬ 
null
¬¬ 
;
¬¬ 
}
­­ 	
public
±± 
bool
±± 
containsErrorCode
±± %
(
±±% &
int
²² 
	errorCode
²² 
)
³³ 
{
´´ 	
try
µµ 
{
¶¶ 
foreach
·· 
(
·· 
	FSqlError
·· "
ferr
··# '
in
··( *
m_fSqlErrorList
··+ :
)
··: ;
{
¸¸ 
if
¹¹ 
(
¹¹ 
ferr
¹¹ 
.
¹¹ 
	errorCode
¹¹ &
==
¹¹' )
	errorCode
¹¹* 3
)
¹¹3 4
{
ºº 
return
»» 
true
»» #
;
»»# $
}
¼¼ 
}
½½ 
return
¾¾ 
false
¾¾ 
;
¾¾ 
}
¿¿ 
catch
ÀÀ 
(
ÀÀ 
	Exception
ÀÀ 
ex
ÀÀ 
)
ÀÀ  
{
ÁÁ 
FDebug
ÂÂ 
.
ÂÂ 
throwException
ÂÂ %
(
ÂÂ% &
ex
ÂÂ& (
)
ÂÂ( )
;
ÂÂ) *
}
ÃÃ 
finally
ÄÄ 
{
ÅÅ 
}
ÇÇ 
return
ÈÈ 
false
ÈÈ 
;
ÈÈ 
}
ÉÉ 	
}
ÏÏ 
}ĞĞ “ 
pD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\c_FSqlErrorCollectionEnumerator.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class )
FSqlErrorCollectionEnumerator .
:/ 0
IEnumerator1 <
,< =
IDisposable> I
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
int 
m_index 
= 
- 
$num  
;  !
private 
FSqlErrorCollection #!
m_fSqlErrorCollection$ 9
=: ;
null< @
;@ A
public## )
FSqlErrorCollectionEnumerator## ,
(##, -
FSqlErrorCollection$$ 
fSqlErrorCollection$$  3
)%% 
{&& 	!
m_fSqlErrorCollection'' !
=''" #
fSqlErrorCollection''$ 7
;''7 8
}(( 	
~,, 	)
FSqlErrorCollectionEnumerator,,	 &
(,,& '
)-- 
{.. 	
	myDispose// 
(// 
false// 
)// 
;// 
}00 	
	protected44 
void44 
	myDispose44  
(44  !
bool55 
	disposing55 
)55 
{66 	
if77 
(77 
!77 

m_disposed77 
)77 
{88 
if99 
(99 
	disposing99 
)99 
{:: !
m_fSqlErrorCollection;; )
=;;* +
null;;, 0
;;;0 1
}<< 
}== 
}>> 	
publicEE 
voidEE 
DisposeEE 
(EE 
)FF 
{GG 	
	myDisposeHH 
(HH 
trueHH 
)HH 
;HH 
GCII 
.II 
SuppressFinalizeII 
(II  
thisII  $
)II$ %
;II% &
}JJ 	
publicRR 
objectRR 
CurrentRR 
{SS 	
getTT 
{UU 
tryVV 
{WW 
returnXX !
m_fSqlErrorCollectionXX 0
[XX0 1
m_indexXX1 8
]XX8 9
;XX9 :
}YY 
catchZZ 
(ZZ 
	ExceptionZZ  
exZZ! #
)ZZ# $
{[[ 
FDebug\\ 
.\\ 
throwException\\ )
(\\) *
ex\\* ,
)\\, -
;\\- .
}]] 
finally^^ 
{__ 
}aa 
returnbb 
nullbb 
;bb 
}cc 
}dd 	
publichh 
boolhh 
MoveNexthh 
(hh 
)ii 
{jj 	
trykk 
{ll 
m_indexmm 
++mm 
;mm 
returnnn 
(nn 
m_indexnn 
<nn  !!
m_fSqlErrorCollectionnn" 7
.nn7 8
countnn8 =
)nn= >
;nn> ?
}oo 
catchpp 
(pp 
	Exceptionpp 
expp 
)pp  
{qq 
FDebugrr 
.rr 
throwExceptionrr %
(rr% &
exrr& (
)rr( )
;rr) *
}ss 
finallytt 
{uu 
}ww 
returnxx 
falsexx 
;xx 
}yy 	
public}} 
void}} 
Reset}} 
(}} 
)~~ 
{ 	
try
€€ 
{
 
m_index
‚‚ 
=
‚‚ 
-
‚‚ 
$num
‚‚ 
;
‚‚ 
}
ƒƒ 
catch
„„ 
(
„„ 
	Exception
„„ 
ex
„„ 
)
„„  
{
…… 
FDebug
†† 
.
†† 
throwException
†† %
(
††% &
ex
††& (
)
††( )
;
††) *
}
‡‡ 
finally
ˆˆ 
{
‰‰ 
}
‹‹ 
}
ŒŒ 	
}
’’ 
}““ ˜Ó
^D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\c_FLicChecker.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
internal 
class 
FLicChecker 
:  
IDisposable! ,
{ 
private 
const 
string 
KeySeparator )
=* +
$str, 0
;0 1
private 
const 
string 
LineSeparator *
=+ ,
$str- 1
;1 2
private 
const 
string 
FieldSeparator +
=, -
$str. 1
;1 2
private 
const 
int 
MonitoringPeriod *
=+ ,
$num- 1
*2 3
$num4 6
*7 8
$num9 ;
;; <
private"" 
bool"" 

m_disposed"" 
=""  !
false""" '
;""' (
private$$ 
	FILicCore$$ 

m_fLicCore$$ $
=$$% &
null$$' +
;$$+ ,
private%% 
string%% 
	m_licFile%%  
=%%! "
string%%# )
.%%) *
Empty%%* /
;%%/ 0
private&& 
FDbProvider&& 
m_fDbProvider&& )
=&&* +
FDbProvider&&, 7
.&&7 8
MsSqlServer&&8 C
;&&C D
private'' 
string'' 
m_connectString'' &
=''' (
string'') /
.''/ 0
Empty''0 5
;''5 6
private)) 

Dictionary)) 
<)) 
string)) !
,))! "
object))# )
>))) *
	m_licItem))+ 4
=))5 6
null))7 ;
;)); <
private** 
FStaticTimer** 
m_fTmrMonitoring** -
=**. /
null**0 4
;**4 5
private++ 
FThread++ 

m_fThdMain++ "
=++# $
null++% )
;++) *
internal11 
FLicChecker11 
(11 
	FILicCore22 
fLicCore22 
,22 
string33 
licFile33 
,33 
FDbProvider44 
fDbProvider44 #
,44# $
string55 
connectString55  
)66 
{77 	

m_fLicCore88 
=88 
fLicCore88 !
;88! "
	m_licFile99 
=99 
licFile99 
;99  
m_fDbProvider:: 
=:: 
fDbProvider:: '
;::' (
m_connectString;; 
=;; 
connectString;; +
;;;+ ,
	m_licItem== 
=== 
new== 

Dictionary== &
<==& '
string==' -
,==- .
object==/ 5
>==5 6
(==6 7
)==7 8
;==8 9
initAA 
(AA 
)AA 
;AA 
}BB 	
~FF 	
FLicCheckerFF	 
(FF 
)GG 
{HH 	
	myDisposeII 
(II 
falseII 
)II 
;II 
}JJ 	
	protectedNN 
virtualNN 
voidNN 
	myDisposeNN (
(NN( )
boolOO 
	disposingOO 
)PP 
{QQ 	
ifRR 
(RR 
!RR 

m_disposedRR 
)RR 
{SS 
ifTT 
(TT 
	disposingTT 
)TT 
{UU 
termVV 
(VV 
)VV 
;VV 
}WW 
}XX 

m_disposedYY 
=YY 
trueYY 
;YY 
}ZZ 	
publicbb 
voidbb 
Disposebb 
(bb 
)cc 
{dd 	
	myDisposeee 
(ee 
trueee 
)ee 
;ee 
GCff 
.ff 
SuppressFinalizeff 
(ff  
thisff  $
)ff$ %
;ff% &
}gg 	
publicoo 
Listoo 
<oo 
stringoo 
>oo 
productNameoo '
{pp 	
getqq 
{rr 
tryss 
{tt 
returnuu 
	m_licItemuu $
[uu$ %
$struu% 3
]uu3 4
asuu5 7
Listuu8 <
<uu< =
stringuu= C
>uuC D
;uuD E
}vv 
catchww 
(ww 
	Exceptionww  
exww! #
)ww# $
{xx 
FDebugyy 
.yy 
throwExceptionyy )
(yy) *
exyy* ,
)yy, -
;yy- .
}zz 
finally{{ 
{|| 
}~~ 
return 
null 
; 
}
€€ 
}
 	
public
…… 
string
…… 
productVersion
…… $
{
†† 	
get
‡‡ 
{
ˆˆ 
try
‰‰ 
{
ŠŠ 
return
‹‹ 
	m_licItem
‹‹ $
[
‹‹$ %
$str
‹‹% 6
]
‹‹6 7
.
‹‹7 8
ToString
‹‹8 @
(
‹‹@ A
)
‹‹A B
;
‹‹B C
}
ŒŒ 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
‘‘ 
{
’’ 
}
”” 
return
•• 
string
•• 
.
•• 
Empty
•• #
;
••# $
}
–– 
}
—— 	
public
›› 
string
›› 
licenseType
›› !
{
œœ 	
get
 
{
 
try
ŸŸ 
{
   
return
¡¡ 
	m_licItem
¡¡ $
[
¡¡$ %
$str
¡¡% 3
]
¡¡3 4
.
¡¡4 5
ToString
¡¡5 =
(
¡¡= >
)
¡¡> ?
;
¡¡? @
}
¢¢ 
catch
££ 
(
££ 
	Exception
££  
ex
££! #
)
££# $
{
¤¤ 
FDebug
¥¥ 
.
¥¥ 
throwException
¥¥ )
(
¥¥) *
ex
¥¥* ,
)
¥¥, -
;
¥¥- .
}
¦¦ 
finally
§§ 
{
¨¨ 
}
ªª 
return
«« 
string
«« 
.
«« 
Empty
«« #
;
««# $
}
¬¬ 
}
­­ 	
public
±± 
string
±± 
customerCompany
±± %
{
²² 	
get
³³ 
{
´´ 
try
µµ 
{
¶¶ 
return
·· 
	m_licItem
·· $
[
··$ %
$str
··% 7
]
··7 8
.
··8 9
ToString
··9 A
(
··A B
)
··B C
;
··C D
}
¸¸ 
catch
¹¹ 
(
¹¹ 
	Exception
¹¹  
ex
¹¹! #
)
¹¹# $
{
ºº 
FDebug
»» 
.
»» 
throwException
»» )
(
»») *
ex
»»* ,
)
»», -
;
»»- .
}
¼¼ 
finally
½½ 
{
¾¾ 
}
ÀÀ 
return
ÁÁ 
string
ÁÁ 
.
ÁÁ 
Empty
ÁÁ #
;
ÁÁ# $
}
ÂÂ 
}
ÃÃ 	
public
ÇÇ 
string
ÇÇ 
customerFactory
ÇÇ %
{
ÈÈ 	
get
ÉÉ 
{
ÊÊ 
try
ËË 
{
ÌÌ 
return
ÍÍ 
	m_licItem
ÍÍ $
[
ÍÍ$ %
$str
ÍÍ% 7
]
ÍÍ7 8
.
ÍÍ8 9
ToString
ÍÍ9 A
(
ÍÍA B
)
ÍÍB C
;
ÍÍC D
}
ÎÎ 
catch
ÏÏ 
(
ÏÏ 
	Exception
ÏÏ  
ex
ÏÏ! #
)
ÏÏ# $
{
ĞĞ 
FDebug
ÑÑ 
.
ÑÑ 
throwException
ÑÑ )
(
ÑÑ) *
ex
ÑÑ* ,
)
ÑÑ, -
;
ÑÑ- .
}
ÒÒ 
finally
ÓÓ 
{
ÔÔ 
}
ÖÖ 
return
×× 
string
×× 
.
×× 
Empty
×× #
;
××# $
}
ØØ 
}
ÙÙ 	
public
İİ 
string
İİ 

issuedDate
İİ  
{
ŞŞ 	
get
ßß 
{
àà 
try
áá 
{
ââ 
return
ãã 
	m_licItem
ãã $
[
ãã$ %
$str
ãã% 2
]
ãã2 3
.
ãã3 4
ToString
ãã4 <
(
ãã< =
)
ãã= >
;
ãã> ?
}
ää 
catch
åå 
(
åå 
	Exception
åå  
ex
åå! #
)
åå# $
{
ææ 
FDebug
çç 
.
çç 
throwException
çç )
(
çç) *
ex
çç* ,
)
çç, -
;
çç- .
}
èè 
finally
éé 
{
êê 
}
ìì 
return
íí 
string
íí 
.
íí 
Empty
íí #
;
íí# $
}
îî 
}
ïï 	
public
óó 
string
óó 
expiredDate
óó !
{
ôô 	
get
õõ 
{
öö 
try
÷÷ 
{
øø 
return
ùù 
	m_licItem
ùù $
[
ùù$ %
$str
ùù% 3
]
ùù3 4
.
ùù4 5
ToString
ùù5 =
(
ùù= >
)
ùù> ?
;
ùù? @
}
úú 
catch
ûû 
(
ûû 
	Exception
ûû  
ex
ûû! #
)
ûû# $
{
üü 
FDebug
ıı 
.
ıı 
throwException
ıı )
(
ıı) *
ex
ıı* ,
)
ıı, -
;
ıı- .
}
şş 
finally
ÿÿ 
{
€€ 
}
‚‚ 
return
ƒƒ 
string
ƒƒ 
.
ƒƒ 
Empty
ƒƒ #
;
ƒƒ# $
}
„„ 
}
…… 	
public
‰‰ 
List
‰‰ 
<
‰‰ 
string
‰‰ 
>
‰‰ 
macAddresses
‰‰ (
{
ŠŠ 	
get
‹‹ 
{
ŒŒ 
try
 
{
 
return
 
	m_licItem
 $
[
$ %
$str
% 7
]
7 8
as
9 ;
List
< @
<
@ A
string
A G
>
G H
;
H I
}
 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘  
ex
‘‘! #
)
‘‘# $
{
’’ 
FDebug
““ 
.
““ 
throwException
““ )
(
““) *
ex
““* ,
)
““, -
;
““- .
}
”” 
finally
•• 
{
–– 
}
˜˜ 
return
™™ 
null
™™ 
;
™™ 
}
šš 
}
›› 	
public
ŸŸ 
bool
ŸŸ 
clientCheck
ŸŸ 
{
   	
get
¡¡ 
{
¢¢ 
try
££ 
{
¤¤ 
return
¥¥ 
	m_licItem
¥¥ $
[
¥¥$ %
$str
¥¥% 3
]
¥¥3 4
.
¥¥4 5
ToString
¥¥5 =
(
¥¥= >
)
¥¥> ?
.
¥¥? @
Equals
¥¥@ F
(
¥¥F G
$str
¥¥G L
)
¥¥L M
;
¥¥M N
}
¦¦ 
catch
§§ 
(
§§ 
	Exception
§§  
ex
§§! #
)
§§# $
{
¨¨ 
FDebug
©© 
.
©© 
throwException
©© )
(
©©) *
ex
©©* ,
)
©©, -
;
©©- .
}
ªª 
finally
«« 
{
¬¬ 
}
®® 
return
¯¯ 
false
¯¯ 
;
¯¯ 
}
°° 
}
±± 	
public
µµ 
int
µµ 

clientUser
µµ 
{
¶¶ 	
get
·· 
{
¸¸ 
try
¹¹ 
{
ºº 
return
»» 
(
»» 
int
»» 
)
»»  
	m_licItem
»»  )
[
»») *
$str
»»* 7
]
»»7 8
;
»»8 9
}
¼¼ 
catch
½½ 
(
½½ 
	Exception
½½  
ex
½½! #
)
½½# $
{
¾¾ 
FDebug
¿¿ 
.
¿¿ 
throwException
¿¿ )
(
¿¿) *
ex
¿¿* ,
)
¿¿, -
;
¿¿- .
}
ÀÀ 
finally
ÁÁ 
{
ÂÂ 
}
ÄÄ 
return
ÅÅ 
$num
ÅÅ 
;
ÅÅ 
}
ÆÆ 
}
ÇÇ 	
public
ËË 
int
ËË 
	clientEap
ËË 
{
ÌÌ 	
get
ÍÍ 
{
ÎÎ 
try
ÏÏ 
{
ĞĞ 
return
ÑÑ 
(
ÑÑ 
int
ÑÑ 
)
ÑÑ  
	m_licItem
ÑÑ  )
[
ÑÑ) *
$str
ÑÑ* 6
]
ÑÑ6 7
;
ÑÑ7 8
}
ÒÒ 
catch
ÓÓ 
(
ÓÓ 
	Exception
ÓÓ  
ex
ÓÓ! #
)
ÓÓ# $
{
ÔÔ 
FDebug
ÕÕ 
.
ÕÕ 
throwException
ÕÕ )
(
ÕÕ) *
ex
ÕÕ* ,
)
ÕÕ, -
;
ÕÕ- .
}
ÖÖ 
finally
×× 
{
ØØ 
}
ÚÚ 
return
ÛÛ 
$num
ÛÛ 
;
ÛÛ 
}
ÜÜ 
}
İİ 	
public
áá 
string
áá 
clientLimitPolicy
áá '
{
ââ 	
get
ãã 
{
ää 
try
åå 
{
ææ 
return
çç 
	m_licItem
çç $
[
çç$ %
$str
çç% :
]
çç: ;
.
çç; <
ToString
çç< D
(
ççD E
)
ççE F
;
ççF G
}
èè 
catch
éé 
(
éé 
	Exception
éé  
ex
éé! #
)
éé# $
{
êê 
FDebug
ëë 
.
ëë 
throwException
ëë )
(
ëë) *
ex
ëë* ,
)
ëë, -
;
ëë- .
}
ìì 
finally
íí 
{
îî 
}
ğğ 
return
ññ 
string
ññ 
.
ññ 
Empty
ññ #
;
ññ# $
}
òò 
}
óó 	
public
÷÷ 
bool
÷÷ 
	mobileUse
÷÷ 
{
øø 	
get
ùù 
{
úú 
try
ûû 
{
üü 
return
ıı 
	m_licItem
ıı $
[
ıı$ %
$str
ıı% 1
]
ıı1 2
.
ıı2 3
ToString
ıı3 ;
(
ıı; <
)
ıı< =
.
ıı= >
Equals
ıı> D
(
ııD E
$str
ııE J
)
ııJ K
;
ııK L
}
şş 
catch
ÿÿ 
(
ÿÿ 
	Exception
ÿÿ  
ex
ÿÿ! #
)
ÿÿ# $
{
€€ 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
‚‚ 
finally
ƒƒ 
{
„„ 
}
†† 
return
‡‡ 
false
‡‡ 
;
‡‡ 
}
ˆˆ 
}
‰‰ 	
public
 
int
 

mobileUser
 
{
 	
get
 
{
 
try
‘‘ 
{
’’ 
return
““ 
(
““ 
int
““ 
)
““  
	m_licItem
““  )
[
““) *
$str
““* 7
]
““7 8
;
““8 9
}
”” 
catch
•• 
(
•• 
	Exception
••  
ex
••! #
)
••# $
{
–– 
FDebug
—— 
.
—— 
throwException
—— )
(
——) *
ex
——* ,
)
——, -
;
——- .
}
˜˜ 
finally
™™ 
{
šš 
}
œœ 
return
 
$num
 
;
 
}
 
}
ŸŸ 	
public
££ 
string
££ 
mobileLimitPolicy
££ '
{
¤¤ 	
get
¥¥ 
{
¦¦ 
try
§§ 
{
¨¨ 
return
©© 
	m_licItem
©© $
[
©©$ %
$str
©©% :
]
©©: ;
.
©©; <
ToString
©©< D
(
©©D E
)
©©E F
;
©©F G
}
ªª 
catch
«« 
(
«« 
	Exception
««  
ex
««! #
)
««# $
{
¬¬ 
FDebug
­­ 
.
­­ 
throwException
­­ )
(
­­) *
ex
­­* ,
)
­­, -
;
­­- .
}
®® 
finally
¯¯ 
{
°° 
}
²² 
return
³³ 
string
³³ 
.
³³ 
Empty
³³ #
;
³³# $
}
´´ 
}
µµ 	
private
¹¹ 
string
¹¹ "
applicationNamespace
¹¹ +
{
ºº 	
get
»» 
{
¼¼ 
try
½½ 
{
¾¾ 
return
¿¿ 
Assembly
¿¿ #
.
¿¿# $
LoadFile
¿¿$ ,
(
¿¿, -
Application
¿¿- 8
.
¿¿8 9
ExecutablePath
¿¿9 G
)
¿¿G H
.
¿¿H I

EntryPoint
¿¿I S
.
¿¿S T
ReflectedType
¿¿T a
.
¿¿a b
	Namespace
¿¿b k
;
¿¿k l
}
ÀÀ 
catch
ÁÁ 
(
ÁÁ 
	Exception
ÁÁ  
ex
ÁÁ! #
)
ÁÁ# $
{
ÂÂ 
FDebug
ÃÃ 
.
ÃÃ 
throwException
ÃÃ )
(
ÃÃ) *
ex
ÃÃ* ,
)
ÃÃ, -
;
ÃÃ- .
}
ÄÄ 
finally
ÅÅ 
{
ÆÆ 
}
ÈÈ 
return
ÉÉ 
string
ÉÉ 
.
ÉÉ 
Empty
ÉÉ #
;
ÉÉ# $
}
ÊÊ 
}
ËË 	
public
ÓÓ 
void
ÓÓ 
init
ÓÓ 
(
ÓÓ 
)
ÔÔ 
{
ÕÕ 	
try
ÖÖ 
{
×× 
if
ØØ 
(
ØØ 
!
ØØ 
File
ØØ 
.
ØØ 
Exists
ØØ 
(
ØØ  
	m_licFile
ØØ  )
)
ØØ) *
)
ØØ* +
{
ÙÙ 

m_fLicCore
ÚÚ 
.
ÚÚ #
writeLogOfLicenseFail
ÚÚ 4
(
ÚÚ4 5

FConstants
ÚÚ5 ?
.
ÚÚ? @

err_m_0018
ÚÚ@ J
)
ÚÚJ K
;
ÚÚK L
Environment
ÛÛ 
.
ÛÛ  
Exit
ÛÛ  $
(
ÛÛ$ %
$num
ÛÛ% &
)
ÛÛ& '
;
ÛÛ' (
}
ÜÜ 
if
àà 
(
àà 
!
àà 

isModified
àà 
(
àà  
)
àà  !
)
àà! "
{
áá 

m_fLicCore
ââ 
.
ââ #
writeLogOfLicenseFail
ââ 4
(
ââ4 5

FConstants
ââ5 ?
.
ââ? @

err_m_0019
ââ@ J
)
ââJ K
;
ââK L
Environment
ãã 
.
ãã  
Exit
ãã  $
(
ãã$ %
$num
ãã% &
)
ãã& '
;
ãã' (
}
ää 
parse
èè 
(
èè 
)
èè 
;
èè 
validateOnce
ïï 
(
ïï 
)
ïï 
;
ïï 
validateRegularly
ğğ !
(
ğğ! "
)
ğğ" #
;
ğğ# $
m_fTmrMonitoring
ôô  
=
ôô! "
new
ôô# &
FStaticTimer
ôô' 3
(
ôô3 4
)
ôô4 5
;
ôô5 6
m_fTmrMonitoring
õõ  
.
õõ  !
start
õõ! &
(
õõ& '
MonitoringPeriod
õõ' 7
)
õõ7 8
;
õõ8 9

m_fThdMain
÷÷ 
=
÷÷ 
new
÷÷  
FThread
÷÷! (
(
÷÷( )
$str
÷÷) ;
)
÷÷; <
;
÷÷< =

m_fThdMain
øø 
.
øø 
ThreadJobCalled
øø *
+=
øø+ -
new
øø. 1*
FThreadJobCalledEventHandler
øø2 N
(
øøN O(
m_fThdMain_ThreadJobCalled
øøO i
)
øøi j
;
øøj k

m_fThdMain
ùù 
.
ùù 
start
ùù  
(
ùù  !
)
ùù! "
;
ùù" #
}
úú 
catch
ûû 
(
ûû 
	Exception
ûû 
ex
ûû 
)
ûû 
{
üü 
FDebug
ıı 
.
ıı 
throwException
ıı %
(
ıı% &
ex
ıı& (
)
ıı( )
;
ıı) *
}
şş 
finally
ÿÿ 
{
€€ 
}
‚‚ 
}
ƒƒ 	
private
‡‡ 
void
‡‡ 
term
‡‡ 
(
‡‡ 
)
ˆˆ 
{
‰‰ 	
try
ŠŠ 
{
‹‹ 
if
ŒŒ 
(
ŒŒ 

m_fThdMain
ŒŒ 
!=
ŒŒ !
null
ŒŒ" &
)
ŒŒ& '
{
 

m_fThdMain
 
.
 
stop
 #
(
# $
)
$ %
;
% &

m_fThdMain
 
.
 
Dispose
 &
(
& '
)
' (
;
( )

m_fThdMain
 
.
 
ThreadJobCalled
 .
-=
/ 1
new
2 5*
FThreadJobCalledEventHandler
6 R
(
R S(
m_fThdMain_ThreadJobCalled
S m
)
m n
;
n o

m_fThdMain
‘‘ 
=
‘‘  
null
‘‘! %
;
‘‘% &
}
’’ 
if
”” 
(
”” 
m_fTmrMonitoring
”” $
!=
””% '
null
””( ,
)
””, -
{
•• 
m_fTmrMonitoring
–– $
.
––$ %
Dispose
––% ,
(
––, -
)
––- .
;
––. /
m_fTmrMonitoring
—— $
=
——% &
null
——' +
;
——+ ,
}
˜˜ 
}
™™ 
catch
šš 
(
šš 
	Exception
šš 
ex
šš 
)
šš  
{
›› 
FDebug
œœ 
.
œœ 
throwException
œœ %
(
œœ% &
ex
œœ& (
)
œœ( )
;
œœ) *
}
 
finally
 
{
ŸŸ 
}
¡¡ 
}
¢¢ 	
private
¦¦ 
void
¦¦ 
validateOnce
¦¦ !
(
¦¦! "
)
§§ 
{
¨¨ 	
bool
©© 
isValid
©© 
=
©© 
false
©©  
;
©©  !
string
ªª 
message
ªª 
=
ªª 
string
ªª #
.
ªª# $
Empty
ªª$ )
;
ªª) *
try
¬¬ 
{
­­ 
if
±± 
(
±± 
!
±± 
productName
±±  
.
±±  !
Contains
±±! )
(
±±) *"
applicationNamespace
±±* >
)
±±> ?
)
±±? @
{
²² 
message
³³ 
=
³³ 
string
³³ $
.
³³$ %
Format
³³% +
(
³³+ ,

FConstants
³³, 6
.
³³6 7

err_m_0020
³³7 A
,
³³A B
$str
³³C Q
)
³³Q R
;
³³R S

m_fLicCore
´´ 
.
´´ #
writeLogOfLicenseFail
´´ 4
(
´´4 5
message
´´5 <
)
´´< =
;
´´= >
Environment
µµ 
.
µµ  
Exit
µµ  $
(
µµ$ %
$num
µµ% &
)
µµ& '
;
µµ' (
}
¶¶ 
isValid
½½ 
=
½½ 
false
½½ 
;
½½  
foreach
¾¾ 
(
¾¾ 
string
¾¾ 
addr
¾¾  $
in
¾¾% '
FUserPCInfo
¾¾( 3
.
¾¾3 4
MacAddressList
¾¾4 B
(
¾¾B C
)
¾¾C D
)
¾¾D E
{
¿¿ 
if
ÀÀ 
(
ÀÀ 
macAddresses
ÀÀ $
.
ÀÀ$ %
Contains
ÀÀ% -
(
ÀÀ- .
addr
ÀÀ. 2
)
ÀÀ2 3
)
ÀÀ3 4
{
ÁÁ 
isValid
ÂÂ 
=
ÂÂ  !
true
ÂÂ" &
;
ÂÂ& '
break
ÃÃ 
;
ÃÃ 
}
ÄÄ 
}
ÅÅ 
if
ÇÇ 
(
ÇÇ 
!
ÇÇ 
isValid
ÇÇ 
)
ÇÇ 
{
ÈÈ 
message
ÉÉ 
=
ÉÉ 
string
ÉÉ $
.
ÉÉ$ %
Format
ÉÉ% +
(
ÉÉ+ ,

FConstants
ÉÉ, 6
.
ÉÉ6 7

err_m_0020
ÉÉ7 A
,
ÉÉA B
$str
ÉÉC U
)
ÉÉU V
;
ÉÉV W

m_fLicCore
ÊÊ 
.
ÊÊ #
writeLogOfLicenseFail
ÊÊ 4
(
ÊÊ4 5
message
ÊÊ5 <
)
ÊÊ< =
;
ÊÊ= >
Environment
ËË 
.
ËË  
Exit
ËË  $
(
ËË$ %
$num
ËË% &
)
ËË& '
;
ËË' (
}
ÌÌ 
}
ÍÍ 
catch
ÎÎ 
(
ÎÎ 
	Exception
ÎÎ 
ex
ÎÎ 
)
ÎÎ  
{
ÏÏ 
FDebug
ĞĞ 
.
ĞĞ 
throwException
ĞĞ %
(
ĞĞ% &
ex
ĞĞ& (
)
ĞĞ( )
;
ĞĞ) *
}
ÑÑ 
finally
ÒÒ 
{
ÓÓ 
}
ÕÕ 
}
ÖÖ 	
private
ÚÚ 
void
ÚÚ 
validateRegularly
ÚÚ &
(
ÚÚ& '
)
ÛÛ 
{
ÜÜ 	
try
İİ 
{
ŞŞ 
checkPeriod
ßß 
(
ßß 
)
ßß 
;
ßß 
checkEap
àà 
(
àà 
)
àà 
;
àà 
}
áá 
catch
ââ 
(
ââ 
	Exception
ââ 
ex
ââ 
)
ââ  
{
ãã 
FDebug
ää 
.
ää 
throwException
ää %
(
ää% &
ex
ää& (
)
ää( )
;
ää) *
}
åå 
finally
ææ 
{
çç 
}
éé 
}
êê 	
private
îî 
void
îî 
parse
îî 
(
îî 
)
ïï 
{
ğğ 	
string
ññ 
buffer
ññ 
=
ññ 
string
ññ "
.
ññ" #
Empty
ññ# (
;
ññ( )
StreamReader
òò 
streamReader
òò %
=
òò& '
null
òò( ,
;
òò, -
string
ôô 
[
ôô 
]
ôô 
parts
ôô 
=
ôô 
null
ôô !
;
ôô! "
string
õõ 
[
õõ 
]
õõ 
rows
õõ 
=
õõ 
null
õõ  
;
õõ  !
string
öö 
[
öö 
]
öö 
items
öö 
=
öö 
null
öö !
;
öö! "
try
øø 
{
ùù 
streamReader
úú 
=
úú 
new
úú "
StreamReader
úú# /
(
úú/ 0
	m_licFile
úú0 9
)
úú9 :
;
úú: ;
buffer
ûû 
=
ûû 
streamReader
ûû %
.
ûû% &
	ReadToEnd
ûû& /
(
ûû/ 0
)
ûû0 1
;
ûû1 2
streamReader
üü 
.
üü 
Close
üü "
(
üü" #
)
üü# $
;
üü$ %
parts
€€ 
=
€€ 
buffer
€€ 
.
€€ 
Split
€€ $
(
€€$ %
new
€€% (
string
€€) /
[
€€/ 0
]
€€0 1
{
€€2 3
KeySeparator
€€4 @
}
€€A B
,
€€B C 
StringSplitOptions
€€D V
.
€€V W 
RemoveEmptyEntries
€€W i
)
€€i j
;
€€j k
buffer
„„ 
=
„„ 
(
„„ 
new
„„ 
FCrypt
„„ $
(
„„$ %
)
„„% &
)
„„& '
.
„„' (
decrypt2
„„( 0
(
„„0 1
parts
„„1 6
[
„„6 7
$num
„„7 8
]
„„8 9
)
„„9 :
;
„„: ;
rows
ˆˆ 
=
ˆˆ 
buffer
ˆˆ 
.
ˆˆ 
Split
ˆˆ #
(
ˆˆ# $
new
ˆˆ$ '
string
ˆˆ( .
[
ˆˆ. /
]
ˆˆ/ 0
{
ˆˆ1 2
LineSeparator
ˆˆ3 @
}
ˆˆA B
,
ˆˆB C 
StringSplitOptions
ˆˆD V
.
ˆˆV W 
RemoveEmptyEntries
ˆˆW i
)
ˆˆi j
;
ˆˆj k
foreach
‰‰ 
(
‰‰ 
string
‰‰ 
row
‰‰  #
in
‰‰$ &
rows
‰‰' +
)
‰‰+ ,
{
ŠŠ 
items
‹‹ 
=
‹‹ 
row
‹‹ 
.
‹‹  
Split
‹‹  %
(
‹‹% &
new
‹‹& )
string
‹‹* 0
[
‹‹0 1
]
‹‹1 2
{
‹‹3 4
FieldSeparator
‹‹5 C
}
‹‹D E
,
‹‹E F 
StringSplitOptions
‹‹G Y
.
‹‹Y Z 
RemoveEmptyEntries
‹‹Z l
)
‹‹l m
;
‹‹m n
match
ŒŒ 
(
ŒŒ 
items
ŒŒ 
[
ŒŒ  
$num
ŒŒ  !
]
ŒŒ! "
.
ŒŒ" #
Trim
ŒŒ# '
(
ŒŒ' (
)
ŒŒ( )
,
ŒŒ) *
items
ŒŒ+ 0
[
ŒŒ0 1
$num
ŒŒ1 2
]
ŒŒ2 3
.
ŒŒ3 4
Trim
ŒŒ4 8
(
ŒŒ8 9
)
ŒŒ9 :
)
ŒŒ: ;
;
ŒŒ; <
}
 
}
 
catch
 
(
 
	Exception
 
ex
 
)
  
{
 
FDebug
‘‘ 
.
‘‘ 
throwException
‘‘ %
(
‘‘% &
ex
‘‘& (
)
‘‘( )
;
‘‘) *
}
’’ 
finally
““ 
{
”” 
}
–– 
}
—— 	
private
›› 
bool
›› 

isModified
›› 
(
››  
)
œœ 
{
 	
string
 
buffer
 
=
 
string
 "
.
" #
Empty
# (
;
( )
string
ŸŸ 
[
ŸŸ 
]
ŸŸ 
parts
ŸŸ 
=
ŸŸ 
null
ŸŸ !
;
ŸŸ! "
StreamReader
   
streamReader
   %
=
  & '
null
  ( ,
;
  , -
try
¢¢ 
{
££ 
streamReader
¤¤ 
=
¤¤ 
new
¤¤ "
StreamReader
¤¤# /
(
¤¤/ 0
	m_licFile
¤¤0 9
)
¤¤9 :
;
¤¤: ;
buffer
¥¥ 
=
¥¥ 
streamReader
¥¥ %
.
¥¥% &
	ReadToEnd
¥¥& /
(
¥¥/ 0
)
¥¥0 1
;
¥¥1 2
streamReader
¦¦ 
.
¦¦ 
Close
¦¦ "
(
¦¦" #
)
¦¦# $
;
¦¦$ %
parts
ªª 
=
ªª 
buffer
ªª 
.
ªª 
Split
ªª $
(
ªª$ %
new
ªª% (
string
ªª) /
[
ªª/ 0
]
ªª0 1
{
ªª2 3
KeySeparator
ªª4 @
}
ªªA B
,
ªªB C 
StringSplitOptions
ªªD V
.
ªªV W 
RemoveEmptyEntries
ªªW i
)
ªªi j
;
ªªj k
parts
¬¬ 
[
¬¬ 
$num
¬¬ 
]
¬¬ 
=
¬¬ 
parts
¬¬  
[
¬¬  !
$num
¬¬! "
]
¬¬" #
.
¬¬# $
Replace
¬¬$ +
(
¬¬+ ,
$str
¬¬, 0
,
¬¬0 1
$str
¬¬2 4
)
¬¬4 5
;
¬¬5 6
parts
­­ 
[
­­ 
$num
­­ 
]
­­ 
=
­­ 
parts
­­  
[
­­  !
$num
­­! "
]
­­" #
.
­­# $
Replace
­­$ +
(
­­+ ,
$str
­­, 0
,
­­0 1
$str
­­2 4
)
­­4 5
;
­­5 6
parts
±± 
[
±± 
$num
±± 
]
±± 
=
±± 
(
±± 
new
±± 
FCrypt
±±  &
(
±±& '
)
±±' (
)
±±( )
.
±±) *
decrypt2
±±* 2
(
±±2 3
parts
±±3 8
[
±±8 9
$num
±±9 :
]
±±: ;
)
±±; <
;
±±< =
parts
²² 
[
²² 
$num
²² 
]
²² 
=
²² 
parts
²²  
[
²²  !
$num
²²! "
]
²²" #
.
²²# $
Replace
²²$ +
(
²²+ ,
$str
²², 0
,
²²0 1
$str
²²2 4
)
²²4 5
;
²²5 6
parts
³³ 
[
³³ 
$num
³³ 
]
³³ 
=
³³ 
parts
³³  
[
³³  !
$num
³³! "
]
³³" #
.
³³# $
Replace
³³$ +
(
³³+ ,
$str
³³, 0
,
³³0 1
$str
³³2 4
)
³³4 5
;
³³5 6
return
·· 
parts
·· 
[
·· 
$num
·· 
]
·· 
.
··  
Equals
··  &
(
··& '
parts
··' ,
[
··, -
$num
··- .
]
··. /
)
··/ 0
;
··0 1
}
¸¸ 
catch
¹¹ 
(
¹¹ 
	Exception
¹¹ 
ex
¹¹ 
)
¹¹  
{
ºº 
FDebug
»» 
.
»» 
throwException
»» %
(
»»% &
ex
»»& (
)
»»( )
;
»») *
}
¼¼ 
finally
½½ 
{
¾¾ 
if
¿¿ 
(
¿¿ 
streamReader
¿¿  
!=
¿¿! #
null
¿¿$ (
)
¿¿( )
{
ÀÀ 
streamReader
ÁÁ  
.
ÁÁ  !
Dispose
ÁÁ! (
(
ÁÁ( )
)
ÁÁ) *
;
ÁÁ* +
streamReader
ÂÂ  
=
ÂÂ! "
null
ÂÂ# '
;
ÂÂ' (
}
ÃÃ 
}
ÄÄ 
return
ÅÅ 
false
ÅÅ 
;
ÅÅ 
}
ÆÆ 	
private
ÊÊ 
void
ÊÊ 
match
ÊÊ 
(
ÊÊ 
string
ËË 
name
ËË 
,
ËË 
string
ÌÌ 
value
ÌÌ 
)
ÍÍ 
{
ÎÎ 	
string
ÏÏ 
[
ÏÏ 
]
ÏÏ 
values
ÏÏ 
=
ÏÏ 
null
ÏÏ "
;
ÏÏ" #
try
ÑÑ 
{
ÒÒ 
if
ÓÓ 
(
ÓÓ 
name
ÔÔ 
.
ÔÔ 
Equals
ÔÔ 
(
ÔÔ  
$str
ÔÔ  1
)
ÔÔ1 2
||
ÔÔ3 5
name
ÕÕ 
.
ÕÕ 
Equals
ÕÕ 
(
ÕÕ  
$str
ÕÕ  .
)
ÕÕ. /
||
ÕÕ0 2
name
ÖÖ 
.
ÖÖ 
Equals
ÖÖ 
(
ÖÖ  
$str
ÖÖ  2
)
ÖÖ2 3
||
ÖÖ4 6
name
×× 
.
×× 
Equals
×× 
(
××  
$str
××  2
)
××2 3
||
××4 6
name
ØØ 
.
ØØ 
Equals
ØØ 
(
ØØ  
$str
ØØ  -
)
ØØ- .
||
ØØ/ 1
name
ÙÙ 
.
ÙÙ 
Equals
ÙÙ 
(
ÙÙ  
$str
ÙÙ  .
)
ÙÙ. /
||
ÙÙ0 2
name
ÚÚ 
.
ÚÚ 
Equals
ÚÚ 
(
ÚÚ  
$str
ÚÚ  .
)
ÚÚ. /
||
ÚÚ0 2
name
ÛÛ 
.
ÛÛ 
Equals
ÛÛ 
(
ÛÛ  
$str
ÛÛ  5
)
ÛÛ5 6
||
ÛÛ7 9
name
ÜÜ 
.
ÜÜ 
Equals
ÜÜ 
(
ÜÜ  
$str
ÜÜ  5
)
ÜÜ5 6
||
ÜÜ7 9
name
İİ 
.
İİ 
Equals
İİ 
(
İİ  
$str
İİ  ,
)
İİ, -
)
ŞŞ 
{
ßß 
	m_licItem
àà 
.
àà 
Add
àà !
(
àà! "
name
àà" &
,
àà& '
value
àà( -
)
àà- .
;
àà. /
}
áá 
else
ââ 
if
ââ 
(
ââ 
name
ãã 
.
ãã 
Equals
ãã 
(
ãã  
$str
ãã  .
)
ãã. /
||
ãã0 2
name
ää 
.
ää 
Equals
ää 
(
ää  
$str
ää  2
)
ää2 3
)
åå 
{
ææ 
values
çç 
=
çç 
value
çç "
.
çç" #
Split
çç# (
(
çç( )
new
çç) ,
string
çç- 3
[
çç3 4
]
çç4 5
{
çç6 7
$str
çç8 ;
,
çç; <
$str
çç= @
,
çç@ A
$str
ççB E
}
ççF G
,
ççG H 
StringSplitOptions
ççI [
.
çç[ \ 
RemoveEmptyEntries
çç\ n
)
ççn o
;
çço p
	m_licItem
èè 
.
èè 
Add
èè !
(
èè! "
name
èè" &
,
èè& '
new
èè( +
List
èè, 0
<
èè0 1
string
èè1 7
>
èè7 8
(
èè8 9
values
èè9 ?
)
èè? @
)
èè@ A
;
èèA B
}
éé 
else
êê 
if
êê 
(
êê 
name
ëë 
.
ëë 
Equals
ëë 
(
ëë  
$str
ëë  -
)
ëë- .
||
ëë/ 1
name
ìì 
.
ìì 
Equals
ìì 
(
ìì  
$str
ìì  ,
)
ìì, -
||
ìì. 0
name
íí 
.
íí 
Equals
íí 
(
íí  
$str
íí  -
)
íí- .
)
îî 
{
ïï 
	m_licItem
ğğ 
.
ğğ 
Add
ğğ !
(
ğğ! "
name
ğğ" &
,
ğğ& '
int
ğğ( +
.
ğğ+ ,
Parse
ğğ, 1
(
ğğ1 2
value
ğğ2 7
)
ğğ7 8
)
ğğ8 9
;
ğğ9 :
}
ññ 
}
òò 
catch
óó 
(
óó 
	Exception
óó 
ex
óó 
)
óó  
{
ôô 
FDebug
õõ 
.
õõ 
throwException
õõ %
(
õõ% &
ex
õõ& (
)
õõ( )
;
õõ) *
}
öö 
finally
÷÷ 
{
øø 
}
úú 
}
ûû 	
private
ÿÿ 
void
ÿÿ 
checkPeriod
ÿÿ  
(
ÿÿ  !
)
€€ 
{
 	
string
‚‚ 
message
‚‚ 
=
‚‚ 
string
‚‚ #
.
‚‚# $
Empty
‚‚$ )
;
‚‚) *
try
„„ 
{
…… 
if
†† 
(
†† 
!
‡‡ 
expiredDate
‡‡  
.
‡‡  !
Equals
‡‡! '
(
‡‡' (
$str
‡‡( 3
)
‡‡3 4
&&
‡‡5 7
DateTime
ˆˆ 
.
ˆˆ 
Parse
ˆˆ "
(
ˆˆ" #
expiredDate
ˆˆ# .
)
ˆˆ. /
.
ˆˆ/ 0
	CompareTo
ˆˆ0 9
(
ˆˆ9 :
DateTime
ˆˆ: B
.
ˆˆB C
Now
ˆˆC F
)
ˆˆF G
<
ˆˆH I
$num
ˆˆJ K
)
‰‰ 
{
ŠŠ 
message
‹‹ 
=
‹‹ 
string
‹‹ $
.
‹‹$ %
Format
‹‹% +
(
‹‹+ ,

FConstants
‹‹, 6
.
‹‹6 7

err_m_0020
‹‹7 A
,
‹‹A B
$str
‹‹C Q
)
‹‹Q R
;
‹‹R S

m_fLicCore
ŒŒ 
.
ŒŒ #
writeLogOfLicenseFail
ŒŒ 4
(
ŒŒ4 5
message
ŒŒ5 <
)
ŒŒ< =
;
ŒŒ= >
Environment
 
.
  
Exit
  $
(
$ %
$num
% &
)
& '
;
' (
}
 
}
 
catch
 
(
 
	Exception
 
ex
 
)
  
{
‘‘ 
FDebug
’’ 
.
’’ 
throwException
’’ %
(
’’% &
ex
’’& (
)
’’( )
;
’’) *
}
““ 
finally
”” 
{
•• 
}
—— 
}
˜˜ 	
private
œœ 
void
œœ 
checkEap
œœ 
(
œœ 
)
 
{
 	
int
ŸŸ 
eapCount
ŸŸ 
=
ŸŸ 
$num
ŸŸ 
;
ŸŸ 
FSql
¡¡ 
fSql
¡¡ 
=
¡¡ 
null
¡¡ 
;
¡¡ 
FIQueryExecutor
¢¢ 
fqExe
¢¢ !
=
¢¢" #
null
¢¢$ (
;
¢¢( )
DataSet
££ 
ds
££ 
=
££ 
null
££ 
;
££ 
	DataTable
¤¤ 

fraseapdef
¤¤  
=
¤¤! "
null
¤¤# '
;
¤¤' (
string
¥¥ 
sql
¥¥ 
=
¥¥ 
string
¥¥ 
.
¥¥  
Empty
¥¥  %
;
¥¥% &
string
¦¦ 
message
¦¦ 
=
¦¦ 
string
¦¦ #
.
¦¦# $
Empty
¦¦$ )
;
¦¦) *
try
¨¨ 
{
©© 
sql
ªª 
=
ªª 
$str
ªª Y
;
ªªY Z
fqExe
«« 
=
«« 

FDbAdapter
«« "
.
««" #!
createQueryExecutor
««# 6
(
««6 7
m_fDbProvider
««7 D
,
««D E
m_connectString
««F U
)
««U V
;
««V W
fSql
¬¬ 
=
¬¬ 
new
¬¬ 
FSql
¬¬ 
(
¬¬  
$str
¬¬  ,
,
¬¬, -
sql
¬¬. 1
)
¬¬1 2
;
¬¬2 3
fqExe
­­ 
.
­­ 
	appendSql
­­ 
(
­­  
fSql
­­  $
)
­­$ %
;
­­% &
ds
±± 
=
±± 
fqExe
±± 
.
±± 
execute
±± "
(
±±" #
)
±±# $
;
±±$ %

fraseapdef
²² 
=
²² 
ds
²² 
.
²²  
Tables
²²  &
[
²²& '
$str
²²' 3
]
²²3 4
;
²²4 5
eapCount
³³ 
=
³³ 
(
³³ 
int
³³ 
)
³³  

fraseapdef
³³  *
.
³³* +
Rows
³³+ /
[
³³/ 0
$num
³³0 1
]
³³1 2
[
³³2 3
$str
³³3 >
]
³³> ?
;
³³? @
if
·· 
(
·· 
eapCount
·· 
>
·· 
	clientEap
·· (
)
··( )
{
¸¸ 
message
¹¹ 
=
¹¹ 
string
¹¹ $
.
¹¹$ %
Format
¹¹% +
(
¹¹+ ,

FConstants
¹¹, 6
.
¹¹6 7

err_m_0020
¹¹7 A
,
¹¹A B
$str
¹¹C H
)
¹¹H I
;
¹¹I J

m_fLicCore
ºº 
.
ºº #
writeLogOfLicenseFail
ºº 4
(
ºº4 5
message
ºº5 <
)
ºº< =
;
ºº= >
Environment
»» 
.
»»  
Exit
»»  $
(
»»$ %
$num
»»% &
)
»»& '
;
»»' (
}
¼¼ 
}
½½ 
catch
¾¾ 
(
¾¾ 
	Exception
¾¾ 
ex
¾¾ 
)
¾¾ 
{
¿¿ 
FDebug
ÀÀ 
.
ÀÀ 
throwException
ÀÀ %
(
ÀÀ% &
ex
ÀÀ& (
)
ÀÀ( )
;
ÀÀ) *
}
ÁÁ 
finally
ÂÂ 
{
ÃÃ 
fqExe
ÄÄ 
=
ÄÄ 
null
ÄÄ 
;
ÄÄ 
fSql
ÅÅ 
=
ÅÅ 
null
ÅÅ 
;
ÅÅ 
ds
ÆÆ 
=
ÆÆ 
null
ÆÆ 
;
ÆÆ 

fraseapdef
ÇÇ 
=
ÇÇ 
null
ÇÇ !
;
ÇÇ! "
}
ÈÈ 
}
ÉÉ 	
private
ÑÑ 
void
ÑÑ (
m_fThdMain_ThreadJobCalled
ÑÑ /
(
ÑÑ/ 0
object
ÒÒ 
sender
ÒÒ 
,
ÒÒ 
FThreadEventArgs
ÓÓ 
e
ÓÓ 
)
ÔÔ 
{
ÕÕ 	
try
ÖÖ 
{
×× 
if
ÛÛ 
(
ÛÛ 
!
ÛÛ 
m_fTmrMonitoring
ÛÛ %
.
ÛÛ% &
elasped
ÛÛ& -
(
ÛÛ- .
true
ÛÛ. 2
)
ÛÛ2 3
)
ÛÛ3 4
{
ÜÜ 
e
İİ 
.
İİ 
sleepThread
İİ !
(
İİ! "
$num
İİ" #
)
İİ# $
;
İİ$ %
return
ŞŞ 
;
ŞŞ 
}
ßß 
validateRegularly
ææ !
(
ææ! "
)
ææ" #
;
ææ# $
}
çç 
catch
èè 
(
èè 
	Exception
èè 
ex
èè 
)
èè  
{
éé 
FDebug
êê 
.
êê 
throwException
êê %
(
êê% &
ex
êê& (
)
êê( )
;
êê) *
}
ëë 
finally
ìì 
{
íí 
}
ïï 
}
ğğ 	
}
öö 
}÷÷ ó
\D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\i_FILicCore.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

	interface 
	FILicCore 
{ 
void !
writeLogOfLicenseFail "
(" #
string 
message 
) 
; 
}$$ 
}%% ©*
\D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Event\c_FManualEvent.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FManualEvent 
: 
IDisposable  +
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
bool 
m_locked 
= 
false  %
;% &
private 
ManualResetEvent  
m_event! (
=) *
null+ /
;/ 0
public## 
FManualEvent## 
(## 
)$$ 
{%% 	
m_event&& 
=&& 
new&& 
ManualResetEvent&& *
(&&* +
false&&+ 0
)&&0 1
;&&1 2
}'' 	
~++ 	
FManualEvent++	 
(++ 
),, 
{-- 	
	myDispose.. 
(.. 
false.. 
).. 
;.. 
}// 	
	protected33 
void33 
	myDispose33  
(33  !
bool44 
	disposing44 
)55 
{66 	
if77 
(77 
!77 

m_disposed77 
)77 
{88 
if99 
(99 
	disposing99 
)99 
{:: 
if;; 
(;; 
m_event;; 
!=;;  "
null;;# '
);;' (
{<< 
m_event== 
.==  
Close==  %
(==% &
)==& '
;==' (
m_event>> 
.>>  
Dispose>>  '
(>>' (
)>>( )
;>>) *
m_event?? 
=??  !
null??" &
;??& '
}@@ 
}AA 

m_disposedCC 
=CC 
trueCC !
;CC! "
}DD 
}EE 	
publicMM 
voidMM 
DisposeMM 
(MM 
)NN 
{OO 	
	myDisposePP 
(PP 
truePP 
)PP 
;PP 
GCQQ 
.QQ 
SuppressFinalizeQQ 
(QQ  
thisQQ  $
)QQ$ %
;QQ% &
}RR 	
publicZZ 
boolZZ 
lockedZZ 
{[[ 	
get\\ 
{]] 
try^^ 
{__ 
return`` 
m_locked`` #
;``# $
}aa 
catchbb 
(bb 
	Exceptionbb  
exbb! #
)bb# $
{cc 
FDebugdd 
.dd 
throwExceptiondd )
(dd) *
exdd* ,
)dd, -
;dd- .
}ee 
finallyff 
{gg 
}ii 
returnjj 
falsejj 
;jj 
}kk 
}ll 	
publictt 
booltt 
tryWaittt 
(tt 
intuu 
timeuu 
)vv 
{ww 	
boolxx 
isWaitxx 
=xx 
falsexx 
;xx  
tryzz 
{{{ 
isWait|| 
=|| 
m_event||  
.||  !
WaitOne||! (
(||( )
time||) -
)||- .
;||. /
if}} 
(}} 
isWait}} 
)}} 
{~~ 
m_locked 
= 
true #
;# $
}
€€ 
return
 
isWait
 
;
 
}
‚‚ 
catch
ƒƒ 
(
ƒƒ 
	Exception
ƒƒ 
ex
ƒƒ 
)
ƒƒ  
{
„„ 
FDebug
…… 
.
…… 
throwException
…… %
(
……% &
ex
……& (
)
……( )
;
……) *
}
†† 
finally
‡‡ 
{
ˆˆ 
}
ŠŠ 
return
‹‹ 
false
‹‹ 
;
‹‹ 
}
ŒŒ 	
public
 
void
 
set
 
(
 
)
‘‘ 
{
’’ 	
try
““ 
{
”” 
m_locked
•• 
=
•• 
false
••  
;
••  !
m_event
–– 
.
–– 
Set
–– 
(
–– 
)
–– 
;
–– 
}
—— 
catch
˜˜ 
(
˜˜ 
	Exception
˜˜ 
ex
˜˜ 
)
˜˜  
{
™™ 
FDebug
šš 
.
šš 
throwException
šš %
(
šš% &
ex
šš& (
)
šš( )
;
šš) *
}
›› 
finally
œœ 
{
 
}
ŸŸ 
}
   	
public
¤¤ 
void
¤¤ 
reset
¤¤ 
(
¤¤ 
)
¥¥ 
{
¦¦ 	
try
§§ 
{
¨¨ 
m_event
©© 
.
©© 
Reset
©© 
(
©© 
)
©© 
;
©©  
m_locked
ªª 
=
ªª 
false
ªª  
;
ªª  !
}
«« 
catch
¬¬ 
(
¬¬ 
	Exception
¬¬ 
ex
¬¬ 
)
¬¬  
{
­­ 
FDebug
®® 
.
®® 
throwException
®® %
(
®®% &
ex
®®& (
)
®®( )
;
®®) *
}
¯¯ 
finally
°° 
{
±± 
}
³³ 
}
´´ 	
}
ºº 
}»» ™×
SD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Ftp\c_FSftp.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FSftp 
: 
IDisposable $
{ 
private 
const 
string 
	ftpString &
=' (
$str) 1
;1 2
private   
const   
string   
ftpSlash   %
=  & '
$str  ( +
;  + ,
private!! 
const!! 
int!! 
ftpDefaultPort!! (
=!!) *
$num!!+ -
;!!- .
private## 
bool## 

m_disposed## 
=##  !
false##" '
;##' (
private%% 
string%% 
m_ftpFullPath%% $
=%%% &
string%%' -
.%%- .
Empty%%. 3
;%%3 4
private&& 
string&& 
m_host&& 
=&& 
string&&  &
.&&& '
Empty&&' ,
;&&, -
private'' 
int'' 
m_port'' 
='' 
$num'' 
;'' 
private(( 
string(( 
m_directory(( "
=((# $
string((% +
.((+ ,
Empty((, 1
;((1 2
private)) 
string)) 

m_userName)) !
=))" #
string))$ *
.))* +
Empty))+ 0
;))0 1
private** 
string** 

m_password** !
=**" #
string**$ *
.*** +
Empty**+ 0
;**0 1
private++ 
bool++ 
m_useSsl++ 
=++ 
false++  %
;++% &
private-- 
bool-- 
m_uploadPathExist-- &
=--' (
false--) .
;--. /
public33 
FSftp33 
(33 
string44 
ftpPath44 
)55 
{66 	
string77 
temp77 
=77 
string77  
.77  !
Empty77! &
;77& '
string88 
[88 
]88 
	tempArray88 
=88  
null88! %
;88% &
string99 
host99 
=99 
string99  
.99  !
Empty99! &
;99& '
int:: 
port:: 
=:: 
$num:: 
;:: 
int;; 
directoryIndex;; 
=;;  
$num;;! "
;;;" #
int<< 
	portIndex<< 
=<< 
$num<< 
;<< 
if>> 
(>> 
ftpPath>> 
.>> 
	Substring>> !
(>>! "
ftpPath>>" )
.>>) *
Length>>* 0
->>1 2
$num>>3 4
)>>4 5
!=>>6 8
$str>>9 <
)>>< =
{?? 
ftpPath@@ 
+=@@ 
$str@@ 
;@@ 
}AA 
directoryIndexCC 
=CC 
ftpPathCC $
.CC$ %
ToLowerCC% ,
(CC, -
)CC- .
.CC. /
IndexOfCC/ 6
(CC6 7
	ftpStringCC7 @
)CC@ A
;CCA B
ifEE 
(EE 
directoryIndexEE 
!=EE !
$numEE" #
)EE# $
{FF 
FDebugGG 
.GG 
throwFExceptionGG &
(GG& '
$strGG' P
)GGP Q
;GGQ R
}HH 
tempJJ 
=JJ 
ftpPathJJ 
.JJ 
	SubstringJJ $
(JJ$ %
$numJJ% &
)JJ& '
;JJ' (
	tempArrayKK 
=KK 
tempKK 
.KK 
SplitKK "
(KK" #
$charKK# &
)KK& '
;KK' (
	portIndexMM 
=MM 
	tempArrayMM !
[MM! "
$numMM" #
]MM# $
.MM$ %
IndexOfMM% ,
(MM, -
$charMM- 0
)MM0 1
;MM1 2
ifNN 
(NN 
	portIndexNN 
==NN 
-NN 
$numNN 
)NN  
{OO 
hostPP 
=PP 
	tempArrayPP  
[PP  !
$numPP! "
]PP" #
;PP# $
portQQ 
=QQ 
ftpDefaultPortQQ %
;QQ% &
}RR 
elseSS 
{TT 
hostUU 
=UU 
	tempArrayUU  
[UU  !
$numUU! "
]UU" #
.UU# $
	SubstringUU$ -
(UU- .
$numUU. /
,UU/ 0
	portIndexUU1 :
)UU: ;
;UU; <
portVV 
=VV 
ConvertVV 
.VV 
ToInt32VV &
(VV& '
	tempArrayVV' 0
[VV0 1
$numVV1 2
]VV2 3
.VV3 4
	SubstringVV4 =
(VV= >
	portIndexVV> G
+VVH I
$numVVJ K
)VVK L
)VVL M
;VVM N
}WW 
m_ftpFullPathYY 
=YY 
ftpPathYY #
;YY# $
m_hostZZ 
=ZZ 
hostZZ 
;ZZ 
m_port[[ 
=[[ 
port[[ 
;[[ 
m_directory\\ 
=\\ 
temp\\ 
.\\ 
	Substring\\ (
(\\( )
temp\\) -
.\\- .
IndexOf\\. 5
(\\5 6
$char\\6 9
)\\9 :
)\\: ;
;\\; <
if]] 
(]] 

m_userName]] 
!=]] 
string]] $
.]]$ %
Empty]]% *
)]]* +
{^^ 

m_userName__ 
=__ 
$str__ (
;__( )
}`` 
ifaa 
(aa 

m_passwordaa 
!=aa 
stringaa $
.aa$ %
Emptyaa% *
)aa* +
{bb 

m_passwordcc 
=cc 
$strcc 
;cc  
}dd 
}ee 	
publicii 
FSftpii 
(ii 
stringjj 
ftpPathjj 
,jj 
stringkk 
usernamekk 
,kk 
stringll 
passwordll 
,ll 
boolmm 
useSslmm 
=mm 
falsemm 
)nn 
:oo 
thisoo 
(oo 
ftpPathoo 
)oo 
{pp 	

m_userNameqq 
=qq 
usernameqq !
;qq! "

m_passwordrr 
=rr 
passwordrr !
;rr! "
m_useSslss 
=ss 
useSslss 
;ss 
}tt 	
~xx 	
FSftpxx	 
(xx 
)yy 
{zz 	
	myDispose{{ 
({{ 
false{{ 
){{ 
;{{ 
}|| 	
private
€€ 
void
€€ 
	myDispose
€€ 
(
€€ 
bool
 
	disposing
 
)
‚‚ 
{
ƒƒ 	
if
„„ 
(
„„ 
!
„„ 

m_disposed
„„ 
)
„„ 
{
…… 
if
†† 
(
†† 
	disposing
†† 
)
†† 
{
‡‡ 
}
‰‰ 

m_disposed
ŠŠ 
=
ŠŠ 
true
ŠŠ !
;
ŠŠ! "
}
‹‹ 
}
ŒŒ 	
public
”” 
void
”” 
Dispose
”” 
(
”” 
)
•• 
{
–– 	
	myDispose
—— 
(
—— 
true
—— 
)
—— 
;
—— 
GC
˜˜ 
.
˜˜ 
SuppressFinalize
˜˜ 
(
˜˜  
this
˜˜  $
)
˜˜$ %
;
˜˜% &
}
™™ 	
public
¡¡ 
bool
¡¡ 
uploadPathExist
¡¡ #
{
¢¢ 	
get
££ 
{
¤¤ 
try
¥¥ 
{
¦¦ 
return
§§ 
m_uploadPathExist
§§ ,
;
§§, -
}
¨¨ 
catch
©© 
(
©© 
	Exception
©©  
ex
©©! #
)
©©# $
{
ªª 
FDebug
«« 
.
«« 
throwException
«« )
(
««) *
ex
««* ,
)
««, -
;
««- .
}
¬¬ 
finally
­­ 
{
®® 
}
°° 
return
±± 
false
±± 
;
±± 
}
²² 
set
´´ 
{
µµ 
try
¶¶ 
{
·· 
m_uploadPathExist
¸¸ %
=
¸¸& '
value
¸¸( -
;
¸¸- .
}
¹¹ 
catch
ºº 
(
ºº 
	Exception
ºº  
ex
ºº! #
)
ºº# $
{
»» 
FDebug
¼¼ 
.
¼¼ 
throwException
¼¼ )
(
¼¼) *
ex
¼¼* ,
)
¼¼, -
;
¼¼- .
}
½½ 
finally
¾¾ 
{
¿¿ 
}
ÁÁ 
}
ÂÂ 
}
ÃÃ 	
private
ËË 
void
ËË 
createDirectory
ËË $
(
ËË$ %
string
ÌÌ 
dateDirectory
ÌÌ  
)
ÍÍ 
{
ÎÎ 	

SftpClient
ÏÏ 
sftp
ÏÏ 
=
ÏÏ 
null
ÏÏ "
;
ÏÏ" #
IEnumerable
ĞĞ 
<
ĞĞ 
SftpFile
ĞĞ  
>
ĞĞ  !
sftpfileList
ĞĞ" .
=
ĞĞ/ 0
null
ĞĞ1 5
;
ĞĞ5 6
List
ÒÒ 
<
ÒÒ 
string
ÒÒ 
>
ÒÒ 
paths
ÒÒ 
=
ÒÒ  
null
ÒÒ! %
;
ÒÒ% &
string
ÓÓ 
[
ÓÓ 
]
ÓÓ 
steps
ÓÓ 
=
ÓÓ 
null
ÓÓ !
;
ÓÓ! "
try
ÕÕ 
{
ÖÖ 
sftp
×× 
=
×× 
new
×× 

SftpClient
×× %
(
××% &
m_host
××& ,
,
××, -
m_port
××. 4
,
××4 5

m_userName
××6 @
,
××@ A

m_password
××B L
)
××L M
;
××M N
paths
ÛÛ 
=
ÛÛ 
new
ÛÛ 
List
ÛÛ  
<
ÛÛ  !
string
ÛÛ! '
>
ÛÛ' (
(
ÛÛ( )
)
ÛÛ) *
;
ÛÛ* +
steps
ÜÜ 
=
ÜÜ 
m_directory
ÜÜ #
.
ÜÜ# $
Split
ÜÜ$ )
(
ÜÜ) *
new
ÜÜ* -
char
ÜÜ. 2
[
ÜÜ2 3
]
ÜÜ3 4
{
ÜÜ5 6
$char
ÜÜ7 :
}
ÜÜ; <
,
ÜÜ< = 
StringSplitOptions
ÜÜ> P
.
ÜÜP Q 
RemoveEmptyEntries
ÜÜQ c
)
ÜÜc d
;
ÜÜd e
sftp
ää 
.
ää 
Connect
ää 
(
ää 
)
ää 
;
ää 
for
êê 
(
êê 
int
êê 
i
êê 
=
êê 
$num
êê 
;
êê 
i
êê  !
<=
êê" $
steps
êê% *
.
êê* +
Length
êê+ 1
;
êê1 2
i
êê3 4
++
êê4 6
)
êê6 7
{
ëë 
try
ìì 
{
íí 
sftpfileList
îî $
=
îî% &
sftp
îî' +
.
îî+ ,
ListDirectory
îî, 9
(
îî9 :
String
îî: @
.
îî@ A
Join
îîA E
(
îîE F
ftpSlash
îîF N
,
îîN O
steps
îîP U
,
îîU V
$num
îîW X
,
îîX Y
i
îîZ [
)
îî[ \
+
îî] ^
ftpSlash
îî_ g
)
îîg h
;
îîh i
}
ïï 
catch
ğğ 
(
ğğ '
SftpPathNotFoundException
ğğ 4
spex
ğğ5 9
)
ğğ9 :
{
ññ 
sftp
óó 
.
óó 
CreateDirectory
óó ,
(
óó, -
String
óó- 3
.
óó3 4
Join
óó4 8
(
óó8 9
ftpSlash
óó9 A
,
óóA B
steps
óóC H
,
óóH I
$num
óóJ K
,
óóK L
i
óóM N
)
óóN O
+
óóP Q
ftpSlash
óóR Z
)
óóZ [
;
óó[ \
}
ôô 
catch
õõ 
(
õõ 
	Exception
õõ $
ex
õõ% '
)
õõ' (
{
öö 
FDebug
÷÷ 
.
÷÷ 
throwException
÷÷ -
(
÷÷- .
ex
÷÷. 0
)
÷÷0 1
;
÷÷1 2
}
øø 
}
ùù 
try
ıı 
{
şş 
sftp
ÿÿ 
.
ÿÿ 
ListDirectory
ÿÿ &
(
ÿÿ& '
sftp
ÿÿ' +
.
ÿÿ+ ,
WorkingDirectory
ÿÿ, <
+
ÿÿ= >
m_directory
ÿÿ? J
+
ÿÿK L
dateDirectory
ÿÿM Z
+
ÿÿ[ \
ftpSlash
ÿÿ] e
)
ÿÿe f
;
ÿÿf g
}
€€ 
catch
 
(
 '
SftpPathNotFoundException
 0
spex
1 5
)
5 6
{
‚‚ 
sftp
ƒƒ 
.
ƒƒ 
CreateDirectory
ƒƒ (
(
ƒƒ( )
sftp
ƒƒ) -
.
ƒƒ- .
WorkingDirectory
ƒƒ. >
+
ƒƒ? @
m_directory
ƒƒA L
+
ƒƒM N
dateDirectory
ƒƒO \
+
ƒƒ] ^
ftpSlash
ƒƒ_ g
)
ƒƒg h
;
ƒƒh i
}
„„ 
catch
…… 
(
…… 
	Exception
……  
ex
……! #
)
……# $
{
†† 
FDebug
‡‡ 
.
‡‡ 
throwException
‡‡ )
(
‡‡) *
ex
‡‡* ,
)
‡‡, -
;
‡‡- .
}
ˆˆ 
}
‰‰ 
catch
ŠŠ 
(
ŠŠ 
	Exception
ŠŠ 
ex
ŠŠ 
)
ŠŠ  
{
‹‹ 
FDebug
ŒŒ 
.
ŒŒ 
throwException
ŒŒ %
(
ŒŒ% &
ex
ŒŒ& (
)
ŒŒ( )
;
ŒŒ) *
}
 
finally
 
{
 
sftpfileList
 
=
 
null
 #
;
# $
if
’’ 
(
’’ 
sftp
’’ 
!=
’’ 
null
’’  
)
’’  !
{
““ 
sftp
”” 
.
”” 

Disconnect
”” #
(
””# $
)
””$ %
;
””% &
sftp
•• 
.
•• 
Dispose
••  
(
••  !
)
••! "
;
••" #
sftp
–– 
=
–– 
null
–– 
;
––  
}
—— 
}
˜˜ 
}
™™ 	
public
 
void
 

uploadFile
 
(
 
string
 
filePath
 
,
 
ref
ŸŸ 
string
ŸŸ 
remoteFileName
ŸŸ %
)
   
{
¡¡ 	
FileInfo
¢¢ 
fi
¢¢ 
=
¢¢ 
null
¢¢ 
;
¢¢ 
string
££ 
dateDirectory
££  
=
££! "
string
££# )
.
££) *
Empty
££* /
;
££/ 0

SftpClient
¥¥ 
sftp
¥¥ 
=
¥¥ 
null
¥¥ "
;
¥¥" #
try
§§ 
{
¨¨ 
sftp
©© 
=
©© 
new
©© 

SftpClient
©© %
(
©©% &
m_host
©©& ,
,
©©, -
m_port
©©. 4
,
©©4 5

m_userName
©©6 @
,
©©@ A

m_password
©©B L
)
©©L M
;
©©M N
sftp
«« 
.
«« 
Connect
«« 
(
«« 
)
«« 
;
«« 
if
°° 
(
°° 
!
°° 
File
°° 
.
°° 
Exists
°°  
(
°°  !
filePath
°°! )
)
°°) *
)
°°* +
{
±± 
FDebug
²² 
.
²² 
throwFException
²² *
(
²²* +
$str
²²+ C
+
²²D E
filePath
²²F N
+
²²O P
$str
²²Q T
)
²²T U
;
²²U V
}
³³ 
fi
·· 
=
·· 
new
·· 
FileInfo
·· !
(
··! "
filePath
··" *
)
··* +
;
··+ ,
dateDirectory
¸¸ 
=
¸¸ 
fi
¸¸  "
.
¸¸" #
LastWriteTime
¸¸# 0
.
¸¸0 1
ToString
¸¸1 9
(
¸¸9 :
$str
¸¸: D
)
¸¸D E
;
¸¸E F
createDirectory
»» 
(
»»  
dateDirectory
»»  -
)
»»- .
;
»». /
remoteFileName
ÀÀ 
=
ÀÀ  
sftp
ÀÀ! %
.
ÀÀ% &
WorkingDirectory
ÀÀ& 6
+
ÀÀ7 8
m_directory
ÀÀ9 D
+
ÀÀE F
dateDirectory
ÀÀG T
+
ÀÀU V
$str
ÀÀW Z
+
ÀÀ[ \
Path
ÀÀ] a
.
ÀÀa b
GetFileName
ÀÀb m
(
ÀÀm n
filePath
ÀÀn v
)
ÀÀv w
;
ÀÀw x

FileStream
ÂÂ 
a
ÂÂ 
=
ÂÂ 
new
ÂÂ "

FileStream
ÂÂ# -
(
ÂÂ- .
filePath
ÂÂ. 6
,
ÂÂ6 7
FileMode
ÂÂ8 @
.
ÂÂ@ A
Open
ÂÂA E
)
ÂÂE F
;
ÂÂF G
sftp
ÅÅ 
.
ÅÅ 

UploadFile
ÅÅ 
(
ÅÅ  
a
ÅÅ  !
,
ÅÅ! "
remoteFileName
ÅÅ# 1
,
ÅÅ1 2
true
ÅÅ3 7
,
ÅÅ7 8
null
ÅÅ9 =
)
ÅÅ= >
;
ÅÅ> ?
}
ÆÆ 
catch
ÇÇ 
(
ÇÇ 
	Exception
ÇÇ 
ex
ÇÇ 
)
ÇÇ  
{
ÈÈ 
FDebug
ÉÉ 
.
ÉÉ 
throwException
ÉÉ %
(
ÉÉ% &
ex
ÉÉ& (
)
ÉÉ( )
;
ÉÉ) *
}
ÊÊ 
finally
ËË 
{
ÌÌ 
fi
ÍÍ 
=
ÍÍ 
null
ÍÍ 
;
ÍÍ 
if
ÏÏ 
(
ÏÏ 
sftp
ÏÏ 
!=
ÏÏ 
null
ÏÏ  
)
ÏÏ  !
{
ĞĞ 
sftp
ÑÑ 
.
ÑÑ 

Disconnect
ÑÑ #
(
ÑÑ# $
)
ÑÑ$ %
;
ÑÑ% &
sftp
ÒÒ 
.
ÒÒ 
Dispose
ÒÒ  
(
ÒÒ  !
)
ÒÒ! "
;
ÒÒ" #
sftp
ÓÓ 
=
ÓÓ 
null
ÓÓ 
;
ÓÓ  
}
ÔÔ 
}
ÕÕ 
}
ÖÖ 	
public
ÚÚ 
void
ÚÚ 
DownloadFile
ÚÚ  
(
ÚÚ  !
string
ÛÛ 
path
ÛÛ 
,
ÛÛ 
params
ÜÜ 
string
ÜÜ 
[
ÜÜ 
]
ÜÜ 
files
ÜÜ !
)
İİ 
{
ŞŞ 	

SftpClient
ßß 
sftp
ßß 
=
ßß 
null
ßß "
;
ßß" #
string
àà 
RootFileName
àà 
=
àà  !
string
àà" (
.
àà( )
Empty
àà) .
;
àà. /
try
ââ 
{
ãã 
sftp
ää 
=
ää 
new
ää 

SftpClient
ää %
(
ää% &
m_host
ää& ,
,
ää, -
m_port
ää. 4
,
ää4 5

m_userName
ää6 @
,
ää@ A

m_password
ääB L
)
ääL M
;
ääM N
sftp
ææ 
.
ææ 
Connect
ææ 
(
ææ 
)
ææ 
;
ææ 
foreach
êê 
(
êê 
string
êê 
fileName
êê  (
in
êê) +
files
êê, 1
)
êê1 2
{
ëë 
RootFileName
íí  
=
íí! "
Path
íí# '
.
íí' (
GetFileName
íí( 3
(
íí3 4
fileName
íí4 <
)
íí< =
;
íí= >
using
ïï 
(
ïï 
Stream
ïï !
file1
ïï" '
=
ïï( )
File
ïï* .
.
ïï. /
	OpenWrite
ïï/ 8
(
ïï8 9
path
ïï9 =
+
ïï> ?
$str
ïï@ D
+
ïïE F
RootFileName
ïïG S
)
ïïS T
)
ïïT U
{
ğğ 
sftp
ññ 
.
ññ 
DownloadFile
ññ )
(
ññ) *
fileName
ññ* 2
,
ññ2 3
file1
ññ4 9
)
ññ9 :
;
ññ: ;
}
òò 
Thread
óó 
.
óó 
Sleep
óó  
(
óó  !
$num
óó! $
)
óó$ %
;
óó% &
}
ôô 
}
õõ 
catch
öö 
(
öö 
	Exception
öö 
ex
öö 
)
öö  
{
÷÷ 
FDebug
øø 
.
øø 
throwException
øø %
(
øø% &
ex
øø& (
)
øø( )
;
øø) *
}
ùù 
finally
úú 
{
ûû 
if
üü 
(
üü 
sftp
üü 
!=
üü 
null
üü  
)
üü  !
{
ıı 
sftp
şş 
.
şş 

Disconnect
şş #
(
şş# $
)
şş$ %
;
şş% &
sftp
ÿÿ 
.
ÿÿ 
Dispose
ÿÿ  
(
ÿÿ  !
)
ÿÿ! "
;
ÿÿ" #
sftp
€€ 
=
€€ 
null
€€ 
;
€€  
}
 
}
‚‚ 
}
ƒƒ 	
public
†† 
void
†† 
DeleteFiles
†† 
(
††  
params
‡‡ 
string
‡‡ 
[
‡‡ 
]
‡‡ 
files
‡‡ !
)
ˆˆ 
{
‰‰ 	

SftpClient
ŠŠ 
sftp
ŠŠ 
=
ŠŠ 
null
ŠŠ "
;
ŠŠ" #
try
ŒŒ 
{
 
sftp
 
=
 
new
 

SftpClient
 %
(
% &
m_host
& ,
,
, -
m_port
. 4
,
4 5

m_userName
6 @
,
@ A

m_password
B L
)
L M
;
M N
sftp
 
.
 
Connect
 
(
 
)
 
;
 
foreach
”” 
(
”” 
string
”” 
file
””  $
in
””% '
files
””( -
)
””- .
{
•• 
sftp
–– 
.
–– 

DeleteFile
–– #
(
––# $
file
––$ (
)
––( )
;
––) *
Thread
—— 
.
—— 
Sleep
——  
(
——  !
$num
——! $
)
——$ %
;
——% &
}
˜˜ 
}
™™ 
catch
šš 
(
šš 
	Exception
šš 
ex
šš 
)
šš  
{
›› 
FDebug
œœ 
.
œœ 
throwException
œœ %
(
œœ% &
ex
œœ& (
)
œœ( )
;
œœ) *
}
 
finally
 
{
ŸŸ 
if
   
(
   
sftp
   
!=
   
null
    
)
    !
{
¡¡ 
sftp
¢¢ 
.
¢¢ 

Disconnect
¢¢ #
(
¢¢# $
)
¢¢$ %
;
¢¢% &
sftp
££ 
.
££ 
Dispose
££  
(
££  !
)
££! "
;
££" #
sftp
¤¤ 
=
¤¤ 
null
¤¤ 
;
¤¤  
}
¥¥ 
}
¦¦ 
}
§§ 	
public
«« 
List
«« 
<
«« 
string
«« 
>
«« 
getFileList
«« '
(
««' (
string
¬¬ 
directorypath
¬¬  
)
­­ 
{
®® 	

SftpClient
¯¯ 
sftp
¯¯ 
=
¯¯ 
null
¯¯ "
;
¯¯" #
List
°° 
<
°° 
SftpFile
°° 
>
°° 
sftpFileList
°° '
=
°°( )
null
°°* .
;
°°. /
List
±± 
<
±± 
string
±± 
>
±± 
fileNameList
±± %
=
±±& '
null
±±( ,
;
±±, -
try
³³ 
{
´´ 
sftp
¶¶ 
=
¶¶ 
new
¶¶ 

SftpClient
¶¶ %
(
¶¶% &
m_host
¶¶& ,
,
¶¶, -
m_port
¶¶. 4
,
¶¶4 5

m_userName
¶¶6 @
,
¶¶@ A

m_password
¶¶B L
)
¶¶L M
;
¶¶M N
sftp
¸¸ 
.
¸¸ 
Connect
¸¸ 
(
¸¸ 
)
¸¸ 
;
¸¸ 
sftpFileList
¼¼ 
=
¼¼ 
sftp
¼¼ #
.
¼¼# $
ListDirectory
¼¼$ 1
(
¼¼1 2
directorypath
¼¼2 ?
)
¼¼? @
.
¼¼@ A
ToList
¼¼A G
(
¼¼G H
)
¼¼H I
;
¼¼I J
if
½½ 
(
½½ 
sftpFileList
½½  
!=
½½! #
null
½½$ (
&&
½½) +
sftpFileList
½½, 8
.
½½8 9
Count
½½9 >
>
½½? @
$num
½½A B
)
½½B C
{
¾¾ 
foreach
¿¿ 
(
¿¿ 
SftpFile
¿¿ %
	fsftpfile
¿¿& /
in
¿¿0 2
sftpFileList
¿¿3 ?
)
¿¿? @
{
ÀÀ 
fileNameList
ÁÁ $
.
ÁÁ$ %
Add
ÁÁ% (
(
ÁÁ( )
	fsftpfile
ÁÁ) 2
.
ÁÁ2 3
FullName
ÁÁ3 ;
)
ÁÁ; <
;
ÁÁ< =
}
ÂÂ 
fileNameList
ÃÃ  
.
ÃÃ  !
RemoveAt
ÃÃ! )
(
ÃÃ) *
$num
ÃÃ* +
)
ÃÃ+ ,
;
ÃÃ, -
fileNameList
ÄÄ  
.
ÄÄ  !
RemoveAt
ÄÄ! )
(
ÄÄ) *
$num
ÄÄ* +
)
ÄÄ+ ,
;
ÄÄ, -
}
ÅÅ 
return
ÆÆ 
fileNameList
ÆÆ #
;
ÆÆ# $
}
ÇÇ 
catch
ÈÈ 
(
ÈÈ 
	Exception
ÈÈ 
ex
ÈÈ 
)
ÈÈ  
{
ÉÉ 
FDebug
ÊÊ 
.
ÊÊ 
throwException
ÊÊ %
(
ÊÊ% &
ex
ÊÊ& (
)
ÊÊ( )
;
ÊÊ) *
}
ËË 
finally
ÌÌ 
{
ÍÍ 
if
ÎÎ 
(
ÎÎ 
sftp
ÎÎ 
!=
ÎÎ 
null
ÎÎ  
)
ÎÎ  !
{
ÏÏ 
sftp
ĞĞ 
.
ĞĞ 

Disconnect
ĞĞ #
(
ĞĞ# $
)
ĞĞ$ %
;
ĞĞ% &
sftp
ÑÑ 
.
ÑÑ 
Dispose
ÑÑ  
(
ÑÑ  !
)
ÑÑ! "
;
ÑÑ" #
sftp
ÒÒ 
=
ÒÒ 
null
ÒÒ 
;
ÒÒ  
}
ÓÓ 
}
ÔÔ 
return
ÕÕ 
null
ÕÕ 
;
ÕÕ 
}
ÖÖ 	
public
ÚÚ 
void
ÚÚ 
ConnectionCheck
ÚÚ #
(
ÚÚ# $
)
ÛÛ 
{
ÜÜ 	

SftpClient
İİ 
sftp
İİ 
=
İİ 
null
İİ "
;
İİ" #
try
ßß 
{
àà 
sftp
áá 
=
áá 
new
áá 

SftpClient
áá %
(
áá% &
m_host
áá& ,
,
áá, -
m_port
áá. 4
,
áá4 5

m_userName
áá6 @
,
áá@ A

m_password
ááB L
)
ááL M
;
ááM N
sftp
ãã 
.
ãã 
Connect
ãã 
(
ãã 
)
ãã 
;
ãã 
m_uploadPathExist
ää !
=
ää" #
true
ää$ (
;
ää( )
}
åå 
catch
ææ 
(
ææ 
	Exception
ææ 
ex
ææ 
)
ææ  
{
çç 
FDebug
èè 
.
èè 
throwException
èè %
(
èè% &
ex
èè& (
)
èè( )
;
èè) *
m_uploadPathExist
éé !
=
éé" #
false
éé$ )
;
éé) *
}
êê 
finally
ëë 
{
ìì 
if
íí 
(
íí 
sftp
íí 
!=
íí 
null
íí  
)
íí  !
{
îî 
sftp
ïï 
.
ïï 

Disconnect
ïï #
(
ïï# $
)
ïï$ %
;
ïï% &
sftp
ğğ 
.
ğğ 
Dispose
ğğ  
(
ğğ  !
)
ğğ! "
;
ğğ" #
sftp
ññ 
=
ññ 
null
ññ 
;
ññ  
}
òò 
}
óó 
}
ôô 	
}
úú 
}ûû <
dD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\H101\c_FH101RequestReplyData.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
internal 
class !
FH101RequestReplyData (
:) *
IDisposable+ 6
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
bool 
m_completed  
=! "
false# (
;( )
private 
bool 
m_result 
= 
false  %
;% &
private   
string   
	m_message    
=  ! "
string  # )
.  ) *
Empty  * /
;  / 0
private!! 
Message!! 
m_req!! 
=!! 
null!!  $
;!!$ %
private"" 
Message"" 
m_rep"" 
="" 
null""  $
;""$ %
internal(( !
FH101RequestReplyData(( &
(((& '
Message)) 
req)) 
)** 
{++ 	
m_req,, 
=,, 
req,, 
;,, 
}-- 	
~11 	!
FH101RequestReplyData11	 
(11 
)22 
{33 	
	myDispose44 
(44 
false44 
)44 
;44 
}55 	
	protected99 
void99 
	myDispose99  
(99  !
bool:: 
	disposing:: 
);; 
{<< 	
if== 
(== 
!== 

m_disposed== 
)== 
{>> 
if?? 
(?? 
	disposing?? 
)?? 
{@@ 
m_reqAA 
=AA 
nullAA  
;AA  !
m_repBB 
=BB 
nullBB  
;BB  !
}CC 

m_disposedDD 
=DD 
trueDD !
;DD! "
}EE 
}FF 	
publicNN 
voidNN 
DisposeNN 
(NN 
)OO 
{PP 	
	myDisposeQQ 
(QQ 
trueQQ 
)QQ 
;QQ 
GCRR 
.RR 
SuppressFinalizeRR 
(RR  
thisRR  $
)RR$ %
;RR% &
}SS 	
public[[ 
bool[[ 
	completed[[ 
{\\ 	
get]] 
{^^ 
try__ 
{`` 
returnaa 
m_completedaa &
;aa& '
}bb 
catchcc 
(cc 
	Exceptioncc  
excc! #
)cc# $
{dd 
FDebugee 
.ee 
throwExceptionee )
(ee) *
exee* ,
)ee, -
;ee- .
}ff 
finallygg 
{hh 
}jj 
returnkk 
falsekk 
;kk 
}ll 
setnn 
{oo 
trypp 
{qq 
m_completedrr 
=rr  !
valuerr" '
;rr' (
}ss 
catchtt 
(tt 
	Exceptiontt  
extt! #
)tt# $
{uu 
FDebugvv 
.vv 
throwExceptionvv )
(vv) *
exvv* ,
)vv, -
;vv- .
}ww 
finallyxx 
{yy 
}{{ 
}|| 
}}} 	
public
 
bool
 
result
 
{
‚‚ 	
get
ƒƒ 
{
„„ 
try
…… 
{
†† 
return
‡‡ 
m_result
‡‡ #
;
‡‡# $
}
ˆˆ 
catch
‰‰ 
(
‰‰ 
	Exception
‰‰  
ex
‰‰! #
)
‰‰# $
{
ŠŠ 
FDebug
‹‹ 
.
‹‹ 
throwException
‹‹ )
(
‹‹) *
ex
‹‹* ,
)
‹‹, -
;
‹‹- .
}
ŒŒ 
finally
 
{
 
}
 
return
‘‘ 
false
‘‘ 
;
‘‘ 
}
’’ 
set
”” 
{
•• 
try
–– 
{
—— 
m_result
˜˜ 
=
˜˜ 
value
˜˜ $
;
˜˜$ %
}
™™ 
catch
šš 
(
šš 
	Exception
šš  
ex
šš! #
)
šš# $
{
›› 
FDebug
œœ 
.
œœ 
throwException
œœ )
(
œœ) *
ex
œœ* ,
)
œœ, -
;
œœ- .
}
 
finally
 
{
ŸŸ 
}
¡¡ 
}
¢¢ 
}
££ 	
public
§§ 
string
§§ 
message
§§ 
{
¨¨ 	
get
©© 
{
ªª 
try
«« 
{
¬¬ 
return
­­ 
	m_message
­­ $
;
­­$ %
}
®® 
catch
¯¯ 
(
¯¯ 
	Exception
¯¯  
ex
¯¯! #
)
¯¯# $
{
°° 
FDebug
±± 
.
±± 
throwException
±± )
(
±±) *
ex
±±* ,
)
±±, -
;
±±- .
}
²² 
finally
³³ 
{
´´ 
}
¶¶ 
return
·· 
string
·· 
.
·· 
Empty
·· #
;
··# $
}
¸¸ 
set
ºº 
{
»» 
try
¼¼ 
{
½½ 
	m_message
¾¾ 
=
¾¾ 
value
¾¾  %
;
¾¾% &
}
¿¿ 
catch
ÀÀ 
(
ÀÀ 
	Exception
ÀÀ  
ex
ÀÀ! #
)
ÀÀ# $
{
ÁÁ 
FDebug
ÂÂ 
.
ÂÂ 
throwException
ÂÂ )
(
ÂÂ) *
ex
ÂÂ* ,
)
ÂÂ, -
;
ÂÂ- .
}
ÃÃ 
finally
ÄÄ 
{
ÅÅ 
}
ÇÇ 
}
ÈÈ 
}
ÉÉ 	
public
ÍÍ 
Message
ÍÍ 
req
ÍÍ 
{
ÎÎ 	
get
ÏÏ 
{
ĞĞ 
try
ÑÑ 
{
ÒÒ 
return
ÓÓ 
m_req
ÓÓ  
;
ÓÓ  !
}
ÔÔ 
catch
ÕÕ 
(
ÕÕ 
	Exception
ÕÕ  
ex
ÕÕ! #
)
ÕÕ# $
{
ÖÖ 
FDebug
×× 
.
×× 
throwException
×× )
(
××) *
ex
××* ,
)
××, -
;
××- .
}
ØØ 
finally
ÙÙ 
{
ÚÚ 
}
ÜÜ 
return
İİ 
null
İİ 
;
İİ 
}
ŞŞ 
}
ßß 	
public
ãã 
Message
ãã 
rep
ãã 
{
ää 	
get
åå 
{
ææ 
try
çç 
{
èè 
return
éé 
m_rep
éé  
;
éé  !
}
êê 
catch
ëë 
(
ëë 
	Exception
ëë  
ex
ëë! #
)
ëë# $
{
ìì 
FDebug
íí 
.
íí 
throwException
íí )
(
íí) *
ex
íí* ,
)
íí, -
;
íí- .
}
îî 
finally
ïï 
{
ğğ 
}
òò 
return
óó 
null
óó 
;
óó 
}
ôô 
set
öö 
{
÷÷ 
try
øø 
{
ùù 
m_rep
úú 
=
úú 
value
úú !
;
úú! "
}
ûû 
catch
üü 
(
üü 
	Exception
üü  
ex
üü! #
)
üü# $
{
ıı 
FDebug
şş 
.
şş 
throwException
şş )
(
şş) *
ex
şş* ,
)
şş, -
;
şş- .
}
ÿÿ 
finally
€€ 
{
 
}
ƒƒ 
}
„„ 
}
…… 	
}
‘‘ 
}’’ Á
hD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\H101\c_FH101SessionEventListener.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
internal 
class %
FH101SessionEventListener ,
:- . 
SessionEventListener/ C
,C D
IDisposableE P
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private!! 
FH101!! 
m_fH101!! 
=!! 
null!!  $
;!!$ %
public'' %
FH101SessionEventListener'' (
(''( )
FH101(( 
fH101(( 
))) 
{** 	
m_fH101++ 
=++ 
fH101++ 
;++ 
},, 	
~00 	%
FH101SessionEventListener00	 "
(00" #
)11 
{22 	
	myDispose33 
(33 
false33 
)33 
;33 
}44 	
	protected88 
void88 
	myDispose88  
(88  !
bool99 
	disposing99 
):: 
{;; 	
if<< 
(<< 
!<< 

m_disposed<< 
)<< 
{== 
if>> 
(>> 
	disposing>> 
)>> 
{?? 
m_fH101@@ 
=@@ 
null@@ "
;@@" #
}AA 

m_disposedCC 
=CC 
trueCC !
;CC! "
}DD 
}EE 	
publicMM 
voidMM 
DisposeMM 
(MM 
)NN 
{OO 	
	myDisposePP 
(PP 
truePP 
)PP 
;PP 
GCQQ 
.QQ 
SuppressFinalizeQQ 
(QQ  
thisQQ  $
)QQ$ %
;QQ% &
}RR 	
publicff 
voidff 
	onConnectff 
(ff 
Sessiongg 
ssgg 
)hh 
{ii 	
tryjj 
{kk 
ifll 
(ll 
m_fH101ll 
!=ll 
nullll #
)ll# $
{mm 
m_fH101nn 
.nn 
onH101Connectednn +
(nn+ ,
)nn, -
;nn- .
}oo 
}pp 
catchqq 
(qq 
	Exceptionqq 
exqq 
)qq  
{rr 
FDebugss 
.ss 
writeLogss 
(ss  
exss  "
)ss" #
;ss# $
}tt 
finallyuu 
{vv 
}xx 
}yy 	
public}} 
void}} 
onDisconnect}}  
(}}  !
Session~~ 
ss~~ 
) 
{
€€ 	
try
 
{
‚‚ 
if
ƒƒ 
(
ƒƒ 
m_fH101
ƒƒ 
!=
ƒƒ 
null
ƒƒ #
)
ƒƒ# $
{
„„ 
m_fH101
…… 
.
……  
onH101Disconnected
…… .
(
……. /
)
……/ 0
;
……0 1
}
†† 
}
‡‡ 
catch
ˆˆ 
(
ˆˆ 
	Exception
ˆˆ 
ex
ˆˆ 
)
ˆˆ  
{
‰‰ 
FDebug
ŠŠ 
.
ŠŠ 
writeLog
ŠŠ 
(
ŠŠ  
ex
ŠŠ  "
)
ŠŠ" #
;
ŠŠ# $
}
‹‹ 
finally
ŒŒ 
{
 
}
 
}
 	
}
–– 
}—— …"
ZD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\IniFile\c_FIniFile.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

static 
class 
FIniFile  
{ 
static 
FIniFile 
( 
) 
{ 	
} 	
public-- 
static-- 
string-- 
readIniFile-- (
(--( )
string.. 
section.. 
,.. 
string// 
key// 
,// 
string00 
iniFileName00 
)11 
{22 	
int33 
ret33 
=33 
$num33 
;33 
StringBuilder44 
value44 
=44  !
null44" &
;44& '
try66 
{77 
value88 
=88 
new88 
StringBuilder88 )
(88) *
$num88* /
)88/ 0
;880 1
ret99 
=99 
FNativeAPIs99 !
.99! "#
GetPrivateProfileString99" 9
(999 :
section99: A
,99A B
key99C F
,99F G
string99H N
.99N O
Empty99O T
,99T U
value99V [
,99[ \
$num99] b
,99b c
iniFileName99d o
)99o p
;99p q
return:: 
value:: 
.:: 
ToString:: %
(::% &
)::& '
;::' (
};; 
catch<< 
(<< 
	Exception<< 
ex<< 
)<<  
{== 
FDebug>> 
.>> 
throwException>> %
(>>% &
ex>>& (
)>>( )
;>>) *
}?? 
finally@@ 
{AA 
}CC 
returnDD 
stringDD 
.DD 
EmptyDD 
;DD  
}EE 	
publicII 
staticII 
stringII 
readIniFileII (
(II( )
stringJJ 
sectionJJ 
,JJ 
stringKK 
keyKK 
,KK 
stringLL 
iniFileNameLL 
,LL 
stringMM 
defaultValueMM 
)NN 
{OO 	
stringPP 
valuePP 
=PP 
stringPP !
.PP! "
EmptyPP" '
;PP' (
tryRR 
{SS 
valueTT 
=TT 
readIniFileTT #
(TT# $
sectionTT$ +
,TT+ ,
keyTT- 0
,TT0 1
iniFileNameTT2 =
)TT= >
;TT> ?
ifUU 
(UU 
valueUU 
==UU 
stringUU #
.UU# $
EmptyUU$ )
)UU) *
{VV 
returnWW 
defaultValueWW '
;WW' (
}XX 
returnYY 
valueYY 
;YY 
}ZZ 
catch[[ 
([[ 
	Exception[[ 
ex[[ 
)[[  
{\\ 
FDebug]] 
.]] 
throwException]] %
(]]% &
ex]]& (
)]]( )
;]]) *
}^^ 
finally__ 
{`` 
}bb 
returncc 
stringcc 
.cc 
Emptycc 
;cc  
}dd 	
publichh 
statichh 
voidhh 
writeIniFilehh '
(hh' (
stringii 
sectionii 
,ii 
stringjj 
keyjj 
,jj 
stringkk 
valuekk 
,kk 
stringll 
iniFileNamell 
)mm 
{nn 	
tryoo 
{pp 
FNativeAPIsqq 
.qq %
WritePrivateProfileStringqq 5
(qq5 6
sectionqq6 =
,qq= >
keyqq? B
,qqB C
valueqqD I
,qqI J
iniFileNameqqK V
)qqV W
;qqW X
}rr 
catchss 
(ss 
	Exceptionss 
exss 
)ss  
{tt 
FDebuguu 
.uu 
throwExceptionuu %
(uu% &
exuu& (
)uu( )
;uu) *
}vv 
finallyww 
{xx 
}zz 
}{{ 	
}
 
}‚‚ «>
TD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Mail\c_FMail.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

static 
class 
FMail 
{ 
public$$ 
static$$ 
void$$ 
sendMail$$ #
($$# $
string%% 
server%% 
,%% 
string&& 
from&& 
,&& 
string'' 
to'' 
,'' 
string(( 
userId(( 
,(( 
string)) 
userPw)) 
,)) 
string** 
subject** 
,** 
string++ 
body++ 
),, 
{-- 	
try.. 
{// 
sendMail00 
(00 
server11 
,11 
from22 
,22 
to33 
,33 
userId44 
,44 
userPw55 
,55 
subject66 
,66 
body77 
,77 
false88 
)99 
;99 
}:: 
catch;; 
(;; 
	Exception;; 
ex;; 
);;  
{<< 
FDebug== 
.== 
throwException== %
(==% &
ex==& (
)==( )
;==) *
}>> 
finally?? 
{@@ 
}BB 
}CC 	
publicGG 
staticGG 
voidGG 
sendMailGG #
(GG# $
stringHH 
serverHH 
,HH 
stringII 
fromII 
,II 
stringJJ 
toJJ 
,JJ 
stringKK 
userIdKK 
,KK 
stringLL 
userPwLL 
,LL 
stringMM 
subjectMM 
,MM 
stringNN 
bodyNN 
,NN 
boolOO 
isHtmlOO 
)PP 
{QQ 	
tryRR 
{SS 
sendMailTT 
(TT 
serverUU 
,UU 
fromVV 
,VV 
newWW 
stringWW 
[WW 
]WW  
{WW! "
toWW# %
}WW& '
,WW' (
userIdXX 
,XX 
userPwYY 
,YY 
subjectZZ 
,ZZ 
body[[ 
,[[ 
isHtml\\ 
)]] 
;]] 
}^^ 
catch__ 
(__ 
	Exception__ 
ex__ 
)__  
{`` 
FDebugaa 
.aa 
throwExceptionaa %
(aa% &
exaa& (
)aa( )
;aa) *
}bb 
finallycc 
{dd 
}ff 
}gg 	
publickk 
statickk 
voidkk 
sendMailkk #
(kk# $
stringll 
serverll 
,ll 
stringmm 
frommm 
,mm 
stringnn 
[nn 
]nn 
toListnn 
,nn 
stringoo 
userIdoo 
,oo 
stringpp 
userPwpp 
,pp 
stringqq 
subjectqq 
,qq 
stringrr 
bodyrr 
,rr 
boolss 
isHtmlss 
)tt 
{uu 	
tryvv 
{ww 
sendMailxx 
(xx 
serveryy 
,yy 
$numzz 
,zz 
from{{ 
,{{ 
toList|| 
,|| 
userId}} 
,}} 
userPw~~ 
,~~ 
subject 
, 
body
€€ 
,
€€ 
isHtml
 
)
‚‚ 
;
‚‚ 
}
ƒƒ 
catch
„„ 
(
„„ 
	Exception
„„ 
ex
„„ 
)
„„  
{
…… 
FDebug
†† 
.
†† 
throwException
†† %
(
††% &
ex
††& (
)
††( )
;
††) *
}
‡‡ 
finally
ˆˆ 
{
‰‰ 
}
‹‹ 
}
ŒŒ 	
public
 
static
 
void
 
sendMail
 #
(
# $
string
‘‘ 
server
‘‘ 
,
‘‘ 
int
’’ 

serverPort
’’ 
,
’’ 
string
““ 
from
““ 
,
““ 
string
”” 
[
”” 
]
”” 
toList
”” 
,
”” 
string
•• 
userId
•• 
,
•• 
string
–– 
userPw
–– 
,
–– 
string
—— 
subject
—— 
,
—— 
string
˜˜ 
body
˜˜ 
,
˜˜ 
bool
™™ 
isHtml
™™ 
)
šš 
{
›› 	
const
œœ 
int
œœ 
Timeout
œœ 
=
œœ 
$num
œœ  %
;
œœ% &
MailMessage
 
message
 
=
  !
null
" &
;
& '

SmtpClient
ŸŸ 
client
ŸŸ 
=
ŸŸ 
null
ŸŸ  $
;
ŸŸ$ %
try
¡¡ 
{
¢¢ 
message
££ 
=
££ 
new
££ 
MailMessage
££ )
(
££) *
)
££* +
;
££+ ,
message
¤¤ 
.
¤¤ 
From
¤¤ 
=
¤¤ 
new
¤¤ "
MailAddress
¤¤# .
(
¤¤. /
from
¤¤/ 3
)
¤¤3 4
;
¤¤4 5
foreach
¥¥ 
(
¥¥ 
string
¥¥ 
to
¥¥  "
in
¥¥# %
toList
¥¥& ,
)
¥¥, -
{
¦¦ 
message
§§ 
.
§§ 
To
§§ 
.
§§ 
Add
§§ "
(
§§" #
to
§§# %
)
§§% &
;
§§& '
}
¨¨ 
message
©© 
.
©© 
Subject
©© 
=
©©  !
subject
©©" )
;
©©) *
message
ªª 
.
ªª 
Body
ªª 
=
ªª 
body
ªª #
;
ªª# $
message
«« 
.
«« 

IsBodyHtml
«« "
=
««# $
isHtml
««% +
;
««+ ,
client
­­ 
=
­­ 
new
­­ 

SmtpClient
­­ '
(
­­' (
server
­­( .
,
­­. /

serverPort
­­0 :
)
­­: ;
;
­­; <
client
¯¯ 
.
¯¯ #
UseDefaultCredentials
¯¯ ,
=
¯¯- .
false
¯¯/ 4
;
¯¯4 5
client
°° 
.
°° 
DeliveryMethod
°° %
=
°°& ' 
SmtpDeliveryMethod
°°( :
.
°°: ;
Network
°°; B
;
°°B C
client
±± 
.
±± 
Timeout
±± 
=
±±  
Timeout
±±! (
;
±±( )
client
²² 
.
²² 
Credentials
²² "
=
²²# $
new
²²% (
NetworkCredential
²²) :
(
²²: ;
userId
²²; A
,
²²A B
userPw
²²C I
)
²²I J
;
²²J K
client
³³ 
.
³³ 
Send
³³ 
(
³³ 
message
³³ #
)
³³# $
;
³³$ %
}
´´ 
catch
µµ 
(
µµ 
	Exception
µµ 
ex
µµ 
)
µµ  
{
¶¶ 
FDebug
·· 
.
·· 
throwException
·· %
(
··% &
ex
··& (
)
··( )
;
··) *
}
¸¸ 
finally
¹¹ 
{
ºº 
if
»» 
(
»» 
message
»» 
!=
»» 
null
»» #
)
»»# $
{
¼¼ 
message
½½ 
.
½½ 
Dispose
½½ #
(
½½# $
)
½½$ %
;
½½% &
}
¾¾ 
client
¿¿ 
=
¿¿ 
null
¿¿ 
;
¿¿ 
}
ÀÀ 
}
ÁÁ 	
}
ÇÇ 
}ÈÈ ¬Ô
[D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Security\c_FWinAuth.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

static 
class 
FWinAuth  
{ 
private 
const 
string 
CAPTION_TEXT )
=* +
$str, O
;O P
private 
const 
int %
LOGON32_LOGON_INTERACTIVE 3
=4 5
$num6 7
;7 8
private   
const   
int   !
LOGON32_LOGON_NETWORK   /
=  0 1
$num  2 3
;  3 4
private"" 
const"" 
int"" $
LOGON32_PROVIDER_DEFAULT"" 2
=""3 4
$num""5 6
;""6 7
private## 
const## 
int## $
LOGON32_PROVIDER_WINNT50## 2
=##3 4
$num##5 6
;##6 7
private$$ 
const$$ 
int$$ $
LOGON32_PROVIDER_WINNT40$$ 2
=$$3 4
$num$$5 6
;$$6 7
private%% 
const%% 
int%% $
LOGON32_PROVIDER_WINNT35%% 2
=%%3 4
$num%%5 6
;%%6 7
private'' 
const'' 
int'' 
MAX_USER_NAME'' '
=''( )
$num''* -
;''- .
private(( 
const(( 
int(( 
MAX_PASSWORD(( &
=((' (
$num(() ,
;((, -
private)) 
const)) 
int)) 

MAX_DOMAIN)) $
=))% &
$num))' *
;))* +
private// 
static// 
string// 
osName// $
{00 	
get11 
{22 $
ManagementObjectSearcher33 (
mos33) ,
=33- .
null33/ 3
;333 4
try55 
{66 
mos77 
=77 
new77 $
ManagementObjectSearcher77 6
(776 7
$str777 b
)77b c
;77c d
foreach88 
(88 
ManagementObject88 -
mo88. 0
in881 3
mos884 7
.887 8
Get888 ;
(88; <
)88< =
)88= >
{99 
return:: 
mo:: !
[::! "
$str::" +
]::+ ,
.::, -
ToString::- 5
(::5 6
)::6 7
;::7 8
};; 
}<< 
catch== 
(== 
	Exception==  
ex==! #
)==# $
{>> 
FDebug?? 
.?? 
throwException?? )
(??) *
ex??* ,
)??, -
;??- .
}@@ 
finallyAA 
{BB 
}DD 
returnEE 
stringEE 
.EE 
EmptyEE #
;EE# $
}FF 
}GG 	
privateKK 
staticKK 
FOsGroupKK 
osGroupKK  '
{LL 	
getMM 
{NN 
intOO 
indexOO 
=OO 
$numOO 
;OO 
stringPP 
currOSPP 
=PP 
osNamePP  &
;PP& '
stringQQ 
[QQ 
]QQ 
xpAndBelowGroupQQ (
=QQ) *
{QQ+ ,
$strQQ- 3
,QQ3 4
$strQQ5 9
,QQ9 :
$strQQ; A
}QQB C
;QQC D
stringRR 
[RR 
]RR 
vistaAndAboveGroupRR +
=RR, -
{RR. /
$strRR0 7
,RR7 8
$strRR9 <
,RR< =
$strRR> D
,RRD E
$strRRF I
,RRI J
$strRRK Q
}RRR S
;RRS T
tryTT 
{UU 
foreachVV 
(VV 
stringVV #
keyVV$ '
inVV( *
xpAndBelowGroupVV+ :
)VV: ;
{WW 
indexXX 
=XX 
currOSXX  &
.XX& '
IndexOfXX' .
(XX. /
keyXX/ 2
)XX2 3
;XX3 4
ifYY 
(YY 
indexYY !
>=YY" $
$numYY% &
)YY& '
{ZZ 
return[[ "
FOsGroup[[# +
.[[+ ,

XpAndBelow[[, 6
;[[6 7
}\\ 
}]] 
foreach__ 
(__ 
string__ #
key__$ '
in__( *
vistaAndAboveGroup__+ =
)__= >
{`` 
indexaa 
=aa 
currOSaa  &
.aa& '
IndexOfaa' .
(aa. /
keyaa/ 2
)aa2 3
;aa3 4
ifbb 
(bb 
indexbb !
>=bb" $
$numbb% &
)bb& '
{cc 
returndd "
FOsGroupdd# +
.dd+ ,
VistaAndAbovedd, 9
;dd9 :
}ee 
}ff 
}gg 
catchhh 
(hh 
	Exceptionhh  
exhh! #
)hh# $
{ii 
FDebugjj 
.jj 
throwExceptionjj )
(jj) *
exjj* ,
)jj, -
;jj- .
}kk 
finallyll 
{mm 
}oo 
returnpp 
FOsGrouppp 
.pp  
UnKnownpp  '
;pp' (
}qq 
}rr 	
publiczz 
staticzz 
boolzz 
getLocalCredentialszz .
(zz. /
string{{ 
messageText{{ 
)|| 
{}} 	
try~~ 
{ 
if
€€ 
(
€€ 
osGroup
€€ 
==
€€ 
FOsGroup
€€ '
.
€€' (

XpAndBelow
€€( 2
)
€€2 3
{
 
return
‚‚ .
 getLocalCredentialsForXpAndBelow
‚‚ ;
(
‚‚; <
messageText
‚‚< G
)
‚‚G H
;
‚‚H I
}
ƒƒ 
else
„„ 
if
„„ 
(
„„ 
osGroup
„„  
==
„„! #
FOsGroup
„„$ ,
.
„„, -
VistaAndAbove
„„- :
)
„„: ;
{
…… 
return
†† 1
#getLocalCredentialsForVistaAndAbove
†† >
(
††> ?
messageText
††? J
)
††J K
;
††K L
}
‡‡ 
else
ˆˆ 
{
‰‰ 
FDebug
ŠŠ 
.
ŠŠ 
throwFException
ŠŠ *
(
ŠŠ* +
string
ŠŠ+ 1
.
ŠŠ1 2
Format
ŠŠ2 8
(
ŠŠ8 9

FConstants
ŠŠ9 C
.
ŠŠC D

err_m_0021
ŠŠD N
,
ŠŠN O
osName
ŠŠP V
)
ŠŠV W
)
ŠŠW X
;
ŠŠX Y
}
‹‹ 
}
ŒŒ 
catch
 
(
 
	Exception
 
ex
 
)
  
{
 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
‘‘ 
{
’’ 
}
”” 
return
•• 
false
•• 
;
•• 
}
–– 	
public
šš 
static
šš 
bool
šš "
getDomainCredentials
šš /
(
šš/ 0
string
›› 

domainName
›› 
,
›› 
string
œœ 
messageText
œœ 
)
 
{
 	
try
ŸŸ 
{
   
if
¡¡ 
(
¡¡ 
osGroup
¡¡ 
==
¡¡ 
FOsGroup
¡¡ '
.
¡¡' (

XpAndBelow
¡¡( 2
)
¡¡2 3
{
¢¢ 
return
££ /
!getDomainCredentialsForXpAndBelow
££ <
(
££< =

domainName
££= G
,
££G H
messageText
££I T
)
££T U
;
££U V
}
¤¤ 
else
¥¥ 
if
¥¥ 
(
¥¥ 
osGroup
¥¥  
==
¥¥! #
FOsGroup
¥¥$ ,
.
¥¥, -
VistaAndAbove
¥¥- :
)
¥¥: ;
{
¦¦ 
return
§§ 2
$getDomainCredentialsForVistaAndAbove
§§ ?
(
§§? @

domainName
§§@ J
,
§§J K
messageText
§§L W
)
§§W X
;
§§X Y
}
¨¨ 
else
©© 
{
ªª 
FDebug
«« 
.
«« 
throwFException
«« *
(
««* +
string
««+ 1
.
««1 2
Format
««2 8
(
««8 9

FConstants
««9 C
.
««C D

err_m_0021
««D N
,
««N O
osName
««P V
)
««V W
)
««W X
;
««X Y
}
¬¬ 
}
­­ 
catch
®® 
(
®® 
	Exception
®® 
ex
®® 
)
®®  
{
¯¯ 
FDebug
°° 
.
°° 
throwException
°° %
(
°°% &
ex
°°& (
)
°°( )
;
°°) *
}
±± 
finally
²² 
{
³³ 
}
µµ 
return
¶¶ 
false
¶¶ 
;
¶¶ 
}
·· 	
private
»» 
static
»» 
bool
»» .
 getLocalCredentialsForXpAndBelow
»» <
(
»»< =
string
¼¼ 
messageText
¼¼ 
)
½½ 
{
¾¾ 	
try
¿¿ 
{
ÀÀ 
return
ÁÁ /
!getDomainCredentialsForXpAndBelow
ÁÁ 8
(
ÁÁ8 9
string
ÁÁ9 ?
.
ÁÁ? @
Empty
ÁÁ@ E
,
ÁÁE F
messageText
ÁÁG R
)
ÁÁR S
;
ÁÁS T
}
ÂÂ 
catch
ÃÃ 
(
ÃÃ 
	Exception
ÃÃ 
ex
ÃÃ 
)
ÃÃ  
{
ÄÄ 
FDebug
ÅÅ 
.
ÅÅ 
throwException
ÅÅ %
(
ÅÅ% &
ex
ÅÅ& (
)
ÅÅ( )
;
ÅÅ) *
}
ÆÆ 
finally
ÇÇ 
{
ÈÈ 
}
ÊÊ 
return
ËË 
false
ËË 
;
ËË 
}
ÌÌ 	
private
ĞĞ 
static
ĞĞ 
bool
ĞĞ /
!getDomainCredentialsForXpAndBelow
ĞĞ =
(
ĞĞ= >
string
ÑÑ 

domainName
ÑÑ 
,
ÑÑ 
string
ÒÒ 
messageText
ÒÒ 
)
ÓÓ 
{
ÔÔ 	
try
ÕÕ 
{
ÖÖ 
FNativeAPIs
×× 
.
×× 
	AUTH_INFO
×× %
authInfo
××& .
;
××. /
int
ØØ 
	authError
ØØ 
=
ØØ 
$num
ØØ  !
;
ØØ! "
StringBuilder
ÚÚ 
usernameBuf
ÚÚ )
=
ÚÚ* +
null
ÚÚ, 0
;
ÚÚ0 1
StringBuilder
ÛÛ 
passwordBuf
ÛÛ )
=
ÛÛ* +
null
ÛÛ, 0
;
ÛÛ0 1
StringBuilder
ÜÜ 
	domainBuf
ÜÜ '
=
ÜÜ( )
null
ÜÜ* .
;
ÜÜ. /
bool
İİ 
save
İİ 
=
İİ 
false
İİ !
;
İİ! "
try
ßß 
{
àà 
authInfo
áá 
=
áá 
new
áá "
FNativeAPIs
áá# .
.
áá. /
	AUTH_INFO
áá/ 8
(
áá8 9
)
áá9 :
;
áá: ;
authInfo
ââ 
.
ââ 
pszCaptionText
ââ +
=
ââ, -
CAPTION_TEXT
ââ. :
+
ââ; <
(
ââ= >
(
ââ> ?
string
ââ? E
.
ââE F 
IsNullOrWhiteSpace
ââF X
(
ââX Y

domainName
ââY c
)
ââc d
)
ââd e
?
ââf g
Environment
ââh s
.
ââs t
UserDomainNameâât ‚
:ââƒ „

domainNameââ… 
)ââ 
;ââ ‘
authInfo
ãã 
.
ãã 
pszMessageText
ãã +
=
ãã, -
messageText
ãã. 9
;
ãã9 :
authInfo
ää 
.
ää 
cbSize
ää #
=
ää$ %
Marshal
ää& -
.
ää- .
SizeOf
ää. 4
(
ää4 5
authInfo
ää5 =
)
ää= >
;
ää> ?
usernameBuf
èè 
=
èè  !
new
èè" %
StringBuilder
èè& 3
(
èè3 4
MAX_USER_NAME
èè4 A
)
èèA B
;
èèB C
passwordBuf
éé 
=
éé  !
new
éé" %
StringBuilder
éé& 3
(
éé3 4
MAX_PASSWORD
éé4 @
)
éé@ A
;
ééA B
	domainBuf
êê 
=
êê 
new
êê  #
StringBuilder
êê$ 1
(
êê1 2

MAX_DOMAIN
êê2 <
)
êê< =
;
êê= >
FNativeAPIs
ññ 
.
ññ   
FCredUIReturnCodes
ññ  2
result
ññ3 9
=
ññ: ;
FNativeAPIs
òò #
.
òò# $(
CredUIPromptForCredentials
òò$ >
(
òò> ?
ref
óó 
authInfo
óó  (
,
óó( )
$str
ôô "
,
ôô" #
IntPtr
õõ "
.
õõ" #
Zero
õõ# '
,
õõ' (
	authError
öö %
,
öö% &
usernameBuf
÷÷ '
,
÷÷' (
MAX_USER_NAME
øø )
,
øø) *
passwordBuf
ùù '
,
ùù' (
MAX_PASSWORD
úú (
,
úú( )
ref
ûû 
save
ûû  $
,
ûû$ %
FNativeAPIs
üü '
.
üü' (
FCREDUI_FLAGS
üü( 5
.
üü5 6 
INCORRECT_PASSWORD
üü6 H
)
ıı 
;
ıı 
if
ÿÿ 
(
ÿÿ 
result
ÿÿ 
==
ÿÿ !
FNativeAPIs
ÿÿ" -
.
ÿÿ- . 
FCredUIReturnCodes
ÿÿ. @
.
ÿÿ@ A
NO_ERROR
ÿÿA I
)
ÿÿI J
{
€€ 
StringBuilder
‚‚ %
userBuilder
‚‚& 1
=
‚‚2 3
new
‚‚4 7
StringBuilder
‚‚8 E
(
‚‚E F
)
‚‚F G
;
‚‚G H
StringBuilder
ƒƒ %
domainBuilder
ƒƒ& 3
=
ƒƒ4 5
new
ƒƒ6 9
StringBuilder
ƒƒ: G
(
ƒƒG H
)
ƒƒH I
;
ƒƒI J
FNativeAPIs
…… #
.
……# $ 
FCredUIReturnCodes
……$ 6

returnCode
……7 A
=
……B C
FNativeAPIs
†† '
.
††' (!
CredUIParseUserName
††( ;
(
††; <
usernameBuf
‡‡  +
.
‡‡+ ,
ToString
‡‡, 4
(
‡‡4 5
)
‡‡5 6
,
‡‡6 7
userBuilder
ˆˆ  +
,
ˆˆ+ ,
MAX_USER_NAME
‰‰  -
,
‰‰- .
domainBuilder
ŠŠ  -
,
ŠŠ- .

MAX_DOMAIN
‹‹  *
)
ŒŒ  !
;
ŒŒ! "
if
 
(
 

returnCode
 &
==
' )
FNativeAPIs
* 5
.
5 6 
FCredUIReturnCodes
6 H
.
H I
NO_ERROR
I Q
)
Q R
{
 
return
 "!
validateUserAccount
# 6
(
6 7
domainBuilder
7 D
.
D E
ToString
E M
(
M N
)
N O
,
O P
userBuilder
Q \
.
\ ]
ToString
] e
(
e f
)
f g
,
g h
passwordBuf
i t
.
t u
ToString
u }
(
} ~
)
~ 
) €
;€ 
}
‘‘ 
else
’’ 
if
’’ 
(
’’  !

returnCode
’’! +
==
’’, .
FNativeAPIs
’’/ :
.
’’: ; 
FCredUIReturnCodes
’’; M
.
’’M N(
ERROR_INVALID_ACCOUNT_NAME
’’N h
)
’’h i
{
““ 
return
”” "!
validateUserAccount
””# 6
(
””6 7
string
””7 =
.
””= >
Empty
””> C
,
””C D
userBuilder
””E P
.
””P Q
ToString
””Q Y
(
””Y Z
)
””Z [
,
””[ \
passwordBuf
””] h
.
””h i
ToString
””i q
(
””q r
)
””r s
)
””s t
;
””t u
}
•• 
return
–– 
false
–– $
;
––$ %
}
—— 
return
˜˜ 
false
˜˜  
;
˜˜  !
}
™™ 
catch
šš 
(
šš 
	Exception
šš  
ex
šš! #
)
šš# $
{
›› 
FDebug
œœ 
.
œœ 
throwException
œœ )
(
œœ) *
ex
œœ* ,
)
œœ, -
;
œœ- .
}
 
finally
 
{
ŸŸ 
usernameBuf
   
=
    !
null
  " &
;
  & '
passwordBuf
¡¡ 
=
¡¡  !
null
¡¡" &
;
¡¡& '
	domainBuf
¢¢ 
=
¢¢ 
null
¢¢  $
;
¢¢$ %
}
££ 
return
¤¤ 
false
¤¤ 
;
¤¤ 
}
¥¥ 
catch
¦¦ 
(
¦¦ 
	Exception
¦¦ 
ex
¦¦ 
)
¦¦  
{
§§ 
FDebug
¨¨ 
.
¨¨ 
throwException
¨¨ %
(
¨¨% &
ex
¨¨& (
)
¨¨( )
;
¨¨) *
}
©© 
finally
ªª 
{
«« 
}
­­ 
return
®® 
false
®® 
;
®® 
}
¯¯ 	
private
³³ 
static
³³ 
bool
³³ 1
#getLocalCredentialsForVistaAndAbove
³³ ?
(
³³? @
string
´´ 
messageText
´´ 
)
µµ 
{
¶¶ 	
try
·· 
{
¸¸ 
return
¹¹ 2
$getDomainCredentialsForVistaAndAbove
¹¹ ;
(
¹¹; <
string
¹¹< B
.
¹¹B C
Empty
¹¹C H
,
¹¹H I
messageText
¹¹J U
)
¹¹U V
;
¹¹V W
}
ºº 
catch
»» 
(
»» 
	Exception
»» 
ex
»» 
)
»»  
{
¼¼ 
FDebug
½½ 
.
½½ 
throwException
½½ %
(
½½% &
ex
½½& (
)
½½( )
;
½½) *
}
¾¾ 
finally
¿¿ 
{
ÀÀ 
}
ÂÂ 
return
ÃÃ 
false
ÃÃ 
;
ÃÃ 
}
ÄÄ 	
private
ÈÈ 
static
ÈÈ 
bool
ÈÈ 2
$getDomainCredentialsForVistaAndAbove
ÈÈ @
(
ÈÈ@ A
string
ÉÉ 

domainName
ÉÉ 
,
ÉÉ 
string
ÊÊ 
messageText
ÊÊ 
)
ËË 
{
ÌÌ 	
FNativeAPIs
ÍÍ 
.
ÍÍ 
	AUTH_INFO
ÍÍ !
authInfo
ÍÍ" *
;
ÍÍ* +
uint
ÎÎ 
authPackage
ÎÎ 
=
ÎÎ 
$num
ÎÎ  
;
ÎÎ  !
uint
ÏÏ 
outAuthBufferSize
ÏÏ "
;
ÏÏ" #
IntPtr
ĞĞ 
outAuthBuffer
ĞĞ  
;
ĞĞ  !
int
ÒÒ 
maxUserName
ÒÒ 
=
ÒÒ 
$num
ÒÒ 
;
ÒÒ  
int
ÓÓ 
	maxDomain
ÓÓ 
=
ÓÓ 
$num
ÓÓ 
;
ÓÓ 
int
ÔÔ 
maxPassword
ÔÔ 
=
ÔÔ 
$num
ÔÔ 
;
ÔÔ  
StringBuilder
ÖÖ 
usernameBuf
ÖÖ %
=
ÖÖ& '
null
ÖÖ( ,
;
ÖÖ, -
StringBuilder
×× 
passwordBuf
×× %
=
××& '
null
××( ,
;
××, -
StringBuilder
ØØ 
	domainBuf
ØØ #
=
ØØ$ %
null
ØØ& *
;
ØØ* +
bool
ÙÙ 
save
ÙÙ 
=
ÙÙ 
false
ÙÙ 
;
ÙÙ 
try
ÛÛ 
{
ÜÜ 
authInfo
İİ 
=
İİ 
new
İİ 
FNativeAPIs
İİ *
.
İİ* +
	AUTH_INFO
İİ+ 4
(
İİ4 5
)
İİ5 6
;
İİ6 7
authInfo
ŞŞ 
.
ŞŞ 
pszCaptionText
ŞŞ '
=
ŞŞ( )
CAPTION_TEXT
ŞŞ* 6
+
ŞŞ7 8
(
ŞŞ9 :
(
ŞŞ: ;
string
ŞŞ; A
.
ŞŞA B 
IsNullOrWhiteSpace
ŞŞB T
(
ŞŞT U

domainName
ŞŞU _
)
ŞŞ_ `
)
ŞŞ` a
?
ŞŞb c
Environment
ŞŞd o
.
ŞŞo p
UserDomainName
ŞŞp ~
:ŞŞ €

domainNameŞŞ ‹
)ŞŞ‹ Œ
;ŞŞŒ 
authInfo
ßß 
.
ßß 
pszMessageText
ßß '
=
ßß( )
messageText
ßß* 5
;
ßß5 6
authInfo
àà 
.
àà 
cbSize
àà 
=
àà  !
Marshal
àà" )
.
àà) *
SizeOf
àà* 0
(
àà0 1
authInfo
àà1 9
)
àà9 :
;
àà: ;
outAuthBuffer
ââ 
=
ââ 
new
ââ  #
IntPtr
ââ$ *
(
ââ* +
)
ââ+ ,
;
ââ, -
int
éé 
result
éé 
=
éé 
FNativeAPIs
êê 
.
êê  /
!CredUIPromptForWindowsCredentials
êê  A
(
êêA B
ref
ëë 
authInfo
ëë $
,
ëë$ %
$num
ìì 
,
ìì 
ref
íí 
authPackage
íí '
,
íí' (
IntPtr
îî 
.
îî 
Zero
îî #
,
îî# $
$num
ïï 
,
ïï 
out
ğğ 
outAuthBuffer
ğğ )
,
ğğ) *
out
ññ 
outAuthBufferSize
ññ -
,
ññ- .
ref
òò 
save
òò  
,
òò  !
$num
óó 
)
óó' (
;
óó( )
if
ùù 
(
ùù 
result
ùù 
==
ùù 
$num
ùù 
)
ùù  
{
úú 
	maxDomain
ûû 
=
ûû 

MAX_DOMAIN
ûû  *
;
ûû* +
maxUserName
üü 
=
üü  !
MAX_USER_NAME
üü" /
;
üü/ 0
maxPassword
ıı 
=
ıı  !
MAX_PASSWORD
ıı" .
;
ıı. /
usernameBuf
ÿÿ 
=
ÿÿ  !
new
ÿÿ" %
StringBuilder
ÿÿ& 3
(
ÿÿ3 4
MAX_USER_NAME
ÿÿ4 A
)
ÿÿA B
;
ÿÿB C
passwordBuf
€€ 
=
€€  !
new
€€" %
StringBuilder
€€& 3
(
€€3 4
MAX_PASSWORD
€€4 @
)
€€@ A
;
€€A B
	domainBuf
 
=
 
new
  #
StringBuilder
$ 1
(
1 2

MAX_DOMAIN
2 <
)
< =
;
= >
if
ƒƒ 
(
ƒƒ 
FNativeAPIs
ƒƒ #
.
ƒƒ# $,
CredUnPackAuthenticationBuffer
ƒƒ$ B
(
ƒƒB C
$num
„„, -
,
„„- .
outAuthBuffer
……, 9
,
……9 :
outAuthBufferSize
††, =
,
††= >
usernameBuf
‡‡, 7
,
‡‡7 8
ref
ˆˆ, /
maxUserName
ˆˆ0 ;
,
ˆˆ; <
	domainBuf
‰‰, 5
,
‰‰5 6
ref
ŠŠ, /
	maxDomain
ŠŠ0 9
,
ŠŠ9 :
passwordBuf
‹‹, 7
,
‹‹7 8
ref
ŒŒ, /
maxPassword
ŒŒ0 ;
)
ŒŒ; <
)
 
{
 
FNativeAPIs
 #
.
# $
CoTaskMemFree
$ 1
(
1 2
outAuthBuffer
2 ?
)
? @
;
@ A
return
‘‘ !
validateUserAccount
’’ /
(
’’/ 0

domainName
““  *
,
““* +
usernameBuf
””  +
.
””+ ,
ToString
””, 4
(
””4 5
)
””5 6
,
””6 7
passwordBuf
••  +
.
••+ ,
ToString
••, 4
(
••4 5
)
••5 6
)
––  !
;
––! "
}
—— 
}
˜˜ 
return
™™ 
false
™™ 
;
™™ 
}
šš 
catch
›› 
(
›› 
	Exception
›› 
ex
›› 
)
››  
{
œœ 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
ŸŸ 
{
   
usernameBuf
¡¡ 
=
¡¡ 
null
¡¡ "
;
¡¡" #
passwordBuf
¢¢ 
=
¢¢ 
null
¢¢ "
;
¢¢" #
	domainBuf
££ 
=
££ 
null
££  
;
££  !
}
¤¤ 
return
¥¥ 
false
¥¥ 
;
¥¥ 
}
¦¦ 	
public
ªª 
static
ªª 
bool
ªª !
validateUserAccount
ªª .
(
ªª. /
string
«« 

domainName
«« 
,
«« 
string
¬¬ 
userName
¬¬ 
,
¬¬ 
string
­­ 
password
­­ 
)
®® 
{
¯¯ 	
IntPtr
°° 
hToken
°° 
;
°° 
IntPtr
±± 
hDuplicateToken
±± "
;
±±" #
try
³³ 
{
´´ 
hToken
µµ 
=
µµ 
new
µµ 
IntPtr
µµ #
(
µµ# $
$num
µµ$ %
)
µµ% &
;
µµ& '
hToken
¶¶ 
=
¶¶ 
IntPtr
¶¶ 
.
¶¶  
Zero
¶¶  $
;
¶¶$ %
if
½½ 
(
½½ 
FNativeAPIs
¾¾ 
.
¾¾  
	LogonUser
¾¾  )
(
¾¾) *
userName
¿¿  
,
¿¿  !

domainName
ÀÀ "
,
ÀÀ" #
password
ÁÁ  
,
ÁÁ  !#
LOGON32_LOGON_NETWORK
ÂÂ -
,
ÂÂ- .&
LOGON32_PROVIDER_DEFAULT
ÃÃ 0
,
ÃÃ0 1
ref
ÄÄ 
hToken
ÄÄ "
)
ÅÅ 
)
ÆÆ 
{
ÇÇ 
if
ÈÈ 
(
ÈÈ 
FNativeAPIs
ÈÈ #
.
ÈÈ# $
DuplicateToken
ÈÈ$ 2
(
ÈÈ2 3
hToken
ÈÈ3 9
,
ÈÈ9 :
$num
ÈÈ; <
,
ÈÈ< =
out
ÈÈ> A
hDuplicateToken
ÈÈB Q
)
ÈÈQ R
)
ÈÈR S
{
ÉÉ 
WindowsIdentity
ÊÊ '
windowsIdentity
ÊÊ( 7
=
ÊÊ8 9
new
ÊÊ: =
WindowsIdentity
ÊÊ> M
(
ÊÊM N
hDuplicateToken
ÊÊN ]
)
ÊÊ] ^
;
ÊÊ^ _)
WindowsImpersonationContext
ËË 3"
impersonationContext
ËË4 H
=
ËËI J
windowsIdentity
ËËK Z
.
ËËZ [
Impersonate
ËË[ f
(
ËËf g
)
ËËg h
;
ËËh i"
impersonationContext
ÍÍ ,
.
ÍÍ, -
Undo
ÍÍ- 1
(
ÍÍ1 2
)
ÍÍ2 3
;
ÍÍ3 4
}
ÎÎ 
if
ÓÓ 
(
ÓÓ 
hToken
ÓÓ 
!=
ÓÓ !
IntPtr
ÓÓ" (
.
ÓÓ( )
Zero
ÓÓ) -
)
ÓÓ- .
{
ÔÔ 
FNativeAPIs
ÕÕ #
.
ÕÕ# $
CloseHandle
ÕÕ$ /
(
ÕÕ/ 0
hToken
ÕÕ0 6
)
ÕÕ6 7
;
ÕÕ7 8
}
ÖÖ 
if
ØØ 
(
ØØ 
hDuplicateToken
ØØ '
!=
ØØ( *
IntPtr
ØØ+ 1
.
ØØ1 2
Zero
ØØ2 6
)
ØØ6 7
{
ÙÙ 
FNativeAPIs
ÚÚ #
.
ÚÚ# $
CloseHandle
ÚÚ$ /
(
ÚÚ/ 0
hDuplicateToken
ÚÚ0 ?
)
ÚÚ? @
;
ÚÚ@ A
}
ÛÛ 
return
ßß 
true
ßß 
;
ßß  
}
àà 
return
áá 
false
áá 
;
áá 
}
ââ 
catch
ãã 
(
ãã 
	Exception
ãã 
ex
ãã 
)
ãã  
{
ää 
FDebug
åå 
.
åå 
throwException
åå %
(
åå% &
ex
åå& (
)
åå( )
;
åå) *
}
ææ 
finally
çç 
{
èè 
}
êê 
return
ëë 
false
ëë 
;
ëë 
}
ìì 	
}
òò 
}óó ö”
^D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Security\c_FLicLicense.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FLicLicense 
: 
IDisposable *
{ 
private 
const 
string 
	LicenseId &
=' (
$str) 5
;5 6
private 
const 
string 
ProductSerial *
=+ ,
$str- =
;= >
private   
const   
string   
ProductDemo   (
=  ) *
$str  + 9
;  9 :
private!! 
const!! 
string!! 
ProductTitle!! )
=!!* +
$str!!, ;
;!!; <
private"" 
const"" 
string"" 
CustomerCompany"" ,
=""- .
$str""/ A
;""A B
private## 
const## 
string## 
Server## #
=##$ %
$str##& .
;##. /
private$$ 
const$$ 
string$$ 
	ClickOnce$$ &
=$$' (
$str$$) 5
;$$5 6
private%% 
const%% 
string%% 
	UserLimit%% &
=%%' (
$str%%) 5
;%%5 6
private&& 
const&& 
string&& 
ExpireIssuedCheck&& .
=&&/ 0
$str&&1 F
;&&F G
private'' 
const'' 
string'' 
ExpireIssuedDate'' -
=''. /
$str''0 D
;''D E
private(( 
const(( 
string(( 
MacAddressCheck(( ,
=((- .
$str((/ B
;((B C
private)) 
const)) 
string)) 

MacAddress)) '
=))( )
$str))* 7
;))7 8
private** 
const** 
string** 
Key**  
=**! "
$str**# (
;**( )
private,, 
const,, 
char,, 
	Separator,, $
=,,% &
$char,,' *
;,,* +
private00 
bool00 

m_disposed00 
=00  !
false00" '
;00' (
private22 
FLicInfo22 

m_fLicInfo22 #
=22$ %
null22& *
;22* +
public88 
FLicLicense88 
(88 
)99 
{:: 	
}<< 	
~@@ 	
FLicLicense@@	 
(@@ 
)AA 
{BB 	
	myDisposeCC 
(CC 
falseCC 
)CC 
;CC 
}DD 	
	protectedHH 
voidHH 
	myDisposeHH  
(HH  !
boolII 
	disposingII 
)JJ 
{KK 	
ifLL 
(LL 
!LL 

m_disposedLL 
)LL 
{MM 
ifNN 
(NN 
	disposingNN 
)NN 
{OO 
}QQ 

m_disposedRR 
=RR 
trueRR !
;RR! "
}SS 
}TT 	
public\\ 
void\\ 
Dispose\\ 
(\\ 
)]] 
{^^ 	
	myDispose__ 
(__ 
true__ 
)__ 
;__ 
GC`` 
.`` 
SuppressFinalize`` 
(``  
this``  $
)``$ %
;``% &
}aa 	
publicii 
FLicInfoii 
fLicInfoii  
{jj 	
getkk 
{ll 
trymm 
{nn 
returnoo 

m_fLicInfooo %
;oo% &
}pp 
catchqq 
(qq 
	Exceptionqq  
exqq! #
)qq# $
{rr 
FDebugss 
.ss 
throwExceptionss )
(ss) *
exss* ,
)ss, -
;ss- .
}tt 
finallyuu 
{vv 
}xx 
returnyy 
nullyy 
;yy 
}zz 
}{{ 	
public
ƒƒ 
void
ƒƒ 
validate
ƒƒ 
(
ƒƒ 
string
„„ 
fileName
„„ 
)
…… 
{
†† 	
StreamReader
‡‡ 
sr
‡‡ 
=
‡‡ 
null
‡‡ "
;
‡‡" #
string
ˆˆ 
licData
ˆˆ 
=
ˆˆ 
null
ˆˆ !
;
ˆˆ! "
string
‰‰ 
[
‰‰ 
]
‰‰ 
vals
‰‰ 
=
‰‰ 
null
‰‰  
;
‰‰  !
int
ŠŠ 
index
ŠŠ 
=
ŠŠ 
$num
ŠŠ 
;
ŠŠ 
bool
‹‹ 
isValid
‹‹ 
=
‹‹ 
false
‹‹  
;
‹‹  !
try
 
{
 
if
’’ 
(
’’ 
!
’’ 
File
’’ 
.
’’ 
Exists
’’  
(
’’  !
fileName
’’! )
)
’’) *
)
’’* +
{
““ 
FDebug
”” 
.
”” 
throwFException
”” *
(
””* +

FConstants
””+ 5
.
””5 6

err_m_0018
””6 @
)
””@ A
;
””A B
}
•• 

m_fLicInfo
™™ 
=
™™ 
new
™™  
FLicInfo
™™! )
(
™™) *
)
™™* +
;
™™+ ,
sr
 
=
 
new
 
StreamReader
 %
(
% &
fileName
& .
,
. /
Encoding
0 8
.
8 9
Default
9 @
)
@ A
;
A B
licData
 
=
 
sr
 
.
 
	ReadToEnd
 &
(
& '
)
' (
;
( )
index
¢¢ 
=
¢¢ 
licData
¢¢ 
.
¢¢  
IndexOf
¢¢  '
(
¢¢' (
Key
¢¢( +
)
¢¢+ ,
;
¢¢, -
if
££ 
(
££ 
index
££ 
==
££ 
-
££ 
$num
££ 
)
££  
{
¤¤ 
FDebug
¥¥ 
.
¥¥ 
throwFException
¥¥ *
(
¥¥* +

FConstants
¥¥+ 5
.
¥¥5 6

err_m_0022
¥¥6 @
)
¥¥@ A
;
¥¥A B
}
¦¦ 

m_fLicInfo
§§ 
.
§§ 
rawData
§§ "
=
§§# $
licData
§§% ,
.
§§, -
	Substring
§§- 6
(
§§6 7
$num
§§7 8
,
§§8 9
index
§§: ?
)
§§? @
;
§§@ A

m_fLicInfo
¨¨ 
.
¨¨ 
rawData
¨¨ "
=
¨¨# $

m_fLicInfo
¨¨% /
.
¨¨/ 0
rawData
¨¨0 7
.
¨¨7 8
Replace
¨¨8 ?
(
¨¨? @
$str
¨¨@ D
,
¨¨D E
$str
¨¨F H
)
¨¨H I
;
¨¨I J

m_fLicInfo
©© 
.
©© 
rawData
©© "
=
©©# $

m_fLicInfo
©©% /
.
©©/ 0
rawData
©©0 7
.
©©7 8
Replace
©©8 ?
(
©©? @
$str
©©@ D
,
©©D E
$str
©©F H
)
©©H I
;
©©I J
foreach
­­ 
(
­­ 
string
­­ 
s
­­  !
in
­­" $
licData
­­% ,
.
­­, -
Split
­­- 2
(
­­2 3
new
­­3 6
string
­­7 =
[
­­= >
]
­­> ?
{
­­@ A
Environment
­­B M
.
­­M N
NewLine
­­N U
}
­­V W
,
­­W X 
StringSplitOptions
­­Y k
.
­­k l 
RemoveEmptyEntries
­­l ~
)
­­~ 
)­­ €
{
®® 
if
¯¯ 
(
¯¯ 
s
¯¯ 
[
¯¯ 
$num
¯¯ 
]
¯¯ 
==
¯¯ 
$char
¯¯  #
)
¯¯# $
{
°° 
continue
±±  
;
±±  !
}
²² 
vals
¶¶ 
=
¶¶ 
s
¶¶ 
.
¶¶ 
Split
¶¶ "
(
¶¶" #
new
¶¶# &
char
¶¶' +
[
¶¶+ ,
]
¶¶, -
{
¶¶. /
	Separator
¶¶0 9
}
¶¶: ;
)
¶¶; <
;
¶¶< =
if
·· 
(
·· 
vals
·· 
.
·· 
Length
·· #
!=
··$ &
$num
··' (
)
··( )
{
¸¸ 
FDebug
¹¹ 
.
¹¹ 
throwFException
¹¹ .
(
¹¹. /

FConstants
¹¹/ 9
.
¹¹9 :

err_m_0022
¹¹: D
)
¹¹D E
;
¹¹E F
}
ºº 
if
¼¼ 
(
¼¼ 
vals
¼¼ 
[
¼¼ 
$num
¼¼ 
]
¼¼ 
==
¼¼  "
	LicenseId
¼¼# ,
)
¼¼, -
{
½½ 

m_fLicInfo
¾¾ "
.
¾¾" #
	licenseId
¾¾# ,
=
¾¾- .
vals
¾¾/ 3
[
¾¾3 4
$num
¾¾4 5
]
¾¾5 6
;
¾¾6 7
}
¿¿ 
else
ÀÀ 
if
ÀÀ 
(
ÀÀ 
vals
ÀÀ !
[
ÀÀ! "
$num
ÀÀ" #
]
ÀÀ# $
==
ÀÀ% '
ProductSerial
ÀÀ( 5
)
ÀÀ5 6
{
ÁÁ 

m_fLicInfo
ÂÂ "
.
ÂÂ" #
productSerial
ÂÂ# 0
=
ÂÂ1 2
vals
ÂÂ3 7
[
ÂÂ7 8
$num
ÂÂ8 9
]
ÂÂ9 :
;
ÂÂ: ;
}
ÃÃ 
else
ÄÄ 
if
ÄÄ 
(
ÄÄ 
vals
ÄÄ !
[
ÄÄ! "
$num
ÄÄ" #
]
ÄÄ# $
==
ÄÄ% '
ProductDemo
ÄÄ( 3
)
ÄÄ3 4
{
ÅÅ 

m_fLicInfo
ÆÆ "
.
ÆÆ" #
productDemo
ÆÆ# .
=
ÆÆ/ 0
vals
ÆÆ1 5
[
ÆÆ5 6
$num
ÆÆ6 7
]
ÆÆ7 8
;
ÆÆ8 9
}
ÇÇ 
else
ÈÈ 
if
ÈÈ 
(
ÈÈ 
vals
ÈÈ !
[
ÈÈ! "
$num
ÈÈ" #
]
ÈÈ# $
==
ÈÈ% '
ProductTitle
ÈÈ( 4
)
ÈÈ4 5
{
ÉÉ 

m_fLicInfo
ÊÊ "
.
ÊÊ" #
productTitle
ÊÊ# /
=
ÊÊ0 1
vals
ÊÊ2 6
[
ÊÊ6 7
$num
ÊÊ7 8
]
ÊÊ8 9
;
ÊÊ9 :
}
ËË 
else
ÌÌ 
if
ÌÌ 
(
ÌÌ 
vals
ÌÌ !
[
ÌÌ! "
$num
ÌÌ" #
]
ÌÌ# $
==
ÌÌ% '
CustomerCompany
ÌÌ( 7
)
ÌÌ7 8
{
ÍÍ 

m_fLicInfo
ÎÎ "
.
ÎÎ" #
customerCompany
ÎÎ# 2
=
ÎÎ3 4
vals
ÎÎ5 9
[
ÎÎ9 :
$num
ÎÎ: ;
]
ÎÎ; <
;
ÎÎ< =
}
ÏÏ 
else
ĞĞ 
if
ĞĞ 
(
ĞĞ 
vals
ĞĞ !
[
ĞĞ! "
$num
ĞĞ" #
]
ĞĞ# $
==
ĞĞ% '
Server
ĞĞ( .
)
ĞĞ. /
{
ÑÑ 

m_fLicInfo
ÒÒ "
.
ÒÒ" #
server
ÒÒ# )
=
ÒÒ* +
vals
ÒÒ, 0
[
ÒÒ0 1
$num
ÒÒ1 2
]
ÒÒ2 3
;
ÒÒ3 4
}
ÓÓ 
else
ÔÔ 
if
ÔÔ 
(
ÔÔ 
vals
ÔÔ !
[
ÔÔ! "
$num
ÔÔ" #
]
ÔÔ# $
==
ÔÔ% '
	ClickOnce
ÔÔ( 1
)
ÔÔ1 2
{
ÕÕ 

m_fLicInfo
ÖÖ "
.
ÖÖ" #
	clickOnce
ÖÖ# ,
=
ÖÖ- .
vals
ÖÖ/ 3
[
ÖÖ3 4
$num
ÖÖ4 5
]
ÖÖ5 6
;
ÖÖ6 7
}
×× 
else
ØØ 
if
ØØ 
(
ØØ 
vals
ØØ !
[
ØØ! "
$num
ØØ" #
]
ØØ# $
==
ØØ% '
	UserLimit
ØØ( 1
)
ØØ1 2
{
ÙÙ 

m_fLicInfo
ÚÚ "
.
ÚÚ" #
	userLimit
ÚÚ# ,
=
ÚÚ- .
vals
ÚÚ/ 3
[
ÚÚ3 4
$num
ÚÚ4 5
]
ÚÚ5 6
;
ÚÚ6 7
}
ÛÛ 
else
ÜÜ 
if
ÜÜ 
(
ÜÜ 
vals
ÜÜ !
[
ÜÜ! "
$num
ÜÜ" #
]
ÜÜ# $
==
ÜÜ% '
ExpireIssuedCheck
ÜÜ( 9
)
ÜÜ9 :
{
İİ 

m_fLicInfo
ŞŞ "
.
ŞŞ" #
expireIssuedCheck
ŞŞ# 4
=
ŞŞ5 6
vals
ŞŞ7 ;
[
ŞŞ; <
$num
ŞŞ< =
]
ŞŞ= >
;
ŞŞ> ?
}
ßß 
else
àà 
if
àà 
(
àà 
vals
àà !
[
àà! "
$num
àà" #
]
àà# $
==
àà% '
ExpireIssuedDate
àà( 8
)
àà8 9
{
áá 

m_fLicInfo
ââ "
.
ââ" #
expireIssuedDate
ââ# 3
=
ââ4 5
vals
ââ6 :
[
ââ: ;
$num
ââ; <
]
ââ< =
;
ââ= >
}
ãã 
else
ää 
if
ää 
(
ää 
vals
ää !
[
ää! "
$num
ää" #
]
ää# $
==
ää% '
MacAddressCheck
ää( 7
)
ää7 8
{
åå 

m_fLicInfo
ææ "
.
ææ" #
macAddressCheck
ææ# 2
=
ææ3 4
vals
ææ5 9
[
ææ9 :
$num
ææ: ;
]
ææ; <
;
ææ< =
}
çç 
else
èè 
if
èè 
(
èè 
vals
èè !
[
èè! "
$num
èè" #
]
èè# $
==
èè% '

MacAddress
èè( 2
)
èè2 3
{
éé 
if
êê 
(
êê 
!
êê 

m_fLicInfo
êê '
.
êê' (
macAddressList
êê( 6
.
êê6 7
Contains
êê7 ?
(
êê? @
vals
êê@ D
[
êêD E
$num
êêE F
]
êêF G
)
êêG H
)
êêH I
{
ëë 

m_fLicInfo
ìì &
.
ìì& '
macAddressList
ìì' 5
.
ìì5 6
Add
ìì6 9
(
ìì9 :
vals
ìì: >
[
ìì> ?
$num
ìì? @
]
ìì@ A
)
ììA B
;
ììB C
}
íí 
}
îî 
else
ïï 
if
ïï 
(
ïï 
vals
ïï !
[
ïï! "
$num
ïï" #
]
ïï# $
==
ïï% '
Key
ïï( +
)
ïï+ ,
{
ğğ 

m_fLicInfo
ññ "
.
ññ" #
key
ññ# &
=
ññ' (
vals
ññ) -
[
ññ- .
$num
ññ. /
]
ññ/ 0
;
ññ0 1
}
òò 
}
óó 
if
úú 
(
úú 

m_fLicInfo
úú 
.
úú 
key
úú "
!=
úú# %
(
úú& '
new
úú' *
FCrypt
úú+ 1
(
úú1 2
)
úú2 3
)
úú3 4
.
úú4 5
encrypt2
úú5 =
(
úú= >

m_fLicInfo
úú> H
.
úúH I
rawData
úúI P
)
úúP Q
)
úúQ R
{
ûû 
FDebug
üü 
.
üü 
throwFException
üü *
(
üü* +

FConstants
üü+ 5
.
üü5 6

err_m_0022
üü6 @
)
üü@ A
;
üüA B
}
ıı 
if
‚‚ 
(
‚‚ 

m_fLicInfo
ƒƒ 
.
ƒƒ 
server
ƒƒ %
.
ƒƒ% &
Trim
ƒƒ& *
(
ƒƒ* +
)
ƒƒ+ ,
==
ƒƒ- /
string
ƒƒ0 6
.
ƒƒ6 7
Empty
ƒƒ7 <
||
ƒƒ= ?

m_fLicInfo
„„ 
.
„„ 
expireIssuedCheck
„„ 0
.
„„0 1
Trim
„„1 5
(
„„5 6
)
„„6 7
==
„„8 :
string
„„; A
.
„„A B
Empty
„„B G
||
„„H J

m_fLicInfo
…… 
.
…… 
macAddressCheck
…… .
.
……. /
Trim
……/ 3
(
……3 4
)
……4 5
==
……6 8
string
……9 ?
.
……? @
Empty
……@ E
)
†† 
{
‡‡ 
FDebug
ˆˆ 
.
ˆˆ 
throwFException
ˆˆ *
(
ˆˆ* +

FConstants
ˆˆ+ 5
.
ˆˆ5 6

err_m_0022
ˆˆ6 @
)
ˆˆ@ A
;
ˆˆA B
}
‰‰ 
if
 
(
 

m_fLicInfo
 
.
 
expireIssuedCheck
 0
==
1 3
FYesNo
4 :
.
: ;
Yes
; >
.
> ?
ToString
? G
(
G H
)
H I
)
I J
{
‘‘ 
if
’’ 
(
’’ 

m_fLicInfo
’’ "
.
’’" #
expireIssuedDate
’’# 3
.
’’3 4
	CompareTo
’’4 =
(
’’= >
DateTime
’’> F
.
’’F G
Now
’’G J
.
’’J K
ToString
’’K S
(
’’S T
$str
’’T ^
)
’’^ _
)
’’_ `
<
’’a b
$num
’’c d
)
’’d e
{
““ 
FDebug
”” 
.
”” 
throwFException
”” .
(
””. /

FConstants
””/ 9
.
””9 :

err_m_0022
””: D
)
””D E
;
””E F
}
•• 
}
–– 
if
›› 
(
›› 

m_fLicInfo
œœ 
.
œœ 
server
œœ %
==
œœ& (
FYesNo
œœ) /
.
œœ/ 0
No
œœ0 2
.
œœ2 3
ToString
œœ3 ;
(
œœ; <
)
œœ< =
&&
œœ> @

m_fLicInfo
 
.
 
macAddressCheck
 .
==
/ 1
FYesNo
2 8
.
8 9
Yes
9 <
.
< =
ToString
= E
(
E F
)
F G
)
 
{
ŸŸ 
isValid
   
=
   
false
   #
;
  # $
foreach
¡¡ 
(
¡¡ 
string
¡¡ #
s
¡¡$ %
in
¡¡& (
FUserPCInfo
¡¡) 4
.
¡¡4 5
MacAddressList
¡¡5 C
(
¡¡C D
)
¡¡D E
)
¡¡E F
{
¢¢ 
if
££ 
(
££ 

m_fLicInfo
££ &
.
££& '
macAddressList
££' 5
.
££5 6
Contains
££6 >
(
££> ?
s
££? @
)
££@ A
)
££A B
{
¤¤ 
isValid
¥¥ #
=
¥¥$ %
true
¥¥& *
;
¥¥* +
break
¦¦ !
;
¦¦! "
}
§§ 
}
¨¨ 
if
ªª 
(
ªª 
!
ªª 
isValid
ªª  
)
ªª  !
{
«« 
FDebug
¬¬ 
.
¬¬ 
throwFException
¬¬ .
(
¬¬. /

FConstants
¬¬/ 9
.
¬¬9 :

err_m_0022
¬¬: D
)
¬¬D E
;
¬¬E F
}
­­ 
}
®® 
}
¯¯ 
catch
°° 
(
°° 
	Exception
°° 
ex
°° 
)
°°  
{
±± 
FDebug
²² 
.
²² 
throwException
²² %
(
²²% &
ex
²²& (
)
²²( )
;
²²) *
}
³³ 
finally
´´ 
{
µµ 
if
¶¶ 
(
¶¶ 
sr
¶¶ 
!=
¶¶ 
null
¶¶ 
)
¶¶ 
{
·· 
sr
¸¸ 
.
¸¸ 
Close
¸¸ 
(
¸¸ 
)
¸¸ 
;
¸¸ 
sr
¹¹ 
.
¹¹ 
Dispose
¹¹ 
(
¹¹ 
)
¹¹  
;
¹¹  !
sr
ºº 
=
ºº 
null
ºº 
;
ºº 
}
»» 
}
¼¼ 
}
½½ 	
}
ÃÃ 
}ÄÄ ü¡
[D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Security\c_FLicInfo.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FLicInfo 
: 
IDisposable '
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private   
string   
m_licenseId   "
=  # $
string  % +
.  + ,
Empty  , 1
;  1 2
private!! 
string!! 
m_productSerial!! &
=!!' (
string!!) /
.!!/ 0
Empty!!0 5
;!!5 6
private"" 
string"" 
m_productDemo"" $
=""% &
string""' -
.""- .
Empty"". 3
;""3 4
private## 
string## 
m_productTitle## %
=##& '
string##( .
.##. /
Empty##/ 4
;##4 5
private$$ 
string$$ 
m_customerCompany$$ (
=$$) *
string$$+ 1
.$$1 2
Empty$$2 7
;$$7 8
private%% 
string%% 
m_server%% 
=%%  !
string%%" (
.%%( )
Empty%%) .
;%%. /
private&& 
string&& 
m_clickOnce&& "
=&&# $
string&&% +
.&&+ ,
Empty&&, 1
;&&1 2
private'' 
string'' 
m_userLimit'' "
=''# $
string''% +
.''+ ,
Empty'', 1
;''1 2
private)) 
string)) 
m_expireIssuedCheck)) *
=))+ ,
string))- 3
.))3 4
Empty))4 9
;))9 :
private** 
string** 
m_expireIssuedDate** )
=*** +
string**, 2
.**2 3
Empty**3 8
;**8 9
private,, 
string,, 
m_macAddressCheck,, (
=,,) *
string,,+ 1
.,,1 2
Empty,,2 7
;,,7 8
private-- 
HashSet-- 
<-- 
string-- 
>-- 
m_macAddressList--  0
=--1 2
null--3 7
;--7 8
private// 
string// 
m_key// 
=// 
string// %
.//% &
Empty//& +
;//+ ,
private00 
string00 
	m_rawData00  
=00! "
string00# )
.00) *
Empty00* /
;00/ 0
public66 
FLicInfo66 
(66 
)77 
{88 	
m_macAddressList99 
=99 
new99 "
HashSet99# *
<99* +
string99+ 1
>991 2
(992 3
)993 4
;994 5
}:: 	
~>> 	
FLicInfo>>	 
(>> 
)?? 
{@@ 	
	myDisposeAA 
(AA 
falseAA 
)AA 
;AA 
}BB 	
	protectedFF 
voidFF 
	myDisposeFF  
(FF  !
boolGG 
	disposingGG 
)HH 
{II 	
ifJJ 
(JJ 
!JJ 

m_disposedJJ 
)JJ 
{KK 
ifLL 
(LL 
	disposingLL 
)LL 
{MM 
}OO 

m_disposedPP 
=PP 
truePP !
;PP! "
}QQ 
}RR 	
publicZZ 
voidZZ 
DisposeZZ 
(ZZ 
)[[ 
{\\ 	
	myDispose]] 
(]] 
true]] 
)]] 
;]] 
GC^^ 
.^^ 
SuppressFinalize^^ 
(^^  
this^^  $
)^^$ %
;^^% &
}__ 	
publicgg 
stringgg 
	licenseIdgg 
{hh 	
getii 
{jj 
trykk 
{ll 
returnmm 
m_licenseIdmm &
;mm& '
}nn 
catchoo 
(oo 
	Exceptionoo  
exoo! #
)oo# $
{pp 
FDebugqq 
.qq 
throwExceptionqq )
(qq) *
exqq* ,
)qq, -
;qq- .
}rr 
finallyss 
{tt 
}vv 
returnww 
stringww 
.ww 
Emptyww #
;ww# $
}xx 
internalzz 
setzz 
{{{ 
try|| 
{}} 
m_licenseId~~ 
=~~  !
value~~" '
;~~' (
} 
catch
€€ 
(
€€ 
	Exception
€€  
ex
€€! #
)
€€# $
{
 
FDebug
‚‚ 
.
‚‚ 
throwException
‚‚ )
(
‚‚) *
ex
‚‚* ,
)
‚‚, -
;
‚‚- .
}
ƒƒ 
finally
„„ 
{
…… 
}
‡‡ 
}
ˆˆ 
}
‰‰ 	
public
 
string
 
productSerial
 #
{
 	
get
 
{
 
try
‘‘ 
{
’’ 
return
““ 
m_productSerial
““ *
;
““* +
}
”” 
catch
•• 
(
•• 
	Exception
••  
ex
••! #
)
••# $
{
–– 
FDebug
—— 
.
—— 
throwException
—— )
(
——) *
ex
——* ,
)
——, -
;
——- .
}
˜˜ 
finally
™™ 
{
šš 
}
œœ 
return
 
string
 
.
 
Empty
 #
;
# $
}
 
internal
   
set
   
{
¡¡ 
try
¢¢ 
{
££ 
m_productSerial
¤¤ #
=
¤¤$ %
value
¤¤& +
;
¤¤+ ,
}
¥¥ 
catch
¦¦ 
(
¦¦ 
	Exception
¦¦  
ex
¦¦! #
)
¦¦# $
{
§§ 
FDebug
¨¨ 
.
¨¨ 
throwException
¨¨ )
(
¨¨) *
ex
¨¨* ,
)
¨¨, -
;
¨¨- .
}
©© 
finally
ªª 
{
«« 
}
­­ 
}
®® 
}
¯¯ 	
public
³³ 
string
³³ 
productDemo
³³ !
{
´´ 	
get
µµ 
{
¶¶ 
try
·· 
{
¸¸ 
return
¹¹ 
m_productDemo
¹¹ (
;
¹¹( )
}
ºº 
catch
»» 
(
»» 
	Exception
»»  
ex
»»! #
)
»»# $
{
¼¼ 
FDebug
½½ 
.
½½ 
throwException
½½ )
(
½½) *
ex
½½* ,
)
½½, -
;
½½- .
}
¾¾ 
finally
¿¿ 
{
ÀÀ 
}
ÂÂ 
return
ÃÃ 
string
ÃÃ 
.
ÃÃ 
Empty
ÃÃ #
;
ÃÃ# $
}
ÄÄ 
internal
ÆÆ 
set
ÆÆ 
{
ÇÇ 
try
ÈÈ 
{
ÉÉ 
m_productDemo
ÊÊ !
=
ÊÊ" #
value
ÊÊ$ )
;
ÊÊ) *
}
ËË 
catch
ÌÌ 
(
ÌÌ 
	Exception
ÌÌ  
ex
ÌÌ! #
)
ÌÌ# $
{
ÍÍ 
FDebug
ÎÎ 
.
ÎÎ 
throwException
ÎÎ )
(
ÎÎ) *
ex
ÎÎ* ,
)
ÎÎ, -
;
ÎÎ- .
}
ÏÏ 
finally
ĞĞ 
{
ÑÑ 
}
ÓÓ 
}
ÔÔ 
}
ÕÕ 	
public
ÙÙ 
string
ÙÙ 
productTitle
ÙÙ "
{
ÚÚ 	
get
ÛÛ 
{
ÜÜ 
try
İİ 
{
ŞŞ 
return
ßß 
m_productTitle
ßß )
;
ßß) *
}
àà 
catch
áá 
(
áá 
	Exception
áá  
ex
áá! #
)
áá# $
{
ââ 
FDebug
ãã 
.
ãã 
throwException
ãã )
(
ãã) *
ex
ãã* ,
)
ãã, -
;
ãã- .
}
ää 
finally
åå 
{
ææ 
}
èè 
return
éé 
string
éé 
.
éé 
Empty
éé #
;
éé# $
}
êê 
internal
ìì 
set
ìì 
{
íí 
try
îî 
{
ïï 
m_productTitle
ğğ "
=
ğğ# $
value
ğğ% *
;
ğğ* +
}
ññ 
catch
òò 
(
òò 
	Exception
òò  
ex
òò! #
)
òò# $
{
óó 
FDebug
ôô 
.
ôô 
throwException
ôô )
(
ôô) *
ex
ôô* ,
)
ôô, -
;
ôô- .
}
õõ 
finally
öö 
{
÷÷ 
}
ùù 
}
úú 
}
ûû 	
public
ÿÿ 
string
ÿÿ 
customerCompany
ÿÿ %
{
€€ 	
get
 
{
‚‚ 
try
ƒƒ 
{
„„ 
return
…… 
m_customerCompany
…… ,
;
……, -
}
†† 
catch
‡‡ 
(
‡‡ 
	Exception
‡‡  
ex
‡‡! #
)
‡‡# $
{
ˆˆ 
FDebug
‰‰ 
.
‰‰ 
throwException
‰‰ )
(
‰‰) *
ex
‰‰* ,
)
‰‰, -
;
‰‰- .
}
ŠŠ 
finally
‹‹ 
{
ŒŒ 
}
 
return
 
string
 
.
 
Empty
 #
;
# $
}
 
internal
’’ 
set
’’ 
{
““ 
try
”” 
{
•• 
m_customerCompany
–– %
=
––& '
value
––( -
;
––- .
}
—— 
catch
˜˜ 
(
˜˜ 
	Exception
˜˜  
ex
˜˜! #
)
˜˜# $
{
™™ 
FDebug
šš 
.
šš 
throwException
šš )
(
šš) *
ex
šš* ,
)
šš, -
;
šš- .
}
›› 
finally
œœ 
{
 
}
ŸŸ 
}
   
}
¡¡ 	
public
¥¥ 
string
¥¥ 
server
¥¥ 
{
¦¦ 	
get
§§ 
{
¨¨ 
try
©© 
{
ªª 
return
«« 
m_server
«« #
;
««# $
}
¬¬ 
catch
­­ 
(
­­ 
	Exception
­­  
ex
­­! #
)
­­# $
{
®® 
FDebug
¯¯ 
.
¯¯ 
throwException
¯¯ )
(
¯¯) *
ex
¯¯* ,
)
¯¯, -
;
¯¯- .
}
°° 
finally
±± 
{
²² 
}
´´ 
return
µµ 
string
µµ 
.
µµ 
Empty
µµ #
;
µµ# $
}
¶¶ 
internal
¸¸ 
set
¸¸ 
{
¹¹ 
try
ºº 
{
»» 
m_server
¼¼ 
=
¼¼ 
value
¼¼ $
;
¼¼$ %
}
½½ 
catch
¾¾ 
(
¾¾ 
	Exception
¾¾  
ex
¾¾! #
)
¾¾# $
{
¿¿ 
FDebug
ÀÀ 
.
ÀÀ 
throwException
ÀÀ )
(
ÀÀ) *
ex
ÀÀ* ,
)
ÀÀ, -
;
ÀÀ- .
}
ÁÁ 
finally
ÂÂ 
{
ÃÃ 
}
ÅÅ 
}
ÆÆ 
}
ÇÇ 	
public
ËË 
string
ËË 
	clickOnce
ËË 
{
ÌÌ 	
get
ÍÍ 
{
ÎÎ 
try
ÏÏ 
{
ĞĞ 
return
ÑÑ 
m_clickOnce
ÑÑ &
;
ÑÑ& '
}
ÒÒ 
catch
ÓÓ 
(
ÓÓ 
	Exception
ÓÓ  
ex
ÓÓ! #
)
ÓÓ# $
{
ÔÔ 
FDebug
ÕÕ 
.
ÕÕ 
throwException
ÕÕ )
(
ÕÕ) *
ex
ÕÕ* ,
)
ÕÕ, -
;
ÕÕ- .
}
ÖÖ 
finally
×× 
{
ØØ 
}
ÚÚ 
return
ÛÛ 
string
ÛÛ 
.
ÛÛ 
Empty
ÛÛ #
;
ÛÛ# $
}
ÜÜ 
internal
ŞŞ 
set
ŞŞ 
{
ßß 
try
àà 
{
áá 
m_clickOnce
ââ 
=
ââ  !
value
ââ" '
;
ââ' (
}
ãã 
catch
ää 
(
ää 
	Exception
ää  
ex
ää! #
)
ää# $
{
åå 
FDebug
ææ 
.
ææ 
throwException
ææ )
(
ææ) *
ex
ææ* ,
)
ææ, -
;
ææ- .
}
çç 
finally
èè 
{
éé 
}
ëë 
}
ìì 
}
íí 	
public
ññ 
string
ññ 
	userLimit
ññ 
{
òò 	
get
óó 
{
ôô 
try
õõ 
{
öö 
return
÷÷ 
m_userLimit
÷÷ &
;
÷÷& '
}
øø 
catch
ùù 
(
ùù 
	Exception
ùù  
ex
ùù! #
)
ùù# $
{
úú 
FDebug
ûû 
.
ûû 
throwException
ûû )
(
ûû) *
ex
ûû* ,
)
ûû, -
;
ûû- .
}
üü 
finally
ıı 
{
şş 
}
€€ 
return
 
string
 
.
 
Empty
 #
;
# $
}
‚‚ 
internal
„„ 
set
„„ 
{
…… 
try
†† 
{
‡‡ 
m_userLimit
ˆˆ 
=
ˆˆ  !
value
ˆˆ" '
;
ˆˆ' (
}
‰‰ 
catch
ŠŠ 
(
ŠŠ 
	Exception
ŠŠ  
ex
ŠŠ! #
)
ŠŠ# $
{
‹‹ 
FDebug
ŒŒ 
.
ŒŒ 
throwException
ŒŒ )
(
ŒŒ) *
ex
ŒŒ* ,
)
ŒŒ, -
;
ŒŒ- .
}
 
finally
 
{
 
}
‘‘ 
}
’’ 
}
““ 	
public
—— 
string
—— 
expireIssuedCheck
—— '
{
˜˜ 	
get
™™ 
{
šš 
try
›› 
{
œœ 
return
 !
m_expireIssuedCheck
 .
;
. /
}
 
catch
ŸŸ 
(
ŸŸ 
	Exception
ŸŸ  
ex
ŸŸ! #
)
ŸŸ# $
{
   
FDebug
¡¡ 
.
¡¡ 
throwException
¡¡ )
(
¡¡) *
ex
¡¡* ,
)
¡¡, -
;
¡¡- .
}
¢¢ 
finally
££ 
{
¤¤ 
}
¦¦ 
return
§§ 
string
§§ 
.
§§ 
Empty
§§ #
;
§§# $
}
¨¨ 
internal
ªª 
set
ªª 
{
«« 
try
¬¬ 
{
­­ !
m_expireIssuedCheck
®® '
=
®®( )
value
®®* /
;
®®/ 0
}
¯¯ 
catch
°° 
(
°° 
	Exception
°°  
ex
°°! #
)
°°# $
{
±± 
FDebug
²² 
.
²² 
throwException
²² )
(
²²) *
ex
²²* ,
)
²², -
;
²²- .
}
³³ 
finally
´´ 
{
µµ 
}
·· 
}
¸¸ 
}
¹¹ 	
public
½½ 
string
½½ 
expireIssuedDate
½½ &
{
¾¾ 	
get
¿¿ 
{
ÀÀ 
try
ÁÁ 
{
ÂÂ 
return
ÃÃ  
m_expireIssuedDate
ÃÃ -
;
ÃÃ- .
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
	Exception
ÅÅ  
ex
ÅÅ! #
)
ÅÅ# $
{
ÆÆ 
FDebug
ÇÇ 
.
ÇÇ 
throwException
ÇÇ )
(
ÇÇ) *
ex
ÇÇ* ,
)
ÇÇ, -
;
ÇÇ- .
}
ÈÈ 
finally
ÉÉ 
{
ÊÊ 
}
ÌÌ 
return
ÍÍ 
string
ÍÍ 
.
ÍÍ 
Empty
ÍÍ #
;
ÍÍ# $
}
ÎÎ 
internal
ĞĞ 
set
ĞĞ 
{
ÑÑ 
try
ÒÒ 
{
ÓÓ  
m_expireIssuedDate
ÔÔ &
=
ÔÔ' (
value
ÔÔ) .
;
ÔÔ. /
}
ÕÕ 
catch
ÖÖ 
(
ÖÖ 
	Exception
ÖÖ  
ex
ÖÖ! #
)
ÖÖ# $
{
×× 
FDebug
ØØ 
.
ØØ 
throwException
ØØ )
(
ØØ) *
ex
ØØ* ,
)
ØØ, -
;
ØØ- .
}
ÙÙ 
finally
ÚÚ 
{
ÛÛ 
}
İİ 
}
ŞŞ 
}
ßß 	
public
ãã 
string
ãã 
macAddressCheck
ãã %
{
ää 	
get
åå 
{
ææ 
try
çç 
{
èè 
return
éé 
m_macAddressCheck
éé ,
;
éé, -
}
êê 
catch
ëë 
(
ëë 
	Exception
ëë  
ex
ëë! #
)
ëë# $
{
ìì 
FDebug
íí 
.
íí 
throwException
íí )
(
íí) *
ex
íí* ,
)
íí, -
;
íí- .
}
îî 
finally
ïï 
{
ğğ 
}
òò 
return
óó 
string
óó 
.
óó 
Empty
óó #
;
óó# $
}
ôô 
internal
öö 
set
öö 
{
÷÷ 
try
øø 
{
ùù 
m_macAddressCheck
úú %
=
úú& '
value
úú( -
;
úú- .
}
ûû 
catch
üü 
(
üü 
	Exception
üü  
ex
üü! #
)
üü# $
{
ıı 
FDebug
şş 
.
şş 
throwException
şş )
(
şş) *
ex
şş* ,
)
şş, -
;
şş- .
}
ÿÿ 
finally
€€ 
{
 
}
ƒƒ 
}
„„ 
}
…… 	
public
‰‰ 
HashSet
‰‰ 
<
‰‰ 
string
‰‰ 
>
‰‰ 
macAddressList
‰‰ -
{
ŠŠ 	
get
‹‹ 
{
ŒŒ 
try
 
{
 
return
 
m_macAddressList
 +
;
+ ,
}
 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘  
ex
‘‘! #
)
‘‘# $
{
’’ 
FDebug
““ 
.
““ 
throwException
““ )
(
““) *
ex
““* ,
)
““, -
;
““- .
}
”” 
finally
•• 
{
–– 
}
˜˜ 
return
™™ 
null
™™ 
;
™™ 
}
šš 
}
›› 	
public
ŸŸ 
string
ŸŸ 
key
ŸŸ 
{
   	
get
¡¡ 
{
¢¢ 
try
££ 
{
¤¤ 
return
¥¥ 
m_key
¥¥  
;
¥¥  !
}
¦¦ 
catch
§§ 
(
§§ 
	Exception
§§  
ex
§§! #
)
§§# $
{
¨¨ 
FDebug
©© 
.
©© 
throwException
©© )
(
©©) *
ex
©©* ,
)
©©, -
;
©©- .
}
ªª 
finally
«« 
{
¬¬ 
}
®® 
return
¯¯ 
string
¯¯ 
.
¯¯ 
Empty
¯¯ #
;
¯¯# $
}
°° 
internal
²² 
set
²² 
{
³³ 
try
´´ 
{
µµ 
m_key
¶¶ 
=
¶¶ 
value
¶¶ !
;
¶¶! "
}
·· 
catch
¸¸ 
(
¸¸ 
	Exception
¸¸  
ex
¸¸! #
)
¸¸# $
{
¹¹ 
FDebug
ºº 
.
ºº 
throwException
ºº )
(
ºº) *
ex
ºº* ,
)
ºº, -
;
ºº- .
}
»» 
finally
¼¼ 
{
½½ 
}
¿¿ 
}
ÀÀ 
}
ÁÁ 	
public
ÅÅ 
string
ÅÅ 
rawData
ÅÅ 
{
ÆÆ 	
get
ÇÇ 
{
ÈÈ 
try
ÉÉ 
{
ÊÊ 
return
ËË 
	m_rawData
ËË $
;
ËË$ %
}
ÌÌ 
catch
ÍÍ 
(
ÍÍ 
	Exception
ÍÍ  
ex
ÍÍ! #
)
ÍÍ# $
{
ÎÎ 
FDebug
ÏÏ 
.
ÏÏ 
throwException
ÏÏ )
(
ÏÏ) *
ex
ÏÏ* ,
)
ÏÏ, -
;
ÏÏ- .
}
ĞĞ 
finally
ÑÑ 
{
ÒÒ 
}
ÔÔ 
return
ÕÕ 
string
ÕÕ 
.
ÕÕ 
Empty
ÕÕ #
;
ÕÕ# $
}
ÖÖ 
internal
ØØ 
set
ØØ 
{
ÙÙ 
try
ÚÚ 
{
ÛÛ 
	m_rawData
ÜÜ 
=
ÜÜ 
value
ÜÜ  %
;
ÜÜ% &
}
İİ 
catch
ŞŞ 
(
ŞŞ 
	Exception
ŞŞ  
ex
ŞŞ! #
)
ŞŞ# $
{
ßß 
FDebug
àà 
.
àà 
throwException
àà )
(
àà) *
ex
àà* ,
)
àà, -
;
àà- .
}
áá 
finally
ââ 
{
ãã 
}
åå 
}
ææ 
}
çç 	
}
óó 
}ôô ¬Ä
_D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Security\c_FLic2License.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FLic2License 
: 
IDisposable  +
{ 
private 
const 
string 
LicenceInformation /
=0 1
$str2 G
;G H
private 
const 
string 
	LicenceId &
=' (
$str) 5
;5 6
private   
const   
string   
CustomerCompany   ,
=  - .
$str  / A
;  A B
private!! 
const!! 
string!! 
CustomerSite!! )
=!!* +
$str!!, ;
;!!; <
private## 
const## 
string## 
ProductInformation## /
=##0 1
$str##2 G
;##G H
private$$ 
const$$ 
string$$ 
ProductTitle$$ )
=$$* +
$str$$, ;
;$$; <
private%% 
const%% 
string%% 
ProductVersion%% +
=%%, -
$str%%. ?
;%%? @
private'' 
const'' 
string'' 

FAmateSecs'' '
=''( )
$str''* 7
;''7 8
private(( 
const(( 
string(( 
	FAmateOpc(( &
=((' (
$str(() 5
;((5 6
private)) 
const)) 
string)) 
	FAmateTcp)) &
=))' (
$str))) 5
;))5 6
private** 
const** 
string** 
FAmateAdminManager** /
=**0 1
$str**2 H
;**H I
private++ 
const++ 
string++ 
FAmateAdminService++ /
=++0 1
$str++2 H
;++H I
private,, 
const,, 
string,, 
FAmateS2hCvt,, )
=,,* +
$str,,, I
;,,I J
private.. 
const.. 
string.. 
ProductEnabled.. +
=.., -
$str... ?
;..? @
private// 
const// 
string// 
NetworkDeployed// ,
=//- .
$str/// A
;//A B
private00 
const00 
string00 
ExpireIssuedCheck00 .
=00/ 0
$str001 F
;00F G
private11 
const11 
string11 
ExpireIssuedDate11 -
=11. /
$str110 D
;11D E
private22 
const22 
string22 
MacAddressCheck22 ,
=22- .
$str22/ B
;22B C
private33 
const33 
string33 

MacAddress33 '
=33( )
$str33* 7
;337 8
private55 
const55 
string55 

EapRuntime55 '
=55( )
$str55* 7
;557 8
private66 
const66 
string66 
EquipmentRuntime66 -
=66. /
$str660 C
;66C D
private77 
const77 
string77 %
Secs1HsmsConverterRuntime77 6
=777 8
$str779 W
;77W X
private88 
const88 
string88 
OpcTagRuntime88 *
=88+ ,
$str88- >
;88> ?
private:: 
const:: 
string:: 

LicenseKey:: '
=::( )
$str::* 7
;::7 8
private;; 
const;; 
string;; 
Key;;  
=;;! "
$str;;# (
;;;( )
private== 
const== 
string== 

KeyMarking== '
===( )
$str==* 0
;==0 1
privateAA 
boolAA 

m_disposedAA 
=AA  !
falseAA" '
;AA' (
privateCC 
	FLic2InfoCC 

m_fLicInfoCC $
=CC% &
nullCC' +
;CC+ ,
publicII 
FLic2LicenseII 
(II 
)JJ 
{KK 	

m_fLicInfoLL 
=LL 
newLL 
	FLic2InfoLL &
(LL& '
)LL' (
;LL( )
}MM 	
~QQ 	
FLic2LicenseQQ	 
(QQ 
)RR 
{SS 	
	myDisposeTT 
(TT 
falseTT 
)TT 
;TT 
}UU 	
	protectedYY 
voidYY 
	myDisposeYY  
(YY  !
boolZZ 
	disposingZZ 
)[[ 
{\\ 	
if]] 
(]] 
!]] 

m_disposed]] 
)]] 
{^^ 
if__ 
(__ 
	disposing__ 
)__ 
{`` 

m_fLicInfoaa 
=aa  
nullaa! %
;aa% &
}bb 

m_disposedcc 
=cc 
truecc !
;cc! "
}dd 
}ee 	
publicmm 
voidmm 
Disposemm 
(mm 
)nn 
{oo 	
	myDisposepp 
(pp 
truepp 
)pp 
;pp 
GCqq 
.qq 
SuppressFinalizeqq 
(qq  
thisqq  $
)qq$ %
;qq% &
}rr 	
public
€€ 
	FLic2Info
€€ 
validate
€€ !
(
€€! "
string
 
fileName
 
)
‚‚ 
{
ƒƒ 	
StreamReader
„„ 
sr
„„ 
=
„„ 
null
„„ "
;
„„" #
string
…… 
licData
…… 
=
…… 
string
…… #
.
……# $
Empty
……$ )
;
……) *
string
†† 
rawData
†† 
=
†† 
string
†† #
.
††# $
Empty
††$ )
;
††) *
string
‡‡ 
keyData
‡‡ 
=
‡‡ 
string
‡‡ #
.
‡‡# $
Empty
‡‡$ )
;
‡‡) *
int
ˆˆ 
index
ˆˆ 
=
ˆˆ 
$num
ˆˆ 
;
ˆˆ 
try
ŠŠ 
{
‹‹ 
if
 
(
 
!
 
File
 
.
 
Exists
  
(
  !
fileName
! )
)
) *
)
* +
{
 
FDebug
‘‘ 
.
‘‘ 
throwFException
‘‘ *
(
‘‘* +

FConstants
‘‘+ 5
.
‘‘5 6

err_m_0018
‘‘6 @
)
‘‘@ A
;
‘‘A B
}
’’ 
sr
–– 
=
–– 
new
–– 
StreamReader
–– %
(
––% &
fileName
––& .
,
––. /
Encoding
––0 8
.
––8 9
Default
––9 @
)
––@ A
;
––A B
licData
—— 
=
—— 
sr
—— 
.
—— 
	ReadToEnd
—— &
(
——& '
)
——' (
;
——( )
sr
˜˜ 
.
˜˜ 
Close
˜˜ 
(
˜˜ 
)
˜˜ 
;
˜˜ 
sr
™™ 
.
™™ 
Dispose
™™ 
(
™™ 
)
™™ 
;
™™ 
sr
šš 
=
šš 
null
šš 
;
šš 
index
 
=
 
licData
 
.
  
IndexOf
  '
(
' (

KeyMarking
( 2
)
2 3
;
3 4
if
ŸŸ 
(
ŸŸ 
index
ŸŸ 
==
ŸŸ 
-
ŸŸ 
$num
ŸŸ 
)
ŸŸ  
{
   
FDebug
¡¡ 
.
¡¡ 
throwFException
¡¡ *
(
¡¡* +

FConstants
¡¡+ 5
.
¡¡5 6

err_m_0022
¡¡6 @
)
¡¡@ A
;
¡¡A B
}
¢¢ 
rawData
¦¦ 
=
¦¦ 
licData
¦¦ !
.
¦¦! "
	Substring
¦¦" +
(
¦¦+ ,
$num
¦¦, -
,
¦¦- .
index
¦¦/ 4
)
¦¦4 5
;
¦¦5 6
rawData
§§ 
=
§§ 
rawData
§§ !
.
§§! "
Replace
§§" )
(
§§) *
$str
§§* .
,
§§. /
$str
§§0 2
)
§§2 3
;
§§3 4
rawData
¨¨ 
=
¨¨ 
rawData
¨¨ !
.
¨¨! "
Replace
¨¨" )
(
¨¨) *
$str
¨¨* .
,
¨¨. /
$str
¨¨0 2
)
¨¨2 3
;
¨¨3 4
if
©© 
(
©© 
rawData
©© 
==
©© 
string
©© %
.
©©% &
Empty
©©& +
)
©©+ ,
{
ªª 
FDebug
«« 
.
«« 
throwFException
«« *
(
««* +

FConstants
««+ 5
.
««5 6

err_m_0022
««6 @
)
««@ A
;
««A B
}
¬¬ 
keyData
°° 
=
°° 
FIniFile
°° "
.
°°" #
readIniFile
°°# .
(
°°. /

LicenseKey
°°/ 9
,
°°9 :
Key
°°; >
,
°°> ?
fileName
°°@ H
,
°°H I
string
°°J P
.
°°P Q
Empty
°°Q V
)
°°V W
;
°°W X
if
±± 
(
±± 
keyData
±± 
==
±± 
string
±± %
.
±±% &
Empty
±±& +
||
±±, .
keyData
±±/ 6
!=
±±7 9
(
±±: ;
new
±±; >
FCrypt
±±? E
(
±±E F
)
±±F G
)
±±G H
.
±±H I
encrypt2
±±I Q
(
±±Q R
rawData
±±R Y
)
±±Y Z
)
±±Z [
{
²² 
FDebug
³³ 
.
³³ 
throwFException
³³ *
(
³³* +

FConstants
³³+ 5
.
³³5 6

err_m_0022
³³6 @
)
³³@ A
;
³³A B
}
´´ 

m_fLicInfo
¸¸ 
.
¸¸ 
	licenseId
¸¸ $
=
¸¸% &
FIniFile
¸¸' /
.
¸¸/ 0
readIniFile
¸¸0 ;
(
¸¸; < 
LicenceInformation
¸¸< N
,
¸¸N O
	LicenceId
¸¸P Y
,
¸¸Y Z
fileName
¸¸[ c
,
¸¸c d
string
¸¸e k
.
¸¸k l
Empty
¸¸l q
)
¸¸q r
;
¸¸r s

m_fLicInfo
¹¹ 
.
¹¹ 
customerCompany
¹¹ *
=
¹¹+ ,
FIniFile
¹¹- 5
.
¹¹5 6
readIniFile
¹¹6 A
(
¹¹A B 
LicenceInformation
¹¹B T
,
¹¹T U
CustomerCompany
¹¹V e
,
¹¹e f
fileName
¹¹g o
,
¹¹o p
string
¹¹q w
.
¹¹w x
Empty
¹¹x }
)
¹¹} ~
;
¹¹~ 

m_fLicInfo
ºº 
.
ºº 
customerSite
ºº '
=
ºº( )
FIniFile
ºº* 2
.
ºº2 3
readIniFile
ºº3 >
(
ºº> ? 
LicenceInformation
ºº? Q
,
ººQ R
CustomerSite
ººS _
,
ºº_ `
fileName
ººa i
,
ººi j
string
ººk q
.
ººq r
Empty
ººr w
)
ººw x
;
ººx y

m_fLicInfo
¼¼ 
.
¼¼ 
productTitle
¼¼ '
=
¼¼( )
FIniFile
¼¼* 2
.
¼¼2 3
readIniFile
¼¼3 >
(
¼¼> ? 
ProductInformation
¼¼? Q
,
¼¼Q R
ProductTitle
¼¼S _
,
¼¼_ `
fileName
¼¼a i
,
¼¼i j
string
¼¼k q
.
¼¼q r
Empty
¼¼r w
)
¼¼w x
;
¼¼x y

m_fLicInfo
½½ 
.
½½ 
productVersion
½½ )
=
½½* +
FIniFile
½½, 4
.
½½4 5
readIniFile
½½5 @
(
½½@ A 
ProductInformation
½½A S
,
½½S T
ProductVersion
½½U c
,
½½c d
fileName
½½e m
,
½½m n
string
½½o u
.
½½u v
Empty
½½v {
)
½½{ |
;
½½| }

m_fLicInfo
¿¿ 
.
¿¿ 
fLicSecs
¿¿ #
.
¿¿# $
productEnabled
¿¿$ 2
=
¿¿3 4
(
¿¿5 6
FYesNo
¿¿6 <
)
¿¿< =
Enum
¿¿= A
.
¿¿A B
Parse
¿¿B G
(
¿¿G H
typeof
¿¿H N
(
¿¿N O
FYesNo
¿¿O U
)
¿¿U V
,
¿¿V W
FIniFile
¿¿X `
.
¿¿` a
readIniFile
¿¿a l
(
¿¿l m

FAmateSecs
¿¿m w
,
¿¿w x
ProductEnabled¿¿y ‡
,¿¿‡ ˆ
fileName¿¿‰ ‘
,¿¿‘ ’
FYesNo¿¿“ ™
.¿¿™ š
No¿¿š œ
.¿¿œ 
ToString¿¿ ¥
(¿¿¥ ¦
)¿¿¦ §
)¿¿§ ¨
)¿¿¨ ©
;¿¿© ª

m_fLicInfo
ÀÀ 
.
ÀÀ 
fLicSecs
ÀÀ #
.
ÀÀ# $
networkDeployed
ÀÀ$ 3
=
ÀÀ4 5
(
ÀÀ6 7
FYesNo
ÀÀ7 =
)
ÀÀ= >
Enum
ÀÀ> B
.
ÀÀB C
Parse
ÀÀC H
(
ÀÀH I
typeof
ÀÀI O
(
ÀÀO P
FYesNo
ÀÀP V
)
ÀÀV W
,
ÀÀW X
FIniFile
ÀÀY a
.
ÀÀa b
readIniFile
ÀÀb m
(
ÀÀm n

FAmateSecs
ÀÀn x
,
ÀÀx y
NetworkDeployedÀÀz ‰
,ÀÀ‰ Š
fileNameÀÀ‹ “
,ÀÀ“ ”
FYesNoÀÀ• ›
.ÀÀ› œ
NoÀÀœ 
.ÀÀ Ÿ
ToStringÀÀŸ §
(ÀÀ§ ¨
)ÀÀ¨ ©
)ÀÀ© ª
)ÀÀª «
;ÀÀ« ¬

m_fLicInfo
ÁÁ 
.
ÁÁ 
fLicSecs
ÁÁ #
.
ÁÁ# $
expireIssuedCheck
ÁÁ$ 5
=
ÁÁ6 7
(
ÁÁ8 9
FYesNo
ÁÁ9 ?
)
ÁÁ? @
Enum
ÁÁ@ D
.
ÁÁD E
Parse
ÁÁE J
(
ÁÁJ K
typeof
ÁÁK Q
(
ÁÁQ R
FYesNo
ÁÁR X
)
ÁÁX Y
,
ÁÁY Z
FIniFile
ÁÁ[ c
.
ÁÁc d
readIniFile
ÁÁd o
(
ÁÁo p

FAmateSecs
ÁÁp z
,
ÁÁz { 
ExpireIssuedCheckÁÁ| 
,ÁÁ 
fileNameÁÁ —
,ÁÁ— ˜
FYesNoÁÁ™ Ÿ
.ÁÁŸ  
NoÁÁ  ¢
.ÁÁ¢ £
ToStringÁÁ£ «
(ÁÁ« ¬
)ÁÁ¬ ­
)ÁÁ­ ®
)ÁÁ® ¯
;ÁÁ¯ °

m_fLicInfo
ÂÂ 
.
ÂÂ 
fLicSecs
ÂÂ #
.
ÂÂ# $
expireIssuedDate
ÂÂ$ 4
=
ÂÂ5 6
FIniFile
ÂÂ7 ?
.
ÂÂ? @
readIniFile
ÂÂ@ K
(
ÂÂK L

FAmateSecs
ÂÂL V
,
ÂÂV W
ExpireIssuedDate
ÂÂX h
,
ÂÂh i
fileName
ÂÂj r
,
ÂÂr s
string
ÂÂt z
.
ÂÂz {
EmptyÂÂ{ €
)ÂÂ€ 
;ÂÂ ‚

m_fLicInfo
ÃÃ 
.
ÃÃ 
fLicSecs
ÃÃ #
.
ÃÃ# $
macAddresscheck
ÃÃ$ 3
=
ÃÃ4 5
(
ÃÃ6 7
FYesNo
ÃÃ7 =
)
ÃÃ= >
Enum
ÃÃ> B
.
ÃÃB C
Parse
ÃÃC H
(
ÃÃH I
typeof
ÃÃI O
(
ÃÃO P
FYesNo
ÃÃP V
)
ÃÃV W
,
ÃÃW X
FIniFile
ÃÃY a
.
ÃÃa b
readIniFile
ÃÃb m
(
ÃÃm n

FAmateSecs
ÃÃn x
,
ÃÃx y
MacAddressCheckÃÃz ‰
,ÃÃ‰ Š
fileNameÃÃ‹ “
,ÃÃ“ ”
FYesNoÃÃ• ›
.ÃÃ› œ
NoÃÃœ 
.ÃÃ Ÿ
ToStringÃÃŸ §
(ÃÃ§ ¨
)ÃÃ¨ ©
)ÃÃ© ª
)ÃÃª «
;ÃÃ« ¬

m_fLicInfo
ÄÄ 
.
ÄÄ 
fLicSecs
ÄÄ #
.
ÄÄ# $

macAddress
ÄÄ$ .
=
ÄÄ/ 0
FIniFile
ÄÄ1 9
.
ÄÄ9 :
readIniFile
ÄÄ: E
(
ÄÄE F

FAmateSecs
ÄÄF P
,
ÄÄP Q

MacAddress
ÄÄR \
,
ÄÄ\ ]
fileName
ÄÄ^ f
,
ÄÄf g
string
ÄÄh n
.
ÄÄn o
Empty
ÄÄo t
)
ÄÄt u
;
ÄÄu v

m_fLicInfo
ÆÆ 
.
ÆÆ 
fLicOpc
ÆÆ "
.
ÆÆ" #
productEnabled
ÆÆ# 1
=
ÆÆ2 3
(
ÆÆ4 5
FYesNo
ÆÆ5 ;
)
ÆÆ; <
Enum
ÆÆ< @
.
ÆÆ@ A
Parse
ÆÆA F
(
ÆÆF G
typeof
ÆÆG M
(
ÆÆM N
FYesNo
ÆÆN T
)
ÆÆT U
,
ÆÆU V
FIniFile
ÆÆW _
.
ÆÆ_ `
readIniFile
ÆÆ` k
(
ÆÆk l
	FAmateOpc
ÆÆl u
,
ÆÆu v
ProductEnabledÆÆw …
,ÆÆ… †
fileNameÆÆ‡ 
,ÆÆ 
FYesNoÆÆ‘ —
.ÆÆ— ˜
NoÆÆ˜ š
.ÆÆš ›
ToStringÆÆ› £
(ÆÆ£ ¤
)ÆÆ¤ ¥
)ÆÆ¥ ¦
)ÆÆ¦ §
;ÆÆ§ ¨

m_fLicInfo
ÇÇ 
.
ÇÇ 
fLicOpc
ÇÇ "
.
ÇÇ" #
networkDeployed
ÇÇ# 2
=
ÇÇ3 4
(
ÇÇ5 6
FYesNo
ÇÇ6 <
)
ÇÇ< =
Enum
ÇÇ= A
.
ÇÇA B
Parse
ÇÇB G
(
ÇÇG H
typeof
ÇÇH N
(
ÇÇN O
FYesNo
ÇÇO U
)
ÇÇU V
,
ÇÇV W
FIniFile
ÇÇX `
.
ÇÇ` a
readIniFile
ÇÇa l
(
ÇÇl m
	FAmateOpc
ÇÇm v
,
ÇÇv w
NetworkDeployedÇÇx ‡
,ÇÇ‡ ˆ
fileNameÇÇ‰ ‘
,ÇÇ‘ ’
FYesNoÇÇ“ ™
.ÇÇ™ š
NoÇÇš œ
.ÇÇœ 
ToStringÇÇ ¥
(ÇÇ¥ ¦
)ÇÇ¦ §
)ÇÇ§ ¨
)ÇÇ¨ ©
;ÇÇ© ª

m_fLicInfo
ÈÈ 
.
ÈÈ 
fLicOpc
ÈÈ "
.
ÈÈ" #
expireIssuedCheck
ÈÈ# 4
=
ÈÈ5 6
(
ÈÈ7 8
FYesNo
ÈÈ8 >
)
ÈÈ> ?
Enum
ÈÈ? C
.
ÈÈC D
Parse
ÈÈD I
(
ÈÈI J
typeof
ÈÈJ P
(
ÈÈP Q
FYesNo
ÈÈQ W
)
ÈÈW X
,
ÈÈX Y
FIniFile
ÈÈZ b
.
ÈÈb c
readIniFile
ÈÈc n
(
ÈÈn o
	FAmateOpc
ÈÈo x
,
ÈÈx y 
ExpireIssuedCheckÈÈz ‹
,ÈÈ‹ Œ
fileNameÈÈ •
,ÈÈ• –
FYesNoÈÈ— 
.ÈÈ 
NoÈÈ  
.ÈÈ  ¡
ToStringÈÈ¡ ©
(ÈÈ© ª
)ÈÈª «
)ÈÈ« ¬
)ÈÈ¬ ­
;ÈÈ­ ®

m_fLicInfo
ÉÉ 
.
ÉÉ 
fLicOpc
ÉÉ "
.
ÉÉ" #
expireIssuedDate
ÉÉ# 3
=
ÉÉ4 5
FIniFile
ÉÉ6 >
.
ÉÉ> ?
readIniFile
ÉÉ? J
(
ÉÉJ K
	FAmateOpc
ÉÉK T
,
ÉÉT U
ExpireIssuedDate
ÉÉV f
,
ÉÉf g
fileName
ÉÉh p
,
ÉÉp q
string
ÉÉr x
.
ÉÉx y
Empty
ÉÉy ~
)
ÉÉ~ 
;ÉÉ €

m_fLicInfo
ÊÊ 
.
ÊÊ 
fLicOpc
ÊÊ "
.
ÊÊ" #
macAddresscheck
ÊÊ# 2
=
ÊÊ3 4
(
ÊÊ5 6
FYesNo
ÊÊ6 <
)
ÊÊ< =
Enum
ÊÊ= A
.
ÊÊA B
Parse
ÊÊB G
(
ÊÊG H
typeof
ÊÊH N
(
ÊÊN O
FYesNo
ÊÊO U
)
ÊÊU V
,
ÊÊV W
FIniFile
ÊÊX `
.
ÊÊ` a
readIniFile
ÊÊa l
(
ÊÊl m
	FAmateOpc
ÊÊm v
,
ÊÊv w
MacAddressCheckÊÊx ‡
,ÊÊ‡ ˆ
fileNameÊÊ‰ ‘
,ÊÊ‘ ’
FYesNoÊÊ“ ™
.ÊÊ™ š
NoÊÊš œ
.ÊÊœ 
ToStringÊÊ ¥
(ÊÊ¥ ¦
)ÊÊ¦ §
)ÊÊ§ ¨
)ÊÊ¨ ©
;ÊÊ© ª

m_fLicInfo
ËË 
.
ËË 
fLicOpc
ËË "
.
ËË" #

macAddress
ËË# -
=
ËË. /
FIniFile
ËË0 8
.
ËË8 9
readIniFile
ËË9 D
(
ËËD E
	FAmateOpc
ËËE N
,
ËËN O

MacAddress
ËËP Z
,
ËËZ [
fileName
ËË\ d
,
ËËd e
string
ËËf l
.
ËËl m
Empty
ËËm r
)
ËËr s
;
ËËs t

m_fLicInfo
ÍÍ 
.
ÍÍ 
fLicTcp
ÍÍ "
.
ÍÍ" #
productEnabled
ÍÍ# 1
=
ÍÍ2 3
(
ÍÍ4 5
FYesNo
ÍÍ5 ;
)
ÍÍ; <
Enum
ÍÍ< @
.
ÍÍ@ A
Parse
ÍÍA F
(
ÍÍF G
typeof
ÍÍG M
(
ÍÍM N
FYesNo
ÍÍN T
)
ÍÍT U
,
ÍÍU V
FIniFile
ÍÍW _
.
ÍÍ_ `
readIniFile
ÍÍ` k
(
ÍÍk l
	FAmateTcp
ÍÍl u
,
ÍÍu v
ProductEnabledÍÍw …
,ÍÍ… †
fileNameÍÍ‡ 
,ÍÍ 
FYesNoÍÍ‘ —
.ÍÍ— ˜
NoÍÍ˜ š
.ÍÍš ›
ToStringÍÍ› £
(ÍÍ£ ¤
)ÍÍ¤ ¥
)ÍÍ¥ ¦
)ÍÍ¦ §
;ÍÍ§ ¨

m_fLicInfo
ÎÎ 
.
ÎÎ 
fLicTcp
ÎÎ "
.
ÎÎ" #
networkDeployed
ÎÎ# 2
=
ÎÎ3 4
(
ÎÎ5 6
FYesNo
ÎÎ6 <
)
ÎÎ< =
Enum
ÎÎ= A
.
ÎÎA B
Parse
ÎÎB G
(
ÎÎG H
typeof
ÎÎH N
(
ÎÎN O
FYesNo
ÎÎO U
)
ÎÎU V
,
ÎÎV W
FIniFile
ÎÎX `
.
ÎÎ` a
readIniFile
ÎÎa l
(
ÎÎl m
	FAmateTcp
ÎÎm v
,
ÎÎv w
NetworkDeployedÎÎx ‡
,ÎÎ‡ ˆ
fileNameÎÎ‰ ‘
,ÎÎ‘ ’
FYesNoÎÎ“ ™
.ÎÎ™ š
NoÎÎš œ
.ÎÎœ 
ToStringÎÎ ¥
(ÎÎ¥ ¦
)ÎÎ¦ §
)ÎÎ§ ¨
)ÎÎ¨ ©
;ÎÎ© ª

m_fLicInfo
ÏÏ 
.
ÏÏ 
fLicTcp
ÏÏ "
.
ÏÏ" #
expireIssuedCheck
ÏÏ# 4
=
ÏÏ5 6
(
ÏÏ7 8
FYesNo
ÏÏ8 >
)
ÏÏ> ?
Enum
ÏÏ? C
.
ÏÏC D
Parse
ÏÏD I
(
ÏÏI J
typeof
ÏÏJ P
(
ÏÏP Q
FYesNo
ÏÏQ W
)
ÏÏW X
,
ÏÏX Y
FIniFile
ÏÏZ b
.
ÏÏb c
readIniFile
ÏÏc n
(
ÏÏn o
	FAmateTcp
ÏÏo x
,
ÏÏx y 
ExpireIssuedCheckÏÏz ‹
,ÏÏ‹ Œ
fileNameÏÏ •
,ÏÏ• –
FYesNoÏÏ— 
.ÏÏ 
NoÏÏ  
.ÏÏ  ¡
ToStringÏÏ¡ ©
(ÏÏ© ª
)ÏÏª «
)ÏÏ« ¬
)ÏÏ¬ ­
;ÏÏ­ ®

m_fLicInfo
ĞĞ 
.
ĞĞ 
fLicTcp
ĞĞ "
.
ĞĞ" #
expireIssuedDate
ĞĞ# 3
=
ĞĞ4 5
FIniFile
ĞĞ6 >
.
ĞĞ> ?
readIniFile
ĞĞ? J
(
ĞĞJ K
	FAmateTcp
ĞĞK T
,
ĞĞT U
ExpireIssuedDate
ĞĞV f
,
ĞĞf g
fileName
ĞĞh p
,
ĞĞp q
string
ĞĞr x
.
ĞĞx y
Empty
ĞĞy ~
)
ĞĞ~ 
;ĞĞ €

m_fLicInfo
ÑÑ 
.
ÑÑ 
fLicTcp
ÑÑ "
.
ÑÑ" #
macAddresscheck
ÑÑ# 2
=
ÑÑ3 4
(
ÑÑ5 6
FYesNo
ÑÑ6 <
)
ÑÑ< =
Enum
ÑÑ= A
.
ÑÑA B
Parse
ÑÑB G
(
ÑÑG H
typeof
ÑÑH N
(
ÑÑN O
FYesNo
ÑÑO U
)
ÑÑU V
,
ÑÑV W
FIniFile
ÑÑX `
.
ÑÑ` a
readIniFile
ÑÑa l
(
ÑÑl m
	FAmateTcp
ÑÑm v
,
ÑÑv w
MacAddressCheckÑÑx ‡
,ÑÑ‡ ˆ
fileNameÑÑ‰ ‘
,ÑÑ‘ ’
FYesNoÑÑ“ ™
.ÑÑ™ š
NoÑÑš œ
.ÑÑœ 
ToStringÑÑ ¥
(ÑÑ¥ ¦
)ÑÑ¦ §
)ÑÑ§ ¨
)ÑÑ¨ ©
;ÑÑ© ª

m_fLicInfo
ÒÒ 
.
ÒÒ 
fLicTcp
ÒÒ "
.
ÒÒ" #

macAddress
ÒÒ# -
=
ÒÒ. /
FIniFile
ÒÒ0 8
.
ÒÒ8 9
readIniFile
ÒÒ9 D
(
ÒÒD E
	FAmateTcp
ÒÒE N
,
ÒÒN O

MacAddress
ÒÒP Z
,
ÒÒZ [
fileName
ÒÒ\ d
,
ÒÒd e
string
ÒÒf l
.
ÒÒl m
Empty
ÒÒm r
)
ÒÒr s
;
ÒÒs t

m_fLicInfo
ÔÔ 
.
ÔÔ 
fLicAdm
ÔÔ "
.
ÔÔ" #
productEnabled
ÔÔ# 1
=
ÔÔ2 3
(
ÔÔ4 5
FYesNo
ÔÔ5 ;
)
ÔÔ; <
Enum
ÔÔ< @
.
ÔÔ@ A
Parse
ÔÔA F
(
ÔÔF G
typeof
ÔÔG M
(
ÔÔM N
FYesNo
ÔÔN T
)
ÔÔT U
,
ÔÔU V
FIniFile
ÔÔW _
.
ÔÔ_ `
readIniFile
ÔÔ` k
(
ÔÔk l 
FAmateAdminManager
ÔÔl ~
,
ÔÔ~ 
ProductEnabledÔÔ€ 
,ÔÔ 
fileNameÔÔ ˜
,ÔÔ˜ ™
FYesNoÔÔš  
.ÔÔ  ¡
NoÔÔ¡ £
.ÔÔ£ ¤
ToStringÔÔ¤ ¬
(ÔÔ¬ ­
)ÔÔ­ ®
)ÔÔ® ¯
)ÔÔ¯ °
;ÔÔ° ±

m_fLicInfo
ÕÕ 
.
ÕÕ 
fLicAdm
ÕÕ "
.
ÕÕ" #
networkDeployed
ÕÕ# 2
=
ÕÕ3 4
(
ÕÕ5 6
FYesNo
ÕÕ6 <
)
ÕÕ< =
Enum
ÕÕ= A
.
ÕÕA B
Parse
ÕÕB G
(
ÕÕG H
typeof
ÕÕH N
(
ÕÕN O
FYesNo
ÕÕO U
)
ÕÕU V
,
ÕÕV W
FIniFile
ÕÕX `
.
ÕÕ` a
readIniFile
ÕÕa l
(
ÕÕl m 
FAmateAdminManager
ÕÕm 
,ÕÕ €
NetworkDeployedÕÕ 
,ÕÕ ‘
fileNameÕÕ’ š
,ÕÕš ›
FYesNoÕÕœ ¢
.ÕÕ¢ £
NoÕÕ£ ¥
.ÕÕ¥ ¦
ToStringÕÕ¦ ®
(ÕÕ® ¯
)ÕÕ¯ °
)ÕÕ° ±
)ÕÕ± ²
;ÕÕ² ³

m_fLicInfo
ÖÖ 
.
ÖÖ 
fLicAdm
ÖÖ "
.
ÖÖ" #
expireIssuedCheck
ÖÖ# 4
=
ÖÖ5 6
(
ÖÖ7 8
FYesNo
ÖÖ8 >
)
ÖÖ> ?
Enum
ÖÖ? C
.
ÖÖC D
Parse
ÖÖD I
(
ÖÖI J
typeof
ÖÖJ P
(
ÖÖP Q
FYesNo
ÖÖQ W
)
ÖÖW X
,
ÖÖX Y
FIniFile
ÖÖZ b
.
ÖÖb c
readIniFile
ÖÖc n
(
ÖÖn o!
FAmateAdminManagerÖÖo 
,ÖÖ ‚!
ExpireIssuedCheckÖÖƒ ”
,ÖÖ” •
fileNameÖÖ– 
,ÖÖ Ÿ
FYesNoÖÖ  ¦
.ÖÖ¦ §
NoÖÖ§ ©
.ÖÖ© ª
ToStringÖÖª ²
(ÖÖ² ³
)ÖÖ³ ´
)ÖÖ´ µ
)ÖÖµ ¶
;ÖÖ¶ ·

m_fLicInfo
×× 
.
×× 
fLicAdm
×× "
.
××" #
expireIssuedDate
××# 3
=
××4 5
FIniFile
××6 >
.
××> ?
readIniFile
××? J
(
××J K 
FAmateAdminManager
××K ]
,
××] ^
ExpireIssuedDate
××_ o
,
××o p
fileName
××q y
,
××y z
string××{ 
.×× ‚
Empty××‚ ‡
)××‡ ˆ
;××ˆ ‰

m_fLicInfo
ØØ 
.
ØØ 
fLicAdm
ØØ "
.
ØØ" #
macAddresscheck
ØØ# 2
=
ØØ3 4
(
ØØ5 6
FYesNo
ØØ6 <
)
ØØ< =
Enum
ØØ= A
.
ØØA B
Parse
ØØB G
(
ØØG H
typeof
ØØH N
(
ØØN O
FYesNo
ØØO U
)
ØØU V
,
ØØV W
FIniFile
ØØX `
.
ØØ` a
readIniFile
ØØa l
(
ØØl m 
FAmateAdminManager
ØØm 
,ØØ €
MacAddressCheckØØ 
,ØØ ‘
fileNameØØ’ š
,ØØš ›
FYesNoØØœ ¢
.ØØ¢ £
NoØØ£ ¥
.ØØ¥ ¦
ToStringØØ¦ ®
(ØØ® ¯
)ØØ¯ °
)ØØ° ±
)ØØ± ²
;ØØ² ³

m_fLicInfo
ÙÙ 
.
ÙÙ 
fLicAdm
ÙÙ "
.
ÙÙ" #

macAddress
ÙÙ# -
=
ÙÙ. /
FIniFile
ÙÙ0 8
.
ÙÙ8 9
readIniFile
ÙÙ9 D
(
ÙÙD E 
FAmateAdminManager
ÙÙE W
,
ÙÙW X

MacAddress
ÙÙY c
,
ÙÙc d
fileName
ÙÙe m
,
ÙÙm n
string
ÙÙo u
.
ÙÙu v
Empty
ÙÙv {
)
ÙÙ{ |
;
ÙÙ| }

m_fLicInfo
ÛÛ 
.
ÛÛ 
fLicAds
ÛÛ "
.
ÛÛ" #
productEnabled
ÛÛ# 1
=
ÛÛ2 3
(
ÛÛ4 5
FYesNo
ÛÛ5 ;
)
ÛÛ; <
Enum
ÛÛ< @
.
ÛÛ@ A
Parse
ÛÛA F
(
ÛÛF G
typeof
ÛÛG M
(
ÛÛM N
FYesNo
ÛÛN T
)
ÛÛT U
,
ÛÛU V
FIniFile
ÛÛW _
.
ÛÛ_ `
readIniFile
ÛÛ` k
(
ÛÛk l 
FAmateAdminService
ÛÛl ~
,
ÛÛ~ 
ProductEnabledÛÛ€ 
,ÛÛ 
fileNameÛÛ ˜
,ÛÛ˜ ™
FYesNoÛÛš  
.ÛÛ  ¡
NoÛÛ¡ £
.ÛÛ£ ¤
ToStringÛÛ¤ ¬
(ÛÛ¬ ­
)ÛÛ­ ®
)ÛÛ® ¯
)ÛÛ¯ °
;ÛÛ° ±

m_fLicInfo
ÜÜ 
.
ÜÜ 
fLicAds
ÜÜ "
.
ÜÜ" #
expireIssuedCheck
ÜÜ# 4
=
ÜÜ5 6
(
ÜÜ7 8
FYesNo
ÜÜ8 >
)
ÜÜ> ?
Enum
ÜÜ? C
.
ÜÜC D
Parse
ÜÜD I
(
ÜÜI J
typeof
ÜÜJ P
(
ÜÜP Q
FYesNo
ÜÜQ W
)
ÜÜW X
,
ÜÜX Y
FIniFile
ÜÜZ b
.
ÜÜb c
readIniFile
ÜÜc n
(
ÜÜn o!
FAmateAdminServiceÜÜo 
,ÜÜ ‚!
ExpireIssuedCheckÜÜƒ ”
,ÜÜ” •
fileNameÜÜ– 
,ÜÜ Ÿ
FYesNoÜÜ  ¦
.ÜÜ¦ §
NoÜÜ§ ©
.ÜÜ© ª
ToStringÜÜª ²
(ÜÜ² ³
)ÜÜ³ ´
)ÜÜ´ µ
)ÜÜµ ¶
;ÜÜ¶ ·

m_fLicInfo
İİ 
.
İİ 
fLicAds
İİ "
.
İİ" #
expireIssuedDate
İİ# 3
=
İİ4 5
FIniFile
İİ6 >
.
İİ> ?
readIniFile
İİ? J
(
İİJ K 
FAmateAdminService
İİK ]
,
İİ] ^
ExpireIssuedDate
İİ_ o
,
İİo p
fileName
İİq y
,
İİy z
stringİİ{ 
.İİ ‚
Emptyİİ‚ ‡
)İİ‡ ˆ
;İİˆ ‰

m_fLicInfo
ŞŞ 
.
ŞŞ 
fLicAds
ŞŞ "
.
ŞŞ" #
macAddresscheck
ŞŞ# 2
=
ŞŞ3 4
(
ŞŞ5 6
FYesNo
ŞŞ6 <
)
ŞŞ< =
Enum
ŞŞ= A
.
ŞŞA B
Parse
ŞŞB G
(
ŞŞG H
typeof
ŞŞH N
(
ŞŞN O
FYesNo
ŞŞO U
)
ŞŞU V
,
ŞŞV W
FIniFile
ŞŞX `
.
ŞŞ` a
readIniFile
ŞŞa l
(
ŞŞl m 
FAmateAdminService
ŞŞm 
,ŞŞ €
MacAddressCheckŞŞ 
,ŞŞ ‘
fileNameŞŞ’ š
,ŞŞš ›
FYesNoŞŞœ ¢
.ŞŞ¢ £
NoŞŞ£ ¥
.ŞŞ¥ ¦
ToStringŞŞ¦ ®
(ŞŞ® ¯
)ŞŞ¯ °
)ŞŞ° ±
)ŞŞ± ²
;ŞŞ² ³

m_fLicInfo
ßß 
.
ßß 
fLicAds
ßß "
.
ßß" #

macAddress
ßß# -
=
ßß. /
FIniFile
ßß0 8
.
ßß8 9
readIniFile
ßß9 D
(
ßßD E 
FAmateAdminService
ßßE W
,
ßßW X

MacAddress
ßßY c
,
ßßc d
fileName
ßße m
,
ßßm n
string
ßßo u
.
ßßu v
Empty
ßßv {
)
ßß{ |
;
ßß| }

m_fLicInfo
àà 
.
àà 
fLicAds
àà "
.
àà" #

eapRuntime
àà# -
=
àà. /
int
àà0 3
.
àà3 4
Parse
àà4 9
(
àà9 :
FIniFile
àà: B
.
ààB C
readIniFile
ààC N
(
ààN O 
FAmateAdminService
ààO a
,
ààa b

EapRuntime
ààc m
,
ààm n
fileName
àào w
,
ààw x
$str
àày |
)
àà| }
)
àà} ~
;
àà~ 

m_fLicInfo
áá 
.
áá 
fLicAds
áá "
.
áá" #
equipmentRuntime
áá# 3
=
áá4 5
int
áá6 9
.
áá9 :
Parse
áá: ?
(
áá? @
FIniFile
áá@ H
.
ááH I
readIniFile
ááI T
(
ááT U 
FAmateAdminService
ááU g
,
áág h
EquipmentRuntime
áái y
,
ááy z
fileNameáá{ ƒ
,ááƒ „
$stráá… ˆ
)ááˆ ‰
)áá‰ Š
;ááŠ ‹

m_fLicInfo
ââ 
.
ââ 
fLicAds
ââ "
.
ââ" #'
secs1HsmsConverterRuntime
ââ# <
=
ââ= >
int
ââ? B
.
ââB C
Parse
ââC H
(
ââH I
FIniFile
ââI Q
.
ââQ R
readIniFile
ââR ]
(
ââ] ^ 
FAmateAdminService
ââ^ p
,
ââp q(
Secs1HsmsConverterRuntimeââr ‹
,ââ‹ Œ
fileNameââ •
,ââ• –
$strââ— š
)ââš ›
)ââ› œ
;ââœ 

m_fLicInfo
ãã 
.
ãã 
fLicAds
ãã "
.
ãã" #
opcTagRuntime
ãã# 0
=
ãã1 2
int
ãã3 6
.
ãã6 7
Parse
ãã7 <
(
ãã< =
FIniFile
ãã= E
.
ããE F
readIniFile
ããF Q
(
ããQ R 
FAmateAdminService
ããR d
,
ããd e
OpcTagRuntime
ããf s
,
ããs t
fileName
ããu }
,
ãã} ~
$strãã ‡
)ãã‡ ˆ
)ããˆ ‰
;ãã‰ Š

m_fLicInfo
åå 
.
åå 

fLicS2hCvt
åå %
.
åå% &
productEnabled
åå& 4
=
åå5 6
(
åå7 8
FYesNo
åå8 >
)
åå> ?
Enum
åå? C
.
ååC D
Parse
ååD I
(
ååI J
typeof
ååJ P
(
ååP Q
FYesNo
ååQ W
)
ååW X
,
ååX Y
FIniFile
ååZ b
.
ååb c
readIniFile
ååc n
(
åån o
FAmateS2hCvt
ååo {
,
åå{ |
ProductEnabledåå} ‹
,åå‹ Œ
fileNameåå •
,åå• –
FYesNoåå— 
.åå 
Noåå  
.åå  ¡
ToStringåå¡ ©
(åå© ª
)ååª «
)åå« ¬
)åå¬ ­
;åå­ ®

m_fLicInfo
ææ 
.
ææ 

fLicS2hCvt
ææ %
.
ææ% &
networkDeployed
ææ& 5
=
ææ6 7
(
ææ8 9
FYesNo
ææ9 ?
)
ææ? @
Enum
ææ@ D
.
ææD E
Parse
ææE J
(
ææJ K
typeof
ææK Q
(
ææQ R
FYesNo
ææR X
)
ææX Y
,
ææY Z
FIniFile
ææ[ c
.
ææc d
readIniFile
ææd o
(
ææo p
FAmateS2hCvt
ææp |
,
ææ| }
NetworkDeployedææ~ 
,ææ 
fileNameææ —
,ææ— ˜
FYesNoææ™ Ÿ
.ææŸ  
Noææ  ¢
.ææ¢ £
ToStringææ£ «
(ææ« ¬
)ææ¬ ­
)ææ­ ®
)ææ® ¯
;ææ¯ °

m_fLicInfo
çç 
.
çç 

fLicS2hCvt
çç %
.
çç% &
expireIssuedCheck
çç& 7
=
çç8 9
(
çç: ;
FYesNo
çç; A
)
ççA B
Enum
ççB F
.
ççF G
Parse
ççG L
(
ççL M
typeof
ççM S
(
ççS T
FYesNo
ççT Z
)
ççZ [
,
çç[ \
FIniFile
çç] e
.
ççe f
readIniFile
ççf q
(
ççq r
FAmateS2hCvt
ççr ~
,
çç~ !
ExpireIssuedCheckçç€ ‘
,çç‘ ’
fileNameçç“ ›
,çç› œ
FYesNoçç £
.çç£ ¤
Noçç¤ ¦
.çç¦ §
ToStringçç§ ¯
(çç¯ °
)çç° ±
)çç± ²
)çç² ³
;çç³ ´

m_fLicInfo
èè 
.
èè 

fLicS2hCvt
èè %
.
èè% &
expireIssuedDate
èè& 6
=
èè7 8
FIniFile
èè9 A
.
èèA B
readIniFile
èèB M
(
èèM N
FAmateS2hCvt
èèN Z
,
èèZ [
ExpireIssuedDate
èè\ l
,
èèl m
fileName
èèn v
,
èèv w
string
èèx ~
.
èè~ 
Emptyèè „
)èè„ …
;èè… †

m_fLicInfo
éé 
.
éé 

fLicS2hCvt
éé %
.
éé% &
macAddresscheck
éé& 5
=
éé6 7
(
éé8 9
FYesNo
éé9 ?
)
éé? @
Enum
éé@ D
.
ééD E
Parse
ééE J
(
ééJ K
typeof
ééK Q
(
ééQ R
FYesNo
ééR X
)
ééX Y
,
ééY Z
FIniFile
éé[ c
.
ééc d
readIniFile
ééd o
(
ééo p
FAmateS2hCvt
éép |
,
éé| }
MacAddressCheckéé~ 
,éé 
fileNameéé —
,éé— ˜
FYesNoéé™ Ÿ
.ééŸ  
Noéé  ¢
.éé¢ £
ToStringéé£ «
(éé« ¬
)éé¬ ­
)éé­ ®
)éé® ¯
;éé¯ °

m_fLicInfo
êê 
.
êê 

fLicS2hCvt
êê %
.
êê% &

macAddress
êê& 0
=
êê1 2
FIniFile
êê3 ;
.
êê; <
readIniFile
êê< G
(
êêG H
FAmateS2hCvt
êêH T
,
êêT U

MacAddress
êêV `
,
êê` a
fileName
êêb j
,
êêj k
string
êêl r
.
êêr s
Empty
êês x
)
êêx y
;
êêy z
return
îî 

m_fLicInfo
îî !
;
îî! "
}
ïï 
catch
ğğ 
(
ğğ 
	Exception
ğğ 
ex
ğğ 
)
ğğ  
{
ññ 
FDebug
òò 
.
òò 
throwException
òò %
(
òò% &
ex
òò& (
)
òò( )
;
òò) *
}
óó 
finally
ôô 
{
õõ 
if
öö 
(
öö 
sr
öö 
!=
öö 
null
öö 
)
öö 
{
÷÷ 
sr
øø 
.
øø 
Close
øø 
(
øø 
)
øø 
;
øø 
sr
ùù 
.
ùù 
Dispose
ùù 
(
ùù 
)
ùù  
;
ùù  !
sr
úú 
=
úú 
null
úú 
;
úú 
}
ûû 
}
üü 
return
ıı 
null
ıı 
;
ıı 
}
şş 	
public
‚‚ 
bool
‚‚  
validateMacAddress
‚‚ &
(
‚‚& '
string
ƒƒ 
macAddressString
ƒƒ #
)
„„ 
{
…… 	
try
†† 
{
‡‡ 
foreach
ˆˆ 
(
ˆˆ 
string
ˆˆ 
s
ˆˆ  !
in
ˆˆ" $
FUserPCInfo
ˆˆ% 0
.
ˆˆ0 1
MacAddressList
ˆˆ1 ?
(
ˆˆ? @
)
ˆˆ@ A
)
ˆˆA B
{
‰‰ 
if
ŠŠ 
(
ŠŠ 
macAddressString
ŠŠ (
.
ŠŠ( )
Contains
ŠŠ) 1
(
ŠŠ1 2
s
ŠŠ2 3
)
ŠŠ3 4
)
ŠŠ4 5
{
‹‹ 
return
ŒŒ 
true
ŒŒ #
;
ŒŒ# $
}
 
}
 
return
 
false
 
;
 
}
 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘ 
ex
‘‘ 
)
‘‘  
{
’’ 
FDebug
““ 
.
““ 
throwException
““ %
(
““% &
ex
““& (
)
““( )
;
““) *
}
”” 
finally
•• 
{
–– 
}
˜˜ 
return
™™ 
false
™™ 
;
™™ 
}
šš 	
public
 
bool
 %
validateExpireIssueDate
 +
(
+ ,
string
ŸŸ 

expireDate
ŸŸ 
)
   
{
¡¡ 	
try
¢¢ 
{
££ 
if
¤¤ 
(
¤¤ 

expireDate
¤¤ 
.
¤¤ 
	CompareTo
¤¤ (
(
¤¤( )
DateTime
¤¤) 1
.
¤¤1 2
Now
¤¤2 5
.
¤¤5 6
ToString
¤¤6 >
(
¤¤> ?
$str
¤¤? I
)
¤¤I J
)
¤¤J K
<
¤¤L M
$num
¤¤N O
)
¤¤O P
{
¥¥ 
return
¦¦ 
false
¦¦  
;
¦¦  !
}
§§ 
return
¨¨ 
true
¨¨ 
;
¨¨ 
}
©© 
catch
ªª 
(
ªª 
	Exception
ªª 
ex
ªª 
)
ªª  
{
«« 
FDebug
¬¬ 
.
¬¬ 
throwException
¬¬ %
(
¬¬% &
ex
¬¬& (
)
¬¬( )
;
¬¬) *
}
­­ 
finally
®® 
{
¯¯ 
}
±± 
return
²² 
false
²² 
;
²² 
}
³³ 	
public
·· 
void
·· "
rasieValidationError
·· (
(
··( )
string
¸¸ 
step
¸¸ 
)
¹¹ 
{
ºº 	
if
»» 
(
»» 
step
»» 
==
»» 
string
»» 
.
»» 
Empty
»» $
)
»»$ %
{
¼¼ 
FDebug
½½ 
.
½½ 
throwFException
½½ &
(
½½& '

FConstants
½½' 1
.
½½1 2

err_m_0022
½½2 <
)
½½< =
;
½½= >
}
¾¾ 
FDebug
¿¿ 
.
¿¿ 
throwFException
¿¿ "
(
¿¿" #

FConstants
¿¿# -
.
¿¿- .

err_m_0022
¿¿. 8
+
¿¿9 :
$str
¿¿; ?
+
¿¿@ A
step
¿¿B F
+
¿¿G H
$str
¿¿I L
)
¿¿L M
;
¿¿M N
}
ÀÀ 	
}
ÆÆ 
}ÇÇ Ìp
\D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Security\c_FLic2Info.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
	FLic2Info 
: 
IDisposable (
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private   
string   
m_licenseId   "
=  # $
string  % +
.  + ,
Empty  , 1
;  1 2
private!! 
string!! 
m_customerCompany!! (
=!!) *
string!!+ 1
.!!1 2
Empty!!2 7
;!!7 8
private"" 
string"" 
m_customerSite"" %
=""& '
string""( .
."". /
Empty""/ 4
;""4 5
private## 
string## 
m_productTitle## %
=##& '
string##( .
.##. /
Empty##/ 4
;##4 5
private$$ 
string$$ 
m_productVersion$$ '
=$$( )
string$$* 0
.$$0 1
Empty$$1 6
;$$6 7
private&& 
FLic2Common&& 

m_fLicSecs&& &
=&&' (
null&&) -
;&&- .
private'' 
FLic2Common'' 
	m_fLicOpc'' %
=''& '
null''( ,
;'', -
private(( 
FLic2Common(( 
	m_fLicTcp(( %
=((& '
null((( ,
;((, -
private)) 
FLic2Common)) 
	m_fLicAdm)) %
=))& '
null))( ,
;)), -
private** 
FLic2AdminService** !
	m_fLicAds**" +
=**, -
null**. 2
;**2 3
private++ 
FLic2Common++ 
m_fLicS2hCvt++ (
=++) *
null+++ /
;++/ 0
public11 
	FLic2Info11 
(11 
)22 
{33 	

m_fLicSecs44 
=44 
new44 
FLic2Common44 (
(44( )
)44) *
;44* +
	m_fLicOpc55 
=55 
new55 
FLic2Common55 '
(55' (
)55( )
;55) *
	m_fLicTcp66 
=66 
new66 
FLic2Common66 '
(66' (
)66( )
;66) *
	m_fLicAdm77 
=77 
new77 
FLic2Common77 '
(77' (
)77( )
;77) *
	m_fLicAds88 
=88 
new88 
FLic2AdminService88 -
(88- .
)88. /
;88/ 0
m_fLicS2hCvt99 
=99 
new99 
FLic2Common99 *
(99* +
)99+ ,
;99, -
}:: 	
~>> 	
	FLic2Info>>	 
(>> 
)?? 
{@@ 	
	myDisposeAA 
(AA 
falseAA 
)AA 
;AA 
}BB 	
	protectedFF 
voidFF 
	myDisposeFF  
(FF  !
boolGG 
	disposingGG 
)HH 
{II 	
ifJJ 
(JJ 
!JJ 

m_disposedJJ 
)JJ 
{KK 
ifLL 
(LL 
	disposingLL 
)LL 
{MM 

m_fLicSecsNN 
=NN  
nullNN! %
;NN% &
	m_fLicOpcOO 
=OO 
nullOO  $
;OO$ %
	m_fLicTcpPP 
=PP 
nullPP  $
;PP$ %
	m_fLicAdmQQ 
=QQ 
nullQQ  $
;QQ$ %
	m_fLicAdsRR 
=RR 
nullRR  $
;RR$ %
m_fLicS2hCvtSS  
=SS! "
nullSS# '
;SS' (
}TT 

m_disposedUU 
=UU 
trueUU !
;UU! "
}VV 
}WW 	
public__ 
void__ 
Dispose__ 
(__ 
)`` 
{aa 	
	myDisposebb 
(bb 
truebb 
)bb 
;bb 
GCcc 
.cc 
SuppressFinalizecc 
(cc  
thiscc  $
)cc$ %
;cc% &
}dd 	
publicll 
stringll 
	licenseIdll 
{mm 	
getnn 
{oo 
trypp 
{qq 
returnrr 
m_licenseIdrr &
;rr& '
}ss 
catchtt 
(tt 
	Exceptiontt  
extt! #
)tt# $
{uu 
FDebugvv 
.vv 
throwExceptionvv )
(vv) *
exvv* ,
)vv, -
;vv- .
}ww 
finallyxx 
{yy 
}{{ 
return|| 
string|| 
.|| 
Empty|| #
;||# $
}}} 
internal 
set 
{
€€ 
try
 
{
‚‚ 
m_licenseId
ƒƒ 
=
ƒƒ  !
value
ƒƒ" '
;
ƒƒ' (
}
„„ 
catch
…… 
(
…… 
	Exception
……  
ex
……! #
)
……# $
{
†† 
FDebug
‡‡ 
.
‡‡ 
throwException
‡‡ )
(
‡‡) *
ex
‡‡* ,
)
‡‡, -
;
‡‡- .
}
ˆˆ 
finally
‰‰ 
{
ŠŠ 
}
ŒŒ 
}
 
}
 	
public
’’ 
string
’’ 
customerCompany
’’ %
{
““ 	
get
”” 
{
•• 
try
–– 
{
—— 
return
˜˜ 
m_customerCompany
˜˜ ,
;
˜˜, -
}
™™ 
catch
šš 
(
šš 
	Exception
šš  
ex
šš! #
)
šš# $
{
›› 
FDebug
œœ 
.
œœ 
throwException
œœ )
(
œœ) *
ex
œœ* ,
)
œœ, -
;
œœ- .
}
 
finally
 
{
ŸŸ 
}
¡¡ 
return
¢¢ 
string
¢¢ 
.
¢¢ 
Empty
¢¢ #
;
¢¢# $
}
££ 
internal
¥¥ 
set
¥¥ 
{
¦¦ 
try
§§ 
{
¨¨ 
m_customerCompany
©© %
=
©©& '
value
©©( -
;
©©- .
}
ªª 
catch
«« 
(
«« 
	Exception
««  
ex
««! #
)
««# $
{
¬¬ 
FDebug
­­ 
.
­­ 
throwException
­­ )
(
­­) *
ex
­­* ,
)
­­, -
;
­­- .
}
®® 
finally
¯¯ 
{
°° 
}
²² 
}
³³ 
}
´´ 	
public
¸¸ 
string
¸¸ 
customerSite
¸¸ "
{
¹¹ 	
get
ºº 
{
»» 
try
¼¼ 
{
½½ 
return
¾¾ 
m_customerSite
¾¾ )
;
¾¾) *
}
¿¿ 
catch
ÀÀ 
(
ÀÀ 
	Exception
ÀÀ  
ex
ÀÀ! #
)
ÀÀ# $
{
ÁÁ 
FDebug
ÂÂ 
.
ÂÂ 
throwException
ÂÂ )
(
ÂÂ) *
ex
ÂÂ* ,
)
ÂÂ, -
;
ÂÂ- .
}
ÃÃ 
finally
ÄÄ 
{
ÅÅ 
}
ÇÇ 
return
ÈÈ 
string
ÈÈ 
.
ÈÈ 
Empty
ÈÈ #
;
ÈÈ# $
}
ÉÉ 
internal
ËË 
set
ËË 
{
ÌÌ 
try
ÍÍ 
{
ÎÎ 
m_customerSite
ÏÏ "
=
ÏÏ# $
value
ÏÏ% *
;
ÏÏ* +
}
ĞĞ 
catch
ÑÑ 
(
ÑÑ 
	Exception
ÑÑ  
ex
ÑÑ! #
)
ÑÑ# $
{
ÒÒ 
FDebug
ÓÓ 
.
ÓÓ 
throwException
ÓÓ )
(
ÓÓ) *
ex
ÓÓ* ,
)
ÓÓ, -
;
ÓÓ- .
}
ÔÔ 
finally
ÕÕ 
{
ÖÖ 
}
ØØ 
}
ÙÙ 
}
ÚÚ 	
public
ŞŞ 
string
ŞŞ 
productTitle
ŞŞ "
{
ßß 	
get
àà 
{
áá 
try
ââ 
{
ãã 
return
ää 
m_productTitle
ää )
;
ää) *
}
åå 
catch
ææ 
(
ææ 
	Exception
ææ  
ex
ææ! #
)
ææ# $
{
çç 
FDebug
èè 
.
èè 
throwException
èè )
(
èè) *
ex
èè* ,
)
èè, -
;
èè- .
}
éé 
finally
êê 
{
ëë 
}
íí 
return
îî 
string
îî 
.
îî 
Empty
îî #
;
îî# $
}
ïï 
internal
ññ 
set
ññ 
{
òò 
try
óó 
{
ôô 
m_productTitle
õõ "
=
õõ# $
value
õõ% *
;
õõ* +
}
öö 
catch
÷÷ 
(
÷÷ 
	Exception
÷÷  
ex
÷÷! #
)
÷÷# $
{
øø 
FDebug
ùù 
.
ùù 
throwException
ùù )
(
ùù) *
ex
ùù* ,
)
ùù, -
;
ùù- .
}
úú 
finally
ûû 
{
üü 
}
şş 
}
ÿÿ 
}
€€ 	
public
„„ 
string
„„ 
productVersion
„„ $
{
…… 	
get
†† 
{
‡‡ 
try
ˆˆ 
{
‰‰ 
return
ŠŠ 
m_productVersion
ŠŠ +
;
ŠŠ+ ,
}
‹‹ 
catch
ŒŒ 
(
ŒŒ 
	Exception
ŒŒ  
ex
ŒŒ! #
)
ŒŒ# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
 
{
‘‘ 
}
““ 
return
”” 
string
”” 
.
”” 
Empty
”” #
;
””# $
}
•• 
internal
—— 
set
—— 
{
˜˜ 
try
™™ 
{
šš 
m_productVersion
›› $
=
››% &
value
››' ,
;
››, -
}
œœ 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
ŸŸ 
.
ŸŸ 
throwException
ŸŸ )
(
ŸŸ) *
ex
ŸŸ* ,
)
ŸŸ, -
;
ŸŸ- .
}
   
finally
¡¡ 
{
¢¢ 
}
¤¤ 
}
¥¥ 
}
¦¦ 	
public
ªª 
FLic2Common
ªª 
fLicSecs
ªª #
{
«« 	
get
¬¬ 
{
­­ 
try
®® 
{
¯¯ 
return
°° 

m_fLicSecs
°° %
;
°°% &
}
±± 
catch
²² 
(
²² 
	Exception
²²  
ex
²²! #
)
²²# $
{
³³ 
FDebug
´´ 
.
´´ 
throwException
´´ )
(
´´) *
ex
´´* ,
)
´´, -
;
´´- .
}
µµ 
finally
¶¶ 
{
·· 
}
¹¹ 
return
ºº 
null
ºº 
;
ºº 
}
»» 
}
¼¼ 	
public
ÀÀ 
FLic2Common
ÀÀ 
fLicOpc
ÀÀ "
{
ÁÁ 	
get
ÂÂ 
{
ÃÃ 
try
ÄÄ 
{
ÅÅ 
return
ÆÆ 
	m_fLicOpc
ÆÆ $
;
ÆÆ$ %
}
ÇÇ 
catch
ÈÈ 
(
ÈÈ 
	Exception
ÈÈ  
ex
ÈÈ! #
)
ÈÈ# $
{
ÉÉ 
FDebug
ÊÊ 
.
ÊÊ 
throwException
ÊÊ )
(
ÊÊ) *
ex
ÊÊ* ,
)
ÊÊ, -
;
ÊÊ- .
}
ËË 
finally
ÌÌ 
{
ÍÍ 
}
ÏÏ 
return
ĞĞ 
null
ĞĞ 
;
ĞĞ 
}
ÑÑ 
}
ÒÒ 	
public
ÖÖ 
FLic2Common
ÖÖ 
fLicTcp
ÖÖ "
{
×× 	
get
ØØ 
{
ÙÙ 
try
ÚÚ 
{
ÛÛ 
return
ÜÜ 
	m_fLicTcp
ÜÜ $
;
ÜÜ$ %
}
İİ 
catch
ŞŞ 
(
ŞŞ 
	Exception
ŞŞ  
ex
ŞŞ! #
)
ŞŞ# $
{
ßß 
FDebug
àà 
.
àà 
throwException
àà )
(
àà) *
ex
àà* ,
)
àà, -
;
àà- .
}
áá 
finally
ââ 
{
ãã 
}
åå 
return
ææ 
null
ææ 
;
ææ 
}
çç 
}
èè 	
public
ìì 
FLic2Common
ìì 
fLicAdm
ìì "
{
íí 	
get
îî 
{
ïï 
try
ğğ 
{
ññ 
return
òò 
	m_fLicAdm
òò $
;
òò$ %
}
óó 
catch
ôô 
(
ôô 
	Exception
ôô  
ex
ôô! #
)
ôô# $
{
õõ 
FDebug
öö 
.
öö 
throwException
öö )
(
öö) *
ex
öö* ,
)
öö, -
;
öö- .
}
÷÷ 
finally
øø 
{
ùù 
}
ûû 
return
üü 
null
üü 
;
üü 
}
ıı 
}
şş 	
public
‚‚ 
FLic2AdminService
‚‚  
fLicAds
‚‚! (
{
ƒƒ 	
get
„„ 
{
…… 
try
†† 
{
‡‡ 
return
ˆˆ 
	m_fLicAds
ˆˆ $
;
ˆˆ$ %
}
‰‰ 
catch
ŠŠ 
(
ŠŠ 
	Exception
ŠŠ  
ex
ŠŠ! #
)
ŠŠ# $
{
‹‹ 
FDebug
ŒŒ 
.
ŒŒ 
throwException
ŒŒ )
(
ŒŒ) *
ex
ŒŒ* ,
)
ŒŒ, -
;
ŒŒ- .
}
 
finally
 
{
 
}
‘‘ 
return
’’ 
null
’’ 
;
’’ 
}
““ 
}
”” 	
public
˜˜ 
FLic2Common
˜˜ 

fLicS2hCvt
˜˜ %
{
™™ 	
get
šš 
{
›› 
try
œœ 
{
 
return
 
m_fLicS2hCvt
 '
;
' (
}
ŸŸ 
catch
   
(
   
	Exception
    
ex
  ! #
)
  # $
{
¡¡ 
FDebug
¢¢ 
.
¢¢ 
throwException
¢¢ )
(
¢¢) *
ex
¢¢* ,
)
¢¢, -
;
¢¢- .
}
££ 
finally
¤¤ 
{
¥¥ 
}
§§ 
return
¨¨ 
null
¨¨ 
;
¨¨ 
}
©© 
}
ªª 	
}
¶¶ 
}·· ÉM
^D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Security\c_FLic2Common.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FLic2Common 
: 
IDisposable *
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private   
FYesNo   
m_productEnabled   '
=  ( )
FYesNo  * 0
.  0 1
No  1 3
;  3 4
private!! 
FYesNo!! 
m_networkDeployed!! (
=!!) *
FYesNo!!+ 1
.!!1 2
No!!2 4
;!!4 5
private"" 
FYesNo"" 
m_expireIssuedCheck"" *
=""+ ,
FYesNo""- 3
.""3 4
No""4 6
;""6 7
private## 
string## 
m_expireIssuedDate## )
=##* +
string##, 2
.##2 3
Empty##3 8
;##8 9
private$$ 
FYesNo$$ 
m_macAddresscheck$$ (
=$$) *
FYesNo$$+ 1
.$$1 2
No$$2 4
;$$4 5
private%% 
string%% 
m_macAddress%% #
=%%$ %
string%%& ,
.%%, -
Empty%%- 2
;%%2 3
public++ 
FLic2Common++ 
(++ 
),, 
{-- 	
}// 	
~33 	
FLic2Common33	 
(33 
)44 
{55 	
	myDispose66 
(66 
false66 
)66 
;66 
}77 	
	protected;; 
virtual;; 
void;; 
	myDispose;; (
(;;( )
bool<< 
	disposing<< 
)== 
{>> 	
if?? 
(?? 
!?? 

m_disposed?? 
)?? 
{@@ 
ifAA 
(AA 
	disposingAA 
)AA 
{BB 
}DD 

m_disposedEE 
=EE 
trueEE !
;EE! "
}FF 
}GG 	
publicOO 
voidOO 
DisposeOO 
(OO 
)PP 
{QQ 	
	myDisposeRR 
(RR 
trueRR 
)RR 
;RR 
GCSS 
.SS 
SuppressFinalizeSS 
(SS  
thisSS  $
)SS$ %
;SS% &
}TT 	
public\\ 
FYesNo\\ 
productEnabled\\ $
{]] 	
get^^ 
{__ 
try`` 
{aa 
returnbb 
m_productEnabledbb +
;bb+ ,
}cc 
catchdd 
(dd 
	Exceptiondd  
exdd! #
)dd# $
{ee 
FDebugff 
.ff 
throwExceptionff )
(ff) *
exff* ,
)ff, -
;ff- .
}gg 
finallyhh 
{ii 
}kk 
returnll 
FYesNoll 
.ll 
Noll  
;ll  !
}mm 
internaloo 
setoo 
{pp 
tryqq 
{rr 
m_productEnabledss $
=ss% &
valuess' ,
;ss, -
}tt 
catchuu 
(uu 
	Exceptionuu  
exuu! #
)uu# $
{vv 
FDebugww 
.ww 
throwExceptionww )
(ww) *
exww* ,
)ww, -
;ww- .
}xx 
finallyyy 
{zz 
}|| 
}}} 
}~~ 	
public
‚‚ 
FYesNo
‚‚ 
networkDeployed
‚‚ %
{
ƒƒ 	
get
„„ 
{
…… 
try
†† 
{
‡‡ 
return
ˆˆ 
m_networkDeployed
ˆˆ ,
;
ˆˆ, -
}
‰‰ 
catch
ŠŠ 
(
ŠŠ 
	Exception
ŠŠ  
ex
ŠŠ! #
)
ŠŠ# $
{
‹‹ 
FDebug
ŒŒ 
.
ŒŒ 
throwException
ŒŒ )
(
ŒŒ) *
ex
ŒŒ* ,
)
ŒŒ, -
;
ŒŒ- .
}
 
finally
 
{
 
}
‘‘ 
return
’’ 
FYesNo
’’ 
.
’’ 
No
’’  
;
’’  !
}
““ 
internal
•• 
set
•• 
{
–– 
try
—— 
{
˜˜ 
m_networkDeployed
™™ %
=
™™& '
value
™™( -
;
™™- .
}
šš 
catch
›› 
(
›› 
	Exception
››  
ex
››! #
)
››# $
{
œœ 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
ŸŸ 
{
   
}
¢¢ 
}
££ 
}
¤¤ 	
public
¨¨ 
FYesNo
¨¨ 
expireIssuedCheck
¨¨ '
{
©© 	
get
ªª 
{
«« 
try
¬¬ 
{
­­ 
return
®® !
m_expireIssuedCheck
®® .
;
®®. /
}
¯¯ 
catch
°° 
(
°° 
	Exception
°°  
ex
°°! #
)
°°# $
{
±± 
FDebug
²² 
.
²² 
throwException
²² )
(
²²) *
ex
²²* ,
)
²², -
;
²²- .
}
³³ 
finally
´´ 
{
µµ 
}
·· 
return
¸¸ 
FYesNo
¸¸ 
.
¸¸ 
No
¸¸  
;
¸¸  !
}
¹¹ 
internal
»» 
set
»» 
{
¼¼ 
try
½½ 
{
¾¾ !
m_expireIssuedCheck
¿¿ '
=
¿¿( )
value
¿¿* /
;
¿¿/ 0
}
ÀÀ 
catch
ÁÁ 
(
ÁÁ 
	Exception
ÁÁ  
ex
ÁÁ! #
)
ÁÁ# $
{
ÂÂ 
FDebug
ÃÃ 
.
ÃÃ 
throwException
ÃÃ )
(
ÃÃ) *
ex
ÃÃ* ,
)
ÃÃ, -
;
ÃÃ- .
}
ÄÄ 
finally
ÅÅ 
{
ÆÆ 
}
ÈÈ 
}
ÉÉ 
}
ÊÊ 	
public
ÎÎ 
string
ÎÎ 
expireIssuedDate
ÎÎ &
{
ÏÏ 	
get
ĞĞ 
{
ÑÑ 
try
ÒÒ 
{
ÓÓ 
return
ÔÔ  
m_expireIssuedDate
ÔÔ -
;
ÔÔ- .
}
ÕÕ 
catch
ÖÖ 
(
ÖÖ 
	Exception
ÖÖ  
ex
ÖÖ! #
)
ÖÖ# $
{
×× 
FDebug
ØØ 
.
ØØ 
throwException
ØØ )
(
ØØ) *
ex
ØØ* ,
)
ØØ, -
;
ØØ- .
}
ÙÙ 
finally
ÚÚ 
{
ÛÛ 
}
İİ 
return
ŞŞ 
string
ŞŞ 
.
ŞŞ 
Empty
ŞŞ #
;
ŞŞ# $
}
ßß 
internal
áá 
set
áá 
{
ââ 
try
ãã 
{
ää  
m_expireIssuedDate
åå &
=
åå' (
value
åå) .
;
åå. /
}
ææ 
catch
çç 
(
çç 
	Exception
çç  
ex
çç! #
)
çç# $
{
èè 
FDebug
éé 
.
éé 
throwException
éé )
(
éé) *
ex
éé* ,
)
éé, -
;
éé- .
}
êê 
finally
ëë 
{
ìì 
}
îî 
}
ïï 
}
ğğ 	
public
ôô 
FYesNo
ôô 
macAddresscheck
ôô %
{
õõ 	
get
öö 
{
÷÷ 
try
øø 
{
ùù 
return
úú 
m_macAddresscheck
úú ,
;
úú, -
}
ûû 
catch
üü 
(
üü 
	Exception
üü  
ex
üü! #
)
üü# $
{
ıı 
FDebug
şş 
.
şş 
throwException
şş )
(
şş) *
ex
şş* ,
)
şş, -
;
şş- .
}
ÿÿ 
finally
€€ 
{
 
}
ƒƒ 
return
„„ 
FYesNo
„„ 
.
„„ 
No
„„  
;
„„  !
}
…… 
internal
‡‡ 
set
‡‡ 
{
ˆˆ 
try
‰‰ 
{
ŠŠ 
m_macAddresscheck
‹‹ %
=
‹‹& '
value
‹‹( -
;
‹‹- .
}
ŒŒ 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
‘‘ 
{
’’ 
}
”” 
}
•• 
}
–– 	
public
šš 
string
šš 

macAddress
šš  
{
›› 	
get
œœ 
{
 
try
 
{
ŸŸ 
return
   
m_macAddress
   '
;
  ' (
}
¡¡ 
catch
¢¢ 
(
¢¢ 
	Exception
¢¢  
ex
¢¢! #
)
¢¢# $
{
££ 
FDebug
¤¤ 
.
¤¤ 
throwException
¤¤ )
(
¤¤) *
ex
¤¤* ,
)
¤¤, -
;
¤¤- .
}
¥¥ 
finally
¦¦ 
{
§§ 
}
©© 
return
ªª 
string
ªª 
.
ªª 
Empty
ªª #
;
ªª# $
}
«« 
internal
­­ 
set
­­ 
{
®® 
try
¯¯ 
{
°° 
m_macAddress
±±  
=
±±! "
value
±±# (
;
±±( )
}
²² 
catch
³³ 
(
³³ 
	Exception
³³  
ex
³³! #
)
³³# $
{
´´ 
FDebug
µµ 
.
µµ 
throwException
µµ )
(
µµ) *
ex
µµ* ,
)
µµ, -
;
µµ- .
}
¶¶ 
finally
·· 
{
¸¸ 
}
ºº 
}
»» 
}
¼¼ 	
}
ÈÈ 
}ÉÉ Å3
dD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Security\c_FLic2AdminService.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FLic2AdminService "
:# $
FLic2Common% 0
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private   
int   
m_eapRuntime    
=  ! "
$num  # $
;  $ %
private!! 
int!! 
m_equipmentRuntime!! &
=!!' (
$num!!) *
;!!* +
private"" 
int"" '
m_secs1HsmsConverterRuntime"" /
=""0 1
$num""2 3
;""3 4
private## 
int## 
m_opcTagRuntime## #
=##$ %
$num##& '
;##' (
public)) 
FLic2AdminService))  
())  !
)** 
{++ 	
}-- 	
~11 	
FLic2AdminService11	 
(11 
)22 
{33 	
	myDispose44 
(44 
false44 
)44 
;44 
}55 	
	protected99 
override99 
void99 
	myDispose99  )
(99) *
bool:: 
	disposing:: 
);; 
{<< 	
if== 
(== 
!== 

m_disposed== 
)== 
{>> 
if?? 
(?? 
	disposing?? 
)?? 
{@@ 
}BB 

m_disposedCC 
=CC 
trueCC !
;CC! "
}DD 
baseEE 
.EE 
	myDisposeEE 
(EE 
	disposingEE $
)EE$ %
;EE% &
}FF 	
publicNN 
intNN 

eapRuntimeNN 
{OO 	
getPP 
{QQ 
tryRR 
{SS 
returnTT 
m_eapRuntimeTT '
;TT' (
}UU 
catchVV 
(VV 
	ExceptionVV  
exVV! #
)VV# $
{WW 
FDebugXX 
.XX 
throwExceptionXX )
(XX) *
exXX* ,
)XX, -
;XX- .
}YY 
finallyZZ 
{[[ 
}]] 
return^^ 
$num^^ 
;^^ 
}__ 
internalaa 
setaa 
{bb 
trycc 
{dd 
m_eapRuntimeee  
=ee! "
valueee# (
;ee( )
}ff 
catchgg 
(gg 
	Exceptiongg  
exgg! #
)gg# $
{hh 
FDebugii 
.ii 
throwExceptionii )
(ii) *
exii* ,
)ii, -
;ii- .
}jj 
finallykk 
{ll 
}nn 
}oo 
}pp 	
publictt 
inttt 
equipmentRuntimett #
{uu 	
getvv 
{ww 
tryxx 
{yy 
returnzz 
m_equipmentRuntimezz -
;zz- .
}{{ 
catch|| 
(|| 
	Exception||  
ex||! #
)||# $
{}} 
FDebug~~ 
.~~ 
throwException~~ )
(~~) *
ex~~* ,
)~~, -
;~~- .
} 
finally
€€ 
{
 
}
ƒƒ 
return
„„ 
$num
„„ 
;
„„ 
}
…… 
internal
‡‡ 
set
‡‡ 
{
ˆˆ 
try
‰‰ 
{
ŠŠ  
m_equipmentRuntime
‹‹ &
=
‹‹' (
value
‹‹) .
;
‹‹. /
}
ŒŒ 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
‘‘ 
{
’’ 
}
”” 
}
•• 
}
–– 	
public
šš 
int
šš '
secs1HsmsConverterRuntime
šš ,
{
›› 	
get
œœ 
{
 
try
 
{
ŸŸ 
return
   )
m_secs1HsmsConverterRuntime
   6
;
  6 7
}
¡¡ 
catch
¢¢ 
(
¢¢ 
	Exception
¢¢  
ex
¢¢! #
)
¢¢# $
{
££ 
FDebug
¤¤ 
.
¤¤ 
throwException
¤¤ )
(
¤¤) *
ex
¤¤* ,
)
¤¤, -
;
¤¤- .
}
¥¥ 
finally
¦¦ 
{
§§ 
}
©© 
return
ªª 
$num
ªª 
;
ªª 
}
«« 
internal
­­ 
set
­­ 
{
®® 
try
¯¯ 
{
°° )
m_secs1HsmsConverterRuntime
±± /
=
±±0 1
value
±±2 7
;
±±7 8
}
²² 
catch
³³ 
(
³³ 
	Exception
³³  
ex
³³! #
)
³³# $
{
´´ 
FDebug
µµ 
.
µµ 
throwException
µµ )
(
µµ) *
ex
µµ* ,
)
µµ, -
;
µµ- .
}
¶¶ 
finally
·· 
{
¸¸ 
}
ºº 
}
»» 
}
¼¼ 	
public
ÀÀ 
int
ÀÀ 
opcTagRuntime
ÀÀ  
{
ÁÁ 	
get
ÂÂ 
{
ÃÃ 
try
ÄÄ 
{
ÅÅ 
return
ÆÆ 
m_opcTagRuntime
ÆÆ *
;
ÆÆ* +
}
ÇÇ 
catch
ÈÈ 
(
ÈÈ 
	Exception
ÈÈ  
ex
ÈÈ! #
)
ÈÈ# $
{
ÉÉ 
FDebug
ÊÊ 
.
ÊÊ 
throwException
ÊÊ )
(
ÊÊ) *
ex
ÊÊ* ,
)
ÊÊ, -
;
ÊÊ- .
}
ËË 
finally
ÌÌ 
{
ÍÍ 
}
ÏÏ 
return
ĞĞ 
$num
ĞĞ 
;
ĞĞ 
}
ÑÑ 
internal
ÓÓ 
set
ÓÓ 
{
ÔÔ 
try
ÕÕ 
{
ÖÖ 
m_opcTagRuntime
×× #
=
××$ %
value
××& +
;
××+ ,
}
ØØ 
catch
ÙÙ 
(
ÙÙ 
	Exception
ÙÙ  
ex
ÙÙ! #
)
ÙÙ# $
{
ÚÚ 
FDebug
ÛÛ 
.
ÛÛ 
throwException
ÛÛ )
(
ÛÛ) *
ex
ÛÛ* ,
)
ÛÛ, -
;
ÛÛ- .
}
ÜÜ 
finally
İİ 
{
ŞŞ 
}
àà 
}
áá 
}
ââ 	
}
îî 
}ïï ¯•
SD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Zip\c_F7Zip.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

static 
class 
F7Zip 
{ 
static 
F7Zip 
( 
) 
{   	
}"" 	
public00 
static00 
void00 
pack00 
(00  
string11 
zipName11 
,11 
string22 
[22 
]22 
source22 
)33 
{44 	
SevenZipCompressor55 
cmp55 "
=55# $
null55% )
;55) *
try77 
{88 
if99 
(99 
Environment99 
.99  
Is64BitProcess99  .
)99. /
{:: 
SevenZipCompressor;; &
.;;& '
SetLibraryPath;;' 5
(;;5 6
Path;;6 :
.;;: ;
Combine;;; B
(;;B C
	AppDomain;;C L
.;;L M
CurrentDomain;;M Z
.;;Z [
BaseDirectory;;[ h
,;;h i
$str;;j t
);;t u
);;u v
;;;v w
}<< 
cmp@@ 
=@@ 
new@@ 
SevenZipCompressor@@ ,
(@@, -
)@@- .
;@@. /
cmpBB 
.BB 
ArchiveFormatBB !
=BB" #
OutArchiveFormatBB$ 4
.BB4 5
ZipBB5 8
;BB8 9
cmpCC 
.CC 
CompressionMethodCC %
=CC& '
SevenZipCC( 0
.CC0 1
CompressionMethodCC1 B
.CCB C
	Deflate64CCC L
;CCL M
cmpDD 
.DD 
CompressionLevelDD $
=DD% &
CompressionLevelDD' 7
.DD7 8
FastDD8 <
;DD< =
cmpHH 
.HH 
CompressFilesHH !
(HH! "
zipNameHH" )
,HH) *
sourceHH+ 1
)HH1 2
;HH2 3
}II 
catchJJ 
(JJ 
	ExceptionJJ 
exJJ 
)JJ  
{KK 
FDebugLL 
.LL 
throwExceptionLL %
(LL% &
exLL& (
)LL( )
;LL) *
}MM 
finallyNN 
{OO 
cmpPP 
=PP 
nullPP 
;PP 
}QQ 
}RR 	
publicVV 
staticVV 
voidVV 
packVV 
(VV  
stringWW 
zipNameWW 
,WW 
stringXX 
sourceXX 
)YY 
{ZZ 	
SevenZipCompressor[[ 
cmp[[ "
=[[# $
null[[% )
;[[) *
try]] 
{^^ 
if__ 
(__ 
Environment__ 
.__  
Is64BitProcess__  .
)__. /
{`` 
SevenZipCompressoraa &
.aa& '
SetLibraryPathaa' 5
(aa5 6
Pathaa6 :
.aa: ;
Combineaa; B
(aaB C
	AppDomainaaC L
.aaL M
CurrentDomainaaM Z
.aaZ [
BaseDirectoryaa[ h
,aah i
$straaj t
)aat u
)aau v
;aav w
}bb 
cmpff 
=ff 
newff 
SevenZipCompressorff ,
(ff, -
)ff- .
;ff. /
cmphh 
.hh 
ArchiveFormathh !
=hh" #
OutArchiveFormathh$ 4
.hh4 5
Ziphh5 8
;hh8 9
cmpii 
.ii 
CompressionMethodii %
=ii& '
SevenZipii( 0
.ii0 1
CompressionMethodii1 B
.iiB C
	Deflate64iiC L
;iiL M
cmpjj 
.jj 
CompressionLeveljj $
=jj% &
CompressionLeveljj' 7
.jj7 8
Fastjj8 <
;jj< =
cmpnn 
.nn 
CompressFilesnn !
(nn! "
zipNamenn" )
,nn) *
newnn+ .
stringnn/ 5
[nn5 6
]nn6 7
{nn8 9
sourcenn: @
}nnA B
)nnB C
;nnC D
}oo 
catchpp 
(pp 
	Exceptionpp 
expp 
)pp  
{qq 
FDebugrr 
.rr 
throwExceptionrr %
(rr% &
exrr& (
)rr( )
;rr) *
}ss 
finallytt 
{uu 
cmpvv 
=vv 
nullvv 
;vv 
}ww 
}xx 	
public|| 
static|| 
void|| 
unpack|| !
(||! "
string}} 
zipName}} 
,}} 
string~~ 
	targetDir~~ 
) 
{
€€ 	
SevenZipExtractor
 
extr
 "
=
# $
null
% )
;
) *
try
ƒƒ 
{
„„ 
if
…… 
(
…… 
Environment
…… 
.
……  
Is64BitProcess
……  .
)
……. /
{
†† 
SevenZipExtractor
‡‡ %
.
‡‡% &
SetLibraryPath
‡‡& 4
(
‡‡4 5
Path
‡‡5 9
.
‡‡9 :
Combine
‡‡: A
(
‡‡A B
	AppDomain
‡‡B K
.
‡‡K L
CurrentDomain
‡‡L Y
.
‡‡Y Z
BaseDirectory
‡‡Z g
,
‡‡g h
$str
‡‡i s
)
‡‡s t
)
‡‡t u
;
‡‡u v
}
ˆˆ 
extr
ŒŒ 
=
ŒŒ 
new
ŒŒ 
SevenZipExtractor
ŒŒ ,
(
ŒŒ, -
zipName
ŒŒ- 4
)
ŒŒ4 5
;
ŒŒ5 6
extr
 
.
 
ExtractArchive
 #
(
# $
	targetDir
$ -
)
- .
;
. /
}
‘‘ 
catch
’’ 
(
’’ 
	Exception
’’ 
ex
’’ 
)
’’  
{
““ 
FDebug
”” 
.
”” 
throwException
”” %
(
””% &
ex
””& (
)
””( )
;
””) *
}
•• 
finally
–– 
{
—— 
if
˜˜ 
(
˜˜ 
extr
˜˜ 
!=
˜˜ 
null
˜˜  
)
˜˜  !
{
™™ 
extr
šš 
.
šš 
Dispose
šš  
(
šš  !
)
šš! "
;
šš" #
extr
›› 
=
›› 
null
›› 
;
››  
}
œœ 
}
 
}
 	
public
¢¢ 
static
¢¢ !
FZipEntryCollection
¢¢ )!
fZipEntryCollection
¢¢* =
(
¢¢= >
string
££ 
zipName
££ 
)
¤¤ 
{
¥¥ 	

Dictionary
¦¦ 
<
¦¦ 
string
¦¦ 
,
¦¦ 
	FZipEntry
¦¦ (
>
¦¦( )
	entryDict
¦¦* 3
=
¦¦4 5
null
¦¦6 :
;
¦¦: ;
List
§§ 
<
§§ 
	FZipEntry
§§ 
>
§§ 
	entryList
§§ %
=
§§& '
null
§§( ,
;
§§, -
	FZipEntry
¨¨ 
fze
¨¨ 
=
¨¨ 
null
¨¨  
;
¨¨  !
try
ªª 
{
«« 
	entryDict
¬¬ 
=
¬¬ 
new
¬¬ 

Dictionary
¬¬  *
<
¬¬* +
string
¬¬+ 1
,
¬¬1 2
	FZipEntry
¬¬3 <
>
¬¬< =
(
¬¬= >
)
¬¬> ?
;
¬¬? @
	entryList
­­ 
=
­­ 
new
­­ 
List
­­  $
<
­­$ %
	FZipEntry
­­% .
>
­­. /
(
­­/ 0
)
­­0 1
;
­­1 2
if
¯¯ 
(
¯¯ 
Environment
¯¯ 
.
¯¯  
Is64BitProcess
¯¯  .
)
¯¯. /
{
°° 
SevenZipExtractor
±± %
.
±±% &
SetLibraryPath
±±& 4
(
±±4 5
Path
±±5 9
.
±±9 :
Combine
±±: A
(
±±A B
	AppDomain
±±B K
.
±±K L
CurrentDomain
±±L Y
.
±±Y Z
BaseDirectory
±±Z g
,
±±g h
$str
±±i s
)
±±s t
)
±±t u
;
±±u v
}
²² 
using
¶¶ 
(
¶¶ 
SevenZipExtractor
¶¶ (
extr
¶¶) -
=
¶¶. /
new
¶¶0 3
SevenZipExtractor
¶¶4 E
(
¶¶E F
File
¶¶F J
.
¶¶J K
OpenRead
¶¶K S
(
¶¶S T
zipName
¶¶T [
)
¶¶[ \
)
¶¶\ ]
)
¶¶] ^
{
·· 
foreach
¸¸ 
(
¸¸ 
ArchiveFileInfo
¸¸ ,
fi
¸¸- /
in
¸¸0 2
extr
¸¸3 7
.
¸¸7 8
ArchiveFileData
¸¸8 G
)
¸¸G H
{
¹¹ 
fze
ºº 
=
ºº 
new
ºº !
	FZipEntry
ºº" +
(
ºº+ ,
fi
ºº, .
.
ºº. /
FileName
ºº/ 7
)
ºº7 8
;
ºº8 9
fze
»» 
.
»» 
creationTime
»» (
=
»») *
fi
»»+ -
.
»»- .
CreationTime
»». :
;
»»: ;
fze
¼¼ 
.
¼¼ 
lastWriteTime
¼¼ )
=
¼¼* +
fi
¼¼, .
.
¼¼. /
LastWriteTime
¼¼/ <
;
¼¼< =
fze
½½ 
.
½½ 
lastAccessTime
½½ *
=
½½+ ,
fi
½½- /
.
½½/ 0
LastAccessTime
½½0 >
;
½½> ?
fze
¾¾ 
.
¾¾ 
size
¾¾  
=
¾¾! "
(
¾¾# $
long
¾¾$ (
)
¾¾( )
fi
¾¾) +
.
¾¾+ ,
Size
¾¾, 0
;
¾¾0 1
if
ÀÀ 
(
ÀÀ 
!
ÀÀ 
	entryDict
ÀÀ &
.
ÀÀ& '
ContainsKey
ÀÀ' 2
(
ÀÀ2 3
fze
ÀÀ3 6
.
ÀÀ6 7
name
ÀÀ7 ;
)
ÀÀ; <
)
ÀÀ< =
{
ÁÁ 
	entryDict
ÂÂ %
.
ÂÂ% &
Add
ÂÂ& )
(
ÂÂ) *
fze
ÂÂ* -
.
ÂÂ- .
name
ÂÂ. 2
,
ÂÂ2 3
fze
ÂÂ4 7
)
ÂÂ7 8
;
ÂÂ8 9
	entryList
ÃÃ %
.
ÃÃ% &
Add
ÃÃ& )
(
ÃÃ) *
fze
ÃÃ* -
)
ÃÃ- .
;
ÃÃ. /
}
ÄÄ 
}
ÅÅ 
}
ÆÆ 
return
ÊÊ 
new
ÊÊ !
FZipEntryCollection
ÊÊ .
(
ÊÊ. /
	entryDict
ÊÊ/ 8
,
ÊÊ8 9
	entryList
ÊÊ: C
)
ÊÊC D
;
ÊÊD E
}
ËË 
catch
ÌÌ 
(
ÌÌ 
	Exception
ÌÌ 
ex
ÌÌ 
)
ÌÌ  
{
ÍÍ 
FDebug
ÎÎ 
.
ÎÎ 
throwException
ÎÎ %
(
ÎÎ% &
ex
ÎÎ& (
)
ÎÎ( )
;
ÎÎ) *
}
ÏÏ 
finally
ĞĞ 
{
ÑÑ 
	entryDict
ÒÒ 
=
ÒÒ 
null
ÒÒ  
;
ÒÒ  !
	entryList
ÓÓ 
=
ÓÓ 
null
ÓÓ  
;
ÓÓ  !
fze
ÔÔ 
=
ÔÔ 
null
ÔÔ 
;
ÔÔ 
}
ÕÕ 
return
ÖÖ 
null
ÖÖ 
;
ÖÖ 
}
×× 	
public
ÛÛ 
static
ÛÛ 
string
ÛÛ 
compress
ÛÛ %
(
ÛÛ% &
string
ÜÜ 
source
ÜÜ 
)
İİ 
{
ŞŞ 	
byte
ßß 
[
ßß 
]
ßß 
buffer
ßß 
=
ßß 
null
ßß  
;
ßß  !
byte
àà 
[
àà 
]
àà 

compressed
àà 
=
àà 
null
àà  $
;
àà$ %
byte
áá 
[
áá 
]
áá 
gzBuffer
áá 
=
áá 
null
áá "
;
áá" #
try
ãã 
{
ää 
buffer
åå 
=
åå 
Encoding
åå !
.
åå! "
UTF8
åå" &
.
åå& '
GetBytes
åå' /
(
åå/ 0
source
åå0 6
)
åå6 7
;
åå7 8
using
çç 
(
çç 
MemoryStream
çç #
ms
çç$ &
=
çç' (
new
çç) ,
MemoryStream
çç- 9
(
çç9 :
)
çç: ;
)
çç; <
{
èè 
using
éé 
(
éé 

GZipStream
éé %
gZip
éé& *
=
éé+ ,
new
éé- 0

GZipStream
éé1 ;
(
éé; <
ms
éé< >
,
éé> ?
System
éé@ F
.
ééF G
IO
ééG I
.
ééI J
Compression
ééJ U
.
ééU V
CompressionMode
ééV e
.
éée f
Compress
ééf n
,
één o
true
éép t
)
éét u
)
ééu v
{
êê 
gZip
ëë 
.
ëë 
Write
ëë "
(
ëë" #
buffer
ëë# )
,
ëë) *
$num
ëë+ ,
,
ëë, -
buffer
ëë. 4
.
ëë4 5
Length
ëë5 ;
)
ëë; <
;
ëë< =
gZip
ìì 
.
ìì 
Close
ìì "
(
ìì" #
)
ìì# $
;
ìì$ %
}
íí 
ms
îî 
.
îî 
Position
îî 
=
îî  !
$num
îî" #
;
îî# $

compressed
ïï 
=
ïï  
new
ïï! $
byte
ïï% )
[
ïï) *
ms
ïï* ,
.
ïï, -
Length
ïï- 3
]
ïï3 4
;
ïï4 5
ms
ğğ 
.
ğğ 
Read
ğğ 
(
ğğ 

compressed
ğğ &
,
ğğ& '
$num
ğğ( )
,
ğğ) *

compressed
ğğ+ 5
.
ğğ5 6
Length
ğğ6 <
)
ğğ< =
;
ğğ= >
ms
ññ 
.
ññ 
Close
ññ 
(
ññ 
)
ññ 
;
ññ 
}
òò 
gzBuffer
óó 
=
óó 
new
óó 
byte
óó #
[
óó# $

compressed
óó$ .
.
óó. /
Length
óó/ 5
+
óó6 7
$num
óó8 9
]
óó9 :
;
óó: ;
System
ôô 
.
ôô 
Buffer
ôô 
.
ôô 
	BlockCopy
ôô '
(
ôô' (

compressed
ôô( 2
,
ôô2 3
$num
ôô4 5
,
ôô5 6
gzBuffer
ôô7 ?
,
ôô? @
$num
ôôA B
,
ôôB C

compressed
ôôD N
.
ôôN O
Length
ôôO U
)
ôôU V
;
ôôV W
System
õõ 
.
õõ 
Buffer
õõ 
.
õõ 
	BlockCopy
õõ '
(
õõ' (
BitConverter
õõ( 4
.
õõ4 5
GetBytes
õõ5 =
(
õõ= >
buffer
õõ> D
.
õõD E
Length
õõE K
)
õõK L
,
õõL M
$num
õõN O
,
õõO P
gzBuffer
õõQ Y
,
õõY Z
$num
õõ[ \
,
õõ\ ]
$num
õõ^ _
)
õõ_ `
;
õõ` a
return
÷÷ 
Convert
÷÷ 
.
÷÷ 
ToBase64String
÷÷ -
(
÷÷- .
gzBuffer
÷÷. 6
)
÷÷6 7
;
÷÷7 8
}
øø 
catch
ùù 
(
ùù 
	Exception
ùù 
ex
ùù 
)
ùù  
{
úú 
FDebug
ûû 
.
ûû 
throwException
ûû %
(
ûû% &
ex
ûû& (
)
ûû( )
;
ûû) *
}
üü 
finally
ıı 
{
şş 
buffer
ÿÿ 
=
ÿÿ 
null
ÿÿ 
;
ÿÿ 

compressed
€€ 
=
€€ 
null
€€ !
;
€€! "
gzBuffer
 
=
 
null
 
;
  
}
‚‚ 
return
ƒƒ 
string
ƒƒ 
.
ƒƒ 
Empty
ƒƒ 
;
ƒƒ  
}
„„ 	
public
ˆˆ 
static
ˆˆ 
string
ˆˆ 

decompress
ˆˆ '
(
ˆˆ' (
string
‰‰ 
source
‰‰ 
)
ŠŠ 
{
‹‹ 	
byte
ŒŒ 
[
ŒŒ 
]
ŒŒ 
gzBuffer
ŒŒ 
=
ŒŒ 
null
ŒŒ "
;
ŒŒ" #
byte
 
[
 
]
 
buffer
 
=
 
null
  
;
  !
int
 
	msgLength
 
=
 
$num
 
;
 
try
 
{
‘‘ 
gzBuffer
’’ 
=
’’ 
Convert
’’ "
.
’’" #
FromBase64String
’’# 3
(
’’3 4
source
’’4 :
)
’’: ;
;
’’; <
using
”” 
(
”” 
MemoryStream
”” #
ms
””$ &
=
””' (
new
””) ,
MemoryStream
””- 9
(
””9 :
)
””: ;
)
””; <
{
•• 
	msgLength
–– 
=
–– 
BitConverter
––  ,
.
––, -
ToInt32
––- 4
(
––4 5
gzBuffer
––5 =
,
––= >
$num
––? @
)
––@ A
;
––A B
ms
—— 
.
—— 
Write
—— 
(
—— 
gzBuffer
—— %
,
——% &
$num
——' (
,
——( )
gzBuffer
——* 2
.
——2 3
Length
——3 9
-
——: ;
$num
——< =
)
——= >
;
——> ?
buffer
™™ 
=
™™ 
new
™™  
byte
™™! %
[
™™% &
	msgLength
™™& /
]
™™/ 0
;
™™0 1
ms
›› 
.
›› 
Position
›› 
=
››  !
$num
››" #
;
››# $
using
œœ 
(
œœ 

GZipStream
œœ %
zip
œœ& )
=
œœ* +
new
œœ, /

GZipStream
œœ0 :
(
œœ: ;
ms
œœ; =
,
œœ= >
System
œœ? E
.
œœE F
IO
œœF H
.
œœH I
Compression
œœI T
.
œœT U
CompressionMode
œœU d
.
œœd e

Decompress
œœe o
)
œœo p
)
œœp q
{
 
zip
 
.
 
Read
  
(
  !
buffer
! '
,
' (
$num
) *
,
* +
buffer
, 2
.
2 3
Length
3 9
)
9 :
;
: ;
zip
ŸŸ 
.
ŸŸ 
Close
ŸŸ !
(
ŸŸ! "
)
ŸŸ" #
;
ŸŸ# $
}
   
ms
¡¡ 
.
¡¡ 
Close
¡¡ 
(
¡¡ 
)
¡¡ 
;
¡¡ 
return
££ 
Encoding
££ #
.
££# $
UTF8
££$ (
.
££( )
	GetString
££) 2
(
££2 3
buffer
££3 9
)
££9 :
;
££: ;
}
¤¤ 
}
¥¥ 
catch
¦¦ 
(
¦¦ 
	Exception
¦¦ 
ex
¦¦ 
)
¦¦  
{
§§ 
FDebug
¨¨ 
.
¨¨ 
throwException
¨¨ %
(
¨¨% &
ex
¨¨& (
)
¨¨( )
;
¨¨) *
}
©© 
finally
ªª 
{
«« 
gzBuffer
¬¬ 
=
¬¬ 
null
¬¬ 
;
¬¬  
buffer
­­ 
=
­­ 
null
­­ 
;
­­ 
}
®® 
return
¯¯ 
string
¯¯ 
.
¯¯ 
Empty
¯¯ 
;
¯¯  
}
°° 	
}
¶¶ 
}·· Ê
aD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\File\c_FFileSystemWatcher.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FFileSystemWatcher #
:$ %
FileSystemWatcher& 7
,7 8
IDisposable9 D
{ 
public 
new 
event "
FileSystemEventHandler /
Changed0 7
;7 8
public 
new 
event "
FileSystemEventHandler /
Created0 7
;7 8
public 
new 
event "
FileSystemEventHandler /
Deleted0 7
;7 8
public 
new 
event 
RenamedEventHandler ,
Renamed- 4
;4 5
private   
bool   

m_disposed   
=    !
false  " '
;  ' (
private"" 
bool"" &
m_enableRecentEventsFilter"" /
=""0 1
false""2 7
;""7 8
private## 
TimeSpan## !
m_eventFilterTimeSpan## .
;##. /
private$$ 

Dictionary$$ 
<$$ 
string$$ !
,$$! "
DateTime$$# +
>$$+ ,
m_lastFileEvent$$- <
=$$= >
null$$? C
;$$C D
public** 
FFileSystemWatcher** !
(**! "
)++ 
:++ 
base++ 
(++ 
)++ 
{,, 	
init-- 
(-- 
)-- 
;-- 
}.. 	
public22 
FFileSystemWatcher22 !
(22! "
string33 
path33 
,33 
bool44 
	autoStart44 
=44 
false44 "
,44" #
bool55 $
enableRecentEventsFilter55 )
=55* +
true55, 0
,550 1
int66  
eventsFilterInterval66 $
=66% &
$num66' *
)77 
:77 
base77 
(77 
path77 
)77 
{88 	
init99 
(99 
	autoStart99 
,99 $
enableRecentEventsFilter99 4
,994 5 
eventsFilterInterval996 J
)99J K
;99K L
}:: 	
public>> 
FFileSystemWatcher>> !
(>>! "
string?? 
path?? 
,?? 
string@@ 
filter@@ 
,@@ 
boolAA 
	autoStartAA 
=AA 
falseAA "
,AA" #
boolBB $
enableRecentEventsFilterBB )
=BB* +
trueBB, 0
,BB0 1
intCC  
eventsFilterIntervalCC $
=CC% &
$numCC' *
)DD 
:DD 
baseDD 
(DD 
pathDD 
,DD 
filterDD !
)DD! "
{EE 	
initFF 
(FF 
	autoStartFF 
,FF $
enableRecentEventsFilterFF 4
,FF4 5 
eventsFilterIntervalFF6 J
)FFJ K
;FFK L
}GG 	
~KK 	
FFileSystemWatcherKK	 
(KK 
)LL 
{MM 	
	myDisposeNN 
(NN 
falseNN 
)NN 
;NN 
}OO 	
	protectedSS 
voidSS 
	myDisposeSS  
(SS  !
boolTT 
	disposingTT 
)UU 
{VV 	
ifWW 
(WW 
!WW 

m_disposedWW 
)WW 
{XX 
ifYY 
(YY 
	disposingYY 
)YY 
{ZZ 
stop[[ 
([[ 
)[[ 
;[[ 
}\\ 
base^^ 
.^^ 
Dispose^^ 
(^^ 
)^^ 
;^^ 

m_disposed`` 
=`` 
true`` !
;``! "
}aa 
}bb 	
publicjj 
newjj 
voidjj 
Disposejj 
(jj  
)kk 
{ll 	
	myDisposemm 
(mm 
truemm 
)mm 
;mm 
}nn 	
publicvv 
intvv  
eventsFilterIntervalvv '
{ww 	
getxx 
{yy 
tryzz 
{{{ 
return|| 
(|| 
int|| 
)||  !
m_eventFilterTimeSpan||  5
.||5 6
TotalMilliseconds||6 G
;||G H
}}} 
catch~~ 
(~~ 
	Exception~~  
ex~~! #
)~~# $
{ 
FDebug
€€ 
.
€€ 
throwException
€€ )
(
€€) *
ex
€€* ,
)
€€, -
;
€€- .
}
 
finally
‚‚ 
{
ƒƒ 
}
…… 
return
†† 
$num
†† 
;
†† 
}
‡‡ 
set
‰‰ 
{
ŠŠ 
try
‹‹ 
{
ŒŒ #
m_eventFilterTimeSpan
 )
=
* +
new
, /
TimeSpan
0 8
(
8 9
$num
9 :
,
: ;
$num
< =
,
= >
$num
? @
,
@ A
$num
B C
,
C D
value
E J
)
J K
;
K L
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
‘‘ 
.
‘‘ 
throwException
‘‘ )
(
‘‘) *
ex
‘‘* ,
)
‘‘, -
;
‘‘- .
}
’’ 
finally
““ 
{
”” 
}
–– 
}
—— 
}
˜˜ 	
public
œœ 
bool
œœ &
enableRecentEventsFilter
œœ ,
{
 	
get
 
{
ŸŸ 
try
   
{
¡¡ 
return
¢¢ (
m_enableRecentEventsFilter
¢¢ 5
;
¢¢5 6
}
££ 
catch
¤¤ 
(
¤¤ 
	Exception
¤¤  
ex
¤¤! #
)
¤¤# $
{
¥¥ 
FDebug
¦¦ 
.
¦¦ 
throwException
¦¦ )
(
¦¦) *
ex
¦¦* ,
)
¦¦, -
;
¦¦- .
}
§§ 
finally
¨¨ 
{
©© 
}
«« 
return
¬¬ 
false
¬¬ 
;
¬¬ 
}
­­ 
set
¯¯ 
{
°° 
try
±± 
{
²² (
m_enableRecentEventsFilter
³³ .
=
³³/ 0
value
³³1 6
;
³³6 7
if
´´ 
(
´´ "
eventsFilterInterval
´´ ,
==
´´- /
$num
´´0 1
)
´´1 2
{
µµ "
eventsFilterInterval
¶¶ ,
=
¶¶- .
$num
¶¶/ 2
;
¶¶2 3
}
·· 
}
¸¸ 
catch
¹¹ 
(
¹¹ 
	Exception
¹¹  
ex
¹¹! #
)
¹¹# $
{
ºº 
FDebug
»» 
.
»» 
throwException
»» )
(
»») *
ex
»»* ,
)
»», -
;
»»- .
}
¼¼ 
finally
½½ 
{
¾¾ 
}
ÀÀ 
}
ÁÁ 
}
ÂÂ 	
public
ÊÊ 
void
ÊÊ 
init
ÊÊ 
(
ÊÊ 
bool
ËË 
	autoStart
ËË 
=
ËË 
false
ËË "
,
ËË" #
bool
ÌÌ &
enableRecentEventsFilter
ÌÌ )
=
ÌÌ* +
true
ÌÌ, 0
,
ÌÌ0 1
int
ÍÍ "
eventsFilterInterval
ÍÍ $
=
ÍÍ% &
$num
ÍÍ' *
)
ÎÎ 
{
ÏÏ 	
try
ĞĞ 
{
ÑÑ 
this
ÒÒ 
.
ÒÒ &
enableRecentEventsFilter
ÒÒ -
=
ÒÒ. /&
enableRecentEventsFilter
ÒÒ0 H
;
ÒÒH I
this
ÓÓ 
.
ÓÓ "
eventsFilterInterval
ÓÓ )
=
ÓÓ* +"
eventsFilterInterval
ÓÓ, @
;
ÓÓ@ A
if
×× 
(
×× 
	autoStart
×× 
)
×× 
{
ØØ 
start
ÙÙ 
(
ÙÙ 
)
ÙÙ 
;
ÙÙ 
}
ÚÚ 
}
ÛÛ 
catch
ÜÜ 
(
ÜÜ 
	Exception
ÜÜ 
ex
ÜÜ 
)
ÜÜ  
{
İİ 
FDebug
ŞŞ 
.
ŞŞ 
throwException
ŞŞ %
(
ŞŞ% &
ex
ŞŞ& (
)
ŞŞ( )
;
ŞŞ) *
}
ßß 
finally
àà 
{
áá 
}
ãã 
}
ää 	
public
èè 
void
èè 
start
èè 
(
èè 
)
éé 
{
êê 	
try
ëë 
{
ìì 
m_lastFileEvent
íí 
=
íí  !
new
íí" %

Dictionary
íí& 0
<
íí0 1
string
íí1 7
,
íí7 8
DateTime
íí9 A
>
ííA B
(
ííB C
)
ííC D
;
ííD E
base
ññ 
.
ññ 
Created
ññ 
+=
ññ 
new
ññ  #$
FileSystemEventHandler
ññ$ :
(
ññ: ;(
FFileSystemWatcher_Created
ññ; U
)
ññU V
;
ññV W
base
òò 
.
òò 
Changed
òò 
+=
òò 
new
òò  #$
FileSystemEventHandler
òò$ :
(
òò: ;(
FFileSystemWatcher_Changed
òò; U
)
òòU V
;
òòV W
base
óó 
.
óó 
Deleted
óó 
+=
óó 
new
óó  #$
FileSystemEventHandler
óó$ :
(
óó: ;(
FFileSystemWatcher_Deleted
óó; U
)
óóU V
;
óóV W
base
ôô 
.
ôô 
Renamed
ôô 
+=
ôô 
new
ôô  #!
RenamedEventHandler
ôô$ 7
(
ôô7 8(
FFileSystemWatcher_Renamed
ôô8 R
)
ôôR S
;
ôôS T
this
øø 
.
øø !
EnableRaisingEvents
øø (
=
øø) *
true
øø+ /
;
øø/ 0
}
ùù 
catch
úú 
(
úú 
	Exception
úú 
ex
úú 
)
úú  
{
ûû 
FDebug
üü 
.
üü 
throwException
üü %
(
üü% &
ex
üü& (
)
üü( )
;
üü) *
}
ıı 
finally
şş 
{
ÿÿ 
}
 
}
‚‚ 	
public
†† 
void
†† 
stop
†† 
(
†† 
)
‡‡ 
{
ˆˆ 	
try
‰‰ 
{
ŠŠ 
this
‹‹ 
.
‹‹ !
EnableRaisingEvents
‹‹ (
=
‹‹) *
false
‹‹+ 0
;
‹‹0 1
base
 
.
 
Created
 
-=
 
new
  #$
FileSystemEventHandler
$ :
(
: ;(
FFileSystemWatcher_Created
; U
)
U V
;
V W
base
 
.
 
Changed
 
-=
 
new
  #$
FileSystemEventHandler
$ :
(
: ;(
FFileSystemWatcher_Changed
; U
)
U V
;
V W
base
‘‘ 
.
‘‘ 
Deleted
‘‘ 
-=
‘‘ 
new
‘‘  #$
FileSystemEventHandler
‘‘$ :
(
‘‘: ;(
FFileSystemWatcher_Deleted
‘‘; U
)
‘‘U V
;
‘‘V W
base
’’ 
.
’’ 
Renamed
’’ 
-=
’’ 
new
’’  #!
RenamedEventHandler
’’$ 7
(
’’7 8(
FFileSystemWatcher_Renamed
’’8 R
)
’’R S
;
’’S T
m_lastFileEvent
–– 
=
––  !
null
––" &
;
––& '
}
—— 
catch
˜˜ 
(
˜˜ 
	Exception
˜˜ 
ex
˜˜ 
)
˜˜  
{
™™ 
FDebug
šš 
.
šš 
throwException
šš %
(
šš% &
ex
šš& (
)
šš( )
;
šš) *
}
›› 
finally
œœ 
{
 
}
ŸŸ 
}
   	
private
¤¤ 
bool
¤¤ $
hasOccuredAnotherEvent
¤¤ +
(
¤¤+ ,
string
¥¥ 
filename
¥¥ 
)
¦¦ 
{
§§ 	
bool
¨¨ 
retVal
¨¨ 
=
¨¨ 
false
¨¨ 
;
¨¨  
DateTime
©© 
now
©© 
=
©© 
DateTime
©© #
.
©©# $
Now
©©$ '
;
©©' (
try
«« 
{
¬¬ 
if
­­ 
(
­­ &
enableRecentEventsFilter
­­ ,
)
­­, -
{
®® (
deleteTimeOverEventsFilter
¯¯ .
(
¯¯. /
now
¯¯/ 2
)
¯¯2 3
;
¯¯3 4
if
°° 
(
°° 
m_lastFileEvent
°° '
.
°°' (
ContainsKey
°°( 3
(
°°3 4
filename
°°4 <
)
°°< =
)
°°= >
{
±± 
m_lastFileEvent
²² '
[
²²' (
filename
²²( 0
]
²²0 1
=
²²2 3
now
²²4 7
;
²²7 8
retVal
³³ 
=
³³  
true
³³! %
;
³³% &
}
´´ 
else
µµ 
{
¶¶ 
m_lastFileEvent
·· '
.
··' (
Add
··( +
(
··+ ,
filename
··, 4
,
··4 5
now
··6 9
)
··9 :
;
··: ;
}
¸¸ 
}
¹¹ 
return
ºº 
retVal
ºº 
;
ºº 
}
»» 
catch
¼¼ 
(
¼¼ 
	Exception
¼¼ 
ex
¼¼ 
)
¼¼  
{
½½ 
FDebug
¾¾ 
.
¾¾ 
throwException
¾¾ %
(
¾¾% &
ex
¾¾& (
)
¾¾( )
;
¾¾) *
}
¿¿ 
finally
ÀÀ 
{
ÁÁ 
}
ÃÃ 
return
ÄÄ 
false
ÄÄ 
;
ÄÄ 
}
ÅÅ 	
private
ÊÊ 
void
ÊÊ (
deleteTimeOverEventsFilter
ÊÊ /
(
ÊÊ/ 0
DateTime
ËË 
now
ËË 
)
ÌÌ 
{
ÍÍ 	
TimeSpan
ÎÎ 
	eventSpan
ÎÎ 
;
ÎÎ 
List
ÏÏ 
<
ÏÏ 
string
ÏÏ 
>
ÏÏ 
deletingFiles
ÏÏ &
=
ÏÏ' (
null
ÏÏ) -
;
ÏÏ- .
try
ÑÑ 
{
ÒÒ 
deletingFiles
ÖÖ 
=
ÖÖ 
new
ÖÖ  #
List
ÖÖ$ (
<
ÖÖ( )
string
ÖÖ) /
>
ÖÖ/ 0
(
ÖÖ0 1
)
ÖÖ1 2
;
ÖÖ2 3
foreach
×× 
(
×× 
KeyValuePair
×× %
<
××% &
string
××& ,
,
××, -
DateTime
××. 6
>
××6 7
	fileEvent
××8 A
in
××B D
m_lastFileEvent
××E T
)
××T U
{
ØØ 
	eventSpan
ÙÙ 
=
ÙÙ 
now
ÙÙ  #
-
ÙÙ$ %
	fileEvent
ÙÙ& /
.
ÙÙ/ 0
Value
ÙÙ0 5
;
ÙÙ5 6
if
ÚÚ 
(
ÚÚ 
	eventSpan
ÚÚ !
>=
ÚÚ" $#
m_eventFilterTimeSpan
ÚÚ% :
)
ÚÚ: ;
{
ÛÛ 
deletingFiles
ÜÜ %
.
ÜÜ% &
Add
ÜÜ& )
(
ÜÜ) *
	fileEvent
ÜÜ* 3
.
ÜÜ3 4
Key
ÜÜ4 7
)
ÜÜ7 8
;
ÜÜ8 9
}
İİ 
}
ŞŞ 
foreach
åå 
(
åå 
string
åå 
file
åå  $
in
åå% '
deletingFiles
åå( 5
)
åå5 6
{
ææ 
m_lastFileEvent
çç #
.
çç# $
Remove
çç$ *
(
çç* +
file
çç+ /
)
çç/ 0
;
çç0 1
}
èè 
}
éé 
catch
êê 
(
êê 
	Exception
êê 
ex
êê 
)
êê  
{
ëë 
FDebug
ìì 
.
ìì 
throwException
ìì %
(
ìì% &
ex
ìì& (
)
ìì( )
;
ìì) *
}
íí 
finally
îî 
{
ïï 
deletingFiles
ğğ 
=
ğğ 
null
ğğ  $
;
ğğ$ %
}
ññ 
}
òò 	
private
úú 
void
úú (
FFileSystemWatcher_Created
úú /
(
úú/ 0
object
ûû 
sender
ûû 
,
ûû !
FileSystemEventArgs
üü 
e
üü  !
)
ıı 
{
şş 	
if
ÿÿ 
(
ÿÿ 
!
ÿÿ $
hasOccuredAnotherEvent
ÿÿ &
(
ÿÿ& '
e
ÿÿ' (
.
ÿÿ( )
FullPath
ÿÿ) 1
)
ÿÿ1 2
)
ÿÿ2 3
{
€€ 
	onCreated
 
(
 
e
 
)
 
;
 
}
‚‚ 
}
ƒƒ 	
private
‡‡ 
void
‡‡ (
FFileSystemWatcher_Changed
‡‡ /
(
‡‡/ 0
object
ˆˆ 
sender
ˆˆ 
,
ˆˆ !
FileSystemEventArgs
‰‰ 
e
‰‰  !
)
ŠŠ 
{
‹‹ 	
if
ŒŒ 
(
ŒŒ 
!
ŒŒ $
hasOccuredAnotherEvent
ŒŒ '
(
ŒŒ' (
e
ŒŒ( )
.
ŒŒ) *
FullPath
ŒŒ* 2
)
ŒŒ2 3
)
ŒŒ3 4
{
 
	onChanged
 
(
 
e
 
)
 
;
 
}
 
}
 	
private
”” 
void
”” (
FFileSystemWatcher_Deleted
”” /
(
””/ 0
object
•• 
sender
•• 
,
•• !
FileSystemEventArgs
–– 
e
––  !
)
—— 
{
˜˜ 	
if
™™ 
(
™™ 
!
™™ $
hasOccuredAnotherEvent
™™ '
(
™™' (
e
™™( )
.
™™) *
FullPath
™™* 2
)
™™2 3
)
™™3 4
{
šš 
	onDeleted
›› 
(
›› 
e
›› 
)
›› 
;
›› 
}
œœ 
}
 	
private
¡¡ 
void
¡¡ (
FFileSystemWatcher_Renamed
¡¡ /
(
¡¡/ 0
object
¢¢ 
sender
¢¢ 
,
¢¢ 
RenamedEventArgs
££ 
e
££ 
)
¤¤ 
{
¥¥ 	
if
¦¦ 
(
¦¦ 
!
¦¦ $
hasOccuredAnotherEvent
¦¦ '
(
¦¦' (
e
¦¦( )
.
¦¦) *
FullPath
¦¦* 2
)
¦¦2 3
)
¦¦3 4
{
§§ 
	onRenamed
¨¨ 
(
¨¨ 
e
¨¨ 
)
¨¨ 
;
¨¨ 
}
©© 
}
ªª 	
	protected
²² 
virtual
²² 
void
²² 
	onCreated
²² (
(
²²( )!
FileSystemEventArgs
³³ 
e
³³  !
)
´´ 
{
µµ 	
if
¶¶ 
(
¶¶ 
Created
¶¶ 
!=
¶¶ 
null
¶¶ 
)
¶¶  
{
·· 
Created
¸¸ 
(
¸¸ 
this
¸¸ 
,
¸¸ 
e
¸¸ 
)
¸¸  
;
¸¸  !
}
¹¹ 
}
ºº 	
	protected
¾¾ 
virtual
¾¾ 
void
¾¾ 
	onChanged
¾¾ (
(
¾¾( )!
FileSystemEventArgs
¿¿ 
e
¿¿  !
)
ÀÀ 
{
ÁÁ 	
if
ÂÂ 
(
ÂÂ 
Changed
ÂÂ 
!=
ÂÂ 
null
ÂÂ 
)
ÂÂ  
{
ÃÃ 
Changed
ÄÄ 
(
ÄÄ 
this
ÄÄ 
,
ÄÄ 
e
ÄÄ 
)
ÄÄ  
;
ÄÄ  !
}
ÅÅ 
}
ÆÆ 	
	protected
ÊÊ 
virtual
ÊÊ 
void
ÊÊ 
	onDeleted
ÊÊ (
(
ÊÊ( )!
FileSystemEventArgs
ËË 
e
ËË  !
)
ÌÌ 
{
ÍÍ 	
if
ÎÎ 
(
ÎÎ 
Deleted
ÎÎ 
!=
ÎÎ 
null
ÎÎ 
)
ÎÎ  
{
ÏÏ 
Deleted
ĞĞ 
(
ĞĞ 
this
ĞĞ 
,
ĞĞ 
e
ĞĞ 
)
ĞĞ  
;
ĞĞ  !
}
ÑÑ 
}
ÒÒ 	
	protected
ÖÖ 
virtual
ÖÖ 
void
ÖÖ 
	onRenamed
ÖÖ (
(
ÖÖ( )
RenamedEventArgs
×× 
e
×× 
)
ØØ 
{
ÙÙ 	
if
ÚÚ 
(
ÚÚ 
Renamed
ÚÚ 
!=
ÚÚ 
null
ÚÚ 
)
ÚÚ  
{
ÛÛ 
Renamed
ÜÜ 
(
ÜÜ 
this
ÜÜ 
,
ÜÜ 
e
ÜÜ 
)
ÜÜ  
;
ÜÜ  !
}
İİ 
}
ŞŞ 	
}
ää 
}åå º 
hD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\H101\c_FH101ErrorRaisedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
Serializable 
] 
public 

class %
FH101ErrorRaisedEventArgs *
:+ ,
	EventArgs- 6
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FH101 
m_fOwnerH101 "
=# $
null% )
;) *
private 
string 
	m_message  
=! "
string# )
.) *
Empty* /
;/ 0
private 
	Exception 
m_exception %
=& '
null( ,
;, -
internal%% %
FH101ErrorRaisedEventArgs%% *
(%%* +
FH101&& 

fOwnerH101&& 
,&& 
string'' 
message'' 
,'' 
	Exception(( 
	exception(( 
))) 
{** 	
m_fOwnerH101++ 
=++ 

fOwnerH101++ %
;++% &
	m_message,, 
=,, 
message,, 
;,,  
m_exception-- 
=-- 
	exception-- #
;--# $
}.. 	
~22 	%
FH101ErrorRaisedEventArgs22	 "
(22" #
)33 
{44 	
	myDispose55 
(55 
false55 
)55 
;55 
}66 	
	protected:: 
void:: 
	myDispose::  
(::  !
bool;; 
	disposing;; 
)<< 
{== 	
if>> 
(>> 
!>> 

m_disposed>> 
)>> 
{?? 
if@@ 
(@@ 
	disposing@@ 
)@@ 
{AA 
m_fOwnerH101BB  
=BB! "
nullBB# '
;BB' (
m_exceptionCC 
=CC  !
nullCC" &
;CC& '
}DD 

m_disposedEE 
=EE 
trueEE !
;EE! "
}FF 
}GG 	
publicOO 
FH101OO 

fOwnerH101OO 
{PP 	
getQQ 
{RR 
trySS 
{TT 
returnUU 
m_fOwnerH101UU '
;UU' (
}VV 
catchWW 
(WW 
	ExceptionWW  
exWW! #
)WW# $
{XX 
FDebugYY 
.YY 
throwExceptionYY )
(YY) *
exYY* ,
)YY, -
;YY- .
}ZZ 
finally[[ 
{\\ 
}^^ 
return__ 
null__ 
;__ 
}`` 
}aa 	
publicee 
stringee 
messageee 
{ff 	
getgg 
{hh 
tryii 
{jj 
returnkk 
	m_messagekk $
;kk$ %
}ll 
catchmm 
(mm 
	Exceptionmm  
exmm! #
)mm# $
{nn 
FDebugoo 
.oo 
throwExceptionoo )
(oo) *
exoo* ,
)oo, -
;oo- .
}pp 
finallyqq 
{rr 
}tt 
returnuu 
stringuu 
.uu 
Emptyuu #
;uu# $
}vv 
}ww 	
public{{ 
	Exception{{ 
	exception{{ "
{|| 	
get}} 
{~~ 
try 
{
€€ 
return
 
m_exception
 &
;
& '
}
‚‚ 
catch
ƒƒ 
(
ƒƒ 
	Exception
ƒƒ  
ex
ƒƒ! #
)
ƒƒ# $
{
„„ 
FDebug
…… 
.
…… 
throwException
…… )
(
……) *
ex
……* ,
)
……, -
;
……- .
}
†† 
finally
‡‡ 
{
ˆˆ 
}
ŠŠ 
return
‹‹ 
null
‹‹ 
;
‹‹ 
}
ŒŒ 
}
 	
}
™™ 
}šš ­
cD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\LogWriter\c_FEventLogWriter.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

static 
class 
FEventLogWriter '
{ 
private 
const 
int 
DefaultEventId (
=) *
$num+ /
;/ 0
private   
static   
string   
	m_logName   '
=  ( )
$str  * 2
;  2 3
public22 
static22 
void22 
write22  
(22  !
string33 
source33 
,33 
string44 
message44 
)55 
{66 	
try77 
{88 
write99 
(99 
source99 
,99 
message99 %
,99% &
EventLogEntryType99' 8
.998 9
Information999 D
,99D E
DefaultEventId99F T
)99T U
;99U V
}:: 
catch;; 
(;; 
	Exception;; 
ex;; 
);;  
{<< 
System== 
.== 
Diagnostics== "
.==" #
Debug==# (
.==( )
	WriteLine==) 2
(==2 3
ex==3 5
.==5 6
ToString==6 >
(==> ?
)==? @
)==@ A
;==A B
}>> 
finally?? 
{@@ 
}BB 
}CC 	
publicGG 
staticGG 
voidGG 
writeGG  
(GG  !
stringHH 
sourceHH 
,HH 
stringII 
messageII 
,II 
EventLogEntryTypeJJ 
typeJJ "
)KK 
{LL 	
tryMM 
{NN 
writeOO 
(OO 
sourceOO 
,OO 
messageOO %
,OO% &
typeOO' +
,OO+ ,
DefaultEventIdOO- ;
)OO; <
;OO< =
}PP 
catchQQ 
(QQ 
	ExceptionQQ 
exQQ 
)QQ  
{RR 
SystemSS 
.SS 
DiagnosticsSS "
.SS" #
DebugSS# (
.SS( )
	WriteLineSS) 2
(SS2 3
exSS3 5
.SS5 6
ToStringSS6 >
(SS> ?
)SS? @
)SS@ A
;SSA B
}TT 
finallyUU 
{VV 
}XX 
}YY 	
public]] 
static]] 
void]] 
write]]  
(]]  !
string^^ 
source^^ 
,^^ 
string__ 
message__ 
,__ 
EventLogEntryType`` 
type`` "
,``" #
intaa 
eventIdaa 
)bb 
{cc 	
trydd 
{ee 
ifff 
(ff 
!ff 
EventLogff 
.ff 
SourceExistsff *
(ff* +
sourceff+ 1
)ff1 2
)ff2 3
{gg 
EventLoghh 
.hh 
CreateEventSourcehh .
(hh. /
sourcehh/ 5
,hh5 6
	m_logNamehh7 @
)hh@ A
;hhA B
}ii 
EventLogmm 
.mm 

WriteEntrymm #
(mm# $
sourcemm$ *
,mm* +
messagemm, 3
,mm3 4
typemm5 9
,mm9 :
eventIdmm; B
)mmB C
;mmC D
}nn 
catchoo 
(oo 
	Exceptionoo 
exoo 
)oo  
{pp 
Systemqq 
.qq 
Diagnosticsqq "
.qq" #
Debugqq# (
.qq( )
	WriteLineqq) 2
(qq2 3
exqq3 5
.qq5 6
ToStringqq6 >
(qq> ?
)qq? @
)qq@ A
;qqA B
}rr 
finallyss 
{tt 
}vv 
}ww 	
}}} 
}~~ §G
cD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\LogWriter\c_FServiceLogData.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FServiceLogData  
:! "
IDisposable# .
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
DateTime 
m_startTime 
; 
StringBuilder 
m_log 
= 
null "
;" #
public$$ 
FServiceLogData$$ 
($$ 
string%% 

serverName%% 
,%% 
Type&& 
type&& 
,&& 
string'' 
functionName'' 
)(( 
{)) 	
m_startTime** 
=** 
DateTime** "
.**" #
Now**# &
;**& '
m_log++ 
=++ 
new++ 
StringBuilder++ %
(++% &
)++& '
;++' (
m_log// 
.// 
Append// 
(// 
$str// &
+//' (
FDataConvert//) 5
.//5 6&
defaultNowDateTimeToString//6 P
(//P Q
)//Q R
+//S T
$str//U X
+//Y Z
Environment//[ f
.//f g
NewLine//g n
)//n o
;//o p
m_log11 
.11 
Append11 
(11 
$str11 '
+11( )

serverName11* 4
+115 6
$str117 <
)11< =
;11= >
m_log22 
.22 
Append22 
(22 
$str22 &
+22' (
type22) -
.22- .
	Namespace22. 7
+228 9
$str22: ?
)22? @
;22@ A
m_log33 
.33 
Append33 
(33 
$str33 %
+33& '
type33( ,
.33, -
Name33- 1
+332 3
$str334 9
)339 :
;33: ;
m_log44 
.44 
Append44 
(44 
$str44 )
+44* +
functionName44, 8
+449 :
$str44; >
+44? @
Environment44A L
.44L M
NewLine44M T
)44T U
;44U V
m_log66 
.66 
Append66 
(66 
$str66 
+66 
Environment66 *
.66* +
NewLine66+ 2
)662 3
;663 4
}77 	
public;; 
FServiceLogData;; 
(;; 
Type<< 
type<< 
,<< 
string== 
functionName== 
)>> 
{?? 	
m_startTime@@ 
=@@ 
DateTime@@ "
.@@" #
Now@@# &
;@@& '
m_logAA 
=AA 
newAA 
StringBuilderAA %
(AA% &
)AA& '
;AA' (
m_logEE 
.EE 
AppendEE 
(EE 
$strEE &
+EE' (
FDataConvertEE) 5
.EE5 6&
defaultNowDateTimeToStringEE6 P
(EEP Q
)EEQ R
+EES T
$strEEU X
+EEY Z
EnvironmentEE[ f
.EEf g
NewLineEEg n
)EEn o
;EEo p
m_logGG 
.GG 
AppendGG 
(GG 
$strGG &
+GG' (
typeGG) -
.GG- .
	NamespaceGG. 7
+GG8 9
$strGG: ?
)GG? @
;GG@ A
m_logHH 
.HH 
AppendHH 
(HH 
$strHH %
+HH& '
typeHH( ,
.HH, -
NameHH- 1
+HH2 3
$strHH4 9
)HH9 :
;HH: ;
m_logII 
.II 
AppendII 
(II 
$strII )
+II* +
functionNameII, 8
+II9 :
$strII; >
+II? @
EnvironmentIIA L
.IIL M
NewLineIIM T
)IIT U
;IIU V
m_logKK 
.KK 
AppendKK 
(KK 
$strKK 
+KK 
EnvironmentKK *
.KK* +
NewLineKK+ 2
)KK2 3
;KK3 4
}LL 	
~PP 	
FServiceLogDataPP	 
(PP 
)QQ 
{RR 	
	myDisposeSS 
(SS 
falseSS 
)SS 
;SS 
}TT 	
	protectedXX 
voidXX 
	myDisposeXX  
(XX  !
boolYY 
	disposingYY 
)ZZ 
{[[ 	
if\\ 
(\\ 
!\\ 

m_disposed\\ 
)\\ 
{]] 
if^^ 
(^^ 
	disposing^^ 
)^^ 
{__ 
}aa 

m_disposedbb 
=bb 
truebb !
;bb! "
}cc 
}dd 	
publicll 
voidll 
Disposell 
(ll 
)mm 
{nn 	
	myDisposeoo 
(oo 
trueoo 
)oo 
;oo 
GCpp 
.pp 
SuppressFinalizepp 
(pp  
thispp  $
)pp$ %
;pp% &
}qq 	
internalyy 
DateTimeyy 
	startTimeyy #
{zz 	
get{{ 
{|| 
try}} 
{~~ 
return 
m_startTime &
;& '
}
€€ 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
‚‚ 
FDebug
ƒƒ 
.
ƒƒ 
throwException
ƒƒ )
(
ƒƒ) *
ex
ƒƒ* ,
)
ƒƒ, -
;
ƒƒ- .
}
„„ 
finally
…… 
{
†† 
}
ˆˆ 
return
‰‰ 
DateTime
‰‰ 
.
‰‰  
Now
‰‰  #
;
‰‰# $
}
ŠŠ 
}
‹‹ 	
internal
 
StringBuilder
 
logData
 &
{
 	
get
‘‘ 
{
’’ 
try
““ 
{
”” 
return
•• 
m_log
••  
;
••  !
}
–– 
catch
—— 
(
—— 
	Exception
——  
ex
——! #
)
——# $
{
˜˜ 
FDebug
™™ 
.
™™ 
throwException
™™ )
(
™™) *
ex
™™* ,
)
™™, -
;
™™- .
}
šš 
finally
›› 
{
œœ 
}
 
return
ŸŸ 
null
ŸŸ 
;
ŸŸ 
}
   
}
¡¡ 	
public
©© 
void
©© 
	appendLog
©© 
(
©© !
FServiceLogCategory
ªª 
	fCategory
ªª  )
,
ªª) *
string
«« 
action
«« 
,
«« 
string
¬¬ 
log
¬¬ 
)
­­ 
{
®® 	
try
¯¯ 
{
°° 
if
±± 
(
±± 
	fCategory
±± 
==
±±  !
FServiceLogCategory
±±! 4
.
±±4 5
Information
±±5 @
)
±±@ A
{
²² 
m_log
³³ 
.
³³ 
Append
³³  
(
³³  !
$str
³³! 1
)
³³1 2
;
³³2 3
}
´´ 
else
µµ 
if
µµ 
(
µµ 
	fCategory
µµ "
==
µµ# %!
FServiceLogCategory
µµ& 9
.
µµ9 :
Warning
µµ: A
)
µµA B
{
¶¶ 
m_log
·· 
.
·· 
Append
··  
(
··  !
$str
··! 1
)
··1 2
;
··2 3
}
¸¸ 
else
¹¹ 
{
ºº 
m_log
»» 
.
»» 
Append
»»  
(
»»  !
$str
»»! 1
)
»»1 2
;
»»2 3
}
¼¼ 
m_log
½½ 
.
½½ 
Append
½½ 
(
½½ 
$str
½½ '
+
½½( )
action
½½* 0
+
½½1 2
$str
½½3 6
+
½½7 8
Environment
½½9 D
.
½½D E
NewLine
½½E L
)
½½L M
;
½½M N
m_log
ÁÁ 
.
ÁÁ 
Append
ÁÁ 
(
ÁÁ 
$str
ÁÁ 9
+
ÁÁ: ;
Environment
ÁÁ< G
.
ÁÁG H
NewLine
ÁÁH O
)
ÁÁO P
;
ÁÁP Q
m_log
ÂÂ 
.
ÂÂ 
Append
ÂÂ 
(
ÂÂ 
log
ÂÂ  
+
ÂÂ! "
Environment
ÂÂ# .
.
ÂÂ. /
NewLine
ÂÂ/ 6
)
ÂÂ6 7
;
ÂÂ7 8
m_log
ÃÃ 
.
ÃÃ 
Append
ÃÃ 
(
ÃÃ 
$str
ÃÃ  
+
ÃÃ! "
Environment
ÃÃ# .
.
ÃÃ. /
NewLine
ÃÃ/ 6
)
ÃÃ6 7
;
ÃÃ7 8
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
	Exception
ÅÅ 
ex
ÅÅ 
)
ÅÅ  
{
ÆÆ 
FDebug
ÇÇ 
.
ÇÇ 
throwException
ÇÇ %
(
ÇÇ% &
ex
ÇÇ& (
)
ÇÇ( )
;
ÇÇ) *
}
ÈÈ 
finally
ÉÉ 
{
ÊÊ 
}
ÌÌ 
}
ÍÍ 	
}
ÓÓ 
}ÔÔ ãG
_D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Network\c_FNetworkDrive.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

static 
class 
FNetworkDrive %
{ 
static 
FNetworkDrive 
( 
) 
{ 	
}   	
public(( 
static(( 
void(( 
connect2(( #
(((# $
string)) 
drive)) 
,)) 
string** 
pass** 
,** 
string++ 
userId++ 
,++ 
string,, 
password,, 
)-- 
{.. 	
FNativeAPIs// 
.// 
NETRESOURCE// #
ns//$ &
=//' (
new//) ,
FNativeAPIs//- 8
.//8 9
NETRESOURCE//9 D
(//D E
)//E F
;//F G
int00 
flags00 
=00 
$num00 
;00 
try22 
{33 
ns44 
.44 
dwScope44 
=44 
$num44 
;44 
ns55 
.55 
dwType55 
=55 
FNativeAPIs55 '
.55' (
RESOURCETYPE_DISK55( 9
;559 :
ns66 
.66 
dwDisplayType66  
=66! "
$num66# $
;66$ %
ns77 
.77 
dwUsage77 
=77 
$num77 
;77 
ns88 
.88 
lpRemoteName88 
=88  !
pass88" &
;88& '
ns99 
.99 
lpLocalName99 
=99  
drive99! &
;99& '
FNativeAPIs== 
.== 
WNetAddConnection2A== /
(==/ 0
ref==0 3
ns==4 6
,==6 7
password==8 @
,==@ A
userId==B H
,==H I
flags==J O
)==O P
;==P Q
}>> 
catch?? 
(?? 
	Exception?? 
ex?? 
)??  
{@@ 
FDebugAA 
.AA 
throwExceptionAA %
(AA% &
exAA& (
)AA( )
;AA) *
}BB 
finallyCC 
{DD 
}FF 
}GG 	
publicKK 
staticKK 
voidKK 
connectKK "
(KK" #
stringLL 
driveLL 
,LL 
stringMM 

netwokPathMM 
,MM 
stringNN 
userNN 
,NN 
stringOO 
passwordOO 
)PP 
{QQ 	
FNativeAPIsRR 
.RR 
NETRESOURCERR #
nsRR$ &
=RR' (
newRR) ,
FNativeAPIsRR- 8
.RR8 9
NETRESOURCERR9 D
(RRD E
)RRE F
;RRF G
StringBuilderSS 
sbSS 
=SS 
nullSS #
;SS# $
uintTT 
flagsTT 
=TT 
$numTT 
;TT 
intUU 
capacityUU 
=UU 
$numUU 
;UU 
uintVV 
resultFlagsVV 
=VV 
$numVV  
;VV  !
intWW 
errorWW 
=WW 
$numWW 
;WW 
tryYY 
{ZZ 
ns[[ 
.[[ 
dwType[[ 
=[[ 
FNativeAPIs[[ '
.[[' (
RESOURCETYPE_DISK[[( 9
;[[9 :
ns\\ 
.\\ 
lpLocalName\\ 
=\\  
drive\\! &
;\\& '
ns]] 
.]] 
lpRemoteName]] 
=]]  !

netwokPath]]" ,
;]], -
ns^^ 
.^^ 

lpProvider^^ 
=^^ 
null^^  $
;^^$ %
sb`` 
=`` 
new`` 
StringBuilder`` &
(``& '
capacity``' /
)``/ 0
;``0 1
errordd 
=dd 
FNativeAPIsdd #
.dd# $
WNetUseConnectiondd$ 5
(dd5 6
IntPtrdd6 <
.dd< =
Zerodd= A
,ddA B
refddC F
nsddG I
,ddI J
passwordddK S
,ddS T
userddU Y
,ddY Z
flagsdd[ `
,dd` a
sbddb d
,ddd e
refddf i
capacityddj r
,ddr s
outddt w
resultFlags	ddx ƒ
)
ddƒ „
;
dd„ …
ifee 
(ee 
erroree 
>ee 
$numee 
)ee 
{ff 
throwgg 
newgg 
Win32Exceptiongg ,
(gg, -
errorgg- 2
)gg2 3
;gg3 4
}hh 
}ii 
catchjj 
(jj 
	Exceptionjj 
exjj 
)jj  
{kk 
FDebugll 
.ll 
throwExceptionll %
(ll% &
exll& (
)ll( )
;ll) *
}mm 
finallynn 
{oo 
sbpp 
=pp 
nullpp 
;pp 
}qq 
}rr 	
publicvv 
staticvv 
stringvv 
connectvv $
(vv$ %
stringww 

netwokPathww 
,ww 
stringxx 
userxx 
,xx 
stringyy 
passwordyy 
)zz 
{{{ 	
FNativeAPIs|| 
.|| 
NETRESOURCE|| #
ns||$ &
=||' (
new||) ,
FNativeAPIs||- 8
.||8 9
NETRESOURCE||9 D
(||D E
)||E F
;||F G
StringBuilder}} 
sb}} 
=}} 
null}} #
;}}# $
uint~~ 
flags~~ 
=~~ 
$num~~ 
;~~ 
int 
capacity 
= 
$num 
; 
uint
€€ 
resultFlags
€€ 
=
€€ 
$num
€€  
;
€€  !
int
 
error
 
=
 
$num
 
;
 
try
ƒƒ 
{
„„ 
ns
…… 
.
…… 
dwType
…… 
=
…… 
FNativeAPIs
…… '
.
……' (
RESOURCETYPE_DISK
……( 9
;
……9 :
ns
†† 
.
†† 
lpLocalName
†† 
=
††  
null
††! %
;
††% &
ns
‡‡ 
.
‡‡ 
lpRemoteName
‡‡ 
=
‡‡  !

netwokPath
‡‡" ,
;
‡‡, -
ns
ˆˆ 
.
ˆˆ 

lpProvider
ˆˆ 
=
ˆˆ 
null
ˆˆ  $
;
ˆˆ$ %
sb
ŠŠ 
=
ŠŠ 
new
ŠŠ 
StringBuilder
ŠŠ &
(
ŠŠ& '
capacity
ŠŠ' /
)
ŠŠ/ 0
;
ŠŠ0 1
error
 
=
 
FNativeAPIs
 #
.
# $
WNetUseConnection
$ 5
(
5 6
IntPtr
6 <
.
< =
Zero
= A
,
A B
ref
C F
ns
G I
,
I J
password
K S
,
S T
user
U Y
,
Y Z
flags
[ `
,
` a
sb
b d
,
d e
ref
f i
capacity
j r
,
r s
out
t w
resultFlagsx ƒ
)ƒ „
;„ …
if
 
(
 
error
 
>
 
$num
 
)
 
{
 
throw
‘‘ 
new
‘‘ 
Win32Exception
‘‘ ,
(
‘‘, -
error
‘‘- 2
)
‘‘2 3
;
‘‘3 4
}
’’ 
return
–– 
sb
–– 
.
–– 
ToString
–– "
(
––" #
)
––# $
;
––$ %
}
—— 
catch
˜˜ 
(
˜˜ 
	Exception
˜˜ 
ex
˜˜ 
)
˜˜  
{
™™ 
FDebug
šš 
.
šš 
throwException
šš %
(
šš% &
ex
šš& (
)
šš( )
;
šš) *
}
›› 
finally
œœ 
{
 
sb
 
=
 
null
 
;
 
}
ŸŸ 
return
   
string
   
.
   
Empty
   
;
    
}
¡¡ 	
public
¥¥ 
static
¥¥ 
void
¥¥ 

disconnect
¥¥ %
(
¥¥% &
string
¦¦ 
drive
¦¦ 
)
§§ 
{
¨¨ 	
try
©© 
{
ªª 
FNativeAPIs
«« 
.
«« $
WNetCancelConnection2A
«« 2
(
««2 3
drive
««3 8
,
««8 9
$num
««: ;
,
««; <
$num
««= >
)
««> ?
;
««? @
}
¬¬ 
catch
­­ 
(
­­ 
	Exception
­­ 
ex
­­ 
)
­­  
{
®® 
FDebug
¯¯ 
.
¯¯ 
throwException
¯¯ %
(
¯¯% &
ex
¯¯& (
)
¯¯( )
;
¯¯) *
}
°° 
finally
±± 
{
²² 
}
´´ 
}
µµ 	
}
»» 
}¼¼ Î
^D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Resource\c_FUserPCInfo.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

static 
class 
FUserPCInfo #
{ 
private 
const 
String 
	WORKGROUP &
=' (
$str) U
;U V
private 
const 
String 
	OSVERSION &
=' (
$str) j
;j k
private 
const 
String 
DNSHOSTNAME (
=) *
$str+ }
;} ~
private 
const 
String 
	IPADDRESS &
=' (
$str) y
;y z
private 
const 
String 

MACADDRESS '
=( )
$str* {
;{ |
public## 
static## 
string## 
ComputerName## )
{$$ 	
get%% 
{&& 
try'' 
{(( 
return)) 
Environment)) &
.))& '
MachineName))' 2
;))2 3
}** 
catch++ 
(++ 
	Exception++  
ex++! #
)++# $
{,, 
FDebug-- 
.-- 
throwException-- )
(--) *
ex--* ,
)--, -
;--- .
}.. 
finally// 
{00 
}22 
return33 
string33 
.33 
Empty33 #
;33# $
}44 
}55 	
public99 
static99 
string99 
UserName99 %
{:: 	
get;; 
{<< 
try== 
{>> 
return?? 
Environment?? &
.??& '
UserName??' /
;??/ 0
}@@ 
catchAA 
(AA 
	ExceptionAA  
exAA! #
)AA# $
{BB 
FDebugCC 
.CC 
throwExceptionCC )
(CC) *
exCC* ,
)CC, -
;CC- .
}DD 
finallyEE 
{FF 
}HH 
returnII 
stringII 
.II 
EmptyII #
;II# $
}JJ 
}KK 	
publicTT 
staticTT 
stringTT 
getWorkGroupTT )
(TT) *
)UU 
{VV 	
ObjectQueryWW 
objectQueryWW #
=WW$ %
nullWW& *
;WW* +$
ManagementObjectSearcherXX $
searcherXX% -
=XX. /
nullXX0 4
;XX4 5&
ManagementObjectCollectionYY &
mosYY' *
=YY+ ,
nullYY- 1
;YY1 2
try[[ 
{\\ 
objectQuery__ 
=__ 
new__ !
System__" (
.__( )

Management__) 3
.__3 4
ObjectQuery__4 ?
(__? @
	WORKGROUP__@ I
)__I J
;__J K
searcher`` 
=`` 
new`` 
System`` %
.``% &

Management``& 0
.``0 1$
ManagementObjectSearcher``1 I
(``I J
objectQuery``J U
)``U V
;``V W
mosaa 
=aa 
searcheraa 
.aa 
Getaa "
(aa" #
)aa# $
;aa$ %
foreachee 
(ee 
Systemee 
.ee  

Managementee  *
.ee* +
ManagementObjectee+ ;
moee< >
inee? A
moseeB E
)eeE F
{ff 
returnjj 
mojj 
.jj 

Propertiesjj (
[jj( )
$strjj) 4
]jj4 5
.jj5 6
Valuejj6 ;
==jj< >
nulljj? C
?jjD E
stringjjF L
.jjL M
EmptyjjM R
:jjS T
mojjU W
[jjW X
$strjjX c
]jjc d
.jjd e
ToStringjje m
(jjm n
)jjn o
;jjo p
}kk 
}ll 
catchmm 
(mm 
	Exceptionmm 
exmm 
)mm  
{nn 
FDebugoo 
.oo 
throwExceptionoo %
(oo% &
exoo& (
)oo( )
;oo) *
}pp 
finallyqq 
{rr 
objectQueryss 
=ss 
nullss "
;ss" #
searchertt 
=tt 
nulltt 
;tt  
mosuu 
=uu 
nulluu 
;uu 
}vv 
returnww 
stringww 
.ww 
Emptyww 
;ww  
}xx 	
public|| 
static|| 
string|| 
getOSVersion|| )
(||) *
)}} 
{~~ 	
ObjectQuery 
objectQuery #
=$ %
null& *
;* +&
ManagementObjectSearcher
€€ $
searcher
€€% -
=
€€. /
null
€€0 4
;
€€4 5(
ManagementObjectCollection
 &
mos
' *
=
+ ,
null
- 1
;
1 2
string
‚‚ 
	osVersion
‚‚ 
=
‚‚ 
string
‚‚ %
.
‚‚% &
Empty
‚‚& +
;
‚‚+ ,
try
„„ 
{
…… 
objectQuery
ˆˆ 
=
ˆˆ 
new
ˆˆ !
System
ˆˆ" (
.
ˆˆ( )

Management
ˆˆ) 3
.
ˆˆ3 4
ObjectQuery
ˆˆ4 ?
(
ˆˆ? @
	OSVERSION
ˆˆ@ I
)
ˆˆI J
;
ˆˆJ K
searcher
‰‰ 
=
‰‰ 
new
‰‰ 
System
‰‰ %
.
‰‰% &

Management
‰‰& 0
.
‰‰0 1&
ManagementObjectSearcher
‰‰1 I
(
‰‰I J
objectQuery
‰‰J U
)
‰‰U V
;
‰‰V W
mos
ŠŠ 
=
ŠŠ 
searcher
ŠŠ 
.
ŠŠ 
Get
ŠŠ "
(
ŠŠ" #
)
ŠŠ# $
;
ŠŠ$ %
foreach
 
(
 
System
 
.
  

Management
  *
.
* +
ManagementObject
+ ;
mo
< >
in
? A
mos
B E
)
E F
{
 
	osVersion
 
=
 
mo
  "
[
" #
$str
# ,
]
, -
.
- .
ToString
. 6
(
6 7
)
7 8
;
8 9
if
‘‘ 
(
‘‘ 
mo
‘‘ 
[
‘‘ 
$str
‘‘ 1
]
‘‘1 2
!=
‘‘3 5
null
‘‘6 :
)
‘‘: ;
{
’’ 
	osVersion
““ !
+=
““" $
mo
““% '
[
““' (
$str
““( >
]
““> ?
.
““? @
ToString
““@ H
(
““H I
)
““I J
;
““J K
}
”” 
return
•• 
	osVersion
•• $
.
••$ %
Trim
••% )
(
••) *
)
••* +
;
••+ ,
}
–– 
}
—— 
catch
˜˜ 
(
˜˜ 
	Exception
˜˜ 
ex
˜˜ 
)
˜˜  
{
™™ 
FDebug
šš 
.
šš 
throwException
šš %
(
šš% &
ex
šš& (
)
šš( )
;
šš) *
}
›› 
finally
œœ 
{
 
objectQuery
 
=
 
null
 "
;
" #
searcher
ŸŸ 
=
ŸŸ 
null
ŸŸ 
;
ŸŸ  
mos
   
=
   
null
   
;
   
}
¡¡ 
return
¢¢ 
string
¢¢ 
.
¢¢ 
Empty
¢¢ 
;
¢¢  
}
££ 	
public
§§ 
static
§§ 
string
§§ 
[
§§ 
]
§§ 
getIPAddressList
§§ /
(
§§/ 0
)
¨¨ 
{
©© 	
List
ªª 
<
ªª 
string
ªª 
>
ªª 
ipList
ªª 
=
ªª  !
new
ªª" %
List
ªª& *
<
ªª* +
string
ªª+ 1
>
ªª1 2
(
ªª2 3
)
ªª3 4
;
ªª4 5
ObjectQuery
«« 
objectQuery
«« #
=
««$ %
null
««& *
;
««* +&
ManagementObjectSearcher
¬¬ $
searcher
¬¬% -
=
¬¬. /
null
¬¬0 4
;
¬¬4 5(
ManagementObjectCollection
­­ &
mos
­­' *
=
­­+ ,
null
­­- 1
;
­­1 2
try
¯¯ 
{
°° 
objectQuery
³³ 
=
³³ 
new
³³ !
System
³³" (
.
³³( )

Management
³³) 3
.
³³3 4
ObjectQuery
³³4 ?
(
³³? @
	IPADDRESS
³³@ I
)
³³I J
;
³³J K
searcher
´´ 
=
´´ 
new
´´ 
System
´´ %
.
´´% &

Management
´´& 0
.
´´0 1&
ManagementObjectSearcher
´´1 I
(
´´I J
objectQuery
´´J U
)
´´U V
;
´´V W
mos
µµ 
=
µµ 
searcher
µµ 
.
µµ 
Get
µµ "
(
µµ" #
)
µµ# $
;
µµ$ %
foreach
¹¹ 
(
¹¹ 
System
¹¹ 
.
¹¹  

Management
¹¹  *
.
¹¹* +
ManagementObject
¹¹+ ;
mo
¹¹< >
in
¹¹? A
mos
¹¹B E
)
¹¹E F
{
ºº 
string
»» 
[
»» 
]
»» 
AddressList
»» (
=
»») *
(
»»+ ,
string
»», 2
[
»»2 3
]
»»3 4
)
»»4 5
mo
»»5 7
[
»»7 8
$str
»»8 C
]
»»C D
;
»»D E
foreach
¼¼ 
(
¼¼ 
string
¼¼ #
Address
¼¼$ +
in
¼¼, .
AddressList
¼¼/ :
)
¼¼: ;
{
½½ 
System
¿¿ 
.
¿¿ 
Net
¿¿ "
.
¿¿" #
	IPAddress
¿¿# ,
	ipAddress
¿¿- 6
;
¿¿6 7
if
ÀÀ 
(
ÀÀ 
System
ÀÀ "
.
ÀÀ" #
Net
ÀÀ# &
.
ÀÀ& '
	IPAddress
ÀÀ' 0
.
ÀÀ0 1
TryParse
ÀÀ1 9
(
ÀÀ9 :
Address
ÀÀ: A
,
ÀÀA B
out
ÀÀC F
	ipAddress
ÀÀG P
)
ÀÀP Q
)
ÀÀQ R
{
ÁÁ 
if
ÂÂ 
(
ÂÂ  
	ipAddress
ÂÂ  )
.
ÂÂ) *
AddressFamily
ÂÂ* 7
==
ÂÂ8 :
System
ÂÂ; A
.
ÂÂA B
Net
ÂÂB E
.
ÂÂE F
Sockets
ÂÂF M
.
ÂÂM N
AddressFamily
ÂÂN [
.
ÂÂ[ \
InterNetwork
ÂÂ\ h
)
ÂÂh i
{
ÃÃ 
ipList
ÄÄ  &
.
ÄÄ& '
Add
ÄÄ' *
(
ÄÄ* +
Address
ÄÄ+ 2
)
ÄÄ2 3
;
ÄÄ3 4
break
ÅÅ  %
;
ÅÅ% &
}
ÆÆ 
}
ÇÇ 
}
ÈÈ 
}
ÉÉ 
return
ÊÊ 
ipList
ÊÊ 
.
ÊÊ 
ToArray
ÊÊ %
(
ÊÊ% &
)
ÊÊ& '
;
ÊÊ' (
}
ËË 
catch
ÌÌ 
(
ÌÌ 
	Exception
ÌÌ 
ex
ÌÌ 
)
ÌÌ  
{
ÍÍ 
FDebug
ÎÎ 
.
ÎÎ 
throwException
ÎÎ %
(
ÎÎ% &
ex
ÎÎ& (
)
ÎÎ( )
;
ÎÎ) *
}
ÏÏ 
finally
ĞĞ 
{
ÑÑ 
ipList
ÒÒ 
=
ÒÒ 
null
ÒÒ 
;
ÒÒ 
objectQuery
ÓÓ 
=
ÓÓ 
null
ÓÓ "
;
ÓÓ" #
searcher
ÔÔ 
=
ÔÔ 
null
ÔÔ 
;
ÔÔ  
mos
ÕÕ 
=
ÕÕ 
null
ÕÕ 
;
ÕÕ 
}
ÖÖ 
return
×× 
null
×× 
;
×× 
}
ØØ 	
public
ÜÜ 
static
ÜÜ 
string
ÜÜ 
getIPAddress
ÜÜ )
(
ÜÜ) *
)
İİ 
{
ŞŞ 	
List
ßß 
<
ßß 
string
ßß 
>
ßß 
ipList
ßß 
=
ßß  !
new
ßß" %
List
ßß& *
<
ßß* +
string
ßß+ 1
>
ßß1 2
(
ßß2 3
)
ßß3 4
;
ßß4 5
ObjectQuery
àà 
objectQuery
àà #
=
àà$ %
null
àà& *
;
àà* +&
ManagementObjectSearcher
áá $
searcher
áá% -
=
áá. /
null
áá0 4
;
áá4 5(
ManagementObjectCollection
ââ &
mos
ââ' *
=
ââ+ ,
null
ââ- 1
;
ââ1 2
try
ää 
{
åå 
objectQuery
èè 
=
èè 
new
èè !
System
èè" (
.
èè( )

Management
èè) 3
.
èè3 4
ObjectQuery
èè4 ?
(
èè? @
	IPADDRESS
èè@ I
)
èèI J
;
èèJ K
searcher
éé 
=
éé 
new
éé 
System
éé %
.
éé% &

Management
éé& 0
.
éé0 1&
ManagementObjectSearcher
éé1 I
(
ééI J
objectQuery
ééJ U
)
ééU V
;
ééV W
mos
êê 
=
êê 
searcher
êê 
.
êê 
Get
êê "
(
êê" #
)
êê# $
;
êê$ %
foreach
îî 
(
îî 
System
îî 
.
îî  

Management
îî  *
.
îî* +
ManagementObject
îî+ ;
mo
îî< >
in
îî? A
mos
îîB E
)
îîE F
{
ïï 
string
ğğ 
[
ğğ 
]
ğğ 
AddressList
ğğ (
=
ğğ) *
(
ğğ+ ,
string
ğğ, 2
[
ğğ2 3
]
ğğ3 4
)
ğğ4 5
mo
ğğ5 7
[
ğğ7 8
$str
ğğ8 C
]
ğğC D
;
ğğD E
foreach
ññ 
(
ññ 
string
ññ #
Address
ññ$ +
in
ññ, .
AddressList
ññ/ :
)
ññ: ;
{
òò 
System
ôô 
.
ôô 
Net
ôô "
.
ôô" #
	IPAddress
ôô# ,
	ipAddress
ôô- 6
;
ôô6 7
if
õõ 
(
õõ 
System
õõ "
.
õõ" #
Net
õõ# &
.
õõ& '
	IPAddress
õõ' 0
.
õõ0 1
TryParse
õõ1 9
(
õõ9 :
Address
õõ: A
,
õõA B
out
õõC F
	ipAddress
õõG P
)
õõP Q
)
õõQ R
{
öö 
if
÷÷ 
(
÷÷  
	ipAddress
÷÷  )
.
÷÷) *
AddressFamily
÷÷* 7
==
÷÷8 :
System
÷÷; A
.
÷÷A B
Net
÷÷B E
.
÷÷E F
Sockets
÷÷F M
.
÷÷M N
AddressFamily
÷÷N [
.
÷÷[ \
InterNetwork
÷÷\ h
)
÷÷h i
{
øø 
return
ùù  &
Address
ùù' .
;
ùù. /
}
úú 
}
ûû 
}
üü 
}
ıı 
return
şş 
$str
şş "
;
şş" #
}
ÿÿ 
catch
€€ 
(
€€ 
	Exception
€€ 
ex
€€ 
)
€€  
{
 
FDebug
‚‚ 
.
‚‚ 
throwException
‚‚ %
(
‚‚% &
ex
‚‚& (
)
‚‚( )
;
‚‚) *
}
ƒƒ 
finally
„„ 
{
…… 
ipList
†† 
=
†† 
null
†† 
;
†† 
objectQuery
‡‡ 
=
‡‡ 
null
‡‡ "
;
‡‡" #
searcher
ˆˆ 
=
ˆˆ 
null
ˆˆ 
;
ˆˆ  
mos
‰‰ 
=
‰‰ 
null
‰‰ 
;
‰‰ 
}
ŠŠ 
return
‹‹ 
null
‹‹ 
;
‹‹ 
}
ŒŒ 	
public
 
static
 
string
 
[
 
]
 
MacAddressList
 -
(
- .
)
‘‘ 
{
’’ 	
List
““ 
<
““ 
string
““ 
>
““ 
macList
““  
=
““! "
new
““# &
List
““' +
<
““+ ,
string
““, 2
>
““2 3
(
““3 4
)
““4 5
;
““5 6
ObjectQuery
”” 
objectQuery
”” #
=
””$ %
null
””& *
;
””* +&
ManagementObjectSearcher
•• $
searcher
••% -
=
••. /
null
••0 4
;
••4 5(
ManagementObjectCollection
–– &
mos
––' *
=
––+ ,
null
––- 1
;
––1 2
try
˜˜ 
{
™™ 
objectQuery
œœ 
=
œœ 
new
œœ !
System
œœ" (
.
œœ( )

Management
œœ) 3
.
œœ3 4
ObjectQuery
œœ4 ?
(
œœ? @

MACADDRESS
œœ@ J
)
œœJ K
;
œœK L
searcher
 
=
 
new
 
System
 %
.
% &

Management
& 0
.
0 1&
ManagementObjectSearcher
1 I
(
I J
objectQuery
J U
)
U V
;
V W
mos
 
=
 
searcher
 
.
 
Get
 "
(
" #
)
# $
;
$ %
foreach
¢¢ 
(
¢¢ 
System
¢¢ 
.
¢¢  

Management
¢¢  *
.
¢¢* +
ManagementObject
¢¢+ ;
mo
¢¢< >
in
¢¢? A
mos
¢¢B E
)
¢¢E F
{
££ 
macList
¤¤ 
.
¤¤ 
Add
¤¤ 
(
¤¤  
mo
¤¤  "
[
¤¤" #
$str
¤¤# /
]
¤¤/ 0
as
¤¤1 3
string
¤¤4 :
)
¤¤: ;
;
¤¤; <
}
¥¥ 
return
¦¦ 
macList
¦¦ 
.
¦¦ 
ToArray
¦¦ &
(
¦¦& '
)
¦¦' (
;
¦¦( )
}
§§ 
catch
¨¨ 
(
¨¨ 
	Exception
¨¨ 
ex
¨¨ 
)
¨¨  
{
©© 
FDebug
ªª 
.
ªª 
throwException
ªª %
(
ªª% &
ex
ªª& (
)
ªª( )
;
ªª) *
}
«« 
finally
¬¬ 
{
­­ 
macList
®® 
=
®® 
null
®® 
;
®® 
objectQuery
¯¯ 
=
¯¯ 
null
¯¯ "
;
¯¯" #
searcher
°° 
=
°° 
null
°° 
;
°°  
mos
±± 
=
±± 
null
±± 
;
±± 
}
²² 
return
³³ 
null
³³ 
;
³³ 
}
´´ 	
}
ºº 
}»» ´A
cD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Resource\c_FProcessResource.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FProcessResource !
:" #
IDisposable$ /
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
string 
m_processName $
=% &
string' -
.- .
Empty. 3
;3 4
private 
bool 
m_isRun 
= 
false $
;$ %
private 
List 
< 
double 
> 
m_cpuUsageList +
=, -
null. 2
;2 3
private 
double 
m_memoryUsage $
=% &
$num' (
;( )
private   
double   
m_diskUsage   "
=  # $
$num  % &
;  & '
public&& 
FProcessResource&& 
(&&  
string'' 
processName'' 
)(( 
{)) 	
m_processName** 
=** 
processName** '
;**' (
m_cpuUsageList++ 
=++ 
new++  
List++! %
<++% &
double++& ,
>++, -
(++- .
)++. /
;++/ 0
},, 	
~00 	
FProcessResource00	 
(00 
)11 
{22 	
	myDispose33 
(33 
false33 
)33 
;33 
}44 	
	protected88 
void88 
	myDispose88  
(88  !
bool99 
	disposing99 
):: 
{;; 	
if<< 
(<< 
!<< 

m_disposed<< 
)<< 
{== 
if>> 
(>> 
	disposing>> 
)>> 
{?? 
m_cpuUsageList@@ "
=@@# $
null@@% )
;@@) *
}AA 

m_disposedCC 
=CC 
trueCC !
;CC! "
}DD 
}EE 	
publicMM 
voidMM 
DisposeMM 
(MM 
)NN 
{OO 	
	myDisposePP 
(PP 
truePP 
)PP 
;PP 
GCQQ 
.QQ 
SuppressFinalizeQQ 
(QQ  
thisQQ  $
)QQ$ %
;QQ% &
}RR 	
publicZZ 
stringZZ 
processNameZZ !
{[[ 	
get\\ 
{]] 
try^^ 
{__ 
return`` 
m_processName`` (
;``( )
}aa 
catchbb 
(bb 
	Exceptionbb  
exbb! #
)bb# $
{cc 
FDebugdd 
.dd 
throwExceptiondd )
(dd) *
exdd* ,
)dd, -
;dd- .
}ee 
finallyff 
{gg 
}ii 
returnjj 
nulljj 
;jj 
}kk 
}ll 	
publicpp 
boolpp 
isRunpp 
{qq 	
getrr 
{ss 
trytt 
{uu 
returnvv 
m_isRunvv "
;vv" #
}ww 
catchxx 
(xx 
	Exceptionxx  
exxx! #
)xx# $
{yy 
FDebugzz 
.zz 
throwExceptionzz )
(zz) *
exzz* ,
)zz, -
;zz- .
}{{ 
finally|| 
{}} 
} 
return
€€ 
false
€€ 
;
€€ 
}
 
set
ƒƒ 
{
„„ 
try
…… 
{
†† 
m_isRun
‡‡ 
=
‡‡ 
value
‡‡ #
;
‡‡# $
}
ˆˆ 
catch
‰‰ 
(
‰‰ 
	Exception
‰‰  
ex
‰‰! #
)
‰‰# $
{
ŠŠ 
FDebug
‹‹ 
.
‹‹ 
throwException
‹‹ )
(
‹‹) *
ex
‹‹* ,
)
‹‹, -
;
‹‹- .
}
ŒŒ 
finally
 
{
 
}
 
}
‘‘ 
}
’’ 	
public
–– 
double
–– 
cpuUsage
–– 
{
—— 	
get
˜˜ 
{
™™ 
double
šš 
usage
šš 
=
šš 
$num
šš  
;
šš  !
try
›› 
{
œœ 
if
 
(
 
m_cpuUsageList
 &
.
& '
Count
' ,
>
- .
$num
/ 0
)
0 1
{
 
usage
ŸŸ 
=
ŸŸ 
m_cpuUsageList
ŸŸ  .
.
ŸŸ. /
Average
ŸŸ/ 6
(
ŸŸ6 7
)
ŸŸ7 8
;
ŸŸ8 9
}
   
return
¡¡ 
usage
¡¡  
;
¡¡  !
}
¢¢ 
catch
££ 
(
££ 
	Exception
££  
ex
££! #
)
££# $
{
¤¤ 
FDebug
¥¥ 
.
¥¥ 
throwException
¥¥ )
(
¥¥) *
ex
¥¥* ,
)
¥¥, -
;
¥¥- .
}
¦¦ 
finally
§§ 
{
¨¨ 
}
ªª 
return
«« 
$num
«« 
;
«« 
}
¬¬ 
set
®® 
{
¯¯ 
try
°° 
{
±± 
m_cpuUsageList
²² "
.
²²" #
Add
²²# &
(
²²& '
value
²²' ,
)
²², -
;
²²- .
}
³³ 
catch
´´ 
(
´´ 
	Exception
´´  
ex
´´! #
)
´´# $
{
µµ 
FDebug
¶¶ 
.
¶¶ 
throwException
¶¶ )
(
¶¶) *
ex
¶¶* ,
)
¶¶, -
;
¶¶- .
}
·· 
finally
¸¸ 
{
¹¹ 
}
»» 
}
¼¼ 
}
½½ 	
public
ÁÁ 
double
ÁÁ 
memoryUsage
ÁÁ !
{
ÂÂ 	
get
ÃÃ 
{
ÄÄ 
try
ÅÅ 
{
ÆÆ 
return
ÇÇ 
m_memoryUsage
ÇÇ (
;
ÇÇ( )
}
ÈÈ 
catch
ÉÉ 
(
ÉÉ 
	Exception
ÉÉ  
ex
ÉÉ! #
)
ÉÉ# $
{
ÊÊ 
FDebug
ËË 
.
ËË 
throwException
ËË )
(
ËË) *
ex
ËË* ,
)
ËË, -
;
ËË- .
}
ÌÌ 
finally
ÍÍ 
{
ÎÎ 
}
ĞĞ 
return
ÑÑ 
$num
ÑÑ 
;
ÑÑ 
}
ÒÒ 
set
ÔÔ 
{
ÕÕ 
try
ÖÖ 
{
×× 
m_memoryUsage
ØØ !
=
ØØ" #
value
ØØ$ )
;
ØØ) *
}
ÙÙ 
catch
ÚÚ 
(
ÚÚ 
	Exception
ÚÚ  
ex
ÚÚ! #
)
ÚÚ# $
{
ÛÛ 
FDebug
ÜÜ 
.
ÜÜ 
throwException
ÜÜ )
(
ÜÜ) *
ex
ÜÜ* ,
)
ÜÜ, -
;
ÜÜ- .
}
İİ 
finally
ŞŞ 
{
ßß 
}
áá 
}
ââ 
}
ãã 	
public
çç 
double
çç 
	diskUsage
çç 
{
èè 	
get
éé 
{
êê 
try
ëë 
{
ìì 
return
íí 
m_diskUsage
íí &
;
íí& '
}
îî 
catch
ïï 
(
ïï 
	Exception
ïï  
ex
ïï! #
)
ïï# $
{
ğğ 
FDebug
ññ 
.
ññ 
throwException
ññ )
(
ññ) *
ex
ññ* ,
)
ññ, -
;
ññ- .
}
òò 
finally
óó 
{
ôô 
}
öö 
return
÷÷ 
$num
÷÷ 
;
÷÷ 
}
øø 
set
úú 
{
ûû 
try
üü 
{
ıı 
m_diskUsage
şş 
=
şş  !
value
şş" '
;
şş' (
}
ÿÿ 
catch
€€ 
(
€€ 
	Exception
€€  
ex
€€! #
)
€€# $
{
 
FDebug
‚‚ 
.
‚‚ 
throwException
‚‚ )
(
‚‚) *
ex
‚‚* ,
)
‚‚, -
;
‚‚- .
}
ƒƒ 
finally
„„ 
{
…… 
}
‡‡ 
}
ˆˆ 
}
‰‰ 	
}
•• 
}–– ½;
mD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Resource\c_FProcessResourceCollection.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class &
FProcessResourceCollection +
:, -
IDisposable. 9
,9 :
IEnumerable; F
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 

Dictionary 
< 
string !
,! "
FProcessResource# 3
>3 4
m_fProcResDict5 C
=D E
nullF J
;J K
private 
List 
< 
FProcessResource %
>% &
m_fProcResList' 5
=6 7
null8 <
;< =
internal## &
FProcessResourceCollection## +
(##+ ,

Dictionary$$ 
<$$ 
string$$ 
,$$ 
FProcessResource$$ /
>$$/ 0
fProcResDict$$1 =
,$$= >
List%% 
<%% 
FProcessResource%% !
>%%! "
fProcResList%%# /
)&& 
{'' 	
m_fProcResDict(( 
=(( 
fProcResDict(( )
;(() *
m_fProcResList)) 
=)) 
fProcResList)) )
;))) *
}** 	
~.. 	&
FProcessResourceCollection..	 #
(..# $
)// 
{00 	
	myDispose11 
(11 
false11 
)11 
;11 
}22 	
	protected66 
void66 
	myDispose66  
(66  !
bool77 
	disposing77 
)88 
{99 	
if:: 
(:: 
!:: 

m_disposed:: 
):: 
{;; 
if<< 
(<< 
	disposing<< 
)<< 
{== 
m_fProcResDict>> "
=>># $
null>>% )
;>>) *
m_fProcResList?? "
=??# $
null??% )
;??) *
}@@ 
}AA 

m_disposedCC 
=CC 
trueCC 
;CC 
}DD 	
publicLL 
voidLL 
DisposeLL 
(LL 
)MM 
{NN 	
	myDisposeOO 
(OO 
trueOO 
)OO 
;OO 
GCPP 
.PP 
SuppressFinalizePP 
(PP  
thisPP  $
)PP$ %
;PP% &
}QQ 	
publicYY 
IEnumeratorYY 
GetEnumeratorYY (
(YY( )
)ZZ 
{[[ 	
try\\ 
{]] 
return^^ 
new^^ 0
$FProcessResourceCollectionEnumerator^^ ?
(^^? @
this^^@ D
)^^D E
;^^E F
}__ 
catch`` 
(`` 
	Exception`` 
ex`` 
)``  
{aa 
FDebugbb 
.bb 
throwExceptionbb %
(bb% &
exbb& (
)bb( )
;bb) *
}cc 
finallydd 
{ee 
}ff 
returngg 
nullgg 
;gg 
}hh 	
publicll 
intll 
countll 
{mm 	
getnn 
{oo 
trypp 
{qq 
returnrr 
m_fProcResListrr )
.rr) *
Countrr* /
;rr/ 0
}ss 
catchtt 
(tt 
	Exceptiontt  
extt! #
)tt# $
{uu 
FDebugvv 
.vv 
throwExceptionvv )
(vv) *
exvv* ,
)vv, -
;vv- .
}ww 
finallyxx 
{yy 
}{{ 
return|| 
$num|| 
;|| 
}}} 
}~~ 	
public
‚‚ 
FProcessResource
‚‚ 
this
‚‚  $
[
‚‚$ %
int
‚‚% (
i
‚‚) *
]
‚‚* +
{
ƒƒ 	
get
„„ 
{
…… 
try
†† 
{
‡‡ 
if
ˆˆ 
(
ˆˆ 
i
ˆˆ 
<
ˆˆ 
$num
ˆˆ 
||
ˆˆ  
i
ˆˆ! "
>=
ˆˆ# %
m_fProcResList
ˆˆ& 4
.
ˆˆ4 5
Count
ˆˆ5 :
)
ˆˆ: ;
{
‰‰ 
return
ŠŠ 
null
ŠŠ #
;
ŠŠ# $
}
‹‹ 
return
ŒŒ 
m_fProcResList
ŒŒ )
[
ŒŒ) *
i
ŒŒ* +
]
ŒŒ+ ,
;
ŒŒ, -
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
‘‘ 
finally
’’ 
{
““ 
}
•• 
return
–– 
null
–– 
;
–– 
}
—— 
}
˜˜ 	
public
œœ 
FProcessResource
œœ 
this
œœ  $
[
œœ$ %
string
œœ% +
name
œœ, 0
]
œœ0 1
{
 	
get
 
{
ŸŸ 
try
   
{
¡¡ 
if
¢¢ 
(
¢¢ 
!
¢¢ 
m_fProcResDict
¢¢ '
.
¢¢' (
ContainsKey
¢¢( 3
(
¢¢3 4
name
¢¢4 8
)
¢¢8 9
)
¢¢9 :
{
££ 
return
¤¤ 
null
¤¤ #
;
¤¤# $
}
¥¥ 
return
¦¦ 
m_fProcResDict
¦¦ )
[
¦¦) *
name
¦¦* .
]
¦¦. /
;
¦¦/ 0
}
§§ 
catch
¨¨ 
(
¨¨ 
	Exception
¨¨  
ex
¨¨! #
)
¨¨# $
{
©© 
FDebug
ªª 
.
ªª 
throwException
ªª )
(
ªª) *
ex
ªª* ,
)
ªª, -
;
ªª- .
}
«« 
finally
¬¬ 
{
­­ 
}
¯¯ 
return
°° 
null
°° 
;
°° 
}
±± 
}
²² 	
public
ºº 
object
ºº 
item
ºº 
(
ºº 
int
»» 
index
»» 
)
¼¼ 
{
½½ 	
try
¾¾ 
{
¿¿ 
return
ÀÀ 
this
ÀÀ 
[
ÀÀ 
index
ÀÀ !
]
ÀÀ! "
;
ÀÀ" #
}
ÁÁ 
catch
ÂÂ 
(
ÂÂ 
	Exception
ÂÂ 
ex
ÂÂ 
)
ÂÂ  
{
ÃÃ 
FDebug
ÄÄ 
.
ÄÄ 
throwException
ÄÄ %
(
ÄÄ% &
ex
ÄÄ& (
)
ÄÄ( )
;
ÄÄ) *
}
ÅÅ 
finally
ÆÆ 
{
ÇÇ 
}
ÉÉ 
return
ÊÊ 
null
ÊÊ 
;
ÊÊ 
}
ËË 	
public
ÏÏ 
object
ÏÏ 
item
ÏÏ 
(
ÏÏ 
string
ĞĞ 
name
ĞĞ 
)
ÑÑ 
{
ÒÒ 	
try
ÓÓ 
{
ÔÔ 
return
ÕÕ 
this
ÕÕ 
[
ÕÕ 
name
ÕÕ  
]
ÕÕ  !
;
ÕÕ! "
}
ÖÖ 
catch
×× 
(
×× 
	Exception
×× 
ex
×× 
)
××  
{
ØØ 
FDebug
ÙÙ 
.
ÙÙ 
throwException
ÙÙ %
(
ÙÙ% &
ex
ÙÙ& (
)
ÙÙ( )
;
ÙÙ) *
}
ÚÚ 
finally
ÛÛ 
{
ÜÜ 
}
ŞŞ 
return
ßß 
null
ßß 
;
ßß 
}
àà 	
}
ææ 
}çç È
wD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Resource\c_FProcessResourceCollectionEnumerator.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 0
$FProcessResourceCollectionEnumerator 5
:6 7
IEnumerator8 C
,C D
IDisposableE P
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
int 
m_index 
= 
- 
$num  
;  !
private &
FProcessResourceCollection *
m_fProcResCol+ 8
=9 :
null; ?
;? @
public## 0
$FProcessResourceCollectionEnumerator## 3
(##3 4&
FProcessResourceCollection$$ &
fProcResCol$$' 2
)%% 
{&& 	
m_fProcResCol'' 
='' 
fProcResCol'' '
;''' (
}(( 	
~,, 	0
$FProcessResourceCollectionEnumerator,,	 -
(,,- .
)-- 
{.. 	
}00 	
	protected44 
void44 
	myDispose44  
(44  !
bool55 
	disposing55 
)66 
{77 	
if88 
(88 
!88 

m_disposed88 
)88 
{99 
if:: 
(:: 
	disposing:: 
):: 
{;; 
m_fProcResCol<< !
=<<" #
null<<$ (
;<<( )
}== 
}>> 

m_disposed?? 
=?? 
true?? 
;?? 
}@@ 	
publicHH 
voidHH 
DisposeHH 
(HH 
)II 
{JJ 	
	myDisposeKK 
(KK 
trueKK 
)KK 
;KK 
}LL 	
publicTT 
objectTT 
CurrentTT 
{UU 	
getVV 
{WW 
tryXX 
{YY 
returnZZ 
m_fProcResColZZ (
[ZZ( )
m_indexZZ) 0
]ZZ0 1
;ZZ1 2
}[[ 
catch\\ 
(\\ 
	Exception\\  
ex\\! #
)\\# $
{]] 
FDebug^^ 
.^^ 
throwException^^ )
(^^) *
ex^^* ,
)^^, -
;^^- .
}__ 
finally`` 
{aa 
}cc 
returndd 
nulldd 
;dd 
}ee 
}ff 	
publicjj 
booljj 
MoveNextjj 
(jj 
)kk 
{ll 	
trymm 
{nn 
m_indexoo 
++oo 
;oo 
returnpp 
(pp 
m_indexpp 
<pp  !
m_fProcResColpp" /
.pp/ 0
countpp0 5
)pp5 6
;pp6 7
}qq 
catchrr 
(rr 
Systemrr 
.rr 
	Exceptionrr #
exrr$ &
)rr& '
{ss 
FDebugtt 
.tt 
throwExceptiontt %
(tt% &
extt& (
)tt( )
;tt) *
}uu 
finallyvv 
{ww 
}yy 
returnzz 
falsezz 
;zz 
}{{ 	
public 
void 
Reset 
( 
)
€€ 
{
 	
try
‚‚ 
{
ƒƒ 
m_index
„„ 
=
„„ 
-
„„ 
$num
„„ 
;
„„ 
}
…… 
catch
†† 
(
†† 
System
†† 
.
†† 
	Exception
†† #
ex
††$ &
)
††& '
{
‡‡ 
FDebug
ˆˆ 
.
ˆˆ 
throwException
ˆˆ %
(
ˆˆ% &
ex
ˆˆ& (
)
ˆˆ( )
;
ˆˆ) *
}
‰‰ 
finally
ŠŠ 
{
‹‹ 
}
 
}
 	
}
”” 
}•• ¸‰
^D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Telnet\c_FTelnetClient.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FTelnetClient 
:  
IDisposable! ,
{ 
public 
event +
FTelnetStateChangedEventHandler 4
TelnetStateChanged5 G
;G H
public 
event -
!FTelnetPacketReceivedEventHandler 6 
TelnetPacketReceived7 K
;K L
public 
event )
FTelnetPacketSentEventHandler 2
TelnetPacketSent3 C
;C D
public 
const 
int 
DefaultPort $
=% &
$num' )
;) *
private 
bool 

m_disposed 
=  !
false" '
;' (
private   
BitArray   
m_enabledOptions   )
=  * +
null  , 0
;  0 1
private!! 
BitArray!! 
m_localOptions!! '
=!!( )
null!!* .
;!!. /
private"" 
BitArray"" 
m_remoteOptions"" (
="") *
null""+ /
;""/ 0
private## 
List## 
<## 
FTelnetOptionPacket## (
>##( )
m_fReqQueue##* 5
=##6 7
null##8 <
;##< =
private$$ 
FTelnetParser$$ 
	m_fParser$$ '
=$$( )
null$$* .
;$$. /
private&& 
	FCodeLock&& 
m_fMainSync&& %
=&&& '
null&&( ,
;&&, -
private'' 
FTelnetEventPusher'' "
m_fEventPusher''# 1
=''2 3
null''4 8
;''8 9
private-- 
FTelnetClient-- 
(-- 
).. 
{// 	
this00 
.00 
m_enabledOptions00 !
=00" #
new00$ '
BitArray00( 0
(000 1
$num001 4
,004 5
false006 ;
)00; <
;00< =
this11 
.11 
m_localOptions11 
=11  !
new11" %
BitArray11& .
(11. /
$num11/ 2
,112 3
false114 9
)119 :
;11: ;
this22 
.22 
m_remoteOptions22  
=22! "
new22# &
BitArray22' /
(22/ 0
$num220 3
,223 4
false225 :
)22: ;
;22; <
this44 
.44 
m_fReqQueue44 
=44 
new44 "
List44# '
<44' (
FTelnetOptionPacket44( ;
>44; <
(44< =
)44= >
;44> ?
}55 	
public99 
FTelnetClient99 
(99 

FTcpClient:: 

fTcpClient:: !
);; 
:<< 
this<< 
(<< 
)<< 
{== 	
this>> 
.>> 
	m_fParser>> 
=>> 
new>>  
FTelnetParser>>! .
(>>. /

fTcpClient>>/ 9
)>>9 :
;>>: ;
init@@ 
(@@ 
)@@ 
;@@ 
}AA 	
~EE 	
FTelnetClientEE	 
(EE 
)FF 
{GG 	
	myDisposeHH 
(HH 
falseHH 
)HH 
;HH 
}II 	
	protectedMM 
voidMM 
	myDisposeMM  
(MM  !
boolNN 
	disposingNN 
)OO 
{PP 	
ifQQ 
(QQ 
!QQ 

m_disposedQQ 
)QQ 
{RR 
ifSS 
(SS 
	disposingSS 
)SS 
{TT 
termUU 
(UU 
)UU 
;UU 
}VV 

m_disposedWW 
=WW 
trueWW !
;WW! "
}XX 
}YY 	
publicaa 
voidaa 
Disposeaa 
(aa 
)bb 
{cc 	
	myDisposedd 
(dd 
truedd 
)dd 
;dd 
GCee 
.ee 
SuppressFinalizeee 
(ee  
thisee  $
)ee$ %
;ee% &
}ff 	
publicnn 
FTelnetParsernn 
fParsernn $
{oo 	
getpp 
{qq 
tryrr 
{ss 
returntt 
thistt 
.tt  
	m_fParsertt  )
;tt) *
}uu 
catchvv 
(vv 
	Exceptionvv  
exvv! #
)vv# $
{ww 
FDebugxx 
.xx 
throwExceptionxx )
(xx) *
exxx* ,
)xx, -
;xx- .
}yy 
finallyzz 
{{{ 
}}} 
return~~ 
null~~ 
;~~ 
} 
}
€€ 	
private
ˆˆ 
void
ˆˆ 
init
ˆˆ 
(
ˆˆ 
)
‰‰ 
{
ŠŠ 	
try
‹‹ 
{
ŒŒ 
m_fMainSync
 
=
 
new
 !
	FCodeLock
" +
(
+ ,
)
, -
;
- .
m_fEventPusher
 
=
  
new
! $ 
FTelnetEventPusher
% 7
(
7 8
this
8 <
,
< =
false
> C
)
C D
;
D E
}
 
catch
 
(
 
	Exception
 
ex
 
)
  
{
‘‘ 
FDebug
’’ 
.
’’ 
throwException
’’ %
(
’’% &
ex
’’& (
)
’’( )
;
’’) *
}
““ 
finally
”” 
{
•• 
}
—— 
}
˜˜ 	
private
œœ 
void
œœ 
term
œœ 
(
œœ 
)
 
{
 	
try
ŸŸ 
{
   
if
¡¡ 
(
¡¡ 
this
¡¡ 
.
¡¡ 
	m_fParser
¡¡ "
!=
¡¡# %
null
¡¡& *
)
¡¡* +
{
¢¢ 
this
££ 
.
££ 
	m_fParser
££ "
.
££" #
Dispose
££# *
(
££* +
)
££+ ,
;
££, -
this
¤¤ 
.
¤¤ 
	m_fParser
¤¤ "
=
¤¤# $
null
¤¤% )
;
¤¤) *
}
¥¥ 
if
§§ 
(
§§ 
this
§§ 
.
§§ 
m_fMainSync
§§ $
!=
§§% '
null
§§( ,
)
§§, -
{
¨¨ 
this
©© 
.
©© 
m_fMainSync
©© $
.
©©$ %
Dispose
©©% ,
(
©©, -
)
©©- .
;
©©. /
this
ªª 
.
ªª 
m_fMainSync
ªª $
=
ªª% &
null
ªª' +
;
ªª+ ,
}
«« 
this
­­ 
.
­­ 
m_localOptions
­­ #
=
­­$ %
null
­­& *
;
­­* +
this
®® 
.
®® 
m_remoteOptions
®® $
=
®®% &
null
®®' +
;
®®+ ,
if
°° 
(
°° 
m_fEventPusher
°° "
!=
°°# %
null
°°& *
)
°°* +
{
±± 
m_fEventPusher
²² "
.
²²" #(
waitEventHandlingCompleted
²²# =
(
²²= >
)
²²> ?
;
²²? @
m_fEventPusher
³³ "
.
³³" #
Dispose
³³# *
(
³³* +
)
³³+ ,
;
³³, -
m_fEventPusher
´´ "
=
´´# $
null
´´% )
;
´´) *
}
µµ 
}
¶¶ 
catch
·· 
(
·· 
	Exception
·· 
ex
·· 
)
··  
{
¸¸ 
FDebug
¹¹ 
.
¹¹ 
throwException
¹¹ %
(
¹¹% &
ex
¹¹& (
)
¹¹( )
;
¹¹) *
}
ºº 
finally
»» 
{
¼¼ 
}
¾¾ 
}
¿¿ 	
public
ÃÃ 
void
ÃÃ 
close
ÃÃ 
(
ÃÃ 
)
ÄÄ 
{
ÅÅ 	
try
ÆÆ 
{
ÇÇ 
this
ÈÈ 
.
ÈÈ 
	m_fParser
ÈÈ 
.
ÈÈ 
close
ÈÈ $
(
ÈÈ$ %
)
ÈÈ% &
;
ÈÈ& '
}
ÉÉ 
catch
ÊÊ 
(
ÊÊ 
	Exception
ÊÊ 
ex
ÊÊ 
)
ÊÊ  
{
ËË 
FDebug
ÌÌ 
.
ÌÌ 
throwException
ÌÌ %
(
ÌÌ% &
ex
ÌÌ& (
)
ÌÌ( )
;
ÌÌ) *
}
ÍÍ 
finally
ÎÎ 
{
ÏÏ 
}
ÑÑ 
}
ÒÒ 	
public
ÖÖ 
void
ÖÖ 
enableService
ÖÖ !
(
ÖÖ! "
FTelnetOption
×× 
fTargetOption
×× '
,
××' (
bool
ØØ 
enable
ØØ 
)
ÙÙ 
{
ÚÚ 	
try
ÛÛ 
{
ÜÜ 
this
İİ 
.
İİ 
m_enabledOptions
İİ %
[
İİ% &
(
İİ& '
int
İİ' *
)
İİ* +
fTargetOption
İİ+ 8
]
İİ8 9
=
İİ: ;
enable
İİ< B
;
İİB C
}
ŞŞ 
catch
ßß 
(
ßß 
	Exception
ßß 
ex
ßß 
)
ßß  
{
àà 
FDebug
áá 
.
áá 
throwException
áá %
(
áá% &
ex
áá& (
)
áá( )
;
áá) *
}
ââ 
finally
ãã 
{
ää 
}
ææ 
}
çç 	
public
ëë 
bool
ëë 
doingLocalOption
ëë $
(
ëë$ %
FTelnetOption
ìì 
fOption
ìì !
)
íí 
{
îî 	
try
ïï 
{
ğğ 
this
ññ 
.
ññ 
m_fMainSync
ññ  
.
ññ  !
wait
ññ! %
(
ññ% &
)
ññ& '
;
ññ' (
return
õõ 
this
õõ 
.
õõ 
m_localOptions
õõ *
[
õõ* +
(
õõ+ ,
int
õõ, /
)
õõ/ 0
fOption
õõ0 7
]
õõ7 8
;
õõ8 9
}
öö 
catch
÷÷ 
(
÷÷ 
	Exception
÷÷ 
ex
÷÷ 
)
÷÷  
{
øø 
FDebug
ùù 
.
ùù 
throwException
ùù %
(
ùù% &
ex
ùù& (
)
ùù( )
;
ùù) *
}
úú 
finally
ûû 
{
üü 
this
ıı 
.
ıı 
m_fMainSync
ıı  
.
ıı  !
set
ıı! $
(
ıı$ %
)
ıı% &
;
ıı& '
}
şş 
return
ÿÿ 
false
ÿÿ 
;
ÿÿ 
}
€€ 	
public
„„ 
bool
„„ 
doingRemoteOption
„„ %
(
„„% &
FTelnetOption
…… 
fOption
…… !
)
†† 
{
‡‡ 	
try
ˆˆ 
{
‰‰ 
this
ŠŠ 
.
ŠŠ 
m_fMainSync
ŠŠ  
.
ŠŠ  !
wait
ŠŠ! %
(
ŠŠ% &
)
ŠŠ& '
;
ŠŠ' (
return
 
this
 
.
 
m_remoteOptions
 +
[
+ ,
(
, -
int
- 0
)
0 1
fOption
1 8
]
8 9
;
9 :
}
 
catch
 
(
 
	Exception
 
ex
 
)
  
{
‘‘ 
FDebug
’’ 
.
’’ 
throwException
’’ %
(
’’% &
ex
’’& (
)
’’( )
;
’’) *
}
““ 
finally
”” 
{
•• 
this
–– 
.
–– 
m_fMainSync
––  
.
––  !
set
––! $
(
––$ %
)
––% &
;
––& '
}
—— 
return
˜˜ 
false
˜˜ 
;
˜˜ 
}
™™ 	
public
 
void
 
parse
 
(
 
byte
 
[
 
]
 
buffer
 
)
ŸŸ 
{
   	
FITelnetPacket
¡¡ 
fPacket
¡¡ "
=
¡¡# $
null
¡¡% )
;
¡¡) *
try
££ 
{
¤¤ 
this
¥¥ 
.
¥¥ 
fParser
¥¥ 
.
¥¥ 

appendData
¥¥ '
(
¥¥' (
buffer
¥¥( .
)
¥¥. /
;
¥¥/ 0
fPacket
©© 
=
©© 
this
©© 
.
©© 
fParser
©© &
.
©©& '
readNext
©©' /
(
©©/ 0
)
©©0 1
;
©©1 2
while
«« 
(
«« 
fPacket
«« 
!=
««  
null
««! %
)
««% &
{
¬¬ 
this
­­ 
.
­­  
pushPacketReceived
­­ +
(
­­+ ,
fPacket
­­, 3
)
­­3 4
;
­­4 5
if
¯¯ 
(
¯¯ 
fPacket
¯¯ 
.
¯¯  
fPacketType
¯¯  +
==
¯¯, .
FTelnetPacketType
¯¯/ @
.
¯¯@ A
Option
¯¯A G
)
¯¯G H
{
°° 
if
±± 
(
±± 
(
±± 
(
±± !
FTelnetOptionPacket
±± 1
)
±±1 2
fPacket
±±2 9
)
±±9 :
.
±±: ;
fCommand
±±; C
==
±±D F
FTelnetCommand
±±G U
.
±±U V
Do
±±V X
)
±±X Y
{
²² 
this
³³  
.
³³  !
procDoOption
³³! -
(
³³- .
(
³³. /
(
³³/ 0!
FTelnetOptionPacket
³³0 C
)
³³C D
fPacket
³³D K
)
³³K L
.
³³L M
fOption
³³M T
)
³³T U
;
³³U V
}
´´ 
else
µµ 
if
µµ 
(
µµ  !
(
µµ! "
(
µµ" #!
FTelnetOptionPacket
µµ# 6
)
µµ6 7
fPacket
µµ7 >
)
µµ> ?
.
µµ? @
fCommand
µµ@ H
==
µµI K
FTelnetCommand
µµL Z
.
µµZ [
Dont
µµ[ _
)
µµ_ `
{
¶¶ 
this
··  
.
··  !
procDontOption
··! /
(
··/ 0
(
··0 1
(
··1 2!
FTelnetOptionPacket
··2 E
)
··E F
fPacket
··F M
)
··M N
.
··N O
fOption
··O V
)
··V W
;
··W X
}
¸¸ 
else
¹¹ 
if
¹¹ 
(
¹¹  !
(
¹¹! "
(
¹¹" #!
FTelnetOptionPacket
¹¹# 6
)
¹¹6 7
fPacket
¹¹7 >
)
¹¹> ?
.
¹¹? @
fCommand
¹¹@ H
==
¹¹I K
FTelnetCommand
¹¹L Z
.
¹¹Z [
Will
¹¹[ _
)
¹¹_ `
{
ºº 
this
»»  
.
»»  !
procWillOption
»»! /
(
»»/ 0
(
»»0 1
(
»»1 2!
FTelnetOptionPacket
»»2 E
)
»»E F
fPacket
»»F M
)
»»M N
.
»»N O
fOption
»»O V
)
»»V W
;
»»W X
}
¼¼ 
else
½½ 
if
½½ 
(
½½  !
(
½½! "
(
½½" #!
FTelnetOptionPacket
½½# 6
)
½½6 7
fPacket
½½7 >
)
½½> ?
.
½½? @
fCommand
½½@ H
==
½½I K
FTelnetCommand
½½L Z
.
½½Z [
Wont
½½[ _
)
½½_ `
{
¾¾ 
this
¿¿  
.
¿¿  !
procWontOption
¿¿! /
(
¿¿/ 0
(
¿¿0 1
(
¿¿1 2!
FTelnetOptionPacket
¿¿2 E
)
¿¿E F
fPacket
¿¿F M
)
¿¿M N
.
¿¿N O
fOption
¿¿O V
)
¿¿V W
;
¿¿W X
}
ÀÀ 
}
ÁÁ 
fPacket
ÅÅ 
=
ÅÅ 
this
ÅÅ "
.
ÅÅ" #
fParser
ÅÅ# *
.
ÅÅ* +
readNext
ÅÅ+ 3
(
ÅÅ3 4
)
ÅÅ4 5
;
ÅÅ5 6
}
ÇÇ 
}
ÈÈ 
catch
ÉÉ 
(
ÉÉ 
	Exception
ÉÉ 
ex
ÉÉ 
)
ÉÉ  
{
ÊÊ 
FDebug
ËË 
.
ËË 
throwException
ËË %
(
ËË% &
ex
ËË& (
)
ËË( )
;
ËË) *
}
ÌÌ 
finally
ÍÍ 
{
ÎÎ 
}
ĞĞ 
}
ÑÑ 	
public
ÕÕ 
void
ÕÕ 
sendData
ÕÕ 
(
ÕÕ 
byte
ÖÖ 
value
ÖÖ 
)
×× 
{
ØØ 	
try
ÙÙ 
{
ÚÚ 
this
ÛÛ 
.
ÛÛ 
pushPacketSent
ÛÛ #
(
ÛÛ# $
new
ÛÛ$ '
FTelnetDataPacket
ÛÛ( 9
(
ÛÛ9 :
new
ÛÛ: =
byte
ÛÛ> B
[
ÛÛB C
]
ÛÛC D
{
ÛÛE F
value
ÛÛG L
}
ÛÛM N
)
ÛÛN O
)
ÛÛO P
;
ÛÛP Q
this
ÜÜ 
.
ÜÜ 
fParser
ÜÜ 
.
ÜÜ 
sendEscaped
ÜÜ (
(
ÜÜ( )
new
ÜÜ) ,
byte
ÜÜ- 1
[
ÜÜ1 2
]
ÜÜ2 3
{
ÜÜ3 4
value
ÜÜ5 :
}
ÜÜ; <
)
ÜÜ< =
;
ÜÜ= >
}
İİ 
catch
ŞŞ 
(
ŞŞ 
	Exception
ŞŞ 
ex
ŞŞ 
)
ŞŞ 
{
ßß 
FDebug
àà 
.
àà 
throwException
àà %
(
àà% &
ex
àà& (
)
àà( )
;
àà) *
}
áá 
finally
ââ 
{
ãã 
}
åå 
}
ææ 	
public
êê 
void
êê 
sendData
êê 
(
êê 
byte
ëë 
[
ëë 
]
ëë 
buffer
ëë 
)
ìì 
{
íí 	
try
îî 
{
ïï 
this
ğğ 
.
ğğ 
pushPacketSent
ğğ #
(
ğğ# $
new
ğğ$ '
FTelnetDataPacket
ğğ( 9
(
ğğ9 :
buffer
ğğ: @
)
ğğ@ A
)
ğğA B
;
ğğB C
this
ññ 
.
ññ 
fParser
ññ 
.
ññ 
sendEscaped
ññ (
(
ññ( )
buffer
ññ) /
)
ññ/ 0
;
ññ0 1
}
òò 
catch
óó 
(
óó 
	Exception
óó 
ex
óó 
)
óó 
{
ôô 
FDebug
õõ 
.
õõ 
throwException
õõ %
(
õõ% &
ex
õõ& (
)
õõ( )
;
õõ) *
}
öö 
finally
÷÷ 
{
øø 
}
úú 
}
ûû 	
public
ÿÿ 
void
ÿÿ 
sendGoAhead
ÿÿ 
(
ÿÿ  
)
€€ 
{
 	
try
‚‚ 
{
ƒƒ 
this
„„ 
.
„„ 
pushPacketSent
„„ #
(
„„# $
new
„„$ '"
FTelnetCommandPacket
„„( <
(
„„< =
FTelnetCommand
„„= K
.
„„K L
GoAhead
„„L S
)
„„S T
)
„„T U
;
„„U V
this
…… 
.
…… 
fParser
…… 
.
…… 
sendGoAhead
…… (
(
……( )
)
……) *
;
……* +
}
†† 
catch
‡‡ 
(
‡‡ 
	Exception
‡‡ 
ex
‡‡ 
)
‡‡  
{
ˆˆ 
FDebug
‰‰ 
.
‰‰ 
throwException
‰‰ %
(
‰‰% &
ex
‰‰& (
)
‰‰( )
;
‰‰) *
}
ŠŠ 
finally
‹‹ 
{
ŒŒ 
}
 
}
 	
public
““ 
void
““ 
sendDo
““ 
(
““ 
FTelnetOption
”” 
fOption
”” !
)
•• 
{
–– 	!
FTelnetOptionPacket
—— 
fPacket
——  '
=
——( )
null
——* .
;
——. /
try
™™ 
{
šš 
fPacket
›› 
=
›› 
new
›› !
FTelnetOptionPacket
›› 1
(
››1 2
FTelnetCommand
››2 @
.
››@ A
Do
››A C
,
››C D
fOption
››E L
)
››L M
;
››M N
this
ŸŸ 
.
ŸŸ 
pushPacketSent
ŸŸ #
(
ŸŸ# $
fPacket
ŸŸ$ +
)
ŸŸ+ ,
;
ŸŸ, -
this
   
.
   
m_fReqQueue
    
.
    !
Add
  ! $
(
  $ %
fPacket
  % ,
)
  , -
;
  - .
this
¤¤ 
.
¤¤ 
fParser
¤¤ 
.
¤¤ 
sendDo
¤¤ #
(
¤¤# $
fOption
¤¤$ +
)
¤¤+ ,
;
¤¤, -
}
¥¥ 
catch
¦¦ 
(
¦¦ 
	Exception
¦¦ 
ex
¦¦ 
)
¦¦  
{
§§ 
FDebug
¨¨ 
.
¨¨ 
throwException
¨¨ %
(
¨¨% &
ex
¨¨& (
)
¨¨( )
;
¨¨) *
}
©© 
finally
ªª 
{
«« 
if
¬¬ 
(
¬¬ 
fPacket
¬¬ 
!=
¬¬ 
null
¬¬ #
)
¬¬# $
{
­­ 
fPacket
®® 
.
®® 
Dispose
®® #
(
®®# $
)
®®$ %
;
®®% &
fPacket
¯¯ 
=
¯¯ 
null
¯¯ "
;
¯¯" #
}
°° 
}
±± 
}
²² 	
public
¶¶ 
void
¶¶ 
sendDont
¶¶ 
(
¶¶ 
FTelnetOption
·· 
fOption
·· !
)
¸¸ 
{
¹¹ 	!
FTelnetOptionPacket
ºº 
fPacket
ºº  '
=
ºº( )
null
ºº* .
;
ºº. /
try
¼¼ 
{
½½ 
fPacket
¾¾ 
=
¾¾ 
new
¾¾ !
FTelnetOptionPacket
¾¾ 1
(
¾¾1 2
FTelnetCommand
¾¾2 @
.
¾¾@ A
Dont
¾¾A E
,
¾¾E F
fOption
¾¾G N
)
¾¾N O
;
¾¾O P
this
ÂÂ 
.
ÂÂ 
pushPacketSent
ÂÂ #
(
ÂÂ# $
fPacket
ÂÂ$ +
)
ÂÂ+ ,
;
ÂÂ, -
this
ÃÃ 
.
ÃÃ 
m_fReqQueue
ÃÃ  
.
ÃÃ  !
Add
ÃÃ! $
(
ÃÃ$ %
fPacket
ÃÃ% ,
)
ÃÃ, -
;
ÃÃ- .
this
ÇÇ 
.
ÇÇ 
fParser
ÇÇ 
.
ÇÇ 
sendDont
ÇÇ %
(
ÇÇ% &
fOption
ÇÇ& -
)
ÇÇ- .
;
ÇÇ. /
}
ÈÈ 
catch
ÉÉ 
(
ÉÉ 
	Exception
ÉÉ 
ex
ÉÉ 
)
ÉÉ  
{
ÊÊ 
FDebug
ËË 
.
ËË 
throwException
ËË %
(
ËË% &
ex
ËË& (
)
ËË( )
;
ËË) *
}
ÌÌ 
finally
ÍÍ 
{
ÎÎ 
if
ÏÏ 
(
ÏÏ 
fPacket
ÏÏ 
!=
ÏÏ 
null
ÏÏ #
)
ÏÏ# $
{
ĞĞ 
fPacket
ÑÑ 
.
ÑÑ 
Dispose
ÑÑ #
(
ÑÑ# $
)
ÑÑ$ %
;
ÑÑ% &
fPacket
ÒÒ 
=
ÒÒ 
null
ÒÒ "
;
ÒÒ" #
}
ÓÓ 
}
ÔÔ 
}
ÕÕ 	
public
ÙÙ 
void
ÙÙ 
sendWill
ÙÙ 
(
ÙÙ 
FTelnetOption
ÚÚ 
fOption
ÚÚ !
)
ÛÛ 
{
ÜÜ 	!
FTelnetOptionPacket
İİ 
fPacket
İİ  '
=
İİ( )
null
İİ* .
;
İİ. /
try
ßß 
{
àà 
fPacket
áá 
=
áá 
new
áá !
FTelnetOptionPacket
áá 1
(
áá1 2
FTelnetCommand
áá2 @
.
áá@ A
Will
ááA E
,
ááE F
fOption
ááG N
)
ááN O
;
ááO P
this
åå 
.
åå 
pushPacketSent
åå #
(
åå# $
fPacket
åå$ +
)
åå+ ,
;
åå, -
this
ææ 
.
ææ 
m_fReqQueue
ææ  
.
ææ  !
Add
ææ! $
(
ææ$ %
fPacket
ææ% ,
)
ææ, -
;
ææ- .
this
êê 
.
êê 
fParser
êê 
.
êê 
sendWill
êê %
(
êê% &
fOption
êê& -
)
êê- .
;
êê. /
}
ëë 
catch
ìì 
(
ìì 
	Exception
ìì 
ex
ìì 
)
ìì  
{
íí 
FDebug
îî 
.
îî 
throwException
îî %
(
îî% &
ex
îî& (
)
îî( )
;
îî) *
}
ïï 
finally
ğğ 
{
ññ 
if
òò 
(
òò 
fPacket
òò 
!=
òò 
null
òò #
)
òò# $
{
óó 
fPacket
ôô 
.
ôô 
Dispose
ôô #
(
ôô# $
)
ôô$ %
;
ôô% &
fPacket
õõ 
=
õõ 
null
õõ "
;
õõ" #
}
öö 
}
÷÷ 
}
øø 	
public
üü 
void
üü 
sendWont
üü 
(
üü 
FTelnetOption
ıı 
fOption
ıı !
)
şş 
{
ÿÿ 	!
FTelnetOptionPacket
€€ 
fPacket
€€  '
=
€€( )
null
€€* .
;
€€. /
try
‚‚ 
{
ƒƒ 
fPacket
„„ 
=
„„ 
new
„„ !
FTelnetOptionPacket
„„ 1
(
„„1 2
FTelnetCommand
„„2 @
.
„„@ A
Wont
„„A E
,
„„E F
fOption
„„G N
)
„„N O
;
„„O P
this
ˆˆ 
.
ˆˆ 
pushPacketSent
ˆˆ #
(
ˆˆ# $
fPacket
ˆˆ$ +
)
ˆˆ+ ,
;
ˆˆ, -
this
‰‰ 
.
‰‰ 
m_fReqQueue
‰‰  
.
‰‰  !
Add
‰‰! $
(
‰‰$ %
fPacket
‰‰% ,
)
‰‰, -
;
‰‰- .
this
 
.
 
fParser
 
.
 
sendWont
 %
(
% &
fOption
& -
)
- .
;
. /
}
 
catch
 
(
 
	Exception
 
ex
 
)
  
{
 
FDebug
‘‘ 
.
‘‘ 
throwException
‘‘ %
(
‘‘% &
ex
‘‘& (
)
‘‘( )
;
‘‘) *
}
’’ 
finally
““ 
{
”” 
if
•• 
(
•• 
fPacket
•• 
!=
•• 
null
•• #
)
••# $
{
–– 
fPacket
—— 
.
—— 
Dispose
—— #
(
——# $
)
——$ %
;
——% &
fPacket
˜˜ 
=
˜˜ 
null
˜˜ "
;
˜˜" #
}
™™ 
}
šš 
}
›› 	
private
ŸŸ 
void
ŸŸ 
pushStateChanged
ŸŸ %
(
ŸŸ% &
FTelnetOption
   
fOption
   !
,
  ! "
FTelnetPosition
¡¡ 
	fPosition
¡¡ %
,
¡¡% & 
FTelnetOptionState
¢¢ 
fOptionState
¢¢ +
)
££ 
{
¤¤ 	
try
¥¥ 
{
¦¦ 
this
§§ 
.
§§ 
m_fEventPusher
§§ #
.
§§# $
	pushEvent
§§$ -
(
§§- .
new
§§. 1*
FTelnetStateChangedEventArgs
§§2 N
(
§§N O
fOption
§§O V
,
§§V W
	fPosition
§§X a
,
§§a b
fOptionState
§§c o
)
§§o p
)
§§p q
;
§§q r
}
¨¨ 
catch
©© 
(
©© 
	Exception
©© 
ex
©© 
)
©©  
{
ªª 
FDebug
«« 
.
«« 
writeLog
«« 
(
««  
ex
««  "
)
««" #
;
««# $
}
¬¬ 
finally
­­ 
{
®® 
}
°° 
}
±± 	
private
µµ 
void
µµ  
pushPacketReceived
µµ '
(
µµ' (
FITelnetPacket
¶¶ 
fPacket
¶¶ "
)
·· 
{
¸¸ 	
try
¹¹ 
{
ºº 
this
»» 
.
»» 
m_fEventPusher
»» #
.
»»# $
	pushEvent
»»$ -
(
»»- .
new
»». 1,
FTelnetPacketReceivedEventArgs
»»2 P
(
»»P Q
fPacket
»»Q X
)
»»X Y
)
»»Y Z
;
»»Z [
}
¼¼ 
catch
½½ 
(
½½ 
	Exception
½½ 
ex
½½ 
)
½½  
{
¾¾ 
FDebug
¿¿ 
.
¿¿ 
writeLog
¿¿ 
(
¿¿  
ex
¿¿  "
)
¿¿" #
;
¿¿# $
}
ÀÀ 
finally
ÁÁ 
{
ÂÂ 
}
ÄÄ 
}
ÅÅ 	
private
ÉÉ 
void
ÉÉ 
pushPacketSent
ÉÉ #
(
ÉÉ# $
FITelnetPacket
ÊÊ 
fPacket
ÊÊ "
)
ËË 
{
ÌÌ 	
try
ÍÍ 
{
ÎÎ 
this
ÏÏ 
.
ÏÏ 
m_fEventPusher
ÏÏ #
.
ÏÏ# $
	pushEvent
ÏÏ$ -
(
ÏÏ- .
new
ÏÏ. 1(
FTelnetPacketSentEventArgs
ÏÏ2 L
(
ÏÏL M
fPacket
ÏÏM T
)
ÏÏT U
)
ÏÏU V
;
ÏÏV W
}
ĞĞ 
catch
ÑÑ 
(
ÑÑ 
	Exception
ÑÑ 
ex
ÑÑ 
)
ÑÑ  
{
ÒÒ 
FDebug
ÓÓ 
.
ÓÓ 
writeLog
ÓÓ 
(
ÓÓ  
ex
ÓÓ  "
)
ÓÓ" #
;
ÓÓ# $
}
ÔÔ 
finally
ÕÕ 
{
ÖÖ 
}
ØØ 
}
ÙÙ 	
internal
İİ 
void
İİ "
onTelnetStateChanged
İİ *
(
İİ* +"
FTelnetEventArgsBase
ŞŞ  
args
ŞŞ! %
)
ßß 
{
àà 	
try
áá 
{
ââ 
if
ãã 
(
ãã 
this
ãã 
.
ãã  
TelnetStateChanged
ãã +
!=
ãã, .
null
ãã/ 3
)
ãã3 4
{
ää 
this
åå 
.
åå  
TelnetStateChanged
åå +
(
åå+ ,
this
åå, 0
,
åå0 1
(
åå2 3*
FTelnetStateChangedEventArgs
åå3 O
)
ååO P
args
ååP T
)
ååT U
;
ååU V
}
ææ 
}
çç 
catch
èè 
(
èè 
	Exception
èè 
ex
èè 
)
èè  
{
éé 
FDebug
êê 
.
êê 
writeLog
êê 
(
êê  
ex
êê  "
)
êê" #
;
êê# $
}
ëë 
finally
ìì 
{
íí 
}
ïï 
}
ğğ 	
internal
ôô 
void
ôô $
onTelnetPacketReceived
ôô ,
(
ôô, -"
FTelnetEventArgsBase
õõ  
args
õõ! %
)
öö 
{
÷÷ 	
try
øø 
{
ùù 
if
úú 
(
úú 
this
úú 
.
úú "
TelnetPacketReceived
úú -
!=
úú. 0
null
úú1 5
)
úú5 6
{
ûû 
this
üü 
.
üü "
TelnetPacketReceived
üü -
(
üü- .
this
üü. 2
,
üü2 3
(
üü4 5,
FTelnetPacketReceivedEventArgs
üü5 S
)
üüS T
args
üüT X
)
üüX Y
;
üüY Z
}
ıı 
}
şş 
catch
ÿÿ 
(
ÿÿ 
	Exception
ÿÿ 
ex
ÿÿ 
)
ÿÿ  
{
€€ 
FDebug
 
.
 
writeLog
 
(
  
ex
  "
)
" #
;
# $
}
‚‚ 
finally
ƒƒ 
{
„„ 
}
†† 
}
‡‡ 	
internal
‹‹ 
void
‹‹  
onTelnetPacketSent
‹‹ (
(
‹‹( )"
FTelnetEventArgsBase
ŒŒ  
args
ŒŒ! %
)
 
{
 	
try
 
{
 
if
‘‘ 
(
‘‘ 
this
‘‘ 
.
‘‘ 
TelnetPacketSent
‘‘ )
!=
‘‘* ,
null
‘‘- 1
)
‘‘1 2
{
’’ 
this
““ 
.
““ 
TelnetPacketSent
““ )
(
““) *
this
““* .
,
““. /
(
““0 1(
FTelnetPacketSentEventArgs
““1 K
)
““K L
args
““L P
)
““P Q
;
““Q R
}
”” 
}
•• 
catch
–– 
(
–– 
	Exception
–– 
ex
–– 
)
––  
{
—— 
FDebug
˜˜ 
.
˜˜ 
writeLog
˜˜ 
(
˜˜  
ex
˜˜  "
)
˜˜" #
;
˜˜# $
}
™™ 
finally
šš 
{
›› 
}
 
}
 	
private
¢¢ 
void
¢¢ 
procDoOption
¢¢ !
(
¢¢! "
FTelnetOption
££ 
fOption
££ !
)
¤¤ 
{
¥¥ 	
int
¦¦ 
option
¦¦ 
;
¦¦ 
bool
§§ 

isResponse
§§ 
;
§§ 
try
©© 
{
ªª 
option
«« 
=
«« 
(
«« 
int
«« 
)
«« 
fOption
«« %
;
««% &

isResponse
¬¬ 
=
¬¬  
isResponseDoOption
¬¬ /
(
¬¬/ 0
fOption
¬¬0 7
)
¬¬7 8
;
¬¬8 9
if
®® 
(
®® 
this
®® 
.
®® 
m_enabledOptions
®® )
[
®®) *
option
®®* 0
]
®®0 1
)
®®1 2
{
¯¯ 
if
°° 
(
°° 
!
°° 
this
°° 
.
°° 
m_localOptions
°° ,
[
°°, -
option
°°- 3
]
°°3 4
)
°°4 5
{
±± 
this
²² 
.
²² 
m_localOptions
²² +
[
²²+ ,
option
²², 2
]
²²2 3
=
²²4 5
true
²²6 :
;
²²: ;
pushStateChanged
³³ (
(
³³( )
fOption
³³) 0
,
³³0 1
FTelnetPosition
³³2 A
.
³³A B
Local
³³B G
,
³³G H 
FTelnetOptionState
³³I [
.
³³[ \
On
³³\ ^
)
³³^ _
;
³³_ `
if
·· 
(
·· 
!
·· 

isResponse
·· '
)
··' (
{
¸¸ 
this
¹¹  
.
¹¹  !
sendWill
¹¹! )
(
¹¹) *
fOption
¹¹* 1
)
¹¹1 2
;
¹¹2 3
}
ºº 
}
»» 
}
¼¼ 
else
½½ 
{
¾¾ 
if
¿¿ 
(
¿¿ 
this
¿¿ 
.
¿¿ 
m_localOptions
¿¿ +
[
¿¿+ ,
option
¿¿, 2
]
¿¿2 3
)
¿¿3 4
{
ÀÀ 
this
ÁÁ 
.
ÁÁ 
m_localOptions
ÁÁ +
[
ÁÁ+ ,
option
ÁÁ, 2
]
ÁÁ2 3
=
ÁÁ4 5
false
ÁÁ6 ;
;
ÁÁ; <
pushStateChanged
ÂÂ (
(
ÂÂ( )
fOption
ÂÂ) 0
,
ÂÂ0 1
FTelnetPosition
ÂÂ2 A
.
ÂÂA B
Local
ÂÂB G
,
ÂÂG H 
FTelnetOptionState
ÂÂI [
.
ÂÂ[ \
Off
ÂÂ\ _
)
ÂÂ_ `
;
ÂÂ` a
}
ÃÃ 
if
ÇÇ 
(
ÇÇ 
!
ÇÇ 

isResponse
ÇÇ #
)
ÇÇ# $
{
ÈÈ 
this
ÉÉ 
.
ÉÉ 
sendWont
ÉÉ %
(
ÉÉ% &
fOption
ÉÉ& -
)
ÉÉ- .
;
ÉÉ. /
}
ÊÊ 
}
ËË 
}
ÌÌ 
catch
ÍÍ 
(
ÍÍ 
	Exception
ÍÍ 
ex
ÍÍ 
)
ÍÍ  
{
ÎÎ 
FDebug
ÏÏ 
.
ÏÏ 
throwException
ÏÏ %
(
ÏÏ% &
ex
ÏÏ& (
)
ÏÏ( )
;
ÏÏ) *
}
ĞĞ 
finally
ÑÑ 
{
ÒÒ 
}
ÔÔ 
}
ÕÕ 	
private
ÙÙ 
void
ÙÙ 
procDontOption
ÙÙ #
(
ÙÙ# $
FTelnetOption
ÚÚ 
fOption
ÚÚ !
)
ÛÛ 
{
ÜÜ 	
int
İİ 
option
İİ 
;
İİ 
bool
ŞŞ 

isResponse
ŞŞ 
;
ŞŞ 
try
àà 
{
áá 
this
ââ 
.
ââ 
m_fMainSync
ââ  
.
ââ  !
wait
ââ! %
(
ââ% &
)
ââ& '
;
ââ' (
option
ææ 
=
ææ 
(
ææ 
int
ææ 
)
ææ 
fOption
ææ %
;
ææ% &

isResponse
çç 
=
çç "
isResponseDontOption
çç 1
(
çç1 2
fOption
çç2 9
)
çç9 :
;
çç: ;
if
éé 
(
éé 
this
êê 
.
êê 
m_enabledOptions
êê )
[
êê) *
option
êê* 0
]
êê0 1
&&
êê2 4
this
ëë 
.
ëë 
m_localOptions
ëë '
[
ëë' (
option
ëë( .
]
ëë. /
)
ìì 
{
íí 
if
îî 
(
îî 
this
îî 
.
îî 
m_localOptions
îî +
[
îî+ ,
option
îî, 2
]
îî2 3
)
îî3 4
{
ïï 
this
ğğ 
.
ğğ 
m_localOptions
ğğ +
[
ğğ+ ,
option
ğğ, 2
]
ğğ2 3
=
ğğ4 5
false
ğğ6 ;
;
ğğ; <
pushStateChanged
ññ (
(
ññ( )
fOption
ññ) 0
,
ññ0 1
FTelnetPosition
ññ2 A
.
ññA B
Local
ññB G
,
ññG H 
FTelnetOptionState
ññI [
.
ññ[ \
Off
ññ\ _
)
ññ_ `
;
ññ` a
}
òò 
if
öö 
(
öö 
!
öö 

isResponse
öö #
)
öö# $
{
÷÷ 
this
øø 
.
øø 
sendWont
øø %
(
øø% &
fOption
øø& -
)
øø- .
;
øø. /
}
ùù 
}
úú 
}
ûû 
catch
üü 
(
üü 
	Exception
üü 
ex
üü 
)
üü  
{
ıı 
FDebug
şş 
.
şş 
throwException
şş %
(
şş% &
ex
şş& (
)
şş( )
;
şş) *
}
ÿÿ 
finally
€€ 
{
 
m_fMainSync
‚‚ 
.
‚‚ 
set
‚‚ 
(
‚‚  
)
‚‚  !
;
‚‚! "
}
ƒƒ 
}
„„ 	
private
ˆˆ 
void
ˆˆ 
procWillOption
ˆˆ #
(
ˆˆ# $
FTelnetOption
‰‰ 
fOption
‰‰ !
)
ŠŠ 
{
‹‹ 	
int
ŒŒ 
option
ŒŒ 
;
ŒŒ 
bool
 

isResponse
 
;
 
try
 
{
 
m_fMainSync
‘‘ 
.
‘‘ 
wait
‘‘  
(
‘‘  !
)
‘‘! "
;
‘‘" #
option
•• 
=
•• 
(
•• 
int
•• 
)
•• 
fOption
•• %
;
••% &

isResponse
–– 
=
–– "
isResponseWillOption
–– 1
(
––1 2
fOption
––2 9
)
––9 :
;
––: ;
if
˜˜ 
(
˜˜ 
this
˜˜ 
.
˜˜ 
m_enabledOptions
˜˜ )
[
˜˜) *
option
˜˜* 0
]
˜˜0 1
!=
˜˜2 4
this
˜˜5 9
.
˜˜9 :
m_remoteOptions
˜˜: I
[
˜˜I J
option
˜˜J P
]
˜˜P Q
)
˜˜Q R
{
™™ 
this
šš 
.
šš 
m_remoteOptions
šš (
[
šš( )
option
šš) /
]
šš/ 0
=
šš1 2
this
šš3 7
.
šš7 8
m_enabledOptions
šš8 H
[
ššH I
option
ššI O
]
ššO P
;
ššP Q
this
œœ 
.
œœ 
pushStateChanged
œœ )
(
œœ) *
fOption
 
,
  
FTelnetPosition
 '
.
' (
Remote
( .
,
. /
this
ŸŸ 
.
ŸŸ 
m_remoteOptions
ŸŸ ,
[
ŸŸ, -
option
ŸŸ- 3
]
ŸŸ3 4
?
ŸŸ5 6 
FTelnetOptionState
ŸŸ7 I
.
ŸŸI J
On
ŸŸJ L
:
ŸŸM N 
FTelnetOptionState
ŸŸO a
.
ŸŸa b
Off
ŸŸb e
)
   
;
   
if
¤¤ 
(
¤¤ 
!
¤¤ 

isResponse
¤¤ #
)
¤¤# $
{
¥¥ 
if
¦¦ 
(
¦¦ 
this
¦¦  
.
¦¦  !
m_enabledOptions
¦¦! 1
[
¦¦1 2
option
¦¦2 8
]
¦¦8 9
)
¦¦9 :
{
§§ 
this
¨¨  
.
¨¨  !
sendDo
¨¨! '
(
¨¨' (
fOption
¨¨( /
)
¨¨/ 0
;
¨¨0 1
}
©© 
else
ªª 
{
«« 
this
¬¬  
.
¬¬  !
sendDont
¬¬! )
(
¬¬) *
fOption
¬¬* 1
)
¬¬1 2
;
¬¬2 3
}
­­ 
}
®® 
}
¯¯ 
}
°° 
catch
±± 
(
±± 
	Exception
±± 
ex
±± 
)
±±  
{
²² 
FDebug
³³ 
.
³³ 
throwException
³³ %
(
³³% &
ex
³³& (
)
³³( )
;
³³) *
}
´´ 
finally
µµ 
{
¶¶ 
m_fMainSync
·· 
.
·· 
set
·· 
(
··  
)
··  !
;
··! "
}
¸¸ 
}
¹¹ 	
private
½½ 
void
½½ 
procWontOption
½½ #
(
½½# $
FTelnetOption
¾¾ 
fOption
¾¾ !
)
¿¿ 
{
ÀÀ 	
int
ÁÁ 
option
ÁÁ 
;
ÁÁ 
bool
ÂÂ 

isResponse
ÂÂ 
;
ÂÂ 
try
ÄÄ 
{
ÅÅ 
m_fMainSync
ÆÆ 
.
ÆÆ 
wait
ÆÆ  
(
ÆÆ  !
)
ÆÆ! "
;
ÆÆ" #
option
ÊÊ 
=
ÊÊ 
(
ÊÊ 
int
ÊÊ 
)
ÊÊ 
fOption
ÊÊ %
;
ÊÊ% &

isResponse
ËË 
=
ËË "
isResponseWontOption
ËË 1
(
ËË1 2
fOption
ËË2 9
)
ËË9 :
;
ËË: ;
if
ÍÍ 
(
ÍÍ 
this
ÍÍ 
.
ÍÍ 
m_remoteOptions
ÍÍ (
[
ÍÍ( )
option
ÍÍ) /
]
ÍÍ/ 0
)
ÍÍ0 1
{
ÎÎ 
if
ÏÏ 
(
ÏÏ 
!
ÏÏ 

isResponse
ÏÏ #
)
ÏÏ# $
{
ĞĞ 
this
ÑÑ 
.
ÑÑ 
sendDont
ÑÑ %
(
ÑÑ% &
fOption
ÑÑ& -
)
ÑÑ- .
;
ÑÑ. /
}
ÒÒ 
if
ÖÖ 
(
ÖÖ 
this
ÖÖ 
.
ÖÖ 
m_remoteOptions
ÖÖ ,
[
ÖÖ, -
option
ÖÖ- 3
]
ÖÖ3 4
)
ÖÖ4 5
{
×× 
this
ØØ 
.
ØØ 
m_remoteOptions
ØØ ,
[
ØØ, -
option
ØØ- 3
]
ØØ3 4
=
ØØ5 6
false
ØØ7 <
;
ØØ< =
this
ÙÙ 
.
ÙÙ 
pushStateChanged
ÙÙ -
(
ÙÙ- .
fOption
ÙÙ. 5
,
ÙÙ5 6
FTelnetPosition
ÙÙ7 F
.
ÙÙF G
Remote
ÙÙG M
,
ÙÙM N 
FTelnetOptionState
ÙÙO a
.
ÙÙa b
Off
ÙÙb e
)
ÙÙe f
;
ÙÙf g
}
ÚÚ 
}
ÛÛ 
}
ÜÜ 
catch
İİ 
(
İİ 
	Exception
İİ 
ex
İİ 
)
İİ  
{
ŞŞ 
FDebug
ßß 
.
ßß 
throwException
ßß %
(
ßß% &
ex
ßß& (
)
ßß( )
;
ßß) *
}
àà 
finally
áá 
{
ââ 
m_fMainSync
ãã 
.
ãã 
set
ãã 
(
ãã  
)
ãã  !
;
ãã! "
}
ää 
}
åå 	
private
éé 
bool
éé  
isResponseDoOption
éé '
(
éé' (
FTelnetOption
êê 
fOption
êê !
)
ëë 
{
ìì 	
try
íí 
{
îî 
for
ïï 
(
ïï 
int
ïï 
i
ïï 
=
ïï 
$num
ïï 
;
ïï 
i
ïï  !
<
ïï" #
m_fReqQueue
ïï$ /
.
ïï/ 0
Count
ïï0 5
;
ïï5 6
i
ïï7 8
++
ïï8 :
)
ïï: ;
{
ğğ 
if
ññ 
(
ññ 
m_fReqQueue
òò #
[
òò# $
i
òò$ %
]
òò% &
.
òò& '
fCommand
òò' /
==
òò0 2
FTelnetCommand
òò3 A
.
òòA B
Will
òòB F
&&
òòG I
m_fReqQueue
óó #
[
óó# $
i
óó$ %
]
óó% &
.
óó& '
fOption
óó' .
==
óó/ 1
fOption
óó2 9
)
ôô 
{
õõ 
m_fReqQueue
öö #
.
öö# $
RemoveAt
öö$ ,
(
öö, -
i
öö- .
)
öö. /
;
öö/ 0
return
÷÷ 
true
÷÷ #
;
÷÷# $
}
øø 
}
ùù 
}
úú 
catch
ûû 
(
ûû 
	Exception
ûû 
ex
ûû 
)
ûû  
{
üü 
FDebug
ıı 
.
ıı 
throwException
ıı %
(
ıı% &
ex
ıı& (
)
ıı( )
;
ıı) *
}
şş 
finally
ÿÿ 
{
€€ 
}
‚‚ 
return
ƒƒ 
false
ƒƒ 
;
ƒƒ 
}
„„ 	
private
ˆˆ 
bool
ˆˆ "
isResponseDontOption
ˆˆ )
(
ˆˆ) *
FTelnetOption
‰‰ 
fOption
‰‰ !
)
ŠŠ 
{
‹‹ 	
try
ŒŒ 
{
 
for
 
(
 
int
 
i
 
=
 
$num
 
;
 
i
  !
<
" #
m_fReqQueue
$ /
.
/ 0
Count
0 5
;
5 6
i
7 8
++
8 :
)
: ;
{
 
if
 
(
 
(
‘‘ 
m_fReqQueue
‘‘ $
[
‘‘$ %
i
‘‘% &
]
‘‘& '
.
‘‘' (
fCommand
‘‘( 0
==
‘‘1 3
FTelnetCommand
‘‘4 B
.
‘‘B C
Will
‘‘C G
||
‘‘H J
m_fReqQueue
‘‘K V
[
‘‘V W
i
‘‘W X
]
‘‘X Y
.
‘‘Y Z
fCommand
‘‘Z b
==
‘‘c e
FTelnetCommand
‘‘f t
.
‘‘t u
Wont
‘‘u y
)
‘‘y z
&&
‘‘{ }
m_fReqQueue
’’ #
[
’’# $
i
’’$ %
]
’’% &
.
’’& '
fOption
’’' .
==
’’/ 1
fOption
’’2 9
)
““ 
{
”” 
m_fReqQueue
•• #
.
••# $
RemoveAt
••$ ,
(
••, -
i
••- .
)
••. /
;
••/ 0
return
–– 
true
–– #
;
––# $
}
—— 
}
˜˜ 
}
™™ 
catch
šš 
(
šš 
	Exception
šš 
ex
šš 
)
šš  
{
›› 
FDebug
œœ 
.
œœ 
throwException
œœ %
(
œœ% &
ex
œœ& (
)
œœ( )
;
œœ) *
}
 
finally
 
{
ŸŸ 
}
¡¡ 
return
¢¢ 
false
¢¢ 
;
¢¢ 
}
££ 	
private
§§ 
bool
§§ "
isResponseWillOption
§§ )
(
§§) *
FTelnetOption
¨¨ 
fOption
¨¨ !
)
©© 
{
ªª 	
try
«« 
{
¬¬ 
for
­­ 
(
­­ 
int
­­ 
i
­­ 
=
­­ 
$num
­­ 
;
­­ 
i
­­  !
<
­­" #
m_fReqQueue
­­$ /
.
­­/ 0
Count
­­0 5
;
­­5 6
i
­­7 8
++
­­8 :
)
­­: ;
{
®® 
if
¯¯ 
(
¯¯ 
m_fReqQueue
°° #
[
°°# $
i
°°$ %
]
°°% &
.
°°& '
fCommand
°°' /
==
°°0 2
FTelnetCommand
°°3 A
.
°°A B
Do
°°B D
&&
°°E G
m_fReqQueue
±± #
[
±±# $
i
±±$ %
]
±±% &
.
±±& '
fOption
±±' .
==
±±/ 1
fOption
±±2 9
)
²² 
{
³³ 
m_fReqQueue
´´ #
.
´´# $
RemoveAt
´´$ ,
(
´´, -
i
´´- .
)
´´. /
;
´´/ 0
return
µµ 
true
µµ #
;
µµ# $
}
¶¶ 
}
·· 
}
¸¸ 
catch
¹¹ 
(
¹¹ 
	Exception
¹¹ 
ex
¹¹ 
)
¹¹  
{
ºº 
FDebug
»» 
.
»» 
throwException
»» %
(
»»% &
ex
»»& (
)
»»( )
;
»») *
}
¼¼ 
finally
½½ 
{
¾¾ 
}
ÀÀ 
return
ÁÁ 
false
ÁÁ 
;
ÁÁ 
}
ÂÂ 	
private
ÆÆ 
bool
ÆÆ "
isResponseWontOption
ÆÆ )
(
ÆÆ) *
FTelnetOption
ÇÇ 
fOption
ÇÇ !
)
ÈÈ 
{
ÉÉ 	
try
ÊÊ 
{
ËË 
for
ÌÌ 
(
ÌÌ 
int
ÌÌ 
i
ÌÌ 
=
ÌÌ 
$num
ÌÌ 
;
ÌÌ 
i
ÌÌ  !
<
ÌÌ" #
m_fReqQueue
ÌÌ$ /
.
ÌÌ/ 0
Count
ÌÌ0 5
;
ÌÌ5 6
i
ÌÌ7 8
++
ÌÌ8 :
)
ÌÌ: ;
{
ÍÍ 
if
ÎÎ 
(
ÎÎ 
(
ÏÏ 
m_fReqQueue
ÏÏ $
[
ÏÏ$ %
i
ÏÏ% &
]
ÏÏ& '
.
ÏÏ' (
fCommand
ÏÏ( 0
==
ÏÏ1 3
FTelnetCommand
ÏÏ4 B
.
ÏÏB C
Do
ÏÏC E
||
ÏÏF H
m_fReqQueue
ÏÏI T
[
ÏÏT U
i
ÏÏU V
]
ÏÏV W
.
ÏÏW X
fCommand
ÏÏX `
==
ÏÏa c
FTelnetCommand
ÏÏd r
.
ÏÏr s
Dont
ÏÏs w
)
ÏÏw x
&&
ÏÏy {
m_fReqQueue
ĞĞ #
[
ĞĞ# $
i
ĞĞ$ %
]
ĞĞ% &
.
ĞĞ& '
fOption
ĞĞ' .
==
ĞĞ/ 1
fOption
ĞĞ2 9
)
ÑÑ 
{
ÒÒ 
m_fReqQueue
ÓÓ #
.
ÓÓ# $
RemoveAt
ÓÓ$ ,
(
ÓÓ, -
i
ÓÓ- .
)
ÓÓ. /
;
ÓÓ/ 0
return
ÔÔ 
true
ÔÔ #
;
ÔÔ# $
}
ÕÕ 
}
ÖÖ 
}
×× 
catch
ØØ 
(
ØØ 
	Exception
ØØ 
ex
ØØ 
)
ØØ  
{
ÙÙ 
FDebug
ÚÚ 
.
ÚÚ 
throwException
ÚÚ %
(
ÚÚ% &
ex
ÚÚ& (
)
ÚÚ( )
;
ÚÚ) *
}
ÛÛ 
finally
ÜÜ 
{
İİ 
}
ßß 
return
àà 
false
àà 
;
àà 
}
áá 	
}
çç 
}èè şÿ
bD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Telnet\c_FTelnetByteBuffer.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FTelnetByteBuffer "
:# $
IDisposable% 0
{ 
private 
const 
int 
DefaultCapacity )
=* +
$num, /
;/ 0
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
int 
m_count 
; 
private 
byte 
[ 
] 
m_data 
; 
public## 
FTelnetByteBuffer##  
(##  !
)##! "
{$$ 	
m_count%% 
=%% 
$num%% 
;%% 
m_data&& 
=&& 
new&& 
byte&& 
[&& 
DefaultCapacity&& -
]&&- .
;&&. /
}'' 	
public++ 
FTelnetByteBuffer++  
(++  !
int,, 
capacity,, 
)-- 
{.. 	
if// 
(// 
capacity// 
<// 
$num// 
)// 
{00 
FDebug11 
.11 
throwFException11 &
(11& '
string11' -
.11- .
Format11. 4
(114 5

FConstants115 ?
.11? @

err_m_000511@ J
,11J K
$str11L V
)11V W
)11W X
;11X Y
}22 
m_count66 
=66 
$num66 
;66 
m_data77 
=77 
new77 
byte77 
[77 
capacity77 &
]77& '
;77' (
}88 	
public<< 
FTelnetByteBuffer<<  
(<<  !
byte== 
[== 
]== 
data== 
)>> 
{?? 	
if@@ 
(@@ 
data@@ 
==@@ 
null@@ 
)@@ 
{AA 
FDebugBB 
.BB 
throwFExceptionBB &
(BB& '
stringBB' -
.BB- .
FormatBB. 4
(BB4 5

FConstantsBB5 ?
.BB? @

err_m_0016BB@ J
,BBJ K
$strBBL R
)BBR S
)BBS T
;BBT U
}CC 
m_dataGG 
=GG 
newGG 
byteGG 
[GG 
dataGG "
.GG" #
LengthGG# )
]GG) *
;GG* +
dataII 
.II 
CopyToII 
(II 
m_dataII 
,II 
$numII  !
)II! "
;II" #
m_countKK 
=KK 
dataKK 
.KK 
LengthKK !
;KK! "
}LL 	
	protectedPP 
voidPP 
	myDisposePP  
(PP  !
boolQQ 
	disposingQQ 
)RR 
{SS 	
ifTT 
(TT 
!TT 

m_disposedTT 
)TT 
{UU 
ifVV 
(VV 
	disposingVV 
)VV 
{WW 
termXX 
(XX 
)XX 
;XX 
}YY 

m_disposedZZ 
=ZZ 
trueZZ !
;ZZ! "
}[[ 
}\\ 	
publicdd 
voiddd 
Disposedd 
(dd 
)ee 
{ff 	
	myDisposegg 
(gg 
truegg 
)gg 
;gg 
GChh 
.hh 
SuppressFinalizehh 
(hh  
thishh  $
)hh$ %
;hh% &
}ii 	
publicqq 
intqq 
capacityqq 
{rr 	
getss 
{tt 
tryuu 
{vv 
returnww 
m_dataww !
.ww! "
Lengthww" (
;ww( )
}xx 
catchyy 
(yy 
	Exceptionyy  
exyy! #
)yy# $
{zz 
FDebug{{ 
.{{ 
throwException{{ )
({{) *
ex{{* ,
){{, -
;{{- .
}|| 
finally}} 
{~~ 
}
€€ 
return
 
$num
 
;
 
}
‚‚ 
set
„„ 
{
…… 
try
†† 
{
‡‡ 
if
ˆˆ 
(
ˆˆ 
value
ˆˆ 
<
ˆˆ 
$num
ˆˆ  !
)
ˆˆ! "
{
‰‰ 
FDebug
ŠŠ 
.
ŠŠ 
throwFException
ŠŠ .
(
ŠŠ. /
string
ŠŠ/ 5
.
ŠŠ5 6
Format
ŠŠ6 <
(
ŠŠ< =

FConstants
ŠŠ= G
.
ŠŠG H

err_m_0005
ŠŠH R
,
ŠŠR S
$str
ŠŠT [
)
ŠŠ[ \
)
ŠŠ\ ]
;
ŠŠ] ^
}
‹‹ 
if
 
(
 
value
 
==
  
m_count
! (
)
( )
{
 
return
 
;
 
}
 
if
’’ 
(
’’ 
value
’’ 
<
’’ 
m_count
’’  '
)
’’' (
{
““ 
FDebug
”” 
.
”” 
throwFException
”” .
(
””. /
string
””/ 5
.
””5 6
Format
””6 <
(
””< =

FConstants
””= G
.
””G H

err_m_0015
””H R
,
””R S
$str
””T [
)
””[ \
)
””\ ]
;
””] ^
}
•• 
byte
™™ 
[
™™ 
]
™™ 
newData
™™ "
=
™™# $
new
™™% (
byte
™™) -
[
™™- .
value
™™. 3
]
™™3 4
;
™™4 5
Array
›› 
.
›› 
Copy
›› 
(
›› 
m_data
œœ 
,
œœ 
$num
 
,
 
newData
 
,
  
$num
ŸŸ 
,
ŸŸ 
m_count
   
)
    
;
    !
m_data
¢¢ 
=
¢¢ 
newData
¢¢ $
;
¢¢$ %
}
££ 
catch
¤¤ 
(
¤¤ 
	Exception
¤¤  
ex
¤¤! #
)
¤¤# $
{
¥¥ 
FDebug
¦¦ 
.
¦¦ 
throwException
¦¦ )
(
¦¦) *
ex
¦¦* ,
)
¦¦, -
;
¦¦- .
}
§§ 
finally
¨¨ 
{
©© 
}
«« 
}
¬¬ 
}
­­ 	
public
±± 
int
±± 
count
±± 
{
²² 	
get
³³ 
{
´´ 
try
µµ 
{
¶¶ 
return
·· 
m_count
·· "
;
··" #
}
¸¸ 
catch
¹¹ 
(
¹¹ 
	Exception
¹¹  
ex
¹¹! #
)
¹¹# $
{
ºº 
FDebug
»» 
.
»» 
throwException
»» )
(
»») *
ex
»»* ,
)
»», -
;
»»- .
}
¼¼ 
finally
½½ 
{
¾¾ 
}
ÀÀ 
return
ÁÁ 
$num
ÁÁ 
;
ÁÁ 
}
ÂÂ 
}
ÃÃ 	
public
ÇÇ 
byte
ÇÇ 
this
ÇÇ 
[
ÇÇ 
int
ÇÇ 
index
ÇÇ "
]
ÇÇ" #
{
ÈÈ 	
get
ÉÉ 
{
ÊÊ 
try
ËË 
{
ÌÌ 
if
ÍÍ 
(
ÍÍ 
(
ÍÍ 
index
ÍÍ 
<
ÍÍ  
$num
ÍÍ! "
)
ÍÍ" #
||
ÍÍ$ &
(
ÍÍ' (
index
ÍÍ( -
>=
ÍÍ. 0
m_count
ÍÍ1 8
)
ÍÍ8 9
)
ÍÍ9 :
{
ÎÎ 
FDebug
ÏÏ 
.
ÏÏ 
throwFException
ÏÏ .
(
ÏÏ. /
string
ÏÏ/ 5
.
ÏÏ5 6
Format
ÏÏ6 <
(
ÏÏ< =

FConstants
ÏÏ= G
.
ÏÏG H

err_m_0005
ÏÏH R
,
ÏÏR S
$str
ÏÏT [
)
ÏÏ[ \
)
ÏÏ\ ]
;
ÏÏ] ^
}
ĞĞ 
return
ÔÔ 
m_data
ÔÔ !
[
ÔÔ! "
index
ÔÔ" '
]
ÔÔ' (
;
ÔÔ( )
}
ÕÕ 
catch
ÖÖ 
(
ÖÖ 
	Exception
ÖÖ  
ex
ÖÖ! #
)
ÖÖ# $
{
×× 
FDebug
ØØ 
.
ØØ 
throwException
ØØ )
(
ØØ) *
ex
ØØ* ,
)
ØØ, -
;
ØØ- .
}
ÙÙ 
finally
ÚÚ 
{
ÛÛ 
}
İİ 
return
ŞŞ 
$num
ŞŞ 
;
ŞŞ 
}
ßß 
set
áá 
{
ââ 
try
ãã 
{
ää 
if
åå 
(
åå 
(
åå 
index
åå 
<
åå  
$num
åå! "
)
åå" #
||
åå$ &
(
åå' (
index
åå( -
>=
åå. 0
m_count
åå1 8
)
åå8 9
)
åå9 :
{
ææ 
FDebug
çç 
.
çç 
throwFException
çç .
(
çç. /
string
çç/ 5
.
çç5 6
Format
çç6 <
(
çç< =

FConstants
çç= G
.
ççG H

err_m_0005
ççH R
,
ççR S
$str
ççT [
)
çç[ \
)
çç\ ]
;
çç] ^
}
èè 
m_data
ìì 
[
ìì 
index
ìì  
]
ìì  !
=
ìì" #
value
ìì$ )
;
ìì) *
}
íí 
catch
îî 
(
îî 
	Exception
îî  
ex
îî! #
)
îî# $
{
ïï 
FDebug
ğğ 
.
ğğ 
throwException
ğğ )
(
ğğ) *
ex
ğğ* ,
)
ğğ, -
;
ğğ- .
}
ññ 
finally
òò 
{
óó 
}
õõ 
}
öö 
}
÷÷ 	
private
ÿÿ 
void
ÿÿ 
init
ÿÿ 
(
ÿÿ 
)
€€ 
{
 	
try
‚‚ 
{
ƒƒ 
}
…… 
catch
†† 
(
†† 
	Exception
†† 
ex
†† 
)
††  
{
‡‡ 
FDebug
ˆˆ 
.
ˆˆ 
throwException
ˆˆ %
(
ˆˆ% &
ex
ˆˆ& (
)
ˆˆ( )
;
ˆˆ) *
}
‰‰ 
finally
ŠŠ 
{
‹‹ 
}
 
}
 	
private
’’ 
void
’’ 
term
’’ 
(
’’ 
)
““ 
{
”” 	
try
•• 
{
–– 
m_data
—— 
=
—— 
null
—— 
;
—— 
}
˜˜ 
catch
™™ 
(
™™ 
	Exception
™™ 
ex
™™ 
)
™™  
{
šš 
FDebug
›› 
.
›› 
throwException
›› %
(
››% &
ex
››& (
)
››( )
;
››) *
}
œœ 
finally
 
{
 
}
   
}
¢¢ 	
public
¦¦ 
void
¦¦ 
append
¦¦ 
(
¦¦ 
byte
§§ 
value
§§ 
)
¨¨ 
{
©© 	
ensureCapacity
ªª 
(
ªª 
m_count
ªª "
+
ªª# $
$num
ªª% &
)
ªª& '
;
ªª' (
m_data
«« 
[
«« 
m_count
«« 
++
«« 
]
«« 
=
«« 
value
««  %
;
««% &
}
¬¬ 	
public
°° 
void
°° 
append
°° 
(
°° 
byte
±± 
[
±± 
]
±± 
	byteArray
±± 
)
²² 
{
³³ 	
if
´´ 
(
´´ 
	byteArray
´´ 
==
´´ 
null
´´ !
)
´´! "
{
µµ 
FDebug
¶¶ 
.
¶¶ 
throwFException
¶¶ &
(
¶¶& '
string
¶¶' -
.
¶¶- .
Format
¶¶. 4
(
¶¶4 5

FConstants
¶¶5 ?
.
¶¶? @

err_m_0016
¶¶@ J
,
¶¶J K
$str
¶¶L X
)
¶¶X Y
)
¶¶Y Z
;
¶¶Z [
}
·· 
if
¹¹ 
(
¹¹ 
	byteArray
¹¹ 
.
¹¹ 
Length
¹¹  
==
¹¹! #
$num
¹¹$ %
)
¹¹% &
{
ºº 
return
»» 
;
»» 
}
¼¼ 
ensureCapacity
ÀÀ 
(
ÀÀ 
m_count
ÀÀ "
+
ÀÀ# $
	byteArray
ÀÀ% .
.
ÀÀ. /
Length
ÀÀ/ 5
)
ÀÀ5 6
;
ÀÀ6 7
Array
ÂÂ 
.
ÂÂ 
Copy
ÂÂ 
(
ÂÂ 
	byteArray
ÃÃ 
,
ÃÃ 
$num
ÄÄ 
,
ÄÄ 
m_data
ÅÅ 
,
ÅÅ 
m_count
ÆÆ 
,
ÆÆ 
	byteArray
ÇÇ 
.
ÇÇ 
Length
ÇÇ  
)
ÇÇ  !
;
ÇÇ! "
m_count
ÉÉ 
+=
ÉÉ 
	byteArray
ÉÉ  
.
ÉÉ  !
Length
ÉÉ! '
;
ÉÉ' (
}
ÊÊ 	
public
ÎÎ 
void
ÎÎ 
clear
ÎÎ 
(
ÎÎ 
)
ÏÏ 
{
ĞĞ 	
try
ÑÑ 
{
ÒÒ 
if
ÓÓ 
(
ÓÓ 
m_count
ÓÓ 
>
ÓÓ 
$num
ÓÓ 
)
ÓÓ  
{
ÔÔ 
m_count
ÕÕ 
=
ÕÕ 
$num
ÕÕ 
;
ÕÕ  
}
ÖÖ 
}
×× 
catch
ØØ 
(
ØØ 
	Exception
ØØ 
ex
ØØ 
)
ØØ  
{
ÙÙ 
FDebug
ÚÚ 
.
ÚÚ 
throwException
ÚÚ %
(
ÚÚ% &
ex
ÚÚ& (
)
ÚÚ( )
;
ÚÚ) *
}
ÛÛ 
finally
ÜÜ 
{
İİ 
}
ßß 
}
àà 	
public
ää 
void
ää 
collapseDoubles
ää #
(
ää# $
byte
åå 
value
åå 
)
ææ 
{
çç 	
int
èè 
index
èè 
=
èè 
$num
èè 
;
èè 
try
êê 
{
ëë 
if
ìì 
(
ìì 
this
ìì 
.
ìì 
m_count
ìì  
<
ìì! "
$num
ìì# $
)
ìì$ %
{
íí 
return
îî 
;
îî 
}
ïï 
index
óó 
=
óó 
$num
óó 
;
óó 
do
õõ 
{
öö 
index
÷÷ 
=
÷÷ 
Array
÷÷ !
.
÷÷! "
IndexOf
÷÷" )
<
÷÷) *
byte
÷÷* .
>
÷÷. /
(
÷÷/ 0
m_data
÷÷0 6
,
÷÷6 7
value
÷÷8 =
,
÷÷= >
index
÷÷? D
)
÷÷D E
;
÷÷E F
if
ùù 
(
ùù 
(
ùù 
index
ùù 
==
ùù !
-
ùù" #
$num
ùù# $
)
ùù$ %
||
ùù& (
(
ùù) *
index
ùù* /
>=
ùù0 2
m_count
ùù3 :
-
ùù; <
$num
ùù= >
)
ùù> ?
)
ùù? @
{
úú 
break
ûû 
;
ûû 
}
üü 
if
şş 
(
şş 
m_data
şş 
[
şş 
++
şş !
index
şş! &
]
şş& '
==
şş( *
value
şş+ 0
)
şş0 1
{
ÿÿ 
removeAt
€€  
(
€€  !
index
€€! &
)
€€& '
;
€€' (
}
 
}
ƒƒ 
while
ƒƒ 
(
ƒƒ 
index
ƒƒ 
<=
ƒƒ !
m_count
ƒƒ" )
)
ƒƒ) *
;
ƒƒ* +
}
„„ 
catch
…… 
(
…… 
	Exception
…… 
ex
…… 
)
……  
{
†† 
FDebug
‡‡ 
.
‡‡ 
throwException
‡‡ %
(
‡‡% &
ex
‡‡& (
)
‡‡( )
;
‡‡) *
}
ˆˆ 
finally
‰‰ 
{
ŠŠ 
}
ŒŒ 
}
 	
public
‘‘ 
bool
‘‘ 
contains
‘‘ 
(
‘‘ 
byte
’’ 
value
’’ 
)
““ 
{
”” 	
try
•• 
{
–– 
if
—— 
(
—— 
m_count
—— 
==
—— 
$num
——  
)
——  !
{
˜˜ 
return
™™ 
false
™™  
;
™™  !
}
šš 
for
 
(
 
int
 
i
 
=
 
$num
 
;
 
i
  !
<
" #
m_count
$ +
;
+ ,
i
- .
++
. 0
)
0 1
{
ŸŸ 
if
   
(
   
m_data
   
[
   
i
    
]
    !
==
  " $
value
  % *
)
  * +
{
¡¡ 
return
¢¢ 
true
¢¢ #
;
¢¢# $
}
££ 
}
¤¤ 
return
¥¥ 
false
¥¥ 
;
¥¥ 
}
¦¦ 
catch
§§ 
(
§§ 
	Exception
§§ 
ex
§§ 
)
§§  
{
¨¨ 
FDebug
©© 
.
©© 
throwException
©© %
(
©©% &
ex
©©& (
)
©©( )
;
©©) *
}
ªª 
finally
«« 
{
¬¬ 
}
®® 
return
¯¯ 
false
¯¯ 
;
¯¯ 
}
°° 	
public
´´ 
void
´´ 
doDouble
´´ 
(
´´ 
byte
µµ 
value
µµ 
)
¶¶ 
{
·· 	
int
¸¸ 
index
¸¸ 
=
¸¸ 
$num
¸¸ 
;
¸¸ 
try
ºº 
{
»» 
index
¼¼ 
=
¼¼ 
indexOf
¼¼ 
(
¼¼  
value
¼¼  %
)
¼¼% &
;
¼¼& '
while
¾¾ 
(
¾¾ 
index
¾¾ 
!=
¾¾ 
-
¾¾  !
$num
¾¾! "
)
¾¾" #
{
¿¿ 
insert
ÀÀ 
(
ÀÀ 
index
ÀÀ  
,
ÀÀ  !
value
ÀÀ" '
)
ÀÀ' (
;
ÀÀ( )
index
ÁÁ 
=
ÁÁ 
indexOf
ÁÁ #
(
ÁÁ# $
value
ÁÁ$ )
,
ÁÁ) *
index
ÁÁ+ 0
+
ÁÁ1 2
$num
ÁÁ3 4
)
ÁÁ4 5
;
ÁÁ5 6
}
ÂÂ 
}
ÃÃ 
catch
ÄÄ 
(
ÄÄ 
	Exception
ÄÄ 
ex
ÄÄ 
)
ÄÄ  
{
ÅÅ 
FDebug
ÆÆ 
.
ÆÆ 
throwException
ÆÆ %
(
ÆÆ% &
ex
ÆÆ& (
)
ÆÆ( )
;
ÆÆ) *
}
ÇÇ 
finally
ÈÈ 
{
ÉÉ 
}
ËË 
}
ÌÌ 	
private
ĞĞ 
void
ĞĞ 
ensureCapacity
ĞĞ #
(
ĞĞ# $
int
ÑÑ 
minCapacity
ÑÑ 
)
ÒÒ 
{
ÓÓ 	
int
ÔÔ 
newCapacity
ÔÔ 
=
ÔÔ 
$num
ÔÔ 
;
ÔÔ  
try
ÖÖ 
{
×× 
if
ØØ 
(
ØØ 
m_data
ØØ 
.
ØØ 
Length
ØØ !
<
ØØ" #
minCapacity
ØØ$ /
)
ØØ/ 0
{
ÙÙ 
newCapacity
ÚÚ 
=
ÚÚ  !
(
ÚÚ" #
m_data
ÚÚ# )
.
ÚÚ) *
Length
ÚÚ* 0
==
ÚÚ1 3
$num
ÚÚ4 5
)
ÚÚ5 6
?
ÚÚ7 8
$num
ÚÚ9 ;
:
ÚÚ< =
m_data
ÚÚ> D
.
ÚÚD E
Length
ÚÚE K
*
ÚÚL M
$num
ÚÚN O
;
ÚÚO P
if
ŞŞ 
(
ŞŞ 
newCapacity
ŞŞ #
<
ŞŞ$ %
minCapacity
ŞŞ& 1
)
ŞŞ1 2
{
ßß 
newCapacity
àà #
=
àà$ %
minCapacity
àà& 1
;
àà1 2
}
áá 
this
ãã 
.
ãã 
capacity
ãã !
=
ãã" #
newCapacity
ãã$ /
;
ãã/ 0
}
ää 
}
åå 
catch
ææ 
(
ææ 
	Exception
ææ 
ex
ææ 
)
ææ  
{
çç 
FDebug
èè 
.
èè 
throwException
èè %
(
èè% &
ex
èè& (
)
èè( )
;
èè) *
}
éé 
finally
êê 
{
ëë 
}
íí 
}
îî 	
public
òò 
int
òò 
indexOf
òò 
(
òò 
byte
óó 
value
óó 
)
ôô 
{
õõ 	
try
öö 
{
÷÷ 
if
øø 
(
øø 
m_count
øø 
==
øø 
$num
øø  
)
øø  !
{
ùù 
return
úú 
-
úú 
$num
úú 
;
úú 
}
ûû 
return
üü 
Array
üü 
.
üü 
IndexOf
üü $
(
üü$ %
m_data
üü% +
,
üü+ ,
value
üü- 2
,
üü2 3
$num
üü4 5
,
üü5 6
m_count
üü7 >
)
üü> ?
;
üü? @
}
ıı 
catch
şş 
(
şş 
	Exception
şş 
ex
şş 
)
şş  
{
ÿÿ 
FDebug
€€ 
.
€€ 
throwException
€€ %
(
€€% &
ex
€€& (
)
€€( )
;
€€) *
}
 
finally
‚‚ 
{
ƒƒ 
}
…… 
return
†† 
-
†† 
$num
†† 
;
†† 
}
‡‡ 	
public
‹‹ 
int
‹‹ 
indexOf
‹‹ 
(
‹‹ 
byte
ŒŒ 
value
ŒŒ 
,
ŒŒ 
int
 

startIndex
 
)
 
{
 	
try
 
{
‘‘ 
if
’’ 
(
’’ 
(
’’ 
m_count
’’ 
==
’’ 
$num
’’  !
)
’’! "
||
’’# %
(
’’& '
m_count
’’' .
-
’’/ 0

startIndex
’’1 ;
>
’’< =
$num
’’> ?
)
’’? @
)
’’@ A
{
““ 
return
”” 
-
”” 
$num
”” 
;
”” 
}
•• 
return
–– 
Array
–– 
.
–– 
IndexOf
–– $
(
––$ %
m_data
––% +
,
––+ ,
value
––- 2
,
––2 3

startIndex
––4 >
,
––> ?
m_count
––@ G
-
––H I

startIndex
––J T
)
––T U
;
––U V
}
—— 
catch
˜˜ 
(
˜˜ 
	Exception
˜˜ 
ex
˜˜ 
)
˜˜  
{
™™ 
FDebug
šš 
.
šš 
throwException
šš %
(
šš% &
ex
šš& (
)
šš( )
;
šš) *
}
›› 
finally
œœ 
{
 
}
ŸŸ 
return
   
-
   
$num
   
;
   
}
¡¡ 	
public
¥¥ 
void
¥¥ 
insert
¥¥ 
(
¥¥ 
int
¦¦ 
index
¦¦ 
,
¦¦ 
byte
§§ 
value
§§ 
)
¨¨ 
{
©© 	
try
ªª 
{
«« 
if
¬¬ 
(
¬¬ 
(
¬¬ 
index
¬¬ 
<
¬¬ 
$num
¬¬ 
)
¬¬ 
||
¬¬  "
(
¬¬# $
index
¬¬$ )
>
¬¬* +
m_count
¬¬, 3
)
¬¬3 4
)
¬¬4 5
{
­­ 
FDebug
®® 
.
®® 
throwFException
®® *
(
®®* +
string
®®+ 1
.
®®1 2
Format
®®2 8
(
®®8 9

FConstants
®®9 C
.
®®C D

err_m_0005
®®D N
,
®®N O
$str
®®P W
)
®®W X
)
®®X Y
;
®®Y Z
}
¯¯ 
if
³³ 
(
³³ 
m_count
³³ 
==
³³ 
m_data
³³ %
.
³³% &
Length
³³& ,
)
³³, -
{
´´ 
ensureCapacity
µµ "
(
µµ" #
m_count
µµ# *
+
µµ+ ,
$num
µµ- .
)
µµ. /
;
µµ/ 0
}
¶¶ 
if
ºº 
(
ºº 
index
ºº 
<
ºº 
m_count
ºº #
)
ºº# $
{
»» 
Array
¼¼ 
.
¼¼ 
Copy
¼¼ 
(
¼¼ 
m_data
½½ 
,
½½ 
index
¾¾ 
,
¾¾ 
m_data
¿¿ 
,
¿¿ 
index
ÀÀ 
+
ÀÀ 
$num
ÀÀ  !
,
ÀÀ! "
m_count
ÁÁ 
-
ÁÁ  !
index
ÁÁ" '
)
ÁÁ' (
;
ÁÁ( )
}
ÂÂ 
m_data
ÄÄ 
[
ÄÄ 
index
ÄÄ 
]
ÄÄ 
=
ÄÄ 
value
ÄÄ  %
;
ÄÄ% &
m_count
ÅÅ 
++
ÅÅ 
;
ÅÅ 
}
ÆÆ 
catch
ÇÇ 
(
ÇÇ 
	Exception
ÇÇ 
ex
ÇÇ 
)
ÇÇ  
{
ÈÈ 
FDebug
ÉÉ 
.
ÉÉ 
throwException
ÉÉ %
(
ÉÉ% &
ex
ÉÉ& (
)
ÉÉ( )
;
ÉÉ) *
}
ÊÊ 
finally
ËË 
{
ÌÌ 
}
ÎÎ 
}
ÏÏ 	
public
ÓÓ 
void
ÓÓ 
insert
ÓÓ 
(
ÓÓ 
int
ÔÔ 
index
ÔÔ 
,
ÔÔ 
byte
ÕÕ 
[
ÕÕ 
]
ÕÕ 
values
ÕÕ 
)
ÖÖ 
{
×× 	
try
ØØ 
{
ÙÙ 
if
ÚÚ 
(
ÚÚ 
(
ÚÚ 
index
ÚÚ 
<
ÚÚ 
$num
ÚÚ 
)
ÚÚ 
||
ÚÚ  "
(
ÚÚ# $
index
ÚÚ$ )
>
ÚÚ* +
m_count
ÚÚ, 3
)
ÚÚ3 4
)
ÚÚ4 5
{
ÛÛ 
FDebug
ÜÜ 
.
ÜÜ 
throwFException
ÜÜ *
(
ÜÜ* +
string
ÜÜ+ 1
.
ÜÜ1 2
Format
ÜÜ2 8
(
ÜÜ8 9

FConstants
ÜÜ9 C
.
ÜÜC D

err_m_0005
ÜÜD N
,
ÜÜN O
$str
ÜÜP W
)
ÜÜW X
)
ÜÜX Y
;
ÜÜY Z
}
İİ 
if
ßß 
(
ßß 
values
ßß 
.
ßß 
Length
ßß !
==
ßß" $
$num
ßß% &
)
ßß& '
{
àà 
return
áá 
;
áá 
}
ââ 
ensureCapacity
ææ 
(
ææ 
m_count
ææ &
+
ææ' (
values
ææ) /
.
ææ/ 0
Length
ææ0 6
)
ææ6 7
;
ææ7 8
if
èè 
(
èè 
index
èè 
<
èè 
m_count
èè #
)
èè# $
{
éé 
Array
êê 
.
êê 
Copy
êê 
(
êê 
m_data
ëë 
,
ëë 
index
ìì 
,
ìì 
m_data
íí 
,
íí 
index
îî 
+
îî 
values
îî  &
.
îî& '
Length
îî' -
,
îî- .
m_count
ïï 
-
ïï  !
index
ïï" '
)
ïï' (
;
ïï( )
}
ğğ 
Array
ôô 
.
ôô 
Copy
ôô 
(
ôô 
values
õõ 
,
õõ 
$num
öö 
,
öö 
m_data
÷÷ 
,
÷÷ 
index
øø 
,
øø 
values
ùù 
.
ùù 
Length
ùù !
)
ùù! "
;
ùù" #
m_count
ûû 
+=
ûû 
values
ûû !
.
ûû! "
Length
ûû" (
;
ûû( )
}
üü 
catch
ıı 
(
ıı 
	Exception
ıı 
ex
ıı 
)
ıı  
{
şş 
FDebug
ÿÿ 
.
ÿÿ 
throwException
ÿÿ %
(
ÿÿ% &
ex
ÿÿ& (
)
ÿÿ( )
;
ÿÿ) *
}
€€ 
finally
 
{
‚‚ 
}
„„ 
}
…… 	
public
‰‰ 
void
‰‰ 
removeAt
‰‰ 
(
‰‰ 
int
ŠŠ 
index
ŠŠ 
)
‹‹ 
{
ŒŒ 	
try
 
{
 
if
 
(
 
(
 
index
 
<
 
$num
 
)
 
||
  "
(
# $
index
$ )
>=
* ,
m_count
- 4
)
4 5
)
5 6
{
 
FDebug
‘‘ 
.
‘‘ 
throwFException
‘‘ *
(
‘‘* +
string
‘‘+ 1
.
‘‘1 2
Format
‘‘2 8
(
‘‘8 9

FConstants
‘‘9 C
.
‘‘C D

err_m_0005
‘‘D N
,
‘‘N O
$str
‘‘P W
)
‘‘W X
)
‘‘X Y
;
‘‘Y Z
}
’’ 
if
–– 
(
–– 
index
–– 
==
–– 
m_count
–– $
-
––% &
$num
––' (
)
––( )
{
—— 
m_count
˜˜ 
--
˜˜ 
;
˜˜ 
return
™™ 
;
™™ 
}
šš 
if
œœ 
(
œœ 
index
œœ 
<
œœ 
m_count
œœ #
)
œœ# $
{
 
Array
 
.
 
Copy
 
(
 
m_data
ŸŸ 
,
ŸŸ 
index
   
+
   
$num
    !
,
  ! "
m_data
¡¡ 
,
¡¡ 
index
¢¢ 
,
¢¢ 
m_count
££ 
-
££  !
index
££" '
-
££( )
$num
££* +
)
££+ ,
;
££, -
m_count
¥¥ 
--
¥¥ 
;
¥¥ 
}
¦¦ 
}
§§ 
catch
¨¨ 
(
¨¨ 
	Exception
¨¨ 
ex
¨¨ 
)
¨¨  
{
©© 
FDebug
ªª 
.
ªª 
throwException
ªª %
(
ªª% &
ex
ªª& (
)
ªª( )
;
ªª) *
}
«« 
finally
¬¬ 
{
­­ 
}
¯¯ 
}
°° 	
public
´´ 
void
´´ 
replace
´´ 
(
´´ 
byte
µµ 
value
µµ 
,
µµ 
byte
¶¶ 
[
¶¶ 
]
¶¶ 
newValue
¶¶ 
)
·· 
{
¸¸ 	
int
¹¹ 
index
¹¹ 
;
¹¹ 
try
»» 
{
¼¼ 
if
½½ 
(
½½ 
newValue
½½ 
==
½½ 
null
½½  $
)
½½$ %
{
¾¾ 
FDebug
¿¿ 
.
¿¿ 
throwFException
¿¿ *
(
¿¿* +
string
¿¿+ 1
.
¿¿1 2
Format
¿¿2 8
(
¿¿8 9

FConstants
¿¿9 C
.
¿¿C D

err_m_0016
¿¿D N
,
¿¿N O
$str
¿¿P [
)
¿¿[ \
)
¿¿\ ]
;
¿¿] ^
}
ÀÀ 
index
ÄÄ 
=
ÄÄ 
indexOf
ÄÄ 
(
ÄÄ  
value
ÄÄ  %
)
ÄÄ% &
;
ÄÄ& '
while
ÆÆ 
(
ÆÆ 
index
ÆÆ 
!=
ÆÆ 
-
ÆÆ  !
$num
ÆÆ! "
)
ÆÆ" #
{
ÇÇ 
removeAt
ÈÈ 
(
ÈÈ 
index
ÈÈ "
)
ÈÈ" #
;
ÈÈ# $
insert
ÉÉ 
(
ÉÉ 
index
ÉÉ  
,
ÉÉ  !
newValue
ÉÉ" *
)
ÉÉ* +
;
ÉÉ+ ,
index
ÊÊ 
=
ÊÊ 
indexOf
ÊÊ #
(
ÊÊ# $
value
ÊÊ$ )
,
ÊÊ) *
index
ÊÊ+ 0
+
ÊÊ1 2
newValue
ÊÊ3 ;
.
ÊÊ; <
Length
ÊÊ< B
)
ÊÊB C
;
ÊÊC D
}
ËË 
}
ÌÌ 
catch
ÍÍ 
(
ÍÍ 
	Exception
ÍÍ 
ex
ÍÍ 
)
ÍÍ  
{
ÎÎ 
FDebug
ÏÏ 
.
ÏÏ 
throwException
ÏÏ %
(
ÏÏ% &
ex
ÏÏ& (
)
ÏÏ( )
;
ÏÏ) *
}
ĞĞ 
finally
ÑÑ 
{
ÒÒ 
}
ÔÔ 
}
ÕÕ 	
public
ÙÙ 
byte
ÙÙ 
[
ÙÙ 
]
ÙÙ 
toArrary
ÙÙ 
(
ÙÙ 
)
ÚÚ 
{
ÛÛ 	
byte
ÜÜ 
[
ÜÜ 
]
ÜÜ 
returnArray
ÜÜ 
=
ÜÜ  
null
ÜÜ! %
;
ÜÜ% &
try
ŞŞ 
{
ßß 
returnArray
àà 
=
àà 
new
àà !
byte
àà" &
[
àà& '
m_count
àà' .
]
àà. /
;
àà/ 0
Buffer
ää 
.
ää 
	BlockCopy
ää  
(
ää  !
m_data
åå 
,
åå 
$num
ææ 
,
ææ 
returnArray
çç 
,
çç  
$num
èè 
,
èè 
m_count
éé 
)
éé 
;
éé 
return
íí 
returnArray
íí "
;
íí" #
}
îî 
catch
ïï 
(
ïï 
	Exception
ïï 
ex
ïï 
)
ïï  
{
ğğ 
FDebug
ññ 
.
ññ 
throwException
ññ %
(
ññ% &
ex
ññ& (
)
ññ( )
;
ññ) *
}
òò 
finally
óó 
{
ôô 
}
öö 
return
÷÷ 
null
÷÷ 
;
÷÷ 
}
øø 	
}
şş 
}ÿÿ õ$
eD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Telnet\c_FTelnetCommandPacket.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class  
FTelnetCommandPacket %
:& '
FITelnetPacket( 6
,6 7
IDisposable8 C
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FTelnetCommand 

m_fCommand )
;) *
public!!  
FTelnetCommandPacket!! #
(!!# $
FTelnetCommand"" 
fTelnetCommand"" )
)## 
{$$ 	
if%% 
(%% 
fTelnetCommand&& 
==&& !
FTelnetCommand&&" 0
.&&0 1
Do&&1 3
||&&4 6
fTelnetCommand'' 
=='' !
FTelnetCommand''" 0
.''0 1
Dont''1 5
||''6 8
fTelnetCommand(( 
==(( !
FTelnetCommand((" 0
.((0 1
Will((1 5
||((6 8
fTelnetCommand)) 
==)) !
FTelnetCommand))" 0
.))0 1
Wont))1 5
)** 
{++ 
FDebug,, 
.,, 
throwFException,, &
(,,& '
string,,' -
.,,- .
Format,,. 4
(,,4 5

FConstants,,5 ?
.,,? @

err_m_0015,,@ J
,,,J K
$str,,L U
),,U V
),,V W
;,,W X
}-- 
this.. 
... 

m_fCommand.. 
=.. 
fTelnetCommand.. ,
;.., -
}// 	
~33 	 
FTelnetCommandPacket33	 
(33 
)44 
{55 	
	myDispose66 
(66 
false66 
)66 
;66 
}77 	
	protected;; 
void;; 
	myDispose;;  
(;;  !
bool<< 
	disposing<< 
)== 
{>> 	
if?? 
(?? 
!?? 

m_disposed?? 
)?? 
{@@ 
ifAA 
(AA 
	disposingAA 
)AA 
{BB 
termCC 
(CC 
)CC 
;CC 
}DD 

m_disposedEE 
=EE 
trueEE !
;EE! "
}FF 
}GG 	
publicOO 
voidOO 
DisposeOO 
(OO 
)PP 
{QQ 	
	myDisposeRR 
(RR 
trueRR 
)RR 
;RR 
GCSS 
.SS 
SuppressFinalizeSS 
(SS  
thisSS  $
)SS$ %
;SS% &
}TT 	
public\\ 
FTelnetPacketType\\  
fPacketType\\! ,
{]] 	
get^^ 
{__ 
try`` 
{aa 
returnbb 
FTelnetPacketTypebb ,
.bb, -
Commandbb- 4
;bb4 5
}cc 
catchdd 
(dd 
	Exceptiondd  
exdd! #
)dd# $
{ee 
FDebugff 
.ff 
throwExceptionff )
(ff) *
exff* ,
)ff, -
;ff- .
}gg 
finallyhh 
{ii 
}kk 
returnll 
FTelnetPacketTypell (
.ll( )
Commandll) 0
;ll0 1
}mm 
}nn 	
publicrr 
FTelnetCommandrr 
fCommandrr &
{ss 	
gettt 
{uu 
tryvv 
{ww 
returnxx 
thisxx 
.xx  

m_fCommandxx  *
;xx* +
}yy 
catchzz 
(zz 
	Exceptionzz  
exzz! #
)zz# $
{{{ 
FDebug|| 
.|| 
throwException|| )
(||) *
ex||* ,
)||, -
;||- .
}}} 
finally~~ 
{ 
}
 
return
‚‚ 
FTelnetCommand
‚‚ %
.
‚‚% &
NoOperation
‚‚& 1
;
‚‚1 2
}
ƒƒ 
}
„„ 	
private
ŒŒ 
void
ŒŒ 
term
ŒŒ 
(
ŒŒ 
)
ŒŒ 
{
 	
try
 
{
 
}
‘‘ 
catch
’’ 
(
’’ 
	Exception
’’ 
ex
’’ 
)
’’  
{
““ 
FDebug
”” 
.
”” 
throwException
”” %
(
””% &
ex
””& (
)
””( )
;
””) *
}
•• 
finally
–– 
{
—— 
}
™™ 
}
šš 	
}
   
}¡¡ š#
bD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Telnet\c_FTelnetDataPacket.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FTelnetDataPacket "
:# $
FITelnetPacket% 3
,3 4
IDisposable5 @
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
byte 
[ 
] 
m_data 
; 
public!! 
FTelnetDataPacket!!  
(!!  !
byte"" 
["" 
]"" 
data"" 
)## 
{$$ 	
if%% 
(%% 
data%% 
==%% 
null%% 
)%% 
{&& 
FDebug'' 
.'' 
throwFException'' &
(''& '
string''' -
.''- .
Format''. 4
(''4 5

FConstants''5 ?
.''? @

err_m_0016''@ J
,''J K
$str''L R
)''R S
)''S T
;''T U
}(( 
this)) 
.)) 
m_data)) 
=)) 
()) 
byte)) 
[))  
]))  !
)))! "
data))" &
.))& '
Clone))' ,
()), -
)))- .
;)). /
}** 	
~.. 	
FTelnetDataPacket..	 
(.. 
)// 
{00 	
	myDispose11 
(11 
false11 
)11 
;11 
}22 	
	protected66 
void66 
	myDispose66  
(66  !
bool77 
	disposing77 
)88 
{99 	
if:: 
(:: 
!:: 

m_disposed:: 
):: 
{;; 
if<< 
(<< 
	disposing<< 
)<< 
{== 
term>> 
(>> 
)>> 
;>> 
}?? 

m_disposed@@ 
=@@ 
true@@ !
;@@! "
}AA 
}BB 	
publicJJ 
voidJJ 
DisposeJJ 
(JJ 
)KK 
{LL 	
	myDisposeMM 
(MM 
trueMM 
)MM 
;MM 
GCNN 
.NN 
SuppressFinalizeNN 
(NN  
thisNN  $
)NN$ %
;NN% &
}OO 	
publicWW 
byteWW 
[WW 
]WW 
dataWW 
{XX 	
getYY 
{ZZ 
try[[ 
{\\ 
return]] 
this]] 
.]]  
m_data]]  &
;]]& '
}^^ 
catch__ 
(__ 
	Exception__  
ex__! #
)__# $
{`` 
FDebugaa 
.aa 
throwExceptionaa )
(aa) *
exaa* ,
)aa, -
;aa- .
}bb 
finallycc 
{dd 
}ff 
returngg 
nullgg 
;gg 
}hh 
}ii 	
publicmm 
FTelnetPacketTypemm  
fPacketTypemm! ,
{nn 	
getoo 
{pp 
tryqq 
{rr 
returnss 
FTelnetPacketTypess ,
.ss, -
Datass- 1
;ss1 2
}tt 
catchuu 
(uu 
	Exceptionuu  
exuu! #
)uu# $
{vv 
FDebugww 
.ww 
throwExceptionww )
(ww) *
exww* ,
)ww, -
;ww- .
}xx 
finallyyy 
{zz 
}|| 
return}} 
FTelnetPacketType}} (
.}}( )
Data}}) -
;}}- .
}~~ 
} 	
private
‡‡ 
void
‡‡ 
term
‡‡ 
(
‡‡ 
)
‡‡ 
{
ˆˆ 	
try
‰‰ 
{
ŠŠ 
this
‹‹ 
.
‹‹ 
m_data
‹‹ 
=
‹‹ 
null
‹‹ "
;
‹‹" #
}
ŒŒ 
catch
 
(
 
	Exception
 
ex
 
)
  
{
 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
‘‘ 
{
’’ 
}
”” 
}
•• 	
}
›› 
}œœ 0
dD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Telnet\c_FTelnetOptionPacket.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FTelnetOptionPacket $
:% &
FITelnetPacket' 5
,5 6
IDisposable7 B
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FTelnetCommand 

m_fCommand )
;) *
private 
FTelnetOption 
	m_fOption '
;' (
public!! 
FTelnetOptionPacket!! "
(!!" #
FTelnetCommand"" 
fCommand"" #
,""# $
FTelnetOption## 
fOption## !
)$$ 
{%% 	
if&& 
(&& 
fCommand'' 
=='' 
FTelnetCommand'' *
.''* +
Do''+ -
||''. 0
fCommand(( 
==(( 
FTelnetCommand(( *
.((* +
Dont((+ /
||((0 2
fCommand)) 
==)) 
FTelnetCommand)) *
.))* +
Will))+ /
||))0 2
fCommand** 
==** 
FTelnetCommand** *
.*** +
Wont**+ /
)++ 
{,, 
this-- 
.-- 

m_fCommand-- 
=--  !
fCommand--" *
;--* +
this.. 
... 
	m_fOption.. 
=..  
fOption..! (
;..( )
}// 
else00 
{11 
FDebug22 
.22 
throwFException22 &
(22& '
string22' -
.22- .
Format22. 4
(224 5

FConstants225 ?
.22? @

err_m_001522@ J
,22J K
$str22L U
)22U V
)22V W
;22W X
}33 
}44 	
public88 
FTelnetOptionPacket88 "
(88" #
FTelnetCommand99 
fCommand99 #
,99# $
byte:: 
option:: 
);; 
:<< 
this<< 
(<< 
fCommand<< 
,<< 
(<< 
FTelnetOption<< +
)<<+ ,
option<<, 2
)<<2 3
{== 	
}?? 	
~CC 	
FTelnetOptionPacketCC	 
(CC 
)DD 
{EE 	
	myDisposeFF 
(FF 
falseFF 
)FF 
;FF 
}GG 	
	protectedKK 
voidKK 
	myDisposeKK  
(KK  !
boolLL 
	disposingLL 
)MM 
{NN 	
ifOO 
(OO 
!OO 

m_disposedOO 
)OO 
{PP 
ifQQ 
(QQ 
	disposingQQ 
)QQ 
{RR 
termSS 
(SS 
)SS 
;SS 
}TT 

m_disposedUU 
=UU 
trueUU !
;UU! "
}VV 
}WW 	
public__ 
void__ 
Dispose__ 
(__ 
)`` 
{aa 	
	myDisposebb 
(bb 
truebb 
)bb 
;bb 
GCcc 
.cc 
SuppressFinalizecc 
(cc  
thiscc  $
)cc$ %
;cc% &
}dd 	
publicll 
FTelnetPacketTypell  
fPacketTypell! ,
{mm 	
getnn 
{oo 
trypp 
{qq 
returnrr 
FTelnetPacketTyperr ,
.rr, -
Optionrr- 3
;rr3 4
}ss 
catchtt 
(tt 
	Exceptiontt  
extt! #
)tt# $
{uu 
FDebugvv 
.vv 
throwExceptionvv )
(vv) *
exvv* ,
)vv, -
;vv- .
}ww 
finallyxx 
{yy 
}{{ 
return|| 
FTelnetPacketType|| (
.||( )
Option||) /
;||/ 0
}}} 
}~~ 	
public
‚‚ 
FTelnetCommand
‚‚ 
fCommand
‚‚ &
{
ƒƒ 	
get
„„ 
{
…… 
try
†† 
{
‡‡ 
return
ˆˆ 
this
ˆˆ 
.
ˆˆ  

m_fCommand
ˆˆ  *
;
ˆˆ* +
}
‰‰ 
catch
ŠŠ 
(
ŠŠ 
	Exception
ŠŠ  
ex
ŠŠ! #
)
ŠŠ# $
{
‹‹ 
FDebug
ŒŒ 
.
ŒŒ 
throwException
ŒŒ )
(
ŒŒ) *
ex
ŒŒ* ,
)
ŒŒ, -
;
ŒŒ- .
}
 
finally
 
{
 
}
‘‘ 
return
’’ 
FTelnetCommand
’’ %
.
’’% &
NoOperation
’’& 1
;
’’1 2
}
““ 
}
”” 	
public
˜˜ 
FTelnetOption
˜˜ 
fOption
˜˜ $
{
™™ 	
get
šš 
{
›› 
try
œœ 
{
 
return
 
	m_fOption
 $
;
$ %
}
ŸŸ 
catch
   
(
   
	Exception
    
ex
  ! #
)
  # $
{
¡¡ 
FDebug
¢¢ 
.
¢¢ 
throwException
¢¢ )
(
¢¢) *
ex
¢¢* ,
)
¢¢, -
;
¢¢- .
}
££ 
finally
¤¤ 
{
¥¥ 
}
§§ 
return
¨¨ 
FTelnetOption
¨¨ $
.
¨¨$ %
TransmitBinary
¨¨% 3
;
¨¨3 4
}
©© 
}
ªª 	
private
²² 
void
²² 
term
²² 
(
²² 
)
²² 
{
³³ 	
try
´´ 
{
µµ 
}
·· 
catch
¸¸ 
(
¸¸ 
	Exception
¸¸ 
ex
¸¸ 
)
¸¸  
{
¹¹ 
FDebug
ºº 
.
ºº 
throwException
ºº %
(
ºº% &
ex
ºº& (
)
ºº( )
;
ºº) *
}
»» 
finally
¼¼ 
{
½½ 
}
¿¿ 
}
ÀÀ 	
}
ÆÆ 
}ÇÇ É
oD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Telnet\c_FTelnetPacketReceivedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
Serializable 
] 
public 

class *
FTelnetPacketReceivedEventArgs /
:0 1 
FTelnetEventArgsBase2 F
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FITelnetPacket 
	m_fPacket (
;( )
internal *
FTelnetPacketReceivedEventArgs /
(/ 0
FITelnetPacket   
fTelnetPacket   (
)!! 
:"" 
base"" 
("" 
FTelnetEventId"" "
.""" # 
TelnetPacketReceived""# 7
)""7 8
{## 	
this$$ 
.$$ 
	m_fPacket$$ 
=$$ 
fTelnetPacket$$ *
;$$* +
}%% 	
~)) 	*
FTelnetPacketReceivedEventArgs))	 '
())' (
)** 
{++ 	
	myDispose,, 
(,, 
false,, 
),, 
;,, 
}-- 	
	protected11 
override11 
void11 
	myDispose11  )
(11) *
bool22 
	disposing22 
)33 
{44 	
if55 
(55 
!55 
this55 
.55 

m_disposed55  
)55  !
{66 
if77 
(77 
	disposing77 
)77 
{88 
}:: 
this;; 
.;; 

m_disposed;; 
=;;  !
true;;" &
;;;& '
base?? 
.?? 
	myDispose?? 
(?? 
	disposing?? (
)??( )
;??) *
}@@ 
}AA 	
publicII 
FITelnetPacketII 
fPacketII %
{JJ 	
getKK 
{LL 
tryMM 
{NN 
returnOO 
thisOO 
.OO  
	m_fPacketOO  )
;OO) *
}PP 
catchQQ 
(QQ 
	ExceptionQQ  
exQQ! #
)QQ# $
{RR 
FDebugSS 
.SS 
throwExceptionSS )
(SS) *
exSS* ,
)SS, -
;SS- .
}TT 
finallyUU 
{VV 
}XX 
returnYY 
nullYY 
;YY 
}ZZ 
}[[ 	
}gg 
}hh ¯
kD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Telnet\c_FTelnetPacketSentEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
Serializable 
] 
public 

class &
FTelnetPacketSentEventArgs +
:, - 
FTelnetEventArgsBase. B
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FITelnetPacket 
	m_fPacket (
;( )
internal"" &
FTelnetPacketSentEventArgs"" +
(""+ ,
FITelnetPacket## 
fPacket## "
)$$ 
:%% 
base%% 
(%% 
FTelnetEventId%% !
.%%! "
TelnetPacketSent%%" 2
)%%2 3
{&& 	
this'' 
.'' 
	m_fPacket'' 
='' 
fPacket'' $
;''$ %
}(( 	
~,, 	&
FTelnetPacketSentEventArgs,,	 #
(,,# $
)-- 
{.. 	
	myDispose// 
(// 
false// 
)// 
;// 
}00 	
	protected44 
override44 
void44 
	myDispose44  )
(44) *
bool55 
	disposing55 
)66 
{77 	
if88 
(88 
!88 
this88 
.88 

m_disposed88  
)88  !
{99 
if:: 
(:: 
	disposing:: 
):: 
{;; 
}== 
this>> 
.>> 

m_disposed>> 
=>>  !
true>>" &
;>>& '
baseBB 
.BB 
	myDisposeBB 
(BB 
	disposingBB (
)BB( )
;BB) *
}CC 
}DD 	
publicLL 
FITelnetPacketLL 
fTelnetPacketLL +
{MM 	
getNN 
{OO 
tryPP 
{QQ 
returnRR 
thisRR 
.RR  
	m_fPacketRR  )
;RR) *
}SS 
catchTT 
(TT 
	ExceptionTT  
exTT! #
)TT# $
{UU 
FDebugVV 
.VV 
throwExceptionVV )
(VV) *
exVV* ,
)VV, -
;VV- .
}WW 
finallyXX 
{YY 
}[[ 
return\\ 
null\\ 
;\\ 
}]] 
}^^ 	
}jj 
}kk §
eD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Telnet\c_FTelnetEventArgsBase.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
Serializable 
] 
public 

abstract 
class  
FTelnetEventArgsBase .
:/ 0
	EventArgs1 :
,: ;
IDisposable< G
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FTelnetEventId 
m_fTelnetEventId /
=0 1
FTelnetEventId2 @
.@ A
NoneA E
;E F
internal!!  
FTelnetEventArgsBase!! %
(!!% &
FTelnetEventId"" 
fTelnetEventId"" )
)## 
{$$ 	
m_fTelnetEventId%% 
=%% 
fTelnetEventId%% -
;%%- .
}&& 	
~** 	 
FTelnetEventArgsBase**	 
(** 
)++ 
{,, 	
	myDispose-- 
(-- 
false-- 
)-- 
;-- 
}.. 	
	protected22 
virtual22 
void22 
	myDispose22 (
(22( )
bool33 
	disposing33 
)44 
{55 	
if66 
(66 
!66 

m_disposed66 
)66 
{77 
if88 
(88 
	disposing88 
)88 
{99 
};; 

m_disposed== 
=== 
true== !
;==! "
}>> 
}?? 	
publicGG 
voidGG 
DisposeGG 
(GG 
)HH 
{II 	
	myDisposeJJ 
(JJ 
trueJJ 
)JJ 
;JJ 
GCKK 
.KK 
SuppressFinalizeKK 
(KK  
thisKK  $
)KK$ %
;KK% &
}LL 	
internalTT 
FTelnetEventIdTT 
fTelnetEventIdTT  .
{UU 	
getVV 
{WW 
tryXX 
{YY 
returnZZ 
m_fTelnetEventIdZZ +
;ZZ+ ,
}[[ 
catch\\ 
(\\ 
	Exception\\  
ex\\! #
)\\# $
{]] 
FDebug^^ 
.^^ 
throwException^^ )
(^^) *
ex^^* ,
)^^, -
;^^- .
}__ 
finally`` 
{aa 
}cc 
returndd 
FTelnetEventIddd %
.dd% &
Nonedd& *
;dd* +
}ee 
}ff 	
}rr 
}ss ¾{
cD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Telnet\c_FTelnetEventPusher.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
internal 
class 
FTelnetEventPusher %
:& '
IDisposable( 3
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
FTelnetClient 
m_fTelnetClient %
=& '
null( ,
;, -
private 
FQueue 
<  
FTelnetEventArgsBase +
>+ ,
	m_fEvents- 6
=7 8
null9 =
;= >
private 
FThread 
m_fEventPusher &
=' (
null) -
;- .
private 
bool &
m_isCompletedEventHandling /
=0 1
false2 7
;7 8
private 
bool 
m_suspended  
=! "
false# (
;( )
public%% 
FTelnetEventPusher%% !
(%%! "
FTelnetClient&& 
fTelnetClient&& '
,&&' (
bool'' 
	suspended'' 
)(( 
{)) 	
m_fTelnetClient** 
=** 
fTelnetClient** +
;**+ ,
	m_fEvents++ 
=++ 
new++ 
FQueue++ "
<++" # 
FTelnetEventArgsBase++# 7
>++7 8
(++8 9
)++9 :
;++: ;
m_suspended,, 
=,, 
	suspended,, #
;,,# $
init00 
(00 
)00 
;00 
}11 	
~55 	
FTelnetEventPusher55	 
(55 
)66 
{77 	
	myDispose88 
(88 
false88 
)88 
;88 
}99 	
	protected== 
void== 
	myDispose==  
(==  !
bool>> 
	disposing>> 
)?? 
{@@ 	
ifAA 
(AA 
!AA 

m_disposedAA 
)AA 
{BB 
ifCC 
(CC 
	disposingCC 
)CC 
{DD 
termEE 
(EE 
)EE 
;EE 
ifII 
(II 
	m_fEventsII !
!=II" $
nullII% )
)II) *
{JJ 
	m_fEventsKK !
.KK! "
DisposeKK" )
(KK) *
)KK* +
;KK+ ,
	m_fEventsLL !
=LL" #
nullLL$ (
;LL( )
}MM 
}NN 

m_disposedPP 
=PP 
truePP !
;PP! "
}QQ 
}RR 	
publicZZ 
voidZZ 
DisposeZZ 
(ZZ 
)[[ 
{\\ 	
	myDispose]] 
(]] 
true]] 
)]] 
;]] 
GC^^ 
.^^ 
SuppressFinalize^^ 
(^^  
this^^  $
)^^$ %
;^^% &
}__ 	
publicgg 
intgg 

eventCountgg 
{hh 	
getii 
{jj 
trykk 
{ll 
returnmm 
	m_fEventsmm $
.mm$ %
countmm% *
;mm* +
}nn 
catchoo 
(oo 
	Exceptionoo  
exoo! #
)oo# $
{pp 
FDebugqq 
.qq 
throwExceptionqq )
(qq) *
exqq* ,
)qq, -
;qq- .
}rr 
finallyss 
{tt 
}vv 
returnww 
$numww 
;ww 
}xx 
}yy 	
public}} 
bool}} $
isCompletedEventHandling}} ,
{~~ 	
get 
{
€€ 
try
 
{
‚‚ 
if
ƒƒ 
(
ƒƒ 
this
ƒƒ 
.
ƒƒ 

eventCount
ƒƒ '
==
ƒƒ( *
$num
ƒƒ+ ,
&&
ƒƒ- /(
m_isCompletedEventHandling
ƒƒ0 J
)
ƒƒJ K
{
„„ 
return
…… 
true
…… #
;
……# $
}
†† 
return
‡‡ 
false
‡‡  
;
‡‡  !
}
ˆˆ 
catch
‰‰ 
(
‰‰ 
	Exception
‰‰  
ex
‰‰! #
)
‰‰# $
{
ŠŠ 
FDebug
‹‹ 
.
‹‹ 
throwException
‹‹ )
(
‹‹) *
ex
‹‹* ,
)
‹‹, -
;
‹‹- .
}
ŒŒ 
finally
 
{
 
}
 
return
‘‘ 
false
‘‘ 
;
‘‘ 
}
’’ 
}
““ 	
public
—— 
bool
—— 
	suspended
—— 
{
˜˜ 	
get
™™ 
{
šš 
try
›› 
{
œœ 
return
 
m_suspended
 &
;
& '
}
 
catch
ŸŸ 
(
ŸŸ 
	Exception
ŸŸ  
ex
ŸŸ! #
)
ŸŸ# $
{
   
FDebug
¡¡ 
.
¡¡ 
throwException
¡¡ )
(
¡¡) *
ex
¡¡* ,
)
¡¡, -
;
¡¡- .
}
¢¢ 
finally
££ 
{
¤¤ 
}
¦¦ 
return
§§ 
false
§§ 
;
§§ 
}
¨¨ 
}
©© 	
private
±± 
void
±± 
init
±± 
(
±± 
)
²² 
{
³³ 	
try
´´ 
{
µµ (
m_isCompletedEventHandling
¶¶ *
=
¶¶+ ,
true
¶¶- 1
;
¶¶1 2
m_fEventPusher
·· 
=
··  
new
··! $
FThread
··% ,
(
··, -
$str
··- F
,
··F G
false
··H M
,
··M N
System
··O U
.
··U V
	Threading
··V _
.
··_ `
ThreadPriority
··` n
.
··n o
Normal
··o u
,
··u v
false
··w |
)
··| }
;
··} ~
m_fEventPusher
¸¸ 
.
¸¸ 
ThreadJobCalled
¸¸ .
+=
¸¸/ 1
new
¸¸2 5*
FThreadJobCalledEventHandler
¸¸6 R
(
¸¸R S,
m_fEventPusher_ThreadJobCalled
¸¸S q
)
¸¸q r
;
¸¸r s
m_fEventPusher
¹¹ 
.
¹¹ 
start
¹¹ $
(
¹¹$ %
)
¹¹% &
;
¹¹& '
}
ºº 
catch
»» 
(
»» 
	Exception
»» 
ex
»» 
)
»»  
{
¼¼ 
FDebug
½½ 
.
½½ 
throwException
½½ %
(
½½% &
ex
½½& (
)
½½( )
;
½½) *
}
¾¾ 
finally
¿¿ 
{
ÀÀ 
}
ÂÂ 
}
ÃÃ 	
private
ÇÇ 
void
ÇÇ 
term
ÇÇ 
(
ÇÇ 
)
ÈÈ 
{
ÉÉ 	
try
ÊÊ 
{
ËË 
if
ÌÌ 
(
ÌÌ 
m_fEventPusher
ÌÌ "
!=
ÌÌ# %
null
ÌÌ& *
)
ÌÌ* +
{
ÍÍ 
while
ÎÎ 
(
ÎÎ 
!
ÎÎ 
this
ÎÎ  
.
ÎÎ  !&
isCompletedEventHandling
ÎÎ! 9
)
ÎÎ9 :
{
ÏÏ 
System
ĞĞ 
.
ĞĞ 
	Threading
ĞĞ (
.
ĞĞ( )
Thread
ĞĞ) /
.
ĞĞ/ 0
Sleep
ĞĞ0 5
(
ĞĞ5 6
$num
ĞĞ6 8
)
ĞĞ8 9
;
ĞĞ9 :
}
ÑÑ 
m_fEventPusher
ÕÕ "
.
ÕÕ" #
ThreadJobCalled
ÕÕ# 2
-=
ÕÕ3 5
new
ÕÕ6 9*
FThreadJobCalledEventHandler
ÕÕ: V
(
ÕÕV W,
m_fEventPusher_ThreadJobCalled
ÕÕW u
)
ÕÕu v
;
ÕÕv w
m_fEventPusher
×× "
.
××" #
stop
××# '
(
××' (
)
××( )
;
××) *
m_fEventPusher
ØØ "
.
ØØ" #
Dispose
ØØ# *
(
ØØ* +
)
ØØ+ ,
;
ØØ, -
m_fEventPusher
ÙÙ "
=
ÙÙ# $
null
ÙÙ% )
;
ÙÙ) *
}
ÚÚ 
}
ÛÛ 
catch
ÜÜ 
(
ÜÜ 
	Exception
ÜÜ 
ex
ÜÜ 
)
ÜÜ  
{
İİ 
FDebug
ŞŞ 
.
ŞŞ 
throwException
ŞŞ %
(
ŞŞ% &
ex
ŞŞ& (
)
ŞŞ( )
;
ŞŞ) *
}
ßß 
finally
àà 
{
áá 
}
ãã 
}
ää 	
public
èè 
void
èè 
	pushEvent
èè 
(
èè "
FTelnetEventArgsBase
éé  
fTelnetEvent
éé! -
)
êê 
{
ëë 	
try
ìì 
{
íí 
	m_fEvents
îî 
.
îî 
enqueue
îî !
(
îî! "
fTelnetEvent
îî" .
)
îî. /
;
îî/ 0
}
ïï 
catch
ğğ 
(
ğğ 
	Exception
ğğ 
ex
ğğ 
)
ğğ  
{
ññ 
FDebug
òò 
.
òò 
throwException
òò %
(
òò% &
ex
òò& (
)
òò( )
;
òò) *
}
óó 
finally
ôô 
{
õõ 
}
÷÷ 
}
øø 	
public
üü 
void
üü 
	pushEvent
üü 
(
üü "
FTelnetEventArgsBase
ıı  
[
ıı  !
]
ıı! "
fTelnetEvents
ıı# 0
)
şş 
{
ÿÿ 	
try
€€ 
{
 
	m_fEvents
‚‚ 
.
‚‚ 
enqueue
‚‚ !
(
‚‚! "
fTelnetEvents
‚‚" /
)
‚‚/ 0
;
‚‚0 1
}
ƒƒ 
catch
„„ 
(
„„ 
	Exception
„„ 
ex
„„ 
)
„„  
{
…… 
FDebug
†† 
.
†† 
throwException
†† %
(
††% &
ex
††& (
)
††( )
;
††) *
}
‡‡ 
finally
ˆˆ 
{
‰‰ 
}
‹‹ 
}
ŒŒ 	
public
 
void
 
suspend
 
(
 
)
‘‘ 
{
’’ 	
try
““ 
{
”” 
m_suspended
•• 
=
•• 
true
•• "
;
••" #
}
–– 
catch
—— 
(
—— 
	Exception
—— 
ex
—— 
)
——  
{
˜˜ 
FDebug
™™ 
.
™™ 
throwException
™™ %
(
™™% &
ex
™™& (
)
™™( )
;
™™) *
}
šš 
finally
›› 
{
œœ 
}
 
}
ŸŸ 	
public
££ 
void
££ 
resume
££ 
(
££ 
)
¤¤ 
{
¥¥ 	
try
¦¦ 
{
§§ 
m_suspended
¨¨ 
=
¨¨ 
false
¨¨ #
;
¨¨# $
}
©© 
catch
ªª 
(
ªª 
	Exception
ªª 
ex
ªª 
)
ªª  
{
«« 
FDebug
¬¬ 
.
¬¬ 
throwException
¬¬ %
(
¬¬% &
ex
¬¬& (
)
¬¬( )
;
¬¬) *
}
­­ 
finally
®® 
{
¯¯ 
}
±± 
}
²² 	
public
¶¶ 
void
¶¶ (
waitEventHandlingCompleted
¶¶ .
(
¶¶. /
)
·· 
{
¸¸ 	
try
¹¹ 
{
ºº 
while
»» 
(
»» 
!
»» 
this
»» 
.
»» &
isCompletedEventHandling
»» 5
)
»»5 6
{
¼¼ 
if
½½ 
(
½½ 
System
½½ 
.
½½ 
Windows
½½ &
.
½½& '
Forms
½½' ,
.
½½, -
Application
½½- 8
.
½½8 9
MessageLoop
½½9 D
)
½½D E
{
¾¾ 
System
¿¿ 
.
¿¿ 
Windows
¿¿ &
.
¿¿& '
Forms
¿¿' ,
.
¿¿, -
Application
¿¿- 8
.
¿¿8 9
DoEvents
¿¿9 A
(
¿¿A B
)
¿¿B C
;
¿¿C D
}
ÀÀ 
System
ÁÁ 
.
ÁÁ 
	Threading
ÁÁ $
.
ÁÁ$ %
Thread
ÁÁ% +
.
ÁÁ+ ,
Sleep
ÁÁ, 1
(
ÁÁ1 2
$num
ÁÁ2 3
)
ÁÁ3 4
;
ÁÁ4 5
}
ÂÂ 
}
ÃÃ 
catch
ÄÄ 
(
ÄÄ 
	Exception
ÄÄ 
ex
ÄÄ 
)
ÄÄ  
{
ÅÅ 
FDebug
ÆÆ 
.
ÆÆ 
throwException
ÆÆ %
(
ÆÆ% &
ex
ÆÆ& (
)
ÆÆ( )
;
ÆÆ) *
}
ÇÇ 
finally
ÈÈ 
{
ÉÉ 
}
ËË 
}
ÌÌ 	
private
ÔÔ 
void
ÔÔ ,
m_fEventPusher_ThreadJobCalled
ÔÔ 3
(
ÔÔ3 4
object
ÕÕ 
sender
ÕÕ 
,
ÕÕ 
FThreadEventArgs
ÖÖ 
e
ÖÖ 
)
×× 
{
ØØ 	"
FTelnetEventArgsBase
ÙÙ  
args
ÙÙ! %
=
ÙÙ& '
null
ÙÙ( ,
;
ÙÙ, -
try
ÛÛ 
{
ÜÜ 
if
İİ 
(
İİ 
	m_fEvents
İİ 
.
İİ 
count
İİ #
==
İİ$ &
$num
İİ' (
)
İİ( )
{
ŞŞ (
m_isCompletedEventHandling
ßß .
=
ßß/ 0
true
ßß1 5
;
ßß5 6
e
àà 
.
àà 
sleepThread
àà !
(
àà! "
$num
àà" #
)
àà# $
;
àà$ %
return
áá 
;
áá 
}
ââ (
m_isCompletedEventHandling
ãã *
=
ãã+ ,
false
ãã- 2
;
ãã2 3
if
çç 
(
çç 
m_suspended
çç 
)
çç  
{
èè 
e
éé 
.
éé 
sleepThread
éé !
(
éé! "
$num
éé" #
)
éé# $
;
éé$ %
return
êê 
;
êê 
}
ëë 
while
ïï 
(
ïï 
!
ïï 
m_suspended
ïï #
&&
ïï$ &
(
ïï' (
args
ïï( ,
=
ïï- .
	m_fEvents
ïï/ 8
.
ïï8 9
dequeue
ïï9 @
(
ïï@ A
)
ïïA B
)
ïïB C
!=
ïïD F
null
ïïG K
)
ïïK L
{
ğğ 
if
ññ 
(
ññ 
args
ññ 
.
ññ 
fTelnetEventId
ññ +
==
ññ, .
FTelnetEventId
ññ/ =
.
ññ= > 
TelnetStateChanged
ññ> P
)
ññP Q
{
òò 
m_fTelnetClient
óó '
.
óó' ("
onTelnetStateChanged
óó( <
(
óó< =
args
óó= A
)
óóA B
;
óóB C
}
ôô 
else
õõ 
if
õõ 
(
õõ 
args
õõ !
.
õõ! "
fTelnetEventId
õõ" 0
==
õõ1 3
FTelnetEventId
õõ4 B
.
õõB C"
TelnetPacketReceived
õõC W
)
õõW X
{
öö 
m_fTelnetClient
÷÷ '
.
÷÷' ($
onTelnetPacketReceived
÷÷( >
(
÷÷> ?
args
÷÷? C
)
÷÷C D
;
÷÷D E
}
øø 
else
ùù 
if
ùù 
(
ùù 
args
ùù !
.
ùù! "
fTelnetEventId
ùù" 0
==
ùù1 3
FTelnetEventId
ùù4 B
.
ùùB C
TelnetPacketSent
ùùC S
)
ùùS T
{
úú 
m_fTelnetClient
ûû '
.
ûû' ( 
onTelnetPacketSent
ûû( :
(
ûû: ;
args
ûû; ?
)
ûû? @
;
ûû@ A
}
üü 
}
ıı 
}
şş 
catch
ÿÿ 
(
ÿÿ 
	Exception
ÿÿ 
ex
ÿÿ 
)
ÿÿ  
{
€€ 
FDebug
 
.
 
writeLog
 
(
  
ex
  "
)
" #
;
# $
}
‚‚ 
finally
ƒƒ 
{
„„ 
args
…… 
=
…… 
null
…… 
;
…… 
}
†† 
}
‡‡ 	
}
 
} ˆ¬
^D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Telnet\c_FTelnetParser.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FTelnetParser 
:  
IDisposable! ,
{ 
public 
const 
byte 
IAC 
= 
$num  #
;# $
private 
bool 

m_disposed 
=  !
false" '
;' (
private 

FTcpClient 
m_fTcpClient '
=( )
null* .
;. /
private 
FTelnetParserState "
m_fState# +
;+ ,
private 
FTelnetRecvBuffer !
m_fRecvBuffer" /
=0 1
null2 6
;6 7
public## 
FTelnetParser## 
(## 

FTcpClient$$ 

fTcpClient$$ !
)%% 
{&& 	
if'' 
('' 

fTcpClient'' 
=='' 
null'' "
)''" #
{(( 
FDebug)) 
.)) 
throwFException)) &
())& '
string))' -
.))- .
Format)). 4
())4 5

FConstants))5 ?
.))? @

err_m_0016))@ J
,))J K
$str))L X
)))X Y
)))Y Z
;))Z [
}** 
if,, 
(,, 

fTcpClient,, 
.,, 
fState,, !
==,," $
FTcpClientState,,% 4
.,,4 5
Closed,,5 ;
),,; <
{-- 
FDebug.. 
... 
throwFException.. &
(..& '
string..' -
...- .
Format... 4
(..4 5

FConstants..5 ?
...? @

err_m_0013..@ J
,..J K
$str..L X
)..X Y
)..Y Z
;..Z [
}// 
this11 
.11 
m_fTcpClient11 
=11 

fTcpClient11  *
;11* +
init55 
(55 
)55 
;55 
}66 	
~:: 	
FTelnetParser::	 
(:: 
);; 
{<< 	
	myDispose== 
(== 
false== 
)== 
;== 
}>> 	
	protectedBB 
voidBB 
	myDisposeBB  
(BB  !
boolCC 
	disposingCC 
)DD 
{EE 	
ifFF 
(FF 
!FF 

m_disposedFF 
)FF 
{GG 
ifHH 
(HH 
	disposingHH 
)HH 
{II 
termJJ 
(JJ 
)JJ 
;JJ 
}KK 

m_disposedLL 
=LL 
trueLL !
;LL! "
}MM 
}NN 	
publicVV 
voidVV 
DisposeVV 
(VV 
)WW 
{XX 	
	myDisposeYY 
(YY 
trueYY 
)YY 
;YY 
GCZZ 
.ZZ 
SuppressFinalizeZZ 
(ZZ  
thisZZ  $
)ZZ$ %
;ZZ% &
}[[ 	
publiccc 

FTcpClientcc 

fTcpClientcc $
{dd 	
getee 
{ff 
trygg 
{hh 
returnii 
thisii 
.ii  
m_fTcpClientii  ,
;ii, -
}jj 
catchkk 
(kk 
	Exceptionkk  
exkk! #
)kk# $
{ll 
FDebugmm 
.mm 
throwExceptionmm )
(mm) *
exmm* ,
)mm, -
;mm- .
}nn 
finallyoo 
{pp 
}rr 
returnss 
nullss 
;ss 
}tt 
}uu 	
publicyy 
FTelnetParserStateyy !
fStateyy" (
{zz 	
get{{ 
{|| 
try}} 
{~~ 
return 
this 
.  
m_fState  (
;( )
}
€€ 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
‚‚ 
FDebug
ƒƒ 
.
ƒƒ 
throwException
ƒƒ )
(
ƒƒ) *
ex
ƒƒ* ,
)
ƒƒ, -
;
ƒƒ- .
}
„„ 
finally
…… 
{
†† 
}
ˆˆ 
return
‰‰  
FTelnetParserState
‰‰ )
.
‰‰) *
Data
‰‰* .
;
‰‰. /
}
ŠŠ 
}
‹‹ 	
private
““ 
void
““ 
init
““ 
(
““ 
)
”” 
{
•• 	
m_fRecvBuffer
–– 
=
–– 
new
–– 
FTelnetRecvBuffer
––  1
(
––1 2
)
––2 3
;
––3 4
}
—— 	
private
›› 
void
›› 
term
›› 
(
›› 
)
œœ 
{
 	
try
 
{
ŸŸ 
if
   
(
   
m_fRecvBuffer
   !
!=
  " $
null
  % )
)
  ) *
{
¡¡ 
m_fRecvBuffer
¢¢ !
.
¢¢! "
Dispose
¢¢" )
(
¢¢) *
)
¢¢* +
;
¢¢+ ,
m_fRecvBuffer
££ !
=
££" #
null
££$ (
;
££( )
}
¤¤ 
}
¥¥ 
catch
¦¦ 
(
¦¦ 
	Exception
¦¦ 
ex
¦¦ 
)
¦¦  
{
§§ 
FDebug
¨¨ 
.
¨¨ 
throwException
¨¨ %
(
¨¨% &
ex
¨¨& (
)
¨¨( )
;
¨¨) *
}
©© 
finally
ªª 
{
«« 
}
­­ 
}
®® 	
public
²² 
void
²² 
close
²² 
(
²² 
)
³³ 
{
´´ 	
try
µµ 
{
¶¶ 
this
·· 
.
·· 
m_fTcpClient
·· !
.
··! "
close
··" '
(
··' (
)
··( )
;
··) *
}
¸¸ 
catch
¹¹ 
(
¹¹ 
	Exception
¹¹ 
ex
¹¹ 
)
¹¹  
{
ºº 
FDebug
»» 
.
»» 
throwException
»» %
(
»»% &
ex
»»& (
)
»»( )
;
»») *
}
¼¼ 
finally
½½ 
{
¾¾ 
}
ÀÀ 
}
ÁÁ 	
public
ÅÅ 
void
ÅÅ 

appendData
ÅÅ 
(
ÅÅ 
byte
ÆÆ 
[
ÆÆ 
]
ÆÆ 
data
ÆÆ 
)
ÇÇ 
{
ÈÈ 	
try
ÉÉ 
{
ÊÊ 
m_fRecvBuffer
ËË 
.
ËË 
input
ËË #
(
ËË# $
data
ËË$ (
)
ËË( )
;
ËË) *
}
ÌÌ 
catch
ÍÍ 
(
ÍÍ 
	Exception
ÍÍ 
ex
ÍÍ 
)
ÍÍ  
{
ÎÎ 
FDebug
ÏÏ 
.
ÏÏ 
throwException
ÏÏ %
(
ÏÏ% &
ex
ÏÏ& (
)
ÏÏ( )
;
ÏÏ) *
}
ĞĞ 
finally
ÑÑ 
{
ÒÒ 
}
ÔÔ 
}
ÕÕ 	
public
ÙÙ 
FITelnetPacket
ÙÙ 
readNext
ÙÙ &
(
ÙÙ& '
)
ÚÚ 
{
ÛÛ 	
int
ÜÜ 
index
ÜÜ 
=
ÜÜ 
$num
ÜÜ 
;
ÜÜ 
bool
İİ 
isReturn
İİ 
=
İİ 
false
İİ !
;
İİ! "
byte
ßß 
	byteValue
ßß 
;
ßß 
byte
àà 
[
àà 
]
àà 
buffer
àà 
=
àà 
null
àà  
;
àà  !
FITelnetPacket
áá 
fPacket
áá "
=
áá# $
null
áá% )
;
áá) *
FTelnetByteBuffer
ââ 
fDataPacket
ââ )
=
ââ* +
null
ââ, 0
;
ââ0 1
try
ää 
{
åå 
fDataPacket
ææ 
=
ææ 
new
ææ !
FTelnetByteBuffer
ææ" 3
(
ææ3 4
)
ææ4 5
;
ææ5 6
index
èè 
=
èè 
$num
èè 
;
èè 
buffer
éé 
=
éé 
m_fRecvBuffer
éé &
.
éé& '
watch
éé' ,
(
éé, -
m_fRecvBuffer
éé- :
.
éé: ;
length
éé; A
)
ééA B
;
ééB C
do
ëë 
{
ìì 
if
íí 
(
íí 
buffer
íí 
.
íí 
Length
íí %
==
íí& (
index
íí) .
)
íí. /
{
îî 
if
ïï 
(
ïï 
index
ïï !
!=
ïï" $
$num
ïï% &
)
ïï& '
{
ğğ 
m_fRecvBuffer
ññ )
.
ññ) *
output
ññ* 0
(
ññ0 1
index
ññ1 6
)
ññ6 7
;
ññ7 8
}
òò 
return
óó 
fPacket
óó &
;
óó& '
}
ôô 
	byteValue
öö 
=
öö 
buffer
öö  &
[
öö& '
index
öö' ,
++
öö, .
]
öö. /
;
öö/ 0
if
øø 
(
øø 
this
øø 
.
øø 
fState
øø #
==
øø$ & 
FTelnetParserState
øø' 9
.
øø9 :
Data
øø: >
)
øø> ?
{
ùù 
if
üü 
(
üü 
	byteValue
üü %
==
üü& (

FAsciiByte
üü) 3
.
üü3 4
CR
üü4 6
)
üü6 7
{
ıı 
fDataPacket
şş '
.
şş' (
append
şş( .
(
şş. /

FAsciiByte
şş/ 9
.
şş9 :
CR
şş: <
)
şş< =
;
şş= >
this
ÿÿ  
.
ÿÿ  !
m_fState
ÿÿ! )
=
ÿÿ* + 
FTelnetParserState
ÿÿ, >
.
ÿÿ> ?$
ReceivedCarriageReturn
ÿÿ? U
;
ÿÿU V
}
€€ 
else
 
if
 
(
  !
	byteValue
! *
==
+ -
(
. /
byte
/ 3
)
3 4
FTelnetCommand
4 B
.
B C
Iac
C F
)
F G
{
‚‚ 
if
ƒƒ 
(
ƒƒ  
fDataPacket
ƒƒ  +
.
ƒƒ+ ,
count
ƒƒ, 1
>
ƒƒ2 3
$num
ƒƒ4 5
)
ƒƒ5 6
{
„„ 
m_fRecvBuffer
……  -
.
……- .
output
……. 4
(
……4 5
fDataPacket
……5 @
.
……@ A
count
……A F
)
……F G
;
……G H
return
††  &
new
††' *
FTelnetDataPacket
††+ <
(
††< =
fDataPacket
††= H
.
††H I
toArrary
††I Q
(
††Q R
)
††R S
)
††S T
;
††T U
}
‡‡ 
this
ˆˆ  
.
ˆˆ  !
m_fState
ˆˆ! )
=
ˆˆ* + 
FTelnetParserState
ˆˆ, >
.
ˆˆ> ?
ReceivedIAC
ˆˆ? J
;
ˆˆJ K
}
‰‰ 
else
ŠŠ 
{
‹‹ 
fDataPacket
ŒŒ '
.
ŒŒ' (
append
ŒŒ( .
(
ŒŒ. /
	byteValue
ŒŒ/ 8
)
ŒŒ8 9
;
ŒŒ9 :
}
 
}
 
else
‘‘ 
if
‘‘ 
(
‘‘ 
this
‘‘  
.
‘‘  !
fState
‘‘! '
==
‘‘( * 
FTelnetParserState
‘‘+ =
.
‘‘= >$
ReceivedCarriageReturn
‘‘> T
)
‘‘T U
{
’’ 
if
•• 
(
•• 
	byteValue
•• %
!=
••& (

FAsciiByte
••) 3
.
••3 4
NUL
••4 7
)
••7 8
{
–– 
fDataPacket
—— '
.
——' (
append
——( .
(
——. /
	byteValue
——/ 8
)
——8 9
;
——9 :
}
˜˜ 
this
™™ 
.
™™ 
m_fState
™™ %
=
™™& ' 
FTelnetParserState
™™( :
.
™™: ;
Data
™™; ?
;
™™? @
}
œœ 
else
 
if
 
(
 
this
 !
.
! "
fState
" (
==
) + 
FTelnetParserState
, >
.
> ?
ReceivedIAC
? J
)
J K
{
 
if
¡¡ 
(
¡¡ 
	byteValue
¡¡ %
==
¡¡& (
(
¡¡) *
byte
¡¡* .
)
¡¡. /
FTelnetCommand
¡¡/ =
.
¡¡= >
Iac
¡¡> A
)
¡¡A B
{
¢¢ 
fDataPacket
££ '
.
££' (
append
££( .
(
££. /
	byteValue
££/ 8
)
££8 9
;
££9 :
this
¤¤  
.
¤¤  !
m_fState
¤¤! )
=
¤¤* + 
FTelnetParserState
¤¤, >
.
¤¤> ?
Data
¤¤? C
;
¤¤C D
}
¥¥ 
else
¦¦ 
{
§§ 
if
¨¨ 
(
¨¨  
	byteValue
©©  )
==
©©* ,
(
©©- .
byte
©©. 2
)
©©2 3
FTelnetCommand
©©3 A
.
©©A B
AbortOutput
©©B M
||
©©N P
	byteValue
ªª  )
==
ªª* ,
(
ªª- .
byte
ªª. 2
)
ªª2 3
FTelnetCommand
ªª3 A
.
ªªA B
AreYouThere
ªªB M
||
ªªN P
	byteValue
««  )
==
««* ,
(
««- .
byte
««. 2
)
««2 3
FTelnetCommand
««3 A
.
««A B
Break
««B G
||
««H J
	byteValue
¬¬  )
==
¬¬* ,
(
¬¬- .
byte
¬¬. 2
)
¬¬2 3
FTelnetCommand
¬¬3 A
.
¬¬A B
DataMark
¬¬B J
||
¬¬K M
	byteValue
­­  )
==
­­* ,
(
­­- .
byte
­­. 2
)
­­2 3
FTelnetCommand
­­3 A
.
­­A B
EraseCharacter
­­B P
||
­­Q S
	byteValue
®®  )
==
®®* ,
(
®®- .
byte
®®. 2
)
®®2 3
FTelnetCommand
®®3 A
.
®®A B
	EraseLine
®®B K
||
®®L N
	byteValue
¯¯  )
==
¯¯* ,
(
¯¯- .
byte
¯¯. 2
)
¯¯2 3
FTelnetCommand
¯¯3 A
.
¯¯A B
GoAhead
¯¯B I
||
¯¯J L
	byteValue
°°  )
==
°°* ,
(
°°- .
byte
°°. 2
)
°°2 3
FTelnetCommand
°°3 A
.
°°A B
InterruptProcess
°°B R
||
°°S U
	byteValue
±±  )
==
±±* ,
(
±±- .
byte
±±. 2
)
±±2 3
FTelnetCommand
±±3 A
.
±±A B
NoOperation
±±B M
)
²²  !
{
³³ 
m_fRecvBuffer
´´  -
.
´´- .
output
´´. 4
(
´´4 5
index
´´5 :
)
´´: ;
;
´´; <
fPacket
µµ  '
=
µµ( )
new
µµ* -"
FTelnetCommandPacket
µµ. B
(
µµB C
(
µµC D
FTelnetCommand
µµD R
)
µµR S
	byteValue
µµS \
)
µµ\ ]
;
µµ] ^
this
¶¶  $
.
¶¶$ %
m_fState
¶¶% -
=
¶¶. / 
FTelnetParserState
¶¶0 B
.
¶¶B C
Data
¶¶C G
;
¶¶G H
}
·· 
else
¸¸  
if
¸¸! #
(
¸¸$ %
	byteValue
¸¸% .
==
¸¸/ 1
(
¸¸2 3
byte
¸¸3 7
)
¸¸7 8
FTelnetCommand
¸¸8 F
.
¸¸F G
Do
¸¸G I
)
¸¸I J
{
¹¹ 
this
ºº  $
.
ºº$ %
m_fState
ºº% -
=
ºº. / 
FTelnetParserState
ºº0 B
.
ººB C

ReceivedDo
ººC M
;
ººM N
}
»» 
else
¼¼  
if
¼¼! #
(
¼¼$ %
	byteValue
¼¼% .
==
¼¼/ 1
(
¼¼2 3
byte
¼¼3 7
)
¼¼7 8
FTelnetCommand
¼¼8 F
.
¼¼F G
Dont
¼¼G K
)
¼¼K L
{
½½ 
this
¾¾  $
.
¾¾$ %
m_fState
¾¾% -
=
¾¾. / 
FTelnetParserState
¾¾0 B
.
¾¾B C
ReceivedDont
¾¾C O
;
¾¾O P
}
¿¿ 
else
ÀÀ  
if
ÀÀ! #
(
ÀÀ$ %
	byteValue
ÀÀ% .
==
ÀÀ/ 1
(
ÀÀ2 3
byte
ÀÀ3 7
)
ÀÀ7 8
FTelnetCommand
ÀÀ8 F
.
ÀÀF G
Will
ÀÀG K
)
ÀÀK L
{
ÁÁ 
this
ÂÂ  $
.
ÂÂ$ %
m_fState
ÂÂ% -
=
ÂÂ. / 
FTelnetParserState
ÂÂ0 B
.
ÂÂB C
ReceivedWill
ÂÂC O
;
ÂÂO P
}
ÃÃ 
else
ÄÄ  
if
ÄÄ! #
(
ÄÄ$ %
	byteValue
ÄÄ% .
==
ÄÄ/ 1
(
ÄÄ2 3
byte
ÄÄ3 7
)
ÄÄ7 8
FTelnetCommand
ÄÄ8 F
.
ÄÄF G
Wont
ÄÄG K
)
ÄÄK L
{
ÅÅ 
this
ÆÆ  $
.
ÆÆ$ %
m_fState
ÆÆ% -
=
ÆÆ. / 
FTelnetParserState
ÆÆ0 B
.
ÆÆB C
ReceivedWont
ÆÆC O
;
ÆÆO P
}
ÇÇ 
else
ÈÈ  
{
ÉÉ 
FDebug
ÊÊ  &
.
ÊÊ& '
throwFException
ÊÊ' 6
(
ÊÊ6 7
string
ÊÊ7 =
.
ÊÊ= >
Format
ÊÊ> D
(
ÊÊD E

FConstants
ÊÊE O
.
ÊÊO P

err_m_0015
ÊÊP Z
,
ÊÊZ [
$str
ÊÊ\ e
)
ÊÊe f
)
ÊÊf g
;
ÊÊg h
}
ËË 
}
ÌÌ 
}
ĞĞ 
else
ÑÑ 
if
ÑÑ 
(
ÑÑ 
this
ÑÑ !
.
ÑÑ! "
fState
ÑÑ" (
==
ÑÑ) + 
FTelnetParserState
ÑÑ, >
.
ÑÑ> ?

ReceivedDo
ÑÑ? I
)
ÑÑI J
{
ÒÒ 
m_fRecvBuffer
ÓÓ %
.
ÓÓ% &
output
ÓÓ& ,
(
ÓÓ, -
index
ÓÓ- 2
)
ÓÓ2 3
;
ÓÓ3 4
fPacket
ÔÔ 
=
ÔÔ  !
new
ÔÔ" %!
FTelnetOptionPacket
ÔÔ& 9
(
ÔÔ9 :
FTelnetCommand
ÔÔ: H
.
ÔÔH I
Do
ÔÔI K
,
ÔÔK L
	byteValue
ÔÔM V
)
ÔÔV W
;
ÔÔW X
this
ÕÕ 
.
ÕÕ 
m_fState
ÕÕ %
=
ÕÕ& ' 
FTelnetParserState
ÕÕ( :
.
ÕÕ: ;
Data
ÕÕ; ?
;
ÕÕ? @
}
ÖÖ 
else
×× 
if
×× 
(
×× 
this
×× !
.
××! "
fState
××" (
==
××) + 
FTelnetParserState
××, >
.
××> ?
ReceivedDont
××? K
)
××K L
{
ØØ 
m_fRecvBuffer
ÙÙ %
.
ÙÙ% &
output
ÙÙ& ,
(
ÙÙ, -
index
ÙÙ- 2
)
ÙÙ2 3
;
ÙÙ3 4
fPacket
ÚÚ 
=
ÚÚ  !
new
ÚÚ" %!
FTelnetOptionPacket
ÚÚ& 9
(
ÚÚ9 :
FTelnetCommand
ÚÚ: H
.
ÚÚH I
Dont
ÚÚI M
,
ÚÚM N
	byteValue
ÚÚO X
)
ÚÚX Y
;
ÚÚY Z
this
ÛÛ 
.
ÛÛ 
m_fState
ÛÛ %
=
ÛÛ& ' 
FTelnetParserState
ÛÛ( :
.
ÛÛ: ;
Data
ÛÛ; ?
;
ÛÛ? @
}
ÜÜ 
else
İİ 
if
İİ 
(
İİ 
this
İİ !
.
İİ! "
fState
İİ" (
==
İİ) + 
FTelnetParserState
İİ, >
.
İİ> ?
ReceivedWill
İİ? K
)
İİK L
{
ŞŞ 
m_fRecvBuffer
ßß %
.
ßß% &
output
ßß& ,
(
ßß, -
index
ßß- 2
)
ßß2 3
;
ßß3 4
fPacket
àà 
=
àà  !
new
àà" %!
FTelnetOptionPacket
àà& 9
(
àà9 :
FTelnetCommand
àà: H
.
ààH I
Will
ààI M
,
ààM N
	byteValue
ààO X
)
ààX Y
;
ààY Z
this
áá 
.
áá 
m_fState
áá %
=
áá& ' 
FTelnetParserState
áá( :
.
áá: ;
Data
áá; ?
;
áá? @
}
ââ 
else
ãã 
if
ãã 
(
ãã 
this
ãã !
.
ãã! "
fState
ãã" (
==
ãã) + 
FTelnetParserState
ãã, >
.
ãã> ?
ReceivedWont
ãã? K
)
ããK L
{
ää 
m_fRecvBuffer
åå %
.
åå% &
output
åå& ,
(
åå, -
index
åå- 2
)
åå2 3
;
åå3 4
fPacket
ææ 
=
ææ  !
new
ææ" %!
FTelnetOptionPacket
ææ& 9
(
ææ9 :
FTelnetCommand
ææ: H
.
ææH I
Wont
ææI M
,
ææM N
	byteValue
ææO X
)
ææX Y
;
ææY Z
this
çç 
.
çç 
m_fState
çç %
=
çç& ' 
FTelnetParserState
çç( :
.
çç: ;
Data
çç; ?
;
çç? @
}
èè 
if
ìì 
(
ìì 
fPacket
ìì 
==
ìì  "
null
ìì# '
&&
ìì( *
fDataPacket
ìì+ 6
.
ìì6 7
count
ìì7 <
>
ìì= >
$num
ìì? @
)
ìì@ A
{
íí 
isReturn
îî  
=
îî! "
(
îî# $
fDataPacket
îî$ /
.
îî/ 0
count
îî0 5
==
îî6 8
m_fRecvBuffer
îî9 F
.
îîF G
length
îîG M
)
îîM N
;
îîN O
if
ğğ 
(
ğğ 
!
ğğ 
isReturn
ğğ %
)
ğğ% &
{
ññ 
isReturn
òò $
=
òò% &
(
òò' (
index
òò( -
==
òò. 0
m_fRecvBuffer
òò1 >
.
òò> ?
length
òò? E
)
òòE F
;
òòF G
}
óó 
if
õõ 
(
õõ 
isReturn
õõ $
)
õõ$ %
{
öö 
m_fRecvBuffer
÷÷ )
.
÷÷) *
clear
÷÷* /
(
÷÷/ 0
)
÷÷0 1
;
÷÷1 2
return
øø "
new
øø# &
FTelnetDataPacket
øø' 8
(
øø8 9
fDataPacket
øø9 D
.
øøD E
toArrary
øøE M
(
øøM N
)
øøN O
)
øøO P
;
øøP Q
}
ùù 
}
úú 
}
üü 
while
üü 
(
üü 
fPacket
üü  
==
üü! #
null
üü$ (
)
üü( )
;
üü) *
return
şş 
fPacket
şş 
;
şş 
}
ÿÿ 
catch
€€ 
(
€€ 
	Exception
€€ 
ex
€€ 
)
€€  
{
 
FDebug
‚‚ 
.
‚‚ 
throwException
‚‚ %
(
‚‚% &
ex
‚‚& (
)
‚‚( )
;
‚‚) *
}
ƒƒ 
finally
„„ 
{
…… 
}
‡‡ 
return
ˆˆ 
null
ˆˆ 
;
ˆˆ 
}
‰‰ 	
public
 
void
 
sendCommand
 
(
  
FTelnetCommand
 
fCommand
 #
)
 
{
 	
try
‘‘ 
{
’’ 
if
““ 
(
““ 
fCommand
”” 
==
”” 
FTelnetCommand
””  .
.
””. /
AbortOutput
””/ :
||
””; =
fCommand
•• 
==
•• 
FTelnetCommand
••  .
.
••. /
AreYouThere
••/ :
||
••; =
fCommand
–– 
==
–– 
FTelnetCommand
––  .
.
––. /
Break
––/ 4
||
––5 7
fCommand
—— 
==
—— 
FTelnetCommand
——  .
.
——. /
DataMark
——/ 7
||
——8 :
fCommand
˜˜ 
==
˜˜ 
FTelnetCommand
˜˜  .
.
˜˜. /
EraseCharacter
˜˜/ =
||
˜˜> @
fCommand
™™ 
==
™™ 
FTelnetCommand
™™  .
.
™™. /
	EraseLine
™™/ 8
||
™™9 ;
fCommand
šš 
==
šš 
FTelnetCommand
šš  .
.
šš. /
GoAhead
šš/ 6
||
šš7 9
fCommand
›› 
==
›› 
FTelnetCommand
››  .
.
››. /
Iac
››/ 2
||
››3 5
fCommand
œœ 
==
œœ 
FTelnetCommand
œœ  .
.
œœ. /
InterruptProcess
œœ/ ?
||
œœ@ B
fCommand
 
==
 
FTelnetCommand
  .
.
. /
NoOperation
/ :
)
 
{
ŸŸ 
sendRaw
   
(
   
new
   
byte
    $
[
  $ %
]
  % &
{
  ' (
IAC
  ) ,
,
  , -
(
  . /
byte
  / 3
)
  3 4
fCommand
  4 <
}
  = >
)
  > ?
;
  ? @
}
¡¡ 
else
¢¢ 
{
££ 
FDebug
¤¤ 
.
¤¤ 
throwFException
¤¤ *
(
¤¤* +
string
¤¤+ 1
.
¤¤1 2
Format
¤¤2 8
(
¤¤8 9

FConstants
¤¤9 C
.
¤¤C D

err_m_0015
¤¤D N
,
¤¤N O
$str
¤¤P Y
)
¤¤Y Z
)
¤¤Z [
;
¤¤[ \
}
¥¥ 
}
¦¦ 
catch
§§ 
(
§§ 
	Exception
§§ 
ex
§§ 
)
§§  
{
¨¨ 
FDebug
©© 
.
©© 
throwException
©© %
(
©©% &
ex
©©& (
)
©©( )
;
©©) *
}
ªª 
finally
«« 
{
¬¬ 
}
®® 
}
¯¯ 	
public
³³ 
void
³³ 
sendCommand
³³ 
(
³³  
FTelnetCommand
´´ 
fCommand
´´ #
,
´´# $
FTelnetOption
µµ 
fOption
µµ !
)
¶¶ 
{
·· 	
try
¸¸ 
{
¹¹ 
if
ºº 
(
ºº 
fCommand
»» 
==
»» 
FTelnetCommand
»»  .
.
»». /
Do
»»/ 1
||
»»2 4
fCommand
¼¼ 
==
¼¼ 
FTelnetCommand
¼¼  .
.
¼¼. /
Dont
¼¼/ 3
||
¼¼4 6
fCommand
½½ 
==
½½ 
FTelnetCommand
½½  .
.
½½. /
Will
½½/ 3
||
½½4 6
fCommand
¾¾ 
==
¾¾ 
FTelnetCommand
¾¾  .
.
¾¾. /
Wont
¾¾/ 3
)
¿¿ 
{
ÀÀ 
sendRaw
ÁÁ 
(
ÁÁ 
new
ÁÁ 
byte
ÁÁ  $
[
ÁÁ$ %
]
ÁÁ% &
{
ÁÁ' (
IAC
ÁÁ) ,
,
ÁÁ, -
(
ÁÁ. /
byte
ÁÁ/ 3
)
ÁÁ3 4
fCommand
ÁÁ4 <
,
ÁÁ< =
(
ÁÁ> ?
byte
ÁÁ? C
)
ÁÁC D
fOption
ÁÁD K
}
ÁÁL M
)
ÁÁM N
;
ÁÁN O
}
ÂÂ 
else
ÃÃ 
{
ÄÄ 
FDebug
ÅÅ 
.
ÅÅ 
throwFException
ÅÅ *
(
ÅÅ* +
string
ÅÅ+ 1
.
ÅÅ1 2
Format
ÅÅ2 8
(
ÅÅ8 9

FConstants
ÅÅ9 C
.
ÅÅC D

err_m_0015
ÅÅD N
,
ÅÅN O
$str
ÅÅP Y
)
ÅÅY Z
)
ÅÅZ [
;
ÅÅ[ \
}
ÆÆ 
}
ÇÇ 
catch
ÈÈ 
(
ÈÈ 
	Exception
ÈÈ 
ex
ÈÈ 
)
ÈÈ  
{
ÉÉ 
FDebug
ÊÊ 
.
ÊÊ 
throwException
ÊÊ %
(
ÊÊ% &
ex
ÊÊ& (
)
ÊÊ( )
;
ÊÊ) *
}
ËË 
finally
ÌÌ 
{
ÍÍ 
}
ÏÏ 
}
ĞĞ 	
public
ÔÔ 
void
ÔÔ 
sendDo
ÔÔ 
(
ÔÔ 
byte
ÕÕ 
option
ÕÕ 
)
ÖÖ 
{
×× 	
try
ØØ 
{
ÙÙ 
sendRaw
ÚÚ 
(
ÚÚ 
new
ÚÚ 
byte
ÚÚ  
[
ÚÚ  !
]
ÚÚ! "
{
ÚÚ# $
IAC
ÚÚ% (
,
ÚÚ( )
(
ÚÚ* +
byte
ÚÚ+ /
)
ÚÚ/ 0
FTelnetCommand
ÚÚ0 >
.
ÚÚ> ?
Do
ÚÚ? A
,
ÚÚA B
option
ÚÚC I
}
ÚÚJ K
)
ÚÚK L
;
ÚÚL M
}
ÛÛ 
catch
ÜÜ 
(
ÜÜ 
	Exception
ÜÜ 
ex
ÜÜ 
)
ÜÜ  
{
İİ 
FDebug
ŞŞ 
.
ŞŞ 
throwException
ŞŞ %
(
ŞŞ% &
ex
ŞŞ& (
)
ŞŞ( )
;
ŞŞ) *
}
ßß 
finally
àà 
{
áá 
}
ãã 
}
ää 	
public
èè 
void
èè 
sendDo
èè 
(
èè 
FTelnetOption
éé 
fOption
éé !
)
êê 
{
ëë 	
try
ìì 
{
íí 
sendRaw
îî 
(
îî 
new
îî 
byte
îî  
[
îî  !
]
îî! "
{
îî# $
IAC
îî% (
,
îî( )
(
îî* +
byte
îî+ /
)
îî/ 0
FTelnetCommand
îî0 >
.
îî> ?
Do
îî? A
,
îîA B
(
îîC D
byte
îîD H
)
îîH I
fOption
îîI P
}
îîQ R
)
îîR S
;
îîS T
}
ïï 
catch
ğğ 
(
ğğ 
	Exception
ğğ 
ex
ğğ 
)
ğğ  
{
ññ 
FDebug
òò 
.
òò 
throwException
òò %
(
òò% &
ex
òò& (
)
òò( )
;
òò) *
}
óó 
finally
ôô 
{
õõ 
}
÷÷ 
}
øø 	
public
üü 
void
üü 
sendDont
üü 
(
üü 
byte
ıı 
option
ıı 
)
şş 
{
ÿÿ 	
try
€€ 
{
 
sendRaw
‚‚ 
(
‚‚ 
new
‚‚ 
byte
‚‚  
[
‚‚  !
]
‚‚! "
{
‚‚# $
IAC
‚‚% (
,
‚‚( )
(
‚‚* +
byte
‚‚+ /
)
‚‚/ 0
FTelnetCommand
‚‚0 >
.
‚‚> ?
Dont
‚‚? C
,
‚‚C D
option
‚‚E K
}
‚‚L M
)
‚‚M N
;
‚‚N O
}
ƒƒ 
catch
„„ 
(
„„ 
	Exception
„„ 
ex
„„ 
)
„„  
{
…… 
FDebug
†† 
.
†† 
throwException
†† %
(
††% &
ex
††& (
)
††( )
;
††) *
}
‡‡ 
finally
ˆˆ 
{
‰‰ 
}
‹‹ 
}
ŒŒ 	
public
 
void
 
sendDont
 
(
 
FTelnetOption
‘‘ 
fOption
‘‘ !
)
’’ 
{
““ 	
try
”” 
{
•• 
sendRaw
–– 
(
–– 
new
–– 
byte
––  
[
––  !
]
––! "
{
––# $
IAC
––% (
,
––( )
(
––* +
byte
––+ /
)
––/ 0
FTelnetCommand
––0 >
.
––> ?
Dont
––? C
,
––C D
(
––E F
byte
––F J
)
––J K
fOption
––K R
}
––S T
)
––T U
;
––U V
}
—— 
catch
˜˜ 
(
˜˜ 
	Exception
˜˜ 
ex
˜˜ 
)
˜˜  
{
™™ 
FDebug
šš 
.
šš 
throwException
šš %
(
šš% &
ex
šš& (
)
šš( )
;
šš) *
}
›› 
finally
œœ 
{
 
}
ŸŸ 
}
   	
public
¤¤ 
void
¤¤ 
sendWill
¤¤ 
(
¤¤ 
byte
¥¥ 
option
¥¥ 
)
¦¦ 
{
§§ 	
try
¨¨ 
{
©© 
sendRaw
ªª 
(
ªª 
new
ªª 
byte
ªª  
[
ªª  !
]
ªª! "
{
ªª# $
IAC
ªª% (
,
ªª( )
(
ªª* +
byte
ªª+ /
)
ªª/ 0
FTelnetCommand
ªª0 >
.
ªª> ?
Will
ªª? C
,
ªªC D
option
ªªE K
}
ªªL M
)
ªªM N
;
ªªN O
}
«« 
catch
¬¬ 
(
¬¬ 
	Exception
¬¬ 
ex
¬¬ 
)
¬¬  
{
­­ 
FDebug
®® 
.
®® 
throwException
®® %
(
®®% &
ex
®®& (
)
®®( )
;
®®) *
}
¯¯ 
finally
°° 
{
±± 
}
³³ 
}
´´ 	
public
¸¸ 
void
¸¸ 
sendWill
¸¸ 
(
¸¸ 
FTelnetOption
¹¹ 
fOption
¹¹ !
)
ºº 
{
»» 	
try
¼¼ 
{
½½ 
sendRaw
¾¾ 
(
¾¾ 
new
¾¾ 
byte
¾¾  
[
¾¾  !
]
¾¾! "
{
¾¾# $
IAC
¾¾% (
,
¾¾( )
(
¾¾* +
byte
¾¾+ /
)
¾¾/ 0
FTelnetCommand
¾¾0 >
.
¾¾> ?
Will
¾¾? C
,
¾¾C D
(
¾¾E F
byte
¾¾F J
)
¾¾J K
fOption
¾¾K R
}
¾¾S T
)
¾¾T U
;
¾¾U V
}
¿¿ 
catch
ÀÀ 
(
ÀÀ 
	Exception
ÀÀ 
ex
ÀÀ 
)
ÀÀ  
{
ÁÁ 
FDebug
ÂÂ 
.
ÂÂ 
throwException
ÂÂ %
(
ÂÂ% &
ex
ÂÂ& (
)
ÂÂ( )
;
ÂÂ) *
}
ÃÃ 
finally
ÄÄ 
{
ÅÅ 
}
ÇÇ 
}
ÈÈ 	
public
ÌÌ 
void
ÌÌ 
sendWont
ÌÌ 
(
ÌÌ 
byte
ÍÍ 
option
ÍÍ 
)
ÎÎ 
{
ÏÏ 	
try
ĞĞ 
{
ÑÑ 
sendRaw
ÒÒ 
(
ÒÒ 
new
ÒÒ 
byte
ÒÒ  
[
ÒÒ  !
]
ÒÒ! "
{
ÒÒ# $
IAC
ÒÒ% (
,
ÒÒ( )
(
ÒÒ* +
byte
ÒÒ+ /
)
ÒÒ/ 0
FTelnetCommand
ÒÒ0 >
.
ÒÒ> ?
Wont
ÒÒ? C
,
ÒÒC D
option
ÒÒE K
}
ÒÒL M
)
ÒÒM N
;
ÒÒN O
}
ÓÓ 
catch
ÔÔ 
(
ÔÔ 
	Exception
ÔÔ 
ex
ÔÔ 
)
ÔÔ  
{
ÕÕ 
FDebug
ÖÖ 
.
ÖÖ 
throwException
ÖÖ %
(
ÖÖ% &
ex
ÖÖ& (
)
ÖÖ( )
;
ÖÖ) *
}
×× 
finally
ØØ 
{
ÙÙ 
}
ÛÛ 
}
ÜÜ 	
public
àà 
void
àà 
sendWont
àà 
(
àà 
FTelnetOption
áá 
fOption
áá !
)
ââ 
{
ãã 	
try
ää 
{
åå 
sendRaw
ææ 
(
ææ 
new
ææ 
byte
ææ  
[
ææ  !
]
ææ! "
{
ææ# $
IAC
ææ% (
,
ææ( )
(
ææ* +
byte
ææ+ /
)
ææ/ 0
FTelnetCommand
ææ0 >
.
ææ> ?
Wont
ææ? C
,
ææC D
(
ææE F
byte
ææF J
)
ææJ K
fOption
ææK R
}
ææS T
)
ææT U
;
ææU V
}
çç 
catch
èè 
(
èè 
	Exception
èè 
ex
èè 
)
èè  
{
éé 
FDebug
êê 
.
êê 
throwException
êê %
(
êê% &
ex
êê& (
)
êê( )
;
êê) *
}
ëë 
finally
ìì 
{
íí 
}
ïï 
}
ğğ 	
public
ôô 
void
ôô 
sendEscaped
ôô 
(
ôô  
byte
õõ 
[
õõ 
]
õõ 
buffer
õõ 
)
öö 
{
÷÷ 	
FTelnetByteBuffer
øø 
fEscapeBuffer
øø +
=
øø, -
null
øø. 2
;
øø2 3
try
úú 
{
ûû 
if
üü 
(
üü 
buffer
üü 
==
üü 
null
üü "
)
üü" #
{
ıı 
FDebug
şş 
.
şş 
throwFException
şş *
(
şş* +
string
şş+ 1
.
şş1 2
Format
şş2 8
(
şş8 9

FConstants
şş9 C
.
şşC D

err_m_0016
şşD N
,
şşN O
$str
şşP X
)
şşX Y
)
şşY Z
;
şşZ [
}
ÿÿ 
fEscapeBuffer
ƒƒ 
=
ƒƒ 
new
ƒƒ  #
FTelnetByteBuffer
ƒƒ$ 5
(
ƒƒ5 6
buffer
ƒƒ6 <
)
ƒƒ< =
;
ƒƒ= >
fEscapeBuffer
„„ 
.
„„ 
doDouble
„„ &
(
„„& '
IAC
„„' *
)
„„* +
;
„„+ ,
sendRaw
…… 
(
…… 
fEscapeBuffer
…… %
.
……% &
toArrary
……& .
(
……. /
)
……/ 0
)
……0 1
;
……1 2
}
†† 
catch
‡‡ 
(
‡‡ 
	Exception
‡‡ 
ex
‡‡ 
)
‡‡  
{
ˆˆ 
FDebug
‰‰ 
.
‰‰ 
throwException
‰‰ %
(
‰‰% &
ex
‰‰& (
)
‰‰( )
;
‰‰) *
}
ŠŠ 
finally
‹‹ 
{
ŒŒ 
}
 
}
 	
public
““ 
void
““ 
sendGoAhead
““ 
(
““  
)
““  !
{
”” 	
try
•• 
{
–– 
sendCommand
—— 
(
—— 
FTelnetCommand
—— *
.
——* +
GoAhead
——+ 2
)
——2 3
;
——3 4
}
˜˜ 
catch
™™ 
(
™™ 
	Exception
™™ 
ex
™™ 
)
™™  
{
šš 
FDebug
›› 
.
›› 
throwException
›› %
(
››% &
ex
››& (
)
››( )
;
››) *
}
œœ 
finally
 
{
 
}
   
}
¡¡ 	
public
¥¥ 
void
¥¥ 
sendRaw
¥¥ 
(
¥¥ 
byte
¦¦ 
[
¦¦ 
]
¦¦ 
buffer
¦¦ 
)
§§ 
{
¨¨ 	
try
©© 
{
ªª 
if
«« 
(
«« 
buffer
«« 
==
«« 
null
«« "
)
««" #
{
¬¬ 
FDebug
­­ 
.
­­ 
throwFException
­­ *
(
­­* +
string
­­+ 1
.
­­1 2
Format
­­2 8
(
­­8 9

FConstants
­­9 C
.
­­C D

err_m_0016
­­D N
,
­­N O
$str
­­P X
)
­­X Y
)
­­Y Z
;
­­Z [
}
®® 
this
¯¯ 
.
¯¯ 
m_fTcpClient
¯¯ !
.
¯¯! "
send
¯¯" &
(
¯¯& '
new
¯¯' *
FSocketSendData
¯¯+ :
(
¯¯: ;
buffer
¯¯; A
)
¯¯A B
)
¯¯B C
;
¯¯C D
}
°° 
catch
±± 
(
±± 
	Exception
±± 
ex
±± 
)
±±  
{
²² 
FDebug
³³ 
.
³³ 
throwException
³³ %
(
³³% &
ex
³³& (
)
³³( )
;
³³) *
}
´´ 
finally
µµ 
{
¶¶ 
}
¸¸ 
}
¹¹ 	
}
¿¿ 
}ÀÀ ·?
bD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Telnet\c_FTelnetRecvBuffer.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
internal 
class 
FTelnetRecvBuffer $
:% &
IDisposable' 2
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
	ArrayList 
m_data  
=! "
null# '
;' (
public"" 
FTelnetRecvBuffer""  
(""  !
)## 
{$$ 	
init%% 
(%% 
)%% 
;%% 
}&& 	
~** 	
FTelnetRecvBuffer**	 
(** 
)++ 
{,, 	
	myDispose-- 
(-- 
false-- 
)-- 
;-- 
}.. 	
	protected22 
void22 
	myDispose22  
(22  !
bool33 
	disposing33 
)44 
{55 	
if66 
(66 
!66 

m_disposed66 
)66 
{77 
if88 
(88 
	disposing88 
)88 
{99 
m_data:: 
=:: 
null:: !
;::! "
};; 

m_disposed<< 
=<< 
true<< !
;<<! "
}== 
}>> 	
publicFF 
voidFF 
DisposeFF 
(FF 
)GG 
{HH 	
	myDisposeII 
(II 
trueII 
)II 
;II 
GCJJ 
.JJ 
SuppressFinalizeJJ 
(JJ  
thisJJ  $
)JJ$ %
;JJ% &
}KK 	
publicSS 
intSS 
lengthSS 
{TT 	
getUU 
{VV 
tryWW 
{XX 
returnYY 
m_dataYY !
.YY! "
CountYY" '
;YY' (
}ZZ 
catch[[ 
([[ 
	Exception[[  
ex[[! #
)[[# $
{\\ 
FDebug]] 
.]] 
throwException]] )
(]]) *
ex]]* ,
)]], -
;]]- .
}^^ 
finally__ 
{`` 
}bb 
returncc 
$numcc 
;cc 
}dd 
}ee 	
privatemm 
voidmm 
initmm 
(mm 
)nn 
{oo 	
trypp 
{qq 
m_datarr 
=rr 
newrr 
	ArrayListrr &
(rr& '
)rr' (
;rr( )
}ss 
catchtt 
(tt 
	Exceptiontt 
extt 
)tt  
{uu 
FDebugvv 
.vv 
throwExceptionvv %
(vv% &
exvv& (
)vv( )
;vv) *
}ww 
finallyxx 
{yy 
}{{ 
}|| 	
public
€€ 
void
€€ 
clear
€€ 
(
€€ 
)
 
{
‚‚ 	
try
ƒƒ 
{
„„ 
m_data
…… 
.
…… 
Clear
…… 
(
…… 
)
…… 
;
…… 
}
†† 
catch
‡‡ 
(
‡‡ 
	Exception
‡‡ 
ex
‡‡ 
)
‡‡  
{
ˆˆ 
FDebug
‰‰ 
.
‰‰ 
throwException
‰‰ %
(
‰‰% &
ex
‰‰& (
)
‰‰( )
;
‰‰) *
}
ŠŠ 
finally
‹‹ 
{
ŒŒ 
}
 
}
 	
public
““ 
void
““ 
input
““ 
(
““ 
byte
”” 
[
”” 
]
”” 
data
”” 
)
•• 
{
–– 	
try
—— 
{
˜˜ 
m_data
™™ 
.
™™ 
AddRange
™™ 
(
™™  
data
™™  $
)
™™$ %
;
™™% &
}
šš 
catch
›› 
(
›› 
	Exception
›› 
ex
›› 
)
››  
{
œœ 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
ŸŸ 
{
   
}
¢¢ 
}
££ 	
public
§§ 
byte
§§ 
[
§§ 
]
§§ 
output
§§ 
(
§§ 
int
¨¨ 
count
¨¨ 
)
©© 
{
ªª 	
byte
«« 
[
«« 
]
«« 
bytes
«« 
=
«« 
null
«« 
;
««  
try
­­ 
{
®® 
if
¯¯ 
(
¯¯ 
this
¯¯ 
.
¯¯ 
m_data
¯¯ 
.
¯¯  
Count
¯¯  %
<
¯¯& '
count
¯¯( -
)
¯¯- .
{
°° 
FDebug
±± 
.
±± 
throwFException
±± *
(
±±* +
string
±±+ 1
.
±±1 2
Format
±±2 8
(
±±8 9

FConstants
±±9 C
.
±±C D

err_m_0005
±±D N
,
±±N O
$str
±±P W
)
±±W X
)
±±X Y
;
±±Y Z
}
²² 
bytes
¶¶ 
=
¶¶ 
(
¶¶ 
byte
¶¶ 
[
¶¶ 
]
¶¶ 
)
¶¶  
this
¶¶  $
.
¶¶$ %
m_data
¶¶% +
.
¶¶+ ,
GetRange
¶¶, 4
(
¶¶4 5
$num
¶¶5 6
,
¶¶6 7
count
¶¶8 =
)
¶¶= >
.
¶¶> ?
ToArray
¶¶? F
(
¶¶F G
typeof
¶¶G M
(
¶¶M N
byte
¶¶N R
)
¶¶R S
)
¶¶S T
;
¶¶T U
this
¸¸ 
.
¸¸ 
m_data
¸¸ 
.
¸¸ 
RemoveRange
¸¸ '
(
¸¸' (
$num
¸¸( )
,
¸¸) *
count
¸¸+ 0
)
¸¸0 1
;
¸¸1 2
return
¼¼ 
bytes
¼¼ 
;
¼¼ 
}
½½ 
catch
¾¾ 
(
¾¾ 
	Exception
¾¾ 
ex
¾¾ 
)
¾¾  
{
¿¿ 
FDebug
ÀÀ 
.
ÀÀ 
throwException
ÀÀ %
(
ÀÀ% &
ex
ÀÀ& (
)
ÀÀ( )
;
ÀÀ) *
}
ÁÁ 
finally
ÂÂ 
{
ÃÃ 
}
ÅÅ 
return
ÆÆ 
null
ÆÆ 
;
ÆÆ 
}
ÇÇ 	
public
ËË 
byte
ËË 
[
ËË 
]
ËË 
watch
ËË 
(
ËË 
int
ÌÌ 
count
ÌÌ 
)
ÍÍ 
{
ÎÎ 	
try
ÏÏ 
{
ĞĞ 
if
ÑÑ 
(
ÑÑ 
this
ÑÑ 
.
ÑÑ 
m_data
ÑÑ 
.
ÑÑ  
Count
ÑÑ  %
<
ÑÑ& '
count
ÑÑ( -
)
ÑÑ- .
{
ÒÒ 
FDebug
ÓÓ 
.
ÓÓ 
throwFException
ÓÓ *
(
ÓÓ* +
string
ÓÓ+ 1
.
ÓÓ1 2
Format
ÓÓ2 8
(
ÓÓ8 9

FConstants
ÓÓ9 C
.
ÓÓC D

err_m_0005
ÓÓD N
,
ÓÓN O
$str
ÓÓP W
)
ÓÓW X
)
ÓÓX Y
;
ÓÓY Z
}
ÔÔ 
return
ØØ 
(
ØØ 
byte
ØØ 
[
ØØ 
]
ØØ 
)
ØØ 
this
ØØ #
.
ØØ# $
m_data
ØØ$ *
.
ØØ* +
GetRange
ØØ+ 3
(
ØØ3 4
$num
ØØ4 5
,
ØØ5 6
count
ØØ7 <
)
ØØ< =
.
ØØ= >
ToArray
ØØ> E
(
ØØE F
typeof
ØØF L
(
ØØL M
byte
ØØM Q
)
ØØQ R
)
ØØR S
;
ØØS T
}
ÙÙ 
catch
ÚÚ 
(
ÚÚ 
	Exception
ÚÚ 
ex
ÚÚ 
)
ÚÚ  
{
ÛÛ 
FDebug
ÜÜ 
.
ÜÜ 
throwException
ÜÜ %
(
ÜÜ% &
ex
ÜÜ& (
)
ÜÜ( )
;
ÜÜ) *
}
İİ 
finally
ŞŞ 
{
ßß 
}
áá 
return
ââ 
null
ââ 
;
ââ 
}
ãã 	
}
éé 
}êê ê!
mD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Telnet\c_FTelnetStateChangedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
Serializable 
] 
public 

class (
FTelnetStateChangedEventArgs -
:. / 
FTelnetEventArgsBase0 D
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
FTelnetOption 
	m_fOption 
;  
FTelnetPosition 
m_fPosition #
;# $
FTelnetOptionState 
m_fOptionState )
;) *
internal## (
FTelnetStateChangedEventArgs## -
(##- .
FTelnetOption$$ 
fOption$$ !
,$$! "
FTelnetPosition%% 
	fPosition%% %
,%%% &
FTelnetOptionState&& 
fOptionState&& +
)'' 
:(( 
base(( 
((( 
FTelnetEventId(( "
.((" #
TelnetStateChanged((# 5
)((5 6
{)) 	
	m_fOption** 
=** 
fOption** 
;**  
m_fPosition++ 
=++ 
	fPosition++ #
;++# $
m_fOptionState,, 
=,, 
fOptionState,, )
;,,) *
}-- 	
~11 	(
FTelnetStateChangedEventArgs11	 %
(11% &
)22 
{33 	
	myDispose44 
(44 
false44 
)44 
;44 
}55 	
	protected99 
override99 
void99 
	myDispose99  )
(99) *
bool:: 
	disposing:: 
);; 
{<< 	
if== 
(== 
!== 
this== 
.== 

m_disposed==  
)==  !
{>> 
if?? 
(?? 
	disposing?? 
)?? 
{@@ 
}BB 
thisCC 
.CC 

m_disposedCC 
=CC  !
trueCC" &
;CC& '
baseGG 
.GG 
	myDisposeGG 
(GG 
	disposingGG (
)GG( )
;GG) *
}HH 
}II 	
publicQQ 
FTelnetOptionQQ 
fOptionQQ $
{RR 	
getSS 
{TT 
tryUU 
{VV 
returnWW 
thisWW 
.WW  
	m_fOptionWW  )
;WW) *
}XX 
catchYY 
(YY 
	ExceptionYY  
exYY! #
)YY# $
{ZZ 
FDebug[[ 
.[[ 
throwException[[ )
([[) *
ex[[* ,
)[[, -
;[[- .
}\\ 
finally]] 
{^^ 
}`` 
returnaa 
thisaa 
.aa 
	m_fOptionaa %
;aa% &
}bb 
}cc 	
publicgg 
FTelnetPositiongg 
	fPositiongg (
{hh 	
getii 
{jj 
trykk 
{ll 
returnmm 
m_fPositionmm &
;mm& '
}nn 
catchoo 
(oo 
	Exceptionoo  
exoo! #
)oo# $
{pp 
FDebugqq 
.qq 
throwExceptionqq )
(qq) *
exqq* ,
)qq, -
;qq- .
}rr 
finallyss 
{tt 
}vv 
returnww 
m_fPositionww "
;ww" #
}xx 
}yy 	
public}} 
FTelnetOptionState}} !
fOptionState}}" .
{~~ 	
get 
{
€€ 
try
 
{
‚‚ 
return
ƒƒ 
m_fOptionState
ƒƒ )
;
ƒƒ) *
}
„„ 
catch
…… 
(
…… 
	Exception
……  
ex
……! #
)
……# $
{
†† 
FDebug
‡‡ 
.
‡‡ 
throwException
‡‡ )
(
‡‡) *
ex
‡‡* ,
)
‡‡, -
;
‡‡- .
}
ˆˆ 
finally
‰‰ 
{
ŠŠ 
}
ŒŒ 
return
 
m_fOptionState
 %
;
% &
}
 
}
 	
}
›› 
}œœ æ
_D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Telnet\i_FITelnetPacket.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

	interface 
FITelnetPacket #
{ 
FTelnetPacketType 
fPacketType %
{ 	
get 
; 
} 	
}** 
}++ ¡R
^D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Clipboard\c_FClipboard.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

static 
class 

FClipboard "
{ 
[ 	
System	 
. 
Runtime 
. 
InteropServices '
.' (
	DllImport( 1
(1 2
$str2 >
)> ?
]? @
static 
extern 
IntPtr "
GetOpenClipboardWindow 3
(3 4
)4 5
;5 6
[ 	
System	 
. 
Runtime 
. 
InteropServices '
.' (
	DllImport( 1
(1 2
$str2 >
)> ?
]? @
static 
extern 
int 
GetWindowText '
(' (
int( +
hwnd, 0
,0 1
StringBuilder2 ?
text@ D
,D E
intF I
countJ O
)O P
;P Q
[ 	
System	 
. 
Runtime 
. 
InteropServices '
.' (
	DllImport( 1
(1 2
$str2 >
)> ?
]? @
static   
extern   
IntPtr   
CloseClipboard   +
(  + ,
)  , -
;  - .
public,, 
static,, 
bool,, 
containsData,, '
(,,' (
string-- 
format-- 
).. 
{// 	
try00 
{11 
return22 
	Clipboard22  
.22  !
ContainsData22! -
(22- .
format22. 4
)224 5
;225 6
}33 
catch44 
(44 
	Exception44 
ex44 
)44  
{55 
FDebug66 
.66 
throwException66 %
(66% &
ex66& (
)66( )
;66) *
}77 
finally88 
{99 
};; 
return<< 
false<< 
;<< 
}== 	
publicAA 
staticAA 
voidAA 
setDataAA "
(AA" #
stringBB 
formatBB 
,BB 
objectCC 
dataCC 
)DD 
{EE 	
tryFF 
{GG 
CloseClipboardHH 
(HH 
)HH  
;HH  !
	ClipboardJJ 
.JJ 
ClearJJ 
(JJ  
)JJ  !
;JJ! "
	ClipboardKK 
.KK 
SetDataKK !
(KK! "
formatKK" (
,KK( )
dataKK* .
)KK. /
;KK/ 0
}LL 
catchMM 
(MM 
	ExceptionMM 
exMM 
)MM  
{NN 
FDebugOO 
.OO 
throwExceptionOO %
(OO% &
exOO& (
)OO( )
;OO) *
}PP 
finallyQQ 
{RR 
}TT 
}UU 	
publicYY 
staticYY 
voidYY 
setStringDataYY (
(YY( )
stringZZ 
formatZZ 
,ZZ 
string[[ 
data[[ 
)\\ 
{]] 	
try^^ 
{__ 
setData`` 
(`` 
format`` 
,`` 
(``  !
object``! '
)``' (
data``( ,
)``, -
;``- .
}aa 
catchbb 
(bb 
	Exceptionbb 
exbb 
)bb  
{cc 
FDebugdd 
.dd 
throwExceptiondd %
(dd% &
exdd& (
)dd( )
;dd) *
}ee 
finallyff 
{gg 
}ii 
}jj 	
publicnn 
staticnn 
voidnn 
setTextnn "
(nn" #
stringoo 
dataoo 
)pp 
{qq 	
tryrr 
{ss 
CloseClipboarduu 
(uu 
)uu  
;uu  !
	Clipboard
ƒƒ 
.
ƒƒ 
Clear
ƒƒ 
(
ƒƒ  
)
ƒƒ  !
;
ƒƒ! "
	Clipboard
„„ 
.
„„ 
SetDataObject
„„ '
(
„„' (
data
„„( ,
)
„„, -
;
„„- .
}
…… 
catch
†† 
(
†† 
	Exception
†† 
ex
†† 
)
††  
{
‡‡ 
FDebug
ˆˆ 
.
ˆˆ 
throwException
ˆˆ %
(
ˆˆ% &
new
ˆˆ& )
	Exception
ˆˆ* 3
(
ˆˆ3 4
string
ˆˆ4 :
.
ˆˆ: ;
Format
ˆˆ; A
(
ˆˆA B
$str
ˆˆB M
,
ˆˆM N(
getOpenClipboardWindowText
ˆˆO i
(
ˆˆi j
)
ˆˆj k
,
ˆˆk l
ex
ˆˆm o
.
ˆˆo p
Message
ˆˆp w
)
ˆˆw x
)
ˆˆx y
)
ˆˆy z
;
ˆˆz {
}
‰‰ 
finally
ŠŠ 
{
‹‹ 
}
 
}
 	
public
’’ 
static
’’ 
object
’’ 
getData
’’ $
(
’’$ %
string
““ 
format
““ 
)
”” 
{
•• 	
object
–– 
obj
–– 
=
–– 
null
–– 
;
–– 
int
—— 
cnt
—— 
=
—— 
$num
—— 
;
—— 
try
™™ 
{
šš 
while
›› 
(
›› 
true
›› 
)
›› 
{
œœ 
try
 
{
 
obj
ŸŸ 
=
ŸŸ 
	Clipboard
ŸŸ '
.
ŸŸ' (
GetData
ŸŸ( /
(
ŸŸ/ 0
format
ŸŸ0 6
)
ŸŸ6 7
;
ŸŸ7 8
break
   
;
   
}
¡¡ 
catch
¢¢ 
(
¢¢ 
System
¢¢ !
.
¢¢! "
Runtime
¢¢" )
.
¢¢) *
InteropServices
¢¢* 9
.
¢¢9 :
COMException
¢¢: F
comEx
¢¢G L
)
¢¢L M
{
££ 
if
¤¤ 
(
¤¤ 
cnt
¤¤ 
>
¤¤  !
$num
¤¤" #
)
¤¤# $
{
¥¥ 
FDebug
¦¦ "
.
¦¦" #
throwException
¦¦# 1
(
¦¦1 2
comEx
¦¦2 7
)
¦¦7 8
;
¦¦8 9
}
§§ 
System
¨¨ 
.
¨¨ 
	Threading
¨¨ (
.
¨¨( )
Thread
¨¨) /
.
¨¨/ 0
Sleep
¨¨0 5
(
¨¨5 6
$num
¨¨6 7
)
¨¨7 8
;
¨¨8 9
}
©© 
catch
ªª 
(
ªª 
	Exception
ªª $
inEx
ªª% )
)
ªª) *
{
«« 
FDebug
¬¬ 
.
¬¬ 
throwException
¬¬ -
(
¬¬- .
inEx
¬¬. 2
)
¬¬2 3
;
¬¬3 4
}
­­ 
cnt
®® 
++
®® 
;
®® 
}
¯¯ 
return
³³ 
obj
³³ 
;
³³ 
}
´´ 
catch
µµ 
(
µµ 
	Exception
µµ 
ex
µµ 
)
µµ  
{
¶¶ 
FDebug
·· 
.
·· 
throwException
·· %
(
··% &
ex
··& (
)
··( )
;
··) *
}
¸¸ 
finally
¹¹ 
{
ºº 
}
¼¼ 
return
½½ 
null
½½ 
;
½½ 
}
¾¾ 	
public
ÂÂ 
static
ÂÂ 
string
ÂÂ 
getStringData
ÂÂ *
(
ÂÂ* +
string
ÃÃ 
format
ÃÃ 
)
ÄÄ 
{
ÅÅ 	
try
ÆÆ 
{
ÇÇ 
return
ÈÈ 
(
ÈÈ 
string
ÈÈ 
)
ÈÈ 
getData
ÈÈ &
(
ÈÈ& '
format
ÈÈ' -
)
ÈÈ- .
;
ÈÈ. /
}
ÉÉ 
catch
ÊÊ 
(
ÊÊ 
	Exception
ÊÊ 
ex
ÊÊ 
)
ÊÊ  
{
ËË 
FDebug
ÌÌ 
.
ÌÌ 
throwException
ÌÌ %
(
ÌÌ% &
ex
ÌÌ& (
)
ÌÌ( )
;
ÌÌ) *
}
ÍÍ 
finally
ÎÎ 
{
ÏÏ 
}
ÑÑ 
return
ÒÒ 
string
ÒÒ 
.
ÒÒ 
Empty
ÒÒ 
;
ÒÒ  
}
ÓÓ 	
public
×× 
static
×× 
void
×× 
clear
××  
(
××  !
)
ØØ 
{
ÙÙ 	
try
ÚÚ 
{
ÛÛ 
	Clipboard
ÜÜ 
.
ÜÜ 
Clear
ÜÜ 
(
ÜÜ  
)
ÜÜ  !
;
ÜÜ! "
}
İİ 
catch
ŞŞ 
(
ŞŞ 
	Exception
ŞŞ 
ex
ŞŞ 
)
ŞŞ  
{
ßß 
FDebug
àà 
.
àà 
throwException
àà %
(
àà% &
ex
àà& (
)
àà( )
;
àà) *
}
áá 
finally
ââ 
{
ãã 
}
åå 
}
ææ 	
private
êê 
static
êê 
string
êê (
getOpenClipboardWindowText
êê 8
(
êê8 9
)
ëë 
{
ìì 	
string
íí 
wndText
íí 
=
íí 
string
íí #
.
íí# $
Empty
íí$ )
;
íí) *
try
îî 
{
ïï 
IntPtr
ññ 
hwnd
ññ 
=
ññ $
GetOpenClipboardWindow
ññ 4
(
ññ4 5
)
ññ5 6
;
ññ6 7
StringBuilder
òò 
sb
òò  
=
òò! "
new
òò# &
StringBuilder
òò' 4
(
òò4 5
$num
òò5 8
)
òò8 9
;
òò9 :
GetWindowText
óó 
(
óó 
hwnd
óó "
.
óó" #
ToInt32
óó# *
(
óó* +
)
óó+ ,
,
óó, -
sb
óó. 0
,
óó0 1
$num
óó2 5
)
óó5 6
;
óó6 7
wndText
õõ 
=
õõ 
sb
õõ 
.
õõ 
ToString
õõ %
(
õõ% &
)
õõ& '
;
õõ' (
return
÷÷ 
wndText
÷÷ 
;
÷÷ 
}
øø 
catch
ùù 
(
ùù 
	Exception
ùù 
ex
ùù 
)
ùù  
{
úú 
FDebug
ûû 
.
ûû 
throwException
ûû %
(
ûû% &
ex
ûû& (
)
ûû( )
;
ûû) *
}
üü 
return
ıı 
wndText
ıı 
;
ıı 
}
şş 	
}
„„ 
}…… Ÿ
_D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\c_FDbErrorCode.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
internal 
static 
class 
FDbErrorCode &
{ 
public   
const   
int   
	ORA_00001   "
=  # $
$num  % &
;  & '
public'' 
const'' 
int'' 
	ORA_00060'' "
=''# $
$num''% '
;''' (
public.. 
const.. 
int.. 
	ORA_00257.. "
=..# $
$num..% (
;..( )
public55 
const55 
int55 
	ORA_0103655 "
=55# $
$num55% )
;55) *
public<< 
const<< 
int<< 
	ORA_01089<< "
=<<# $
$num<<% )
;<<) *
publicCC 
constCC 
intCC 
	ORA_01653CC "
=CC# $
$numCC% )
;CC) *
publicJJ 
constJJ 
intJJ 
	ORA_01654JJ "
=JJ# $
$numJJ% )
;JJ) *
publicQQ 
constQQ 
intQQ 
	ORA_01658QQ "
=QQ# $
$numQQ% )
;QQ) *
publicXX 
constXX 
intXX 
	ORA_02046XX "
=XX# $
$numXX% )
;XX) *
public__ 
const__ 
int__ 
	ORA_02068__ "
=__# $
$num__% )
;__) *
publicff 
constff 
intff 
	ORA_03113ff "
=ff# $
$numff% )
;ff) *
publicmm 
constmm 
intmm 
	ORA_03114mm "
=mm# $
$nummm% )
;mm) *
publictt 
consttt 
inttt 
	ORA_12170tt "
=tt# $
$numtt% *
;tt* +
public{{ 
const{{ 
int{{ 
	ORA_12500{{ "
={{# $
$num{{% *
;{{* +
public
‚‚ 
const
‚‚ 
int
‚‚ 
	ORA_12541
‚‚ "
=
‚‚# $
$num
‚‚% *
;
‚‚* +
public
‰‰ 
const
‰‰ 
int
‰‰ 
	ORA_12547
‰‰ "
=
‰‰# $
$num
‰‰% *
;
‰‰* +
public
 
const
 
int
 
	ORA_12571
 "
=
# $
$num
% *
;
* +
public
   
const
   
int
   
	SQL_01205
   "
=
  # $
$num
  % )
;
  ) *
public
§§ 
const
§§ 
int
§§ 
	SQL_00942
§§ "
=
§§# $
$num
§§% )
;
§§) *
public
®® 
const
®® 
int
®® 
	SQL_08145
®® "
=
®®# $
$num
®®% )
;
®®) *
public
µµ 
const
µµ 
int
µµ 
	SQL_08601
µµ "
=
µµ# $
$num
µµ% )
;
µµ) *
public
¼¼ 
const
¼¼ 
int
¼¼ 
	SQL_10001
¼¼ "
=
¼¼# $
$num
¼¼% *
;
¼¼* +
public
ÃÃ 
const
ÃÃ 
int
ÃÃ 
	SQL_10002
ÃÃ "
=
ÃÃ# $
$num
ÃÃ% *
;
ÃÃ* +
public
ÊÊ 
const
ÊÊ 
int
ÊÊ 
	SQL_10003
ÊÊ "
=
ÊÊ# $
$num
ÊÊ% *
;
ÊÊ* +
public
ÑÑ 
const
ÑÑ 
int
ÑÑ 
	SQL_10008
ÑÑ "
=
ÑÑ# $
$num
ÑÑ% *
;
ÑÑ* +
public
ØØ 
const
ØØ 
int
ØØ 
	SQL_10011
ØØ "
=
ØØ# $
$num
ØØ% *
;
ØØ* +
public
ßß 
const
ßß 
int
ßß 
	SQL_26054
ßß "
=
ßß# $
$num
ßß% *
;
ßß* +
}
ää 
}åå äm
`D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\c_FBaseExecutor.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 	
abstract
 
class 
FBaseExecutor &
:' (
IDisposable) 4
{ 
private 
bool 

m_disposed 
=  
false! &
;& '
private 
string 
m_connectionString (
=) *
string+ 1
.1 2
Empty2 7
;7 8
private 
int 
	m_timeout 
= 
$num !
;! "
private 

Dictionary 
< 
string  
,  !
FSql" &
>& '
	m_sqlDict( 1
=2 3
null4 8
;8 9
private 
List 
< 
FSql 
> 
	m_sqlList #
=$ %
null& *
;* +
internal"" 
FBaseExecutor"" 
("" 
)## 
{$$ 
	m_sqlDict%% 
=%% 
new%% 

Dictionary%% %
<%%% &
string%%& ,
,%%, -
FSql%%. 2
>%%2 3
(%%3 4
)%%4 5
;%%5 6
	m_sqlList&& 
=&& 
new&& 
List&& 
<&&  
FSql&&  $
>&&$ %
(&&% &
)&&& '
;&&' (
}'' 
internal++ 
FBaseExecutor++ 
(++ 
string,, 
connectionString,, "
)-- 
:.. 
this.. 
(.. 
).. 
{// 
m_connectionString00 
=00 
connectionString00  0
;000 1
}11 
~55 
FBaseExecutor55 
(55 
)66 
{77 
	myDispose88 
(88 
false88 
)88 
;88 
}99 
	protected== 
virtual== 
void== 
	myDispose== '
(==' (
bool>> 
	disposing>> 
)?? 
{@@ 
ifAA 
(AA 
!AA 

m_disposedAA 
)AA 
{BB 
ifCC 
(CC 
	disposingCC 
)CC 
{DD 
	m_sqlDictEE 
=EE 
nullEE #
;EE# $
	m_sqlListFF 
=FF 
nullFF #
;FF# $
}GG 
}HH 

m_disposedII 
=II 
trueII 
;II 
}JJ 
publicRR 
voidRR 
DisposeRR 
(RR 
)SS 
{TT 	
	myDisposeUU 
(UU 
trueUU 
)UU 
;UU 
GCVV 
.VV 
SuppressFinalizeVV 
(VV  
thisVV  $
)VV$ %
;VV% &
}WW 	
public__ 
string__ 
connectionString__ &
{`` 	
getaa 
{bb 
trycc 
{dd 
returnee 
m_connectionStringee -
;ee- .
}ff 
catchgg 
(gg 
	Exceptiongg  
exgg! #
)gg# $
{hh 
FDebugii 
.ii 
throwExceptionii )
(ii) *
exii* ,
)ii, -
;ii- .
}jj 
finallykk 
{ll 
}nn 
returnoo 
stringoo 
.oo 
Emptyoo #
;oo# $
}pp 
setrr 
{ss 
trytt 
{uu 
m_connectionStringvv &
=vv' (
valuevv) .
;vv. /
}ww 
catchxx 
(xx 
	Exceptionxx  
exxx! #
)xx# $
{yy 
FDebugzz 
.zz 
throwExceptionzz )
(zz) *
exzz* ,
)zz, -
;zz- .
}{{ 
finally|| 
{}} 
} 
}
€€ 
}
 	
public
…… 
int
…… 
sqlCount
…… 
{
†† 	
get
‡‡ 
{
ˆˆ 
try
‰‰ 
{
ŠŠ 
return
‹‹ 
	m_sqlList
‹‹ $
.
‹‹$ %
Count
‹‹% *
;
‹‹* +
}
ŒŒ 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
‘‘ 
{
’’ 
}
”” 
return
•• 
$num
•• 
;
•• 
}
–– 
}
—— 	
public
›› 
int
›› 
timeout
›› 
{
œœ 	
get
 
{
 
try
ŸŸ 
{
   
return
¡¡ 
	m_timeout
¡¡ $
;
¡¡$ %
}
¢¢ 
catch
££ 
(
££ 
	Exception
££  
ex
££! #
)
££# $
{
¤¤ 
FDebug
¥¥ 
.
¥¥ 
throwException
¥¥ )
(
¥¥) *
ex
¥¥* ,
)
¥¥, -
;
¥¥- .
}
¦¦ 
finally
§§ 
{
¨¨ 
}
ªª 
return
«« 
$num
«« 
;
«« 
}
¬¬ 
set
®® 
{
¯¯ 
try
°° 
{
±± 
	m_timeout
²² 
=
²² 
value
²²  %
;
²²% &
}
³³ 
catch
´´ 
(
´´ 
	Exception
´´  
ex
´´! #
)
´´# $
{
µµ 
FDebug
¶¶ 
.
¶¶ 
throwException
¶¶ )
(
¶¶) *
ex
¶¶* ,
)
¶¶, -
;
¶¶- .
}
·· 
finally
¸¸ 
{
¹¹ 
}
»» 
}
¼¼ 
}
½½ 	
public
ÁÁ 
FSqlCollection
ÁÁ 
sqlCollection
ÁÁ +
{
ÂÂ 	
get
ÃÃ 
{
ÄÄ 
try
ÅÅ 
{
ÆÆ 
return
ÇÇ 
new
ÇÇ 
FSqlCollection
ÇÇ -
(
ÇÇ- .
	m_sqlDict
ÇÇ. 7
,
ÇÇ7 8
	m_sqlList
ÇÇ9 B
)
ÇÇB C
;
ÇÇC D
}
ÈÈ 
catch
ÉÉ 
(
ÉÉ 
	Exception
ÉÉ  
ex
ÉÉ! #
)
ÉÉ# $
{
ÊÊ 
FDebug
ËË 
.
ËË 
throwException
ËË )
(
ËË) *
ex
ËË* ,
)
ËË, -
;
ËË- .
}
ÌÌ 
finally
ÍÍ 
{
ÎÎ 
}
ĞĞ 
return
ÑÑ 
null
ÑÑ 
;
ÑÑ 
}
ÒÒ 
}
ÓÓ 	
	protected
×× 
List
×× 
<
×× 
FSql
×× 
>
×× 
sqlList
×× $
{
ØØ 	
get
ÙÙ 
{
ÚÚ 
try
ÛÛ 
{
ÜÜ 
return
İİ 
	m_sqlList
İİ $
;
İİ$ %
}
ŞŞ 
catch
ßß 
(
ßß 
	Exception
ßß  
ex
ßß! #
)
ßß# $
{
àà 
FDebug
áá 
.
áá 
throwException
áá )
(
áá) *
ex
áá* ,
)
áá, -
;
áá- .
}
ââ 
finally
ãã 
{
ää 
}
ææ 
return
çç 
null
çç 
;
çç 
}
èè 
}
éé 	
public
ññ 
void
ññ 
	appendSql
ññ 
(
ññ 
FSql
òò 
sql
òò 
)
óó 
{
ôô 	
try
õõ 
{
öö 
if
÷÷ 
(
÷÷ 
	m_sqlDict
÷÷ 
.
÷÷ 
ContainsKey
÷÷ )
(
÷÷) *
(
÷÷* +
sql
÷÷+ .
.
÷÷. /
name
÷÷/ 3
)
÷÷3 4
)
÷÷4 5
)
÷÷5 6
{
øø 
FDebug
ùù 
.
ùù 
throwFException
ùù *
(
ùù* +
string
ùù+ 1
.
ùù1 2
Format
ùù2 8
(
ùù8 9

FConstants
ùù9 C
.
ùùC D

err_m_0004
ùùD N
,
ùùN O
$str
ùùP Z
)
ùùZ [
)
ùù[ \
;
ùù\ ]
}
úú 
	m_sqlDict
ûû 
.
ûû 
Add
ûû 
(
ûû 
sql
ûû !
.
ûû! "
name
ûû" &
,
ûû& '
sql
ûû( +
)
ûû+ ,
;
ûû, -
	m_sqlList
üü 
.
üü 
Add
üü 
(
üü 
sql
üü !
)
üü! "
;
üü" #
}
ıı 
catch
şş 
(
şş 
	Exception
şş 
ex
şş 
)
şş  
{
ÿÿ 
FDebug
€€ 
.
€€ 
throwException
€€ %
(
€€% &
ex
€€& (
)
€€( )
;
€€) *
}
 
finally
‚‚ 
{
ƒƒ 
}
…… 
}
†† 	
public
ŠŠ 
FSql
ŠŠ 
	removeSql
ŠŠ 
(
ŠŠ 
FSql
‹‹ 
sql
‹‹ 
)
ŒŒ 
{
 	
try
 
{
 
if
 
(
 
!
 
	m_sqlDict
 
.
 
ContainsValue
 ,
(
, -
sql
- 0
)
0 1
)
1 2
{
‘‘ 
FDebug
’’ 
.
’’ 
throwFException
’’ *
(
’’* +
string
’’+ 1
.
’’1 2
Format
’’2 8
(
’’8 9

FConstants
’’9 C
.
’’C D

err_m_0003
’’D N
,
’’N O
$str
’’P U
)
’’U V
)
’’V W
;
’’W X
}
““ 
	m_sqlDict
”” 
.
”” 
Remove
””  
(
””  !
sql
””! $
.
””$ %
name
””% )
)
””) *
;
””* +
	m_sqlList
•• 
.
•• 
Remove
••  
(
••  !
sql
••! $
)
••$ %
;
••% &
return
–– 
sql
–– 
;
–– 
}
—— 
catch
˜˜ 
(
˜˜ 
	Exception
˜˜ 
ex
˜˜ 
)
˜˜  
{
™™ 
FDebug
šš 
.
šš 
throwException
šš %
(
šš% &
ex
šš& (
)
šš( )
;
šš) *
}
›› 
finally
œœ 
{
 
}
ŸŸ 
return
   
null
   
;
   
}
¡¡ 	
public
¥¥ 
FSql
¥¥ 
	removeSql
¥¥ 
(
¥¥ 
int
¦¦ 
index
¦¦ 
)
§§ 
{
¨¨ 	
try
©© 
{
ªª 
if
«« 
(
«« 
index
«« 
<
«« 
$num
«« 
||
««  
index
««! &
>=
««' )
	m_sqlList
««* 3
.
««3 4
Count
««4 9
)
««9 :
{
¬¬ 
FDebug
­­ 
.
­­ 
throwFException
­­ *
(
­­* +
string
­­+ 1
.
­­1 2
Format
­­2 8
(
­­8 9

FConstants
­­9 C
.
­­C D

err_m_0003
­­D N
,
­­N O
$str
­­P W
)
­­W X
)
­­X Y
;
­­Y Z
}
®® 
return
¯¯ 
	removeSql
¯¯  
(
¯¯  !
	m_sqlList
¯¯! *
[
¯¯* +
index
¯¯+ 0
]
¯¯0 1
)
¯¯1 2
;
¯¯2 3
}
°° 
catch
±± 
(
±± 
	Exception
±± 
ex
±± 
)
±±  
{
²² 
FDebug
³³ 
.
³³ 
throwException
³³ %
(
³³% &
ex
³³& (
)
³³( )
;
³³) *
}
´´ 
finally
µµ 
{
¶¶ 
}
¸¸ 
return
¹¹ 
null
¹¹ 
;
¹¹ 
}
ºº 	
public
¾¾ 
FSql
¾¾ 
	removeSql
¾¾ 
(
¾¾ 
string
¿¿ 
name
¿¿ 
)
ÀÀ 
{
ÁÁ 	
try
ÂÂ 
{
ÃÃ 
if
ÄÄ 
(
ÄÄ 
!
ÄÄ 
	m_sqlDict
ÄÄ 
.
ÄÄ 
ContainsKey
ÄÄ *
(
ÄÄ* +
name
ÄÄ+ /
)
ÄÄ/ 0
)
ÄÄ0 1
{
ÅÅ 
FDebug
ÆÆ 
.
ÆÆ 
throwFException
ÆÆ *
(
ÆÆ* +
string
ÆÆ+ 1
.
ÆÆ1 2
Format
ÆÆ2 8
(
ÆÆ8 9

FConstants
ÆÆ9 C
.
ÆÆC D

err_m_0003
ÆÆD N
,
ÆÆN O
$str
ÆÆP U
)
ÆÆU V
)
ÆÆV W
;
ÆÆW X
}
ÇÇ 
return
ÈÈ 
	removeSql
ÈÈ  
(
ÈÈ  !
	m_sqlDict
ÈÈ! *
[
ÈÈ* +
name
ÈÈ+ /
]
ÈÈ/ 0
)
ÈÈ0 1
;
ÈÈ1 2
}
ÉÉ 
catch
ÊÊ 
(
ÊÊ 
	Exception
ÊÊ 
ex
ÊÊ 
)
ÊÊ  
{
ËË 
FDebug
ÌÌ 
.
ÌÌ 
throwException
ÌÌ %
(
ÌÌ% &
ex
ÌÌ& (
)
ÌÌ( )
;
ÌÌ) *
}
ÍÍ 
finally
ÎÎ 
{
ÏÏ 
}
ÑÑ 
return
ÒÒ 
null
ÒÒ 
;
ÒÒ 
}
ÓÓ 	
public
×× 
void
×× 
clearSql
×× 
(
×× 
)
ØØ 
{
ÙÙ 	
try
ÚÚ 
{
ÛÛ 
	m_sqlDict
ÜÜ 
.
ÜÜ 
Clear
ÜÜ 
(
ÜÜ  
)
ÜÜ  !
;
ÜÜ! "
	m_sqlList
İİ 
.
İİ 
Clear
İİ 
(
İİ  
)
İİ  !
;
İİ! "
}
ŞŞ 
catch
ßß 
(
ßß 
	Exception
ßß 
ex
ßß 
)
ßß  
{
àà 
FDebug
áá 
.
áá 
throwException
áá %
(
áá% &
ex
áá& (
)
áá( )
;
áá) *
}
ââ 
finally
ãã 
{
ää 
}
ææ 
}
çç 	
}
íí 
}îî ¤„
]D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\c_FDbAdapter.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

static 
class 

FDbAdapter "
{ 
static 
private 
HashSet 
< 
int "
>" #%
m_oracleCriticalErrorCode$ =
=> ?
null@ D
;D E
static 
private 
HashSet 
< 
int "
>" #$
m_oracleWarningErrorCode$ <
== >
null? C
;C D
static 
private 
HashSet 
< 
int "
>" #*
m_msSqlServerCriticalErrorCode$ B
=C D
nullE I
;I J
static 
private 
HashSet 
< 
int "
>" #)
m_msSqlServerWarningErrorCode$ A
=B C
nullD H
;H I
static   

FDbAdapter   
(   
)!! 
{"" 	%
m_oracleCriticalErrorCode## %
=##& '
new##( +
HashSet##, 3
<##3 4
int##4 7
>##7 8
(##8 9
)##9 :
;##: ;$
m_oracleWarningErrorCode$$ $
=$$% &
new$$' *
HashSet$$+ 2
<$$2 3
int$$3 6
>$$6 7
($$7 8
)$$8 9
;$$9 :*
m_msSqlServerCriticalErrorCode%% *
=%%+ ,
new%%- 0
HashSet%%1 8
<%%8 9
int%%9 <
>%%< =
(%%= >
)%%> ?
;%%? @)
m_msSqlServerWarningErrorCode&& )
=&&* +
new&&, /
HashSet&&0 7
<&&7 8
int&&8 ;
>&&; <
(&&< =
)&&= >
;&&> ?
}'' 	
internal// 
static// 
HashSet// 
<//  
int//  #
>//# $#
oracleCriticalErrorCode//% <
{00 	
get11 
{22 
try33 
{44 
return55 %
m_oracleCriticalErrorCode55 4
;554 5
}66 
catch77 
(77 
	Exception77  
ex77! #
)77# $
{88 
FDebug99 
.99 
throwException99 )
(99) *
ex99* ,
)99, -
;99- .
}:: 
finally;; 
{<< 
}>> 
return?? 
null?? 
;?? 
}@@ 
}AA 	
internalEE 
staticEE 
HashSetEE 
<EE  
intEE  #
>EE# $"
oracleWarningErrorCodeEE% ;
{FF 	
getGG 
{HH 
tryII 
{JJ 
returnKK $
m_oracleWarningErrorCodeKK 3
;KK3 4
}LL 
catchMM 
(MM 
	ExceptionMM  
exMM! #
)MM# $
{NN 
FDebugOO 
.OO 
throwExceptionOO )
(OO) *
exOO* ,
)OO, -
;OO- .
}PP 
finallyQQ 
{RR 
}TT 
returnUU 
nullUU 
;UU 
}VV 
}WW 	
internal[[ 
static[[ 
HashSet[[ 
<[[  
int[[  #
>[[# $(
msSqlServerCriticalErrorCode[[% A
{\\ 	
get]] 
{^^ 
try__ 
{`` 
returnaa *
m_msSqlServerCriticalErrorCodeaa 9
;aa9 :
}bb 
catchcc 
(cc 
	Exceptioncc  
excc! #
)cc# $
{dd 
FDebugee 
.ee 
throwExceptionee )
(ee) *
exee* ,
)ee, -
;ee- .
}ff 
finallygg 
{hh 
}jj 
returnkk 
nullkk 
;kk 
}ll 
}mm 	
internalqq 
staticqq 
HashSetqq 
<qq  
intqq  #
>qq# $'
msSqlServerWarningErrorCodeqq% @
{rr 	
getss 
{tt 
tryuu 
{vv 
returnww )
m_msSqlServerWarningErrorCodeww 8
;ww8 9
}xx 
catchyy 
(yy 
	Exceptionyy  
exyy! #
)yy# $
{zz 
FDebug{{ 
.{{ 
throwException{{ )
({{) *
ex{{* ,
){{, -
;{{- .
}|| 
finally}} 
{~~ 
}
€€ 
return
 
null
 
;
 
}
‚‚ 
}
ƒƒ 	
internal
‹‹ 
static
‹‹ !
FSqlErrorCollection
‹‹ +
createSqlErrors
‹‹, ;
(
‹‹; <
SqlException
ŒŒ 
sqlEx
ŒŒ 
)
 
{
 	
List
 
<
 
	FSqlError
 
>
 
fSqlErrorList
 )
=
* +
null
, 0
;
0 1
try
‘‘ 
{
’’ 
fSqlErrorList
““ 
=
““ 
new
““  #
List
““$ (
<
““( )
	FSqlError
““) 2
>
““2 3
(
““3 4
)
““4 5
;
““5 6
foreach
—— 
(
—— 
SqlError
—— !
err
——" %
in
——& (
sqlEx
——) .
.
——. /
Errors
——/ 5
)
——5 6
{
˜˜ 
fSqlErrorList
™™ !
.
™™! "
Add
™™" %
(
™™% &
new
™™& )
	FSqlError
™™* 3
(
™™3 4
err
™™4 7
.
™™7 8
Number
™™8 >
,
™™> ?
err
™™@ C
.
™™C D
Message
™™D K
)
™™K L
)
™™L M
;
™™M N
}
šš 
return
 
new
 !
FSqlErrorCollection
 .
(
. /
fSqlErrorList
/ <
)
< =
;
= >
}
ŸŸ 
catch
   
(
   
	Exception
   
ex
   
)
    
{
¡¡ 
FDebug
¢¢ 
.
¢¢ 
throwException
¢¢ %
(
¢¢% &
ex
¢¢& (
)
¢¢( )
;
¢¢) *
}
££ 
finally
¤¤ 
{
¥¥ 
fSqlErrorList
¦¦ 
=
¦¦ 
null
¦¦  $
;
¦¦$ %
}
§§ 
return
¨¨ 
null
¨¨ 
;
¨¨ 
}
©© 	
internal
­­ 
static
­­ !
FSqlErrorCollection
­­ +
createSqlErrors
­­, ;
(
­­; <
System
®® 
.
®® 
Data
®® 
.
®® 
OracleClient
®® $
.
®®$ %
OracleException
®®% 4
oraEx
®®5 :
)
¯¯ 
{
°° 	
List
±± 
<
±± 
	FSqlError
±± 
>
±± 
fSqlErrorList
±± )
=
±±* +
null
±±, 0
;
±±0 1
try
³³ 
{
´´ 
fSqlErrorList
µµ 
=
µµ 
new
µµ  #
List
µµ$ (
<
µµ( )
	FSqlError
µµ) 2
>
µµ2 3
(
µµ3 4
)
µµ4 5
;
µµ5 6
fSqlErrorList
¹¹ 
.
¹¹ 
Add
¹¹ !
(
¹¹! "
new
¹¹" %
	FSqlError
¹¹& /
(
¹¹/ 0
oraEx
¹¹0 5
.
¹¹5 6
Code
¹¹6 :
,
¹¹: ;
oraEx
¹¹< A
.
¹¹A B
Message
¹¹B I
)
¹¹I J
)
¹¹J K
;
¹¹K L
return
½½ 
new
½½ !
FSqlErrorCollection
½½ .
(
½½. /
fSqlErrorList
½½/ <
)
½½< =
;
½½= >
}
¾¾ 
catch
¿¿ 
(
¿¿ 
	Exception
¿¿ 
ex
¿¿ 
)
¿¿  
{
ÀÀ 
FDebug
ÁÁ 
.
ÁÁ 
throwException
ÁÁ %
(
ÁÁ% &
ex
ÁÁ& (
)
ÁÁ( )
;
ÁÁ) *
}
ÂÂ 
finally
ÃÃ 
{
ÄÄ 
fSqlErrorList
ÅÅ 
=
ÅÅ 
null
ÅÅ  $
;
ÅÅ$ %
}
ÆÆ 
return
ÇÇ 
null
ÇÇ 
;
ÇÇ 
}
ÈÈ 	
internal
ÌÌ 
static
ÌÌ !
FSqlErrorCollection
ÌÌ +
createSqlErrors
ÌÌ, ;
(
ÌÌ; <
Oracle
ÍÍ 
.
ÍÍ 
ManagedDataAccess
ÍÍ $
.
ÍÍ$ %
Client
ÍÍ% +
.
ÍÍ+ ,
OracleException
ÍÍ, ;
oraEx
ÍÍ< A
)
ÎÎ 
{
ÏÏ 	
List
ĞĞ 
<
ĞĞ 
	FSqlError
ĞĞ 
>
ĞĞ 
fSqlErrorList
ĞĞ )
=
ĞĞ* +
null
ĞĞ, 0
;
ĞĞ0 1
try
ÒÒ 
{
ÓÓ 
fSqlErrorList
ÔÔ 
=
ÔÔ 
new
ÔÔ  #
List
ÔÔ$ (
<
ÔÔ( )
	FSqlError
ÔÔ) 2
>
ÔÔ2 3
(
ÔÔ3 4
)
ÔÔ4 5
;
ÔÔ5 6
foreach
ØØ 
(
ØØ 
Oracle
ØØ 
.
ØØ  
ManagedDataAccess
ØØ  1
.
ØØ1 2
Client
ØØ2 8
.
ØØ8 9
OracleError
ØØ9 D
err
ØØE H
in
ØØI K
oraEx
ØØL Q
.
ØØQ R
Errors
ØØR X
)
ØØX Y
{
ÙÙ 
fSqlErrorList
ÚÚ !
.
ÚÚ! "
Add
ÚÚ" %
(
ÚÚ% &
new
ÚÚ& )
	FSqlError
ÚÚ* 3
(
ÚÚ3 4
err
ÚÚ4 7
.
ÚÚ7 8
Number
ÚÚ8 >
,
ÚÚ> ?
err
ÚÚ@ C
.
ÚÚC D
Message
ÚÚD K
)
ÚÚK L
)
ÚÚL M
;
ÚÚM N
}
ÛÛ 
return
ßß 
new
ßß !
FSqlErrorCollection
ßß .
(
ßß. /
fSqlErrorList
ßß/ <
)
ßß< =
;
ßß= >
}
àà 
catch
áá 
(
áá 
	Exception
áá 
ex
áá 
)
áá  
{
ââ 
FDebug
ãã 
.
ãã 
throwException
ãã %
(
ãã% &
ex
ãã& (
)
ãã( )
;
ãã) *
}
ää 
finally
åå 
{
ææ 
fSqlErrorList
çç 
=
çç 
null
çç  $
;
çç$ %
}
èè 
return
éé 
null
éé 
;
éé 
}
êê 	
internal
îî 
static
îî !
FSqlErrorCollection
îî +
createSqlErrors
îî, ;
(
îî; <
MySql
ïï 
.
ïï 
Data
ïï 
.
ïï 
MySqlClient
ïï "
.
ïï" #
MySqlException
ïï# 1
mysEx
ïï2 7
)
ğğ 
{
ññ 	
List
òò 
<
òò 
	FSqlError
òò 
>
òò 
fSqlErrorList
òò )
=
òò* +
null
òò, 0
;
òò0 1
try
ôô 
{
õõ 
fSqlErrorList
öö 
=
öö 
new
öö  #
List
öö$ (
<
öö( )
	FSqlError
öö) 2
>
öö2 3
(
öö3 4
)
öö4 5
;
öö5 6
fSqlErrorList
úú 
.
úú 
Add
úú !
(
úú! "
new
úú" %
	FSqlError
úú& /
(
úú/ 0
mysEx
úú0 5
.
úú5 6
Number
úú6 <
,
úú< =
mysEx
úú> C
.
úúC D
Message
úúD K
)
úúK L
)
úúL M
;
úúM N
return
şş 
new
şş !
FSqlErrorCollection
şş .
(
şş. /
fSqlErrorList
şş/ <
)
şş< =
;
şş= >
}
ÿÿ 
catch
€€ 
(
€€ 
	Exception
€€ 
ex
€€ 
)
€€  
{
 
FDebug
‚‚ 
.
‚‚ 
throwException
‚‚ %
(
‚‚% &
ex
‚‚& (
)
‚‚( )
;
‚‚) *
}
ƒƒ 
finally
„„ 
{
…… 
fSqlErrorList
†† 
=
†† 
null
††  $
;
††$ %
}
‡‡ 
return
ˆˆ 
null
ˆˆ 
;
ˆˆ 
}
‰‰ 	
internal
 
static
 !
FSqlErrorCollection
 +
createSqlErrors
, ;
(
; <
Npgsql
 
.
 
NpgsqlException
 "
pgsEx
# (
)
 
{
 	
List
‘‘ 
<
‘‘ 
	FSqlError
‘‘ 
>
‘‘ 
fSqlErrorList
‘‘ )
=
‘‘* +
null
‘‘, 0
;
‘‘0 1
try
““ 
{
”” 
fSqlErrorList
•• 
=
•• 
new
••  #
List
••$ (
<
••( )
	FSqlError
••) 2
>
••2 3
(
••3 4
)
••4 5
;
••5 6
fSqlErrorList
™™ 
.
™™ 
Add
™™ !
(
™™! "
new
™™" %
	FSqlError
™™& /
(
™™/ 0
pgsEx
™™0 5
.
™™5 6
	ErrorCode
™™6 ?
,
™™? @
pgsEx
™™A F
.
™™F G
Message
™™G N
)
™™N O
)
™™O P
;
™™P Q
return
 
new
 !
FSqlErrorCollection
 .
(
. /
fSqlErrorList
/ <
)
< =
;
= >
}
 
catch
ŸŸ 
(
ŸŸ 
	Exception
ŸŸ 
ex
ŸŸ 
)
ŸŸ  
{
   
FDebug
¡¡ 
.
¡¡ 
throwException
¡¡ %
(
¡¡% &
ex
¡¡& (
)
¡¡( )
;
¡¡) *
}
¢¢ 
finally
££ 
{
¤¤ 
fSqlErrorList
¥¥ 
=
¥¥ 
null
¥¥  $
;
¥¥$ %
}
¦¦ 
return
§§ 
null
§§ 
;
§§ 
}
¨¨ 	
internal
¬¬ 
static
¬¬ 
FSqlErrorType
¬¬ %*
getSqlErrorTypeOfMsSqlServer
¬¬& B
(
¬¬B C!
FSqlErrorCollection
­­ 

fSqlErrors
­­  *
)
®® 
{
¯¯ 	
try
°° 
{
±± 
foreach
²² 
(
²² 
	FSqlError
²² "
ferr
²²# '
in
²²( *

fSqlErrors
²²+ 5
)
²²5 6
{
³³ 
if
´´ 
(
´´ ,
m_msSqlServerCriticalErrorCode
´´ 6
.
´´6 7
Contains
´´7 ?
(
´´? @
ferr
´´@ D
.
´´D E
	errorCode
´´E N
)
´´N O
)
´´O P
{
µµ 
return
¶¶ 
FSqlErrorType
¶¶ ,
.
¶¶, -
Critical
¶¶- 5
;
¶¶5 6
}
·· 
}
¸¸ 
foreach
¼¼ 
(
¼¼ 
	FSqlError
¼¼ "
ferr
¼¼# '
in
¼¼( *

fSqlErrors
¼¼+ 5
)
¼¼5 6
{
½½ 
if
¾¾ 
(
¾¾ +
m_msSqlServerWarningErrorCode
¾¾ 5
.
¾¾5 6
Contains
¾¾6 >
(
¾¾> ?
ferr
¾¾? C
.
¾¾C D
	errorCode
¾¾D M
)
¾¾M N
)
¾¾N O
{
¿¿ 
return
ÀÀ 
FSqlErrorType
ÀÀ ,
.
ÀÀ, -
Warning
ÀÀ- 4
;
ÀÀ4 5
}
ÁÁ 
}
ÂÂ 
return
ÆÆ 
FSqlErrorType
ÆÆ $
.
ÆÆ$ %
Normal
ÆÆ% +
;
ÆÆ+ ,
}
ÇÇ 
catch
ÈÈ 
(
ÈÈ 
	Exception
ÈÈ 
ex
ÈÈ 
)
ÈÈ  
{
ÉÉ 
FDebug
ÊÊ 
.
ÊÊ 
throwException
ÊÊ %
(
ÊÊ% &
ex
ÊÊ& (
)
ÊÊ( )
;
ÊÊ) *
}
ËË 
finally
ÌÌ 
{
ÍÍ 
}
ÏÏ 
return
ĞĞ 
FSqlErrorType
ĞĞ  
.
ĞĞ  !
Normal
ĞĞ! '
;
ĞĞ' (
}
ÑÑ 	
internal
ÕÕ 
static
ÕÕ 
FSqlErrorType
ÕÕ %%
getSqlErrorTypeOfOracle
ÕÕ& =
(
ÕÕ= >!
FSqlErrorCollection
ÖÖ 

fSqlErrors
ÖÖ  *
)
×× 
{
ØØ 	
try
ÙÙ 
{
ÚÚ 
foreach
ÛÛ 
(
ÛÛ 
	FSqlError
ÛÛ "
ferr
ÛÛ# '
in
ÛÛ( *

fSqlErrors
ÛÛ+ 5
)
ÛÛ5 6
{
ÜÜ 
if
İİ 
(
İİ '
m_oracleCriticalErrorCode
İİ 1
.
İİ1 2
Contains
İİ2 :
(
İİ: ;
ferr
İİ; ?
.
İİ? @
	errorCode
İİ@ I
)
İİI J
)
İİJ K
{
ŞŞ 
return
ßß 
FSqlErrorType
ßß ,
.
ßß, -
Critical
ßß- 5
;
ßß5 6
}
àà 
}
áá 
foreach
åå 
(
åå 
	FSqlError
åå "
ferr
åå# '
in
åå( *

fSqlErrors
åå+ 5
)
åå5 6
{
ææ 
if
çç 
(
çç &
m_oracleWarningErrorCode
çç 0
.
çç0 1
Contains
çç1 9
(
çç9 :
ferr
çç: >
.
çç> ?
	errorCode
çç? H
)
ççH I
)
ççI J
{
èè 
return
éé 
FSqlErrorType
éé ,
.
éé, -
Warning
éé- 4
;
éé4 5
}
êê 
}
ëë 
return
ïï 
FSqlErrorType
ïï $
.
ïï$ %
Normal
ïï% +
;
ïï+ ,
}
ğğ 
catch
ññ 
(
ññ 
	Exception
ññ 
ex
ññ 
)
ññ  
{
òò 
FDebug
óó 
.
óó 
throwException
óó %
(
óó% &
ex
óó& (
)
óó( )
;
óó) *
}
ôô 
finally
õõ 
{
öö 
}
øø 
return
ùù 
FSqlErrorType
ùù  
.
ùù  !
Normal
ùù! '
;
ùù' (
}
úú 	
internal
şş 
static
şş 
FSqlErrorType
şş %$
getSqlErrorTypeOfMySql
şş& <
(
şş< =!
FSqlErrorCollection
ÿÿ 

fSqlErrors
ÿÿ  *
)
€€ 
{
 	
try
‚‚ 
{
ƒƒ 
}
…… 
catch
†† 
(
†† 
	Exception
†† 
ex
†† 
)
††  
{
‡‡ 
FDebug
ˆˆ 
.
ˆˆ 
throwException
ˆˆ %
(
ˆˆ% &
ex
ˆˆ& (
)
ˆˆ( )
;
ˆˆ) *
}
‰‰ 
finally
ŠŠ 
{
‹‹ 
}
 
return
 
FSqlErrorType
  
.
  !
Normal
! '
;
' (
}
 	
internal
““ 
static
““ 
FSqlErrorType
““ %&
getSqlErrorTypeOfMariaDb
““& >
(
““> ?!
FSqlErrorCollection
”” 

fSqlErrors
””  *
)
•• 
{
–– 	
try
—— 
{
˜˜ 
}
šš 
catch
›› 
(
›› 
	Exception
›› 
ex
›› 
)
››  
{
œœ 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
ŸŸ 
{
   
}
¢¢ 
return
££ 
FSqlErrorType
££  
.
££  !
Normal
££! '
;
££' (
}
¤¤ 	
internal
¨¨ 
static
¨¨ 
FSqlErrorType
¨¨ %)
getSqlErrorTypeOfPostgreSql
¨¨& A
(
¨¨A B!
FSqlErrorCollection
©© 

fSqlErrors
©©  *
)
ªª 
{
«« 	
try
¬¬ 
{
­­ 
}
¯¯ 
catch
°° 
(
°° 
	Exception
°° 
ex
°° 
)
°°  
{
±± 
FDebug
²² 
.
²² 
throwException
²² %
(
²²% &
ex
²²& (
)
²²( )
;
²²) *
}
³³ 
finally
´´ 
{
µµ 
}
·· 
return
¸¸ 
FSqlErrorType
¸¸  
.
¸¸  !
Normal
¸¸! '
;
¸¸' (
}
¹¹ 	
public
½½ 
static
½½ 
FIQueryExecutor
½½ %!
createQueryExecutor
½½& 9
(
½½9 :
FDbProvider
¾¾ 
fDbProvider
¾¾ #
,
¾¾# $
string
¿¿ 
connectString
¿¿  
)
ÀÀ 
{
ÁÁ 	
try
ÂÂ 
{
ÃÃ 
if
ÄÄ 
(
ÄÄ 
fDbProvider
ÄÄ 
==
ÄÄ  "
FDbProvider
ÄÄ# .
.
ÄÄ. /
MsSqlServer
ÄÄ/ :
)
ÄÄ: ;
{
ÅÅ 
return
ÆÆ 
(
ÆÆ 
FIQueryExecutor
ÆÆ +
)
ÆÆ+ ,
(
ÆÆ, -
new
ÆÆ- 0
FMssQueryExecutor
ÆÆ1 B
(
ÆÆB C
connectString
ÆÆC P
)
ÆÆP Q
)
ÆÆQ R
;
ÆÆR S
}
ÇÇ 
else
ÈÈ 
if
ÈÈ 
(
ÈÈ 
fDbProvider
ÈÈ $
==
ÈÈ% '
FDbProvider
ÈÈ( 3
.
ÈÈ3 4
Oracle
ÈÈ4 :
)
ÈÈ: ;
{
ÉÉ 
return
ÊÊ 
(
ÊÊ 
FIQueryExecutor
ÊÊ +
)
ÊÊ+ ,
(
ÊÊ, -
new
ÊÊ- 0
FOraQueryExecutor
ÊÊ1 B
(
ÊÊB C
connectString
ÊÊC P
)
ÊÊP Q
)
ÊÊQ R
;
ÊÊR S
}
ËË 
else
ÌÌ 
if
ÌÌ 
(
ÌÌ 
fDbProvider
ÌÌ $
==
ÌÌ% '
FDbProvider
ÌÌ( 3
.
ÌÌ3 4
OracleEx
ÌÌ4 <
)
ÌÌ< =
{
ÍÍ 
return
ÎÎ 
(
ÎÎ 
FIQueryExecutor
ÎÎ +
)
ÎÎ+ ,
(
ÎÎ, -
new
ÎÎ- 0
FOdpQueryExecutor
ÎÎ1 B
(
ÎÎB C
connectString
ÎÎC P
)
ÎÎP Q
)
ÎÎQ R
;
ÎÎR S
}
ÏÏ 
else
ĞĞ 
if
ĞĞ 
(
ĞĞ 
fDbProvider
ĞĞ $
==
ĞĞ% '
FDbProvider
ĞĞ( 3
.
ĞĞ3 4
MySql
ĞĞ4 9
)
ĞĞ9 :
{
ÑÑ 
return
ÒÒ 
(
ÒÒ 
FIQueryExecutor
ÒÒ +
)
ÒÒ+ ,
(
ÒÒ, -
new
ÒÒ- 0
FMysQueryExecutor
ÒÒ1 B
(
ÒÒB C
connectString
ÒÒC P
)
ÒÒP Q
)
ÒÒQ R
;
ÒÒR S
}
ÓÓ 
else
ÔÔ 
if
ÔÔ 
(
ÔÔ 
fDbProvider
ÔÔ $
==
ÔÔ% '
FDbProvider
ÔÔ( 3
.
ÔÔ3 4
MariaDb
ÔÔ4 ;
)
ÔÔ; <
{
ÕÕ 
return
ÖÖ 
(
ÖÖ 
FIQueryExecutor
ÖÖ +
)
ÖÖ+ ,
(
ÖÖ, -
new
ÖÖ- 0
FMarQueryExecutor
ÖÖ1 B
(
ÖÖB C
connectString
ÖÖC P
)
ÖÖP Q
)
ÖÖQ R
;
ÖÖR S
}
×× 
else
ØØ 
if
ØØ 
(
ØØ 
fDbProvider
ØØ $
==
ØØ% '
FDbProvider
ØØ( 3
.
ØØ3 4

PostgreSql
ØØ4 >
)
ØØ> ?
{
ÙÙ 
return
ÚÚ 
(
ÚÚ 
FIQueryExecutor
ÚÚ +
)
ÚÚ+ ,
(
ÚÚ, -
new
ÚÚ- 0
FPgsQueryExecutor
ÚÚ1 B
(
ÚÚB C
connectString
ÚÚC P
)
ÚÚP Q
)
ÚÚQ R
;
ÚÚR S
}
ÛÛ 
}
ÜÜ 
catch
İİ 
(
İİ 
	Exception
İİ 
ex
İİ 
)
İİ  
{
ŞŞ 
FDebug
ßß 
.
ßß 
throwException
ßß %
(
ßß% &
ex
ßß& (
)
ßß( )
;
ßß) *
}
àà 
finally
áá 
{
ââ 
}
ää 
return
åå 
null
åå 
;
åå 
}
ææ 	
public
êê 
static
êê  
FITransactExecutor
êê ($
createTransactExecutor
êê) ?
(
êê? @
FDbProvider
ëë 
fDbProvider
ëë #
,
ëë# $
string
ìì 
connectString
ìì  
)
íí 
{
îî 	
try
ïï 
{
ğğ 
if
ññ 
(
ññ 
fDbProvider
ññ 
==
ññ  "
FDbProvider
ññ# .
.
ññ. /
MsSqlServer
ññ/ :
)
ññ: ;
{
òò 
return
óó 
(
óó  
FITransactExecutor
óó .
)
óó. /
(
óó/ 0
new
óó0 3"
FMssTransactExecutor
óó4 H
(
óóH I
connectString
óóI V
)
óóV W
)
óóW X
;
óóX Y
}
ôô 
else
õõ 
if
õõ 
(
õõ 
fDbProvider
õõ $
==
õõ% '
FDbProvider
õõ( 3
.
õõ3 4
Oracle
õõ4 :
)
õõ: ;
{
öö 
return
÷÷ 
(
÷÷  
FITransactExecutor
÷÷ .
)
÷÷. /
(
÷÷/ 0
new
÷÷0 3"
FOraTransactExecutor
÷÷4 H
(
÷÷H I
connectString
÷÷I V
)
÷÷V W
)
÷÷W X
;
÷÷X Y
}
øø 
else
ùù 
if
ùù 
(
ùù 
fDbProvider
ùù $
==
ùù% '
FDbProvider
ùù( 3
.
ùù3 4
OracleEx
ùù4 <
)
ùù< =
{
úú 
return
ûû 
(
ûû  
FITransactExecutor
ûû .
)
ûû. /
(
ûû/ 0
new
ûû0 3"
FOdpTransactExecutor
ûû4 H
(
ûûH I
connectString
ûûI V
)
ûûV W
)
ûûW X
;
ûûX Y
}
üü 
else
ıı 
if
ıı 
(
ıı 
fDbProvider
ıı $
==
ıı% '
FDbProvider
ıı( 3
.
ıı3 4
MySql
ıı4 9
)
ıı9 :
{
şş 
return
ÿÿ 
(
ÿÿ  
FITransactExecutor
ÿÿ .
)
ÿÿ. /
(
ÿÿ/ 0
new
ÿÿ0 3"
FMysTransactExecutor
ÿÿ4 H
(
ÿÿH I
connectString
ÿÿI V
)
ÿÿV W
)
ÿÿW X
;
ÿÿX Y
}
€€ 
else
 
if
 
(
 
fDbProvider
 $
==
% '
FDbProvider
( 3
.
3 4
MariaDb
4 ;
)
; <
{
‚‚ 
return
ƒƒ 
(
ƒƒ  
FITransactExecutor
ƒƒ .
)
ƒƒ. /
(
ƒƒ/ 0
new
ƒƒ0 3"
FMarTransactExecutor
ƒƒ4 H
(
ƒƒH I
connectString
ƒƒI V
)
ƒƒV W
)
ƒƒW X
;
ƒƒX Y
}
„„ 
else
…… 
if
…… 
(
…… 
fDbProvider
…… $
==
……% '
FDbProvider
……( 3
.
……3 4

PostgreSql
……4 >
)
……> ?
{
†† 
return
‡‡ 
(
‡‡  
FITransactExecutor
‡‡ .
)
‡‡. /
(
‡‡/ 0
new
‡‡0 3"
FPgsTransactExecutor
‡‡4 H
(
‡‡H I
connectString
‡‡I V
)
‡‡V W
)
‡‡W X
;
‡‡X Y
}
ˆˆ 
}
‰‰ 
catch
ŠŠ 
(
ŠŠ 
	Exception
ŠŠ 
ex
ŠŠ 
)
ŠŠ  
{
‹‹ 
FDebug
ŒŒ 
.
ŒŒ 
throwException
ŒŒ %
(
ŒŒ% &
ex
ŒŒ& (
)
ŒŒ( )
;
ŒŒ) *
}
 
finally
 
{
 
}
‘‘ 
return
’’ 
null
’’ 
;
’’ 
}
““ 	
public
—— 
static
—— !
FIProcedureExecutor
—— )%
createProcedureExecutor
——* A
(
——A B
FDbProvider
˜˜ 
fDbProvider
˜˜ #
,
˜˜# $
string
™™ 
connectString
™™  
)
šš 
{
›› 	
try
œœ 
{
 
if
 
(
 
fDbProvider
 
==
  "
FDbProvider
# .
.
. /
MsSqlServer
/ :
)
: ;
{
ŸŸ 
throw
   
new
   %
NotImplementedException
   5
(
  5 6
)
  6 7
;
  7 8
}
¡¡ 
else
¢¢ 
if
¢¢ 
(
¢¢ 
fDbProvider
¢¢ $
==
¢¢% '
FDbProvider
¢¢( 3
.
¢¢3 4
Oracle
¢¢4 :
)
¢¢: ;
{
££ 
throw
¤¤ 
new
¤¤ %
NotImplementedException
¤¤ 5
(
¤¤5 6
)
¤¤6 7
;
¤¤7 8
}
¥¥ 
else
¦¦ 
if
¦¦ 
(
¦¦ 
fDbProvider
¦¦ $
==
¦¦% '
FDbProvider
¦¦( 3
.
¦¦3 4
OracleEx
¦¦4 <
)
¦¦< =
{
§§ 
return
¨¨ 
(
¨¨ !
FIProcedureExecutor
¨¨ /
)
¨¨/ 0
(
¨¨0 1
new
¨¨1 4#
FOdpProcedureExecutor
¨¨5 J
(
¨¨J K
connectString
¨¨K X
)
¨¨X Y
)
¨¨Y Z
;
¨¨Z [
}
©© 
else
ªª 
if
ªª 
(
ªª 
fDbProvider
ªª $
==
ªª% '
FDbProvider
ªª( 3
.
ªª3 4
MySql
ªª4 9
)
ªª9 :
{
«« 
throw
¬¬ 
new
¬¬ %
NotImplementedException
¬¬ 5
(
¬¬5 6
)
¬¬6 7
;
¬¬7 8
}
­­ 
else
®® 
if
®® 
(
®® 
fDbProvider
®® $
==
®®% '
FDbProvider
®®( 3
.
®®3 4
MariaDb
®®4 ;
)
®®; <
{
¯¯ 
throw
°° 
new
°° %
NotImplementedException
°° 5
(
°°5 6
)
°°6 7
;
°°7 8
}
±± 
else
²² 
if
²² 
(
²² 
fDbProvider
²² $
==
²²% '
FDbProvider
²²( 3
.
²²3 4

PostgreSql
²²4 >
)
²²> ?
{
³³ 
throw
´´ 
new
´´ %
NotImplementedException
´´ 5
(
´´5 6
)
´´6 7
;
´´7 8
}
µµ 
}
¶¶ 
catch
·· 
(
·· 
	Exception
·· 
ex
·· 
)
··  
{
¸¸ 
FDebug
¹¹ 
.
¹¹ 
throwException
¹¹ %
(
¹¹% &
ex
¹¹& (
)
¹¹( )
;
¹¹) *
}
ºº 
finally
»» 
{
¼¼ 
}
¾¾ 
return
¿¿ 
null
¿¿ 
;
¿¿ 
}
ÀÀ 	
public
ÄÄ 
static
ÄÄ 
void
ÄÄ (
addOracleCriticalErrorCode
ÄÄ 5
(
ÄÄ5 6
int
ÅÅ 
	errorCode
ÅÅ 
)
ÆÆ 
{
ÇÇ 	
try
ÈÈ 
{
ÉÉ 
if
ÊÊ 
(
ÊÊ '
m_oracleCriticalErrorCode
ÊÊ -
==
ÊÊ. 0
null
ÊÊ1 5
)
ÊÊ5 6
{
ËË '
m_oracleCriticalErrorCode
ÌÌ -
=
ÌÌ. /
new
ÌÌ0 3
HashSet
ÌÌ4 ;
<
ÌÌ; <
int
ÌÌ< ?
>
ÌÌ? @
(
ÌÌ@ A
)
ÌÌA B
;
ÌÌB C
}
ÍÍ '
m_oracleCriticalErrorCode
ÎÎ )
.
ÎÎ) *
Add
ÎÎ* -
(
ÎÎ- .
	errorCode
ÎÎ. 7
)
ÎÎ7 8
;
ÎÎ8 9
}
ÏÏ 
catch
ĞĞ 
(
ĞĞ 
	Exception
ĞĞ 
ex
ĞĞ 
)
ĞĞ  
{
ÑÑ 
FDebug
ÒÒ 
.
ÒÒ 
throwException
ÒÒ %
(
ÒÒ% &
ex
ÒÒ& (
)
ÒÒ( )
;
ÒÒ) *
}
ÓÓ 
finally
ÔÔ 
{
ÕÕ 
}
×× 
}
ØØ 	
public
ÜÜ 
static
ÜÜ 
void
ÜÜ '
addOracleWarningErrorCode
ÜÜ 4
(
ÜÜ4 5
int
İİ 
	errorCode
İİ 
)
ŞŞ 
{
ßß 	
try
àà 
{
áá 
if
ââ 
(
ââ &
m_oracleWarningErrorCode
ââ ,
==
ââ- /
null
ââ0 4
)
ââ4 5
{
ãã &
m_oracleWarningErrorCode
ää ,
=
ää- .
new
ää/ 2
HashSet
ää3 :
<
ää: ;
int
ää; >
>
ää> ?
(
ää? @
)
ää@ A
;
ääA B
}
åå &
m_oracleWarningErrorCode
ææ (
.
ææ( )
Add
ææ) ,
(
ææ, -
	errorCode
ææ- 6
)
ææ6 7
;
ææ7 8
}
çç 
catch
èè 
(
èè 
	Exception
èè 
ex
èè 
)
èè  
{
éé 
FDebug
êê 
.
êê 
throwException
êê %
(
êê% &
ex
êê& (
)
êê( )
;
êê) *
}
ëë 
finally
ìì 
{
íí 
}
ïï 
}
ğğ 	
public
ôô 
static
ôô 
void
ôô -
addMsSqlServerCriticalErrorCode
ôô :
(
ôô: ;
int
õõ 
	errorCode
õõ 
)
öö 
{
÷÷ 	
try
øø 
{
ùù 
if
úú 
(
úú ,
m_msSqlServerCriticalErrorCode
úú 2
==
úú3 5
null
úú6 :
)
úú: ;
{
ûû ,
m_msSqlServerCriticalErrorCode
üü 2
=
üü3 4
new
üü5 8
HashSet
üü9 @
<
üü@ A
int
üüA D
>
üüD E
(
üüE F
)
üüF G
;
üüG H
}
ıı ,
m_msSqlServerCriticalErrorCode
şş .
.
şş. /
Add
şş/ 2
(
şş2 3
	errorCode
şş3 <
)
şş< =
;
şş= >
}
ÿÿ 
catch
€€ 
(
€€ 
	Exception
€€ 
ex
€€ 
)
€€  
{
 
FDebug
‚‚ 
.
‚‚ 
throwException
‚‚ %
(
‚‚% &
ex
‚‚& (
)
‚‚( )
;
‚‚) *
}
ƒƒ 
finally
„„ 
{
…… 
}
‡‡ 
}
ˆˆ 	
public
ŒŒ 
static
ŒŒ 
void
ŒŒ ,
addMsSqlServerWarningErrorCode
ŒŒ 9
(
ŒŒ9 :
int
 
	errorCode
 
)
 
{
 	
try
 
{
‘‘ 
if
’’ 
(
’’ +
m_msSqlServerWarningErrorCode
’’ 1
==
’’2 4
null
’’5 9
)
’’9 :
{
““ +
m_msSqlServerWarningErrorCode
”” 1
=
””2 3
new
””4 7
HashSet
””8 ?
<
””? @
int
””@ C
>
””C D
(
””D E
)
””E F
;
””F G
}
•• +
m_msSqlServerWarningErrorCode
–– -
.
––- .
Add
––. 1
(
––1 2
	errorCode
––2 ;
)
––; <
;
––< =
}
—— 
catch
˜˜ 
(
˜˜ 
	Exception
˜˜ 
ex
˜˜ 
)
˜˜  
{
™™ 
FDebug
šš 
.
šš 
throwException
šš %
(
šš% &
ex
šš& (
)
šš( )
;
šš) *
}
›› 
finally
œœ 
{
 
}
ŸŸ 
}
   	
public
¤¤ 
static
¤¤ 
string
¤¤ (
exportQueryFromMsSqlServer
¤¤ 7
(
¤¤7 8
FDbProvider
¥¥ 
fDbProvider
¥¥ #
,
¥¥# $
string
¦¦ 
sql
¦¦ 
)
§§ 
{
¨¨ 	
string
©© 
query
©© 
=
©© 
sql
©© 
;
©© 
try
«« 
{
¬¬ 
if
­­ 
(
­­ 
fDbProvider
­­ 
==
­­  "
FDbProvider
­­# .
.
­­. /
Oracle
­­/ 5
||
­­6 8
fDbProvider
®® 
==
®®  "
FDbProvider
®®# .
.
®®. /
OracleEx
®®/ 7
)
¯¯ 
{
°° 
query
±± 
=
±± 
query
±± !
.
±±! "
Replace
±±" )
(
±±) *
$str
±±* -
,
±±- .
$str
±±/ 2
)
±±2 3
;
±±3 4
query
²² 
=
²² 
query
²² !
.
²²! "
Replace
²²" )
(
²²) *
$str
²²* 2
,
²²2 3
$str
²²4 9
)
²²9 :
;
²²: ;
query
³³ 
=
³³ 
query
³³ !
.
³³! "
Replace
³³" )
(
³³) *
$str
³³* 1
,
³³1 2
$str
³³3 ;
)
³³; <
;
³³< =
query
´´ 
=
´´ 
query
´´ !
.
´´! "
Replace
´´" )
(
´´) *
$str
´´* -
,
´´- .
$str
´´/ 3
)
´´3 4
;
´´4 5
}
µµ 
else
¶¶ 
if
¶¶ 
(
¶¶ 
fDbProvider
·· 
==
··  "
FDbProvider
··# .
.
··. /
MySql
··/ 4
||
··5 7
fDbProvider
¸¸ 
==
¸¸  "
FDbProvider
¸¸# .
.
¸¸. /
MariaDb
¸¸/ 6
)
¹¹ 
{
ºº 
query
»» 
=
»» 
query
»» !
.
»»! "
Replace
»»" )
(
»») *
$str
»»* 2
,
»»2 3
$str
»»4 >
)
»»> ?
;
»»? @
query
¼¼ 
=
¼¼ 
query
¼¼ !
.
¼¼! "
Replace
¼¼" )
(
¼¼) *
$str
¼¼* 1
,
¼¼1 2
$str
¼¼3 8
)
¼¼8 9
;
¼¼9 :
}
½½ 
else
¾¾ 
if
¾¾ 
(
¾¾ 
fDbProvider
¾¾ $
==
¾¾% '
FDbProvider
¾¾( 3
.
¾¾3 4

PostgreSql
¾¾4 >
)
¾¾> ?
{
¿¿ 
query
ÀÀ 
=
ÀÀ 
query
ÀÀ !
.
ÀÀ! "
Replace
ÀÀ" )
(
ÀÀ) *
$str
ÀÀ* 2
,
ÀÀ2 3
$str
ÀÀ4 >
)
ÀÀ> ?
;
ÀÀ? @
query
ÁÁ 
=
ÁÁ 
query
ÁÁ !
.
ÁÁ! "
Replace
ÁÁ" )
(
ÁÁ) *
$str
ÁÁ* 1
,
ÁÁ1 2
$str
ÁÁ3 ;
)
ÁÁ; <
;
ÁÁ< =
}
ÂÂ 
}
ÃÃ 
catch
ÄÄ 
(
ÄÄ 
	Exception
ÄÄ 
ex
ÄÄ 
)
ÄÄ  
{
ÅÅ 
FDebug
ÆÆ 
.
ÆÆ 
throwException
ÆÆ %
(
ÆÆ% &
ex
ÆÆ& (
)
ÆÆ( )
;
ÆÆ) *
}
ÇÇ 
finally
ÈÈ 
{
ÉÉ 
}
ËË 
return
ÌÌ 
query
ÌÌ 
;
ÌÌ 
}
ÍÍ 	
public
ÑÑ 
static
ÑÑ 
string
ÑÑ #
exportQueryFromOracle
ÑÑ 2
(
ÑÑ2 3
FDbProvider
ÒÒ 
fDbProvider
ÒÒ #
,
ÒÒ# $
string
ÓÓ 
sql
ÓÓ 
)
ÔÔ 
{
ÕÕ 	
string
ÖÖ 
query
ÖÖ 
=
ÖÖ 
sql
ÖÖ 
;
ÖÖ 
try
ØØ 
{
ÙÙ 
if
ÚÚ 
(
ÚÚ 
fDbProvider
ÚÚ 
==
ÚÚ  "
FDbProvider
ÚÚ# .
.
ÚÚ. /
MsSqlServer
ÚÚ/ :
)
ÚÚ: ;
{
ÛÛ 
query
ÜÜ 
=
ÜÜ 
query
ÜÜ !
.
ÜÜ! "
Replace
ÜÜ" )
(
ÜÜ) *
$str
ÜÜ* -
,
ÜÜ- .
$str
ÜÜ/ 2
)
ÜÜ2 3
;
ÜÜ3 4
query
İİ 
=
İİ 
query
İİ !
.
İİ! "
Replace
İİ" )
(
İİ) *
$str
İİ* /
,
İİ/ 0
$str
İİ1 9
)
İİ9 :
;
İİ: ;
query
ŞŞ 
=
ŞŞ 
query
ŞŞ !
.
ŞŞ! "
Replace
ŞŞ" )
(
ŞŞ) *
$str
ŞŞ* 2
,
ŞŞ2 3
$str
ŞŞ4 ;
)
ŞŞ; <
;
ŞŞ< =
query
ßß 
=
ßß 
query
ßß !
.
ßß! "
Replace
ßß" )
(
ßß) *
$str
ßß* .
,
ßß. /
$str
ßß0 3
)
ßß3 4
;
ßß4 5
}
àà 
else
áá 
if
áá 
(
áá 
fDbProvider
ââ 
==
ââ  "
FDbProvider
ââ# .
.
ââ. /
MySql
ââ/ 4
||
ââ5 7
fDbProvider
ãã 
==
ãã  "
FDbProvider
ãã# .
.
ãã. /
MariaDb
ãã/ 6
)
ää 
{
åå 
query
ææ 
=
ææ 
query
ææ !
.
ææ! "
Replace
ææ" )
(
ææ) *
$str
ææ* -
,
ææ- .
$str
ææ/ 2
)
ææ2 3
;
ææ3 4
query
çç 
=
çç 
query
çç !
.
çç! "
Replace
çç" )
(
çç) *
$str
çç* /
,
çç/ 0
$str
çç1 ;
)
çç; <
;
çç< =
query
èè 
=
èè 
query
èè !
.
èè! "
Replace
èè" )
(
èè) *
$str
èè* 2
,
èè2 3
$str
èè4 9
)
èè9 :
;
èè: ;
}
éé 
else
êê 
if
êê 
(
êê 
fDbProvider
êê $
==
êê% '
FDbProvider
êê( 3
.
êê3 4

PostgreSql
êê4 >
)
êê> ?
{
ëë 
query
ìì 
=
ìì 
query
ìì !
.
ìì! "
Replace
ìì" )
(
ìì) *
$str
ìì* -
,
ìì- .
$str
ìì/ 2
)
ìì2 3
;
ìì3 4
query
íí 
=
íí 
query
íí !
.
íí! "
Replace
íí" )
(
íí) *
$str
íí* /
,
íí/ 0
$str
íí1 ;
)
íí; <
;
íí< =
}
îî 
}
ïï 
catch
ğğ 
(
ğğ 
	Exception
ğğ 
ex
ğğ 
)
ğğ  
{
ññ 
FDebug
òò 
.
òò 
throwException
òò %
(
òò% &
ex
òò& (
)
òò( )
;
òò) *
}
óó 
finally
ôô 
{
õõ 
}
÷÷ 
return
øø 
query
øø 
;
øø 
}
ùù 	
public
ıı 
static
ıı 
string
ıı "
exportQueryFromMySql
ıı 1
(
ıı1 2
FDbProvider
şş 
fDbProvider
şş #
,
şş# $
string
ÿÿ 
sql
ÿÿ 
)
€€ 
{
 	
string
‚‚ 
query
‚‚ 
=
‚‚ 
sql
‚‚ 
;
‚‚ 
try
„„ 
{
…… 
if
†† 
(
†† 
fDbProvider
†† 
==
††  "
FDbProvider
††# .
.
††. /
MsSqlServer
††/ :
)
††: ;
{
‡‡ 
query
ˆˆ 
=
ˆˆ 
query
ˆˆ !
.
ˆˆ! "
Replace
ˆˆ" )
(
ˆˆ) *
$str
ˆˆ* 4
,
ˆˆ4 5
$str
ˆˆ6 >
)
ˆˆ> ?
;
ˆˆ? @
query
‰‰ 
=
‰‰ 
query
‰‰ !
.
‰‰! "
Replace
‰‰" )
(
‰‰) *
$str
‰‰* /
,
‰‰/ 0
$str
‰‰1 8
)
‰‰8 9
;
‰‰9 :
}
ŠŠ 
else
‹‹ 
if
‹‹ 
(
‹‹ 
fDbProvider
ŒŒ 
==
ŒŒ  "
FDbProvider
ŒŒ# .
.
ŒŒ. /
Oracle
ŒŒ/ 5
||
ŒŒ6 8
fDbProvider
 
==
  "
FDbProvider
# .
.
. /
OracleEx
/ 7
)
 
{
 
query
 
=
 
query
 !
.
! "
Replace
" )
(
) *
$str
* -
,
- .
$str
/ 2
)
2 3
;
3 4
query
‘‘ 
=
‘‘ 
query
‘‘ !
.
‘‘! "
Replace
‘‘" )
(
‘‘) *
$str
‘‘* 4
,
‘‘4 5
$str
‘‘6 ;
)
‘‘; <
;
‘‘< =
query
’’ 
=
’’ 
query
’’ !
.
’’! "
Replace
’’" )
(
’’) *
$str
’’* /
,
’’/ 0
$str
’’1 9
)
’’9 :
;
’’: ;
}
““ 
else
”” 
if
”” 
(
”” 
fDbProvider
”” $
==
””% '
FDbProvider
””( 3
.
””3 4

PostgreSql
””4 >
)
””> ?
{
•• 
query
–– 
=
–– 
query
–– !
.
––! "
Replace
––" )
(
––) *
$str
––* /
,
––/ 0
$str
––1 9
)
––9 :
;
––: ;
}
—— 
}
˜˜ 
catch
™™ 
(
™™ 
	Exception
™™ 
ex
™™ 
)
™™  
{
šš 
FDebug
›› 
.
›› 
throwException
›› %
(
››% &
ex
››& (
)
››( )
;
››) *
}
œœ 
finally
 
{
 
}
   
return
¡¡ 
query
¡¡ 
;
¡¡ 
}
¢¢ 	
public
¦¦ 
static
¦¦ 
string
¦¦ $
exportQueryFromMariaDb
¦¦ 3
(
¦¦3 4
FDbProvider
§§ 
fDbProvider
§§ #
,
§§# $
string
¨¨ 
sql
¨¨ 
)
©© 
{
ªª 	
string
«« 
query
«« 
=
«« 
sql
«« 
;
«« 
try
­­ 
{
®® 
if
¯¯ 
(
¯¯ 
fDbProvider
¯¯ 
==
¯¯  "
FDbProvider
¯¯# .
.
¯¯. /
MsSqlServer
¯¯/ :
)
¯¯: ;
{
°° 
query
±± 
=
±± 
query
±± !
.
±±! "
Replace
±±" )
(
±±) *
$str
±±* 4
,
±±4 5
$str
±±6 >
)
±±> ?
;
±±? @
query
²² 
=
²² 
query
²² !
.
²²! "
Replace
²²" )
(
²²) *
$str
²²* /
,
²²/ 0
$str
²²1 8
)
²²8 9
;
²²9 :
}
³³ 
else
´´ 
if
´´ 
(
´´ 
fDbProvider
µµ 
==
µµ  "
FDbProvider
µµ# .
.
µµ. /
Oracle
µµ/ 5
||
µµ6 8
fDbProvider
¶¶ 
==
¶¶  "
FDbProvider
¶¶# .
.
¶¶. /
OracleEx
¶¶/ 7
)
·· 
{
¸¸ 
query
¹¹ 
=
¹¹ 
query
¹¹ !
.
¹¹! "
Replace
¹¹" )
(
¹¹) *
$str
¹¹* -
,
¹¹- .
$str
¹¹/ 2
)
¹¹2 3
;
¹¹3 4
query
ºº 
=
ºº 
query
ºº !
.
ºº! "
Replace
ºº" )
(
ºº) *
$str
ºº* 4
,
ºº4 5
$str
ºº6 ;
)
ºº; <
;
ºº< =
query
»» 
=
»» 
query
»» !
.
»»! "
Replace
»»" )
(
»») *
$str
»»* /
,
»»/ 0
$str
»»1 9
)
»»9 :
;
»»: ;
}
¼¼ 
else
½½ 
if
½½ 
(
½½ 
fDbProvider
½½ $
==
½½% '
FDbProvider
½½( 3
.
½½3 4

PostgreSql
½½4 >
)
½½> ?
{
¾¾ 
query
¿¿ 
=
¿¿ 
query
¿¿ !
.
¿¿! "
Replace
¿¿" )
(
¿¿) *
$str
¿¿* /
,
¿¿/ 0
$str
¿¿1 9
)
¿¿9 :
;
¿¿: ;
}
ÀÀ 
}
ÁÁ 
catch
ÂÂ 
(
ÂÂ 
	Exception
ÂÂ 
ex
ÂÂ 
)
ÂÂ  
{
ÃÃ 
FDebug
ÄÄ 
.
ÄÄ 
throwException
ÄÄ %
(
ÄÄ% &
ex
ÄÄ& (
)
ÄÄ( )
;
ÄÄ) *
}
ÅÅ 
finally
ÆÆ 
{
ÇÇ 
}
ÉÉ 
return
ÊÊ 
query
ÊÊ 
;
ÊÊ 
}
ËË 	
public
ÏÏ 
static
ÏÏ 
string
ÏÏ '
exportQueryFromPostgreSql
ÏÏ 6
(
ÏÏ6 7
FDbProvider
ĞĞ 
fDbProvider
ĞĞ #
,
ĞĞ# $
string
ÑÑ 
sql
ÑÑ 
)
ÒÒ 
{
ÓÓ 	
string
ÔÔ 
query
ÔÔ 
=
ÔÔ 
sql
ÔÔ 
;
ÔÔ 
try
ÖÖ 
{
×× 
if
ØØ 
(
ØØ 
fDbProvider
ØØ 
==
ØØ  "
FDbProvider
ØØ# .
.
ØØ. /
MsSqlServer
ØØ/ :
)
ØØ: ;
{
ÙÙ 
query
ÚÚ 
=
ÚÚ 
query
ÚÚ !
.
ÚÚ! "
Replace
ÚÚ" )
(
ÚÚ) *
$str
ÚÚ* 4
,
ÚÚ4 5
$str
ÚÚ6 >
)
ÚÚ> ?
;
ÚÚ? @
query
ÛÛ 
=
ÛÛ 
query
ÛÛ !
.
ÛÛ! "
Replace
ÛÛ" )
(
ÛÛ) *
$str
ÛÛ* 2
,
ÛÛ2 3
$str
ÛÛ4 ;
)
ÛÛ; <
;
ÛÛ< =
}
ÜÜ 
else
İİ 
if
İİ 
(
İİ 
fDbProvider
ŞŞ 
==
ŞŞ  "
FDbProvider
ŞŞ# .
.
ŞŞ. /
Oracle
ŞŞ/ 5
||
ŞŞ6 8
fDbProvider
ßß 
==
ßß  "
FDbProvider
ßß# .
.
ßß. /
OracleEx
ßß/ 7
)
àà 
{
áá 
query
ââ 
=
ââ 
query
ââ !
.
ââ! "
Replace
ââ" )
(
ââ) *
$str
ââ* -
,
ââ- .
$str
ââ/ 2
)
ââ2 3
;
ââ3 4
query
ãã 
=
ãã 
query
ãã !
.
ãã! "
Replace
ãã" )
(
ãã) *
$str
ãã* 4
,
ãã4 5
$str
ãã6 ;
)
ãã; <
;
ãã< =
}
ää 
else
åå 
if
åå 
(
åå 
fDbProvider
ææ 
==
ææ  "
FDbProvider
ææ# .
.
ææ. /
MySql
ææ/ 4
||
ææ5 7
fDbProvider
çç 
==
çç  "
FDbProvider
çç# .
.
çç. /
MariaDb
çç/ 6
)
èè 
{
éé 
query
êê 
=
êê 
query
êê !
.
êê! "
Replace
êê" )
(
êê) *
$str
êê* 2
,
êê2 3
$str
êê4 9
)
êê9 :
;
êê: ;
}
ëë 
}
ìì 
catch
íí 
(
íí 
	Exception
íí 
ex
íí 
)
íí  
{
îî 
FDebug
ïï 
.
ïï 
throwException
ïï %
(
ïï% &
ex
ïï& (
)
ïï( )
;
ïï) *
}
ğğ 
finally
ññ 
{
òò 
}
ôô 
return
õõ 
query
õõ 
;
õõ 
}
öö 	
}
üü 
}ıı |
`D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\c_FSqlParameter.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FSqlParameter 
:  
IDisposable! ,
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private   
string   
m_name   
=   
string    &
.  & '
Empty  ' ,
;  , -
private!! 
Type!! 
m_type!! 
=!! 
typeof!! $
(!!$ %
string!!% +
)!!+ ,
;!!, -
private"" 
object"" 
m_value"" 
=""  
DBNull""! '
.""' (
Value""( -
;""- .
public(( 
FSqlParameter(( 
((( 
))) 
{** 	
},, 	
public00 
FSqlParameter00 
(00 
string11 
name11 
)22 
:33 
this33 
(33 
name33 
,33 
DBNull33 
.33  
Value33  %
,33% &
typeof33' -
(33- .
System33. 4
.334 5
DBNull335 ;
)33; <
)33< =
{44 	
}66 	
public:: 
FSqlParameter:: 
(:: 
string;; 
name;; 
,;; 
object<< 
value<< 
)== 
:>> 
this>> 
(>> 
name>> 
,>> 
value>> 
,>> 
value>>  %
.>>% &
GetType>>& -
(>>- .
)>>. /
)>>/ 0
{?? 	
}AA 	
publicEE 
FSqlParameterEE 
(EE 
stringFF 
nameFF 
,FF 
objectGG 
valueGG 
,GG 
TypeHH 
typeHH 
)II 
{JJ 	
m_nameKK 
=KK 
nameKK 
;KK 
m_typeLL 
=LL 
typeLL 
;LL 
thisMM 
.MM 
valueMM 
=MM 
valueMM 
;MM 
}NN 	
~RR 	
FSqlParameterRR	 
(RR 
)SS 
{TT 	
	myDisposeUU 
(UU 
falseUU 
)UU 
;UU 
}VV 	
	protectedZZ 
virtualZZ 
voidZZ 
	myDisposeZZ (
(ZZ( )
bool[[ 
	disposing[[ 
)\\ 
{]] 	
if^^ 
(^^ 
!^^ 

m_disposed^^ 
)^^ 
{__ 
if`` 
(`` 
	disposing`` 
)`` 
{aa 
}cc 
}dd 

m_disposedee 
=ee 
trueee 
;ee 
}ff 	
publicnn 
voidnn 
Disposenn 
(nn 
)oo 
{pp 	
	myDisposeqq 
(qq 
trueqq 
)qq 
;qq 
GCrr 
.rr 
SuppressFinalizerr 
(rr  
thisrr  $
)rr$ %
;rr% &
}ss 	
public{{ 
string{{ 
name{{ 
{|| 	
get}} 
{~~ 
try 
{
€€ 
return
 
m_name
 !
;
! "
}
‚‚ 
catch
ƒƒ 
(
ƒƒ 
	Exception
ƒƒ  
ex
ƒƒ! #
)
ƒƒ# $
{
„„ 
FDebug
…… 
.
…… 
throwException
…… )
(
……) *
ex
……* ,
)
……, -
;
……- .
}
†† 
finally
‡‡ 
{
ˆˆ 
}
ŠŠ 
return
‹‹ 
string
‹‹ 
.
‹‹ 
Empty
‹‹ #
;
‹‹# $
}
ŒŒ 
set
 
{
 
try
 
{
‘‘ 
m_name
’’ 
=
’’ 
value
’’ "
;
’’" #
}
““ 
catch
”” 
(
”” 
	Exception
””  
ex
””! #
)
””# $
{
•• 
FDebug
–– 
.
–– 
throwException
–– )
(
––) *
ex
––* ,
)
––, -
;
––- .
}
—— 
finally
˜˜ 
{
™™ 
}
›› 
}
œœ 
}
 	
public
¡¡ 
bool
¡¡ 
isNull
¡¡ 
{
¢¢ 	
get
££ 
{
¤¤ 
try
¥¥ 
{
¦¦ 
return
§§ 
value
§§  
==
§§! #
DBNull
§§$ *
.
§§* +
Value
§§+ 0
?
§§1 2
true
§§3 7
:
§§8 9
false
§§: ?
;
§§? @
}
¨¨ 
catch
©© 
(
©© 
	Exception
©©  
ex
©©! #
)
©©# $
{
ªª 
FDebug
«« 
.
«« 
throwException
«« )
(
««) *
ex
««* ,
)
««, -
;
««- .
}
¬¬ 
finally
­­ 
{
®® 
}
°° 
return
±± 
false
±± 
;
±± 
}
²² 
}
³³ 	
public
·· 
Type
·· 
type
·· 
{
¸¸ 	
get
¹¹ 
{
ºº 
try
»» 
{
¼¼ 
return
½½ 
m_type
½½ !
;
½½! "
}
¾¾ 
catch
¿¿ 
(
¿¿ 
	Exception
¿¿  
ex
¿¿! #
)
¿¿# $
{
ÀÀ 
FDebug
ÁÁ 
.
ÁÁ 
throwException
ÁÁ )
(
ÁÁ) *
ex
ÁÁ* ,
)
ÁÁ, -
;
ÁÁ- .
}
ÂÂ 
finally
ÃÃ 
{
ÄÄ 
}
ÆÆ 
return
ÇÇ 
null
ÇÇ 
;
ÇÇ 
}
ÈÈ 
set
ÊÊ 
{
ËË 
try
ÌÌ 
{
ÍÍ 
m_type
ÎÎ 
=
ÎÎ 
value
ÎÎ "
;
ÎÎ" #
}
ÏÏ 
catch
ĞĞ 
(
ĞĞ 
	Exception
ĞĞ  
ex
ĞĞ! #
)
ĞĞ# $
{
ÑÑ 
FDebug
ÒÒ 
.
ÒÒ 
throwException
ÒÒ )
(
ÒÒ) *
ex
ÒÒ* ,
)
ÒÒ, -
;
ÒÒ- .
}
ÓÓ 
finally
ÔÔ 
{
ÕÕ 
}
×× 
}
ØØ 
}
ÙÙ 	
public
İİ 
object
İİ 
value
İİ 
{
ŞŞ 	
get
ßß 
{
àà 
try
áá 
{
ââ 
return
ãã 
m_value
ãã "
;
ãã" #
}
ää 
catch
åå 
(
åå 
	Exception
åå  
ex
åå! #
)
åå# $
{
ææ 
FDebug
çç 
.
çç 
throwException
çç )
(
çç) *
ex
çç* ,
)
çç, -
;
çç- .
}
èè 
finally
éé 
{
êê 
}
ìì 
return
íí 
null
íí 
;
íí 
}
îî 
set
ğğ 
{
ññ 
try
òò 
{
óó 
if
ôô 
(
ôô 
m_type
ôô 
==
ôô !
typeof
ôô" (
(
ôô( )
string
ôô) /
)
ôô/ 0
&&
ôô1 3
(
ôô4 5
string
ôô5 ;
)
ôô; <
value
ôô< A
==
ôôB D
string
ôôE K
.
ôôK L
Empty
ôôL Q
)
ôôQ R
{
õõ 
m_value
öö 
=
öö  !
$str
öö" %
;
öö% &
}
÷÷ 
else
øø 
{
ùù 
m_value
úú 
=
úú  !
value
úú" '
;
úú' (
}
ûû 
}
üü 
catch
ıı 
(
ıı 
	Exception
ıı  
ex
ıı! #
)
ıı# $
{
şş 
FDebug
ÿÿ 
.
ÿÿ 
throwException
ÿÿ )
(
ÿÿ) *
ex
ÿÿ* ,
)
ÿÿ, -
;
ÿÿ- .
}
€€ 
finally
 
{
‚‚ 
}
„„ 
}
…… 
}
†† 	
internal
ŠŠ 
SqlParameter
ŠŠ 
sqlParameter
ŠŠ *
{
‹‹ 	
get
ŒŒ 
{
 
SqlParameter
 
sqlPar
 #
=
$ %
null
& *
;
* +
try
 
{
‘‘ 
sqlPar
’’ 
=
’’ 
new
’’  
SqlParameter
’’! -
(
’’- .
)
’’. /
;
’’/ 0
sqlPar
““ 
.
““ 
ParameterName
““ (
=
““) *
m_name
““+ 1
;
““1 2
sqlPar
”” 
.
”” 
Value
””  
=
””! "
m_value
””# *
;
””* +
return
•• 
sqlPar
•• !
;
••! "
}
–– 
catch
—— 
(
—— 
	Exception
——  
ex
——! #
)
——# $
{
˜˜ 
FDebug
™™ 
.
™™ 
throwException
™™ )
(
™™) *
ex
™™* ,
)
™™, -
;
™™- .
}
šš 
finally
›› 
{
œœ 
}
 
return
ŸŸ 
null
ŸŸ 
;
ŸŸ 
}
   
}
¡¡ 	
internal
¥¥ 
System
¥¥ 
.
¥¥ 
Data
¥¥ 
.
¥¥ 
OracleClient
¥¥ )
.
¥¥) *
OracleParameter
¥¥* 9
oracleParameter
¥¥: I
{
¦¦ 	
get
§§ 
{
¨¨ 
System
©© 
.
©© 
Data
©© 
.
©© 
OracleClient
©© (
.
©©( )
OracleParameter
©©) 8
oraPar
©©9 ?
=
©©@ A
null
©©B F
;
©©F G
try
«« 
{
¬¬ 
oraPar
­­ 
=
­­ 
new
­­  
System
­­! '
.
­­' (
Data
­­( ,
.
­­, -
OracleClient
­­- 9
.
­­9 :
OracleParameter
­­: I
(
­­I J
)
­­J K
;
­­K L
oraPar
®® 
.
®® 
ParameterName
®® (
=
®®) *
m_name
®®+ 1
;
®®1 2
oraPar
¯¯ 
.
¯¯ 
Value
¯¯  
=
¯¯! "
m_value
¯¯# *
;
¯¯* +
return
°° 
oraPar
°° !
;
°°! "
}
±± 
catch
²² 
(
²² 
	Exception
²²  
ex
²²! #
)
²²# $
{
³³ 
FDebug
´´ 
.
´´ 
throwException
´´ )
(
´´) *
ex
´´* ,
)
´´, -
;
´´- .
}
µµ 
finally
¶¶ 
{
·· 
}
¹¹ 
return
ºº 
null
ºº 
;
ºº 
}
»» 
}
¼¼ 	
internal
ÀÀ 
Oracle
ÀÀ 
.
ÀÀ 
ManagedDataAccess
ÀÀ )
.
ÀÀ) *
Client
ÀÀ* 0
.
ÀÀ0 1
OracleParameter
ÀÀ1 @
oracleExParameter
ÀÀA R
{
ÁÁ 	
get
ÂÂ 
{
ÃÃ 
Oracle
ÄÄ 
.
ÄÄ 
ManagedDataAccess
ÄÄ (
.
ÄÄ( )
Client
ÄÄ) /
.
ÄÄ/ 0
OracleParameter
ÄÄ0 ?
oraPar
ÄÄ@ F
=
ÄÄG H
null
ÄÄI M
;
ÄÄM N
try
ÆÆ 
{
ÇÇ 
oraPar
ÈÈ 
=
ÈÈ 
new
ÈÈ  
Oracle
ÈÈ! '
.
ÈÈ' (
ManagedDataAccess
ÈÈ( 9
.
ÈÈ9 :
Client
ÈÈ: @
.
ÈÈ@ A
OracleParameter
ÈÈA P
(
ÈÈP Q
)
ÈÈQ R
;
ÈÈR S
oraPar
ÉÉ 
.
ÉÉ 
ParameterName
ÉÉ (
=
ÉÉ) *
m_name
ÉÉ+ 1
;
ÉÉ1 2
oraPar
ÊÊ 
.
ÊÊ 
Value
ÊÊ  
=
ÊÊ! "
m_value
ÊÊ# *
;
ÊÊ* +
return
ËË 
oraPar
ËË !
;
ËË! "
}
ÌÌ 
catch
ÍÍ 
(
ÍÍ 
	Exception
ÍÍ  
ex
ÍÍ! #
)
ÍÍ# $
{
ÎÎ 
FDebug
ÏÏ 
.
ÏÏ 
throwException
ÏÏ )
(
ÏÏ) *
ex
ÏÏ* ,
)
ÏÏ, -
;
ÏÏ- .
}
ĞĞ 
finally
ÑÑ 
{
ÒÒ 
}
ÔÔ 
return
ÕÕ 
null
ÕÕ 
;
ÕÕ 
}
ÖÖ 
}
×× 	
internal
ÛÛ 
MySqlParameter
ÛÛ 
mySqlParameter
ÛÛ  .
{
ÜÜ 	
get
İİ 
{
ŞŞ 
MySqlParameter
ßß 
mysPar
ßß %
=
ßß& '
null
ßß( ,
;
ßß, -
try
áá 
{
ââ 
mysPar
ãã 
=
ãã 
new
ãã  
MySqlParameter
ãã! /
(
ãã/ 0
)
ãã0 1
;
ãã1 2
mysPar
ää 
.
ää 
ParameterName
ää (
=
ää) *
m_name
ää+ 1
;
ää1 2
mysPar
åå 
.
åå 
Value
åå  
=
åå! "
m_value
åå# *
;
åå* +
return
ææ 
mysPar
ææ !
;
ææ! "
}
çç 
catch
èè 
(
èè 
	Exception
èè  
ex
èè! #
)
èè# $
{
éé 
FDebug
êê 
.
êê 
throwException
êê )
(
êê) *
ex
êê* ,
)
êê, -
;
êê- .
}
ëë 
finally
ìì 
{
íí 
}
ïï 
return
ğğ 
null
ğğ 
;
ğğ 
}
ññ 
}
òò 	
internal
öö 
MySqlParameter
öö 
mariaDbParameter
öö  0
{
÷÷ 	
get
øø 
{
ùù 
MySqlParameter
úú 
marPar
úú %
=
úú& '
null
úú( ,
;
úú, -
try
üü 
{
ıı 
marPar
şş 
=
şş 
new
şş  
MySqlParameter
şş! /
(
şş/ 0
)
şş0 1
;
şş1 2
marPar
ÿÿ 
.
ÿÿ 
ParameterName
ÿÿ (
=
ÿÿ) *
m_name
ÿÿ+ 1
;
ÿÿ1 2
marPar
€€ 
.
€€ 
Value
€€  
=
€€! "
m_value
€€# *
;
€€* +
return
 
marPar
 !
;
! "
}
‚‚ 
catch
ƒƒ 
(
ƒƒ 
	Exception
ƒƒ  
ex
ƒƒ! #
)
ƒƒ# $
{
„„ 
FDebug
…… 
.
…… 
throwException
…… )
(
……) *
ex
……* ,
)
……, -
;
……- .
}
†† 
finally
‡‡ 
{
ˆˆ 
}
ŠŠ 
return
‹‹ 
null
‹‹ 
;
‹‹ 
}
ŒŒ 
}
 	
internal
‘‘ 
NpgsqlParameter
‘‘  
pgSqlParameter
‘‘! /
{
’’ 	
get
““ 
{
”” 
NpgsqlParameter
•• 
pgsPar
••  &
=
••' (
null
••) -
;
••- .
try
—— 
{
˜˜ 
pgsPar
™™ 
=
™™ 
new
™™  
NpgsqlParameter
™™! 0
(
™™0 1
)
™™1 2
;
™™2 3
pgsPar
šš 
.
šš 
ParameterName
šš (
=
šš) *
m_name
šš+ 1
;
šš1 2
pgsPar
›› 
.
›› 
Value
››  
=
››! "
m_value
››# *
;
››* +
return
œœ 
pgsPar
œœ !
;
œœ! "
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
ŸŸ 
FDebug
   
.
   
throwException
   )
(
  ) *
ex
  * ,
)
  , -
;
  - .
}
¡¡ 
finally
¢¢ 
{
££ 
}
¥¥ 
return
¦¦ 
null
¦¦ 
;
¦¦ 
}
§§ 
}
¨¨ 	
}
´´ 
}µµ Î	
bD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\i_FIQueryExecutor.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

	interface 
FIQueryExecutor $
{ 
int 
sqlCount 
{ 	
get 
; 
} 	
FSqlCollection"" 
sqlCollection"" $
{## 	
get$$ 
;$$ 
}%% 	
void-- 
	appendSql-- 
(-- 
FSql.. 
sql.. 
)// 
;// 
DataSet33 
execute33 
(33 
int44 
timeout44 
,44 
bool55 
sqlClear55 
)66 
;66 
DataSet:: 
execute:: 
(:: 
int;; 
tiemout;; 
)<< 
;<< 
DataSet@@ 
execute@@ 
(@@ 
boolAA 
sqlClearAA 
)BB 
;BB 
DataSetFF 
executeFF 
(FF 
)GG 
;GG 
}MM 
}NN Ä	
eD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\i_FITransactExecutor.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

	interface 
FITransactExecutor '
{ 
int 
sqlCount 
{ 	
get 
; 
} 	
FSqlCollection!! 
sqlCollection!! $
{"" 	
get## 
;## 
}$$ 	
void,, 
	appendSql,, 
(,, 
FSql-- 
sql-- 
).. 
;.. 
int22 
execute22 
(22 
int33 
timeout33 
,33 
bool44 
sqlClear44 
)55 
;55 
int99 
execute99 
(99 
int:: 
tiemout:: 
);; 
;;; 
int?? 
execute?? 
(?? 
bool@@ 
sqlClear@@ 
)AA 
;AA 
intEE 
executeEE 
(EE 
)FF 
;FF 
}LL 
}MM ÷j
jD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\MsSql\c_FMssQueryExecutor.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FMssQueryExecutor "
:# $
FBaseExecutor% 2
,2 3
FIQueryExecutor4 C
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
internal!! 
FMssQueryExecutor!! "
(!!" #
)"" 
:## 
base## 
(## 
)## 
{$$ 	
}&& 	
internal** 
FMssQueryExecutor** "
(**" #
string++ 
connectString++  
),, 
:-- 
base-- 
(-- 
connectString--  
)--  !
{.. 	
}00 	
~44 	
FMssQueryExecutor44	 
(44 
)55 
{66 	
	myDispose77 
(77 
false77 
)77 
;77 
}88 	
	protected<< 
override<< 
void<< 
	myDispose<<  )
(<<) *
bool== 
	disposing== 
)>> 
{?? 	
if@@ 
(@@ 
!@@ 

m_disposed@@ 
)@@ 
{AA 
ifBB 
(BB 
	disposingBB 
)BB 
{CC 
}EE 

m_disposedFF 
=FF 
trueFF !
;FF! "
baseJJ 
.JJ 
	myDisposeJJ 
(JJ 
	disposingJJ (
)JJ( )
;JJ) *
}KK 
}LL 	
publicZZ 
DataSetZZ 
executeZZ 
(ZZ 
int[[ 
timeout[[ 
,[[ 
bool\\ 
sqlClear\\ 
)]] 
{^^ 	
SqlConnection__ 
sqlCon__  
=__! "
null__# '
;__' (

SqlCommand`` 
sqlCmd`` 
=`` 
null``  $
;``$ %
SqlDataAdapteraa 
sqlAdtaa !
=aa" #
nullaa$ (
;aa( )
DataSetbb 
tempDsbb 
=bb 
nullbb !
;bb! "
DataSetcc 
dscc 
=cc 
nullcc 
;cc 
	DataTabledd 
dtdd 
=dd 
nulldd 
;dd  
FSqlErrorCollectionee 

fSqlErrorsee  *
=ee+ ,
nullee- 1
;ee1 2
FSqlErrorTypeff 
fSqlErrorTypeff '
=ff( )
FSqlErrorTypeff* 7
.ff7 8
Normalff8 >
;ff> ?
stringhh 
systemhh 
=hh 
stringhh "
.hh" #
Emptyhh# (
;hh( )
stringii 
moduleii 
=ii 
stringii "
.ii" #
Emptyii# (
;ii( )
stringjj 
functionjj 
=jj 
stringjj $
.jj$ %
Emptyjj% *
;jj* +
stringkk 
sqlCodekk 
=kk 
stringkk #
.kk# $
Emptykk$ )
;kk) *
stringll 
errorMessagell 
=ll  !
stringll" (
.ll( )
Emptyll) .
;ll. /
usingnn 
(nn 
sqlConnn 
=nn 
newnn 
SqlConnectionnn  -
(nn- .
basenn. 2
.nn2 3
connectionStringnn3 C
)nnC D
)nnD E
{oo 
trypp 
{qq 
ifrr 
(rr 
baserr 
.rr 
sqlListrr $
.rr$ %
Countrr% *
==rr+ -
$numrr. /
)rr/ 0
{ss 
FDebugtt 
.tt 
throwFExceptiontt .
(tt. /
stringtt/ 5
.tt5 6
Formattt6 <
(tt< =

FConstantstt= G
.ttG H

err_m_0003ttH R
,ttR S
$strttT ^
)tt^ _
)tt_ `
;tt` a
}uu 
sqlCmdyy 
=yy 
sqlConyy #
.yy# $
CreateCommandyy$ 1
(yy1 2
)yy2 3
;yy3 4
sqlCmdzz 
.zz 
CommandTimeoutzz )
=zz* +
timeoutzz, 3
;zz3 4
sqlCmd{{ 
.{{ 

Connection{{ %
={{& '
sqlCon{{( .
;{{. /
ds|| 
=|| 
new|| 
DataSet|| $
(||$ %
)||% &
;||& '
tempDs}} 
=}} 
new}}  
DataSet}}! (
(}}( )
)}}) *
;}}* +
foreach
 
(
 
FSql
 !
fsql
" &
in
' )
base
* .
.
. /
sqlList
/ 6
)
6 7
{
‚‚ 
system
ƒƒ 
=
ƒƒ  
fsql
ƒƒ! %
.
ƒƒ% &
system
ƒƒ& ,
;
ƒƒ, -
module
„„ 
=
„„  
fsql
„„! %
.
„„% &
module
„„& ,
;
„„, -
function
……  
=
……! "
fsql
……# '
.
……' (
function
……( 0
;
……0 1
sqlCode
†† 
=
††  !
fsql
††" &
.
††& '
sqlCode
††' .
;
††. /
sqlCmd
 
.
 
CommandText
 *
=
+ ,
fsql
- 1
.
1 2
sqlEx
2 7
;
7 8
foreach
 
(
  !
FSqlParameter
! .
sqlPar
/ 5
in
6 8
fsql
9 =
.
= >$
sqlParameterCollection
> T
)
T U
{
 
sqlCmd
‘‘ "
.
‘‘" #

Parameters
‘‘# -
.
‘‘- .
Add
‘‘. 1
(
‘‘1 2
sqlPar
‘‘2 8
.
‘‘8 9
sqlParameter
‘‘9 E
)
‘‘E F
;
‘‘F G
}
’’ 
sqlAdt
““ 
=
““  
new
““! $
SqlDataAdapter
““% 3
(
““3 4
sqlCmd
““4 :
)
““: ;
;
““; <
sqlAdt
”” 
.
”” 
Fill
”” #
(
””# $
tempDs
””$ *
)
””* +
;
””+ ,
sqlCmd
•• 
.
•• 

Parameters
•• )
.
••) *
Clear
••* /
(
••/ 0
)
••0 1
;
••1 2
dt
™™ 
=
™™ 
tempDs
™™ #
.
™™# $
Tables
™™$ *
[
™™* +
$num
™™+ ,
]
™™, -
;
™™- .
tempDs
šš 
.
šš 
Tables
šš %
.
šš% &
Remove
šš& ,
(
šš, -
dt
šš- /
)
šš/ 0
;
šš0 1
tempDs
›› 
.
›› 
Clear
›› $
(
››$ %
)
››% &
;
››& '
dt
ŸŸ 
.
ŸŸ 
	TableName
ŸŸ $
=
ŸŸ% &
fsql
ŸŸ' +
.
ŸŸ+ ,
name
ŸŸ, 0
;
ŸŸ0 1
ds
   
.
   
Tables
   !
.
  ! "
Add
  " %
(
  % &
dt
  & (
)
  ( )
;
  ) *
}
¡¡ 
if
¥¥ 
(
¥¥ 
sqlClear
¥¥  
)
¥¥  !
{
¦¦ 
base
§§ 
.
§§ 
clearSql
§§ %
(
§§% &
)
§§& '
;
§§' (
}
¨¨ 
return
©© 
ds
©© 
;
©© 
}
ªª 
catch
«« 
(
«« 
SqlException
«« #
sqlEx
««$ )
)
««) *
{
¬¬ 
FDebug
­­ 
.
­­ 
writeLog
­­ #
(
­­# $
sqlEx
­­$ )
)
­­) *
;
­­* +

fSqlErrors
±± 
=
±±  

FDbAdapter
±±! +
.
±±+ ,
createSqlErrors
±±, ;
(
±±; <
sqlEx
±±< A
)
±±A B
;
±±B C
fSqlErrorType
²² !
=
²²" #

FDbAdapter
²²$ .
.
²². /*
getSqlErrorTypeOfMsSqlServer
²²/ K
(
²²K L

fSqlErrors
²²L V
)
²²V W
;
²²W X
errorMessage
´´  
=
´´! "
sqlEx
µµ 
.
µµ 
Message
µµ %
+
µµ& '
Environment
µµ( 3
.
µµ3 4
NewLine
µµ4 ;
+
µµ< =
$str
¶¶ "
+
¶¶# $
system
¶¶% +
+
¶¶, -
$str
¶¶. ;
+
¶¶< =
module
¶¶> D
+
¶¶E F
$str
¶¶G V
+
¶¶W X
function
¶¶Y a
+
¶¶b c
$str
¶¶d r
+
¶¶s t
sqlCode
¶¶u |
+
¶¶} ~
$str¶¶ ‚
;¶¶‚ ƒ
FDebug
¸¸ 
.
¸¸ 
throwException
¸¸ )
(
¸¸) *
new
¸¸* -
FDbException
¸¸. :
(
¸¸: ;
fSqlErrorType
¸¸; H
,
¸¸H I

fSqlErrors
¸¸J T
,
¸¸T U
errorMessage
¸¸V b
,
¸¸b c
sqlEx
¸¸d i
)
¸¸i j
)
¸¸j k
;
¸¸k l
}
¹¹ 
catch
ºº 
(
ºº 
	Exception
ºº  
ex
ºº! #
)
ºº# $
{
»» 
FDebug
¼¼ 
.
¼¼ 
throwException
¼¼ )
(
¼¼) *
ex
¼¼* ,
)
¼¼, -
;
¼¼- .
}
½½ 
finally
¾¾ 
{
¿¿ 
if
ÀÀ 
(
ÀÀ 
sqlAdt
ÀÀ 
!=
ÀÀ !
null
ÀÀ" &
)
ÀÀ& '
{
ÁÁ 
sqlAdt
ÂÂ 
.
ÂÂ 
Dispose
ÂÂ &
(
ÂÂ& '
)
ÂÂ' (
;
ÂÂ( )
sqlAdt
ÃÃ 
=
ÃÃ  
null
ÃÃ! %
;
ÃÃ% &
}
ÄÄ 
if
ÆÆ 
(
ÆÆ 
sqlCmd
ÆÆ 
!=
ÆÆ !
null
ÆÆ" &
)
ÆÆ& '
{
ÇÇ 
sqlCmd
ÈÈ 
.
ÈÈ 
Dispose
ÈÈ &
(
ÈÈ& '
)
ÈÈ' (
;
ÈÈ( )
sqlCmd
ÉÉ 
=
ÉÉ  
null
ÉÉ! %
;
ÉÉ% &
}
ÊÊ 
if
ÌÌ 
(
ÌÌ 
tempDs
ÌÌ 
!=
ÌÌ !
null
ÌÌ" &
)
ÌÌ& '
{
ÍÍ 
tempDs
ÎÎ 
.
ÎÎ 
Dispose
ÎÎ &
(
ÎÎ& '
)
ÎÎ' (
;
ÎÎ( )
tempDs
ÏÏ 
=
ÏÏ  
null
ÏÏ! %
;
ÏÏ% &
}
ĞĞ 
if
ÒÒ 
(
ÒÒ 
sqlCon
ÒÒ 
!=
ÒÒ !
null
ÒÒ" &
)
ÒÒ& '
{
ÓÓ 
if
ÔÔ 
(
ÔÔ 
sqlCon
ÔÔ "
.
ÔÔ" #
State
ÔÔ# (
!=
ÔÔ) +
ConnectionState
ÔÔ, ;
.
ÔÔ; <
Closed
ÔÔ< B
)
ÔÔB C
{
ÕÕ 
sqlCon
ÖÖ "
.
ÖÖ" #
Close
ÖÖ# (
(
ÖÖ( )
)
ÖÖ) *
;
ÖÖ* +
}
×× 
sqlCon
ØØ 
.
ØØ 
Dispose
ØØ &
(
ØØ& '
)
ØØ' (
;
ØØ( )
sqlCon
ÙÙ 
=
ÙÙ  
null
ÙÙ! %
;
ÙÙ% &
}
ÚÚ 

fSqlErrors
ÜÜ 
=
ÜÜ  
null
ÜÜ! %
;
ÜÜ% &
}
İİ 
return
ßß 
null
ßß 
;
ßß 
}
àà 
}
áá 	
public
åå 
DataSet
åå 
execute
åå 
(
åå 
int
ææ 
timeout
ææ 
)
çç 
{
èè 	
try
éé 
{
êê 
return
ëë 
execute
ëë 
(
ëë 
timeout
ëë &
,
ëë& '
true
ëë( ,
)
ëë, -
;
ëë- .
}
ìì 
catch
íí 
(
íí 
	Exception
íí 
ex
íí 
)
íí 
{
îî 
FDebug
ïï 
.
ïï 
throwException
ïï %
(
ïï% &
ex
ïï& (
)
ïï( )
;
ïï) *
}
ğğ 
finally
ññ 
{
òò 
}
ôô 
return
õõ 
null
õõ 
;
õõ 
}
öö 	
public
úú 
DataSet
úú 
execute
úú 
(
úú 
bool
ûû 
sqlClear
ûû 
)
üü 
{
ıı 	
try
şş 
{
ÿÿ 
return
€€ 
execute
€€ 
(
€€ 
base
€€ #
.
€€# $
timeout
€€$ +
,
€€+ ,
sqlClear
€€- 5
)
€€5 6
;
€€6 7
}
 
catch
‚‚ 
(
‚‚ 
	Exception
‚‚ 
ex
‚‚ 
)
‚‚  
{
ƒƒ 
FDebug
„„ 
.
„„ 
throwException
„„ %
(
„„% &
ex
„„& (
)
„„( )
;
„„) *
}
…… 
finally
†† 
{
‡‡ 
}
‰‰ 
return
ŠŠ 
null
ŠŠ 
;
ŠŠ 
}
‹‹ 	
public
 
DataSet
 
execute
 
(
 
)
 
{
‘‘ 	
try
’’ 
{
““ 
return
”” 
execute
”” 
(
”” 
base
”” #
.
””# $
timeout
””$ +
,
””+ ,
true
””- 1
)
””1 2
;
””2 3
}
•• 
catch
–– 
(
–– 
	Exception
–– 
ex
–– 
)
––  
{
—— 
FDebug
˜˜ 
.
˜˜ 
throwException
˜˜ %
(
˜˜% &
ex
˜˜& (
)
˜˜( )
;
˜˜) *
}
™™ 
finally
šš 
{
›› 
}
 
return
 
null
 
;
 
}
ŸŸ 	
}
¥¥ 
}¦¦ ów
mD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\MsSql\c_FMssTransactExecutor.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
class 	 
FMssTransactExecutor
 
:  
FBaseExecutor! .
,. /
FITransactExecutor0 B
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
internal    
FMssTransactExecutor   %
(  % &
)!! 
:"" 
base"" 
("" 
)"" 
{## 	
}%% 	
internal))  
FMssTransactExecutor)) %
())% &
string** 
connectString**  
)++ 
:,, 
base,, 
(,, 
connectString,,  
),,  !
{-- 	
}// 	
~33 	 
FMssTransactExecutor33	 
(33 
)44 
{55 	
	myDispose66 
(66 
false66 
)66 
;66 
}77 	
	protected99 
override99 
void99 
	myDispose99  )
(99) *
bool:: 
	disposing:: 
);; 
{<< 	
if== 
(== 
!== 

m_disposed== 
)== 
{>> 
if?? 
(?? 
	disposing?? 
)?? 
{@@ 
}BB 

m_disposedCC 
=CC 
trueCC !
;CC! "
baseGG 
.GG 
	myDisposeGG 
(GG 
	disposingGG (
)GG( )
;GG) *
}HH 
}II 	
publicWW 
intWW 
executeWW 
(WW 
intXX 
timeoutXX 
,XX 
boolYY 
sqlClearYY 
)ZZ 
{[[ 	
SqlConnection\\ 
sqlCon\\  
=\\! "
null\\# '
;\\' (
SqlTransaction]] 
sqlTran]] "
=]]# $
null]]% )
;]]) *

SqlCommand^^ 
sqlCmd^^ 
=^^ 
null^^  $
;^^$ %
int__ 
rowCount__ 
=__ 
$num__ 
;__ 
int`` 
retryCnt`` 
=`` 
$num`` 
;`` 
FSqlErrorCollectionaa 

fSqlErrorsaa  *
=aa+ ,
nullaa- 1
;aa1 2
FSqlErrorTypebb 
fSqlErrorTypebb '
=bb( )
FSqlErrorTypebb* 7
.bb7 8
Normalbb8 >
;bb> ?
stringdd 
systemdd 
=dd 
stringdd "
.dd" #
Emptydd# (
;dd( )
stringee 
moduleee 
=ee 
stringee "
.ee" #
Emptyee# (
;ee( )
stringff 
functionff 
=ff 
stringff $
.ff$ %
Emptyff% *
;ff* +
stringgg 
sqlCodegg 
=gg 
stringgg #
.gg# $
Emptygg$ )
;gg) *
stringhh 
errorMessagehh 
=hh  !
stringhh" (
.hh( )
Emptyhh) .
;hh. /
usingjj 
(jj 
sqlConjj 
=jj 
newjj 
SqlConnectionjj  -
(jj- .
basejj. 2
.jj2 3
connectionStringjj3 C
)jjC D
)jjD E
{kk 
tryll 
{mm 
ifnn 
(nn 
basenn 
.nn 
sqlListnn $
.nn$ %
Countnn% *
==nn+ -
$numnn. /
)nn/ 0
{oo 
FDebugpp 
.pp 
throwFExceptionpp .
(pp. /
stringpp/ 5
.pp5 6
Formatpp6 <
(pp< =

FConstantspp= G
.ppG H

err_m_0003ppH R
,ppR S
$strppT ^
)pp^ _
)pp_ `
;pp` a
}qq 
sqlConuu 
.uu 
Openuu 
(uu  
)uu  !
;uu! "
whilevv 
(vv 
truevv 
)vv  
{ww 
tryxx 
{yy 
rowCountzz $
=zz% &
$numzz' (
;zz( )
sqlTran{{ #
={{$ %
sqlCon{{& ,
.{{, -
BeginTransaction{{- =
({{= >
){{> ?
;{{? @
sqlCmd|| "
=||# $
sqlCon||% +
.||+ ,
CreateCommand||, 9
(||9 :
)||: ;
;||; <
sqlCmd}} "
.}}" #

Connection}}# -
=}}. /
sqlCon}}0 6
;}}6 7
sqlCmd~~ "
.~~" #
Transaction~~# .
=~~/ 0
sqlTran~~1 8
;~~8 9
sqlCmd "
." #
CommandTimeout# 1
=2 3
timeout4 ;
;; <
foreach
ƒƒ #
(
ƒƒ$ %
FSql
ƒƒ% )
fsql
ƒƒ* .
in
ƒƒ/ 1
base
ƒƒ2 6
.
ƒƒ6 7
sqlList
ƒƒ7 >
)
ƒƒ> ?
{
„„ 
system
……  &
=
……' (
fsql
……) -
.
……- .
system
……. 4
;
……4 5
module
††  &
=
††' (
fsql
††) -
.
††- .
module
††. 4
;
††4 5
function
‡‡  (
=
‡‡) *
fsql
‡‡+ /
.
‡‡/ 0
function
‡‡0 8
;
‡‡8 9
sqlCode
ˆˆ  '
=
ˆˆ( )
fsql
ˆˆ* .
.
ˆˆ. /
sqlCode
ˆˆ/ 6
;
ˆˆ6 7
sqlCmd
  &
.
& '
CommandText
' 2
=
3 4
fsql
5 9
.
9 :
sqlEx
: ?
;
? @
foreach
‘‘  '
(
‘‘( )
FSqlParameter
‘‘) 6
sqlPar
‘‘7 =
in
‘‘> @
fsql
‘‘A E
.
‘‘E F$
sqlParameterCollection
‘‘F \
)
‘‘\ ]
{
’’  !
sqlCmd
““$ *
.
““* +

Parameters
““+ 5
.
““5 6
Add
““6 9
(
““9 :
sqlPar
““: @
.
““@ A
sqlParameter
““A M
)
““M N
;
““N O
}
””  !
rowCount
••  (
+=
••) +
sqlCmd
••, 2
.
••2 3
ExecuteNonQuery
••3 B
(
••B C
)
••C D
;
••D E
sqlCmd
––  &
.
––& '

Parameters
––' 1
.
––1 2
Clear
––2 7
(
––7 8
)
––8 9
;
––9 :
}
—— 
sqlTran
›› #
.
››# $
Commit
››$ *
(
››* +
)
››+ ,
;
››, -
break
œœ !
;
œœ! "
}
 
catch
 
(
 
SqlException
 +
sqlEx
, 1
)
1 2
{
ŸŸ 
FDebug
   "
.
  " #
writeLog
  # +
(
  + ,
sqlEx
  , 1
)
  1 2
;
  2 3

fSqlErrors
¤¤ &
=
¤¤' (

FDbAdapter
¤¤) 3
.
¤¤3 4
createSqlErrors
¤¤4 C
(
¤¤C D
sqlEx
¤¤D I
)
¤¤I J
;
¤¤J K
if
¬¬ 
(
¬¬  

fSqlErrors
¬¬  *
.
¬¬* +
containsErrorCode
¬¬+ <
(
¬¬< =
FDbErrorCode
¬¬= I
.
¬¬I J
	SQL_01205
¬¬J S
)
¬¬S T
&&
¬¬U W
retryCnt
¬¬X `
<
¬¬a b
$num
¬¬c e
)
¬¬e f
{
­­ 
System
®®  &
.
®®& '
Diagnostics
®®' 2
.
®®2 3
Debug
®®3 8
.
®®8 9
	WriteLine
®®9 B
(
®®B C
$str
®®C R
)
®®R S
;
®®S T
if
²²  "
(
²²# $
sqlTran
²²$ +
!=
²², .
null
²²/ 3
)
²²3 4
{
³³  !
sqlTran
´´$ +
.
´´+ ,
Rollback
´´, 4
(
´´4 5
)
´´5 6
;
´´6 7
sqlTran
µµ$ +
.
µµ+ ,
Dispose
µµ, 3
(
µµ3 4
)
µµ4 5
;
µµ5 6
sqlTran
¶¶$ +
=
¶¶, -
null
¶¶. 2
;
¶¶2 3
}
··  !
if
¹¹  "
(
¹¹# $
sqlCmd
¹¹$ *
!=
¹¹+ -
null
¹¹. 2
)
¹¹2 3
{
ºº  !
sqlCmd
»»$ *
.
»»* +
Dispose
»»+ 2
(
»»2 3
)
»»3 4
;
»»4 5
sqlCmd
¼¼$ *
=
¼¼+ ,
null
¼¼- 1
;
¼¼1 2
}
½½  !
retryCnt
ÁÁ  (
++
ÁÁ( *
;
ÁÁ* +
System
ÂÂ  &
.
ÂÂ& '
	Threading
ÂÂ' 0
.
ÂÂ0 1
Thread
ÂÂ1 7
.
ÂÂ7 8
Sleep
ÂÂ8 =
(
ÂÂ= >
$num
ÂÂ> @
)
ÂÂ@ A
;
ÂÂA B
}
ÃÃ 
else
ÄÄ  
{
ÅÅ 
fSqlErrorType
ÆÆ  -
=
ÆÆ. /

FDbAdapter
ÆÆ0 :
.
ÆÆ: ;*
getSqlErrorTypeOfMsSqlServer
ÆÆ; W
(
ÆÆW X

fSqlErrors
ÆÆX b
)
ÆÆb c
;
ÆÆc d
errorMessage
ÈÈ  ,
=
ÈÈ- .
sqlEx
ÉÉ$ )
.
ÉÉ) *
Message
ÉÉ* 1
+
ÉÉ2 3
Environment
ÉÉ4 ?
.
ÉÉ? @
NewLine
ÉÉ@ G
+
ÉÉH I
$str
ÊÊ$ .
+
ÊÊ/ 0
system
ÊÊ1 7
+
ÊÊ8 9
$str
ÊÊ: G
+
ÊÊH I
module
ÊÊJ P
+
ÊÊQ R
$str
ÊÊS b
+
ÊÊc d
function
ÊÊe m
+
ÊÊn o
$str
ÊÊp ~
+ÊÊ €
sqlCodeÊÊ ˆ
+ÊÊ‰ Š
$strÊÊ‹ 
;ÊÊ 
FDebug
ÌÌ  &
.
ÌÌ& '
throwException
ÌÌ' 5
(
ÌÌ5 6
new
ÌÌ6 9
FDbException
ÌÌ: F
(
ÌÌF G
fSqlErrorType
ÌÌG T
,
ÌÌT U

fSqlErrors
ÌÌV `
,
ÌÌ` a
errorMessage
ÌÌb n
,
ÌÌn o
sqlEx
ÌÌp u
)
ÌÌu v
)
ÌÌv w
;
ÌÌw x
}
ÍÍ 
}
ÎÎ 
catch
ÏÏ 
(
ÏÏ 
	Exception
ÏÏ (
ex
ÏÏ) +
)
ÏÏ+ ,
{
ĞĞ 
FDebug
ÑÑ "
.
ÑÑ" #
throwException
ÑÑ# 1
(
ÑÑ1 2
ex
ÑÑ2 4
)
ÑÑ4 5
;
ÑÑ5 6
}
ÒÒ 
finally
ÓÓ 
{
ÔÔ 
}
ÖÖ 
}
×× 
if
ÛÛ 
(
ÛÛ 
sqlClear
ÛÛ  
)
ÛÛ  !
{
ÜÜ 
base
İİ 
.
İİ 
clearSql
İİ %
(
İİ% &
)
İİ& '
;
İİ' (
}
ŞŞ 
return
ßß 
rowCount
ßß #
;
ßß# $
}
àà 
catch
áá 
(
áá 
	Exception
áá  
ex
áá! #
)
áá# $
{
ââ 
if
ãã 
(
ãã 
ex
ãã 
is
ãã 
FDbException
ãã *
||
ãã+ -
ex
ãã. 0
is
ãã1 3
SqlException
ãã4 @
)
ãã@ A
{
ää 
try
åå 
{
ææ 
if
çç 
(
çç  
sqlTran
çç  '
!=
çç( *
null
çç+ /
)
çç/ 0
{
èè 
sqlTran
ìì  '
.
ìì' (
Rollback
ìì( 0
(
ìì0 1
)
ìì1 2
;
ìì2 3
}
íí 
}
îî 
catch
ïï 
(
ïï 
	Exception
ïï (
inEx
ïï) -
)
ïï- .
{
ğğ 
FDebug
ññ "
.
ññ" #
writeLog
ññ# +
(
ññ+ ,
inEx
ññ, 0
)
ññ0 1
;
ññ1 2
}
òò 
}
óó 
FDebug
÷÷ 
.
÷÷ 
throwException
÷÷ )
(
÷÷) *
ex
÷÷* ,
)
÷÷, -
;
÷÷- .
}
øø 
finally
ùù 
{
úú 
if
ûû 
(
ûû 
sqlTran
ûû 
!=
ûû  "
null
ûû# '
)
ûû' (
{
üü 
sqlTran
ıı 
.
ıı  
Dispose
ıı  '
(
ıı' (
)
ıı( )
;
ıı) *
sqlTran
şş 
=
şş  !
null
şş" &
;
şş& '
}
ÿÿ 
if
 
(
 
sqlCmd
 
!=
 !
null
" &
)
& '
{
‚‚ 
sqlCmd
ƒƒ 
.
ƒƒ 
Dispose
ƒƒ &
(
ƒƒ& '
)
ƒƒ' (
;
ƒƒ( )
sqlCmd
„„ 
=
„„  
null
„„! %
;
„„% &
}
…… 
if
‡‡ 
(
‡‡ 
sqlCon
‡‡ 
.
‡‡ 
State
‡‡ #
!=
‡‡# %
ConnectionState
‡‡& 5
.
‡‡5 6
Closed
‡‡6 <
)
‡‡< =
{
ˆˆ 
sqlCon
‰‰ 
.
‰‰ 
Close
‰‰ $
(
‰‰$ %
)
‰‰% &
;
‰‰& '
}
ŠŠ 

fSqlErrors
ŒŒ 
=
ŒŒ  
null
ŒŒ! %
;
ŒŒ% &
}
 
}
 
return
 
$num
 
;
 
}
 	
public
”” 
int
”” 
execute
”” 
(
”” 
int
•• 
timeout
•• 
)
–– 
{
—— 	
try
˜˜ 
{
™™ 
return
šš 
execute
šš 
(
šš 
timeout
šš &
,
šš& '
true
šš( ,
)
šš, -
;
šš- .
}
›› 
catch
œœ 
(
œœ 
	Exception
œœ 
ex
œœ 
)
œœ  
{
 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
ŸŸ 
finally
   
{
¡¡ 
}
££ 
return
¤¤ 
$num
¤¤ 
;
¤¤ 
}
¥¥ 	
public
©© 
int
©© 
execute
©© 
(
©© 
bool
ªª 
sqlClear
ªª 
)
«« 
{
¬¬ 	
try
­­ 
{
®® 
return
¯¯ 
execute
¯¯ 
(
¯¯ 
base
¯¯ #
.
¯¯# $
timeout
¯¯$ +
,
¯¯+ ,
sqlClear
¯¯- 5
)
¯¯5 6
;
¯¯6 7
}
°° 
catch
±± 
(
±± 
	Exception
±± 
ex
±± 
)
±±  
{
²² 
FDebug
³³ 
.
³³ 
throwException
³³ %
(
³³% &
ex
³³& (
)
³³( )
;
³³) *
}
´´ 
finally
µµ 
{
¶¶ 
}
¸¸ 
return
¹¹ 
$num
¹¹ 
;
¹¹ 
}
»» 	
public
ÀÀ 
int
ÀÀ 
execute
ÀÀ 
(
ÀÀ 
)
ÁÁ 
{
ÂÂ 	
try
ÃÃ 
{
ÄÄ 
return
ÅÅ 
execute
ÅÅ 
(
ÅÅ 
base
ÅÅ #
.
ÅÅ# $
timeout
ÅÅ$ +
,
ÅÅ+ ,
true
ÅÅ- 1
)
ÅÅ1 2
;
ÅÅ2 3
}
ÆÆ 
catch
ÇÇ 
(
ÇÇ 
	Exception
ÇÇ 
ex
ÇÇ 
)
ÇÇ  
{
ÈÈ 
FDebug
ÉÉ 
.
ÉÉ 
throwException
ÉÉ %
(
ÉÉ% &
ex
ÉÉ& (
)
ÉÉ( )
;
ÉÉ) *
}
ÊÊ 
finally
ËË 
{
ÌÌ 
}
ÎÎ 
return
ÏÏ 
$num
ÏÏ 
;
ÏÏ 
}
ĞĞ 	
}
ÖÖ 
}×× åk
mD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\OracleEx\c_FOdpQueryExecutor.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FOdpQueryExecutor "
:# $
FBaseExecutor% 2
,2 3
FIQueryExecutor4 C
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
internal   
FOdpQueryExecutor   "
(  " #
)!! 
:"" 
base"" 
("" 
)"" 
{## 	
}%% 	
internal)) 
FOdpQueryExecutor)) "
())" #
string** 
connectString**  
)++ 
:,, 
base,, 
(,, 
connectString,,  
),,  !
{-- 	
}// 	
~33 	
FOdpQueryExecutor33	 
(33 
)44 
{55 	
	myDispose66 
(66 
false66 
)66 
;66 
}77 	
	protected;; 
override;; 
void;; 
	myDispose;;  )
(;;) *
bool;;* .
	disposing;;/ 8
);;8 9
{<< 	
if== 
(== 
!== 

m_disposed== 
)== 
{>> 
if?? 
(?? 
	disposing?? 
)?? 
{@@ 
}BB 

m_disposedCC 
=CC 
trueCC !
;CC! "
baseGG 
.GG 
	myDisposeGG 
(GG 
	disposingGG (
)GG( )
;GG) *
}HH 
}II 	
publicWW 
DataSetWW 
executeWW 
(WW 
intXX 
timeoutXX 
,XX 
boolYY 
sqlClearYY 
)ZZ 
{[[ 	
OracleConnection\\ 
oraCon\\ #
=\\$ %
null\\& *
;\\* +
OracleCommand]] 
oraCmd]]  
=]]! "
null]]# '
;]]' (
OracleDataAdapter^^ 
oraAdt^^ $
=^^% &
null^^' +
;^^+ ,
DataSet__ 
tempDs__ 
=__ 
null__ !
;__! "
DataSet`` 
ds`` 
=`` 
null`` 
;`` 
	DataTableaa 
dtaa 
=aa 
nullaa 
;aa  
FSqlErrorCollectionbb 

fSqlErrorsbb  *
=bb+ ,
nullbb- 1
;bb1 2
FSqlErrorTypecc 
fSqlErrorTypecc '
=cc( )
FSqlErrorTypecc* 7
.cc7 8
Normalcc8 >
;cc> ?
stringee 
systemee 
=ee 
stringee "
.ee" #
Emptyee# (
;ee( )
stringff 
moduleff 
=ff 
stringff "
.ff" #
Emptyff# (
;ff( )
stringgg 
functiongg 
=gg 
stringgg $
.gg$ %
Emptygg% *
;gg* +
stringhh 
sqlCodehh 
=hh 
stringhh #
.hh# $
Emptyhh$ )
;hh) *
stringii 
errorMessageii 
=ii  !
stringii" (
.ii( )
Emptyii) .
;ii. /
usingkk 
(kk 
oraConkk 
=kk 
newkk 
OracleConnectionkk  0
(kk0 1
basekk1 5
.kk5 6
connectionStringkk6 F
)kkF G
)kkG H
{ll 
trymm 
{nn 
ifoo 
(oo 
baseoo 
.oo 
sqlListoo #
.oo# $
Countoo$ )
==oo) +
$numoo+ ,
)oo, -
{pp 
FDebugqq 
.qq 
throwFExceptionqq .
(qq. /
stringqq/ 5
.qq5 6
Formatqq6 <
(qq< =

FConstantsqq= G
.qqG H

err_m_0003qqH R
,qqR S
$strqqS ]
)qq] ^
)qq^ _
;qq_ `
}rr 
oraCmdvv 
=vv 
oraConvv #
.vv# $
CreateCommandvv$ 1
(vv1 2
)vv2 3
;vv3 4
oraCmdww 
.ww 
CommandTimeoutww )
=ww* +
timeoutww, 3
;ww3 4
oraCmdxx 
.xx 

Connectionxx %
=xx& '
oraConxx( .
;xx. /
oraCmdyy 
.yy 

BindByNameyy %
=yy& '
trueyy( ,
;yy, -
dszz 
=zz 
newzz 
DataSetzz $
(zz$ %
)zz% &
;zz& '
tempDs{{ 
={{ 
new{{  
DataSet{{! (
({{( )
){{) *
;{{* +
foreach 
( 
FSql !
fsql" &
in' )
base* .
.. /
sqlList/ 6
)6 7
{
€€ 
system
 
=
  
fsql
! %
.
% &
system
& ,
;
, -
module
‚‚ 
=
‚‚  
fsql
‚‚! %
.
‚‚% &
module
‚‚& ,
;
‚‚, -
function
ƒƒ  
=
ƒƒ! "
fsql
ƒƒ# '
.
ƒƒ' (
function
ƒƒ( 0
;
ƒƒ0 1
sqlCode
„„ 
=
„„  !
fsql
„„" &
.
„„& '
sqlCode
„„' .
;
„„. /
oraCmd
ŒŒ 
.
ŒŒ 
CommandText
ŒŒ *
=
ŒŒ+ ,
fsql
ŒŒ- 1
.
ŒŒ1 2
sqlEx
ŒŒ2 7
;
ŒŒ7 8
foreach
 
(
  !
FSqlParameter
! .
sqlPar
/ 5
in
6 8
fsql
9 =
.
= >$
sqlParameterCollection
> T
)
T U
{
 
oraCmd
 "
.
" #

Parameters
# -
.
- .
Add
. 1
(
1 2
sqlPar
2 8
.
8 9
oracleExParameter
9 J
)
J K
;
K L
}
 
oraAdt
‘‘ 
=
‘‘  
new
‘‘! $
OracleDataAdapter
‘‘% 6
(
‘‘6 7
oraCmd
‘‘7 =
)
‘‘= >
;
‘‘> ?
oraAdt
’’ 
.
’’ 
Fill
’’ #
(
’’# $
tempDs
’’$ *
)
’’* +
;
’’+ ,
oraCmd
““ 
.
““ 

Parameters
““ )
.
““) *
Clear
““* /
(
““/ 0
)
““0 1
;
““1 2
dt
—— 
=
—— 
tempDs
—— #
.
——# $
Tables
——$ *
[
——* +
$num
——+ ,
]
——, -
;
——- .
tempDs
˜˜ 
.
˜˜ 
Tables
˜˜ %
.
˜˜% &
Remove
˜˜& ,
(
˜˜, -
dt
˜˜- /
)
˜˜/ 0
;
˜˜0 1
tempDs
™™ 
.
™™ 
Clear
™™ $
(
™™$ %
)
™™% &
;
™™& '
dt
 
.
 
	TableName
 $
=
% &
fsql
' +
.
+ ,
name
, 0
;
0 1
ds
 
.
 
Tables
 !
.
! "
Add
" %
(
% &
dt
& (
)
( )
;
) *
}
ŸŸ 
if
££ 
(
££ 
sqlClear
££  
)
££  !
{
¤¤ 
base
¥¥ 
.
¥¥ 
clearSql
¥¥ %
(
¥¥% &
)
¥¥& '
;
¥¥' (
}
¦¦ 
return
§§ 
ds
§§ 
;
§§ 
}
¨¨ 
catch
©© 
(
©© 
OracleException
©© %
oraEx
©©& +
)
©©+ ,
{
ªª 
FDebug
«« 
.
«« 
writeLog
«« #
(
««# $
oraEx
««$ )
)
««) *
;
««* +

fSqlErrors
¯¯ 
=
¯¯  

FDbAdapter
¯¯! +
.
¯¯+ ,
createSqlErrors
¯¯, ;
(
¯¯; <
oraEx
¯¯< A
)
¯¯A B
;
¯¯B C
fSqlErrorType
°° !
=
°°" #

FDbAdapter
°°$ .
.
°°. /%
getSqlErrorTypeOfOracle
°°/ F
(
°°F G

fSqlErrors
°°G Q
)
°°Q R
;
°°R S
errorMessage
²²  
=
²²! "
oraEx
³³ 
.
³³ 
Message
³³ %
+
³³& '
Environment
³³( 3
.
³³3 4
NewLine
³³4 ;
+
³³< =
$str
´´ "
+
´´# $
system
´´% +
+
´´, -
$str
´´. ;
+
´´< =
module
´´> D
+
´´E F
$str
´´G V
+
´´W X
function
´´Y a
+
´´b c
$str
´´d r
+
´´s t
sqlCode
´´u |
+
´´} ~
$str´´ ‚
;´´‚ ƒ
FDebug
¶¶ 
.
¶¶ 
throwException
¶¶ )
(
¶¶) *
new
¶¶* -
FDbException
¶¶. :
(
¶¶: ;
fSqlErrorType
¶¶; H
,
¶¶H I

fSqlErrors
¶¶J T
,
¶¶T U
errorMessage
¶¶V b
,
¶¶b c
oraEx
¶¶d i
)
¶¶i j
)
¶¶j k
;
¶¶k l
}
·· 
catch
¸¸ 
(
¸¸ 
	Exception
¸¸ 
ex
¸¸  "
)
¸¸" #
{
¹¹ 
FDebug
ºº 
.
ºº 
throwException
ºº )
(
ºº) *
ex
ºº* ,
)
ºº, -
;
ºº- .
}
»» 
finally
¼¼ 
{
½½ 
if
¾¾ 
(
¾¾ 
oraAdt
¾¾ 
!=
¾¾ !
null
¾¾" &
)
¾¾& '
{
¿¿ 
oraAdt
ÀÀ 
.
ÀÀ 
Dispose
ÀÀ &
(
ÀÀ& '
)
ÀÀ' (
;
ÀÀ( )
oraAdt
ÁÁ 
=
ÁÁ  
null
ÁÁ! %
;
ÁÁ% &
}
ÂÂ 
if
ÄÄ 
(
ÄÄ 
oraCmd
ÄÄ 
!=
ÄÄ !
null
ÄÄ" &
)
ÄÄ& '
{
ÅÅ 
oraCmd
ÆÆ 
.
ÆÆ 
Dispose
ÆÆ &
(
ÆÆ& '
)
ÆÆ' (
;
ÆÆ( )
oraCmd
ÇÇ 
=
ÇÇ  
null
ÇÇ! %
;
ÇÇ% &
}
ÈÈ 
if
ÊÊ 
(
ÊÊ 
tempDs
ÊÊ 
!=
ÊÊ !
null
ÊÊ" &
)
ÊÊ& '
{
ËË 
tempDs
ÌÌ 
.
ÌÌ 
Dispose
ÌÌ &
(
ÌÌ& '
)
ÌÌ' (
;
ÌÌ( )
tempDs
ÍÍ 
=
ÍÍ  
null
ÍÍ! %
;
ÍÍ% &
}
ÎÎ 
if
ĞĞ 
(
ĞĞ 
oraCon
ĞĞ 
!=
ĞĞ !
null
ĞĞ" &
)
ĞĞ& '
{
ÑÑ 
if
ÒÒ 
(
ÒÒ 
oraCon
ÒÒ "
.
ÒÒ" #
State
ÒÒ# (
!=
ÒÒ) +
ConnectionState
ÒÒ, ;
.
ÒÒ; <
Closed
ÒÒ< B
)
ÒÒB C
{
ÓÓ 
oraCon
ÔÔ "
.
ÔÔ" #
Close
ÔÔ# (
(
ÔÔ( )
)
ÔÔ) *
;
ÔÔ* +
}
ÕÕ 
oraCon
ÖÖ 
.
ÖÖ 
Dispose
ÖÖ &
(
ÖÖ& '
)
ÖÖ' (
;
ÖÖ( )
oraCon
×× 
=
××  
null
××! %
;
××% &
}
ØØ 

fSqlErrors
ÚÚ 
=
ÚÚ  
null
ÚÚ! %
;
ÚÚ% &
}
ÛÛ 
return
ÜÜ 
null
ÜÜ 
;
ÜÜ 
}
İİ 
}
ŞŞ 	
public
ââ 
DataSet
ââ 
execute
ââ 
(
ââ 
int
ãã 
timeout
ãã 
)
ää 
{
åå 	
try
ææ 
{
çç 
return
èè 
execute
èè 
(
èè 
timeout
èè &
,
èè& '
true
èè( ,
)
èè, -
;
èè- .
}
éé 
catch
êê 
(
êê 
	Exception
êê 
ex
êê 
)
êê  
{
ëë 
FDebug
ìì 
.
ìì 
throwException
ìì %
(
ìì% &
ex
ìì& (
)
ìì( )
;
ìì) *
}
íí 
finally
îî 
{
ïï 
}
ññ 
return
òò 
null
òò 
;
òò 
}
óó 	
public
÷÷ 
DataSet
÷÷ 
execute
÷÷ 
(
÷÷ 
bool
øø 
sqlClear
øø 
)
ùù 
{
úú 	
try
ûû 
{
üü 
return
ıı 
execute
ıı 
(
ıı 
base
ıı #
.
ıı# $
timeout
ıı$ +
,
ıı+ ,
sqlClear
ıı- 5
)
ıı5 6
;
ıı6 7
}
şş 
catch
ÿÿ 
(
ÿÿ 
	Exception
ÿÿ 
ex
ÿÿ 
)
ÿÿ  
{
€€ 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
‚‚ 
finally
ƒƒ 
{
„„ 
}
†† 
return
‡‡ 
null
‡‡ 
;
‡‡ 
}
ˆˆ 	
public
ŒŒ 
DataSet
ŒŒ 
execute
ŒŒ 
(
ŒŒ 
)
 
{
 	
try
 
{
 
return
‘‘ 
execute
‘‘ 
(
‘‘ 
base
‘‘ #
.
‘‘# $
timeout
‘‘$ +
,
‘‘+ ,
true
‘‘- 1
)
‘‘1 2
;
‘‘2 3
}
’’ 
catch
““ 
(
““ 
	Exception
““ 
ex
““ 
)
““  
{
”” 
FDebug
•• 
.
•• 
throwException
•• %
(
••% &
ex
••& (
)
••( )
;
••) *
}
–– 
finally
—— 
{
˜˜ 
}
šš 
return
›› 
null
›› 
;
›› 
}
 	
}
££ 
}¤¤ ‚{
pD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\OracleEx\c_FOdpTransactExecutor.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class  
FOdpTransactExecutor %
:& '
FBaseExecutor( 5
,5 6
FITransactExecutor7 I
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
internal!!  
FOdpTransactExecutor!! %
(!!% &
)"" 
:## 
base## 
(## 
)## 
{$$ 	
}&& 	
internal**  
FOdpTransactExecutor** %
(**% &
string++ 
connectionString++ #
),, 
:-- 
base-- 
(-- 
connectionString-- "
)--" #
{.. 	
}00 	
~44 	 
FOdpTransactExecutor44	 
(44 
)55 
{66 	
	myDispose77 
(77 
false77 
)77 
;77 
}88 	
	protected<< 
override<< 
void<< 
	myDispose<<  )
(<<) *
bool== 
	disposing== 
)>> 
{?? 	
if@@ 
(@@ 
!@@ 

m_disposed@@ 
)@@ 
{AA 
ifBB 
(BB 
	disposingBB 
)BB 
{CC 
}EE 

m_disposedFF 
=FF 
trueFF !
;FF! "
baseJJ 
.JJ 
	myDisposeJJ 
(JJ 
	disposingJJ (
)JJ( )
;JJ) *
}KK 
}LL 	
publicZZ 
intZZ 
executeZZ 
(ZZ 
int[[ 
timeout[[ 
,[[ 
bool\\ 
sqlClear\\ 
)]] 
{^^ 	
OracleConnection__ 
oraCon__ #
=__$ %
null__& *
;__* +
OracleCommand`` 
oraCmd``  
=``! "
null``# '
;``' (
intaa 
rowCountaa 
=aa 
$numaa 
;aa 
intbb 
retryCntbb 
=bb 
$numbb 
;bb 
FSqlErrorCollectioncc 

fSqlErrorscc  *
=cc+ ,
nullcc- 1
;cc1 2
FSqlErrorTypedd 
fSqlErrorTypedd '
=dd( )
FSqlErrorTypedd* 7
.dd7 8
Normaldd8 >
;dd> ?
stringff 
systemff 
=ff 
stringff "
.ff" #
Emptyff# (
;ff( )
stringgg 
modulegg 
=gg 
stringgg "
.gg" #
Emptygg# (
;gg( )
stringhh 
functionhh 
=hh 
stringhh $
.hh$ %
Emptyhh% *
;hh* +
stringii 
sqlCodeii 
=ii 
stringii #
.ii# $
Emptyii$ )
;ii) *
stringjj 
errorMessagejj 
=jj  !
stringjj" (
.jj( )
Emptyjj) .
;jj. /
usingll 
(ll 
oraConll 
=ll 
newll 
OracleConnectionll  0
(ll0 1
basell1 5
.ll5 6
connectionStringll6 F
)llF G
)llG H
{mm 
trynn 
{oo 
ifpp 
(pp 
basepp 
.pp 
sqlListpp $
.pp$ %
Countpp% *
==pp+ -
$numpp. /
)pp/ 0
{qq 
FDebugrr 
.rr 
throwFExceptionrr .
(rr. /
stringrr/ 5
.rr5 6
Formatrr6 <
(rr< =

FConstantsrr= G
.rrG H

err_m_0003rrH R
,rrR S
$strrrT ^
)rr^ _
)rr_ `
;rr` a
}ss 
oraConww 
.ww 
Openww 
(ww  
)ww  !
;ww! "
whilexx 
(xx 
truexx 
)xx  
{yy 
oraCmdzz 
=zz  
oraConzz! '
.zz' (
CreateCommandzz( 5
(zz5 6
)zz6 7
;zz7 8
oraCmd{{ 
.{{ 

Connection{{ )
={{* +
oraCon{{, 2
;{{2 3
oraCmd|| 
.|| 

BindByName|| )
=||* +
true||, 0
;||0 1
try}} 
{~~ 
rowCount $
=% &
$num' (
;( )
oraCmd
€€ "
.
€€" #

Connection
€€# -
.
€€- .
BeginTransaction
€€. >
(
€€> ?
)
€€? @
;
€€@ A
oraCmd
 "
.
" #
CommandTimeout
# 1
=
2 3
timeout
4 ;
;
; <
foreach
…… #
(
……$ %
FSql
……% )
fSql
……* .
in
……/ 1
base
……2 6
.
……6 7
sqlList
……7 >
)
……> ?
{
†† 
system
‡‡  &
=
‡‡' (
fSql
‡‡) -
.
‡‡- .
system
‡‡. 4
;
‡‡4 5
module
ˆˆ  &
=
ˆˆ' (
fSql
ˆˆ) -
.
ˆˆ- .
module
ˆˆ. 4
;
ˆˆ4 5
function
‰‰  (
=
‰‰) *
fSql
‰‰+ /
.
‰‰/ 0
function
‰‰0 8
;
‰‰8 9
sqlCode
ŠŠ  '
=
ŠŠ( )
fSql
ŠŠ* .
.
ŠŠ. /
sqlCode
ŠŠ/ 6
;
ŠŠ6 7
oraCmd
’’  &
.
’’& '
CommandText
’’' 2
=
’’3 4
fSql
’’5 9
.
’’9 :
sqlEx
’’: ?
;
’’? @
foreach
––  '
(
––( )
FSqlParameter
––) 6
sqlPar
––7 =
in
––> @
fSql
––A E
.
––E F$
sqlParameterCollection
––F \
)
––\ ]
{
——  !
oraCmd
˜˜$ *
.
˜˜* +

Parameters
˜˜+ 5
.
˜˜5 6
Add
˜˜6 9
(
˜˜9 :
sqlPar
˜˜: @
.
˜˜@ A
oracleExParameter
˜˜A R
)
˜˜R S
;
˜˜S T
}
™™  !
rowCount
šš  (
+=
šš) +
oraCmd
šš, 2
.
šš2 3
ExecuteNonQuery
šš3 B
(
ššB C
)
ššC D
;
ššD E
oraCmd
››  &
.
››& '

Parameters
››' 1
.
››1 2
Clear
››2 7
(
››7 8
)
››8 9
;
››9 :
}
œœ 
oraCmd
   "
.
  " #
Transaction
  # .
.
  . /
Commit
  / 5
(
  5 6
)
  6 7
;
  7 8
break
¡¡ !
;
¡¡! "
}
¢¢ 
catch
££ 
(
££ 
OracleException
££ .
oraEx
££/ 4
)
££4 5
{
¤¤ 
FDebug
¥¥ "
.
¥¥" #
writeLog
¥¥# +
(
¥¥+ ,
oraEx
¥¥, 1
)
¥¥1 2
;
¥¥2 3

fSqlErrors
©© &
=
©©' (

FDbAdapter
©©) 3
.
©©3 4
createSqlErrors
©©4 C
(
©©C D
oraEx
©©D I
)
©©I J
;
©©J K
if
±± 
(
±±  

fSqlErrors
±±  *
.
±±* +
containsErrorCode
±±+ <
(
±±< =
FDbErrorCode
±±= I
.
±±I J
	ORA_00060
±±J S
)
±±S T
&&
±±U W
retryCnt
±±X `
<
±±a b
$num
±±c e
)
±±e f
{
²² 
System
³³  &
.
³³& '
Diagnostics
³³' 2
.
³³2 3
Debug
³³3 8
.
³³8 9
	WriteLine
³³9 B
(
³³B C
$str
³³C R
)
³³R S
;
³³S T
if
··  "
(
··# $
oraCmd
··$ *
.
··* +
Transaction
··+ 6
!=
··7 9
null
··: >
)
··> ?
{
¸¸  !
oraCmd
¹¹$ *
.
¹¹* +
Transaction
¹¹+ 6
.
¹¹6 7
Rollback
¹¹7 ?
(
¹¹? @
)
¹¹@ A
;
¹¹A B
}
ºº  !
oraCmd
¾¾  &
.
¾¾& '
Dispose
¾¾' .
(
¾¾. /
)
¾¾/ 0
;
¾¾0 1
oraCmd
¿¿  &
=
¿¿' (
null
¿¿) -
;
¿¿- .
retryCnt
ÃÃ  (
++
ÃÃ( *
;
ÃÃ* +
System
ÄÄ  &
.
ÄÄ& '
	Threading
ÄÄ' 0
.
ÄÄ0 1
Thread
ÄÄ1 7
.
ÄÄ7 8
Sleep
ÄÄ8 =
(
ÄÄ= >
$num
ÄÄ> @
)
ÄÄ@ A
;
ÄÄA B
}
ÅÅ 
else
ÆÆ  
{
ÇÇ 
fSqlErrorType
ÈÈ  -
=
ÈÈ. /

FDbAdapter
ÈÈ0 :
.
ÈÈ: ;*
getSqlErrorTypeOfMsSqlServer
ÈÈ; W
(
ÈÈW X

fSqlErrors
ÈÈX b
)
ÈÈb c
;
ÈÈc d
errorMessage
ÊÊ  ,
=
ÊÊ- .
oraEx
ËË$ )
.
ËË) *
Message
ËË* 1
+
ËË2 3
Environment
ËË4 ?
.
ËË? @
NewLine
ËË@ G
+
ËËH I
$str
ÌÌ$ .
+
ÌÌ/ 0
system
ÌÌ1 7
+
ÌÌ8 9
$str
ÌÌ: G
+
ÌÌH I
module
ÌÌJ P
+
ÌÌQ R
$str
ÌÌS b
+
ÌÌc d
function
ÌÌe m
+
ÌÌn o
$str
ÌÌp ~
+ÌÌ €
sqlCodeÌÌ ˆ
+ÌÌ‰ Š
$strÌÌ‹ 
;ÌÌ 
FDebug
ÎÎ  &
.
ÎÎ& '
throwException
ÎÎ' 5
(
ÎÎ5 6
new
ÎÎ6 9
FDbException
ÎÎ: F
(
ÎÎF G
fSqlErrorType
ÎÎG T
,
ÎÎT U

fSqlErrors
ÎÎV `
,
ÎÎ` a
errorMessage
ÎÎb n
,
ÎÎn o
oraEx
ÎÎp u
)
ÎÎu v
)
ÎÎv w
;
ÎÎw x
}
ÏÏ 
}
ĞĞ 
catch
ÑÑ 
(
ÑÑ 
	Exception
ÑÑ (
ex
ÑÑ) +
)
ÑÑ+ ,
{
ÒÒ 
FDebug
ÓÓ "
.
ÓÓ" #
throwException
ÓÓ# 1
(
ÓÓ1 2
ex
ÓÓ2 4
)
ÓÓ4 5
;
ÓÓ5 6
}
ÔÔ 
finally
ÕÕ 
{
ÖÖ 
}
ØØ 
}
ÙÙ 
if
İİ 
(
İİ 
sqlClear
İİ  
)
İİ  !
{
ŞŞ 
base
ßß 
.
ßß 
clearSql
ßß %
(
ßß% &
)
ßß& '
;
ßß' (
}
àà 
return
áá 
rowCount
áá #
;
áá# $
}
ââ 
catch
ãã 
(
ãã 
	Exception
ãã  
ex
ãã! #
)
ãã# $
{
ää 
if
åå 
(
åå 
ex
åå 
is
åå 
FDbException
åå *
||
åå+ -
ex
åå. 0
is
åå1 3
OracleException
åå4 C
)
ååC D
{
ææ 
try
çç 
{
èè 
if
éé 
(
éé  
oraCmd
éé  &
!=
éé' )
null
éé* .
&&
éé/ 1
oraCmd
éé2 8
.
éé8 9
Transaction
éé9 D
!=
ééE G
null
ééH L
)
ééL M
{
êê 
oraCmd
ëë  &
.
ëë& '
Transaction
ëë' 2
.
ëë2 3
Rollback
ëë3 ;
(
ëë; <
)
ëë< =
;
ëë= >
}
ìì 
}
íí 
catch
îî 
(
îî 
	Exception
îî (
inEx
îî) -
)
îî- .
{
ïï 
FDebug
ğğ "
.
ğğ" #
writeLog
ğğ# +
(
ğğ+ ,
inEx
ğğ, 0
)
ğğ0 1
;
ğğ1 2
}
ññ 
}
òò 
FDebug
öö 
.
öö 
throwException
öö )
(
öö) *
ex
öö* ,
)
öö, -
;
öö- .
}
÷÷ 
finally
øø 
{
ùù 
if
úú 
(
úú 
oraCmd
úú 
!=
úú !
null
úú" &
)
úú& '
{
ûû 
if
üü 
(
üü 
oraCmd
üü "
.
üü" #
Transaction
üü# .
!=
üü/ 1
null
üü2 6
)
üü6 7
{
ıı 
oraCmd
şş "
.
şş" #
Transaction
şş# .
.
şş. /
Dispose
şş/ 6
(
şş6 7
)
şş7 8
;
şş8 9
oraCmd
ÿÿ "
.
ÿÿ" #
Transaction
ÿÿ# .
=
ÿÿ/ 0
null
ÿÿ1 5
;
ÿÿ5 6
}
€€ 
oraCmd
„„ 
.
„„ 
Dispose
„„ &
(
„„& '
)
„„' (
;
„„( )
oraCmd
…… 
=
……  
null
……! %
;
……% &
}
†† 
if
ˆˆ 
(
ˆˆ 
oraCon
ˆˆ 
!=
ˆˆ !
null
ˆˆ" &
)
ˆˆ& '
{
‰‰ 
if
ŠŠ 
(
ŠŠ 
oraCon
ŠŠ "
.
ŠŠ" #
State
ŠŠ# (
!=
ŠŠ) +
ConnectionState
ŠŠ, ;
.
ŠŠ; <
Closed
ŠŠ< B
)
ŠŠB C
{
‹‹ 
oraCon
ŒŒ "
.
ŒŒ" #
Close
ŒŒ# (
(
ŒŒ( )
)
ŒŒ) *
;
ŒŒ* +
}
 
oraCon
 
.
 
Dispose
 &
(
& '
)
' (
;
( )
oraCon
 
=
  
null
! %
;
% &
}
 

fSqlErrors
’’ 
=
’’  
null
’’! %
;
’’% &
}
““ 
}
”” 
return
•• 
$num
•• 
;
•• 
}
–– 	
public
šš 
int
šš 
execute
šš 
(
šš 
int
›› 
timeout
›› 
)
œœ 
{
 	
try
 
{
ŸŸ 
return
   
execute
   
(
   
timeout
   &
,
  & '
true
  ( ,
)
  , -
;
  - .
}
¡¡ 
catch
¢¢ 
(
¢¢ 
	Exception
¢¢ 
ex
¢¢ 
)
¢¢  
{
££ 
FDebug
¤¤ 
.
¤¤ 
throwException
¤¤ %
(
¤¤% &
ex
¤¤& (
)
¤¤( )
;
¤¤) *
}
¥¥ 
finally
¦¦ 
{
§§ 
}
©© 
return
ªª 
$num
ªª 
;
ªª 
}
«« 	
public
¯¯ 
int
¯¯ 
execute
¯¯ 
(
¯¯ 
bool
°° 
sqlClear
°° 
)
±± 
{
²² 	
try
³³ 
{
´´ 
return
µµ 
execute
µµ 
(
µµ 
base
µµ #
.
µµ# $
timeout
µµ$ +
,
µµ+ ,
sqlClear
µµ- 5
)
µµ5 6
;
µµ6 7
}
¶¶ 
catch
·· 
(
·· 
	Exception
·· 
ex
·· 
)
··  
{
¸¸ 
FDebug
¹¹ 
.
¹¹ 
throwException
¹¹ %
(
¹¹% &
ex
¹¹& (
)
¹¹( )
;
¹¹) *
}
ºº 
finally
»» 
{
¼¼ 
}
¾¾ 
return
¿¿ 
$num
¿¿ 
;
¿¿ 
}
ÀÀ 	
public
ÄÄ 
int
ÄÄ 
execute
ÄÄ 
(
ÄÄ 
)
ÅÅ 
{
ÆÆ 	
try
ÇÇ 
{
ÈÈ 
return
ÉÉ 
execute
ÉÉ 
(
ÉÉ 
base
ÉÉ #
.
ÉÉ# $
timeout
ÉÉ$ +
,
ÉÉ+ ,
true
ÉÉ- 1
)
ÉÉ1 2
;
ÉÉ2 3
}
ÊÊ 
catch
ËË 
(
ËË 
	Exception
ËË 
ex
ËË 
)
ËË  
{
ÌÌ 
FDebug
ÍÍ 
.
ÍÍ 
throwException
ÍÍ %
(
ÍÍ% &
ex
ÍÍ& (
)
ÍÍ( )
;
ÍÍ) *
}
ÎÎ 
finally
ÏÏ 
{
ĞĞ 
}
ÒÒ 
return
ÓÓ 
$num
ÓÓ 
;
ÓÓ 
}
ÔÔ 	
}
ÚÚ 
}ÛÛ ˆk
kD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\Oracle\c_FOraQueryExecutor.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FOraQueryExecutor "
:# $
FBaseExecutor% 2
,2 3
FIQueryExecutor4 C
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
internal"" 
FOraQueryExecutor"" "
(""" #
)## 
:$$ 
base$$ 
($$ 
)$$ 
{%% 	
}'' 	
internal++ 
FOraQueryExecutor++ "
(++" #
string,, 
connectString,,  
)-- 
:.. 
base.. 
(.. 
connectString..  
)..  !
{// 	
}11 	
~55 	
FOraQueryExecutor55	 
(55 
)66 
{77 	
	myDispose88 
(88 
false88 
)88 
;88 
}99 	
	protected== 
override== 
void== 
	myDispose==  )
(==) *
bool>> 
	disposing>> 
)?? 
{@@ 	
ifAA 
(AA 
!AA 

m_disposedAA 
)AA 
{BB 
ifCC 
(CC 
	disposingCC 
)CC 
{DD 
}FF 

m_disposedGG 
=GG 
trueGG !
;GG! "
baseKK 
.KK 
	myDisposeKK 
(KK 
	disposingKK (
)KK( )
;KK) *
}LL 
}MM 	
public[[ 
DataSet[[ 
execute[[ 
([[ 
int\\ 
timeout\\ 
,\\ 
bool]] 
sqlClear]] 
)^^ 
{__ 	
OracleConnection`` 
oraCon`` #
=``$ %
null``& *
;``* +
OracleCommandaa 
oraCmdaa  
=aa! "
nullaa# '
;aa' (
OracleDataAdapterbb 
oraAdtbb $
=bb% &
nullbb' +
;bb+ ,
DataSetcc 
tempDscc 
=cc 
nullcc !
;cc! "
DataSetdd 
dsdd 
=dd 
nulldd 
;dd 
	DataTableee 
dtee 
=ee 
nullee 
;ee  
FSqlErrorCollectionff 

fSqlErrorsff  *
=ff+ ,
nullff- 1
;ff1 2
FSqlErrorTypegg 
fSqlErrorTypegg '
=gg( )
FSqlErrorTypegg* 7
.gg7 8
Normalgg8 >
;gg> ?
stringii 
systemii 
=ii 
stringii "
.ii" #
Emptyii# (
;ii( )
stringjj 
modulejj 
=jj 
stringjj "
.jj" #
Emptyjj# (
;jj( )
stringkk 
functionkk 
=kk 
stringkk $
.kk$ %
Emptykk% *
;kk* +
stringll 
sqlCodell 
=ll 
stringll #
.ll# $
Emptyll$ )
;ll) *
stringmm 
errorMessagemm 
=mm  !
stringmm" (
.mm( )
Emptymm) .
;mm. /
usingoo 
(oo 
oraConoo 
=oo 
newoo 
OracleConnectionoo  0
(oo0 1
baseoo1 5
.oo5 6
connectionStringoo6 F
)ooF G
)ooG H
{pp 
tryqq 
{rr 
ifss 
(ss 
basess 
.ss 
sqlListss $
.ss$ %
Countss% *
==ss+ -
$numss. /
)ss/ 0
{tt 
FDebuguu 
.uu 
throwFExceptionuu .
(uu. /
stringuu/ 5
.uu5 6
Formatuu6 <
(uu< =

FConstantsuu= G
.uuG H

err_m_0003uuH R
,uuR S
$struuT ^
)uu^ _
)uu_ `
;uu` a
}vv 
oraCmdzz 
=zz 
oraConzz #
.zz# $
CreateCommandzz$ 1
(zz1 2
)zz2 3
;zz3 4
oraCmd{{ 
.{{ 
CommandTimeout{{ )
={{* +
timeout{{, 3
;{{3 4
oraCmd|| 
.|| 

Connection|| %
=||& '
oraCon||( .
;||. /
ds}} 
=}} 
new}} 
DataSet}} $
(}}$ %
)}}% &
;}}& '
tempDs~~ 
=~~ 
new~~  
DataSet~~! (
(~~( )
)~~) *
;~~* +
foreach
‚‚ 
(
‚‚ 
FSql
‚‚ !
fsql
‚‚" &
in
‚‚' )
base
‚‚* .
.
‚‚. /
sqlList
‚‚/ 6
)
‚‚6 7
{
ƒƒ 
system
„„ 
=
„„  
fsql
„„! %
.
„„% &
system
„„& ,
;
„„, -
module
…… 
=
……  
fsql
……! %
.
……% &
module
……& ,
;
……, -
function
††  
=
††! "
fsql
††# '
.
††' (
function
††( 0
;
††0 1
sqlCode
‡‡ 
=
‡‡  !
fsql
‡‡" &
.
‡‡& '
sqlCode
‡‡' .
;
‡‡. /
oraCmd
 
.
 
CommandText
 *
=
+ ,
fsql
- 1
.
1 2
sqlEx
2 7
;
7 8
foreach
 
(
  !
FSqlParameter
! .
sqlPar
/ 5
in
6 8
fsql
9 =
.
= >$
sqlParameterCollection
> T
)
T U
{
‘‘ 
oraCmd
’’ "
.
’’" #

Parameters
’’# -
.
’’- .
Add
’’. 1
(
’’1 2
sqlPar
’’2 8
.
’’8 9
oracleParameter
’’9 H
)
’’H I
;
’’I J
}
““ 
oraAdt
”” 
=
””  
new
””! $
OracleDataAdapter
””% 6
(
””6 7
oraCmd
””7 =
)
””= >
;
””> ?
oraAdt
•• 
.
•• 
Fill
•• #
(
••# $
tempDs
••$ *
)
••* +
;
••+ ,
oraCmd
–– 
.
–– 

Parameters
–– )
.
––) *
Clear
––* /
(
––/ 0
)
––0 1
;
––1 2
dt
šš 
=
šš 
tempDs
šš #
.
šš# $
Tables
šš$ *
[
šš* +
$num
šš+ ,
]
šš, -
;
šš- .
tempDs
›› 
.
›› 
Tables
›› %
.
››% &
Remove
››& ,
(
››, -
dt
››- /
)
››/ 0
;
››0 1
tempDs
œœ 
.
œœ 
Clear
œœ $
(
œœ$ %
)
œœ% &
;
œœ& '
dt
   
.
   
	TableName
   $
=
  % &
fsql
  ' +
.
  + ,
name
  , 0
;
  0 1
ds
¡¡ 
.
¡¡ 
Tables
¡¡ !
.
¡¡! "
Add
¡¡" %
(
¡¡% &
dt
¡¡& (
)
¡¡( )
;
¡¡) *
}
¢¢ 
if
¤¤ 
(
¤¤ 
sqlClear
¤¤  
)
¤¤  !
{
¥¥ 
base
¦¦ 
.
¦¦ 
clearSql
¦¦ %
(
¦¦% &
)
¦¦& '
;
¦¦' (
}
§§ 
return
¨¨ 
ds
¨¨ 
;
¨¨ 
}
©© 
catch
ªª 
(
ªª 
OracleException
ªª &
oraEx
ªª' ,
)
ªª, -
{
«« 
FDebug
¬¬ 
.
¬¬ 
writeLog
¬¬ #
(
¬¬# $
oraEx
¬¬$ )
)
¬¬) *
;
¬¬* +

fSqlErrors
°° 
=
°°  

FDbAdapter
°°! +
.
°°+ ,
createSqlErrors
°°, ;
(
°°; <
oraEx
°°< A
)
°°A B
;
°°B C
fSqlErrorType
±± !
=
±±" #

FDbAdapter
±±$ .
.
±±. /%
getSqlErrorTypeOfOracle
±±/ F
(
±±F G

fSqlErrors
±±G Q
)
±±Q R
;
±±R S
errorMessage
³³  
=
³³! "
oraEx
´´ 
.
´´ 
Message
´´ %
+
´´& '
Environment
´´( 3
.
´´3 4
NewLine
´´4 ;
+
´´< =
$str
µµ "
+
µµ# $
system
µµ% +
+
µµ, -
$str
µµ. ;
+
µµ< =
module
µµ> D
+
µµE F
$str
µµG V
+
µµW X
function
µµY a
+
µµb c
$str
µµd r
+
µµs t
sqlCode
µµu |
+
µµ} ~
$strµµ ‚
;µµ‚ ƒ
FDebug
·· 
.
·· 
throwException
·· )
(
··) *
new
··* -
FDbException
··. :
(
··: ;
fSqlErrorType
··; H
,
··H I

fSqlErrors
··J T
,
··T U
errorMessage
··V b
,
··b c
oraEx
··d i
)
··i j
)
··j k
;
··k l
}
¸¸ 
catch
¹¹ 
(
¹¹ 
	Exception
¹¹  
ex
¹¹! #
)
¹¹# $
{
ºº 
FDebug
»» 
.
»» 
throwException
»» )
(
»») *
ex
»»* ,
)
»», -
;
»»- .
}
¼¼ 
finally
½½ 
{
¾¾ 
if
¿¿ 
(
¿¿ 
oraAdt
¿¿ 
!=
¿¿ !
null
¿¿" &
)
¿¿& '
{
ÀÀ 
oraAdt
ÁÁ 
.
ÁÁ 
Dispose
ÁÁ &
(
ÁÁ& '
)
ÁÁ' (
;
ÁÁ( )
oraAdt
ÂÂ 
=
ÂÂ  
null
ÂÂ! %
;
ÂÂ% &
}
ÃÃ 
if
ÅÅ 
(
ÅÅ 
oraCmd
ÅÅ 
!=
ÅÅ !
null
ÅÅ" &
)
ÅÅ& '
{
ÆÆ 
oraCmd
ÇÇ 
.
ÇÇ 
Dispose
ÇÇ &
(
ÇÇ& '
)
ÇÇ' (
;
ÇÇ( )
oraCmd
ÈÈ 
=
ÈÈ  
null
ÈÈ! %
;
ÈÈ% &
}
ÉÉ 
if
ËË 
(
ËË 
tempDs
ËË 
!=
ËË !
null
ËË" &
)
ËË& '
{
ÌÌ 
tempDs
ÍÍ 
.
ÍÍ 
Dispose
ÍÍ &
(
ÍÍ& '
)
ÍÍ' (
;
ÍÍ( )
tempDs
ÎÎ 
=
ÎÎ  
null
ÎÎ! %
;
ÎÎ% &
}
ÏÏ 
if
ÑÑ 
(
ÑÑ 
oraCon
ÑÑ 
!=
ÑÑ !
null
ÑÑ" &
)
ÑÑ& '
{
ÒÒ 
if
ÓÓ 
(
ÓÓ 
oraCon
ÓÓ "
.
ÓÓ" #
State
ÓÓ# (
!=
ÓÓ) +
ConnectionState
ÓÓ, ;
.
ÓÓ; <
Closed
ÓÓ< B
)
ÓÓB C
{
ÔÔ 
oraCon
ÕÕ "
.
ÕÕ" #
Close
ÕÕ# (
(
ÕÕ( )
)
ÕÕ) *
;
ÕÕ* +
}
ÖÖ 
oraCon
×× 
.
×× 
Dispose
×× &
(
××& '
)
××' (
;
××( )
oraCon
ØØ 
=
ØØ  
null
ØØ! %
;
ØØ% &
}
ÙÙ 

fSqlErrors
ÛÛ 
=
ÛÛ  
null
ÛÛ! %
;
ÛÛ% &
}
ÜÜ 
return
ŞŞ 
null
ŞŞ 
;
ŞŞ 
}
ßß 
}
àà 	
public
ää 
DataSet
ää 
execute
ää 
(
ää 
int
åå 
timeout
åå 
)
ææ 
{
çç 	
try
èè 
{
éé 
return
êê 
execute
êê 
(
êê 
timeout
êê &
,
êê& '
true
êê( ,
)
êê, -
;
êê- .
}
ëë 
catch
ìì 
(
ìì 
	Exception
ìì 
ex
ìì 
)
ìì  
{
íí 
FDebug
îî 
.
îî 
throwException
îî %
(
îî% &
ex
îî& (
)
îî( )
;
îî) *
}
ïï 
finally
ğğ 
{
ññ 
}
óó 
return
ôô 
null
ôô 
;
ôô 
}
õõ 	
public
ùù 
DataSet
ùù 
execute
ùù 
(
ùù 
bool
úú 
sqlClear
úú 
)
ûû 
{
üü 	
try
ıı 
{
şş 
return
ÿÿ 
execute
ÿÿ 
(
ÿÿ 
base
ÿÿ #
.
ÿÿ# $
timeout
ÿÿ$ +
,
ÿÿ+ ,
sqlClear
ÿÿ- 5
)
ÿÿ5 6
;
ÿÿ6 7
}
€€ 
catch
 
(
 
	Exception
 
ex
 
)
  
{
‚‚ 
FDebug
ƒƒ 
.
ƒƒ 
throwException
ƒƒ %
(
ƒƒ% &
ex
ƒƒ& (
)
ƒƒ( )
;
ƒƒ) *
}
„„ 
finally
…… 
{
†† 
}
ˆˆ 
return
‰‰ 
null
‰‰ 
;
‰‰ 
}
‹‹ 	
public
 
DataSet
 
execute
 
(
 
)
 
{
‘‘ 	
try
’’ 
{
““ 
return
”” 
execute
”” 
(
”” 
base
”” #
.
””# $
timeout
””$ +
,
””+ ,
true
””- 1
)
””1 2
;
””2 3
}
•• 
catch
–– 
(
–– 
	Exception
–– 
ex
–– 
)
––  
{
—— 
FDebug
˜˜ 
.
˜˜ 
throwException
˜˜ %
(
˜˜% &
ex
˜˜& (
)
˜˜( )
;
˜˜) *
}
™™ 
finally
šš 
{
›› 
}
 
return
 
null
 
;
 
}
   	
}
¦¦ 
}§§ ’{
nD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\Oracle\c_FOraTransactExecutor.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class  
FOraTransactExecutor %
:& '
FBaseExecutor( 5
,5 6
FITransactExecutor7 I
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
public!!  
FOraTransactExecutor!! #
(!!# $
)"" 
:## 
base## 
(## 
)## 
{$$ 	
}&& 	
public**  
FOraTransactExecutor** #
(**# $
string++ 
connectionString++ #
),, 
:-- 
base-- 
(-- 
connectionString-- #
)--# $
{.. 	
}00 	
~44 	 
FOraTransactExecutor44	 
(44 
)55 
{66 	
	myDispose77 
(77 
false77 
)77 
;77 
}88 	
	protected<< 
override<< 
void<< 
	myDispose<<  )
(<<) *
bool== 
	disposing== 
)>> 
{?? 	
if@@ 
(@@ 
!@@ 

m_disposed@@ 
)@@ 
{AA 
ifBB 
(BB 
	disposingBB 
)BB 
{CC 
}EE 

m_disposedFF 
=FF 
trueFF !
;FF! "
baseJJ 
.JJ 
	myDisposeJJ 
(JJ 
	disposingJJ (
)JJ( )
;JJ) *
}KK 
}LL 	
publicZZ 
intZZ 
executeZZ 
(ZZ 
int[[ 
timeout[[ 
,[[ 
bool\\ 
sqlClear\\ 
)]] 
{^^ 	
OracleConnection__ 
oraCon__ #
=__$ %
null__& *
;__* +
OracleTransaction`` 
oraTran`` %
=``& '
null``( ,
;``, -
OracleCommandaa 
oraCmdaa  
=aa! "
nullaa# '
;aa' (
intbb 
rowCountbb 
=bb 
$numbb 
;bb 
intcc 
retryCntcc 
=cc 
$numcc 
;cc 
FSqlErrorCollectiondd 

fSqlErrorsdd  *
=dd+ ,
nulldd- 1
;dd1 2
FSqlErrorTypeee 
fSqlErrorTypeee '
=ee( )
FSqlErrorTypeee* 7
.ee7 8
Normalee8 >
;ee> ?
stringgg 
systemgg 
=gg 
stringgg "
.gg" #
Emptygg# (
;gg( )
stringhh 
modulehh 
=hh 
stringhh "
.hh" #
Emptyhh# (
;hh( )
stringii 
functionii 
=ii 
stringii $
.ii$ %
Emptyii% *
;ii* +
stringjj 
sqlCodejj 
=jj 
stringjj #
.jj# $
Emptyjj$ )
;jj) *
stringkk 
errorMessagekk 
=kk  !
stringkk" (
.kk( )
Emptykk) .
;kk. /
usingmm 
(mm 
oraConmm 
=mm 
newmm 
OracleConnectionmm  0
(mm0 1
basemm1 5
.mm5 6
connectionStringmm6 F
)mmF G
)mmG H
{nn 
tryoo 
{pp 
ifqq 
(qq 
baseqq 
.qq 
sqlListqq $
.qq$ %
Countqq% *
==qq+ -
$numqq. /
)qq/ 0
{rr 
FDebugss 
.ss 
throwFExceptionss .
(ss. /
stringss/ 5
.ss5 6
Formatss6 <
(ss< =

FConstantsss= G
.ssG H

err_m_0003ssH R
,ssR S
$strssT ^
)ss^ _
)ss_ `
;ss` a
}tt 
oraConxx 
.xx 
Openxx 
(xx  
)xx  !
;xx! "
whileyy 
(yy 
trueyy 
)yy  
{zz 
try{{ 
{|| 
rowCount}} $
=}}% &
$num}}' (
;}}( )
oraTran~~ #
=~~$ %
oraCon~~& ,
.~~, -
BeginTransaction~~- =
(~~= >
)~~> ?
;~~? @
oraCmd "
=# $
oraCon% +
.+ ,
CreateCommand, 9
(9 :
): ;
;; <
oraCmd
€€ "
.
€€" #

Connection
€€# -
=
€€. /
oraCon
€€0 6
;
€€6 7
oraCmd
 "
.
" #
Transaction
# .
=
/ 0
oraTran
1 8
;
8 9
oraCmd
‚‚ "
.
‚‚" #
CommandTimeout
‚‚# 1
=
‚‚2 3
timeout
‚‚4 ;
;
‚‚; <
foreach
†† #
(
††$ %
FSql
††% )
fsql
††* .
in
††/ 1
base
††2 6
.
††6 7
sqlList
††7 >
)
††> ?
{
‡‡ 
system
ˆˆ  &
=
ˆˆ' (
fsql
ˆˆ) -
.
ˆˆ- .
system
ˆˆ. 4
;
ˆˆ4 5
module
‰‰  &
=
‰‰' (
fsql
‰‰) -
.
‰‰- .
module
‰‰. 4
;
‰‰4 5
function
ŠŠ  (
=
ŠŠ) *
fsql
ŠŠ+ /
.
ŠŠ/ 0
function
ŠŠ0 8
;
ŠŠ8 9
sqlCode
‹‹  '
=
‹‹( )
fsql
‹‹* .
.
‹‹. /
sqlCode
‹‹/ 6
;
‹‹6 7
oraCmd
““  &
.
““& '
CommandText
““' 2
=
““3 4
fsql
““5 9
.
““9 :
sqlEx
““: ?
;
““? @
foreach
””  '
(
””( )
FSqlParameter
””) 6
sqlPar
””7 =
in
””> @
fsql
””A E
.
””E F$
sqlParameterCollection
””F \
)
””\ ]
{
••  !
oraCmd
––$ *
.
––* +

Parameters
––+ 5
.
––5 6
Add
––6 9
(
––9 :
sqlPar
––: @
.
––@ A
oracleParameter
––A P
)
––P Q
;
––Q R
}
——  !
rowCount
˜˜  (
+=
˜˜) +
oraCmd
˜˜, 2
.
˜˜2 3
ExecuteNonQuery
˜˜3 B
(
˜˜B C
)
˜˜C D
;
˜˜D E
oraCmd
™™  &
.
™™& '

Parameters
™™' 1
.
™™1 2
Clear
™™2 7
(
™™7 8
)
™™8 9
;
™™9 :
}
šš 
oraTran
 #
.
# $
Commit
$ *
(
* +
)
+ ,
;
, -
break
ŸŸ !
;
ŸŸ! "
}
   
catch
¡¡ 
(
¡¡ 
OracleException
¡¡ .
oraEx
¡¡/ 4
)
¡¡4 5
{
¢¢ 
FDebug
££ "
.
££" #
writeLog
££# +
(
££+ ,
oraEx
££, 1
)
££1 2
;
££2 3

fSqlErrors
§§ &
=
§§' (

FDbAdapter
§§) 3
.
§§3 4
createSqlErrors
§§4 C
(
§§C D
oraEx
§§D I
)
§§I J
;
§§J K
if
¯¯ 
(
¯¯  

fSqlErrors
¯¯  *
.
¯¯* +
containsErrorCode
¯¯+ <
(
¯¯< =
FDbErrorCode
¯¯= I
.
¯¯I J
	ORA_00060
¯¯J S
)
¯¯S T
&&
¯¯U W
retryCnt
¯¯X `
<
¯¯a b
$num
¯¯c e
)
¯¯e f
{
°° 
System
±±  &
.
±±& '
Diagnostics
±±' 2
.
±±2 3
Debug
±±3 8
.
±±8 9
	WriteLine
±±9 B
(
±±B C
$str
±±C R
)
±±R S
;
±±S T
if
µµ  "
(
µµ# $
oraTran
µµ$ +
!=
µµ, .
null
µµ/ 3
)
µµ3 4
{
¶¶  !
oraTran
··$ +
.
··+ ,
Rollback
··, 4
(
··4 5
)
··5 6
;
··6 7
oraTran
¸¸$ +
.
¸¸+ ,
Dispose
¸¸, 3
(
¸¸3 4
)
¸¸4 5
;
¸¸5 6
oraTran
¹¹$ +
=
¹¹, -
null
¹¹. 2
;
¹¹2 3
}
ºº  !
if
¼¼  "
(
¼¼# $
oraCmd
¼¼$ *
!=
¼¼+ -
null
¼¼. 2
)
¼¼2 3
{
½½  !
oraCmd
¾¾$ *
.
¾¾* +
Dispose
¾¾+ 2
(
¾¾2 3
)
¾¾3 4
;
¾¾4 5
oraCmd
¿¿$ *
=
¿¿+ ,
null
¿¿- 1
;
¿¿1 2
}
ÀÀ  !
retryCnt
ÄÄ  (
++
ÄÄ( *
;
ÄÄ* +
System
ÅÅ  &
.
ÅÅ& '
	Threading
ÅÅ' 0
.
ÅÅ0 1
Thread
ÅÅ1 7
.
ÅÅ7 8
Sleep
ÅÅ8 =
(
ÅÅ= >
$num
ÅÅ> @
)
ÅÅ@ A
;
ÅÅA B
}
ÆÆ 
else
ÇÇ  
{
ÈÈ 
fSqlErrorType
ÉÉ  -
=
ÉÉ. /

FDbAdapter
ÉÉ0 :
.
ÉÉ: ;*
getSqlErrorTypeOfMsSqlServer
ÉÉ; W
(
ÉÉW X

fSqlErrors
ÉÉX b
)
ÉÉb c
;
ÉÉc d
errorMessage
ËË  ,
=
ËË- .
oraEx
ÌÌ$ )
.
ÌÌ) *
Message
ÌÌ* 1
+
ÌÌ2 3
Environment
ÌÌ4 ?
.
ÌÌ? @
NewLine
ÌÌ@ G
+
ÌÌH I
$str
ÍÍ$ .
+
ÍÍ/ 0
system
ÍÍ1 7
+
ÍÍ8 9
$str
ÍÍ: G
+
ÍÍH I
module
ÍÍJ P
+
ÍÍQ R
$str
ÍÍS b
+
ÍÍc d
function
ÍÍe m
+
ÍÍn o
$str
ÍÍp ~
+ÍÍ €
sqlCodeÍÍ ˆ
+ÍÍ‰ Š
$strÍÍ‹ 
;ÍÍ 
FDebug
ÏÏ  &
.
ÏÏ& '
throwException
ÏÏ' 5
(
ÏÏ5 6
new
ÏÏ6 9
FDbException
ÏÏ: F
(
ÏÏF G
fSqlErrorType
ÏÏG T
,
ÏÏT U

fSqlErrors
ÏÏV `
,
ÏÏ` a
errorMessage
ÏÏb n
,
ÏÏn o
oraEx
ÏÏp u
)
ÏÏu v
)
ÏÏv w
;
ÏÏw x
}
ĞĞ 
}
ÑÑ 
catch
ÒÒ 
(
ÒÒ 
	Exception
ÒÒ (
ex
ÒÒ) +
)
ÒÒ+ ,
{
ÓÓ 
FDebug
ÔÔ "
.
ÔÔ" #
throwException
ÔÔ# 1
(
ÔÔ1 2
ex
ÔÔ2 4
)
ÔÔ4 5
;
ÔÔ5 6
}
ÕÕ 
finally
ÖÖ 
{
×× 
}
ÙÙ 
}
ÚÚ 
if
ŞŞ 
(
ŞŞ 
sqlClear
ŞŞ  
)
ŞŞ  !
{
ßß 
base
àà 
.
àà 
clearSql
àà %
(
àà% &
)
àà& '
;
àà' (
}
áá 
return
ââ 
rowCount
ââ #
;
ââ# $
}
ãã 
catch
ää 
(
ää 
	Exception
ää  
ex
ää! #
)
ää# $
{
åå 
if
ææ 
(
ææ 
ex
ææ 
is
ææ 
FDbException
ææ *
||
ææ+ -
ex
ææ. 0
is
ææ1 3
OracleException
ææ4 C
)
ææC D
{
çç 
try
èè 
{
éé 
if
êê 
(
êê  
oraTran
êê  '
!=
êê( *
null
êê+ /
)
êê/ 0
{
ëë 
oraTran
ïï  '
.
ïï' (
Rollback
ïï( 0
(
ïï0 1
)
ïï1 2
;
ïï2 3
}
ğğ 
}
ññ 
catch
òò 
(
òò 
	Exception
òò (
inEx
òò) -
)
òò- .
{
óó 
FDebug
ôô "
.
ôô" #
writeLog
ôô# +
(
ôô+ ,
inEx
ôô, 0
)
ôô0 1
;
ôô1 2
}
õõ 
}
öö 
FDebug
úú 
.
úú 
throwException
úú )
(
úú) *
ex
úú* ,
)
úú, -
;
úú- .
}
ûû 
finally
üü 
{
ıı 
if
şş 
(
şş 
oraTran
şş 
!=
şş  "
null
şş# '
)
şş' (
{
ÿÿ 
oraTran
€€ 
.
€€  
Dispose
€€  '
(
€€' (
)
€€( )
;
€€) *
oraTran
 
=
  !
null
" &
;
& '
}
‚‚ 
if
ƒƒ 
(
ƒƒ 
oraCmd
ƒƒ 
!=
ƒƒ !
null
ƒƒ" &
)
ƒƒ& '
{
„„ 
oraCmd
…… 
.
…… 
Dispose
…… &
(
……& '
)
……' (
;
……( )
oraCmd
†† 
=
††  
null
††! %
;
††% &
}
‡‡ 
if
ˆˆ 
(
ˆˆ 
oraCon
ˆˆ 
!=
ˆˆ !
null
ˆˆ" &
)
ˆˆ& '
{
‰‰ 
if
ŠŠ 
(
ŠŠ 
oraCon
ŠŠ "
.
ŠŠ" #
State
ŠŠ# (
!=
ŠŠ) +
ConnectionState
ŠŠ, ;
.
ŠŠ; <
Closed
ŠŠ< B
)
ŠŠB C
{
‹‹ 
oraCon
ŒŒ "
.
ŒŒ" #
Close
ŒŒ# (
(
ŒŒ( )
)
ŒŒ) *
;
ŒŒ* +
}
 
oraCon
 
.
 
Dispose
 &
(
& '
)
' (
;
( )
oraCon
 
=
  
null
! %
;
% &
}
 

fSqlErrors
’’ 
=
’’  
null
’’! %
;
’’% &
}
““ 
}
”” 
return
•• 
$num
•• 
;
•• 
}
–– 	
public
šš 
int
šš 
execute
šš 
(
šš 
int
›› 
timeout
›› 
)
œœ 
{
 	
try
 
{
ŸŸ 
return
   
execute
   
(
   
timeout
   &
,
  & '
true
  ( ,
)
  , -
;
  - .
}
¡¡ 
catch
¢¢ 
(
¢¢ 
	Exception
¢¢ 
ex
¢¢ 
)
¢¢  
{
££ 
FDebug
¤¤ 
.
¤¤ 
throwException
¤¤ %
(
¤¤% &
ex
¤¤& (
)
¤¤( )
;
¤¤) *
}
¥¥ 
finally
¦¦ 
{
§§ 
}
©© 
return
ªª 
$num
ªª 
;
ªª 
}
«« 	
public
¯¯ 
int
¯¯ 
execute
¯¯ 
(
¯¯ 
bool
°° 
sqlClear
°° 
)
±± 
{
²² 	
try
³³ 
{
´´ 
return
µµ 
execute
µµ 
(
µµ 
base
µµ #
.
µµ# $
timeout
µµ$ +
,
µµ+ ,
sqlClear
µµ- 5
)
µµ5 6
;
µµ6 7
}
¶¶ 
catch
·· 
(
·· 
	Exception
·· 
ex
·· 
)
··  
{
¸¸ 
FDebug
¹¹ 
.
¹¹ 
throwException
¹¹ %
(
¹¹% &
ex
¹¹& (
)
¹¹( )
;
¹¹) *
}
ºº 
finally
»» 
{
¼¼ 
}
¾¾ 
return
¿¿ 
$num
¿¿ 
;
¿¿ 
}
ÀÀ 	
public
ÄÄ 
int
ÄÄ 
execute
ÄÄ 
(
ÄÄ 
)
ÅÅ 
{
ÆÆ 	
try
ÇÇ 
{
ÈÈ 
return
ÉÉ 
execute
ÉÉ 
(
ÉÉ 
base
ÉÉ #
.
ÉÉ# $
timeout
ÉÉ$ +
,
ÉÉ+ ,
true
ÉÉ- 1
)
ÉÉ1 2
;
ÉÉ2 3
}
ÊÊ 
catch
ËË 
(
ËË 
	Exception
ËË 
ex
ËË 
)
ËË  
{
ÌÌ 
FDebug
ÍÍ 
.
ÍÍ 
throwException
ÍÍ %
(
ÍÍ% &
ex
ÍÍ& (
)
ÍÍ( )
;
ÍÍ) *
}
ÎÎ 
finally
ÏÏ 
{
ĞĞ 
}
ÒÒ 
return
ÓÓ 
$num
ÓÓ 
;
ÓÓ 
}
ÔÔ 	
}
ÚÚ 
}ÛÛ ¢Y
]D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Debug\c_FDebugLogArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FDebugLogArgs 
:  
IDisposable! ,
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FDebugLogCategory !

m_category" ,
=- .
FDebugLogCategory/ @
.@ A
InformationA L
;L M
private 
string 
m_action 
=  !
string" (
.( )
Empty) .
;. /
private 
string 
m_typeNamespace &
=' (
string) /
./ 0
Empty0 5
;5 6
private   
string   

m_typeName   !
=  " #
string  $ *
.  * +
Empty  + 0
;  0 1
private!! 
string!! 
m_functionName!! %
=!!& '
string!!( .
.!!. /
Empty!!/ 4
;!!4 5
private"" 
string"" 
m_additionInfo"" %
=""& '
string""( .
."". /
Empty""/ 4
;""4 5
public(( 
FDebugLogArgs(( 
((( 
))) 
{** 	
},, 	
public00 
FDebugLogArgs00 
(00 
FDebugLogCategory11 
	fCategory11 '
,11' (
string22 
action22 
,22 
string33 
typeNamespace33  
,33  !
string44 
typeName44 
,44 
string55 
funcationName55  
)66 
{77 	

m_category88 
=88 
	fCategory88 "
;88" #
m_action99 
=99 
action99 
;99 
m_typeNamespace:: 
=:: 
typeNamespace:: +
;::+ ,

m_typeName;; 
=;; 
typeName;; !
;;;! "
m_functionName<< 
=<< 
funcationName<< *
;<<* +
}== 	
publicAA 
FDebugLogArgsAA 
(AA 
FDebugLogCategoryBB 
	fCategoryBB '
,BB' (
stringCC 
actionCC 
,CC 
TypeDD 
typeDD 
,DD 
stringEE 
functionNameEE 
)FF 
{GG 	

m_categoryHH 
=HH 
	fCategoryHH "
;HH" #
m_actionII 
=II 
actionII 
;II 
m_typeNamespaceJJ 
=JJ 
typeJJ "
.JJ" #
	NamespaceJJ# ,
;JJ, -

m_typeNameKK 
=KK 
typeKK 
.KK 
NameKK "
;KK" #
m_functionNameLL 
=LL 
functionNameLL )
;LL) *
}MM 	
~QQ 	
FDebugLogArgsQQ	 
(QQ 
)RR 
{SS 	
	myDisposeTT 
(TT 
falseTT 
)TT 
;TT 
}UU 	
	protectedYY 
voidYY 
	myDisposeYY  
(YY  !
boolZZ 
	disposingZZ 
)[[ 
{\\ 	
if]] 
(]] 
!]] 

m_disposed]] 
)]] 
{^^ 
if__ 
(__ 
	disposing__ 
)__ 
{`` 
}bb 

m_disposeddd 
=dd 
truedd !
;dd! "
}ee 
}ff 	
publicnn 
voidnn 
Disposenn 
(nn 
)oo 
{pp 	
	myDisposeqq 
(qq 
trueqq 
)qq 
;qq 
GCrr 
.rr 
SuppressFinalizerr 
(rr  
thisrr  $
)rr$ %
;rr% &
}ss 	
public{{ 
FDebugLogCategory{{  
	fCategory{{! *
{|| 	
get}} 
{~~ 
try 
{
€€ 
return
 

m_category
 %
;
% &
}
‚‚ 
catch
ƒƒ 
(
ƒƒ 
	Exception
ƒƒ  
ex
ƒƒ! #
)
ƒƒ# $
{
„„ 
FDebug
…… 
.
…… 
throwException
…… )
(
……) *
ex
……* ,
)
……, -
;
……- .
}
†† 
finally
‡‡ 
{
ˆˆ 
}
ŠŠ 
return
‹‹ 
FDebugLogCategory
‹‹ (
.
‹‹( )
Information
‹‹) 4
;
‹‹4 5
}
ŒŒ 
set
 
{
 
try
 
{
‘‘ 

m_category
’’ 
=
’’  
value
’’! &
;
’’& '
}
““ 
catch
”” 
(
”” 
	Exception
””  
ex
””! #
)
””# $
{
•• 
FDebug
–– 
.
–– 
throwException
–– )
(
––) *
ex
––* ,
)
––, -
;
––- .
}
—— 
finally
˜˜ 
{
™™ 
}
›› 
}
œœ 
}
 	
public
¡¡ 
string
¡¡ 
action
¡¡ 
{
¢¢ 	
get
££ 
{
¤¤ 
try
¥¥ 
{
¦¦ 
return
§§ 
m_action
§§ #
;
§§# $
}
¨¨ 
catch
©© 
(
©© 
	Exception
©©  
ex
©©! #
)
©©# $
{
ªª 
FDebug
«« 
.
«« 
throwException
«« )
(
««) *
ex
««* ,
)
««, -
;
««- .
}
¬¬ 
finally
­­ 
{
®® 
}
°° 
return
±± 
string
±± 
.
±± 
Empty
±± #
;
±±# $
}
²² 
set
´´ 
{
µµ 
try
¶¶ 
{
·· 
m_action
¸¸ 
=
¸¸ 
value
¸¸ $
;
¸¸$ %
}
¹¹ 
catch
ºº 
(
ºº 
	Exception
ºº  
ex
ºº! #
)
ºº# $
{
»» 
FDebug
¼¼ 
.
¼¼ 
throwException
¼¼ )
(
¼¼) *
ex
¼¼* ,
)
¼¼, -
;
¼¼- .
}
½½ 
finally
¾¾ 
{
¿¿ 
}
ÁÁ 
}
ÂÂ 
}
ÃÃ 	
public
ÇÇ 
string
ÇÇ 
typeNamespace
ÇÇ #
{
ÈÈ 	
get
ÉÉ 
{
ÊÊ 
try
ËË 
{
ÌÌ 
return
ÍÍ 
m_typeNamespace
ÍÍ *
;
ÍÍ* +
}
ÎÎ 
catch
ÏÏ 
(
ÏÏ 
	Exception
ÏÏ  
ex
ÏÏ! #
)
ÏÏ# $
{
ĞĞ 
FDebug
ÑÑ 
.
ÑÑ 
throwException
ÑÑ )
(
ÑÑ) *
ex
ÑÑ* ,
)
ÑÑ, -
;
ÑÑ- .
}
ÒÒ 
finally
ÓÓ 
{
ÔÔ 
}
ÖÖ 
return
×× 
string
×× 
.
×× 
Empty
×× #
;
××# $
}
ØØ 
set
ÚÚ 
{
ÛÛ 
try
ÜÜ 
{
İİ 
m_typeNamespace
ŞŞ #
=
ŞŞ$ %
value
ŞŞ& +
;
ŞŞ+ ,
}
ßß 
catch
àà 
(
àà 
	Exception
àà  
ex
àà! #
)
àà# $
{
áá 
FDebug
ââ 
.
ââ 
throwException
ââ )
(
ââ) *
ex
ââ* ,
)
ââ, -
;
ââ- .
}
ãã 
finally
ää 
{
åå 
}
çç 
}
èè 
}
éé 	
public
íí 
string
íí 
typeName
íí 
{
îî 	
get
ïï 
{
ğğ 
try
ññ 
{
òò 
return
óó 

m_typeName
óó %
;
óó% &
}
ôô 
catch
õõ 
(
õõ 
	Exception
õõ  
ex
õõ! #
)
õõ# $
{
öö 
FDebug
÷÷ 
.
÷÷ 
throwException
÷÷ )
(
÷÷) *
ex
÷÷* ,
)
÷÷, -
;
÷÷- .
}
øø 
finally
ùù 
{
úú 
}
üü 
return
ıı 
string
ıı 
.
ıı 
Empty
ıı #
;
ıı# $
}
şş 
set
€€ 
{
 
try
‚‚ 
{
ƒƒ 

m_typeName
„„ 
=
„„  
value
„„! &
;
„„& '
}
…… 
catch
†† 
(
†† 
	Exception
††  
ex
††! #
)
††# $
{
‡‡ 
FDebug
ˆˆ 
.
ˆˆ 
throwException
ˆˆ )
(
ˆˆ) *
ex
ˆˆ* ,
)
ˆˆ, -
;
ˆˆ- .
}
‰‰ 
finally
ŠŠ 
{
‹‹ 
}
 
}
 
}
 	
public
““ 
string
““ 
functionName
““ "
{
”” 	
get
•• 
{
–– 
try
—— 
{
˜˜ 
return
™™ 
m_functionName
™™ )
;
™™) *
}
šš 
catch
›› 
(
›› 
	Exception
››  
ex
››! #
)
››# $
{
œœ 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
ŸŸ 
{
   
}
¢¢ 
return
££ 
string
££ 
.
££ 
Empty
££ #
;
££# $
}
¤¤ 
set
¦¦ 
{
§§ 
try
¨¨ 
{
©© 
m_functionName
ªª "
=
ªª# $
value
ªª% *
;
ªª* +
}
«« 
catch
¬¬ 
(
¬¬ 
	Exception
¬¬  
ex
¬¬! #
)
¬¬# $
{
­­ 
FDebug
®® 
.
®® 
throwException
®® )
(
®®) *
ex
®®* ,
)
®®, -
;
®®- .
}
¯¯ 
finally
°° 
{
±± 
}
³³ 
}
´´ 
}
µµ 	
public
¹¹ 
string
¹¹ 
additionInfo
¹¹ "
{
ºº 	
get
»» 
{
¼¼ 
try
½½ 
{
¾¾ 
return
¿¿ 
m_additionInfo
¿¿ )
;
¿¿) *
}
ÀÀ 
catch
ÁÁ 
(
ÁÁ 
	Exception
ÁÁ  
ex
ÁÁ! #
)
ÁÁ# $
{
ÂÂ 
FDebug
ÃÃ 
.
ÃÃ 
throwException
ÃÃ )
(
ÃÃ) *
ex
ÃÃ* ,
)
ÃÃ, -
;
ÃÃ- .
}
ÄÄ 
finally
ÅÅ 
{
ÆÆ 
}
ÈÈ 
return
ÉÉ 
string
ÉÉ 
.
ÉÉ 
Empty
ÉÉ #
;
ÉÉ# $
}
ÊÊ 
set
ÌÌ 
{
ÍÍ 
try
ÎÎ 
{
ÏÏ 
m_additionInfo
ĞĞ "
=
ĞĞ# $
value
ĞĞ% *
;
ĞĞ* +
}
ÑÑ 
catch
ÒÒ 
(
ÒÒ 
	Exception
ÒÒ  
ex
ÒÒ! #
)
ÒÒ# $
{
ÓÓ 
FDebug
ÔÔ 
.
ÔÔ 
throwException
ÔÔ )
(
ÔÔ) *
ex
ÔÔ* ,
)
ÔÔ, -
;
ÔÔ- .
}
ÕÕ 
finally
ÖÖ 
{
×× 
}
ÙÙ 
}
ÚÚ 
}
ÛÛ 	
}
çç 
}èè ¿
ZD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Debug\c_FException.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 

FException 
:  
ApplicationException 2
{ 
public 

FException 
( 
string 
message 
) 
: 
base 
( 
message 
) 
{ 	
}!! 	
public%% 

FException%% 
(%% 

FException&& 
innerException&& %
)'' 
:(( 
base(( 
((( 
innerException(( "
.((" #
Message((# *
,((* +
innerException((, :
)((: ;
{)) 	
}++ 	
}== 
}>> Æ%
\D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\CodeLock\c_FCodeLock.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
	FCodeLock 
: 
IDisposable (
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
bool 
m_locked 
= 
false  %
;% &
public"" 
	FCodeLock"" 
("" 
)## 
{$$ 	
}&& 	
~** 	
	FCodeLock**	 
(** 
)++ 
{,, 	
	myDispose-- 
(-- 
false-- 
)-- 
;-- 
}.. 	
	protected22 
void22 
	myDispose22  
(22  !
bool33 
	disposing33 
)44 
{55 	
if66 
(66 
!66 

m_disposed66 
)66 
{77 
if88 
(88 
	disposing88 
)88 
{99 
};; 

m_disposed== 
=== 
true== !
;==! "
}>> 
}?? 	
publicGG 
voidGG 
DisposeGG 
(GG 
)HH 
{II 	
	myDisposeJJ 
(JJ 
trueJJ 
)JJ 
;JJ 
GCKK 
.KK 
SuppressFinalizeKK 
(KK  
thisKK  $
)KK$ %
;KK% &
}LL 	
publicTT 
boolTT 
lockedTT 
{UU 	
getVV 
{WW 
tryXX 
{YY 
returnZZ 
m_lockedZZ #
;ZZ# $
}[[ 
catch\\ 
(\\ 
	Exception\\  
ex\\! #
)\\# $
{]] 
FDebug^^ 
.^^ 
throwException^^ )
(^^) *
ex^^* ,
)^^, -
;^^- .
}__ 
finally`` 
{aa 
}cc 
returndd 
falsedd 
;dd 
}ee 
}ff 	
publicnn 
voidnn 
waitnn 
(nn 
)oo 
{pp 	
tryqq 
{rr 
Monitorss 
.ss 
Enterss 
(ss 
thisss "
)ss" #
;ss# $
m_lockedtt 
=tt 
truett 
;tt  
}uu 
catchvv 
(vv 
	Exceptionvv 
exvv 
)vv  
{ww 
FDebugxx 
.xx 
throwExceptionxx %
(xx% &
exxx& (
)xx( )
;xx) *
}yy 
finallyzz 
{{{ 
}}} 
}~~ 	
public
‚‚ 
bool
‚‚ 
tryWait
‚‚ 
(
‚‚ 
int
ƒƒ 
time
ƒƒ 
)
„„ 
{
…… 	
bool
†† 
isWait
†† 
=
†† 
false
†† 
;
††  
try
ˆˆ 
{
‰‰ 
isWait
ŠŠ 
=
ŠŠ 
Monitor
ŠŠ  
.
ŠŠ  !
TryEnter
ŠŠ! )
(
ŠŠ) *
this
ŠŠ* .
,
ŠŠ. /
time
ŠŠ0 4
)
ŠŠ4 5
;
ŠŠ5 6
if
‹‹ 
(
‹‹ 
isWait
‹‹ 
)
‹‹ 
{
ŒŒ 
m_locked
 
=
 
true
 #
;
# $
}
 
return
 
isWait
 
;
 
}
 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘ 
ex
‘‘ 
)
‘‘  
{
’’ 
FDebug
““ 
.
““ 
throwException
““ %
(
““% &
ex
““& (
)
““( )
;
““) *
}
”” 
finally
•• 
{
–– 
}
˜˜ 
return
™™ 
false
™™ 
;
™™ 
}
šš 	
public
 
void
 
set
 
(
 
)
ŸŸ 
{
   	
try
¡¡ 
{
¢¢ 
m_locked
££ 
=
££ 
false
££  
;
££  !
Monitor
¤¤ 
.
¤¤ 
Exit
¤¤ 
(
¤¤ 
this
¤¤ !
)
¤¤! "
;
¤¤" #
}
¥¥ 
catch
¦¦ 
(
¦¦ 
	Exception
¦¦ 
ex
¦¦ 
)
¦¦  
{
§§ 
FDebug
¨¨ 
.
¨¨ 
throwException
¨¨ %
(
¨¨% &
ex
¨¨& (
)
¨¨( )
;
¨¨) *
}
©© 
finally
ªª 
{
«« 
}
­­ 
}
®® 	
}
´´ 
}µµ İ‡
VD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Debug\c_FDebug.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

static 
class 
FDebug 
{ 
private 
static 
	FCodeLock  
m_fCodeLock! ,
=- .
new/ 2
	FCodeLock3 <
(< =
)= >
;> ?
private 
static 
string 
m_logFilePath +
=, -
string. 4
.4 5
Empty5 :
;: ;
private   
static   
string   
m_logFileSuffix   -
=  . /
string  0 6
.  6 7
Empty  7 <
;  < =
private!! 
static!! 
int!! "
m_logFileKeepingPeriod!! 1
=!!2 3
$num!!4 6
;!!6 7
private"" 
static"" 
bool"" &
m_logFileAutoDeleteEnabled"" 6
=""7 8
false""9 >
;""> ?
private## 
static## 
int## 
m_maxLogFileSize## +
=##, -
$num##. 2
*##3 4
$num##5 9
*##: ;
$num##< >
;##> ?
static)) 
FDebug)) 
()) 
)** 
{++ 	
}-- 	
public55 
static55 
string55 
logFilePath55 (
{66 	
get77 
{88 
try99 
{:: 
return;; 
m_logFilePath;; (
;;;( )
}<< 
catch== 
(== 
	Exception==  
ex==! #
)==# $
{>> 
FDebug?? 
.?? 
throwException?? )
(??) *
ex??* ,
)??, -
;??- .
}@@ 
finallyAA 
{BB 
}DD 
returnEE 
stringEE 
.EE 
EmptyEE #
;EE# $
}FF 
setHH 
{II 
tryJJ 
{KK 
m_logFilePathLL !
=LL" #
valueLL$ )
;LL) *
}MM 
catchNN 
(NN 
	ExceptionNN  
exNN! #
)NN# $
{OO 
FDebugPP 
.PP 
throwExceptionPP )
(PP) *
exPP* ,
)PP, -
;PP- .
}QQ 
finallyRR 
{SS 
}UU 
}VV 
}WW 	
public[[ 
static[[ 
string[[ 
logFileSuffix[[ *
{\\ 	
get]] 
{^^ 
try__ 
{`` 
returnaa 
m_logFileSuffixaa *
;aa* +
}bb 
catchcc 
(cc 
	Exceptioncc  
excc! #
)cc# $
{dd 
FDebugee 
.ee 
throwExceptionee )
(ee) *
exee* ,
)ee, -
;ee- .
}ff 
finallygg 
{hh 
}jj 
returnkk 
stringkk 
.kk 
Emptykk #
;kk# $
}ll 
setnn 
{oo 
trypp 
{qq 
m_logFileSuffixrr #
=rr$ %
valuerr& +
;rr+ ,
}ss 
catchtt 
(tt 
	Exceptiontt  
extt! #
)tt# $
{uu 
FDebugvv 
.vv 
throwExceptionvv )
(vv) *
exvv* ,
)vv, -
;vv- .
}ww 
finallyxx 
{yy 
}{{ 
}|| 
}}} 	
public
 
static
 
bool
 &
logFileAutoDeleteEnabled
 3
{
‚‚ 	
get
ƒƒ 
{
„„ 
try
…… 
{
†† 
return
‡‡ (
m_logFileAutoDeleteEnabled
‡‡ 5
;
‡‡5 6
}
ˆˆ 
catch
‰‰ 
(
‰‰ 
	Exception
‰‰  
ex
‰‰! #
)
‰‰# $
{
ŠŠ 
FDebug
‹‹ 
.
‹‹ 
throwException
‹‹ )
(
‹‹) *
ex
‹‹* ,
)
‹‹, -
;
‹‹- .
}
ŒŒ 
finally
 
{
 
}
 
return
‘‘ 
false
‘‘ 
;
‘‘ 
}
’’ 
set
”” 
{
•• 
try
–– 
{
—— (
m_logFileAutoDeleteEnabled
˜˜ .
=
˜˜/ 0
value
˜˜1 6
;
˜˜6 7
}
™™ 
catch
šš 
(
šš 
	Exception
šš  
ex
šš! #
)
šš# $
{
›› 
FDebug
œœ 
.
œœ 
throwException
œœ )
(
œœ) *
ex
œœ* ,
)
œœ, -
;
œœ- .
}
 
finally
 
{
ŸŸ 
}
¡¡ 
}
¢¢ 
}
££ 	
public
§§ 
static
§§ 
int
§§ "
logFileKeepingPeriod
§§ .
{
¨¨ 	
get
©© 
{
ªª 
try
«« 
{
¬¬ 
return
­­ $
m_logFileKeepingPeriod
­­ 1
;
­­1 2
}
®® 
catch
¯¯ 
(
¯¯ 
	Exception
¯¯  
ex
¯¯! #
)
¯¯# $
{
°° 
FDebug
±± 
.
±± 
throwException
±± )
(
±±) *
ex
±±* ,
)
±±, -
;
±±- .
}
²² 
finally
³³ 
{
´´ 
}
¶¶ 
return
·· 
$num
·· 
;
·· 
}
¸¸ 
set
ºº 
{
»» 
try
¼¼ 
{
½½ $
m_logFileKeepingPeriod
¾¾ *
=
¾¾+ ,
value
¾¾- 2
;
¾¾2 3
}
¿¿ 
catch
ÀÀ 
(
ÀÀ 
	Exception
ÀÀ  
ex
ÀÀ! #
)
ÀÀ# $
{
ÁÁ 
FDebug
ÂÂ 
.
ÂÂ 
throwException
ÂÂ )
(
ÂÂ) *
ex
ÂÂ* ,
)
ÂÂ, -
;
ÂÂ- .
}
ÃÃ 
finally
ÄÄ 
{
ÅÅ 
}
ÇÇ 
}
ÈÈ 
}
ÉÉ 	
public
ÍÍ 
static
ÍÍ 
int
ÍÍ 
maxLogFileSize
ÍÍ (
{
ÎÎ 	
get
ÏÏ 
{
ĞĞ 
try
ÑÑ 
{
ÒÒ 
return
ÓÓ 
m_maxLogFileSize
ÓÓ +
;
ÓÓ+ ,
}
ÔÔ 
catch
ÕÕ 
(
ÕÕ 
	Exception
ÕÕ  
ex
ÕÕ! #
)
ÕÕ# $
{
ÖÖ 
FDebug
×× 
.
×× 
throwException
×× )
(
××) *
ex
××* ,
)
××, -
;
××- .
}
ØØ 
finally
ÙÙ 
{
ÚÚ 
}
ÜÜ 
return
İİ 
$num
İİ 
;
İİ 
}
ŞŞ 
set
àà 
{
áá 
try
ãã 
{
ää 
m_maxLogFileSize
åå $
=
åå% &
value
åå' ,
;
åå, -
}
ææ 
catch
çç 
(
çç 
	Exception
çç  
ex
çç! #
)
çç# $
{
èè 
FDebug
éé 
.
éé 
throwException
éé )
(
éé) *
ex
éé* ,
)
éé, -
;
éé- .
}
êê 
finally
ëë 
{
ìì 
}
îî 
}
ïï 
}
ññ 	
public
úú 
static
úú 
void
úú 
throwFException
úú *
(
úú* +
string
ûû 
message
ûû 
)
üü 
{
ıı 	
throw
şş 
new
şş 

FException
şş  
(
şş  !
message
şş! (
)
şş( )
;
şş) *
}
ÿÿ 	
public
ƒƒ 
static
ƒƒ 
void
ƒƒ 
throwException
ƒƒ )
(
ƒƒ) *
	Exception
„„ 
innerException
„„ $
)
…… 
{
†† 	
writeLog
‡‡ 
(
‡‡ 
innerException
‡‡ #
)
‡‡# $
;
‡‡$ %
if
‰‰ 
(
‰‰ 
innerException
‰‰ 
.
‰‰ 
InnerException
‰‰ -
!=
‰‰. 0
null
‰‰1 5
)
‰‰5 6
{
ŠŠ 
throw
‹‹ 
innerException
‹‹ $
;
‹‹$ %
}
ŒŒ 
else
 
{
 
throw
 
new
 
	Exception
 #
(
# $
innerException
$ 2
.
2 3
Message
3 :
,
: ;
innerException
< J
)
J K
;
K L
}
 
}
‘‘ 	
public
•• 
static
•• 
void
•• 
writeLog
•• #
(
••# $
	Exception
–– 
	exception
–– 
)
—— 
{
˜˜ 	
FDebugLogArgs
™™ 
args
™™ 
=
™™  
null
™™! %
;
™™% &
try
›› 
{
œœ 
if
 
(
 
	exception
 
.
 
InnerException
 ,
!=
- /
null
0 4
)
4 5
{
 
return
ŸŸ 
;
ŸŸ 
}
   
if
¤¤ 
(
¤¤ 
	exception
¤¤ 
.
¤¤ 
GetBaseException
¤¤ .
(
¤¤. /
)
¤¤/ 0
is
¤¤1 3

FException
¤¤4 >
)
¤¤> ?
{
¥¥ 
args
¦¦ 
=
¦¦ 
new
¦¦ 
FDebugLogArgs
¦¦ ,
(
¦¦, -
FDebugLogCategory
§§ )
.
§§) *

FException
§§* 4
,
§§4 5
$str
¨¨ )
,
¨¨) *
$str
©© 6
,
©©6 7
$str
ªª  
,
ªª  !
$str
«« "
)
¬¬ 
;
¬¬ 
}
­­ 
else
®® 
{
¯¯ 
args
°° 
=
°° 
new
°° 
FDebugLogArgs
°° ,
(
°°, -
FDebugLogCategory
±± )
.
±±) *
	Exception
±±* 3
,
±±3 4
$str
²² (
,
²²( )
$str
³³ 6
,
³³6 7
$str
´´  
,
´´  !
$str
µµ "
)
¶¶ 
;
¶¶ 
}
·· 
args
¸¸ 
.
¸¸ 
additionInfo
¸¸ !
=
¸¸" #
	exception
¸¸$ -
.
¸¸- .
ToString
¸¸. 6
(
¸¸6 7
)
¸¸7 8
;
¸¸8 9
writeLog
¹¹ 
(
¹¹ 
args
¹¹ 
)
¹¹ 
;
¹¹ 
}
ºº 
catch
»» 
(
»» 
	Exception
»» 
ex
»» 
)
»»  
{
¼¼ 
System
½½ 
.
½½ 
Diagnostics
½½ "
.
½½" #
Debug
½½# (
.
½½( )
	WriteLine
½½) 2
(
½½2 3
ex
½½3 5
.
½½5 6
ToString
½½6 >
(
½½> ?
)
½½? @
)
½½@ A
;
½½A B
}
¾¾ 
finally
¿¿ 
{
ÀÀ 
args
ÁÁ 
=
ÁÁ 
null
ÁÁ 
;
ÁÁ 
}
ÂÂ 
}
ÃÃ 	
public
ÇÇ 
static
ÇÇ 
void
ÇÇ 
writeLog
ÇÇ #
(
ÇÇ# $
FDebugLogArgs
ÈÈ 
args
ÈÈ 
)
ÉÉ 
{
ÊÊ 	
const
ËË 
string
ËË 
HeaderFormat
ËË %
=
ËË& '
$str
ËË( @
;
ËË@ A
const
ÌÌ 
string
ÌÌ 
ContentsFormat
ÌÌ '
=
ÌÌ( )
$str
ÌÌ* i
;
ÌÌi j
string
ÎÎ 
filePath
ÎÎ 
=
ÎÎ 
string
ÎÎ $
.
ÎÎ$ %
Empty
ÎÎ% *
;
ÎÎ* +
string
ÏÏ 

fileSuffix
ÏÏ 
=
ÏÏ 
string
ÏÏ  &
.
ÏÏ& '
Empty
ÏÏ' ,
;
ÏÏ, -
int
ĞĞ 
fileKeepingPeriod
ĞĞ !
=
ĞĞ" #
$num
ĞĞ$ %
;
ĞĞ% &
bool
ÑÑ 
autoDeleteEnabled
ÑÑ "
=
ÑÑ# $
false
ÑÑ% *
;
ÑÑ* +
string
ÒÒ 
header
ÒÒ 
=
ÒÒ 
string
ÒÒ "
.
ÒÒ" #
Empty
ÒÒ# (
;
ÒÒ( )
StringBuilder
ÓÓ 
log
ÓÓ 
=
ÓÓ 
null
ÓÓ  $
;
ÓÓ$ %
DateTime
ÔÔ 
dt
ÔÔ 
;
ÔÔ 
string
ÕÕ 
fileName
ÕÕ 
=
ÕÕ 
string
ÕÕ $
.
ÕÕ$ %
Empty
ÕÕ% *
;
ÕÕ* +
string
ÖÖ 
[
ÖÖ 
]
ÖÖ 
files
ÖÖ 
=
ÖÖ 
null
ÖÖ !
;
ÖÖ! "
StreamWriter
×× 
sw
×× 
=
×× 
null
×× "
;
××" #
FileInfo
ØØ 
fileInfo
ØØ 
=
ØØ 
null
ØØ  $
;
ØØ$ %

FileStream
ÙÙ 
fs
ÙÙ 
=
ÙÙ 
null
ÙÙ  
;
ÙÙ  !
try
ÛÛ 
{
ÜÜ 
m_fCodeLock
İİ 
.
İİ 
wait
İİ  
(
İİ  !
)
İİ! "
;
İİ" #
if
áá 
(
áá 
m_logFilePath
áá !
==
áá" $
string
áá% +
.
áá+ ,
Empty
áá, 1
)
áá1 2
{
ââ 
m_logFilePath
ãã !
=
ãã" #
Application
ãã$ /
.
ãã/ 0
StartupPath
ãã0 ;
+
ãã< =
$str
ãã> E
;
ããE F
}
ää 
filePath
åå 
=
åå 
m_logFilePath
åå (
;
åå( )

fileSuffix
ææ 
=
ææ 
m_logFileSuffix
ææ ,
;
ææ, -
fileKeepingPeriod
çç !
=
çç" #$
m_logFileKeepingPeriod
çç$ :
;
çç: ;
autoDeleteEnabled
èè !
=
èè" #(
m_logFileAutoDeleteEnabled
èè$ >
;
èè> ?
if
ìì 
(
ìì 
!
ìì 
	Directory
ìì 
.
ìì 
Exists
ìì %
(
ìì% &
filePath
ìì& .
)
ìì. /
)
ìì/ 0
{
íí 
	Directory
îî 
.
îî 
CreateDirectory
îî -
(
îî- .
filePath
îî. 6
)
îî6 7
;
îî7 8
}
ïï 
header
óó 
=
óó 
string
óó 
.
óó  
Format
óó  &
(
óó& '
HeaderFormat
ôô  
,
ôô  !
DateTime
õõ 
.
õõ 
Now
õõ  
.
õõ  !
ToString
õõ! )
(
õõ) *
$str
õõ* C
)
õõC D
,
õõD E%
getDebugLogCategoryFlag
öö +
(
öö+ ,
args
öö, 0
.
öö0 1
	fCategory
öö1 :
)
öö: ;
)
÷÷ 
;
÷÷ 
log
ùù 
=
ùù 
new
ùù 
StringBuilder
ùù '
(
ùù' (
)
ùù( )
;
ùù) *
log
úú 
.
úú 
Append
úú 
(
úú 
header
úú !
)
úú! "
;
úú" #
log
ûû 
.
ûû 
Append
ûû 
(
ûû 
string
üü 
.
üü 
Format
üü !
(
üü! "
ContentsFormat
üü" 0
,
üü0 1
args
üü2 6
.
üü6 7
action
üü7 =
,
üü= >
args
üü? C
.
üüC D
typeNamespace
üüD Q
,
üüQ R
args
üüS W
.
üüW X
typeName
üüX `
,
üü` a
args
üüb f
.
üüf g
functionName
üüg s
)
üüs t
)
ıı 
;
ıı 
if
„„ 
(
„„ 
args
„„ 
.
„„ 
additionInfo
„„ %
!=
„„& (
string
„„) /
.
„„/ 0
Empty
„„0 5
)
„„5 6
{
…… 
header
‰‰ 
+=
‰‰ 
$str
‰‰ !
;
‰‰! "
log
‹‹ 
.
‹‹ 
Append
‹‹ 
(
‹‹ 
Environment
‹‹ *
.
‹‹* +
NewLine
‹‹+ 2
)
‹‹2 3
;
‹‹3 4
log
ŒŒ 
.
ŒŒ 
Append
ŒŒ 
(
ŒŒ 
header
ŒŒ %
)
ŒŒ% &
;
ŒŒ& '
log
 
.
 
Append
 
(
 
$str
 ;
)
; <
;
< =
foreach
 
(
 
string
 #
s
$ %
in
& (
args
) -
.
- .
additionInfo
. :
.
: ;
Split
; @
(
@ A
Environment
A L
.
L M
NewLine
M T
.
T U
ToCharArray
U `
(
` a
)
a b
,
b c 
StringSplitOptions
d v
.
v w!
RemoveEmptyEntriesw ‰
)‰ Š
)Š ‹
{
 
log
‘‘ 
.
‘‘ 
Append
‘‘ "
(
‘‘" #
Environment
‘‘# .
.
‘‘. /
NewLine
‘‘/ 6
)
‘‘6 7
;
‘‘7 8
log
’’ 
.
’’ 
Append
’’ "
(
’’" #
header
’’# )
)
’’) *
;
’’* +
log
““ 
.
““ 
Append
““ "
(
““" #
s
““# $
)
““$ %
;
““% &
}
”” 
}
•• 
log
—— 
.
—— 
Append
—— 
(
—— 
Environment
—— &
.
——& '
NewLine
——' .
)
——. /
;
——/ 0
log
˜˜ 
.
˜˜ 
Append
˜˜ 
(
˜˜ 
$str
˜˜ 
)
˜˜ 
;
˜˜  
dt
¢¢ 
=
¢¢ 
DateTime
¢¢ 
.
¢¢ 
Now
¢¢ !
;
¢¢! "
fileName
££ 
=
££ 
dt
££ 
.
££ 
ToString
££ &
(
££& '
$str
££' 1
)
££1 2
+
££3 4
$str
££5 8
+
££9 :
(
££; <

fileSuffix
££< F
==
££G I
string
££J P
.
££P Q
Empty
££Q V
?
££W X
string
££Y _
.
££_ `
Empty
££` e
:
££f g
$str
££h k
+
££l m

fileSuffix
££n x
)
££x y
+
££z {
$str££| ‚
;££‚ ƒ
files
¤¤ 
=
¤¤ 
	Directory
¤¤ !
.
¤¤! "
GetFiles
¤¤" *
(
¤¤* +
filePath
¤¤+ 3
,
¤¤3 4
fileName
¤¤5 =
)
¤¤= >
;
¤¤> ?
if
¥¥ 
(
¥¥ 
files
¥¥ 
.
¥¥ 
Length
¥¥  
>
¥¥! "
$num
¥¥# $
)
¥¥$ %
{
¦¦ 
fileName
§§ 
=
§§ 
files
§§ $
[
§§$ %
files
§§% *
.
§§* +
Length
§§+ 1
-
§§2 3
$num
§§4 5
]
§§5 6
;
§§6 7
fileInfo
¨¨ 
=
¨¨ 
new
¨¨ "
FileInfo
¨¨# +
(
¨¨+ ,
fileName
¨¨, 4
)
¨¨4 5
;
¨¨5 6
if
©© 
(
©© 
fileInfo
©©  
.
©©  !
Length
©©! '
>
©©( )
m_maxLogFileSize
©©* :
)
©©: ;
{
ªª 
fileName
««  
=
««! "
filePath
««# +
+
««, -
$str
««. 2
+
««3 4
dt
««5 7
.
««7 8
ToString
««8 @
(
««@ A
$str
««A T
)
««T U
+
««V W
(
««X Y

fileSuffix
««Y c
==
««d f
string
««g m
.
««m n
Empty
««n s
?
««t u
string
««v |
.
««| }
Empty««} ‚
:««ƒ „
$str««… ˆ
+««‰ Š

fileSuffix««‹ •
)««• –
+««— ˜
$str««™ Ÿ
;««Ÿ  
}
¬¬ 
}
­­ 
else
®® 
{
¯¯ 
fileName
°° 
=
°° 
filePath
°° '
+
°°( )
$str
°°* .
+
°°/ 0
dt
°°1 3
.
°°3 4
ToString
°°4 <
(
°°< =
$str
°°= P
)
°°P Q
+
°°R S
(
°°T U

fileSuffix
°°U _
==
°°` b
string
°°c i
.
°°i j
Empty
°°j o
?
°°p q
string
°°r x
.
°°x y
Empty
°°y ~
:°° €
$str°° „
+°°… †

fileSuffix°°‡ ‘
)°°‘ ’
+°°“ ”
$str°°• ›
;°°› œ
}
±± 
sw
³³ 
=
³³ 
new
³³ 
StreamWriter
³³ %
(
³³% &
fileName
³³& .
,
³³. /
true
³³0 4
,
³³4 5
Encoding
³³6 >
.
³³> ?
Default
³³? F
)
³³F G
;
³³G H
sw
´´ 
.
´´ 
	WriteLine
´´ 
(
´´ 
log
´´  
.
´´  !
ToString
´´! )
(
´´) *
)
´´* +
)
´´+ ,
;
´´, -
sw
µµ 
.
µµ 
Flush
µµ 
(
µµ 
)
µµ 
;
µµ 
sw
¶¶ 
.
¶¶ 
Close
¶¶ 
(
¶¶ 
)
¶¶ 
;
¶¶ 
sw
·· 
=
·· 
null
·· 
;
·· 
if
¾¾ 
(
¾¾ 
autoDeleteEnabled
¾¾ %
)
¾¾% &
{
¿¿ 
fileName
ÀÀ 
=
ÀÀ 
dt
ÀÀ !
.
ÀÀ! "
AddDays
ÀÀ" )
(
ÀÀ) *
fileKeepingPeriod
ÀÀ* ;
*
ÀÀ< =
-
ÀÀ> ?
$num
ÀÀ? @
)
ÀÀ@ A
.
ÀÀA B
ToString
ÀÀB J
(
ÀÀJ K
$str
ÀÀK U
)
ÀÀU V
;
ÀÀV W
foreach
ÁÁ 
(
ÁÁ 
string
ÁÁ #
s
ÁÁ$ %
in
ÁÁ& (
	Directory
ÁÁ) 2
.
ÁÁ2 3
GetFiles
ÁÁ3 ;
(
ÁÁ; <
filePath
ÁÁ< D
,
ÁÁD E
$str
ÁÁF M
)
ÁÁM N
)
ÁÁN O
{
ÂÂ 
if
ÃÃ 
(
ÃÃ 
fileName
ÃÃ $
.
ÃÃ$ %
	CompareTo
ÃÃ% .
(
ÃÃ. /
Path
ÃÃ/ 3
.
ÃÃ3 4
GetFileName
ÃÃ4 ?
(
ÃÃ? @
s
ÃÃ@ A
)
ÃÃA B
)
ÃÃB C
<
ÃÃD E
$num
ÃÃF G
)
ÃÃG H
{
ÄÄ 
break
ÅÅ !
;
ÅÅ! "
}
ÆÆ 
File
ÇÇ 
.
ÇÇ 
Delete
ÇÇ #
(
ÇÇ# $
s
ÇÇ$ %
)
ÇÇ% &
;
ÇÇ& '
}
ÈÈ 
}
ÉÉ 
}
ÊÊ 
catch
ËË 
(
ËË 
	Exception
ËË 
ex
ËË 
)
ËË  
{
ÌÌ 
System
ÍÍ 
.
ÍÍ 
Diagnostics
ÍÍ "
.
ÍÍ" #
Debug
ÍÍ# (
.
ÍÍ( )
	WriteLine
ÍÍ) 2
(
ÍÍ2 3
ex
ÍÍ3 5
.
ÍÍ5 6
ToString
ÍÍ6 >
(
ÍÍ> ?
)
ÍÍ? @
)
ÍÍ@ A
;
ÍÍA B
}
ÎÎ 
finally
ÏÏ 
{
ĞĞ 
if
ÑÑ 
(
ÑÑ 
sw
ÑÑ 
!=
ÑÑ 
null
ÑÑ 
)
ÑÑ 
{
ÒÒ 
sw
ÓÓ 
.
ÓÓ 
Flush
ÓÓ 
(
ÓÓ 
)
ÓÓ 
;
ÓÓ 
sw
ÔÔ 
.
ÔÔ 
Close
ÔÔ 
(
ÔÔ 
)
ÔÔ 
;
ÔÔ 
sw
ÕÕ 
=
ÕÕ 
null
ÕÕ 
;
ÕÕ 
}
ÖÖ 
log
×× 
=
×× 
null
×× 
;
×× 
m_fCodeLock
ØØ 
.
ØØ 
set
ØØ 
(
ØØ  
)
ØØ  !
;
ØØ! "
}
ÙÙ 
}
ÚÚ 	
private
ŞŞ 
static
ŞŞ 
string
ŞŞ %
getDebugLogCategoryFlag
ŞŞ 5
(
ŞŞ5 6
FDebugLogCategory
ßß 
	fCategory
ßß '
)
àà 
{
áá 	
try
ââ 
{
ãã 
if
ää 
(
ää 
	fCategory
ää 
==
ää  
FDebugLogCategory
ää! 2
.
ää2 3

FException
ää3 =
)
ää= >
{
åå 
return
ææ 
$str
ææ 
;
ææ 
}
çç 
else
èè 
if
èè 
(
èè 
	fCategory
èè "
==
èè# %
FDebugLogCategory
èè& 7
.
èè7 8
	Exception
èè8 A
)
èèA B
{
éé 
return
êê 
$str
êê 
;
êê 
}
ëë 
else
ìì 
{
íí 
return
îî 
$str
îî 
;
îî 
}
ïï 
}
ğğ 
catch
ññ 
(
ññ 
	Exception
ññ 
ex
ññ 
)
ññ  
{
òò 
System
óó 
.
óó 
Diagnostics
óó "
.
óó" #
Debug
óó# (
.
óó( )
	WriteLine
óó) 2
(
óó2 3
ex
óó3 5
.
óó5 6
ToString
óó6 >
(
óó> ?
)
óó? @
)
óó@ A
;
óóA B
}
ôô 
finally
õõ 
{
öö 
}
øø 
return
ùù 
string
ùù 
.
ùù 
Empty
ùù 
;
ùù  
}
úú 	
public
şş 
static
şş 
long
şş 
start
şş  
(
şş  !
)
ÿÿ 
{
€€ 	
try
 
{
‚‚ 
return
ƒƒ 
DateTime
ƒƒ 
.
ƒƒ  
Now
ƒƒ  #
.
ƒƒ# $
Ticks
ƒƒ$ )
;
ƒƒ) *
}
„„ 
catch
…… 
(
…… 
	Exception
…… 
ex
…… 
)
……  
{
†† 
System
‡‡ 
.
‡‡ 
Diagnostics
‡‡ "
.
‡‡" #
Debug
‡‡# (
.
‡‡( )
Write
‡‡) .
(
‡‡. /
ex
‡‡/ 1
.
‡‡1 2
ToString
‡‡2 :
(
‡‡: ;
)
‡‡; <
)
‡‡< =
;
‡‡= >
}
ˆˆ 
finally
‰‰ 
{
ŠŠ 
}
ŒŒ 
return
 
$num
 
;
 
}
 	
public
’’ 
static
’’ 
void
’’ 
end
’’ 
(
’’ 
string
““ 
	className
““ 
,
““ 
string
”” 

methodName
”” 
,
”” 
string
•• 
description
•• 
,
•• 
long
–– 
start
–– 
)
—— 
{
˜˜ 	
long
™™ 
end
™™ 
=
™™ 
$num
™™ 
;
™™ 
string
šš 
output
šš 
=
šš 
string
šš "
.
šš" #
Empty
šš# (
;
šš( )
DateTime
›› 
now
›› 
=
›› 
DateTime
›› #
.
››# $
Now
››$ '
;
››' (
try
œœ 
{
 
end
 
=
 
DateTime
 
.
 
Now
 "
.
" #
Ticks
# (
;
( )
output
ŸŸ 
=
ŸŸ 
string
   
.
   
Format
   !
(
  ! "
$str
  " <
,
  < =
now
¡¡ 
.
¡¡ 
ToString
¡¡  
(
¡¡  !
$str
¡¡! :
)
¡¡: ;
,
¡¡; <
now
¢¢ 
.
¢¢ 
Millisecond
¢¢ #
,
¢¢# $
	className
££ 
,
££ 

methodName
¤¤ 
,
¤¤ 
description
¥¥ 
,
¥¥  
(
¦¦ 
double
¦¦ 
)
¦¦ 
(
¦¦ 
end
¦¦  
-
¦¦! "
start
¦¦# (
)
¦¦( )
/
¦¦* +
$num
¦¦, 7
)
§§ 
;
§§ 
System
¨¨ 
.
¨¨ 
Diagnostics
¨¨ "
.
¨¨" #
Debug
¨¨# (
.
¨¨( )
	WriteLine
¨¨) 2
(
¨¨2 3
output
¨¨3 9
)
¨¨9 :
;
¨¨: ;
}
©© 
catch
ªª 
(
ªª 
	Exception
ªª 
ex
ªª 
)
ªª  
{
«« 
System
¬¬ 
.
¬¬ 
Diagnostics
¬¬ "
.
¬¬" #
Debug
¬¬# (
.
¬¬( )
Write
¬¬) .
(
¬¬. /
ex
¬¬/ 1
.
¬¬1 2
ToString
¬¬2 :
(
¬¬: ;
)
¬¬; <
)
¬¬< =
;
¬¬= >
}
­­ 
finally
®® 
{
¯¯ 
}
±± 
}
²² 	
public
¶¶ 
static
¶¶ 
void
¶¶ 
end
¶¶ 
(
¶¶ 
string
·· 
	className
·· 
,
·· 
string
¸¸ 

methodName
¸¸ 
,
¸¸ 
long
¹¹ 
start
¹¹ 
)
ºº 
{
»» 	
long
¼¼ 
end
¼¼ 
=
¼¼ 
$num
¼¼ 
;
¼¼ 
string
½½ 
output
½½ 
=
½½ 
string
½½ "
.
½½" #
Empty
½½# (
;
½½( )
DateTime
¾¾ 
now
¾¾ 
=
¾¾ 
DateTime
¾¾ #
.
¾¾# $
Now
¾¾$ '
;
¾¾' (
try
¿¿ 
{
ÀÀ 
end
ÁÁ 
=
ÁÁ 
DateTime
ÁÁ 
.
ÁÁ 
Now
ÁÁ "
.
ÁÁ" #
Ticks
ÁÁ# (
;
ÁÁ( )
output
ÂÂ 
=
ÂÂ 
string
ÃÃ 
.
ÃÃ 
Format
ÃÃ !
(
ÃÃ! "
$str
ÃÃ" 9
,
ÃÃ9 :
now
ÄÄ 
.
ÄÄ 
ToString
ÄÄ  
(
ÄÄ  !
$str
ÄÄ! :
)
ÄÄ: ;
,
ÄÄ; <
now
ÅÅ 
.
ÅÅ 
Millisecond
ÅÅ #
,
ÅÅ# $
	className
ÆÆ 
,
ÆÆ 

methodName
ÇÇ 
,
ÇÇ 
(
ÈÈ 
double
ÈÈ 
)
ÈÈ 
(
ÈÈ 
end
ÈÈ  
-
ÈÈ! "
start
ÈÈ# (
)
ÈÈ( )
/
ÈÈ* +
$num
ÈÈ, 7
)
ÉÉ 
;
ÉÉ 
System
ÊÊ 
.
ÊÊ 
Diagnostics
ÊÊ "
.
ÊÊ" #
Debug
ÊÊ# (
.
ÊÊ( )
	WriteLine
ÊÊ) 2
(
ÊÊ2 3
output
ÊÊ3 9
)
ÊÊ9 :
;
ÊÊ: ;
}
ËË 
catch
ÌÌ 
(
ÌÌ 
	Exception
ÌÌ 
ex
ÌÌ 
)
ÌÌ  
{
ÍÍ 
System
ÎÎ 
.
ÎÎ 
Diagnostics
ÎÎ "
.
ÎÎ" #
Debug
ÎÎ# (
.
ÎÎ( )
Write
ÎÎ) .
(
ÎÎ. /
ex
ÎÎ/ 1
.
ÎÎ1 2
ToString
ÎÎ2 :
(
ÎÎ: ;
)
ÎÎ; <
)
ÎÎ< =
;
ÎÎ= >
}
ÏÏ 
finally
ĞĞ 
{
ÑÑ 
}
ÓÓ 
}
ÔÔ 	
public
ØØ 
static
ØØ 
void
ØØ 

writeTrace
ØØ %
(
ØØ% &
string
ÙÙ 
message
ÙÙ 
,
ÙÙ 
params
ÚÚ 
object
ÚÚ 
[
ÚÚ 
]
ÚÚ 
add
ÚÚ 
)
ÛÛ 
{
ÜÜ 	
StringBuilder
İİ 
sb
İİ 
=
İİ 
null
İİ #
;
İİ# $
try
ŞŞ 
{
ßß 
if
àà 
(
àà 
add
àà 
.
àà 
Length
àà 
==
àà !
$num
àà" #
)
àà# $
{
áá 
System
ââ 
.
ââ 
Diagnostics
ââ &
.
ââ& '
Debug
ââ' ,
.
ââ, -
	WriteLine
ââ- 6
(
ââ6 7
$str
ââ7 P
,
ââP Q
DateTime
ââR Z
.
ââZ [
Now
ââ[ ^
.
ââ^ _
ToString
ââ_ g
(
ââg h
$strââh 
)ââ ‚
,ââ‚ ƒ
messageââ„ ‹
)ââ‹ Œ
;ââŒ 
}
ãã 
else
ää 
{
åå 
sb
ææ 
=
ææ 
new
ææ 
StringBuilder
ææ *
(
ææ* +
)
ææ+ ,
;
ææ, -
sb
çç 
.
çç 

AppendLine
çç !
(
çç! "
$str
çç" :
)
çç: ;
;
çç; <
for
èè 
(
èè 
int
èè 
i
èè 
=
èè  
$num
èè! "
;
èè" #
i
èè$ %
<
èè& '
add
èè( +
.
èè+ ,
Length
èè, 2
;
èè2 3
i
èè4 5
++
èè5 7
)
èè7 8
{
éé 
sb
êê 
.
êê 
AppendFormat
êê '
(
êê' (
$str
êê( @
,
êê@ A
i
êêB C
+
êêD E
$num
êêF G
,
êêG H
add
êêI L
[
êêL M
i
êêM N
]
êêN O
)
êêO P
;
êêP Q
}
ëë 
sb
ìì 
.
ìì 
Append
ìì 
(
ìì 
$str
ìì "
)
ìì" #
;
ìì# $
System
íí 
.
íí 
Diagnostics
íí &
.
íí& '
Debug
íí' ,
.
íí, -
	WriteLine
íí- 6
(
íí6 7
sb
íí7 9
.
íí9 :
ToString
íí: B
(
ííB C
)
ííC D
,
ííD E
DateTime
ííF N
.
ííN O
Now
ííO R
.
ííR S
ToString
ííS [
(
íí[ \
$str
íí\ u
)
ííu v
,
íív w
message
ííx 
)íí €
;íí€ 
}
îî 
}
ïï 
catch
ğğ 
(
ğğ 
	Exception
ğğ 
ex
ğğ 
)
ğğ  
{
ññ 
System
òò 
.
òò 
Diagnostics
òò "
.
òò" #
Debug
òò# (
.
òò( )
Write
òò) .
(
òò. /
ex
òò/ 1
.
òò1 2
ToString
òò2 :
(
òò: ;
)
òò; <
)
òò< =
;
òò= >
}
óó 
finally
ôô 
{
õõ 
}
÷÷ 
}
øø 	
}
şş 
}ÿÿ °
[D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Common\c_FConstants.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
internal 
static 
class 

FConstants $
{ 
public   
const   
string   

err_m_0001   &
=  ' (
$str  ) G
;  G H
public'' 
const'' 
string'' 

err_m_0002'' &
=''' (
$str'') G
;''G H
public.. 
const.. 
string.. 

err_m_0003.. &
=..' (
$str..) B
;..B C
public55 
const55 
string55 

err_m_000455 &
=55' (
$str55) B
;55B C
public<< 
const<< 
string<< 

err_m_0005<< &
=<<' (
$str<<) C
;<<C D
publicCC 
constCC 
stringCC 

err_m_0006CC &
=CC' (
$strCC) R
;CCR S
publicJJ 
constJJ 
stringJJ 

err_m_0007JJ &
=JJ' (
$strJJ) A
;JJA B
publicQQ 
constQQ 
stringQQ 

err_m_0008QQ &
=QQ' (
$strQQ) I
;QQI J
publicXX 
constXX 
stringXX 

err_m_0009XX &
=XX' (
$strXX) J
;XXJ K
public__ 
const__ 
string__ 

err_m_0010__ &
=__' (
$str__) >
;__> ?
publicff 
constff 
stringff 

err_m_0011ff &
=ff' (
$strff) B
;ffB C
publicmm 
constmm 
stringmm 

err_m_0012mm &
=mm' (
$strmm) D
;mmD E
publictt 
consttt 
stringtt 

err_m_0013tt &
=tt' (
$strtt) A
;ttA B
public{{ 
const{{ 
string{{ 

err_m_0014{{ &
={{' (
$str{{) A
;{{A B
public
‚‚ 
const
‚‚ 
string
‚‚ 

err_m_0015
‚‚ &
=
‚‚' (
$str
‚‚) >
;
‚‚> ?
public
‰‰ 
const
‰‰ 
string
‰‰ 

err_m_0016
‰‰ &
=
‰‰' (
$str
‰‰) >
;
‰‰> ?
public
 
const
 
string
 

err_m_0017
 &
=
' (
$str
) C
;
C D
public
—— 
const
—— 
string
—— 

err_m_0018
—— &
=
——' (
$str
——) G
;
——G H
public
 
const
 
string
 

err_m_0019
 &
=
' (
$str
) Q
;
Q R
public
¥¥ 
const
¥¥ 
string
¥¥ 

err_m_0020
¥¥ &
=
¥¥' (
$str
¥¥) P
;
¥¥P Q
public
¬¬ 
const
¬¬ 
string
¬¬ 

err_m_0021
¬¬ &
=
¬¬' (
$str
¬¬) L
;
¬¬L M
public
³³ 
const
³³ 
string
³³ 

err_m_0022
³³ &
=
³³' (
$str
³³) E
;
³³E F
}
¹¹ 
}ºº ı„
\D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Convert\FDataConvert.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

static 
class 
FDataConvert $
{ 
static 
FDataConvert 
( 
) 
{ 	
} 	
public-- 
static-- 
string-- &
defaultNowDateTimeToString-- 7
(--7 8
).. 
{// 	
try00 
{11 
return22 
DateTime22 
.22  
Now22  #
.22# $
ToString22$ ,
(22, -
$str22- F
)22F G
;22G H
}33 
catch44 
(44 
	Exception44 
ex44 
)44  
{55 
FDebug66 
.66 
throwException66 %
(66% &
ex66& (
)66( )
;66) *
}77 
finally88 
{99 
};; 
return<< 
string<< 
.<< 
Empty<< 
;<<  
}== 	
publicAA 
staticAA 
stringAA $
defaultDataTimeFormatingAA 5
(AA5 6
stringBB 
dateTimeBB 
)CC 
{DD 	
stringEE 
dtEE 
=EE 
stringEE 
.EE 
EmptyEE $
;EE$ %
tryGG 
{HH 
ifII 
(II 
!II 
stringII 
.II 
IsNullOrEmptyII )
(II) *
dateTimeII* 2
)II2 3
)II3 4
{JJ 
dtKK 
=KK 
dateTimeKK !
.KK! "
PadRightKK" *
(KK* +
$numKK+ -
,KK- .
$charKK/ 2
)KK2 3
;KK3 4
returnOO 
dtOO 
.OO 
	SubstringOO '
(OO' (
$numOO( )
,OO) *
$numOO+ ,
)OO, -
+OO. /
$strOO0 3
+OO4 5
dtOO6 8
.OO8 9
	SubstringOO9 B
(OOB C
$numOOC D
,OOD E
$numOOF G
)OOG H
+OOI J
$strOOK N
+OOO P
dtOOQ S
.OOS T
	SubstringOOT ]
(OO] ^
$numOO^ _
,OO_ `
$numOOa b
)OOb c
+OOd e
$strOOf i
+OOj k
dtOOl n
.OOn o
	SubstringOOo x
(OOx y
$numOOy z
,OOz {
$numOO| }
)OO} ~
+	OO €
$str
OO „
+
OO… †
dt
OO‡ ‰
.
OO‰ Š
	Substring
OOŠ “
(
OO“ ”
$num
OO” –
,
OO– —
$num
OO˜ ™
)
OO™ š
+
OO› œ
$str
OO  
+
OO¡ ¢
dt
OO£ ¥
.
OO¥ ¦
	Substring
OO¦ ¯
(
OO¯ °
$num
OO° ²
,
OO² ³
$num
OO´ µ
)
OOµ ¶
+
OO· ¸
$str
OO¹ ¼
+
OO½ ¾
dt
OO¿ Á
.
OOÁ Â
	Substring
OOÂ Ë
(
OOË Ì
$num
OOÌ Î
,
OOÎ Ï
$num
OOĞ Ñ
)
OOÑ Ò
;
OOÒ Ó
}PP 
}QQ 
catchRR 
(RR 
	ExceptionRR 
exRR 
)RR  
{SS 
FDebugTT 
.TT 
throwExceptionTT %
(TT% &
exTT& (
)TT( )
;TT) *
}UU 
finallyVV 
{WW 
}YY 
returnZZ 
stringZZ 
.ZZ 
EmptyZZ 
;ZZ  
}[[ 	
public__ 
static__ 
string__ 
volumeSizeToString__ /
(__/ 0
long`` 
	byteCount`` 
,`` 
FVolumnOptionaa 
optionaa  
)bb 
{cc 	
trydd 
{ee 
ifff 
(ff 
(ff 
optionff 
==ff 
FVolumnOptionff ,
.ff, -
TeraByteff- 5
)ff5 6
||ff7 9
(gg 
optiongg 
==gg 
FVolumnOptiongg ,
.gg, -
Autogg- 1
&&gg2 4
	byteCountgg5 >
>=gg? A
$numggB O
)ggO P
)ggP Q
{hh 
returnii 
stringii !
.ii! "
Formatii" (
(ii( )
$strii) 5
,ii5 6
	byteCountii7 @
/iiA B
$numiiC R
)iiR S
;iiS T
}jj 
elsekk 
ifkk 
(kk 
(kk 
optionkk  
==kk! #
FVolumnOptionkk$ 1
.kk1 2
GigaBytekk2 :
)kk: ;
||kk< >
(ll 
optionll 
==ll 
FVolumnOptionll ,
.ll, -
Autoll- 1
&&ll2 4
	byteCountll5 >
>=ll? A
$numllB L
)llL M
)llM N
{mm 
returnnn 
stringnn !
.nn! "
Formatnn" (
(nn( )
$strnn) 5
,nn5 6
	byteCountnn7 @
/nnA B
$numnnC O
)nnO P
;nnP Q
}oo 
elsepp 
ifpp 
(pp 
(pp 
optionpp  
==pp! #
FVolumnOptionpp$ 1
.pp1 2
MegaBytepp2 :
)pp: ;
||pp< >
(qq 
optionqq 
==qq 
FVolumnOptionqq ,
.qq, -
Autoqq- 1
&&qq2 4
	byteCountqq5 >
>=qq? A
$numqqB I
)qqI J
)qqJ K
{rr 
returnss 
stringss !
.ss! "
Formatss" (
(ss( )
$strss) 0
,ss0 1
Mathss2 6
.ss6 7
Ceilingss7 >
(ss> ?
	byteCountss? H
/ssI J
$numssK T
)ssT U
)ssU V
;ssV W
}tt 
elseuu 
ifuu 
(uu 
(uu 
optionuu  
==uu! #
FVolumnOptionuu$ 1
.uu1 2
KiloByteuu2 :
)uu: ;
||uu< >
(vv 
optionvv 
==vv 
FVolumnOptionvv ,
.vv, -
Autovv- 1
&&vv2 4
	byteCountvv5 >
>=vv? A
$numvvB F
)vvF G
)vvG H
{ww 
returnxx 
stringxx !
.xx! "
Formatxx" (
(xx( )
$strxx) 0
,xx0 1
Mathxx2 6
.xx6 7
Ceilingxx7 >
(xx> ?
	byteCountxx? H
/xxI J
$numxxK Q
)xxQ R
)xxR S
;xxS T
}yy 
elsezz 
ifzz 
(zz 
(zz 
optionzz  
==zz! #
FVolumnOptionzz$ 1
.zz1 2
Bytezz2 6
)zz6 7
||zz8 :
({{ 
option{{ 
=={{ 
FVolumnOption{{ ,
.{{, -
Auto{{- 1
&&{{2 4
	byteCount{{5 >
>{{? @
$num{{A B
&&{{C E
	byteCount{{F O
<{{P Q
$num{{R V
){{V W
){{W X
{|| 
return}} 
string}} !
.}}! "
Format}}" (
(}}( )
$str}}) 3
,}}3 4
	byteCount}}5 >
)}}> ?
;}}? @
}~~ 
} 
catch
€€ 
(
€€ 
	Exception
€€ 
ex
€€ 
)
€€  
{
 
FDebug
‚‚ 
.
‚‚ 
throwException
‚‚ %
(
‚‚% &
ex
‚‚& (
)
‚‚( )
;
‚‚) *
}
ƒƒ 
finally
„„ 
{
…… 
}
‡‡ 
return
ˆˆ 
string
ˆˆ 
.
ˆˆ 
Empty
ˆˆ 
;
ˆˆ  
}
‰‰ 	
public
 
static
 
string
  
volumeSizeToString
 /
(
/ 0
long
 
	byteCount
 
)
 
{
 	
try
‘‘ 
{
’’ 
return
““  
volumeSizeToString
““ )
(
““) *
	byteCount
““* 3
,
““3 4
FVolumnOption
““5 B
.
““B C
Auto
““C G
)
““G H
;
““H I
}
”” 
catch
•• 
(
•• 
	Exception
•• 
ex
•• 
)
••  
{
–– 
FDebug
—— 
.
—— 
throwException
—— %
(
——% &
ex
——& (
)
——( )
;
——) *
}
˜˜ 
finally
™™ 
{
šš 
}
œœ 
return
 
string
 
.
 
Empty
 
;
  
}
 	
public
¢¢ 
static
¢¢ 
DateTime
¢¢ 
stringToDateTime
¢¢ /
(
¢¢/ 0
string
££ 
dateTime
££ 
)
¤¤ 
{
¥¥ 	
DateTime
¦¦ 
result
¦¦ 
;
¦¦ 
try
¨¨ 
{
©© 
return
ªª 
DateTime
ªª 
.
ªª  
TryParse
ªª  (
(
ªª( )&
defaultDataTimeFormating
ªª) A
(
ªªA B
dateTime
ªªB J
)
ªªJ K
,
ªªK L
out
ªªM P
result
ªªQ W
)
ªªW X
?
ªªY Z
result
ªª[ a
:
ªªb c
new
ªªd g
DateTime
ªªh p
(
ªªp q
)
ªªq r
;
ªªr s
}
«« 
catch
¬¬ 
(
¬¬ 
	Exception
¬¬ 
ex
¬¬ 
)
¬¬  
{
­­ 
FDebug
®® 
.
®® 
throwException
®® %
(
®®% &
ex
®®& (
)
®®( )
;
®®) *
}
¯¯ 
finally
°° 
{
±± 
}
³³ 
return
´´ 
new
´´ 
DateTime
´´ 
(
´´  
)
´´  !
;
´´! "
}
µµ 	
public
¹¹ 
static
¹¹ 
bool
¹¹ 
trySpanTime
¹¹ &
(
¹¹& '
string
ºº 
	startTime
ºº 
,
ºº 
string
»» 
endTime
»» 
,
»» 
out
¼¼ 
TimeSpan
¼¼ 
result
¼¼ 
)
½½ 
{
¾¾ 	
DateTime
¿¿ 
dtStart
¿¿ 
,
¿¿ 
dtEnd
¿¿ #
;
¿¿# $
bool
ÀÀ 

bStartTime
ÀÀ 
,
ÀÀ 
bEndTime
ÀÀ %
;
ÀÀ% &
result
ÂÂ 
=
ÂÂ 
new
ÂÂ 
TimeSpan
ÂÂ !
(
ÂÂ! "
)
ÂÂ" #
;
ÂÂ# $
try
ÄÄ 
{
ÅÅ 

bStartTime
ÆÆ 
=
ÆÆ 
DateTime
ÆÆ %
.
ÆÆ% &
TryParse
ÆÆ& .
(
ÆÆ. /&
defaultDataTimeFormating
ÆÆ/ G
(
ÆÆG H
	startTime
ÆÆH Q
)
ÆÆQ R
,
ÆÆR S
out
ÆÆT W
dtStart
ÆÆX _
)
ÆÆ_ `
;
ÆÆ` a
bEndTime
ÇÇ 
=
ÇÇ 
DateTime
ÇÇ #
.
ÇÇ# $
TryParse
ÇÇ$ ,
(
ÇÇ, -&
defaultDataTimeFormating
ÇÇ- E
(
ÇÇE F
endTime
ÇÇF M
)
ÇÇM N
,
ÇÇN O
out
ÇÇP S
dtEnd
ÇÇT Y
)
ÇÇY Z
;
ÇÇZ [
if
ÉÉ 
(
ÉÉ 

bStartTime
ÉÉ 
&&
ÉÉ !
bEndTime
ÉÉ" *
)
ÉÉ* +
{
ÊÊ 
result
ËË 
=
ËË 
dtEnd
ËË "
-
ËË# $
dtStart
ËË% ,
;
ËË, -
return
ÌÌ 
true
ÌÌ 
;
ÌÌ  
}
ÍÍ 
}
ÎÎ 
catch
ÏÏ 
(
ÏÏ 
	Exception
ÏÏ 
ex
ÏÏ 
)
ÏÏ  
{
ĞĞ 
FDebug
ÑÑ 
.
ÑÑ 
throwException
ÑÑ %
(
ÑÑ% &
ex
ÑÑ& (
)
ÑÑ( )
;
ÑÑ) *
}
ÒÒ 
finally
ÓÓ 
{
ÔÔ 
}
ÖÖ 
return
×× 
false
×× 
;
×× 
}
ØØ 	
public
ÜÜ 
static
ÜÜ 
FXmlNode
ÜÜ 
stringToXmlNode
ÜÜ .
(
ÜÜ. /
string
İİ 
data
İİ 
)
ŞŞ 
{
ßß 	
FXmlDocument
àà 
fDoc
àà 
=
àà 
null
àà  $
;
àà$ %
try
ââ 
{
ãã 
fDoc
ää 
=
ää 
new
ää 
FXmlDocument
ää '
(
ää' (
)
ää( )
;
ää) *
fDoc
åå 
.
åå  
preserveWhiteSpace
åå '
=
åå( )
false
åå* /
;
åå/ 0
fDoc
ææ 
.
ææ 
loadXml
ææ 
(
ææ 
string
ææ #
.
ææ# $
Format
ææ$ *
(
ææ* +
$str
ææ+ =
,
ææ= >
data
ææ? C
)
ææC D
)
ææD E
;
ææE F
return
èè 
fDoc
èè 
.
èè 
fFirstChild
èè '
.
èè' (
fFirstChild
èè( 3
;
èè3 4
}
éé 
catch
êê 
(
êê 
	Exception
êê 
ex
êê 
)
êê  
{
ëë 
FDebug
ìì 
.
ìì 
throwException
ìì %
(
ìì% &
ex
ìì& (
)
ìì( )
;
ìì) *
}
íí 
finally
îî 
{
ïï 
fDoc
ğğ 
=
ğğ 
null
ğğ 
;
ğğ 
}
ññ 
return
òò 
null
òò 
;
òò 
}
óó 	
public
÷÷ 
static
÷÷ 
FXmlNode
÷÷ 
stringToXmlNode
÷÷ .
(
÷÷. /
bool
øø 
isTrs
øø 
,
øø 
string
ùù 
data
ùù 
)
úú 
{
ûû 	
FXmlDocument
üü 
fDoc
üü 
=
üü 
null
üü  $
;
üü$ %
int
ıı 
xmlHeaderIdx
ıı 
=
ıı 
$num
ıı  
;
ıı  !
try
ÿÿ 
{
€€ 
if
‚‚ 
(
‚‚ 
isTrs
‚‚ 
)
‚‚ 
{
ƒƒ 
xmlHeaderIdx
ˆˆ  
=
ˆˆ! "
data
ˆˆ# '
.
ˆˆ' (
IndexOf
ˆˆ( /
(
ˆˆ/ 0
$str
ˆˆ0 4
)
ˆˆ4 5
;
ˆˆ5 6
if
‰‰ 
(
‰‰ 
xmlHeaderIdx
‰‰ $
>
‰‰% &
$num
‰‰' (
)
‰‰( )
{
ŠŠ 
data
‹‹ 
=
‹‹ 
data
‹‹ #
.
‹‹# $
	Substring
‹‹$ -
(
‹‹- .
xmlHeaderIdx
‹‹. :
+
‹‹; <
$num
‹‹= >
)
‹‹> ?
;
‹‹? @
}
ŒŒ 
}
 
fDoc
‘‘ 
=
‘‘ 
new
‘‘ 
FXmlDocument
‘‘ '
(
‘‘' (
)
‘‘( )
;
‘‘) *
fDoc
’’ 
.
’’  
preserveWhiteSpace
’’ '
=
’’( )
false
’’* /
;
’’/ 0
fDoc
““ 
.
““ 
loadXml
““ 
(
““ 
string
““ #
.
““# $
Format
““$ *
(
““* +
$str
““+ =
,
““= >
data
““? C
)
““C D
)
““D E
;
““E F
return
•• 
fDoc
•• 
.
•• 
fFirstChild
•• '
.
••' (
fFirstChild
••( 3
;
••3 4
}
–– 
catch
—— 
(
—— 
	Exception
—— 
ex
—— 
)
——  
{
˜˜ 
FDebug
™™ 
.
™™ 
throwException
™™ %
(
™™% &
ex
™™& (
)
™™( )
;
™™) *
}
šš 
finally
›› 
{
œœ 
fDoc
 
=
 
null
 
;
 
}
 
return
ŸŸ 
null
ŸŸ 
;
ŸŸ 
}
   	
public
¤¤ 
static
¤¤ 
byte
¤¤ 
[
¤¤ 
]
¤¤ 
stringToBytes
¤¤ *
(
¤¤* +
string
¥¥ 
data
¥¥ 
)
¦¦ 
{
§§ 	
ASCIIEncoding
¨¨ 
ascii
¨¨ 
=
¨¨  !
null
¨¨" &
;
¨¨& '
try
ªª 
{
«« 
ascii
¬¬ 
=
¬¬ 
new
¬¬ 
ASCIIEncoding
¬¬ )
(
¬¬) *
)
¬¬* +
;
¬¬+ ,
return
­­ 
ascii
­­ 
.
­­ 
GetBytes
­­ %
(
­­% &
data
­­& *
)
­­* +
;
­­+ ,
}
®® 
catch
¯¯ 
(
¯¯ 
	Exception
¯¯ 
ex
¯¯ 
)
¯¯  
{
°° 
FDebug
±± 
.
±± 
throwException
±± %
(
±±% &
ex
±±& (
)
±±( )
;
±±) *
}
²² 
finally
³³ 
{
´´ 
ascii
µµ 
=
µµ 
null
µµ 
;
µµ 
}
¶¶ 
return
·· 
null
·· 
;
·· 
}
¸¸ 	
}
¾¾ 
}¿¿ Ø;
jD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\c_FSqlParameterCollection.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class #
FSqlParameterCollection (
:) *
IDisposable* 5
,5 6
IEnumerable7 B
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 

Dictionary 
< 
string !
,! "
FSqlParameter# 0
>0 1
m_sqlParameterDict2 D
=E F
nullG K
;K L
private 
List 
< 
FSqlParameter "
>" #
m_sqlParameterList$ 6
=7 8
null9 =
;= >
internal$$ #
FSqlParameterCollection$$ (
($$( )

Dictionary%% 
<%% 
string%% 
,%% 
FSqlParameter%% ,
>%%, -
sqlParameterDict%%. >
,%%> ?
List&& 
<&& 
FSqlParameter&& 
>&& 
sqlParameterList&&  0
)'' 
{(( 	
m_sqlParameterDict)) 
=))  
sqlParameterDict))! 1
;))1 2
m_sqlParameterList** 
=**  
sqlParameterList**! 1
;**1 2
}++ 	
~// 	#
FSqlParameterCollection//	  
(//  !
)00 
{11 	
	myDispose22 
(22 
false22 
)22 
;22 
}33 	
	protected77 
void77 
	myDispose77  
(77  !
bool88 
	disposing88 
)99 
{:: 	
if;; 
(;; 
!;; 

m_disposed;; 
);; 
{<< 
if== 
(== 
	disposing== 
)== 
{>> 
m_sqlParameterDict?? &
=??' (
null??) -
;??- .
m_sqlParameterList@@ &
=@@' (
null@@) -
;@@- .
}AA 
}BB 

m_disposedDD 
=DD 
trueDD 
;DD 
}EE 	
publicMM 
voidMM 
DisposeMM 
(MM 
)NN 
{OO 	
	myDisposePP 
(PP 
truePP 
)PP 
;PP 
GCQQ 
.QQ 
SuppressFinalizeQQ 
(QQ  
thisQQ  $
)QQ$ %
;QQ% &
}RR 	
publicZZ 
IEnumeratorZZ 
GetEnumeratorZZ (
(ZZ( )
)[[ 
{\\ 	
try]] 
{^^ 
return__ 
new__ -
!FSqlParameterCollectionEnumerator__ <
(__< =
this__= A
)__A B
;__B C
}`` 
catchaa 
(aa 
	Exceptionaa 
exaa 
)aa  
{bb 
FDebugcc 
.cc 
throwExceptioncc %
(cc% &
excc& (
)cc( )
;cc) *
}dd 
finallyee 
{ff 
}gg 
returnhh 
nullhh 
;hh 
}ii 	
publicmm 
intmm 
countmm 
{nn 	
getoo 
{pp 
tryqq 
{rr 
returnss 
m_sqlParameterListss -
.ss- .
Countss. 3
;ss3 4
}tt 
catchuu 
(uu 
	Exceptionuu  
exuu! #
)uu# $
{vv 
FDebugww 
.ww 
throwExceptionww )
(ww) *
exww* ,
)ww, -
;ww- .
}xx 
finallyyy 
{zz 
}|| 
return}} 
$num}} 
;}} 
}~~ 
} 	
public
ƒƒ 
FSqlParameter
ƒƒ 
this
ƒƒ !
[
ƒƒ! "
int
ƒƒ" %
i
ƒƒ& '
]
ƒƒ' (
{
„„ 	
get
…… 
{
†† 
try
‡‡ 
{
ˆˆ 
if
‰‰ 
(
‰‰ 
i
‰‰ 
<
‰‰ 
$num
‰‰ 
||
‰‰  
i
‰‰! "
>=
‰‰# % 
m_sqlParameterList
‰‰& 8
.
‰‰8 9
Count
‰‰9 >
)
‰‰> ?
{
ŠŠ 
return
‹‹ 
null
‹‹ #
;
‹‹# $
}
ŒŒ 
return
  
m_sqlParameterList
 -
[
- .
i
. /
]
/ 0
;
0 1
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
‘‘ 
.
‘‘ 
throwException
‘‘ )
(
‘‘) *
ex
‘‘* ,
)
‘‘, -
;
‘‘- .
}
’’ 
finally
““ 
{
”” 
}
–– 
return
—— 
null
—— 
;
—— 
}
˜˜ 
}
™™ 	
public
 
FSqlParameter
 
this
 !
[
! "
string
" (
name
) -
]
- .
{
 	
get
ŸŸ 
{
   
try
¡¡ 
{
¢¢ 
if
££ 
(
££ 
!
££  
m_sqlParameterDict
££ +
.
££+ ,
ContainsKey
££, 7
(
££7 8
name
££8 <
)
££< =
)
££= >
{
¤¤ 
return
¥¥ 
null
¥¥ #
;
¥¥# $
}
¦¦ 
return
§§  
m_sqlParameterDict
§§ -
[
§§- .
name
§§. 2
]
§§2 3
;
§§3 4
}
¨¨ 
catch
©© 
(
©© 
	Exception
©©  
ex
©©! #
)
©©# $
{
ªª 
FDebug
«« 
.
«« 
throwException
«« )
(
««) *
ex
««* ,
)
««, -
;
««- .
}
¬¬ 
finally
­­ 
{
®® 
}
°° 
return
±± 
null
±± 
;
±± 
}
²² 
}
³³ 	
public
»» 
object
»» 
item
»» 
(
»» 
int
¼¼ 
index
¼¼ 
)
½½ 
{
¾¾ 	
try
¿¿ 
{
ÀÀ 
return
ÁÁ 
this
ÁÁ 
[
ÁÁ 
index
ÁÁ !
]
ÁÁ! "
;
ÁÁ" #
}
ÂÂ 
catch
ÃÃ 
(
ÃÃ 
	Exception
ÃÃ 
ex
ÃÃ 
)
ÃÃ  
{
ÄÄ 
FDebug
ÅÅ 
.
ÅÅ 
throwException
ÅÅ %
(
ÅÅ% &
ex
ÅÅ& (
)
ÅÅ( )
;
ÅÅ) *
}
ÆÆ 
finally
ÇÇ 
{
ÈÈ 
}
ÊÊ 
return
ËË 
null
ËË 
;
ËË 
}
ÌÌ 	
public
ĞĞ 
object
ĞĞ 
item
ĞĞ 
(
ĞĞ 
string
ÑÑ 
name
ÑÑ 
)
ÒÒ 
{
ÓÓ 	
try
ÔÔ 
{
ÕÕ 
return
ÖÖ 
this
ÖÖ 
[
ÖÖ 
name
ÖÖ  
]
ÖÖ  !
;
ÖÖ! "
}
×× 
catch
ØØ 
(
ØØ 
	Exception
ØØ 
ex
ØØ 
)
ØØ  
{
ÙÙ 
FDebug
ÚÚ 
.
ÚÚ 
throwException
ÚÚ %
(
ÚÚ% &
ex
ÚÚ& (
)
ÚÚ( )
;
ÚÚ) *
}
ÛÛ 
finally
ÜÜ 
{
İİ 
}
ßß 
return
àà 
null
àà 
;
àà 
}
áá 	
}
çç 
}èè ƒ 
tD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\c_FSqlParameterCollectionEnumerator.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class -
!FSqlParameterCollectionEnumerator 2
:3 4
IEnumerator5 @
,@ A
IDisposableB M
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
int 
m_index 
= 
- 
$num  
;  !
private #
FSqlParameterCollection '$
m_sqlParameterCollection( @
=A B
nullC G
;G H
public## -
!FSqlParameterCollectionEnumerator## 0
(##0 1#
FSqlParameterCollection$$ #"
sqlParameterCollection$$$ :
)%% 
{&& 	$
m_sqlParameterCollection'' $
=''% &"
sqlParameterCollection''' =
;''= >
}(( 	
~,, 	-
!FSqlParameterCollectionEnumerator,,	 *
(,,* +
)-- 
{.. 	
}00 	
	protected44 
void44 
	myDispose44  
(44  !
bool55 
	disposing55 
)66 
{77 	
if88 
(88 
!88 

m_disposed88 
)88 
{99 
if:: 
(:: 
	disposing:: 
):: 
{;; $
m_sqlParameterCollection<< ,
=<<- .
null<</ 3
;<<3 4
}== 
}>> 

m_disposed?? 
=?? 
true?? 
;?? 
}@@ 	
publicHH 
voidHH 
DisposeHH 
(HH 
)II 
{JJ 	
	myDisposeKK 
(KK 
trueKK 
)KK 
;KK 
}LL 	
publicTT 
objectTT 
CurrentTT 
{UU 	
getVV 
{WW 
tryXX 
{YY 
returnZZ $
m_sqlParameterCollectionZZ 3
[ZZ3 4
m_indexZZ4 ;
]ZZ; <
;ZZ< =
}[[ 
catch\\ 
(\\ 
	Exception\\  
ex\\! #
)\\# $
{]] 
FDebug^^ 
.^^ 
throwException^^ )
(^^) *
ex^^* ,
)^^, -
;^^- .
}__ 
finally`` 
{aa 
}cc 
returndd 
nulldd 
;dd 
}ee 
}ff 	
publicjj 
booljj 
MoveNextjj 
(jj 
)kk 
{ll 	
trymm 
{nn 
m_indexoo 
++oo 
;oo 
returnpp 
(pp 
m_indexpp 
<pp  !$
m_sqlParameterCollectionpp" :
.pp: ;
countpp; @
)pp@ A
;ppA B
}qq 
catchrr 
(rr 
Systemrr 
.rr 
	Exceptionrr #
exrr$ &
)rr& '
{ss 
FDebugtt 
.tt 
throwExceptiontt %
(tt% &
extt& (
)tt( )
;tt) *
}uu 
finallyvv 
{ww 
}yy 
returnzz 
falsezz 
;zz 
}{{ 	
public 
void 
Reset 
( 
)
€€ 
{
 	
try
‚‚ 
{
ƒƒ 
m_index
„„ 
=
„„ 
-
„„ 
$num
„„ 
;
„„ 
}
…… 
catch
†† 
(
†† 
System
†† 
.
†† 
	Exception
†† #
ex
††$ &
)
††& '
{
‡‡ 
FDebug
ˆˆ 
.
ˆˆ 
throwException
ˆˆ %
(
ˆˆ% &
ex
ˆˆ& (
)
ˆˆ( )
;
ˆˆ) *
}
‰‰ 
finally
ŠŠ 
{
‹‹ 
}
 
}
 	
}
”” 
}•• ‘:
aD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\c_FSqlCollection.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FSqlCollection 
:  !
IDisposable" -
,- .
IEnumerable/ :
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 

Dictionary 
< 
string !
,! "
FSql# '
>' (
	m_sqlDict) 2
=3 4
null5 9
;9 :
private 
List 
< 
FSql 
> 
	m_sqlList $
=% &
null' +
;+ ,
internal"" 
FSqlCollection"" 
(""  

Dictionary## 
<## 
string## 
,## 
FSql## #
>### $
sqlDict##% ,
,##, -
List$$ 
<$$ 
FSql$$ 
>$$ 
sqlList$$ 
)%% 
{&& 	
	m_sqlDict'' 
='' 
sqlDict'' 
;''  
	m_sqlList(( 
=(( 
sqlList(( 
;((  
})) 	
~-- 	
FSqlCollection--	 
(-- 
).. 
{// 	
	myDispose00 
(00 
false00 
)00 
;00 
}11 	
	protected55 
void55 
	myDispose55  
(55  !
bool66 
	disposing66 
)66 
{77 	
if88 
(88 
!88 

m_disposed88 
)88 
{99 
if:: 
(:: 
	disposing:: 
):: 
{;; 
	m_sqlDict<< 
=<< 
null<<  $
;<<$ %
	m_sqlList== 
=== 
null==  $
;==$ %
}>> 
}?? 

m_disposedAA 
=AA 
trueAA 
;AA 
}BB 	
publicJJ 
voidJJ 
DisposeJJ 
(JJ 
)KK 
{LL 	
	myDisposeMM 
(MM 
trueMM 
)MM 
;MM 
GCNN 
.NN 
SuppressFinalizeNN 
(NN  
thisNN  $
)NN$ %
;NN% &
}OO 	
publicWW 
IEnumeratorWW 
GetEnumeratorWW (
(WW( )
)XX 
{YY 	
tryZZ 
{[[ 
return\\ 
new\\ $
FSqlCollectionEnumerator\\ 3
(\\3 4
this\\4 8
)\\8 9
;\\9 :
}]] 
catch^^ 
(^^ 
	Exception^^ 
ex^^ 
)^^  
{__ 
FDebug`` 
.`` 
throwException`` %
(``% &
ex``& (
)``( )
;``) *
}aa 
finallybb 
{cc 
}ee 
returnff 
nullff 
;ff 
}gg 	
publickk 
intkk 
countkk 
{ll 	
getmm 
{nn 
tryoo 
{pp 
returnqq 
	m_sqlListqq $
.qq$ %
Countqq% *
;qq* +
}rr 
catchss 
(ss 
Systemss 
.ss 
	Exceptionss '
exss( *
)ss* +
{tt 
FDebuguu 
.uu 
throwExceptionuu )
(uu) *
exuu* ,
)uu, -
;uu- .
}vv 
finallyww 
{xx 
}zz 
return{{ 
$num{{ 
;{{ 
}|| 
}}} 	
public
 
FSql
 
this
 
[
 
int
 
i
 
]
 
{
‚‚ 	
get
ƒƒ 
{
„„ 
try
…… 
{
†† 
if
‡‡ 
(
‡‡ 
i
‡‡ 
<
‡‡ 
$num
‡‡ 
||
‡‡  
i
‡‡! "
>=
‡‡# %
	m_sqlList
‡‡& /
.
‡‡/ 0
Count
‡‡0 5
)
‡‡5 6
{
ˆˆ 
return
‰‰ 
null
‰‰ #
;
‰‰# $
}
ŠŠ 
return
‹‹ 
	m_sqlList
‹‹ $
[
‹‹$ %
i
‹‹% &
]
‹‹& '
;
‹‹' (
}
ŒŒ 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
‘‘ 
{
’’ 
}
”” 
return
•• 
null
•• 
;
•• 
}
–– 
}
—— 	
public
›› 
FSql
›› 
this
›› 
[
›› 
string
›› 
name
››  $
]
››$ %
{
œœ 	
get
 
{
 
try
ŸŸ 
{
   
if
¡¡ 
(
¡¡ 
!
¡¡ 
	m_sqlDict
¡¡ "
.
¡¡" #
ContainsKey
¡¡# .
(
¡¡. /
name
¡¡/ 3
)
¡¡3 4
)
¡¡4 5
{
¢¢ 
return
££ 
null
££ #
;
££# $
}
¤¤ 
return
¥¥ 
	m_sqlDict
¥¥ $
[
¥¥$ %
name
¥¥% )
]
¥¥) *
;
¥¥* +
}
¦¦ 
catch
§§ 
(
§§ 
	Exception
§§  
ex
§§! #
)
§§# $
{
¨¨ 
FDebug
©© 
.
©© 
throwException
©© )
(
©©) *
ex
©©* ,
)
©©, -
;
©©- .
}
ªª 
finally
«« 
{
¬¬ 
}
®® 
return
¯¯ 
null
¯¯ 
;
¯¯ 
}
°° 
}
±± 	
public
¹¹ 
object
¹¹ 
item
¹¹ 
(
¹¹ 
int
ºº 
index
ºº 
)
»» 
{
¼¼ 	
try
½½ 
{
¾¾ 
return
¿¿ 
this
¿¿ 
[
¿¿ 
index
¿¿ !
]
¿¿! "
;
¿¿" #
}
ÀÀ 
catch
ÁÁ 
(
ÁÁ 
	Exception
ÁÁ 
ex
ÁÁ 
)
ÁÁ  
{
ÂÂ 
FDebug
ÃÃ 
.
ÃÃ 
throwException
ÃÃ %
(
ÃÃ% &
ex
ÃÃ& (
)
ÃÃ( )
;
ÃÃ) *
}
ÄÄ 
finally
ÅÅ 
{
ÆÆ 
}
ÈÈ 
return
ÉÉ 
null
ÉÉ 
;
ÉÉ 
}
ÊÊ 	
public
ÎÎ 
object
ÎÎ 
item
ÎÎ 
(
ÎÎ 
string
ÏÏ 
name
ÏÏ 
)
ĞĞ 
{
ÑÑ 	
try
ÒÒ 
{
ÓÓ 
return
ÔÔ 
this
ÔÔ 
[
ÔÔ 
name
ÔÔ  
]
ÔÔ  !
;
ÔÔ! "
}
ÕÕ 
catch
ÖÖ 
(
ÖÖ 
	Exception
ÖÖ 
ex
ÖÖ 
)
ÖÖ  
{
×× 
FDebug
ØØ 
.
ØØ 
throwException
ØØ %
(
ØØ% &
ex
ØØ& (
)
ØØ( )
;
ØØ) *
}
ÙÙ 
finally
ÚÚ 
{
ÛÛ 
}
İİ 
return
ŞŞ 
null
ŞŞ 
;
ŞŞ 
}
ßß 	
}
åå 
}ææ Í
kD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\c_FSqlCollectionEnumerator.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class $
FSqlCollectionEnumerator )
:* +
IEnumerator, 7
,7 8
IDisposable9 D
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
int 
m_index 
= 
- 
$num  
;  !
private 
FSqlCollection 
m_sqlCollection .
=/ 0
null1 5
;5 6
public## $
FSqlCollectionEnumerator## '
(##' (
FSqlCollection$$ 
sqlCollection$$ (
)%% 
{&& 	
m_sqlCollection'' 
='' 
sqlCollection'' +
;''+ ,
}(( 	
~,, 	$
FSqlCollectionEnumerator,,	 !
(,,! "
)-- 
{.. 	
	myDispose// 
(// 
false// 
)// 
;// 
}00 	
	protected44 
void44 
	myDispose44  
(44  !
bool55 
	disposing55 
)55 
{66 	
if77 
(77 
!77 

m_disposed77 
)77 
{88 
if99 
(99 
	disposing99 
)99 
{:: 
m_sqlCollection;; #
=;;$ %
null;;& *
;;;* +
}<< 
}== 
}>> 	
publicFF 
voidFF 
DisposeFF 
(FF 
)GG 
{HH 	
	myDisposeII 
(II 
trueII 
)II 
;II 
GCJJ 
.JJ 
SuppressFinalizeJJ 
(JJ  
thisJJ  $
)JJ$ %
;JJ% &
}KK 	
publicSS 
objectSS 
CurrentSS 
{TT 	
getUU 
{VV 
tryWW 
{XX 
returnYY 
m_sqlCollectionYY *
[YY* +
m_indexYY+ 2
]YY2 3
;YY3 4
}ZZ 
catch[[ 
([[ 
	Exception[[  
ex[[! #
)[[# $
{\\ 
FDebug]] 
.]] 
throwException]] )
(]]) *
ex]]* ,
)]], -
;]]- .
}^^ 
finally__ 
{`` 
}bb 
returncc 
nullcc 
;cc 
}dd 
}ee 	
publicii 
boolii 
MoveNextii 
(ii 
)jj 
{kk 	
tryll 
{mm 
m_indexnn 
++nn 
;nn 
returnoo 
(oo 
m_indexoo 
<oo  !
m_sqlCollectionoo" 1
.oo1 2
countoo2 7
)oo7 8
;oo8 9
}pp 
catchqq 
(qq 
	Exceptionqq 
exqq 
)qq  
{rr 
FDebugss 
.ss 
throwExceptionss %
(ss% &
exss& (
)ss( )
;ss) *
}tt 
finallyuu 
{vv 
}xx 
returnyy 
falseyy 
;yy 
}zz 	
public~~ 
void~~ 
Reset~~ 
(~~ 
) 
{
€€ 	
try
 
{
‚‚ 
m_index
ƒƒ 
=
ƒƒ 
-
ƒƒ 
$num
ƒƒ 
;
ƒƒ 
}
„„ 
catch
…… 
(
…… 
	Exception
…… 
ex
…… 
)
……  
{
†† 
FDebug
‡‡ 
.
‡‡ 
throwException
‡‡ %
(
‡‡% &
ex
‡‡& (
)
‡‡( )
;
‡‡) *
}
ˆˆ 
finally
‰‰ 
{
ŠŠ 
}
ŒŒ 
}
 	
}
““ 
}”” ö
_D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\c_FDbException.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FDbException 
:  
ApplicationException  4
{ 
private 
int 
m_errorCode 
=  !
$num" #
;# $
private 
FSqlErrorType 
m_fSqlErrorType -
=. /
FSqlErrorType0 =
.= >
Normal> D
;D E
private 
FSqlErrorCollection #
m_fSqlErrors$ 0
=1 2
null3 7
;7 8
internal"" 
FDbException"" 
("" 
FSqlErrorType## 
fSqlErrorType## '
,##' (
FSqlErrorCollection$$ 

fSqlErrors$$  *
,$$* +
string%% 
message%% 
,%% 
	Exception&& 
innerException&& $
)'' 
:(( 
base(( 
((( 
message(( 
,(( 
innerException(( *
)((* +
{)) 	
m_fSqlErrorType** 
=** 
fSqlErrorType** +
;**+ ,
m_fSqlErrors++ 
=++ 

fSqlErrors++ %
;++% &
},, 	
public44 
int44 
	errorCode44 
{55 	
get66 
{77 
try88 
{99 
return:: 
m_errorCode:: &
;::& '
};; 
catch<< 
(<< 
	Exception<<  
ex<<! #
)<<# $
{== 
FDebug>> 
.>> 
throwException>> )
(>>) *
ex>>* ,
)>>, -
;>>- .
}?? 
finally@@ 
{AA 
}CC 
returnDD 
$numDD 
;DD 
}EE 
}FF 	
publicJJ 
FSqlErrorTypeJJ 
fSqlErrorTypeJJ *
{KK 	
getLL 
{MM 
tryNN 
{OO 
returnPP 
m_fSqlErrorTypePP *
;PP* +
}QQ 
catchRR 
(RR 
	ExceptionRR  
exRR! #
)RR# $
{SS 
FDebugTT 
.TT 
throwExceptionTT )
(TT) *
exTT* ,
)TT, -
;TT- .
}UU 
finallyVV 
{WW 
}YY 
returnZZ 
FSqlErrorTypeZZ $
.ZZ$ %
NormalZZ% +
;ZZ+ ,
}[[ 
}\\ 	
public`` 
FSqlErrorCollection`` "

fSqlErrors``# -
{aa 	
getbb 
{cc 
trydd 
{ee 
returnff 
m_fSqlErrorsff '
;ff' (
}gg 
catchhh 
(hh 
	Exceptionhh  
exhh! #
)hh# $
{ii 
FDebugjj 
.jj 
throwExceptionjj )
(jj) *
exjj* ,
)jj, -
;jj- .
}kk 
finallyll 
{mm 
}oo 
returnpp 
nullpp 
;pp 
}qq 
}rr 	
}~~ 
} à<
jD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Ftp\c_FFtpDirectoryEntryCollection.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class (
FFtpDirectoryEntryCollection -
:. /
IDisposable0 ;
,; <
IEnumerable= H
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 

Dictionary 
< 
string !
,! "
FFtpDirectoryEntry# 5
>5 6#
m_ftpDirectoryEntryDict7 N
=O P
nullQ U
;U V
private 
List 
< 
FFtpDirectoryEntry '
>' (#
m_ftpDirectoryEntryList) @
=A B
nullC G
;G H
internal   (
FFtpDirectoryEntryCollection   -
(  - .

Dictionary!! 
<!! 
string!! 
,!! 
FFtpDirectoryEntry!! 1
>!!1 2!
ftpDirectoryEntryDict!!3 H
,!!H I
List"" 
<"" 
FFtpDirectoryEntry"" #
>""# $!
ftpDirectoryEntryList""% :
)## 
{$$ 	#
m_ftpDirectoryEntryDict%% #
=%%$ %!
ftpDirectoryEntryDict%%& ;
;%%; <#
m_ftpDirectoryEntryList&& #
=&&$ %!
ftpDirectoryEntryList&&& ;
;&&; <
}'' 	
~++ 	(
FFtpDirectoryEntryCollection++	 %
(++% &
),, 
{-- 	
	myDispose.. 
(.. 
false.. 
).. 
;.. 
}// 	
	protected33 
void33 
	myDispose33  
(33  !
bool44 
	disposing44 
)44 
{55 	
if66 
(66 
!66 

m_disposed66 
)66 
{77 
if88 
(88 
	disposing88 
)88 
{99 #
m_ftpDirectoryEntryDict:: +
=::, -
null::. 2
;::2 3#
m_ftpDirectoryEntryList;; +
=;;, -
null;;. 2
;;;2 3
}<< 
}== 

m_disposed?? 
=?? 
true?? 
;?? 
}@@ 	
publicHH 
voidHH 
DisposeHH 
(HH 
)II 
{JJ 	
	myDisposeKK 
(KK 
trueKK 
)KK 
;KK 
GCLL 
.LL 
SuppressFinalizeLL 
(LL  
thisLL  $
)LL$ %
;LL% &
}MM 	
publicUU 
IEnumeratorUU 
GetEnumeratorUU (
(UU( )
)VV 
{WW 	
tryXX 
{YY 
returnZZ 
newZZ (
FFtpDirectoryEntryEnumeratorZZ 7
(ZZ7 8
thisZZ8 <
)ZZ< =
;ZZ= >
}[[ 
catch\\ 
(\\ 
	Exception\\ 
ex\\ 
)\\  
{]] 
FDebug^^ 
.^^ 
throwException^^ %
(^^% &
ex^^& (
)^^( )
;^^) *
}__ 
finally`` 
{aa 
}cc 
returndd 
nulldd 
;dd 
}ee 	
publicii 
intii 
countii 
{jj 	
getkk 
{ll 
trymm 
{nn 
returnoo #
m_ftpDirectoryEntryListoo 2
.oo2 3
Countoo3 8
;oo8 9
}pp 
catchqq 
(qq 
Systemqq 
.qq 
	Exceptionqq '
exqq( *
)qq* +
{rr 
FDebugss 
.ss 
throwExceptionss )
(ss) *
exss* ,
)ss, -
;ss- .
}tt 
finallyuu 
{vv 
}xx 
returnyy 
$numyy 
;yy 
}zz 
}{{ 	
public 
FFtpDirectoryEntry !
this" &
[& '
int' *
i+ ,
], -
{
€€ 	
get
 
{
‚‚ 
try
ƒƒ 
{
„„ 
if
…… 
(
…… 
i
…… 
<
…… 
$num
…… 
||
……  
i
……! "
>=
……# %%
m_ftpDirectoryEntryList
……& =
.
……= >
Count
……> C
)
……C D
{
†† 
return
‡‡ 
null
‡‡ #
;
‡‡# $
}
ˆˆ 
return
‰‰ %
m_ftpDirectoryEntryList
‰‰ 2
[
‰‰2 3
i
‰‰3 4
]
‰‰4 5
;
‰‰5 6
}
ŠŠ 
catch
‹‹ 
(
‹‹ 
	Exception
‹‹  
ex
‹‹! #
)
‹‹# $
{
ŒŒ 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
 
{
 
}
’’ 
return
““ 
null
““ 
;
““ 
}
”” 
}
•• 	
public
™™  
FFtpDirectoryEntry
™™ !
this
™™" &
[
™™& '
string
™™' -
name
™™. 2
]
™™2 3
{
šš 	
get
›› 
{
œœ 
try
 
{
 
if
ŸŸ 
(
ŸŸ 
!
ŸŸ %
m_ftpDirectoryEntryDict
ŸŸ 0
.
ŸŸ0 1
ContainsKey
ŸŸ1 <
(
ŸŸ< =
name
ŸŸ= A
)
ŸŸA B
)
ŸŸB C
{
   
return
¡¡ 
null
¡¡ #
;
¡¡# $
}
¢¢ 
return
££ %
m_ftpDirectoryEntryDict
££ 2
[
££2 3
name
££3 7
]
££7 8
;
££8 9
}
¤¤ 
catch
¥¥ 
(
¥¥ 
	Exception
¥¥  
ex
¥¥! #
)
¥¥# $
{
¦¦ 
FDebug
§§ 
.
§§ 
throwException
§§ )
(
§§) *
ex
§§* ,
)
§§, -
;
§§- .
}
¨¨ 
finally
©© 
{
ªª 
}
¬¬ 
return
­­ 
null
­­ 
;
­­ 
}
®® 
}
¯¯ 	
public
·· 
object
·· 
item
·· 
(
·· 
int
¸¸ 
index
¸¸ 
)
¹¹ 
{
ºº 	
try
»» 
{
¼¼ 
return
½½ 
this
½½ 
[
½½ 
index
½½ !
]
½½! "
;
½½" #
}
¾¾ 
catch
¿¿ 
(
¿¿ 
	Exception
¿¿ 
ex
¿¿ 
)
¿¿  
{
ÀÀ 
FDebug
ÁÁ 
.
ÁÁ 
throwException
ÁÁ %
(
ÁÁ% &
ex
ÁÁ& (
)
ÁÁ( )
;
ÁÁ) *
}
ÂÂ 
finally
ÃÃ 
{
ÄÄ 
}
ÆÆ 
return
ÇÇ 
null
ÇÇ 
;
ÇÇ 
}
ÈÈ 	
public
ÌÌ 
object
ÌÌ 
item
ÌÌ 
(
ÌÌ 
string
ÍÍ 
name
ÍÍ 
)
ÎÎ 
{
ÏÏ 	
try
ĞĞ 
{
ÑÑ 
return
ÒÒ 
this
ÒÒ 
[
ÒÒ 
name
ÒÒ  
]
ÒÒ  !
;
ÒÒ! "
}
ÓÓ 
catch
ÔÔ 
(
ÔÔ 
	Exception
ÔÔ 
ex
ÔÔ 
)
ÔÔ  
{
ÕÕ 
FDebug
ÖÖ 
.
ÖÖ 
throwException
ÖÖ %
(
ÖÖ% &
ex
ÖÖ& (
)
ÖÖ( )
;
ÖÖ) *
}
×× 
finally
ØØ 
{
ÙÙ 
}
ÛÛ 
return
ÜÜ 
null
ÜÜ 
;
ÜÜ 
}
İİ 	
}
ãã 
}ää ›
jD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Ftp\c_FFtpDirectoryEntryEnumerator.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
class 	(
FFtpDirectoryEntryEnumerator
 &
:' (
IEnumerator) 4
,4 5
IDisposable6 A
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
int 
m_index 
= 
- 
$num  
;  !
private (
FFtpDirectoryEntryCollection ,
m_ftpCollection- <
== >
null? C
;C D
public   (
FFtpDirectoryEntryEnumerator   +
(  + ,(
FFtpDirectoryEntryCollection!! (
ftpCollection!!) 6
)"" 
{## 	
m_ftpCollection$$ 
=$$ 
ftpCollection$$ +
;$$+ ,
}%% 	
~)) 	(
FFtpDirectoryEntryEnumerator))	 %
())% &
)** 
{++ 	
}-- 	
	protected11 
void11 
	myDispose11  
(11  !
bool22 
	disposing22 
)33 
{44 	
if55 
(55 
!55 

m_disposed55 
)55 
{66 
if77 
(77 
	disposing77 
)77 
{88 
m_ftpCollection99 #
=99$ %
null99& *
;99* +
}:: 
};; 

m_disposed<< 
=<< 
true<< 
;<< 
}== 	
publicEE 
voidEE 
DisposeEE 
(EE 
)FF 
{GG 	
	myDisposeHH 
(HH 
trueHH 
)HH 
;HH 
}II 	
publicQQ 
objectQQ 
CurrentQQ 
{RR 	
getSS 
{TT 
tryUU 
{VV 
returnWW 
m_ftpCollectionWW *
[WW* +
m_indexWW+ 2
]WW2 3
;WW3 4
}XX 
catchYY 
(YY 
	ExceptionYY  
exYY! #
)YY# $
{ZZ 
FDebug[[ 
.[[ 
throwException[[ )
([[) *
ex[[* ,
)[[, -
;[[- .
}\\ 
finally]] 
{^^ 
}`` 
returnaa 
nullaa 
;aa 
}bb 
}cc 	
publicgg 
boolgg 
MoveNextgg 
(gg 
)hh 
{ii 	
tryjj 
{kk 
m_indexll 
++ll 
;ll 
returnmm 
(mm 
m_indexmm 
<mm  !
m_ftpCollectionmm" 1
.mm1 2
countmm2 7
)mm7 8
;mm8 9
}nn 
catchoo 
(oo 
Systemoo 
.oo 
	Exceptionoo #
exoo$ &
)oo& '
{pp 
FDebugqq 
.qq 
throwExceptionqq %
(qq% &
exqq& (
)qq( )
;qq) *
}rr 
finallyss 
{tt 
}vv 
returnww 
falseww 
;ww 
}xx 	
public|| 
void|| 
Reset|| 
(|| 
)}} 
{~~ 	
try 
{
€€ 
m_index
 
=
 
-
 
$num
 
;
 
}
‚‚ 
catch
ƒƒ 
(
ƒƒ 
System
ƒƒ 
.
ƒƒ 
	Exception
ƒƒ #
ex
ƒƒ$ &
)
ƒƒ& '
{
„„ 
FDebug
…… 
.
…… 
throwException
…… %
(
……% &
ex
……& (
)
……( )
;
……) *
}
†† 
finally
‡‡ 
{
ˆˆ 
}
ŠŠ 
}
‹‹ 	
}
‘‘ 
}’’ ØÄ
eD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\LogWriter\c_FServiceLogWriter.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FServiceLogWriter "
:# $
IDisposable% 0
{ 
private 
const 
int 
LogFileDeletePeriod -
=. /
$num0 2
*3 4
$num5 7
*8 9
$num: >
;> ?
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
string 
m_logFilePath $
=% &
Application' 2
.2 3
StartupPath3 >
+? @
$strA H
;H I
private   
string   
m_logFileSuffix   &
=  ' (
$str  ) 5
;  5 6
private!! 
string!! 
m_logFileExt!! #
=!!$ %
$str!!& +
;!!+ ,
private"" 
bool"" 
m_dateTimeUsed"" #
=""$ %
false""& +
;""+ ,
private## 
bool## 
m_endStringUsed## $
=##% &
false##' ,
;##, -
private$$ 
string$$ 
m_endString$$ "
=$$# $
$str$$% (
;$$( )
private%% 
int%% 
m_maxLogFileSize%% $
=%%% &
$num%%' +
*%%, -
$num%%. 2
*%%3 4
$num%%5 6
;%%6 7
private&& 
static&& 
bool&& &
m_logFileAutoDeleteEnabled&& 6
=&&7 8
false&&9 >
;&&> ?
private'' 
int'' "
m_logFileKeepingPeriod'' *
=''+ ,
$num''- /
;''/ 0
private)) 
string)) 

m_filePath)) !
=))" #
string))$ *
.))* +
Empty))+ 0
;))0 1
private** 
string** 
m_fileSuffix** #
=**$ %
string**& ,
.**, -
Empty**- 2
;**2 3
private++ 
string++ 
	m_fileExt++  
=++! "
string++# )
.++) *
Empty++* /
;++/ 0
private,, 
string,, 
m_openedFileName,, '
=,,( )
string,,* 0
.,,0 1
Empty,,1 6
;,,6 7
private// 
FQueue// 
<// 
string// 
>// 
m_fLogQueue// *
=//+ ,
null//- 1
;//1 2
private00 

FileStream00 
m_fsLogFile00 &
=00' (
null00) -
;00- .
private11 
StreamWriter11 
m_swLogFile11 (
=11) *
null11+ /
;11/ 0
private22 
FThread22 

m_fThdMain22 "
=22# $
null22% )
;22) *
private33 
FStaticTimer33 
m_fTmrLogFileDelete33 0
=331 2
null333 7
;337 8
public99 
FServiceLogWriter99  
(99  !
):: 
{;; 	
init<< 
(<< 
)<< 
;<< 
}== 	
publicAA 
FServiceLogWriterAA  
(AA  !
stringBB 
logFilePathBB 
,BB 
stringCC 
logFileSuffixCC  
,CC  !
stringDD 

logFileExtDD 
,DD 
boolEE 
dateTimeUsedEE 
,EE 
boolFF 
endStringUsedFF 
)GG 
{HH 	
m_logFilePathII 
=II 
logFilePathII '
;II' (
m_logFileSuffixJJ 
=JJ 
logFileSuffixJJ +
;JJ+ ,
m_logFileExtKK 
=KK 

logFileExtKK %
;KK% &
m_dateTimeUsedLL 
=LL 
dateTimeUsedLL )
;LL) *
m_endStringUsedMM 
=MM 
endStringUsedMM +
;MM+ ,
initOO 
(OO 
)OO 
;OO 
}PP 	
~TT 	
FServiceLogWriterTT	 
(TT 
)UU 
{VV 	
	myDisposeWW 
(WW 
falseWW 
)WW 
;WW 
}XX 	
	protected\\ 
void\\ 
	myDispose\\  
(\\  !
bool]] 
	disposing]] 
)^^ 
{__ 	
if`` 
(`` 
!`` 

m_disposed`` 
)`` 
{aa 
ifbb 
(bb 
	disposingbb 
)bb 
{cc 
termdd 
(dd 
)dd 
;dd 
}ee 

m_disposedff 
=ff 
trueff !
;ff! "
}gg 
}hh 	
publicpp 
voidpp 
Disposepp 
(pp 
)qq 
{rr 	
	myDisposess 
(ss 
truess 
)ss 
;ss 
GCtt 
.tt 
SuppressFinalizett 
(tt  
thistt  $
)tt$ %
;tt% &
}uu 	
public}} 
string}} 
logFilePath}} !
{~~ 	
get 
{
€€ 
try
 
{
‚‚ 
return
ƒƒ 
m_logFilePath
ƒƒ (
;
ƒƒ( )
}
„„ 
catch
…… 
(
…… 
	Exception
……  
ex
……! #
)
……# $
{
†† 
FDebug
‡‡ 
.
‡‡ 
throwException
‡‡ )
(
‡‡) *
ex
‡‡* ,
)
‡‡, -
;
‡‡- .
}
ˆˆ 
finally
‰‰ 
{
ŠŠ 
}
ŒŒ 
return
 
string
 
.
 
Empty
 #
;
# $
}
 
set
 
{
‘‘ 
try
’’ 
{
““ 
m_logFilePath
”” !
=
””" #
value
””$ )
;
””) *
}
•• 
catch
–– 
(
–– 
	Exception
––  
ex
––! #
)
––# $
{
—— 
FDebug
˜˜ 
.
˜˜ 
throwException
˜˜ )
(
˜˜) *
ex
˜˜* ,
)
˜˜, -
;
˜˜- .
}
™™ 
finally
šš 
{
›› 
}
 
}
 
}
ŸŸ 	
public
££ 
string
££ 
logFileSuffix
££ #
{
¤¤ 	
get
¥¥ 
{
¦¦ 
try
§§ 
{
¨¨ 
return
©© 
m_logFileSuffix
©© *
;
©©* +
}
ªª 
catch
«« 
(
«« 
	Exception
««  
ex
««! #
)
««# $
{
¬¬ 
FDebug
­­ 
.
­­ 
throwException
­­ )
(
­­) *
ex
­­* ,
)
­­, -
;
­­- .
}
®® 
finally
¯¯ 
{
°° 
}
²² 
return
³³ 
string
³³ 
.
³³ 
Empty
³³ #
;
³³# $
}
´´ 
set
¶¶ 
{
·· 
try
¸¸ 
{
¹¹ 
m_logFileSuffix
ºº #
=
ºº$ %
value
ºº& +
;
ºº+ ,
}
»» 
catch
¼¼ 
(
¼¼ 
	Exception
¼¼  
ex
¼¼! #
)
¼¼# $
{
½½ 
FDebug
¾¾ 
.
¾¾ 
throwException
¾¾ )
(
¾¾) *
ex
¾¾* ,
)
¾¾, -
;
¾¾- .
}
¿¿ 
finally
ÀÀ 
{
ÁÁ 
}
ÃÃ 
}
ÄÄ 
}
ÅÅ 	
public
ÉÉ 
string
ÉÉ 

logFileExt
ÉÉ  
{
ÊÊ 	
get
ËË 
{
ÌÌ 
try
ÍÍ 
{
ÎÎ 
return
ÏÏ 
m_logFileExt
ÏÏ '
;
ÏÏ' (
}
ĞĞ 
catch
ÑÑ 
(
ÑÑ 
	Exception
ÑÑ  
ex
ÑÑ! #
)
ÑÑ# $
{
ÒÒ 
FDebug
ÓÓ 
.
ÓÓ 
throwException
ÓÓ )
(
ÓÓ) *
ex
ÓÓ* ,
)
ÓÓ, -
;
ÓÓ- .
}
ÔÔ 
finally
ÕÕ 
{
ÖÖ 
}
ØØ 
return
ÙÙ 
string
ÙÙ 
.
ÙÙ 
Empty
ÙÙ #
;
ÙÙ# $
}
ÚÚ 
set
ÜÜ 
{
İİ 
try
ŞŞ 
{
ßß 
m_logFileExt
àà  
=
àà! "
value
àà# (
;
àà( )
}
áá 
catch
ââ 
(
ââ 
	Exception
ââ  
ex
ââ! #
)
ââ# $
{
ãã 
FDebug
ää 
.
ää 
throwException
ää )
(
ää) *
ex
ää* ,
)
ää, -
;
ää- .
}
åå 
finally
ææ 
{
çç 
}
éé 
}
êê 
}
ëë 	
public
ïï 
bool
ïï 
dateTimeUsed
ïï  
{
ğğ 	
get
ññ 
{
òò 
try
óó 
{
ôô 
return
õõ 
m_dateTimeUsed
õõ )
;
õõ) *
}
öö 
catch
÷÷ 
(
÷÷ 
	Exception
÷÷  
ex
÷÷! #
)
÷÷# $
{
øø 
FDebug
ùù 
.
ùù 
throwException
ùù )
(
ùù) *
ex
ùù* ,
)
ùù, -
;
ùù- .
}
úú 
finally
ûû 
{
üü 
}
şş 
return
ÿÿ 
false
ÿÿ 
;
ÿÿ 
}
€€ 
}
 	
public
…… 
bool
…… 
endStringUsed
…… !
{
†† 	
get
‡‡ 
{
ˆˆ 
try
‰‰ 
{
ŠŠ 
return
‹‹ 
m_endStringUsed
‹‹ *
;
‹‹* +
}
ŒŒ 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
‘‘ 
{
’’ 
}
”” 
return
•• 
false
•• 
;
•• 
}
–– 
}
—— 	
public
›› 
string
›› 
	endString
›› 
{
œœ 	
get
 
{
 
try
ŸŸ 
{
   
return
¡¡ 
m_endString
¡¡ &
;
¡¡& '
}
¢¢ 
catch
££ 
(
££ 
	Exception
££  
ex
££! #
)
££# $
{
¤¤ 
FDebug
¥¥ 
.
¥¥ 
throwException
¥¥ )
(
¥¥) *
ex
¥¥* ,
)
¥¥, -
;
¥¥- .
}
¦¦ 
finally
§§ 
{
¨¨ 
}
ªª 
return
«« 
string
«« 
.
«« 
Empty
«« #
;
««# $
}
¬¬ 
set
®® 
{
¯¯ 
try
°° 
{
±± 
	endString
²² 
=
²² 
value
²²  %
;
²²% &
}
³³ 
catch
´´ 
(
´´ 
	Exception
´´  
ex
´´! #
)
´´# $
{
µµ 
FDebug
¶¶ 
.
¶¶ 
throwException
¶¶ )
(
¶¶) *
ex
¶¶* ,
)
¶¶, -
;
¶¶- .
}
·· 
finally
¸¸ 
{
¹¹ 
}
»» 
}
¼¼ 
}
½½ 	
public
ÁÁ 
int
ÁÁ 
maxLogFileSize
ÁÁ !
{
ÂÂ 	
get
ÃÃ 
{
ÄÄ 
try
ÅÅ 
{
ÆÆ 
return
ÇÇ 
m_maxLogFileSize
ÇÇ +
;
ÇÇ+ ,
}
ÈÈ 
catch
ÉÉ 
(
ÉÉ 
	Exception
ÉÉ  
ex
ÉÉ! #
)
ÉÉ# $
{
ÊÊ 
FDebug
ËË 
.
ËË 
throwException
ËË )
(
ËË) *
ex
ËË* ,
)
ËË, -
;
ËË- .
}
ÌÌ 
finally
ÍÍ 
{
ÎÎ 
}
ĞĞ 
return
ÑÑ 
$num
ÑÑ 
;
ÑÑ 
}
ÒÒ 
set
ÔÔ 
{
ÕÕ 
try
ÖÖ 
{
×× 
m_maxLogFileSize
ØØ $
=
ØØ% &
value
ØØ' ,
;
ØØ, -
}
ÙÙ 
catch
ÚÚ 
(
ÚÚ 
	Exception
ÚÚ  
ex
ÚÚ! #
)
ÚÚ# $
{
ÛÛ 
FDebug
ÜÜ 
.
ÜÜ 
throwException
ÜÜ )
(
ÜÜ) *
ex
ÜÜ* ,
)
ÜÜ, -
;
ÜÜ- .
}
İİ 
finally
ŞŞ 
{
ßß 
}
áá 
}
ââ 
}
ãã 	
public
çç 
bool
çç &
logFileAutoDeleteEnabled
çç ,
{
èè 	
get
éé 
{
êê 
try
ëë 
{
ìì 
return
íí (
m_logFileAutoDeleteEnabled
íí 5
;
íí5 6
}
îî 
catch
ïï 
(
ïï 
	Exception
ïï  
ex
ïï! #
)
ïï# $
{
ğğ 
FDebug
ññ 
.
ññ 
throwException
ññ )
(
ññ) *
ex
ññ* ,
)
ññ, -
;
ññ- .
}
òò 
finally
óó 
{
ôô 
}
öö 
return
÷÷ 
false
÷÷ 
;
÷÷ 
}
øø 
set
úú 
{
ûû 
try
üü 
{
ıı (
m_logFileAutoDeleteEnabled
şş .
=
şş/ 0
value
şş1 6
;
şş6 7
}
ÿÿ 
catch
€€ 
(
€€ 
	Exception
€€  
ex
€€! #
)
€€# $
{
 
FDebug
‚‚ 
.
‚‚ 
throwException
‚‚ )
(
‚‚) *
ex
‚‚* ,
)
‚‚, -
;
‚‚- .
}
ƒƒ 
finally
„„ 
{
…… 
}
‡‡ 
}
ˆˆ 
}
‰‰ 	
public
 
int
 "
logFileKeepingPeriod
 '
{
 	
get
 
{
 
try
‘‘ 
{
’’ 
return
““ $
m_logFileKeepingPeriod
““ 1
;
““1 2
}
”” 
catch
•• 
(
•• 
	Exception
••  
ex
••! #
)
••# $
{
–– 
FDebug
—— 
.
—— 
throwException
—— )
(
——) *
ex
——* ,
)
——, -
;
——- .
}
˜˜ 
finally
™™ 
{
šš 
}
œœ 
return
 
$num
 
;
 
}
 
set
   
{
¡¡ 
try
¢¢ 
{
££ $
m_logFileKeepingPeriod
¤¤ *
=
¤¤+ ,
value
¤¤- 2
;
¤¤2 3
}
¥¥ 
catch
¦¦ 
(
¦¦ 
	Exception
¦¦  
ex
¦¦! #
)
¦¦# $
{
§§ 
FDebug
¨¨ 
.
¨¨ 
throwException
¨¨ )
(
¨¨) *
ex
¨¨* ,
)
¨¨, -
;
¨¨- .
}
©© 
finally
ªª 
{
«« 
}
­­ 
}
®® 
}
¯¯ 	
private
·· 
void
·· 
init
·· 
(
·· 
)
¸¸ 
{
¹¹ 	
try
ºº 
{
»» 
m_fLogQueue
¼¼ 
=
¼¼ 
new
¼¼ !
FQueue
¼¼" (
<
¼¼( )
string
¼¼) /
>
¼¼/ 0
(
¼¼0 1
)
¼¼1 2
;
¼¼2 3!
m_fTmrLogFileDelete
¾¾ #
=
¾¾$ %
new
¾¾& )
FStaticTimer
¾¾* 6
(
¾¾6 7
)
¾¾7 8
;
¾¾8 9!
m_fTmrLogFileDelete
¿¿ #
.
¿¿# $
start
¿¿$ )
(
¿¿) *!
LogFileDeletePeriod
¿¿* =
)
¿¿= >
;
¿¿> ?

m_fThdMain
ÁÁ 
=
ÁÁ 
new
ÁÁ  
FThread
ÁÁ! (
(
ÁÁ( )
$str
ÁÁ) A
)
ÁÁA B
;
ÁÁB C

m_fThdMain
ÂÂ 
.
ÂÂ 
ThreadJobCalled
ÂÂ *
+=
ÂÂ+ -
new
ÂÂ. 1*
FThreadJobCalledEventHandler
ÂÂ2 N
(
ÂÂN O(
m_fThdMain_ThreadJobCalled
ÂÂO i
)
ÂÂi j
;
ÂÂj k

m_fThdMain
ÃÃ 
.
ÃÃ 
start
ÃÃ  
(
ÃÃ  !
)
ÃÃ! "
;
ÃÃ" #
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
	Exception
ÅÅ 
ex
ÅÅ 
)
ÅÅ  
{
ÆÆ 
FDebug
ÇÇ 
.
ÇÇ 
throwException
ÇÇ %
(
ÇÇ% &
ex
ÇÇ& (
)
ÇÇ( )
;
ÇÇ) *
}
ÈÈ 
finally
ÉÉ 
{
ÊÊ 
}
ÌÌ 
}
ÍÍ 	
private
ÑÑ 
void
ÑÑ 
term
ÑÑ 
(
ÑÑ 
)
ÒÒ 
{
ÓÓ 	
try
ÔÔ 
{
ÕÕ 
if
ÖÖ 
(
ÖÖ 

m_fThdMain
ÖÖ 
!=
ÖÖ !
null
ÖÖ" &
)
ÖÖ& '
{
×× 
while
ÛÛ 
(
ÛÛ 
m_fLogQueue
ÛÛ &
.
ÛÛ& '
count
ÛÛ' ,
>
ÛÛ- .
$num
ÛÛ/ 0
)
ÛÛ0 1
{
ÜÜ 
System
İİ 
.
İİ 
	Threading
İİ (
.
İİ( )
Thread
İİ) /
.
İİ/ 0
Sleep
İİ0 5
(
İİ5 6
$num
İİ6 8
)
İİ8 9
;
İİ9 :
}
ŞŞ 

m_fThdMain
ââ 
.
ââ 
stop
ââ #
(
ââ# $
)
ââ$ %
;
ââ% &

m_fThdMain
ãã 
.
ãã 
Dispose
ãã &
(
ãã& '
)
ãã' (
;
ãã( )

m_fThdMain
ää 
.
ää 
ThreadJobCalled
ää .
-=
ää/ 1
new
ää2 5*
FThreadJobCalledEventHandler
ää6 R
(
ääR S(
m_fThdMain_ThreadJobCalled
ääS m
)
ääm n
;
ään o

m_fThdMain
åå 
=
åå  
null
åå! %
;
åå% &
}
ææ 
if
èè 
(
èè !
m_fTmrLogFileDelete
èè '
!=
èè( *
null
èè+ /
)
èè/ 0
{
éé !
m_fTmrLogFileDelete
êê '
.
êê' (
Dispose
êê( /
(
êê/ 0
)
êê0 1
;
êê1 2!
m_fTmrLogFileDelete
ëë '
=
ëë( )
null
ëë* .
;
ëë. /
}
ìì 
if
îî 
(
îî 
m_fLogQueue
îî 
!=
îî  "
null
îî# '
)
îî' (
{
ïï 
m_fLogQueue
ğğ 
.
ğğ  
Dispose
ğğ  '
(
ğğ' (
)
ğğ( )
;
ğğ) *
m_fLogQueue
ññ 
=
ññ  !
null
ññ" &
;
ññ& '
}
òò 
closeLogFile
ôô 
(
ôô 
)
ôô 
;
ôô 
}
õõ 
catch
öö 
(
öö 
	Exception
öö 
ex
öö 
)
öö  
{
÷÷ 
FDebug
øø 
.
øø 
throwException
øø %
(
øø% &
ex
øø& (
)
øø( )
;
øø) *
}
ùù 
finally
úú 
{
ûû 
}
ıı 
}
şş 	
private
‚‚ 
void
‚‚ 
openLogFile
‚‚  
(
‚‚  !
)
ƒƒ 
{
„„ 	
string
…… 
[
…… 
]
…… 
files
…… 
=
…… 
null
…… !
;
……! "
string
†† 
searchPattern
††  
=
††! "
string
††# )
.
††) *
Empty
††* /
;
††/ 0
string
‡‡ 
fileName
‡‡ 
=
‡‡ 
string
‡‡ $
.
‡‡$ %
Empty
‡‡% *
;
‡‡* +
FileInfo
ˆˆ 
fileInfo
ˆˆ 
=
ˆˆ 
null
ˆˆ  $
;
ˆˆ$ %
try
ŠŠ 
{
‹‹ 
if
ŒŒ 
(
ŒŒ 
!
ŒŒ 
	Directory
ŒŒ 
.
ŒŒ 
Exists
ŒŒ %
(
ŒŒ% &
m_logFilePath
ŒŒ& 3
)
ŒŒ3 4
)
ŒŒ4 5
{
 
	Directory
 
.
 
CreateDirectory
 -
(
- .
m_logFilePath
. ;
)
; <
;
< =
}
 
if
““ 
(
““ 
m_swLogFile
““ 
==
““  "
null
““# '
)
““' (
{
”” 
searchPattern
•• !
=
••" #
$str
••$ (
+
••) *
m_logFileSuffix
••+ :
+
••; <
$str
••= @
+
••A B
m_logFileExt
••C O
;
••O P
files
–– 
=
–– 
	Directory
–– %
.
––% &
GetFiles
––& .
(
––. /
m_logFilePath
––/ <
,
––< =
searchPattern
––> K
)
––K L
;
––L M
if
šš 
(
šš 
files
šš 
.
šš 
Length
šš $
==
šš% '
$num
šš( )
)
šš) *
{
›› 
m_openedFileName
œœ (
=
œœ) *
string
œœ+ 1
.
œœ1 2
Empty
œœ2 7
;
œœ7 8
}
 
else
 
{
ŸŸ 
m_openedFileName
   (
=
  ) *
files
  + 0
[
  0 1
files
  1 6
.
  6 7
Length
  7 =
-
  > ?
$num
  @ A
]
  A B
;
  B C
fileInfo
¢¢  
=
¢¢! "
new
¢¢# &
FileInfo
¢¢' /
(
¢¢/ 0
m_openedFileName
¢¢0 @
)
¢¢@ A
;
¢¢A B
if
££ 
(
££ 
fileInfo
££ $
.
££$ %
Length
££% +
>=
££, .
m_maxLogFileSize
££/ ?
)
££? @
{
¤¤ 
m_openedFileName
¥¥ ,
=
¥¥- .
string
¥¥/ 5
.
¥¥5 6
Empty
¥¥6 ;
;
¥¥; <
}
¦¦ 
}
§§ 

m_filePath
«« 
=
««  
m_logFilePath
««! .
;
««. /
m_fileSuffix
¬¬  
=
¬¬! "
m_logFileSuffix
¬¬# 2
;
¬¬2 3
	m_fileExt
­­ 
=
­­ 
m_logFileExt
­­  ,
;
­­, -
}
®® 
else
¯¯ 
if
¯¯ 
(
¯¯ 
m_logFilePath
¯¯ &
!=
¯¯' )

m_filePath
¯¯* 4
||
¯¯5 7
m_logFileSuffix
¯¯8 G
!=
¯¯H J
m_fileSuffix
¯¯K W
||
¯¯X Z
m_logFileExt
¯¯[ g
!=
¯¯h j
	m_fileExt
¯¯k t
)
¯¯t u
{
°° 
closeLogFile
±±  
(
±±  !
)
±±! "
;
±±" #
m_openedFileName
µµ $
=
µµ% &
string
µµ' -
.
µµ- .
Empty
µµ. 3
;
µµ3 4

m_filePath
¹¹ 
=
¹¹  
m_logFilePath
¹¹! .
;
¹¹. /
m_fileSuffix
ºº  
=
ºº! "
m_logFileSuffix
ºº# 2
;
ºº2 3
	m_fileExt
»» 
=
»» 
m_logFileExt
»»  ,
;
»», -
}
¼¼ 
else
½½ 
{
¾¾ 
fileInfo
¿¿ 
=
¿¿ 
new
¿¿ "
FileInfo
¿¿# +
(
¿¿+ ,
m_openedFileName
¿¿, <
)
¿¿< =
;
¿¿= >
if
ÀÀ 
(
ÀÀ 
fileInfo
ÀÀ  
.
ÀÀ  !
Length
ÀÀ! '
>=
ÀÀ( *
m_maxLogFileSize
ÀÀ+ ;
)
ÀÀ; <
{
ÁÁ 
closeLogFile
ÂÂ $
(
ÂÂ$ %
)
ÂÂ% &
;
ÂÂ& '
m_openedFileName
ÃÃ (
=
ÃÃ) *
string
ÃÃ+ 1
.
ÃÃ1 2
Empty
ÃÃ2 7
;
ÃÃ7 8
}
ÄÄ 
}
ÅÅ 
if
ÉÉ 
(
ÉÉ 
m_swLogFile
ÉÉ 
==
ÉÉ  "
null
ÉÉ# '
)
ÉÉ' (
{
ÊÊ 
if
ËË 
(
ËË 
m_openedFileName
ËË (
==
ËË) +
string
ËË, 2
.
ËË2 3
Empty
ËË3 8
)
ËË8 9
{
ÌÌ 
m_openedFileName
ÍÍ (
=
ÍÍ) *
m_logFilePath
ÍÍ+ 8
+
ÍÍ9 :
$str
ÍÍ; ?
+
ÍÍ@ A
DateTime
ÍÍB J
.
ÍÍJ K
Now
ÍÍK N
.
ÍÍN O
ToString
ÍÍO W
(
ÍÍW X
$str
ÍÍX k
)
ÍÍk l
+
ÍÍm n
$str
ÍÍo r
+
ÍÍs t
m_logFileSuffixÍÍu „
+ÍÍ… †
$strÍÍ‡ Š
+ÍÍ‹ Œ
m_logFileExtÍÍ ™
;ÍÍ™ š
}
ÎÎ 
m_fsLogFile
ÏÏ 
=
ÏÏ  !
new
ÏÏ" %

FileStream
ÏÏ& 0
(
ÏÏ0 1
m_openedFileName
ÏÏ1 A
,
ÏÏA B
FileMode
ÏÏC K
.
ÏÏK L
OpenOrCreate
ÏÏL X
|
ÏÏY Z
FileMode
ÏÏ[ c
.
ÏÏc d
Append
ÏÏd j
,
ÏÏj k

FileAccess
ÏÏl v
.
ÏÏv w
Write
ÏÏw |
,
ÏÏ| }
	FileShareÏÏ~ ‡
.ÏÏ‡ ˆ
ReadÏÏˆ Œ
)ÏÏŒ 
;ÏÏ 
m_swLogFile
ĞĞ 
=
ĞĞ  !
new
ĞĞ" %
StreamWriter
ĞĞ& 2
(
ĞĞ2 3
m_fsLogFile
ĞĞ3 >
,
ĞĞ> ?
Encoding
ĞĞ@ H
.
ĞĞH I
Default
ĞĞI P
)
ĞĞP Q
;
ĞĞQ R
}
ÑÑ 
}
ÒÒ 
catch
ÓÓ 
(
ÓÓ 
	Exception
ÓÓ 
ex
ÓÓ 
)
ÓÓ  
{
ÔÔ 
FDebug
ÕÕ 
.
ÕÕ 
throwException
ÕÕ %
(
ÕÕ% &
ex
ÕÕ& (
)
ÕÕ( )
;
ÕÕ) *
}
ÖÖ 
finally
×× 
{
ØØ 
}
ÚÚ 
}
ÛÛ 	
private
ßß 
void
ßß 
closeLogFile
ßß !
(
ßß! "
)
àà 
{
áá 	
try
ââ 
{
ãã 
if
ää 
(
ää 
m_swLogFile
ää 
!=
ää  "
null
ää# '
)
ää' (
{
åå 
m_swLogFile
ææ 
.
ææ  
Flush
ææ  %
(
ææ% &
)
ææ& '
;
ææ' (
}
çç 
if
éé 
(
éé 
m_fsLogFile
éé 
!=
éé  "
null
éé# '
)
éé' (
{
êê 
m_fsLogFile
ëë 
.
ëë  
Flush
ëë  %
(
ëë% &
)
ëë& '
;
ëë' (
}
ìì 
if
ğğ 
(
ğğ 
m_swLogFile
ğğ 
!=
ğğ  "
null
ğğ# '
)
ğğ' (
{
ññ 
m_swLogFile
òò 
.
òò  
Close
òò  %
(
òò% &
)
òò& '
;
òò' (
m_swLogFile
óó 
.
óó  
Dispose
óó  '
(
óó' (
)
óó( )
;
óó) *
m_swLogFile
ôô 
=
ôô  !
null
ôô" &
;
ôô& '
}
õõ 
if
÷÷ 
(
÷÷ 
m_fsLogFile
÷÷ 
!=
÷÷  "
null
÷÷# '
)
÷÷' (
{
øø 
m_fsLogFile
ùù 
.
ùù  
Close
ùù  %
(
ùù% &
)
ùù& '
;
ùù' (
m_fsLogFile
úú 
.
úú  
Dispose
úú  '
(
úú' (
)
úú( )
;
úú) *
m_fsLogFile
ûû 
=
ûû  !
null
ûû" &
;
ûû& '
}
üü 
}
ıı 
catch
şş 
(
şş 
	Exception
şş 
ex
şş 
)
şş  
{
ÿÿ 
FDebug
€€ 
.
€€ 
throwException
€€ %
(
€€% &
ex
€€& (
)
€€( )
;
€€) *
}
 
finally
‚‚ 
{
ƒƒ 
}
…… 
}
†† 	
private
ŠŠ 
void
ŠŠ 
writeLog
ŠŠ 
(
ŠŠ 
)
‹‹ 
{
ŒŒ 	
try
 
{
 
openLogFile
 
(
 
)
 
;
 
while
““ 
(
““ 
m_fLogQueue
““ "
.
““" #
count
““# (
>
““) *
$num
““+ ,
)
““, -
{
”” 
m_swLogFile
•• 
.
••  
Write
••  %
(
••% &
m_fLogQueue
••& 1
.
••1 2
dequeue
••2 9
(
••9 :
)
••: ;
)
••; <
;
••< =
}
–– 
m_swLogFile
šš 
.
šš 
Flush
šš !
(
šš! "
)
šš" #
;
šš# $
m_fsLogFile
›› 
.
›› 
Flush
›› !
(
››! "
)
››" #
;
››# $
}
œœ 
catch
 
(
 
	Exception
 
ex
 
)
  
{
 
FDebug
ŸŸ 
.
ŸŸ 
throwException
ŸŸ %
(
ŸŸ% &
ex
ŸŸ& (
)
ŸŸ( )
;
ŸŸ) *
}
   
finally
¡¡ 
{
¢¢ 
}
¤¤ 
}
¥¥ 	
private
©© 
void
©© 
deleteLogFile
©© "
(
©©" #
)
ªª 
{
«« 	
string
¬¬ 
fileName
¬¬ 
=
¬¬ 
string
¬¬ $
.
¬¬$ %
Empty
¬¬% *
;
¬¬* +
try
®® 
{
¯¯ 
fileName
°° 
=
°° 
DateTime
°° #
.
°°# $
Now
°°$ '
.
°°' (
AddDays
°°( /
(
°°/ 0$
m_logFileKeepingPeriod
°°0 F
*
°°G H
-
°°I J
$num
°°J K
)
°°K L
.
°°L M
ToString
°°M U
(
°°U V
$str
°°V `
)
°°` a
;
°°a b
foreach
±± 
(
±± 
string
±± 
s
±±  !
in
±±" $
	Directory
±±% .
.
±±. /
GetFiles
±±/ 7
(
±±7 8
m_logFilePath
±±8 E
,
±±E F
$str
±±G K
+
±±L M
m_logFileExt
±±N Z
)
±±Z [
)
±±[ \
{
²² 
if
³³ 
(
³³ 
fileName
³³  
.
³³  !
	CompareTo
³³! *
(
³³* +
Path
³³+ /
.
³³/ 0
GetFileName
³³0 ;
(
³³; <
s
³³< =
)
³³= >
)
³³> ?
<
³³@ A
$num
³³B C
)
³³C D
{
´´ 
break
µµ 
;
µµ 
}
¶¶ 
File
·· 
.
·· 
Delete
·· 
(
··  
s
··  !
)
··! "
;
··" #
}
¸¸ 
}
¹¹ 
catch
ºº 
(
ºº 
	Exception
ºº 
ex
ºº 
)
ºº  
{
»» 
FDebug
¼¼ 
.
¼¼ 
throwException
¼¼ %
(
¼¼% &
ex
¼¼& (
)
¼¼( )
;
¼¼) *
}
½½ 
finally
¾¾ 
{
¿¿ 
}
ÁÁ 
}
ÂÂ 	
public
ÆÆ 
void
ÆÆ 
write
ÆÆ 
(
ÆÆ 
string
ÇÇ 
log
ÇÇ 
)
ÈÈ 
{
ÉÉ 	
StringBuilder
ÊÊ 
sb
ÊÊ 
=
ÊÊ 
null
ÊÊ #
;
ÊÊ# $
string
ËË 
dateTime
ËË 
=
ËË 
string
ËË $
.
ËË$ %
Empty
ËË% *
;
ËË* +
try
ÍÍ 
{
ÎÎ 
sb
ÏÏ 
=
ÏÏ 
new
ÏÏ 
StringBuilder
ÏÏ &
(
ÏÏ& '
)
ÏÏ' (
;
ÏÏ( )
if
ÓÓ 
(
ÓÓ 
m_dateTimeUsed
ÓÓ "
)
ÓÓ" #
{
ÔÔ 
dateTime
ÕÕ 
=
ÕÕ 
$str
ÕÕ "
+
ÕÕ# $
FDataConvert
ÕÕ% 1
.
ÕÕ1 2(
defaultNowDateTimeToString
ÕÕ2 L
(
ÕÕL M
)
ÕÕM N
+
ÕÕO P
$str
ÕÕQ U
;
ÕÕU V
foreach
ÖÖ 
(
ÖÖ 
string
ÖÖ #
s
ÖÖ$ %
in
ÖÖ& (
log
ÖÖ) ,
.
ÖÖ, -
Split
ÖÖ- 2
(
ÖÖ2 3
Environment
ÖÖ3 >
.
ÖÖ> ?
NewLine
ÖÖ? F
.
ÖÖF G
ToArray
ÖÖG N
(
ÖÖN O
)
ÖÖO P
,
ÖÖP Q 
StringSplitOptions
ÖÖR d
.
ÖÖd e 
RemoveEmptyEntries
ÖÖe w
)
ÖÖw x
)
ÖÖx y
{
×× 
sb
ØØ 
.
ØØ 

AppendLine
ØØ %
(
ØØ% &
dateTime
ØØ& .
+
ØØ/ 0
s
ØØ1 2
)
ØØ2 3
;
ØØ3 4
}
ÙÙ 
}
ÚÚ 
else
ÛÛ 
{
ÜÜ 
sb
İİ 
.
İİ 

AppendLine
İİ !
(
İİ! "
log
İİ" %
)
İİ% &
;
İİ& '
}
ŞŞ 
if
àà 
(
àà 
m_endStringUsed
àà #
)
àà# $
{
áá 
sb
ââ 
.
ââ 

AppendLine
ââ !
(
ââ! "
m_endString
ââ" -
)
ââ- .
;
ââ. /
}
ãã 
m_fLogQueue
çç 
.
çç 
enqueue
çç #
(
çç# $
sb
çç$ &
.
çç& '
ToString
çç' /
(
çç/ 0
)
çç0 1
)
çç1 2
;
çç2 3
}
èè 
catch
éé 
(
éé 
	Exception
éé 
ex
éé 
)
éé  
{
êê 
FDebug
ëë 
.
ëë 
throwException
ëë %
(
ëë% &
ex
ëë& (
)
ëë( )
;
ëë) *
}
ìì 
finally
íí 
{
îî 
}
ğğ 
}
ññ 	
public
õõ 
void
õõ 
write
õõ 
(
õõ !
FServiceLogCategory
öö 
	fCategory
öö  )
,
öö) *
string
÷÷ 
action
÷÷ 
,
÷÷ 
string
øø 
typeNamespace
øø  
,
øø  !
string
ùù 
typeName
ùù 
,
ùù 
string
úú 
functionName
úú 
,
úú  
string
ûû 
log
ûû 
)
üü 
{
ıı 	
StringBuilder
şş 
sb
şş 
=
şş 
null
şş #
;
şş# $
try
€€ 
{
 
sb
‚‚ 
=
‚‚ 
new
‚‚ 
StringBuilder
‚‚ &
(
‚‚& '
)
‚‚' (
;
‚‚( )
if
„„ 
(
„„ 
	fCategory
„„ 
==
„„  !
FServiceLogCategory
„„! 4
.
„„4 5
Information
„„5 @
)
„„@ A
{
…… 
sb
†† 
.
†† 
Append
†† 
(
†† 
$str
†† .
)
††. /
;
††/ 0
}
‡‡ 
else
ˆˆ 
if
ˆˆ 
(
ˆˆ 
	fCategory
ˆˆ "
==
ˆˆ# %!
FServiceLogCategory
ˆˆ& 9
.
ˆˆ9 :
Warning
ˆˆ: A
)
ˆˆA B
{
‰‰ 
sb
ŠŠ 
.
ŠŠ 
Append
ŠŠ 
(
ŠŠ 
$str
ŠŠ .
)
ŠŠ. /
;
ŠŠ/ 0
}
‹‹ 
else
ŒŒ 
{
 
sb
 
.
 
Append
 
(
 
$str
 .
)
. /
;
/ 0
}
 
sb
““ 
.
““ 
Append
““ 
(
““ 
$str
““ $
+
““% &
action
““' -
+
““. /
$str
““0 5
)
““5 6
;
““6 7
sb
”” 
.
”” 
Append
”” 
(
”” 
$str
”” '
+
””( )
typeNamespace
””* 7
+
””8 9
$str
””: ?
)
””? @
;
””@ A
sb
•• 
.
•• 
Append
•• 
(
•• 
$str
•• &
+
••' (
typeName
••) 1
+
••2 3
$str
••4 9
)
••9 :
;
••: ;
sb
–– 
.
–– 
Append
–– 
(
–– 
$str
–– &
+
––' (
functionName
––) 5
+
––6 7
$str
––8 ;
)
––; <
;
––< =
if
šš 
(
šš 
log
šš 
!=
šš 
string
šš !
.
šš! "
Empty
šš" '
)
šš' (
{
›› 
sb
œœ 
.
œœ 
Append
œœ 
(
œœ 
Environment
œœ )
.
œœ) *
NewLine
œœ* 1
)
œœ1 2
;
œœ2 3
sb
 
.
 
Append
 
(
 
$str
 :
)
: ;
;
; <
sb
ŸŸ 
.
ŸŸ 
Append
ŸŸ 
(
ŸŸ 
Environment
ŸŸ )
.
ŸŸ) *
NewLine
ŸŸ* 1
)
ŸŸ1 2
;
ŸŸ2 3
sb
   
.
   
Append
   
(
   
log
   !
)
  ! "
;
  " #
}
¡¡ 
write
¥¥ 
(
¥¥ 
sb
¥¥ 
.
¥¥ 
ToString
¥¥ !
(
¥¥! "
)
¥¥" #
)
¥¥# $
;
¥¥$ %
}
¦¦ 
catch
§§ 
(
§§ 
	Exception
§§ 
ex
§§ 
)
§§  
{
¨¨ 
FDebug
©© 
.
©© 
throwException
©© %
(
©©% &
ex
©©& (
)
©©( )
;
©©) *
}
ªª 
finally
«« 
{
¬¬ 
}
®® 
}
¯¯ 	
public
³³ 
void
³³ 
write
³³ 
(
³³ !
FServiceLogCategory
´´ 
	fCategory
´´  )
,
´´) *
string
µµ 
action
µµ 
,
µµ 
Type
¶¶ 
type
¶¶ 
,
¶¶ 
string
·· 
functionName
·· 
,
··  
string
¸¸ 
log
¸¸ 
)
¹¹ 
{
ºº 	
try
»» 
{
¼¼ 
write
½½ 
(
½½ 
	fCategory
½½ 
,
½½  
action
½½! '
,
½½' (
type
½½) -
.
½½- .
	Namespace
½½. 7
,
½½7 8
type
½½9 =
.
½½= >
Name
½½> B
,
½½B C
functionName
½½D P
,
½½P Q
log
½½R U
)
½½U V
;
½½V W
}
¾¾ 
catch
¿¿ 
(
¿¿ 
	Exception
¿¿ 
ex
¿¿ 
)
¿¿  
{
ÀÀ 
FDebug
ÁÁ 
.
ÁÁ 
throwException
ÁÁ %
(
ÁÁ% &
ex
ÁÁ& (
)
ÁÁ( )
;
ÁÁ) *
}
ÂÂ 
finally
ÃÃ 
{
ÄÄ 
}
ÆÆ 
}
ÇÇ 	
public
ËË 
void
ËË 
write
ËË 
(
ËË 
FServiceLogData
ÌÌ 
fLogData
ÌÌ $
)
ÍÍ 
{
ÎÎ 	
DateTime
ÏÏ 
endTime
ÏÏ 
;
ÏÏ 
try
ÑÑ 
{
ÒÒ 
endTime
ÓÓ 
=
ÓÓ 
DateTime
ÓÓ "
.
ÓÓ" #
Now
ÓÓ# &
;
ÓÓ& '
fLogData
×× 
.
×× 
logData
××  
.
××  !
Append
××! '
(
××' (
$str
××( 3
+
××4 5
FDataConvert
××6 B
.
××B C(
defaultNowDateTimeToString
××C ]
(
××] ^
)
××^ _
+
××` a
$str
××b g
)
××g h
;
××h i
fLogData
ØØ 
.
ØØ 
logData
ØØ  
.
ØØ  !
Append
ØØ! '
(
ØØ' (
$str
ØØ( 4
+
ØØ5 6
endTime
ØØ7 >
.
ØØ> ?
Subtract
ØØ? G
(
ØØG H
fLogData
ØØH P
.
ØØP Q
	startTime
ØØQ Z
)
ØØZ [
.
ØØ[ \
TotalMilliseconds
ØØ\ m
.
ØØm n
ToString
ØØn v
(
ØØv w
$str
ØØw {
)
ØØ{ |
+
ØØ} ~
$strØØ ‚
)ØØ‚ ƒ
;ØØƒ „
write
ÚÚ 
(
ÚÚ 
fLogData
ÚÚ 
.
ÚÚ 
logData
ÚÚ &
.
ÚÚ& '
ToString
ÚÚ' /
(
ÚÚ/ 0
)
ÚÚ0 1
)
ÚÚ1 2
;
ÚÚ2 3
}
ÛÛ 
catch
ÜÜ 
(
ÜÜ 
	Exception
ÜÜ 
ex
ÜÜ 
)
ÜÜ  
{
İİ 
FDebug
ŞŞ 
.
ŞŞ 
throwException
ŞŞ %
(
ŞŞ% &
ex
ŞŞ& (
)
ŞŞ( )
;
ŞŞ) *
}
ßß 
finally
àà 
{
áá 
}
ãã 
}
ää 	
private
ìì 
void
ìì (
m_fThdMain_ThreadJobCalled
ìì /
(
ìì/ 0
object
íí 
sender
íí 
,
íí 
FThreadEventArgs
îî 
e
îî 
)
ïï 
{
ğğ 	
try
ññ 
{
òò 
if
óó 
(
óó 
m_fLogQueue
óó 
.
óó  
count
óó  %
==
óó& (
$num
óó) *
)
óó* +
{
ôô 
e
õõ 
.
õõ 
sleepThread
õõ !
(
õõ! "
$num
õõ" #
)
õõ# $
;
õõ$ %
return
öö 
;
öö 
}
÷÷ 
writeLog
ûû 
(
ûû 
)
ûû 
;
ûû 
if
‚‚ 
(
‚‚ (
m_logFileAutoDeleteEnabled
‚‚ .
&&
‚‚/ 1!
m_fTmrLogFileDelete
‚‚2 E
.
‚‚E F
elasped
‚‚F M
(
‚‚M N
false
‚‚N S
)
‚‚S T
)
‚‚T U
{
ƒƒ !
m_fTmrLogFileDelete
„„ '
.
„„' (
restart
„„( /
(
„„/ 0
)
„„0 1
;
„„1 2
deleteLogFile
…… !
(
……! "
)
……" #
;
……# $
}
†† 
}
‡‡ 
catch
ˆˆ 
(
ˆˆ 
	Exception
ˆˆ 
ex
ˆˆ 
)
ˆˆ  
{
‰‰ 
FDebug
ŠŠ 
.
ŠŠ 
writeLog
ŠŠ 
(
ŠŠ  
ex
ŠŠ  "
)
ŠŠ" #
;
ŠŠ# $
}
‹‹ 
finally
ŒŒ 
{
 
}
 
}
 	
}
–– 
}—— Å|
XD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Pipe\c_FPipeFlag.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
	FPipeFlag 
: 
IDisposable (
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
	FCodeLock 
m_fLock !
=" #
null$ (
;( )
private 
int 
m_connectCount "
=# $
$num% &
;& '
private 
int 
m_sendCount 
=  !
$num" #
;# $
private 
int 
m_receiveCount "
=# $
$num% &
;& '
private   
bool   
m_disconnected   #
=  $ %
false  & +
;  + ,
public&& 
	FPipeFlag&& 
(&& 
)'' 
{(( 	
m_fLock)) 
=)) 
new)) 
	FCodeLock)) #
())# $
)))$ %
;))% &
}** 	
~.. 	
	FPipeFlag..	 
(.. 
)// 
{00 	
	myDispose11 
(11 
false11 
)11 
;11 
}22 	
	protected66 
void66 
	myDispose66  
(66  !
bool77 
	disposing77 
)88 
{99 	
if:: 
(:: 
!:: 

m_disposed:: 
):: 
{;; 
if<< 
(<< 
	disposing<< 
)<< 
{== 
if>> 
(>> 
m_fLock>> 
!=>>  "
null>># '
)>>' (
{?? 
m_fLock@@ 
.@@  
Dispose@@  '
(@@' (
)@@( )
;@@) *
m_fLockAA 
=AA  !
nullAA" &
;AA& '
}BB 
}CC 

m_disposedEE 
=EE 
trueEE !
;EE! "
}FF 
}GG 	
publicOO 
voidOO 
DisposeOO 
(OO 
)PP 
{QQ 	
	myDisposeRR 
(RR 
trueRR 
)RR 
;RR 
GCSS 
.SS 
SuppressFinalizeSS 
(SS  
thisSS  $
)SS$ %
;SS% &
}TT 	
public\\ 
bool\\ 
doConnectCompleted\\ &
{]] 	
get^^ 
{__ 
try`` 
{aa 
returnbb 
m_connectCountbb )
==bb* ,
$numbb- .
?bb/ 0
truebb1 5
:bb6 7
falsebb8 =
;bb= >
}cc 
catchdd 
(dd 
	Exceptiondd  
exdd! #
)dd# $
{ee 
FDebugff 
.ff 
throwExceptionff )
(ff) *
exff* ,
)ff, -
;ff- .
}gg 
finallyhh 
{ii 
}kk 
returnll 
falsell 
;ll 
}mm 
}nn 	
publicrr 
boolrr 
doReceiveCompletedrr &
{ss 	
gettt 
{uu 
tryvv 
{ww 
returnxx 
m_receiveCountxx )
==xx* ,
$numxx- .
?xx/ 0
truexx1 5
:xx6 7
falsexx8 =
;xx= >
}yy 
catchzz 
(zz 
	Exceptionzz  
exzz! #
)zz# $
{{{ 
FDebug|| 
.|| 
throwException|| )
(||) *
ex||* ,
)||, -
;||- .
}}} 
finally~~ 
{ 
}
 
return
‚‚ 
false
‚‚ 
;
‚‚ 
}
ƒƒ 
}
„„ 	
public
ˆˆ 
bool
ˆˆ 
doSendCompleted
ˆˆ #
{
‰‰ 	
get
ŠŠ 
{
‹‹ 
try
ŒŒ 
{
 
return
 
m_sendCount
 &
==
' )
$num
* +
?
, -
true
. 2
:
3 4
false
5 :
;
: ;
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
‘‘ 
FDebug
’’ 
.
’’ 
throwException
’’ )
(
’’) *
ex
’’* ,
)
’’, -
;
’’- .
}
““ 
finally
”” 
{
•• 
}
—— 
return
˜˜ 
false
˜˜ 
;
˜˜ 
}
™™ 
}
šš 	
public
 
bool
 
disconnected
  
{
ŸŸ 	
get
   
{
¡¡ 
try
¢¢ 
{
££ 
return
¤¤ 
m_disconnected
¤¤ )
;
¤¤) *
}
¥¥ 
catch
¦¦ 
(
¦¦ 
	Exception
¦¦  
ex
¦¦! #
)
¦¦# $
{
§§ 
FDebug
¨¨ 
.
¨¨ 
throwException
¨¨ )
(
¨¨) *
ex
¨¨* ,
)
¨¨, -
;
¨¨- .
}
©© 
finally
ªª 
{
«« 
}
­­ 
return
®® 
false
®® 
;
®® 
}
¯¯ 
set
±± 
{
²² 
try
³³ 
{
´´ 
m_disconnected
µµ "
=
µµ# $
value
µµ% *
;
µµ* +
}
¶¶ 
catch
·· 
(
·· 
	Exception
··  
ex
··! #
)
··# $
{
¸¸ 
FDebug
¹¹ 
.
¹¹ 
throwException
¹¹ )
(
¹¹) *
ex
¹¹* ,
)
¹¹, -
;
¹¹- .
}
ºº 
finally
»» 
{
¼¼ 
}
¾¾ 
}
¿¿ 
}
ÀÀ 	
public
ÈÈ 
void
ÈÈ 
init
ÈÈ 
(
ÈÈ 
)
ÉÉ 
{
ÊÊ 	
try
ËË 
{
ÌÌ 
m_connectCount
ÍÍ 
=
ÍÍ  
$num
ÍÍ! "
;
ÍÍ" #
m_sendCount
ÎÎ 
=
ÎÎ 
$num
ÎÎ 
;
ÎÎ  
m_receiveCount
ÏÏ 
=
ÏÏ  
$num
ÏÏ! "
;
ÏÏ" #
m_disconnected
ÑÑ 
=
ÑÑ  
false
ÑÑ! &
;
ÑÑ& '
}
ÒÒ 
catch
ÓÓ 
(
ÓÓ 
	Exception
ÓÓ 
ex
ÓÓ 
)
ÓÓ  
{
ÔÔ 
FDebug
ÕÕ 
.
ÕÕ 
throwException
ÕÕ %
(
ÕÕ% &
ex
ÕÕ& (
)
ÕÕ( )
;
ÕÕ) *
}
ÖÖ 
finally
×× 
{
ØØ 
}
ÚÚ 
}
ÛÛ 	
public
ßß 
int
ßß 
beginConnect
ßß 
(
ßß  
)
àà 
{
áá 	
try
ââ 
{
ãã 
m_fLock
ää 
.
ää 
wait
ää 
(
ää 
)
ää 
;
ää 
return
åå 
++
åå 
m_connectCount
åå '
;
åå' (
}
ææ 
catch
çç 
(
çç 
	Exception
çç 
ex
çç 
)
çç  
{
èè 
FDebug
éé 
.
éé 
throwException
éé %
(
éé% &
ex
éé& (
)
éé( )
;
éé) *
}
êê 
finally
ëë 
{
ìì 
m_fLock
íí 
.
íí 
set
íí 
(
íí 
)
íí 
;
íí 
}
îî 
return
ïï 
$num
ïï 
;
ïï 
}
ğğ 	
public
ôô 
int
ôô 

endConnect
ôô 
(
ôô 
)
õõ 
{
öö 	
try
÷÷ 
{
øø 
m_fLock
ùù 
.
ùù 
wait
ùù 
(
ùù 
)
ùù 
;
ùù 
return
úú 
--
úú 
m_connectCount
úú '
;
úú' (
}
ûû 
catch
üü 
(
üü 
	Exception
üü 
ex
üü 
)
üü  
{
ıı 
FDebug
şş 
.
şş 
throwException
şş %
(
şş% &
ex
şş& (
)
şş( )
;
şş) *
}
ÿÿ 
finally
€€ 
{
 
m_fLock
‚‚ 
.
‚‚ 
set
‚‚ 
(
‚‚ 
)
‚‚ 
;
‚‚ 
}
ƒƒ 
return
„„ 
$num
„„ 
;
„„ 
}
…… 	
public
‰‰ 
int
‰‰ 
	beginSend
‰‰ 
(
‰‰ 
)
ŠŠ 
{
‹‹ 	
try
ŒŒ 
{
 
m_fLock
 
.
 
wait
 
(
 
)
 
;
 
return
 
++
 
m_sendCount
 $
;
$ %
}
 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘ 
ex
‘‘ 
)
‘‘  
{
’’ 
FDebug
““ 
.
““ 
throwException
““ %
(
““% &
ex
““& (
)
““( )
;
““) *
}
”” 
finally
•• 
{
–– 
m_fLock
—— 
.
—— 
set
—— 
(
—— 
)
—— 
;
—— 
}
˜˜ 
return
™™ 
$num
™™ 
;
™™ 
}
šš 	
public
 
int
 
endSend
 
(
 
)
ŸŸ 
{
   	
try
¡¡ 
{
¢¢ 
m_fLock
££ 
.
££ 
wait
££ 
(
££ 
)
££ 
;
££ 
return
¤¤ 
--
¤¤ 
m_sendCount
¤¤ $
;
¤¤$ %
}
¥¥ 
catch
¦¦ 
(
¦¦ 
	Exception
¦¦ 
ex
¦¦ 
)
¦¦  
{
§§ 
FDebug
¨¨ 
.
¨¨ 
throwException
¨¨ %
(
¨¨% &
ex
¨¨& (
)
¨¨( )
;
¨¨) *
}
©© 
finally
ªª 
{
«« 
m_fLock
¬¬ 
.
¬¬ 
set
¬¬ 
(
¬¬ 
)
¬¬ 
;
¬¬ 
}
­­ 
return
®® 
$num
®® 
;
®® 
}
¯¯ 	
public
³³ 
int
³³ 
beginReceive
³³ 
(
³³  
)
´´ 
{
µµ 	
try
¶¶ 
{
·· 
m_fLock
¸¸ 
.
¸¸ 
wait
¸¸ 
(
¸¸ 
)
¸¸ 
;
¸¸ 
return
¹¹ 
++
¹¹ 
m_receiveCount
¹¹ '
;
¹¹' (
}
ºº 
catch
»» 
(
»» 
	Exception
»» 
ex
»» 
)
»»  
{
¼¼ 
FDebug
½½ 
.
½½ 
throwException
½½ %
(
½½% &
ex
½½& (
)
½½( )
;
½½) *
}
¾¾ 
finally
¿¿ 
{
ÀÀ 
m_fLock
ÁÁ 
.
ÁÁ 
set
ÁÁ 
(
ÁÁ 
)
ÁÁ 
;
ÁÁ 
}
ÂÂ 
return
ÃÃ 
$num
ÃÃ 
;
ÃÃ 
}
ÄÄ 	
public
ÈÈ 
int
ÈÈ 

endReceive
ÈÈ 
(
ÈÈ 
)
ÉÉ 
{
ÊÊ 	
try
ËË 
{
ÌÌ 
m_fLock
ÍÍ 
.
ÍÍ 
wait
ÍÍ 
(
ÍÍ 
)
ÍÍ 
;
ÍÍ 
return
ÎÎ 
--
ÎÎ 
m_receiveCount
ÎÎ '
;
ÎÎ' (
}
ÏÏ 
catch
ĞĞ 
(
ĞĞ 
	Exception
ĞĞ 
ex
ĞĞ 
)
ĞĞ  
{
ÑÑ 
FDebug
ÒÒ 
.
ÒÒ 
throwException
ÒÒ %
(
ÒÒ% &
ex
ÒÒ& (
)
ÒÒ( )
;
ÒÒ) *
}
ÓÓ 
finally
ÔÔ 
{
ÕÕ 
m_fLock
ÖÖ 
.
ÖÖ 
set
ÖÖ 
(
ÖÖ 
)
ÖÖ 
;
ÖÖ 
}
×× 
return
ØØ 
$num
ØØ 
;
ØØ 
}
ÙÙ 	
public
İİ 
void
İİ "
waitConnectCompleted
İİ (
(
İİ( )
)
ŞŞ 
{
ßß 	
try
àà 
{
áá 
while
ââ 
(
ââ 
!
ââ 
this
ââ 
.
ââ  
doConnectCompleted
ââ /
)
ââ/ 0
{
ãã 
System
ää 
.
ää 
	Threading
ää $
.
ää$ %
Thread
ää% +
.
ää+ ,
Sleep
ää, 1
(
ää1 2
$num
ää2 3
)
ää3 4
;
ää4 5
}
åå 
}
ææ 
catch
çç 
(
çç 
	Exception
çç 
ex
çç 
)
çç  
{
èè 
FDebug
éé 
.
éé 
throwException
éé %
(
éé% &
ex
éé& (
)
éé( )
;
éé) *
}
êê 
finally
ëë 
{
ìì 
}
îî 
}
ïï 	
public
óó 
void
óó 
waitSendCompleted
óó %
(
óó% &
)
ôô 
{
õõ 	
try
öö 
{
÷÷ 
while
øø 
(
øø 
!
øø 
this
øø 
.
øø 
doSendCompleted
øø ,
)
øø, -
{
ùù 
System
úú 
.
úú 
	Threading
úú $
.
úú$ %
Thread
úú% +
.
úú+ ,
Sleep
úú, 1
(
úú1 2
$num
úú2 3
)
úú3 4
;
úú4 5
}
ûû 
}
üü 
catch
ıı 
(
ıı 
	Exception
ıı 
ex
ıı 
)
ıı  
{
şş 
FDebug
ÿÿ 
.
ÿÿ 
throwException
ÿÿ %
(
ÿÿ% &
ex
ÿÿ& (
)
ÿÿ( )
;
ÿÿ) *
}
€€ 
finally
 
{
‚‚ 
}
„„ 
}
…… 	
public
‰‰ 
void
‰‰ "
waitReceiveCompleted
‰‰ (
(
‰‰( )
)
ŠŠ 
{
‹‹ 	
try
ŒŒ 
{
 
while
 
(
 
!
 
this
 
.
  
doReceiveCompleted
 /
)
/ 0
{
 
System
 
.
 
	Threading
 $
.
$ %
Thread
% +
.
+ ,
Sleep
, 1
(
1 2
$num
2 3
)
3 4
;
4 5
}
‘‘ 
}
’’ 
catch
““ 
(
““ 
	Exception
““ 
ex
““ 
)
““  
{
”” 
FDebug
•• 
.
•• 
throwException
•• %
(
••% &
ex
••& (
)
••( )
;
••) *
}
–– 
finally
—— 
{
˜˜ 
}
šš 
}
›› 	
public
ŸŸ 
void
ŸŸ 
waitAllCompleted
ŸŸ $
(
ŸŸ$ %
)
   
{
¡¡ 	
try
¢¢ 
{
££ 
while
¤¤ 
(
¤¤ 
!
¤¤ 
this
¤¤ 
.
¤¤  
doConnectCompleted
¤¤ /
||
¤¤0 2
!
¤¤3 4
this
¤¤4 8
.
¤¤8 9
doSendCompleted
¤¤9 H
||
¤¤I K
!
¤¤L M
this
¤¤M Q
.
¤¤Q R 
doReceiveCompleted
¤¤R d
)
¤¤d e
{
¥¥ 
System
¦¦ 
.
¦¦ 
	Threading
¦¦ $
.
¦¦$ %
Thread
¦¦% +
.
¦¦+ ,
Sleep
¦¦, 1
(
¦¦1 2
$num
¦¦2 3
)
¦¦3 4
;
¦¦4 5
}
§§ 
}
¨¨ 
catch
©© 
(
©© 
	Exception
©© 
ex
©© 
)
©©  
{
ªª 
FDebug
«« 
.
«« 
throwException
«« %
(
««% &
ex
««& (
)
««( )
;
««) *
}
¬¬ 
finally
­­ 
{
®® 
}
°° 
}
±± 	
}
·· 
}¸¸ ¬ô
ZD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Pipe\c_FPipeClient.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FPipeClient 
: 
FIPipe %
,% &
IDisposable' 2
{ 
public 
event )
FPipeStateChangedEventHandler 2
PipeStateChanged3 C
=D E
nullF J
;J K
public 
event )
FPipeDataReceivedEventHandler 2
PipeDataReceived3 C
=D E
nullF J
;J K
public 
event %
FPipeDataSentEventHandler .
PipeDataSent/ ;
=< =
null> B
;B C
public 
event +
FPipeDataSendFailedEventHandler 4
PipeDataSendFailed5 G
=H I
nullJ N
;N O
public 
event (
FPipeErrorRaisedEventHandler 1
PipeErrorRaised2 A
=B C
nullD H
;H I
private!! 
const!! 
int!! 
RecvBufferSize!! (
=!!) *
$num!!+ 0
;!!0 1
private"" 
const"" 
int"" 
SendBufferSize"" (
="") *
$num""+ 0
;""0 1
private$$ 
bool$$ 

m_disposed$$ 
=$$  !
false$$" '
;$$' (
private&& 
string&& 

m_pipeName&& !
=&&" #
$str&&$ 0
;&&0 1
private'' 
int''  
m_retryConnectPeriod'' (
='') *
$num''+ /
;''/ 0
private(( 

FPipeState(( 
m_fState(( #
=(($ %

FPipeState((& 0
.((0 1
Closed((1 7
;((7 8
private)) 
bool)) 
	m_started)) 
=))  
false))! &
;))& '
private++ !
NamedPipeClientStream++ %
m_pipeClient++& 2
=++3 4
null++5 9
;++9 :
private,, 
	FPipeFlag,, 
m_fPipeFlag,, %
=,,& '
null,,( ,
;,,, -
private-- 
byte-- 
[-- 
]-- 
	m_recvBuf--  
=--! "
null--# '
;--' (
private.. 
FStaticTimer..  
m_fRetryConnectTimer.. 1
=..2 3
null..4 8
;..8 9
private00 
	FCodeLock00 
m_fMainSync00 %
=00& '
null00( ,
;00, -
private11 
	FCodeLock11 
m_fDisconnectSync11 +
=11, -
null11. 2
;112 3
private22 
FPipeEventPusher22  
m_fEventPusher22! /
=220 1
null222 6
;226 7
private33 
FThread33 

m_fThdMain33 "
=33# $
null33% )
;33) *
public99 
FPipeClient99 
(99 
string:: 
pipeName:: 
);; 
{<< 	

m_pipeName== 
=== 
pipeName== !
;==! "
init>> 
(>> 
)>> 
;>> 
}?? 	
~CC 	
FPipeClientCC	 
(CC 
)DD 
{EE 	
	myDisposeFF 
(FF 
falseFF 
)FF 
;FF 
}GG 	
	protectedKK 
voidKK 
	myDisposeKK  
(KK  !
boolLL 
	disposingLL 
)MM 
{NN 	
ifOO 
(OO 
!OO 

m_disposedOO 
)OO 
{PP 
ifQQ 
(QQ 
	disposingQQ 
)QQ 
{RR 
termSS 
(SS 
)SS 
;SS 
}TT 

m_disposedUU 
=UU 
trueUU !
;UU! "
}VV 
}WW 	
public__ 
void__ 
Dispose__ 
(__ 
)`` 
{aa 	
	myDisposebb 
(bb 
truebb 
)bb 
;bb 
GCcc 
.cc 
SuppressFinalizecc 
(cc  
thiscc  $
)cc$ %
;cc% &
}dd 	
publicll 
	FPipeTypell 
	fPipeTypell "
{mm 	
getnn 
{oo 
trypp 
{qq 
returnrr 
	FPipeTyperr $
.rr$ %
Clientrr% +
;rr+ ,
}ss 
catchtt 
(tt 
	Exceptiontt  
extt! #
)tt# $
{uu 
FDebugvv 
.vv 
throwExceptionvv )
(vv) *
exvv* ,
)vv, -
;vv- .
}ww 
finallyxx 
{yy 
}{{ 
return|| 
	FPipeType||  
.||  !
Client||! '
;||' (
}}} 
}~~ 	
public
‚‚ 
string
‚‚ 
pipeName
‚‚ 
{
ƒƒ 	
get
„„ 
{
…… 
try
†† 
{
‡‡ 
return
ˆˆ 

m_pipeName
ˆˆ %
;
ˆˆ% &
}
‰‰ 
catch
ŠŠ 
(
ŠŠ 
	Exception
ŠŠ  
ex
ŠŠ! #
)
ŠŠ# $
{
‹‹ 
FDebug
ŒŒ 
.
ŒŒ 
throwException
ŒŒ )
(
ŒŒ) *
ex
ŒŒ* ,
)
ŒŒ, -
;
ŒŒ- .
}
 
finally
 
{
 
}
‘‘ 
return
’’ 
string
’’ 
.
’’ 
Empty
’’ #
;
’’# $
}
““ 
}
”” 	
public
˜˜ 
bool
˜˜ 
started
˜˜ 
{
™™ 	
get
šš 
{
›› 
try
œœ 
{
 
return
 
	m_started
 $
;
$ %
}
ŸŸ 
catch
   
(
   
	Exception
    
ex
  ! #
)
  # $
{
¡¡ 
FDebug
¢¢ 
.
¢¢ 
throwException
¢¢ )
(
¢¢) *
ex
¢¢* ,
)
¢¢, -
;
¢¢- .
}
££ 
finally
¤¤ 
{
¥¥ 
}
§§ 
return
¨¨ 
false
¨¨ 
;
¨¨ 
}
©© 
}
ªª 	
public
®® 
int
®®  
retryConnectPeriod
®® %
{
¯¯ 	
get
°° 
{
±± 
try
²² 
{
³³ 
return
·· "
m_retryConnectPeriod
·· /
;
··/ 0
}
¸¸ 
catch
¹¹ 
(
¹¹ 
	Exception
¹¹  
ex
¹¹! #
)
¹¹# $
{
ºº 
FDebug
»» 
.
»» 
throwException
»» )
(
»») *
ex
»»* ,
)
»», -
;
»»- .
}
¼¼ 
finally
½½ 
{
¾¾ 
}
ÀÀ 
return
ÁÁ 
$num
ÁÁ 
;
ÁÁ 
}
ÂÂ 
set
ÄÄ 
{
ÅÅ 
try
ÆÆ 
{
ÇÇ 
if
ÈÈ 
(
ÈÈ 
value
ÈÈ 
<
ÈÈ 
$num
ÈÈ  !
)
ÈÈ! "
{
ÉÉ 
FDebug
ÊÊ 
.
ÊÊ 
throwFException
ÊÊ .
(
ÊÊ. /
string
ÊÊ/ 5
.
ÊÊ5 6
Format
ÊÊ6 <
(
ÊÊ< =

FConstants
ÊÊ= G
.
ÊÊG H

err_m_0005
ÊÊH R
,
ÊÊR S
$str
ÊÊT j
)
ÊÊj k
)
ÊÊk l
;
ÊÊl m
}
ËË "
m_retryConnectPeriod
ÒÒ (
=
ÒÒ) *
value
ÒÒ+ 0
;
ÒÒ0 1
}
ÓÓ 
catch
ÔÔ 
(
ÔÔ 
	Exception
ÔÔ  
ex
ÔÔ! #
)
ÔÔ# $
{
ÕÕ 
FDebug
ÖÖ 
.
ÖÖ 
throwException
ÖÖ )
(
ÖÖ) *
ex
ÖÖ* ,
)
ÖÖ, -
;
ÖÖ- .
}
×× 
finally
ØØ 
{
ÙÙ 
}
ÛÛ 
}
ÜÜ 
}
İİ 	
public
áá 

FPipeState
áá 
fState
áá  
{
ââ 	
get
ãã 
{
ää 
try
åå 
{
ææ 
return
çç 
m_fState
çç #
;
çç# $
}
èè 
catch
éé 
(
éé 
	Exception
éé  
ex
éé! #
)
éé# $
{
êê 
FDebug
ëë 
.
ëë 
throwException
ëë )
(
ëë) *
ex
ëë* ,
)
ëë, -
;
ëë- .
}
ìì 
finally
íí 
{
îî 
}
ğğ 
return
ññ 

FPipeState
ññ !
.
ññ! "
Closed
ññ" (
;
ññ( )
}
òò 
}
óó 	
private
ûû 
void
ûû 
init
ûû 
(
ûû 
)
üü 
{
ıı 	
try
şş 
{
ÿÿ 
m_fMainSync
€€ 
=
€€ 
new
€€ !
	FCodeLock
€€" +
(
€€+ ,
)
€€, -
;
€€- .
m_fDisconnectSync
 !
=
" #
new
$ '
	FCodeLock
( 1
(
1 2
)
2 3
;
3 4
m_fPipeFlag
‚‚ 
=
‚‚ 
new
‚‚ !
	FPipeFlag
‚‚" +
(
‚‚+ ,
)
‚‚, -
;
‚‚- ."
m_fRetryConnectTimer
ƒƒ $
=
ƒƒ% &
new
ƒƒ' *
FStaticTimer
ƒƒ+ 7
(
ƒƒ7 8
)
ƒƒ8 9
;
ƒƒ9 :
	m_recvBuf
„„ 
=
„„ 
new
„„ 
byte
„„  $
[
„„$ %
RecvBufferSize
„„% 3
]
„„3 4
;
„„4 5
m_fEventPusher
†† 
=
††  
new
††! $
FPipeEventPusher
††% 5
(
††5 6
this
††6 :
)
††: ;
;
††; <

m_fThdMain
ˆˆ 
=
ˆˆ 
new
ˆˆ  
FThread
ˆˆ! (
(
ˆˆ( )
$str
ˆˆ) G
)
ˆˆG H
;
ˆˆH I

m_fThdMain
‰‰ 
.
‰‰ 
ThreadJobCalled
‰‰ *
+=
‰‰+ -
new
‰‰. 1*
FThreadJobCalledEventHandler
‰‰2 N
(
‰‰N O(
m_fThdMain_ThreadJobCalled
‰‰O i
)
‰‰i j
;
‰‰j k

m_fThdMain
ŠŠ 
.
ŠŠ 
start
ŠŠ  
(
ŠŠ  !
)
ŠŠ! "
;
ŠŠ" #
}
‹‹ 
catch
ŒŒ 
(
ŒŒ 
	Exception
ŒŒ 
ex
ŒŒ 
)
ŒŒ  
{
 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
 
{
‘‘ 
}
““ 
}
”” 	
private
˜˜ 
void
˜˜ 
term
˜˜ 
(
˜˜ 
)
™™ 
{
šš 	
try
›› 
{
œœ 
if
 
(
 

m_fThdMain
 
!=
 !
null
" &
)
& '
{
 

m_fThdMain
ŸŸ 
.
ŸŸ 
stop
ŸŸ #
(
ŸŸ# $
)
ŸŸ$ %
;
ŸŸ% &

m_fThdMain
   
.
   
Dispose
   &
(
  & '
)
  ' (
;
  ( )

m_fThdMain
¡¡ 
.
¡¡ 
ThreadJobCalled
¡¡ .
-=
¡¡/ 1
new
¡¡2 5*
FThreadJobCalledEventHandler
¡¡6 R
(
¡¡R S(
m_fThdMain_ThreadJobCalled
¡¡S m
)
¡¡m n
;
¡¡n o

m_fThdMain
¢¢ 
=
¢¢  
null
¢¢! %
;
¢¢% &
}
££ 
stop
¤¤ 
(
¤¤ 
)
¤¤ 
;
¤¤ 
if
¨¨ 
(
¨¨ 
m_fEventPusher
¨¨ "
!=
¨¨# %
null
¨¨& *
)
¨¨* +
{
©© 
m_fEventPusher
ªª "
.
ªª" #(
waitEventHandlingCompleted
ªª# =
(
ªª= >
)
ªª> ?
;
ªª? @
m_fEventPusher
«« "
.
««" #
Dispose
««# *
(
««* +
)
««+ ,
;
««, -
m_fEventPusher
¬¬ "
=
¬¬# $
null
¬¬% )
;
¬¬) *
}
­­ 
if
±± 
(
±± 
m_fPipeFlag
±± 
!=
±±  "
null
±±# '
)
±±' (
{
²² 
m_fPipeFlag
³³ 
.
³³  
Dispose
³³  '
(
³³' (
)
³³( )
;
³³) *
m_fPipeFlag
´´ 
=
´´  !
null
´´" &
;
´´& '
}
µµ 
if
·· 
(
·· "
m_fRetryConnectTimer
·· (
!=
··) +
null
··, 0
)
··0 1
{
¸¸ "
m_fRetryConnectTimer
¹¹ (
.
¹¹( )
Dispose
¹¹) 0
(
¹¹0 1
)
¹¹1 2
;
¹¹2 3"
m_fRetryConnectTimer
ºº (
=
ºº) *
null
ºº+ /
;
ºº/ 0
}
»» 
if
¿¿ 
(
¿¿ 
m_fMainSync
¿¿ 
!=
¿¿  "
null
¿¿# '
)
¿¿' (
{
ÀÀ 
m_fMainSync
ÁÁ 
.
ÁÁ  
Dispose
ÁÁ  '
(
ÁÁ' (
)
ÁÁ( )
;
ÁÁ) *
m_fMainSync
ÂÂ 
=
ÂÂ  !
null
ÂÂ" &
;
ÂÂ& '
}
ÃÃ 
if
ÅÅ 
(
ÅÅ "
m_fRetryConnectTimer
ÅÅ (
!=
ÅÅ) +
null
ÅÅ, 0
)
ÅÅ0 1
{
ÆÆ "
m_fRetryConnectTimer
ÇÇ (
.
ÇÇ( )
Dispose
ÇÇ) 0
(
ÇÇ0 1
)
ÇÇ1 2
;
ÇÇ2 3"
m_fRetryConnectTimer
ÈÈ (
=
ÈÈ) *
null
ÈÈ+ /
;
ÈÈ/ 0
}
ÉÉ 
}
ÊÊ 
catch
ËË 
(
ËË 
	Exception
ËË 
ex
ËË 
)
ËË  
{
ÌÌ 
FDebug
ÍÍ 
.
ÍÍ 
throwException
ÍÍ %
(
ÍÍ% &
ex
ÍÍ& (
)
ÍÍ( )
;
ÍÍ) *
}
ÎÎ 
finally
ÏÏ 
{
ĞĞ 
}
ÒÒ 
}
ÓÓ 	
private
×× 
void
×× 
changeState
××  
(
××  !

FPipeState
ØØ 
fState
ØØ 
)
ÙÙ 
{
ÚÚ 	
try
ÛÛ 
{
ÜÜ 
if
İİ 
(
İİ 
m_fState
İİ 
==
İİ 
fState
İİ  &
)
İİ& '
{
ŞŞ 
return
ßß 
;
ßß 
}
àà 
m_fState
ää 
=
ää 
fState
ää !
;
ää! "
m_fEventPusher
åå 
.
åå 
	pushEvent
åå (
(
åå( )
new
åå) ,(
FPipeStateChangedEventArgs
åå- G
(
ååG H
this
ååH L
,
ååL M
fState
ååN T
)
ååT U
)
ååU V
;
ååV W
}
ææ 
catch
çç 
(
çç 
	Exception
çç 
ex
çç 
)
çç  
{
èè 
FDebug
éé 
.
éé 
throwException
éé %
(
éé% &
ex
éé& (
)
éé( )
;
éé) *
}
êê 
finally
ëë 
{
ìì 
}
îî 
}
ïï 	
private
óó 
void
óó %
pushDataSendFailedEvent
óó ,
(
óó, -
FPipeSendData
ôô 
fData
ôô 
,
ôô  
string
õõ 
message
õõ 
)
öö 
{
÷÷ 	
try
øø 
{
ùù 
m_fEventPusher
úú 
.
úú 
	pushEvent
úú (
(
úú( )
new
úú) ,*
FPipeDataSendFailedEventArgs
úú- I
(
úúI J
this
úúJ N
,
úúN O
fData
úúP U
,
úúU V
message
úúW ^
)
úú^ _
)
úú_ `
;
úú` a
}
ûû 
catch
üü 
(
üü 
	Exception
üü 
ex
üü 
)
üü  
{
ıı 
FDebug
şş 
.
şş 
writeLog
şş 
(
şş  
ex
şş  "
)
şş" #
;
şş# $
}
ÿÿ 
finally
€€ 
{
 
}
ƒƒ 
}
„„ 	
private
ˆˆ 
void
ˆˆ 
pushErrorEvent
ˆˆ #
(
ˆˆ# $
	Exception
‰‰ 
ex
‰‰ 
)
ŠŠ 
{
‹‹ 	
try
ŒŒ 
{
 
FDebug
 
.
 
writeLog
 
(
  
ex
  "
)
" #
;
# $
m_fEventPusher
 
.
 
	pushEvent
 (
(
( )
new
) ,'
FPipeErrorRaisedEventArgs
- F
(
F G
this
G K
,
K L
ex
M O
.
O P
Message
P W
,
W X
ex
Y [
)
[ \
)
\ ]
;
] ^
}
‘‘ 
catch
’’ 
(
’’ 
	Exception
’’ 
ex1
’’  
)
’’  !
{
““ 
FDebug
”” 
.
”” 
writeLog
”” 
(
””  
ex1
””  #
)
””# $
;
””$ %
}
•• 
finally
–– 
{
—— 
}
™™ 
}
šš 	
public
 
void
 
start
 
(
 
)
ŸŸ 
{
   	
FDebugLogArgs
¡¡ 
fLogArgs
¡¡ "
=
¡¡# $
null
¡¡% )
;
¡¡) *
try
££ 
{
¤¤ 
m_fMainSync
¥¥ 
.
¥¥ 
wait
¥¥  
(
¥¥  !
)
¥¥! "
;
¥¥" #
if
©© 
(
©© 
	m_started
©© 
)
©© 
{
ªª 
FDebug
«« 
.
«« 
throwFException
«« *
(
««* +
string
««+ 1
.
««1 2
Format
««2 8
(
««8 9

FConstants
««9 C
.
««C D

err_m_0001
««D N
,
««N O
$str
««P ]
)
««] ^
)
««^ _
;
««_ `
}
¬¬ 
fLogArgs
³³ 
=
³³ 
new
³³ 
FDebugLogArgs
³³ ,
(
³³, -
FDebugLogCategory
³³- >
.
³³> ?
Information
³³? J
,
³³J K
$str
³³L ]
,
³³] ^
this
³³_ c
.
³³c d
GetType
³³d k
(
³³k l
)
³³l m
,
³³m n
$str
³³o v
)
³³v w
;
³³w x
fLogArgs
´´ 
.
´´ 
additionInfo
´´ %
=
´´& '
$str
´´( 4
+
´´5 6

m_pipeName
´´7 A
+
´´B C
$str
´´D G
;
´´G H
FDebug
µµ 
.
µµ 
writeLog
µµ 
(
µµ  
fLogArgs
µµ  (
)
µµ( )
;
µµ) *
changeState
¹¹ 
(
¹¹ 

FPipeState
¹¹ &
.
¹¹& '
Opened
¹¹' -
)
¹¹- .
;
¹¹. /
	m_started
ºº 
=
ºº 
true
ºº  
;
ºº  !
}
»» 
catch
¼¼ 
(
¼¼ 
	Exception
¼¼ 
ex
¼¼ 
)
¼¼  
{
½½ 
FDebug
¾¾ 
.
¾¾ 
throwException
¾¾ %
(
¾¾% &
ex
¾¾& (
)
¾¾( )
;
¾¾) *
}
¿¿ 
finally
ÀÀ 
{
ÁÁ 
fLogArgs
ÂÂ 
=
ÂÂ 
null
ÂÂ 
;
ÂÂ  
m_fMainSync
ÃÃ 
.
ÃÃ 
set
ÃÃ 
(
ÃÃ  
)
ÃÃ  !
;
ÃÃ! "
}
ÄÄ 
}
ÅÅ 	
public
ÉÉ 
void
ÉÉ 
stop
ÉÉ 
(
ÉÉ 
)
ÊÊ 
{
ËË 	
FDebugLogArgs
ÌÌ 
fLogArgs
ÌÌ "
=
ÌÌ# $
null
ÌÌ% )
;
ÌÌ) *
try
ÎÎ 
{
ÏÏ 
m_fMainSync
ĞĞ 
.
ĞĞ 
wait
ĞĞ  
(
ĞĞ  !
)
ĞĞ! "
;
ĞĞ" #
if
ÔÔ 
(
ÔÔ 
!
ÔÔ 
	m_started
ÔÔ 
)
ÔÔ 
{
ÕÕ 
return
ÖÖ 
;
ÖÖ 
}
×× 
termPipeClient
ÛÛ 
(
ÛÛ 
)
ÛÛ  
;
ÛÛ  !
changeState
ÜÜ 
(
ÜÜ 

FPipeState
ÜÜ &
.
ÜÜ& '
Closed
ÜÜ' -
)
ÜÜ- .
;
ÜÜ. /
	m_started
İİ 
=
İİ 
false
İİ !
;
İİ! "
fLogArgs
ää 
=
ää 
new
ää 
FDebugLogArgs
ää ,
(
ää, -
FDebugLogCategory
ää- >
.
ää> ?
Information
ää? J
,
ääJ K
$str
ääL \
,
ää\ ]
this
ää^ b
.
ääb c
GetType
ääc j
(
ääj k
)
ääk l
,
ääl m
$str
ään t
)
äät u
;
ääu v
fLogArgs
åå 
.
åå 
additionInfo
åå %
=
åå& '
$str
åå( 4
+
åå5 6

m_pipeName
åå7 A
+
ååB C
$str
ååD G
;
ååG H
FDebug
ææ 
.
ææ 
writeLog
ææ 
(
ææ  
fLogArgs
ææ  (
)
ææ( )
;
ææ) *
}
çç 
catch
èè 
(
èè 
	Exception
èè 
ex
èè 
)
èè  
{
éé 
FDebug
êê 
.
êê 
throwException
êê %
(
êê% &
ex
êê& (
)
êê( )
;
êê) *
}
ëë 
finally
ìì 
{
íí 
fLogArgs
îî 
=
îî 
null
îî 
;
îî  
m_fMainSync
ïï 
.
ïï 
set
ïï 
(
ïï  
)
ïï  !
;
ïï! "
}
ğğ 
}
ññ 	
public
õõ 
void
õõ 
send
õõ 
(
õõ 
FPipeSendData
öö 
fData
öö 
)
÷÷ 
{
øø 	
try
ùù 
{
úú 
m_fMainSync
ûû 
.
ûû 
wait
ûû  
(
ûû  !
)
ûû! "
;
ûû" #
if
‚‚ 
(
‚‚ 
m_fState
‚‚ 
!=
‚‚ 

FPipeState
‚‚  *
.
‚‚* +
	Connected
‚‚+ 4
)
‚‚4 5
{
ƒƒ 
FDebug
„„ 
.
„„ 
throwFException
„„ *
(
„„* +
string
„„+ 1
.
„„1 2
Format
„„2 8
(
„„8 9

FConstants
„„9 C
.
„„C D

err_m_0012
„„D N
,
„„N O
$str
„„P W
)
„„W X
)
„„X Y
;
„„Y Z
}
…… 
doSend
‰‰ 
(
‰‰ 
fData
‰‰ 
)
‰‰ 
;
‰‰ 
}
ŠŠ 
catch
‹‹ 
(
‹‹ 
	Exception
‹‹ 
ex
‹‹ 
)
‹‹  
{
ŒŒ 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
 
{
 
m_fMainSync
‘‘ 
.
‘‘ 
set
‘‘ 
(
‘‘  
)
‘‘  !
;
‘‘! "
}
’’ 
}
““ 	
private
—— 
void
—— 
termPipeClient
—— #
(
——# $
)
˜˜ 
{
™™ 	
try
šš 
{
›› 
if
œœ 
(
œœ 
m_pipeClient
œœ  
==
œœ! #
null
œœ$ (
)
œœ( )
{
 
return
 
;
 
}
ŸŸ 
m_pipeClient
   
.
   
Close
   "
(
  " #
)
  # $
;
  $ %
m_fPipeFlag
§§ 
.
§§ 
waitAllCompleted
§§ ,
(
§§, -
)
§§- .
;
§§. /
m_pipeClient
«« 
=
«« 
null
«« #
;
««# $
}
¬¬ 
catch
­­ 
(
­­ 
	Exception
­­ 
ex
­­ 
)
­­  
{
®® 
FDebug
¯¯ 
.
¯¯ 
throwException
¯¯ %
(
¯¯% &
ex
¯¯& (
)
¯¯( )
;
¯¯) *
}
°° 
finally
±± 
{
²² 
}
´´ 
}
µµ 	
private
¹¹ 
void
¹¹ 
	doConnect
¹¹ 
(
¹¹ 
)
ºº 
{
»» 	
FDebugLogArgs
¼¼ 
fLogArgs
¼¼ "
=
¼¼# $
null
¼¼% )
;
¼¼) *
bool
½½ 
isReconnect
½½ 
=
½½ 
false
½½ $
;
½½$ %
try
¿¿ 
{
ÀÀ 
m_fPipeFlag
ÁÁ 
.
ÁÁ 
beginConnect
ÁÁ (
(
ÁÁ( )
)
ÁÁ) *
;
ÁÁ* +
if
ÅÅ 
(
ÅÅ 
m_pipeClient
ÅÅ  
==
ÅÅ! #
null
ÅÅ$ (
)
ÅÅ( )
{
ÆÆ 
m_pipeClient
ÇÇ  
=
ÇÇ! "
new
ÇÇ# &#
NamedPipeClientStream
ÇÇ' <
(
ÇÇ< =
$str
ÇÇ= @
,
ÇÇ@ A

m_pipeName
ÇÇB L
,
ÇÇL M
PipeDirection
ÇÇN [
.
ÇÇ[ \
InOut
ÇÇ\ a
,
ÇÇa b
PipeOptions
ÇÇc n
.
ÇÇn o
Asynchronous
ÇÇo {
)
ÇÇ{ |
;
ÇÇ| }
}
ÈÈ 
m_pipeClient
ÉÉ 
.
ÉÉ 
Connect
ÉÉ $
(
ÉÉ$ %
$num
ÉÉ% &
)
ÉÉ& '
;
ÉÉ' (
fLogArgs
ĞĞ 
=
ĞĞ 
new
ĞĞ 
FDebugLogArgs
ĞĞ ,
(
ĞĞ, -
FDebugLogCategory
ĞĞ- >
.
ĞĞ> ?
Information
ĞĞ? J
,
ĞĞJ K
$str
ĞĞL _
,
ĞĞ_ `
this
ĞĞa e
.
ĞĞe f
GetType
ĞĞf m
(
ĞĞm n
)
ĞĞn o
,
ĞĞo p
$str
ĞĞq |
)
ĞĞ| }
;
ĞĞ} ~
fLogArgs
ÑÑ 
.
ÑÑ 
additionInfo
ÑÑ %
=
ÑÑ& '
$str
ÑÑ( 4
+
ÑÑ5 6

m_pipeName
ÑÑ7 A
+
ÑÑB C
$str
ÑÑD G
;
ÑÑG H
FDebug
ÒÒ 
.
ÒÒ 
writeLog
ÒÒ 
(
ÒÒ  
fLogArgs
ÒÒ  (
)
ÒÒ( )
;
ÒÒ) *
changeState
ÖÖ 
(
ÖÖ 

FPipeState
ÖÖ &
.
ÖÖ& '
	Connected
ÖÖ' 0
)
ÖÖ0 1
;
ÖÖ1 2
}
×× 
catch
ØØ 
(
ØØ 
	Exception
ØØ 
ex
ØØ 
)
ØØ  
{
ÙÙ 
if
ÚÚ 
(
ÚÚ 
ex
ÚÚ 
is
ÚÚ 
TimeoutException
ÚÚ *
)
ÚÚ* +
{
ÛÛ "
m_fRetryConnectTimer
ÜÜ (
.
ÜÜ( )
start
ÜÜ) .
(
ÜÜ. /"
m_retryConnectPeriod
ÜÜ/ C
)
ÜÜC D
;
ÜÜD E
}
İİ 
else
ŞŞ 
{
ßß 
pushErrorEvent
àà "
(
àà" #
ex
àà# %
)
àà% &
;
àà& '
isReconnect
áá 
=
áá  !
true
áá" &
;
áá& '
}
ââ 
}
ãã 
finally
ää 
{
åå 
m_fPipeFlag
ææ 
.
ææ 

endConnect
ææ &
(
ææ& '
)
ææ' (
;
ææ( )
if
êê 
(
êê 
isReconnect
êê 
)
êê  
{
ëë 
doReconnect
ìì 
(
ìì  
)
ìì  !
;
ìì! "
}
íí 
}
îî 
}
ïï 	
private
óó 
void
óó 
doDisconnect
óó !
(
óó! "
)
ôô 
{
õõ 	
FDebugLogArgs
öö 
fLogArgs
öö "
=
öö# $
null
öö% )
;
öö) *
try
øø 
{
ùù 
m_fDisconnectSync
úú !
.
úú! "
wait
úú" &
(
úú& '
)
úú' (
;
úú( )
if
şş 
(
şş 
m_fPipeFlag
şş 
.
şş  
disconnected
şş  ,
)
şş, -
{
ÿÿ 
return
€€ 
;
€€ 
}
 
fLogArgs
ˆˆ 
=
ˆˆ 
new
ˆˆ 
FDebugLogArgs
ˆˆ ,
(
ˆˆ, -
FDebugLogCategory
ˆˆ- >
.
ˆˆ> ?
Information
ˆˆ? J
,
ˆˆJ K
$str
ˆˆL b
,
ˆˆb c
this
ˆˆd h
.
ˆˆh i
GetType
ˆˆi p
(
ˆˆp q
)
ˆˆq r
,
ˆˆr s
$strˆˆt ‚
)ˆˆ‚ ƒ
;ˆˆƒ „
fLogArgs
‰‰ 
.
‰‰ 
additionInfo
‰‰ %
=
‰‰& '
$str
‰‰( 4
+
‰‰5 6

m_pipeName
‰‰7 A
+
‰‰B C
$str
‰‰D G
;
‰‰G H
FDebug
ŠŠ 
.
ŠŠ 
writeLog
ŠŠ 
(
ŠŠ  
fLogArgs
ŠŠ  (
)
ŠŠ( )
;
ŠŠ) *
m_fPipeFlag
 
.
 
disconnected
 (
=
) *
true
+ /
;
/ 0
}
 
catch
 
(
 
	Exception
 
ex
 
)
  
{
‘‘ 
pushErrorEvent
’’ 
(
’’ 
ex
’’ !
)
’’! "
;
’’" #
}
““ 
finally
”” 
{
•• 
m_fDisconnectSync
–– !
.
––! "
set
––" %
(
––% &
)
––& '
;
––' (
}
—— 
}
˜˜ 	
private
œœ 
void
œœ 
doReconnect
œœ  
(
œœ  !
)
 
{
 	
try
ŸŸ 
{
   "
m_fRetryConnectTimer
¤¤ $
.
¤¤$ %
start
¤¤% *
(
¤¤* +"
m_retryConnectPeriod
¤¤+ ?
)
¤¤? @
;
¤¤@ A
termPipeClient
¨¨ 
(
¨¨ 
)
¨¨  
;
¨¨  !
m_fPipeFlag
¬¬ 
.
¬¬ 
init
¬¬  
(
¬¬  !
)
¬¬! "
;
¬¬" #
changeState
­­ 
(
­­ 

FPipeState
­­ &
.
­­& '
Opened
­­' -
)
­­- .
;
­­. /
}
®® 
catch
¯¯ 
(
¯¯ 
	Exception
¯¯ 
ex
¯¯ 
)
¯¯  
{
°° 
FDebug
±± 
.
±± 
throwException
±± %
(
±±% &
ex
±±& (
)
±±( )
;
±±) *
}
²² 
finally
³³ 
{
´´ 
}
¶¶ 
}
·· 	
private
»» 
void
»» 
	doReceive
»» 
(
»» 
)
¼¼ 
{
½½ 	
try
¾¾ 
{
¿¿ 
m_fPipeFlag
ÀÀ 
.
ÀÀ 
beginReceive
ÀÀ (
(
ÀÀ( )
)
ÀÀ) *
;
ÀÀ* +
m_pipeClient
ÁÁ 
.
ÁÁ 
	BeginRead
ÁÁ &
(
ÁÁ& '
	m_recvBuf
ÁÁ' 0
,
ÁÁ0 1
$num
ÁÁ2 3
,
ÁÁ3 4
	m_recvBuf
ÁÁ5 >
.
ÁÁ> ?
Length
ÁÁ? E
,
ÁÁE F
new
ÁÁG J
AsyncCallback
ÁÁK X
(
ÁÁX Y
doReceiveCallback
ÁÁY j
)
ÁÁj k
,
ÁÁk l
this
ÁÁm q
)
ÁÁq r
;
ÁÁr s
}
ÂÂ 
catch
ÃÃ 
(
ÃÃ 
	Exception
ÃÃ 
ex
ÃÃ 
)
ÃÃ  
{
ÄÄ 
if
ÅÅ 
(
ÅÅ 
ex
ÅÅ 
is
ÅÅ 
IOException
ÅÅ %
)
ÅÅ% &
{
ÆÆ 
pushErrorEvent
ÇÇ "
(
ÇÇ" #
ex
ÇÇ# %
)
ÇÇ% &
;
ÇÇ& '
doDisconnect
ÎÎ  
(
ÎÎ  !
)
ÎÎ! "
;
ÎÎ" #
}
ÏÏ 
else
ĞĞ 
if
ĞĞ 
(
ĞĞ 
ex
ĞĞ 
is
ĞĞ %
ObjectDisposedException
ĞĞ 6
)
ĞĞ6 7
{
ÑÑ 
System
ÒÒ 
.
ÒÒ 
Diagnostics
ÒÒ &
.
ÒÒ& '
Debug
ÒÒ' ,
.
ÒÒ, -
	WriteLine
ÒÒ- 6
(
ÒÒ6 7
ex
ÒÒ7 9
)
ÒÒ9 :
;
ÒÒ: ;
}
ÓÓ 
else
ÔÔ 
{
ÕÕ 
pushErrorEvent
ÖÖ "
(
ÖÖ" #
ex
ÖÖ# %
)
ÖÖ% &
;
ÖÖ& '
}
×× 
m_fPipeFlag
ØØ 
.
ØØ 

endReceive
ØØ &
(
ØØ& '
)
ØØ' (
;
ØØ( )
}
ÙÙ 
finally
ÚÚ 
{
ÛÛ 
}
İİ 
}
ŞŞ 	
private
ââ 
void
ââ 
doSend
ââ 
(
ââ 
FPipeSendData
ãã 
fData
ãã 
)
ää 
{
åå 	
try
ææ 
{
çç 
m_fPipeFlag
èè 
.
èè 
	beginSend
èè %
(
èè% &
)
èè& '
;
èè' (
m_pipeClient
éé 
.
éé 

BeginWrite
éé '
(
éé' (
fData
éé( -
.
éé- .
data
éé. 2
,
éé2 3
$num
éé4 5
,
éé5 6
fData
éé7 <
.
éé< =
data
éé= A
.
ééA B
Length
ééB H
,
ééH I
new
ééJ M
AsyncCallback
ééN [
(
éé[ \
doSendCallback
éé\ j
)
ééj k
,
éék l
fData
éém r
)
éér s
;
éés t
}
êê 
catch
ëë 
(
ëë 
	Exception
ëë 
ex
ëë 
)
ëë  
{
ìì 
if
íí 
(
íí 
ex
íí 
is
íí 
IOException
íí %
)
íí% &
{
îî 
pushErrorEvent
ïï "
(
ïï" #
ex
ïï# %
)
ïï% &
;
ïï& '%
pushDataSendFailedEvent
ğğ +
(
ğğ+ ,
fData
ğğ, 1
,
ğğ1 2
ex
ğğ3 5
.
ğğ5 6
Message
ğğ6 =
)
ğğ= >
;
ğğ> ?
doDisconnect
÷÷  
(
÷÷  !
)
÷÷! "
;
÷÷" #
}
øø 
else
ùù 
if
ùù 
(
ùù 
ex
ùù 
is
ùù %
ObjectDisposedException
ùù 6
)
ùù6 7
{
úú 
System
ûû 
.
ûû 
Diagnostics
ûû &
.
ûû& '
Debug
ûû' ,
.
ûû, -
	WriteLine
ûû- 6
(
ûû6 7
ex
ûû7 9
)
ûû9 :
;
ûû: ;
}
üü 
else
ıı 
{
şş 
pushErrorEvent
ÿÿ "
(
ÿÿ" #
ex
ÿÿ# %
)
ÿÿ% &
;
ÿÿ& '%
pushDataSendFailedEvent
€€ +
(
€€+ ,
fData
€€, 1
,
€€1 2
ex
€€3 5
.
€€5 6
Message
€€6 =
)
€€= >
;
€€> ?
}
 
m_fPipeFlag
‚‚ 
.
‚‚ 
endSend
‚‚ #
(
‚‚# $
)
‚‚$ %
;
‚‚% &
}
ƒƒ 
finally
„„ 
{
…… 
}
‡‡ 
}
ˆˆ 	
private
ŒŒ 
void
ŒŒ 
doReceiveCallback
ŒŒ &
(
ŒŒ& '
IAsyncResult
 
ar
 
)
 
{
 	
int
 
length
 
=
 
$num
 
;
 
byte
‘‘ 
[
‘‘ 
]
‘‘ 
data
‘‘ 
=
‘‘ 
null
‘‘ 
;
‘‘ 
try
““ 
{
”” 
length
•• 
=
•• 
m_pipeClient
•• %
.
••% &
EndRead
••& -
(
••- .
ar
••. 0
)
••0 1
;
••1 2
if
–– 
(
–– 
length
–– 
==
–– 
$num
–– 
)
––  
{
—— 
doDisconnect
˜˜  
(
˜˜  !
)
˜˜! "
;
˜˜" #
return
™™ 
;
™™ 
}
šš 
data
 
=
 
new
 
byte
 
[
  
length
  &
]
& '
;
' (
Buffer
ŸŸ 
.
ŸŸ 
	BlockCopy
ŸŸ  
(
ŸŸ  !
	m_recvBuf
ŸŸ! *
,
ŸŸ* +
$num
ŸŸ, -
,
ŸŸ- .
data
ŸŸ/ 3
,
ŸŸ3 4
$num
ŸŸ5 6
,
ŸŸ6 7
length
ŸŸ8 >
)
ŸŸ> ?
;
ŸŸ? @
m_fEventPusher
   
.
   
	pushEvent
   (
(
  ( )
new
  ) ,(
FPipeDataReceivedEventArgs
  - G
(
  G H
this
  H L
,
  L M
data
  N R
)
  R S
)
  S T
;
  T U
}
¡¡ 
catch
¢¢ 
(
¢¢ 
	Exception
¢¢ 
ex
¢¢ 
)
¢¢  
{
££ 
if
¤¤ 
(
¤¤ 
ex
¤¤ 
is
¤¤ 
IOException
¤¤ %
)
¤¤% &
{
¥¥ 
pushErrorEvent
¦¦ "
(
¦¦" #
ex
¦¦# %
)
¦¦% &
;
¦¦& '
doDisconnect
­­  
(
­­  !
)
­­! "
;
­­" #
}
®® 
else
¯¯ 
if
¯¯ 
(
¯¯ 
ex
¯¯ 
is
¯¯ %
ObjectDisposedException
¯¯ 6
)
¯¯6 7
{
°° 
System
±± 
.
±± 
Diagnostics
±± &
.
±±& '
Debug
±±' ,
.
±±, -
	WriteLine
±±- 6
(
±±6 7
ex
±±7 9
)
±±9 :
;
±±: ;
}
²² 
else
³³ 
{
´´ 
pushErrorEvent
µµ "
(
µµ" #
ex
µµ# %
)
µµ% &
;
µµ& '
}
¶¶ 
}
·· 
finally
¸¸ 
{
¹¹ 
m_fPipeFlag
ºº 
.
ºº 

endReceive
ºº &
(
ºº& '
)
ºº' (
;
ºº( )
}
»» 
}
¼¼ 	
private
ÀÀ 
void
ÀÀ 
doSendCallback
ÀÀ #
(
ÀÀ# $
IAsyncResult
ÁÁ 
ar
ÁÁ 
)
ÂÂ 
{
ÃÃ 	
FPipeSendData
ÄÄ 
fData
ÄÄ 
=
ÄÄ  !
null
ÄÄ" &
;
ÄÄ& '
try
ÆÆ 
{
ÇÇ 
fData
ÈÈ 
=
ÈÈ 
(
ÈÈ 
FPipeSendData
ÈÈ &
)
ÈÈ& '
ar
ÈÈ' )
.
ÈÈ) *

AsyncState
ÈÈ* 4
;
ÈÈ4 5
m_pipeClient
ÉÉ 
.
ÉÉ 
EndWrite
ÉÉ %
(
ÉÉ% &
ar
ÉÉ& (
)
ÉÉ( )
;
ÉÉ) *
m_fEventPusher
ÊÊ 
.
ÊÊ 
	pushEvent
ÊÊ (
(
ÊÊ( )
new
ÊÊ) ,$
FPipeDataSentEventArgs
ÊÊ- C
(
ÊÊC D
this
ÊÊD H
,
ÊÊH I
fData
ÊÊJ O
)
ÊÊO P
)
ÊÊP Q
;
ÊÊQ R
}
ËË 
catch
ÌÌ 
(
ÌÌ 
	Exception
ÌÌ 
ex
ÌÌ 
)
ÌÌ  
{
ÍÍ 
if
ÎÎ 
(
ÎÎ 
ex
ÎÎ 
is
ÎÎ 
IOException
ÎÎ %
)
ÎÎ% &
{
ÏÏ 
pushErrorEvent
ĞĞ "
(
ĞĞ" #
ex
ĞĞ# %
)
ĞĞ% &
;
ĞĞ& '%
pushDataSendFailedEvent
ÑÑ +
(
ÑÑ+ ,
fData
ÑÑ, 1
,
ÑÑ1 2
ex
ÑÑ3 5
.
ÑÑ5 6
Message
ÑÑ6 =
)
ÑÑ= >
;
ÑÑ> ?
doDisconnect
ØØ  
(
ØØ  !
)
ØØ! "
;
ØØ" #
}
ÙÙ 
else
ÚÚ 
if
ÚÚ 
(
ÚÚ 
ex
ÚÚ 
is
ÚÚ %
ObjectDisposedException
ÚÚ 6
)
ÚÚ6 7
{
ÛÛ 
System
ÜÜ 
.
ÜÜ 
Diagnostics
ÜÜ &
.
ÜÜ& '
Debug
ÜÜ' ,
.
ÜÜ, -
	WriteLine
ÜÜ- 6
(
ÜÜ6 7
ex
ÜÜ7 9
.
ÜÜ9 :
ToString
ÜÜ: B
(
ÜÜB C
)
ÜÜC D
)
ÜÜD E
;
ÜÜE F
}
İİ 
else
ŞŞ 
{
ßß 
pushErrorEvent
àà "
(
àà" #
ex
àà# %
)
àà% &
;
àà& '%
pushDataSendFailedEvent
áá +
(
áá+ ,
fData
áá, 1
,
áá1 2
ex
áá3 5
.
áá5 6
Message
áá6 =
)
áá= >
;
áá> ?
}
ââ 
}
ãã 
finally
ää 
{
åå 
m_fPipeFlag
ææ 
.
ææ 
endSend
ææ #
(
ææ# $
)
ææ$ %
;
ææ% &
}
çç 
}
èè 	
internal
ìì 
void
ìì  
onPipeStateChanged
ìì (
(
ìì( ) 
FPipeEventArgsBase
íí 
args
íí #
)
îî 
{
ïï 	
try
ğğ 
{
ññ 
if
òò 
(
òò 
PipeStateChanged
òò $
!=
òò% '
null
òò( ,
)
òò, -
{
óó 
PipeStateChanged
ôô $
(
ôô$ %
this
ôô% )
,
ôô) *
(
ôô+ ,(
FPipeStateChangedEventArgs
ôô, F
)
ôôF G
args
ôôG K
)
ôôK L
;
ôôL M
}
õõ 
}
öö 
catch
÷÷ 
(
÷÷ 
	Exception
÷÷ 
ex
÷÷ 
)
÷÷  
{
øø 
FDebug
ùù 
.
ùù 
writeLog
ùù 
(
ùù  
ex
ùù  "
)
ùù" #
;
ùù# $
}
úú 
finally
ûû 
{
üü 
}
şş 
}
ÿÿ 	
internal
ƒƒ 
void
ƒƒ  
onPipeDataReceived
ƒƒ (
(
ƒƒ( ) 
FPipeEventArgsBase
„„ 
args
„„ #
)
…… 
{
†† 	
try
‡‡ 
{
ˆˆ 
if
‰‰ 
(
‰‰ 
PipeDataReceived
‰‰ $
!=
‰‰% '
null
‰‰( ,
)
‰‰, -
{
ŠŠ 
PipeDataReceived
‹‹ $
(
‹‹$ %
this
‹‹% )
,
‹‹) *
(
‹‹+ ,(
FPipeDataReceivedEventArgs
‹‹, F
)
‹‹F G
args
‹‹G K
)
‹‹K L
;
‹‹L M
}
ŒŒ 
}
 
catch
 
(
 
	Exception
 
ex
 
)
  
{
 
FDebug
 
.
 
writeLog
 
(
  
ex
  "
)
" #
;
# $
}
‘‘ 
finally
’’ 
{
““ 
}
•• 
}
–– 	
internal
šš 
void
šš 
onPipeDataSent
šš $
(
šš$ % 
FPipeEventArgsBase
›› 
args
›› #
)
œœ 
{
 	
try
 
{
ŸŸ 
if
   
(
   
PipeDataSent
    
!=
  ! #
null
  $ (
)
  ( )
{
¡¡ 
PipeDataSent
¢¢  
(
¢¢  !
this
¢¢! %
,
¢¢% &
(
¢¢' ($
FPipeDataSentEventArgs
¢¢( >
)
¢¢> ?
args
¢¢? C
)
¢¢C D
;
¢¢D E
}
££ 
}
¤¤ 
catch
¥¥ 
(
¥¥ 
	Exception
¥¥ 
ex
¥¥ 
)
¥¥  
{
¦¦ 
FDebug
§§ 
.
§§ 
writeLog
§§ 
(
§§  
ex
§§  "
)
§§" #
;
§§# $
}
¨¨ 
finally
©© 
{
ªª 
}
¬¬ 
}
­­ 	
internal
±± 
void
±± "
onPipeDataSendFailed
±± *
(
±±* + 
FPipeEventArgsBase
²² 
args
²² #
)
³³ 
{
´´ 	
try
µµ 
{
¶¶ 
if
·· 
(
··  
PipeDataSendFailed
·· &
!=
··' )
null
··* .
)
··. /
{
¸¸  
PipeDataSendFailed
¹¹ &
(
¹¹& '
this
¹¹' +
,
¹¹+ ,
(
¹¹- .*
FPipeDataSendFailedEventArgs
¹¹. J
)
¹¹J K
args
¹¹K O
)
¹¹O P
;
¹¹P Q
}
ºº 
}
»» 
catch
¼¼ 
(
¼¼ 
	Exception
¼¼ 
ex
¼¼ 
)
¼¼  
{
½½ 
FDebug
¾¾ 
.
¾¾ 
writeLog
¾¾ 
(
¾¾  
ex
¾¾  "
)
¾¾" #
;
¾¾# $
}
¿¿ 
finally
ÀÀ 
{
ÁÁ 
}
ÃÃ 
}
ÄÄ 	
internal
ÈÈ 
void
ÈÈ 
onPipeErrorRaised
ÈÈ '
(
ÈÈ' ( 
FPipeEventArgsBase
ÉÉ 
args
ÉÉ #
)
ÊÊ 
{
ËË 	
try
ÌÌ 
{
ÍÍ 
if
ÎÎ 
(
ÎÎ 
PipeErrorRaised
ÎÎ #
!=
ÎÎ$ &
null
ÎÎ' +
)
ÎÎ+ ,
{
ÏÏ 
PipeErrorRaised
ĞĞ #
(
ĞĞ# $
this
ĞĞ$ (
,
ĞĞ( )
(
ĞĞ* +'
FPipeErrorRaisedEventArgs
ĞĞ+ D
)
ĞĞD E
args
ĞĞE I
)
ĞĞI J
;
ĞĞJ K
}
ÑÑ 
}
ÒÒ 
catch
ÓÓ 
(
ÓÓ 
	Exception
ÓÓ 
ex
ÓÓ 
)
ÓÓ  
{
ÔÔ 
FDebug
ÕÕ 
.
ÕÕ 
writeLog
ÕÕ 
(
ÕÕ  
ex
ÕÕ  "
)
ÕÕ" #
;
ÕÕ# $
}
ÖÖ 
finally
×× 
{
ØØ 
}
ÚÚ 
}
ÛÛ 	
private
ãã 
void
ãã (
m_fThdMain_ThreadJobCalled
ãã /
(
ãã/ 0
object
ää 
sender
ää 
,
ää 
FThreadEventArgs
åå 
e
åå 
)
ææ 
{
çç 	
bool
èè 
waited
èè 
=
èè 
false
èè 
;
èè  
try
êê 
{
ëë 
waited
ìì 
=
ìì 
m_fMainSync
ìì $
.
ìì$ %
tryWait
ìì% ,
(
ìì, -
$num
ìì- .
)
ìì. /
;
ìì/ 0
if
íí 
(
íí 
!
íí 
waited
íí 
)
íí 
{
îî 
return
ïï 
;
ïï 
}
ğğ 
if
ôô 
(
ôô 
m_fState
ôô 
==
ôô 

FPipeState
ôô  *
.
ôô* +
Opened
ôô+ 1
)
ôô1 2
{
õõ 
if
öö 
(
öö 
!
öö "
m_fRetryConnectTimer
öö -
.
öö- .
enabled
öö. 5
||
öö6 8"
m_fRetryConnectTimer
öö9 M
.
ööM N
elasped
ööN U
(
ööU V
false
ööV [
)
öö[ \
)
öö\ ]
{
÷÷ 
if
øø 
(
øø 
m_fPipeFlag
øø '
.
øø' ( 
doConnectCompleted
øø( :
)
øø: ;
{
ùù 
	doConnect
úú %
(
úú% &
)
úú& '
;
úú' (
return
ûû "
;
ûû" #
}
üü 
}
ıı 
}
şş 
else
ÿÿ 
if
ÿÿ 
(
ÿÿ 
m_fState
ÿÿ !
==
ÿÿ" $

FPipeState
ÿÿ% /
.
ÿÿ/ 0
	Connected
ÿÿ0 9
)
ÿÿ9 :
{
€€ 
if
 
(
 
m_fPipeFlag
 #
.
# $
disconnected
$ 0
)
0 1
{
‚‚ 
doReconnect
ƒƒ #
(
ƒƒ# $
)
ƒƒ$ %
;
ƒƒ% &
return
„„ 
;
„„ 
}
…… 
if
‰‰ 
(
‰‰ 
m_fPipeFlag
‰‰ #
.
‰‰# $ 
doReceiveCompleted
‰‰$ 6
)
‰‰6 7
{
ŠŠ 
	doReceive
‹‹ !
(
‹‹! "
)
‹‹" #
;
‹‹# $
return
ŒŒ 
;
ŒŒ 
}
 
}
 
else
 
if
 
(
 
m_fState
 !
==
" $

FPipeState
% /
.
/ 0
Closed
0 6
)
6 7
{
 
}
’’ 
e
–– 
.
–– 
sleepThread
–– 
(
–– 
$num
–– 
)
––  
;
––  !
}
—— 
catch
˜˜ 
(
˜˜ 
	Exception
˜˜ 
ex
˜˜ 
)
˜˜  
{
™™ 
pushErrorEvent
šš 
(
šš 
ex
šš !
)
šš! "
;
šš" #
}
›› 
finally
œœ 
{
 
if
 
(
 
waited
 
)
 
{
ŸŸ 
m_fMainSync
   
.
    
set
    #
(
  # $
)
  $ %
;
  % &
}
¡¡ 
}
¢¢ 
}
££ 	
}
©© 
}ªª ‹ƒ
ZD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Pipe\c_FPipeServer.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FPipeServer 
: 
FIPipe %
,% &
IDisposable' 2
{ 
public 
event )
FPipeStateChangedEventHandler 2
PipeStateChanged3 C
=D E
nullF J
;J K
public 
event )
FPipeDataReceivedEventHandler 2
PipeDataReceived3 C
=D E
nullF J
;J K
public 
event %
FPipeDataSentEventHandler .
PipeDataSent/ ;
=< =
null> B
;B C
public 
event +
FPipeDataSendFailedEventHandler 4
PipeDataSendFailed5 G
=H I
nullJ N
;N O
public   
event   (
FPipeErrorRaisedEventHandler   1
PipeErrorRaised  2 A
=  B C
null  D H
;  H I
private"" 
const"" 
int"" 
RecvBufferSize"" (
="") *
$num""+ 0
;""0 1
private## 
const## 
int## 
SendBufferSize## (
=##) *
$num##+ 0
;##0 1
private%% 
bool%% 

m_disposed%% 
=%%  !
false%%" '
;%%' (
private'' 
string'' 

m_pipeName'' !
=''" #
$str''$ 0
;''0 1
private(( 
int((  
m_retryConnectPeriod(( (
=(() *
$num((+ /
;((/ 0
private)) 

FPipeState)) 
m_fState)) #
=))$ %

FPipeState))& 0
.))0 1
Closed))1 7
;))7 8
private** 
bool** 
	m_started** 
=**  
false**! &
;**& '
private,, !
NamedPipeServerStream,, %
m_pipeServer,,& 2
=,,3 4
null,,5 9
;,,9 :
private-- 
	FPipeFlag-- 
m_fPipeFlag-- %
=--& '
null--( ,
;--, -
private.. 
byte.. 
[.. 
].. 
	m_recvBuf..  
=..! "
null..# '
;..' (
private// 
FStaticTimer//  
m_fRetryConnectTimer// 1
=//2 3
null//4 8
;//8 9
private11 
	FCodeLock11 
m_fMainSync11 %
=11& '
null11( ,
;11, -
private22 
	FCodeLock22 
m_fDisconnectSync22 +
=22, -
null22. 2
;222 3
private33 
FPipeEventPusher33  
m_fEventPusher33! /
=330 1
null332 6
;336 7
private44 
FThread44 

m_fThdMain44 "
=44# $
null44% )
;44) *
public:: 
FPipeServer:: 
(:: 
string;; 
pipeName;; 
)<< 
{== 	

m_pipeName>> 
=>> 
pipeName>> !
;>>! "
init?? 
(?? 
)?? 
;?? 
}@@ 	
~DD 	
FPipeServerDD	 
(DD 
)EE 
{FF 	
	myDisposeGG 
(GG 
falseGG 
)GG 
;GG 
}HH 	
	protectedLL 
voidLL 
	myDisposeLL  
(LL  !
boolMM 
	disposingMM 
)NN 
{OO 	
ifPP 
(PP 
!PP 

m_disposedPP 
)PP 
{QQ 
ifRR 
(RR 
	disposingRR 
)RR 
{SS 
termTT 
(TT 
)TT 
;TT 
}UU 

m_disposedVV 
=VV 
trueVV !
;VV! "
}WW 
}XX 	
public`` 
void`` 
Dispose`` 
(`` 
)aa 
{bb 	
	myDisposecc 
(cc 
truecc 
)cc 
;cc 
GCdd 
.dd 
SuppressFinalizedd 
(dd  
thisdd  $
)dd$ %
;dd% &
}ee 	
publicmm 
	FPipeTypemm 
	fPipeTypemm "
{nn 	
getoo 
{pp 
tryqq 
{rr 
returnss 
	FPipeTypess $
.ss$ %
Serverss% +
;ss+ ,
}tt 
catchuu 
(uu 
	Exceptionuu  
exuu! #
)uu# $
{vv 
FDebugww 
.ww 
throwExceptionww )
(ww) *
exww* ,
)ww, -
;ww- .
}xx 
finallyyy 
{zz 
}|| 
return}} 
	FPipeType}}  
.}}  !
Server}}! '
;}}' (
}~~ 
} 	
public
ƒƒ 
string
ƒƒ 
pipeName
ƒƒ 
{
„„ 	
get
…… 
{
†† 
try
‡‡ 
{
ˆˆ 
return
‰‰ 

m_pipeName
‰‰ %
;
‰‰% &
}
ŠŠ 
catch
‹‹ 
(
‹‹ 
	Exception
‹‹  
ex
‹‹! #
)
‹‹# $
{
ŒŒ 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
 
{
 
}
’’ 
return
““ 
string
““ 
.
““ 
Empty
““ #
;
““# $
}
”” 
}
•• 	
public
™™ 
bool
™™ 
started
™™ 
{
šš 	
get
›› 
{
œœ 
try
 
{
 
return
ŸŸ 
	m_started
ŸŸ $
;
ŸŸ$ %
}
   
catch
¡¡ 
(
¡¡ 
	Exception
¡¡  
ex
¡¡! #
)
¡¡# $
{
¢¢ 
FDebug
££ 
.
££ 
throwException
££ )
(
££) *
ex
££* ,
)
££, -
;
££- .
}
¤¤ 
finally
¥¥ 
{
¦¦ 
}
¨¨ 
return
©© 
false
©© 
;
©© 
}
ªª 
}
«« 	
public
¯¯ 
int
¯¯  
retryConnectPeriod
¯¯ %
{
°° 	
get
±± 
{
²² 
try
³³ 
{
´´ 
return
¸¸ "
m_retryConnectPeriod
¸¸ /
;
¸¸/ 0
}
¹¹ 
catch
ºº 
(
ºº 
	Exception
ºº  
ex
ºº! #
)
ºº# $
{
»» 
FDebug
¼¼ 
.
¼¼ 
throwException
¼¼ )
(
¼¼) *
ex
¼¼* ,
)
¼¼, -
;
¼¼- .
}
½½ 
finally
¾¾ 
{
¿¿ 
}
ÁÁ 
return
ÂÂ 
$num
ÂÂ 
;
ÂÂ 
}
ÃÃ 
set
ÅÅ 
{
ÆÆ 
try
ÇÇ 
{
ÈÈ 
if
ÉÉ 
(
ÉÉ 
value
ÉÉ 
<
ÉÉ 
$num
ÉÉ  !
)
ÉÉ! "
{
ÊÊ 
FDebug
ËË 
.
ËË 
throwFException
ËË .
(
ËË. /
string
ËË/ 5
.
ËË5 6
Format
ËË6 <
(
ËË< =

FConstants
ËË= G
.
ËËG H

err_m_0005
ËËH R
,
ËËR S
$str
ËËT j
)
ËËj k
)
ËËk l
;
ËËl m
}
ÌÌ "
m_retryConnectPeriod
ÓÓ (
=
ÓÓ) *
value
ÓÓ+ 0
;
ÓÓ0 1
}
ÔÔ 
catch
ÕÕ 
(
ÕÕ 
	Exception
ÕÕ  
ex
ÕÕ! #
)
ÕÕ# $
{
ÖÖ 
FDebug
×× 
.
×× 
throwException
×× )
(
××) *
ex
××* ,
)
××, -
;
××- .
}
ØØ 
finally
ÙÙ 
{
ÚÚ 
}
ÜÜ 
}
İİ 
}
ŞŞ 	
public
ââ 

FPipeState
ââ 
fState
ââ  
{
ãã 	
get
ää 
{
åå 
try
ææ 
{
çç 
return
èè 
m_fState
èè #
;
èè# $
}
éé 
catch
êê 
(
êê 
	Exception
êê  
ex
êê! #
)
êê# $
{
ëë 
FDebug
ìì 
.
ìì 
throwException
ìì )
(
ìì) *
ex
ìì* ,
)
ìì, -
;
ìì- .
}
íí 
finally
îî 
{
ïï 
}
ññ 
return
òò 

FPipeState
òò !
.
òò! "
Closed
òò" (
;
òò( )
}
óó 
}
ôô 	
private
üü 
void
üü 
init
üü 
(
üü 
)
ıı 
{
şş 	
try
ÿÿ 
{
€€ 
m_fMainSync
 
=
 
new
 !
	FCodeLock
" +
(
+ ,
)
, -
;
- .
m_fDisconnectSync
‚‚ !
=
‚‚" #
new
‚‚$ '
	FCodeLock
‚‚( 1
(
‚‚1 2
)
‚‚2 3
;
‚‚3 4
m_fPipeFlag
ƒƒ 
=
ƒƒ 
new
ƒƒ !
	FPipeFlag
ƒƒ" +
(
ƒƒ+ ,
)
ƒƒ, -
;
ƒƒ- ."
m_fRetryConnectTimer
„„ $
=
„„% &
new
„„' *
FStaticTimer
„„+ 7
(
„„7 8
)
„„8 9
;
„„9 :
	m_recvBuf
…… 
=
…… 
new
…… 
byte
……  $
[
……$ %
RecvBufferSize
……% 3
]
……3 4
;
……4 5
m_fEventPusher
‡‡ 
=
‡‡  
new
‡‡! $
FPipeEventPusher
‡‡% 5
(
‡‡5 6
this
‡‡6 :
)
‡‡: ;
;
‡‡; <

m_fThdMain
‰‰ 
=
‰‰ 
new
‰‰  
FThread
‰‰! (
(
‰‰( )
$str
‰‰) @
)
‰‰@ A
;
‰‰A B

m_fThdMain
ŠŠ 
.
ŠŠ 
ThreadJobCalled
ŠŠ *
+=
ŠŠ+ -
new
ŠŠ. 1*
FThreadJobCalledEventHandler
ŠŠ2 N
(
ŠŠN O(
m_fThdMain_ThreadJobCalled
ŠŠO i
)
ŠŠi j
;
ŠŠj k

m_fThdMain
‹‹ 
.
‹‹ 
start
‹‹  
(
‹‹  !
)
‹‹! "
;
‹‹" #
}
ŒŒ 
catch
 
(
 
	Exception
 
ex
 
)
  
{
 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
‘‘ 
{
’’ 
}
”” 
}
•• 	
private
™™ 
void
™™ 
term
™™ 
(
™™ 
)
šš 
{
›› 	
try
œœ 
{
 
if
 
(
 

m_fThdMain
 
!=
 !
null
" &
)
& '
{
ŸŸ 

m_fThdMain
   
.
   
stop
   #
(
  # $
)
  $ %
;
  % &

m_fThdMain
¡¡ 
.
¡¡ 
Dispose
¡¡ &
(
¡¡& '
)
¡¡' (
;
¡¡( )

m_fThdMain
¢¢ 
.
¢¢ 
ThreadJobCalled
¢¢ .
-=
¢¢/ 1
new
¢¢2 5*
FThreadJobCalledEventHandler
¢¢6 R
(
¢¢R S(
m_fThdMain_ThreadJobCalled
¢¢S m
)
¢¢m n
;
¢¢n o

m_fThdMain
££ 
=
££  
null
££! %
;
££% &
}
¤¤ 
stop
¥¥ 
(
¥¥ 
)
¥¥ 
;
¥¥ 
if
©© 
(
©© 
m_fEventPusher
©© "
!=
©©# %
null
©©& *
)
©©* +
{
ªª 
m_fEventPusher
«« "
.
««" #(
waitEventHandlingCompleted
««# =
(
««= >
)
««> ?
;
««? @
m_fEventPusher
¬¬ "
.
¬¬" #
Dispose
¬¬# *
(
¬¬* +
)
¬¬+ ,
;
¬¬, -
m_fEventPusher
­­ "
=
­­# $
null
­­% )
;
­­) *
}
®® 
if
²² 
(
²² 
m_fPipeFlag
²² 
!=
²²  "
null
²²# '
)
²²' (
{
³³ 
m_fPipeFlag
´´ 
.
´´  
Dispose
´´  '
(
´´' (
)
´´( )
;
´´) *
m_fPipeFlag
µµ 
=
µµ  !
null
µµ" &
;
µµ& '
}
¶¶ 
if
¸¸ 
(
¸¸ "
m_fRetryConnectTimer
¸¸ (
!=
¸¸) +
null
¸¸, 0
)
¸¸0 1
{
¹¹ "
m_fRetryConnectTimer
ºº (
.
ºº( )
Dispose
ºº) 0
(
ºº0 1
)
ºº1 2
;
ºº2 3"
m_fRetryConnectTimer
»» (
=
»») *
null
»»+ /
;
»»/ 0
}
¼¼ 
if
ÀÀ 
(
ÀÀ 
m_fMainSync
ÀÀ 
!=
ÀÀ  "
null
ÀÀ# '
)
ÀÀ' (
{
ÁÁ 
m_fMainSync
ÂÂ 
.
ÂÂ  
Dispose
ÂÂ  '
(
ÂÂ' (
)
ÂÂ( )
;
ÂÂ) *
m_fMainSync
ÃÃ 
=
ÃÃ  !
null
ÃÃ" &
;
ÃÃ& '
}
ÄÄ 
if
ÆÆ 
(
ÆÆ 
m_fDisconnectSync
ÆÆ %
!=
ÆÆ& (
null
ÆÆ) -
)
ÆÆ- .
{
ÇÇ 
m_fDisconnectSync
ÈÈ %
.
ÈÈ% &
Dispose
ÈÈ& -
(
ÈÈ- .
)
ÈÈ. /
;
ÈÈ/ 0
m_fDisconnectSync
ÉÉ %
=
ÉÉ& '
null
ÉÉ( ,
;
ÉÉ, -
}
ÊÊ 
}
ËË 
catch
ÌÌ 
(
ÌÌ 
	Exception
ÌÌ 
ex
ÌÌ 
)
ÌÌ  
{
ÍÍ 
FDebug
ÎÎ 
.
ÎÎ 
throwException
ÎÎ %
(
ÎÎ% &
ex
ÎÎ& (
)
ÎÎ( )
;
ÎÎ) *
}
ÏÏ 
finally
ĞĞ 
{
ÑÑ 
}
ÓÓ 
}
ÔÔ 	
private
ØØ 
void
ØØ 
changeState
ØØ  
(
ØØ  !

FPipeState
ÙÙ 
fState
ÙÙ 
)
ÚÚ 
{
ÛÛ 	
try
ÜÜ 
{
İİ 
if
ŞŞ 
(
ŞŞ 
m_fState
ŞŞ 
==
ŞŞ 
fState
ŞŞ  &
)
ŞŞ& '
{
ßß 
return
àà 
;
àà 
}
áá 
m_fState
ãã 
=
ãã 
fState
ãã !
;
ãã! "
m_fEventPusher
ää 
.
ää 
	pushEvent
ää (
(
ää( )
new
ää) ,(
FPipeStateChangedEventArgs
ää- G
(
ääG H
this
ääH L
,
ääL M
fState
ääN T
)
ääT U
)
ääU V
;
ääV W
}
åå 
catch
ææ 
(
ææ 
	Exception
ææ 
ex
ææ 
)
ææ  
{
çç 
FDebug
èè 
.
èè 
throwException
èè %
(
èè% &
ex
èè& (
)
èè( )
;
èè) *
}
éé 
finally
êê 
{
ëë 
}
íí 
}
îî 	
private
òò 
void
òò %
pushDataSendFailedEvent
òò ,
(
òò, -
FPipeSendData
óó 
fData
óó 
,
óó  
string
ôô 
message
ôô 
)
õõ 
{
öö 	
try
÷÷ 
{
øø 
m_fEventPusher
ùù 
.
ùù 
	pushEvent
ùù (
(
ùù( )
new
ùù) ,*
FPipeDataSendFailedEventArgs
ùù- I
(
ùùI J
this
ùùJ N
,
ùùN O
fData
ùùP U
,
ùùU V
message
ùùW ^
)
ùù^ _
)
ùù_ `
;
ùù` a
}
úú 
catch
ûû 
(
ûû 
	Exception
ûû 
ex
ûû 
)
ûû  
{
üü 
FDebug
ıı 
.
ıı 
writeLog
ıı 
(
ıı  
ex
ıı  "
)
ıı" #
;
ıı# $
}
şş 
finally
ÿÿ 
{
€€ 
}
‚‚ 
}
ƒƒ 	
private
‡‡ 
void
‡‡ 
pushErrorEvent
‡‡ #
(
‡‡# $
	Exception
ˆˆ 
ex
ˆˆ 
)
‰‰ 
{
ŠŠ 	
try
‹‹ 
{
ŒŒ 
FDebug
 
.
 
writeLog
 
(
  
ex
  "
)
" #
;
# $
m_fEventPusher
 
.
 
	pushEvent
 (
(
( )
new
) ,'
FPipeErrorRaisedEventArgs
- F
(
F G
this
G K
,
K L
ex
M O
.
O P
Message
P W
,
W X
ex
Y [
)
[ \
)
\ ]
;
] ^
}
 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘ 
ex1
‘‘  
)
‘‘  !
{
’’ 
FDebug
““ 
.
““ 
writeLog
““ 
(
““  
ex1
““  #
)
““# $
;
““$ %
}
”” 
finally
•• 
{
–– 
}
˜˜ 
}
™™ 	
public
 
void
 
start
 
(
 
)
 
{
ŸŸ 	
FDebugLogArgs
   
fLogArgs
   "
=
  # $
null
  % )
;
  ) *
try
¢¢ 
{
££ 
m_fMainSync
¤¤ 
.
¤¤ 
wait
¤¤  
(
¤¤  !
)
¤¤! "
;
¤¤" #
if
¨¨ 
(
¨¨ 
	m_started
¨¨ 
)
¨¨ 
{
©© 
FDebug
ªª 
.
ªª 
throwFException
ªª *
(
ªª* +
string
ªª+ 1
.
ªª1 2
Format
ªª2 8
(
ªª8 9

FConstants
ªª9 C
.
ªªC D

err_m_0001
ªªD N
,
ªªN O
$str
ªªP ]
)
ªª] ^
)
ªª^ _
;
ªª_ `
}
«« 
fLogArgs
²² 
=
²² 
new
²² 
FDebugLogArgs
²² ,
(
²², -
FDebugLogCategory
²²- >
.
²²> ?
Information
²²? J
,
²²J K
$str
²²L ]
,
²²] ^
this
²²_ c
.
²²c d
GetType
²²d k
(
²²k l
)
²²l m
,
²²m n
$str
²²o v
)
²²v w
;
²²w x
fLogArgs
³³ 
.
³³ 
additionInfo
³³ %
=
³³& '
$str
³³( 4
+
³³5 6

m_pipeName
³³7 A
+
³³B C
$str
³³D G
;
³³G H
FDebug
´´ 
.
´´ 
writeLog
´´ 
(
´´  
fLogArgs
´´  (
)
´´( )
;
´´) *
changeState
¸¸ 
(
¸¸ 

FPipeState
¸¸ &
.
¸¸& '
Opened
¸¸' -
)
¸¸- .
;
¸¸. /
	m_started
¹¹ 
=
¹¹ 
true
¹¹  
;
¹¹  !
}
ºº 
catch
»» 
(
»» 
	Exception
»» 
ex
»» 
)
»»  
{
¼¼ 
FDebug
½½ 
.
½½ 
throwException
½½ %
(
½½% &
ex
½½& (
)
½½( )
;
½½) *
}
¾¾ 
finally
¿¿ 
{
ÀÀ 
fLogArgs
ÁÁ 
=
ÁÁ 
null
ÁÁ 
;
ÁÁ  
m_fMainSync
ÂÂ 
.
ÂÂ 
set
ÂÂ 
(
ÂÂ  
)
ÂÂ  !
;
ÂÂ! "
}
ÃÃ 
}
ÄÄ 	
public
ÈÈ 
void
ÈÈ 
stop
ÈÈ 
(
ÈÈ 
)
ÉÉ 
{
ÊÊ 	
FDebugLogArgs
ËË 
fLogArgs
ËË "
=
ËË# $
null
ËË% )
;
ËË) *
try
ÍÍ 
{
ÎÎ 
m_fMainSync
ÏÏ 
.
ÏÏ 
wait
ÏÏ  
(
ÏÏ  !
)
ÏÏ! "
;
ÏÏ" #
if
ÓÓ 
(
ÓÓ 
!
ÓÓ 
	m_started
ÓÓ 
)
ÓÓ 
{
ÔÔ 
return
ÕÕ 
;
ÕÕ 
}
ÖÖ 
termPipeServer
ÚÚ 
(
ÚÚ 
)
ÚÚ  
;
ÚÚ  !
changeState
ÛÛ 
(
ÛÛ 

FPipeState
ÛÛ &
.
ÛÛ& '
Closed
ÛÛ' -
)
ÛÛ- .
;
ÛÛ. /
	m_started
ÜÜ 
=
ÜÜ 
false
ÜÜ !
;
ÜÜ! "
fLogArgs
ãã 
=
ãã 
new
ãã 
FDebugLogArgs
ãã ,
(
ãã, -
FDebugLogCategory
ãã- >
.
ãã> ?
Information
ãã? J
,
ããJ K
$str
ããL \
,
ãã\ ]
this
ãã^ b
.
ããb c
GetType
ããc j
(
ããj k
)
ããk l
,
ããl m
$str
ããn t
)
ããt u
;
ããu v
fLogArgs
ää 
.
ää 
additionInfo
ää %
=
ää& '
$str
ää( 4
+
ää5 6

m_pipeName
ää7 A
+
ääB C
$str
ääD G
;
ääG H
FDebug
åå 
.
åå 
writeLog
åå 
(
åå  
fLogArgs
åå  (
)
åå( )
;
åå) *
}
ææ 
catch
çç 
(
çç 
	Exception
çç 
ex
çç 
)
çç  
{
èè 
FDebug
éé 
.
éé 
throwException
éé %
(
éé% &
ex
éé& (
)
éé( )
;
éé) *
}
êê 
finally
ëë 
{
ìì 
fLogArgs
íí 
=
íí 
null
íí 
;
íí  
m_fMainSync
îî 
.
îî 
set
îî 
(
îî  
)
îî  !
;
îî! "
}
ïï 
}
ğğ 	
public
ôô 
void
ôô 
send
ôô 
(
ôô 
FPipeSendData
õõ 
fData
õõ 
)
öö 
{
÷÷ 	
try
øø 
{
ùù 
m_fMainSync
úú 
.
úú 
wait
úú  
(
úú  !
)
úú! "
;
úú" #
if
 
(
 
m_fState
 
!=
 

FPipeState
  *
.
* +
	Connected
+ 4
)
4 5
{
‚‚ 
FDebug
ƒƒ 
.
ƒƒ 
throwFException
ƒƒ *
(
ƒƒ* +
string
ƒƒ+ 1
.
ƒƒ1 2
Format
ƒƒ2 8
(
ƒƒ8 9

FConstants
ƒƒ9 C
.
ƒƒC D

err_m_0012
ƒƒD N
,
ƒƒN O
$str
ƒƒP W
)
ƒƒW X
)
ƒƒX Y
;
ƒƒY Z
}
„„ 
doSend
ˆˆ 
(
ˆˆ 
fData
ˆˆ 
)
ˆˆ 
;
ˆˆ 
}
‰‰ 
catch
ŠŠ 
(
ŠŠ 
	Exception
ŠŠ 
ex
ŠŠ 
)
ŠŠ  
{
‹‹ 
FDebug
ŒŒ 
.
ŒŒ 
throwException
ŒŒ %
(
ŒŒ% &
ex
ŒŒ& (
)
ŒŒ( )
;
ŒŒ) *
}
 
finally
 
{
 
m_fMainSync
 
.
 
set
 
(
  
)
  !
;
! "
}
‘‘ 
}
’’ 	
private
–– 
void
–– 
termPipeServer
–– #
(
––# $
)
—— 
{
˜˜ 	
try
™™ 
{
šš 
if
›› 
(
›› 
m_pipeServer
››  
==
››! #
null
››$ (
)
››( )
{
œœ 
return
 
;
 
}
 
m_pipeServer
ŸŸ 
.
ŸŸ 
Close
ŸŸ "
(
ŸŸ" #
)
ŸŸ# $
;
ŸŸ$ %
m_fPipeFlag
¦¦ 
.
¦¦ 
waitAllCompleted
¦¦ ,
(
¦¦, -
)
¦¦- .
;
¦¦. /
m_pipeServer
ªª 
=
ªª 
null
ªª #
;
ªª# $
}
«« 
catch
¬¬ 
(
¬¬ 
	Exception
¬¬ 
ex
¬¬ 
)
¬¬  
{
­­ 
FDebug
®® 
.
®® 
throwException
®® %
(
®®% &
ex
®®& (
)
®®( )
;
®®) *
}
¯¯ 
finally
°° 
{
±± 
}
³³ 
}
´´ 	
private
¸¸ 
void
¸¸ 
	doConnect
¸¸ 
(
¸¸ 
)
¹¹ 
{
ºº 	
bool
»» 
isReconnect
»» 
=
»» 
false
»» $
;
»»$ %
try
½½ 
{
¾¾ 
m_fPipeFlag
¿¿ 
.
¿¿ 
beginConnect
¿¿ (
(
¿¿( )
)
¿¿) *
;
¿¿* +
m_pipeServer
ÃÃ 
=
ÃÃ 
new
ÃÃ "#
NamedPipeServerStream
ÃÃ# 8
(
ÃÃ8 9

m_pipeName
ÄÄ 
,
ÄÄ 
PipeDirection
ÅÅ !
.
ÅÅ! "
InOut
ÅÅ" '
,
ÅÅ' (
$num
ÆÆ 
,
ÆÆ "
PipeTransmissionMode
ÇÇ (
.
ÇÇ( )
Byte
ÇÇ) -
,
ÇÇ- .
PipeOptions
ÈÈ 
.
ÈÈ  
Asynchronous
ÈÈ  ,
,
ÈÈ, -
RecvBufferSize
ÉÉ "
,
ÉÉ" #
SendBufferSize
ÊÊ "
)
ËË 
;
ËË 
m_pipeServer
ÌÌ 
.
ÌÌ $
BeginWaitForConnection
ÌÌ 3
(
ÌÌ3 4
new
ÌÌ4 7
AsyncCallback
ÌÌ8 E
(
ÌÌE F
doConnectCallback
ÌÌF W
)
ÌÌW X
,
ÌÌX Y
this
ÌÌZ ^
)
ÌÌ^ _
;
ÌÌ_ `
}
ÍÍ 
catch
ÎÎ 
(
ÎÎ 
	Exception
ÎÎ 
ex
ÎÎ 
)
ÎÎ  
{
ÏÏ 
if
ĞĞ 
(
ĞĞ 
ex
ĞĞ 
is
ĞĞ %
ObjectDisposedException
ĞĞ 1
)
ĞĞ1 2
{
ÑÑ 
System
ÒÒ 
.
ÒÒ 
Diagnostics
ÒÒ &
.
ÒÒ& '
Debug
ÒÒ' ,
.
ÒÒ, -
	WriteLine
ÒÒ- 6
(
ÒÒ6 7
ex
ÒÒ7 9
.
ÒÒ9 :
ToString
ÒÒ: B
(
ÒÒB C
)
ÒÒC D
)
ÒÒD E
;
ÒÒE F
}
ÓÓ 
else
ÔÔ 
{
ÕÕ 
pushErrorEvent
ÖÖ "
(
ÖÖ" #
ex
ÖÖ# %
)
ÖÖ% &
;
ÖÖ& '
isReconnect
×× 
=
××  !
true
××" &
;
××& '
}
ØØ 
m_fPipeFlag
ÙÙ 
.
ÙÙ 

endConnect
ÙÙ &
(
ÙÙ& '
)
ÙÙ' (
;
ÙÙ( )
}
ÚÚ 
finally
ÛÛ 
{
ÜÜ 
if
İİ 
(
İİ 
isReconnect
İİ 
)
İİ  
{
ŞŞ 
doReconnect
ßß 
(
ßß  
)
ßß  !
;
ßß! "
}
àà 
}
áá 
}
ââ 	
private
ææ 
void
ææ 
doDisconnect
ææ !
(
ææ! "
)
çç 
{
èè 	
FDebugLogArgs
éé 
fLogArgs
éé "
=
éé# $
null
éé% )
;
éé) *
try
ëë 
{
ìì 
m_fDisconnectSync
íí !
.
íí! "
wait
íí" &
(
íí& '
)
íí' (
;
íí( )
if
ññ 
(
ññ 
m_fPipeFlag
ññ 
.
ññ  
disconnected
ññ  ,
)
ññ, -
{
òò 
return
óó 
;
óó 
}
ôô 
fLogArgs
ûû 
=
ûû 
new
ûû 
FDebugLogArgs
ûû ,
(
ûû, -
FDebugLogCategory
ûû- >
.
ûû> ?
Information
ûû? J
,
ûûJ K
$str
ûûL b
,
ûûb c
this
ûûd h
.
ûûh i
GetType
ûûi p
(
ûûp q
)
ûûq r
,
ûûr s
$strûût ‚
)ûû‚ ƒ
;ûûƒ „
fLogArgs
üü 
.
üü 
additionInfo
üü %
=
üü& '
$str
üü( 4
+
üü5 6

m_pipeName
üü7 A
+
üüB C
$str
üüD G
;
üüG H
FDebug
ıı 
.
ıı 
writeLog
ıı 
(
ıı  
fLogArgs
ıı  (
)
ıı( )
;
ıı) *
m_fPipeFlag
 
.
 
disconnected
 (
=
) *
true
+ /
;
/ 0
}
‚‚ 
catch
ƒƒ 
(
ƒƒ 
	Exception
ƒƒ 
ex
ƒƒ 
)
ƒƒ  
{
„„ 
pushErrorEvent
…… 
(
…… 
ex
…… !
)
……! "
;
……" #
}
†† 
finally
‡‡ 
{
ˆˆ 
m_fDisconnectSync
‰‰ !
.
‰‰! "
set
‰‰" %
(
‰‰% &
)
‰‰& '
;
‰‰' (
}
ŠŠ 
}
‹‹ 	
private
 
void
 
doReconnect
  
(
  !
)
 
{
‘‘ 	
try
’’ 
{
““ "
m_fRetryConnectTimer
—— $
.
——$ %
start
——% *
(
——* +"
m_retryConnectPeriod
——+ ?
)
——? @
;
——@ A
termPipeServer
›› 
(
›› 
)
››  
;
››  !
m_fPipeFlag
ŸŸ 
.
ŸŸ 
init
ŸŸ  
(
ŸŸ  !
)
ŸŸ! "
;
ŸŸ" #
changeState
   
(
   

FPipeState
   &
.
  & '
Opened
  ' -
)
  - .
;
  . /
}
¡¡ 
catch
¢¢ 
(
¢¢ 
	Exception
¢¢ 
ex
¢¢ 
)
¢¢  
{
££ 
FDebug
¤¤ 
.
¤¤ 
throwException
¤¤ %
(
¤¤% &
ex
¤¤& (
)
¤¤( )
;
¤¤) *
}
¥¥ 
finally
¦¦ 
{
§§ 
}
©© 
}
ªª 	
private
®® 
void
®® 
	doReceive
®® 
(
®® 
)
¯¯ 
{
°° 	
try
±± 
{
²² 
m_fPipeFlag
³³ 
.
³³ 
beginReceive
³³ (
(
³³( )
)
³³) *
;
³³* +
m_pipeServer
´´ 
.
´´ 
	BeginRead
´´ &
(
´´& '
	m_recvBuf
´´' 0
,
´´0 1
$num
´´2 3
,
´´3 4
	m_recvBuf
´´5 >
.
´´> ?
Length
´´? E
,
´´E F
new
´´G J
AsyncCallback
´´K X
(
´´X Y
doReceiveCallback
´´Y j
)
´´j k
,
´´k l
this
´´m q
)
´´q r
;
´´r s
}
µµ 
catch
¶¶ 
(
¶¶ 
	Exception
¶¶ 
ex
¶¶ 
)
¶¶  
{
·· 
if
¸¸ 
(
¸¸ 
ex
¸¸ 
is
¸¸ 
IOException
¸¸ %
)
¸¸% &
{
¹¹ 
pushErrorEvent
ºº "
(
ºº" #
ex
ºº# %
)
ºº% &
;
ºº& '
doDisconnect
ÁÁ  
(
ÁÁ  !
)
ÁÁ! "
;
ÁÁ" #
}
ÂÂ 
else
ÃÃ 
if
ÃÃ 
(
ÃÃ 
ex
ÃÃ 
is
ÃÃ %
ObjectDisposedException
ÃÃ 6
)
ÃÃ6 7
{
ÄÄ 
System
ÅÅ 
.
ÅÅ 
Diagnostics
ÅÅ &
.
ÅÅ& '
Debug
ÅÅ' ,
.
ÅÅ, -
	WriteLine
ÅÅ- 6
(
ÅÅ6 7
ex
ÅÅ7 9
)
ÅÅ9 :
;
ÅÅ: ;
}
ÆÆ 
else
ÇÇ 
{
ÈÈ 
pushErrorEvent
ÉÉ "
(
ÉÉ" #
ex
ÉÉ# %
)
ÉÉ% &
;
ÉÉ& '
}
ÊÊ 
m_fPipeFlag
ËË 
.
ËË 

endReceive
ËË &
(
ËË& '
)
ËË' (
;
ËË( )
}
ÌÌ 
finally
ÍÍ 
{
ÎÎ 
}
ĞĞ 
}
ÑÑ 	
private
ÕÕ 
void
ÕÕ 
doSend
ÕÕ 
(
ÕÕ 
FPipeSendData
ÖÖ 
fData
ÖÖ 
)
×× 
{
ØØ 	
try
ÙÙ 
{
ÚÚ 
m_fPipeFlag
ÛÛ 
.
ÛÛ 
	beginSend
ÛÛ %
(
ÛÛ% &
)
ÛÛ& '
;
ÛÛ' (
m_pipeServer
ÜÜ 
.
ÜÜ 

BeginWrite
ÜÜ '
(
ÜÜ' (
fData
ÜÜ( -
.
ÜÜ- .
data
ÜÜ. 2
,
ÜÜ2 3
$num
ÜÜ4 5
,
ÜÜ5 6
fData
ÜÜ7 <
.
ÜÜ< =
data
ÜÜ= A
.
ÜÜA B
Length
ÜÜB H
,
ÜÜH I
new
ÜÜJ M
AsyncCallback
ÜÜN [
(
ÜÜ[ \
doSendCallback
ÜÜ\ j
)
ÜÜj k
,
ÜÜk l
fData
ÜÜm r
)
ÜÜr s
;
ÜÜs t
}
İİ 
catch
ŞŞ 
(
ŞŞ 
	Exception
ŞŞ 
ex
ŞŞ 
)
ŞŞ  
{
ßß 
if
àà 
(
àà 
ex
àà 
is
àà 
IOException
àà %
)
àà% &
{
áá 
pushErrorEvent
ââ "
(
ââ" #
ex
ââ# %
)
ââ% &
;
ââ& '%
pushDataSendFailedEvent
ãã +
(
ãã+ ,
fData
ãã, 1
,
ãã1 2
ex
ãã3 5
.
ãã5 6
Message
ãã6 =
)
ãã= >
;
ãã> ?
doDisconnect
êê  
(
êê  !
)
êê! "
;
êê" #
}
ëë 
else
ìì 
if
ìì 
(
ìì 
ex
ìì 
is
ìì %
ObjectDisposedException
ìì 6
)
ìì6 7
{
íí 
System
îî 
.
îî 
Diagnostics
îî &
.
îî& '
Debug
îî' ,
.
îî, -
	WriteLine
îî- 6
(
îî6 7
ex
îî7 9
)
îî9 :
;
îî: ;
}
ïï 
else
ğğ 
{
ññ 
pushErrorEvent
òò "
(
òò" #
ex
òò# %
)
òò% &
;
òò& '%
pushDataSendFailedEvent
óó +
(
óó+ ,
fData
óó, 1
,
óó1 2
ex
óó3 5
.
óó5 6
Message
óó6 =
)
óó= >
;
óó> ?
}
ôô 
m_fPipeFlag
õõ 
.
õõ 
endSend
õõ #
(
õõ# $
)
õõ$ %
;
õõ% &
}
öö 
finally
÷÷ 
{
øø 
}
úú 
}
ûû 	
private
ÿÿ 
void
ÿÿ 
doConnectCallback
ÿÿ &
(
ÿÿ& '
IAsyncResult
€€ 
ar
€€ 
)
 
{
‚‚ 	
FDebugLogArgs
ƒƒ 
fLogArgs
ƒƒ "
=
ƒƒ# $
null
ƒƒ% )
;
ƒƒ) *
try
…… 
{
†† 
if
‡‡ 
(
‡‡ 
m_pipeServer
‡‡  
==
‡‡! #
null
‡‡$ (
)
‡‡( )
{
ˆˆ 
return
‰‰ 
;
‰‰ 
}
ŠŠ 
m_pipeServer
 
.
 "
EndWaitForConnection
 1
(
1 2
ar
2 4
)
4 5
;
5 6
fLogArgs
•• 
=
•• 
new
•• 
FDebugLogArgs
•• ,
(
••, -
FDebugLogCategory
••- >
.
••> ?
Information
••? J
,
••J K
$str
••L _
,
••_ `
this
••a e
.
••e f
GetType
••f m
(
••m n
)
••n o
,
••o p
$str••q „
)••„ …
;••… †
fLogArgs
–– 
.
–– 
additionInfo
–– %
=
––& '
$str
––( 4
+
––5 6

m_pipeName
––7 A
+
––B C
$str
––D G
;
––G H
FDebug
—— 
.
—— 
writeLog
—— 
(
——  
fLogArgs
——  (
)
——( )
;
——) *
changeState
›› 
(
›› 

FPipeState
›› &
.
››& '
	Connected
››' 0
)
››0 1
;
››1 2
}
œœ 
catch
 
(
 
	Exception
 
ex
 
)
  
{
 
if
ŸŸ 
(
ŸŸ 
ex
ŸŸ 
is
ŸŸ %
ObjectDisposedException
ŸŸ 1
)
ŸŸ1 2
{
   
System
¡¡ 
.
¡¡ 
Diagnostics
¡¡ &
.
¡¡& '
Debug
¡¡' ,
.
¡¡, -
	WriteLine
¡¡- 6
(
¡¡6 7
ex
¡¡7 9
.
¡¡9 :
ToString
¡¡: B
(
¡¡B C
)
¡¡C D
)
¡¡D E
;
¡¡E F
}
¢¢ 
else
££ 
{
¤¤ 
pushErrorEvent
¥¥ "
(
¥¥" #
ex
¥¥# %
)
¥¥% &
;
¥¥& '
}
¦¦ 
}
§§ 
finally
¨¨ 
{
©© 
fLogArgs
ªª 
=
ªª 
null
ªª 
;
ªª  
m_fPipeFlag
«« 
.
«« 

endConnect
«« &
(
««& '
)
««' (
;
««( )
}
¬¬ 
}
­­ 	
private
±± 
void
±± 
doReceiveCallback
±± &
(
±±& '
IAsyncResult
²² 
ar
²² 
)
³³ 
{
´´ 	
int
µµ 
length
µµ 
=
µµ 
$num
µµ 
;
µµ 
byte
¶¶ 
[
¶¶ 
]
¶¶ 
data
¶¶ 
=
¶¶ 
null
¶¶ 
;
¶¶ 
try
¸¸ 
{
¹¹ 
length
ºº 
=
ºº 
m_pipeServer
ºº %
.
ºº% &
EndRead
ºº& -
(
ºº- .
ar
ºº. 0
)
ºº0 1
;
ºº1 2
if
»» 
(
»» 
length
»» 
==
»» 
$num
»» 
)
»»  
{
¼¼ 
doDisconnect
½½  
(
½½  !
)
½½! "
;
½½" #
return
¾¾ 
;
¾¾ 
}
¿¿ 
data
ÃÃ 
=
ÃÃ 
new
ÃÃ 
byte
ÃÃ 
[
ÃÃ  
length
ÃÃ  &
]
ÃÃ& '
;
ÃÃ' (
Buffer
ÄÄ 
.
ÄÄ 
	BlockCopy
ÄÄ  
(
ÄÄ  !
	m_recvBuf
ÄÄ! *
,
ÄÄ* +
$num
ÄÄ, -
,
ÄÄ- .
data
ÄÄ/ 3
,
ÄÄ3 4
$num
ÄÄ5 6
,
ÄÄ6 7
length
ÄÄ8 >
)
ÄÄ> ?
;
ÄÄ? @
m_fEventPusher
ÅÅ 
.
ÅÅ 
	pushEvent
ÅÅ (
(
ÅÅ( )
new
ÅÅ) ,(
FPipeDataReceivedEventArgs
ÅÅ- G
(
ÅÅG H
this
ÅÅH L
,
ÅÅL M
data
ÅÅN R
)
ÅÅR S
)
ÅÅS T
;
ÅÅT U
}
ÆÆ 
catch
ÇÇ 
(
ÇÇ 
	Exception
ÇÇ 
ex
ÇÇ 
)
ÇÇ  
{
ÈÈ 
if
ÉÉ 
(
ÉÉ 
ex
ÉÉ 
is
ÉÉ 
IOException
ÉÉ %
)
ÉÉ% &
{
ÊÊ 
pushErrorEvent
ËË "
(
ËË" #
ex
ËË# %
)
ËË% &
;
ËË& '
doDisconnect
ÒÒ  
(
ÒÒ  !
)
ÒÒ! "
;
ÒÒ" #
}
ÓÓ 
else
ÔÔ 
if
ÔÔ 
(
ÔÔ 
ex
ÔÔ 
is
ÔÔ %
ObjectDisposedException
ÔÔ 6
)
ÔÔ6 7
{
ÕÕ 
System
ÖÖ 
.
ÖÖ 
Diagnostics
ÖÖ &
.
ÖÖ& '
Debug
ÖÖ' ,
.
ÖÖ, -
	WriteLine
ÖÖ- 6
(
ÖÖ6 7
ex
ÖÖ7 9
)
ÖÖ9 :
;
ÖÖ: ;
}
×× 
else
ØØ 
{
ÙÙ 
pushErrorEvent
ÚÚ "
(
ÚÚ" #
ex
ÚÚ# %
)
ÚÚ% &
;
ÚÚ& '
}
ÛÛ 
}
ÜÜ 
finally
İİ 
{
ŞŞ 
m_fPipeFlag
ßß 
.
ßß 

endReceive
ßß &
(
ßß& '
)
ßß' (
;
ßß( )
}
àà 
}
áá 	
private
åå 
void
åå 
doSendCallback
åå #
(
åå# $
IAsyncResult
ææ 
ar
ææ 
)
çç 
{
èè 	
FPipeSendData
éé 
fData
éé 
=
éé  !
null
éé" &
;
éé& '
try
ëë 
{
ìì 
fData
íí 
=
íí 
(
íí 
FPipeSendData
íí &
)
íí& '
ar
íí' )
.
íí) *

AsyncState
íí* 4
;
íí4 5
m_pipeServer
îî 
.
îî 
EndWrite
îî %
(
îî% &
ar
îî& (
)
îî( )
;
îî) *
m_fEventPusher
ïï 
.
ïï 
	pushEvent
ïï (
(
ïï( )
new
ïï) ,$
FPipeDataSentEventArgs
ïï- C
(
ïïC D
this
ïïD H
,
ïïH I
fData
ïïJ O
)
ïïO P
)
ïïP Q
;
ïïQ R
}
ğğ 
catch
ññ 
(
ññ 
	Exception
ññ 
ex
ññ 
)
ññ  
{
òò 
if
óó 
(
óó 
ex
óó 
is
óó 
IOException
óó %
)
óó% &
{
ôô 
pushErrorEvent
õõ "
(
õõ" #
ex
õõ# %
)
õõ% &
;
õõ& '%
pushDataSendFailedEvent
öö +
(
öö+ ,
fData
öö, 1
,
öö1 2
ex
öö3 5
.
öö5 6
Message
öö6 =
)
öö= >
;
öö> ?
doDisconnect
ıı  
(
ıı  !
)
ıı! "
;
ıı" #
}
şş 
else
ÿÿ 
if
ÿÿ 
(
ÿÿ 
ex
ÿÿ 
is
ÿÿ %
ObjectDisposedException
ÿÿ 6
)
ÿÿ6 7
{
€€ 
System
 
.
 
Diagnostics
 &
.
& '
Debug
' ,
.
, -
	WriteLine
- 6
(
6 7
ex
7 9
.
9 :
ToString
: B
(
B C
)
C D
)
D E
;
E F
}
‚‚ 
else
ƒƒ 
{
„„ 
pushErrorEvent
…… "
(
……" #
ex
……# %
)
……% &
;
……& '%
pushDataSendFailedEvent
†† +
(
††+ ,
fData
††, 1
,
††1 2
ex
††3 5
.
††5 6
Message
††6 =
)
††= >
;
††> ?
}
‡‡ 
}
ˆˆ 
finally
‰‰ 
{
ŠŠ 
m_fPipeFlag
‹‹ 
.
‹‹ 
endSend
‹‹ #
(
‹‹# $
)
‹‹$ %
;
‹‹% &
}
ŒŒ 
}
 	
internal
‘‘ 
void
‘‘  
onPipeStateChanged
‘‘ (
(
‘‘( ) 
FPipeEventArgsBase
’’ 
args
’’ #
)
““ 
{
”” 	
try
•• 
{
–– 
if
—— 
(
—— 
PipeStateChanged
—— $
!=
——% '
null
——( ,
)
——, -
{
˜˜ 
PipeStateChanged
™™ $
(
™™$ %
this
™™% )
,
™™) *
(
™™+ ,(
FPipeStateChangedEventArgs
™™, F
)
™™F G
args
™™G K
)
™™K L
;
™™L M
}
šš 
}
›› 
catch
œœ 
(
œœ 
	Exception
œœ 
ex
œœ 
)
œœ  
{
 
FDebug
 
.
 
writeLog
 
(
  
ex
  "
)
" #
;
# $
}
ŸŸ 
finally
   
{
¡¡ 
}
££ 
}
¤¤ 	
internal
¨¨ 
void
¨¨  
onPipeDataReceived
¨¨ (
(
¨¨( ) 
FPipeEventArgsBase
©© 
args
©© #
)
ªª 
{
«« 	
try
¬¬ 
{
­­ 
if
®® 
(
®® 
PipeDataReceived
®® $
!=
®®% '
null
®®( ,
)
®®, -
{
¯¯ 
PipeDataReceived
°° $
(
°°$ %
this
°°% )
,
°°) *
(
°°+ ,(
FPipeDataReceivedEventArgs
°°, F
)
°°F G
args
°°G K
)
°°K L
;
°°L M
}
±± 
}
²² 
catch
³³ 
(
³³ 
	Exception
³³ 
ex
³³ 
)
³³  
{
´´ 
FDebug
µµ 
.
µµ 
writeLog
µµ 
(
µµ  
ex
µµ  "
)
µµ" #
;
µµ# $
}
¶¶ 
finally
·· 
{
¸¸ 
}
ºº 
}
»» 	
internal
¿¿ 
void
¿¿ 
onPipeDataSent
¿¿ $
(
¿¿$ % 
FPipeEventArgsBase
ÀÀ 
args
ÀÀ #
)
ÁÁ 
{
ÂÂ 	
try
ÃÃ 
{
ÄÄ 
if
ÅÅ 
(
ÅÅ 
PipeDataSent
ÅÅ  
!=
ÅÅ! #
null
ÅÅ$ (
)
ÅÅ( )
{
ÆÆ 
PipeDataSent
ÇÇ  
(
ÇÇ  !
this
ÇÇ! %
,
ÇÇ% &
(
ÇÇ' ($
FPipeDataSentEventArgs
ÇÇ( >
)
ÇÇ> ?
args
ÇÇ? C
)
ÇÇC D
;
ÇÇD E
}
ÈÈ 
}
ÉÉ 
catch
ÊÊ 
(
ÊÊ 
	Exception
ÊÊ 
ex
ÊÊ 
)
ÊÊ  
{
ËË 
FDebug
ÌÌ 
.
ÌÌ 
writeLog
ÌÌ 
(
ÌÌ  
ex
ÌÌ  "
)
ÌÌ" #
;
ÌÌ# $
}
ÍÍ 
finally
ÎÎ 
{
ÏÏ 
}
ÑÑ 
}
ÒÒ 	
internal
ÖÖ 
void
ÖÖ "
onPipeDataSendFailed
ÖÖ *
(
ÖÖ* + 
FPipeEventArgsBase
×× 
args
×× #
)
ØØ 
{
ÙÙ 	
try
ÚÚ 
{
ÛÛ 
if
ÜÜ 
(
ÜÜ  
PipeDataSendFailed
ÜÜ &
!=
ÜÜ' )
null
ÜÜ* .
)
ÜÜ. /
{
İİ  
PipeDataSendFailed
ŞŞ &
(
ŞŞ& '
this
ŞŞ' +
,
ŞŞ+ ,
(
ŞŞ- .*
FPipeDataSendFailedEventArgs
ŞŞ. J
)
ŞŞJ K
args
ŞŞK O
)
ŞŞO P
;
ŞŞP Q
}
ßß 
}
àà 
catch
áá 
(
áá 
	Exception
áá 
ex
áá 
)
áá  
{
ââ 
FDebug
ãã 
.
ãã 
writeLog
ãã 
(
ãã  
ex
ãã  "
)
ãã" #
;
ãã# $
}
ää 
finally
åå 
{
ææ 
}
èè 
}
éé 	
internal
íí 
void
íí 
onPipeErrorRaised
íí '
(
íí' ( 
FPipeEventArgsBase
îî 
args
îî #
)
ïï 
{
ğğ 	
try
ññ 
{
òò 
if
óó 
(
óó 
PipeErrorRaised
óó #
!=
óó$ &
null
óó' +
)
óó+ ,
{
ôô 
PipeErrorRaised
õõ #
(
õõ# $
this
õõ$ (
,
õõ( )
(
õõ* +'
FPipeErrorRaisedEventArgs
õõ+ D
)
õõD E
args
õõE I
)
õõI J
;
õõJ K
}
öö 
}
÷÷ 
catch
øø 
(
øø 
	Exception
øø 
ex
øø 
)
øø  
{
ùù 
FDebug
úú 
.
úú 
writeLog
úú 
(
úú  
ex
úú  "
)
úú" #
;
úú# $
}
ûû 
finally
üü 
{
ıı 
}
ÿÿ 
}
€€ 	
private
ˆˆ 
void
ˆˆ (
m_fThdMain_ThreadJobCalled
ˆˆ /
(
ˆˆ/ 0
object
‰‰ 
sender
‰‰ 
,
‰‰ 
FThreadEventArgs
ŠŠ 
e
ŠŠ 
)
‹‹ 
{
ŒŒ 	
bool
 
waited
 
=
 
false
 
;
  
try
 
{
 
waited
‘‘ 
=
‘‘ 
m_fMainSync
‘‘ $
.
‘‘$ %
tryWait
‘‘% ,
(
‘‘, -
$num
‘‘- .
)
‘‘. /
;
‘‘/ 0
if
’’ 
(
’’ 
!
’’ 
waited
’’ 
)
’’ 
{
““ 
return
”” 
;
”” 
}
•• 
if
™™ 
(
™™ 
m_fState
™™ 
==
™™ 

FPipeState
™™  *
.
™™* +
Opened
™™+ 1
)
™™1 2
{
šš 
if
›› 
(
›› 
!
›› "
m_fRetryConnectTimer
›› -
.
››- .
enabled
››. 5
||
››6 8"
m_fRetryConnectTimer
››9 M
.
››M N
elasped
››N U
(
››U V
false
››V [
)
››[ \
)
››\ ]
{
œœ 
if
 
(
 
m_fPipeFlag
 '
.
' ( 
doConnectCompleted
( :
)
: ;
{
 
	doConnect
ŸŸ %
(
ŸŸ% &
)
ŸŸ& '
;
ŸŸ' (
return
   "
;
  " #
}
¡¡ 
}
¢¢ 
}
££ 
else
¤¤ 
if
¤¤ 
(
¤¤ 
m_fState
¤¤ !
==
¤¤" $

FPipeState
¤¤% /
.
¤¤/ 0
	Connected
¤¤0 9
)
¤¤9 :
{
¥¥ 
if
¦¦ 
(
¦¦ 
m_fPipeFlag
¦¦ #
.
¦¦# $
disconnected
¦¦$ 0
)
¦¦0 1
{
§§ 
doReconnect
¨¨ #
(
¨¨# $
)
¨¨$ %
;
¨¨% &
return
©© 
;
©© 
}
ªª 
if
®® 
(
®® 
m_fPipeFlag
®® #
.
®®# $ 
doReceiveCompleted
®®$ 6
)
®®6 7
{
¯¯ 
	doReceive
°° !
(
°°! "
)
°°" #
;
°°# $
return
±± 
;
±± 
}
²² 
}
³³ 
else
´´ 
if
´´ 
(
´´ 
m_fState
´´ !
==
´´" $

FPipeState
´´% /
.
´´/ 0
Closed
´´0 6
)
´´6 7
{
µµ 
}
·· 
e
»» 
.
»» 
sleepThread
»» 
(
»» 
$num
»» 
)
»»  
;
»»  !
}
¼¼ 
catch
½½ 
(
½½ 
	Exception
½½ 
ex
½½ 
)
½½  
{
¾¾ 
pushErrorEvent
¿¿ 
(
¿¿ 
ex
¿¿ !
)
¿¿! "
;
¿¿" #
}
ÀÀ 
finally
ÁÁ 
{
ÂÂ 
if
ÃÃ 
(
ÃÃ 
waited
ÃÃ 
)
ÃÃ 
{
ÄÄ 
m_fMainSync
ÅÅ 
.
ÅÅ  
set
ÅÅ  #
(
ÅÅ# $
)
ÅÅ$ %
;
ÅÅ% &
}
ÆÆ 
}
ÇÇ 
}
ÈÈ 	
}
ÎÎ 
}ÏÏ “+
\D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Pipe\c_FPipeSendData.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FPipeSendData 
:  
IDisposable! ,
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
byte 
[ 
] 
m_data 
= 
null  $
;$ %
private 
object 
m_state 
=  
null! %
;% &
public"" 
FPipeSendData"" 
("" 
byte## 
[## 
]## 
data## 
)$$ 
{%% 	
m_data&& 
=&& 
data&& 
;&& 
}'' 	
public++ 
FPipeSendData++ 
(++ 
byte,, 
[,, 
],, 
data,, 
,,, 
object-- 
state-- 
).. 
:// 
this// 
(// 
data// 
)// 
{00 	
m_state11 
=11 
state11 
;11 
}22 	
public66 
FPipeSendData66 
(66 
string77 
data77 
)88 
{99 	
m_data:: 
=:: 
Encoding:: 
.:: 
Default:: %
.::% &
GetBytes::& .
(::. /
data::/ 3
)::3 4
;::4 5
};; 	
public?? 
FPipeSendData?? 
(?? 
string@@ 
data@@ 
,@@ 
objectAA 
stateAA 
)BB 
:CC 
thisCC 
(CC 
dataCC 
)CC 
{DD 	
m_stateEE 
=EE 
stateEE 
;EE 
}FF 	
~JJ 	
FPipeSendDataJJ	 
(JJ 
)KK 
{LL 	
	myDisposeMM 
(MM 
falseMM 
)MM 
;MM 
}NN 	
	protectedRR 
voidRR 
	myDisposeRR  
(RR  !
boolSS 
	disposingSS 
)TT 
{UU 	
ifVV 
(VV 
!VV 

m_disposedVV 
)VV 
{WW 
ifXX 
(XX 
	disposingXX 
)XX 
{YY 
m_dataZZ 
=ZZ 
nullZZ !
;ZZ! "
m_state[[ 
=[[ 
null[[ "
;[[" #
}\\ 

m_disposed^^ 
=^^ 
true^^ !
;^^! "
}__ 
}`` 	
publichh 
voidhh 
Disposehh 
(hh 
)ii 
{jj 	
	myDisposekk 
(kk 
truekk 
)kk 
;kk 
GCll 
.ll 
SuppressFinalizell 
(ll  
thisll  $
)ll$ %
;ll% &
}mm 	
publicuu 
byteuu 
[uu 
]uu 
datauu 
{vv 	
getww 
{xx 
tryyy 
{zz 
return{{ 
m_data{{ !
;{{! "
}|| 
catch}} 
(}} 
	Exception}}  
ex}}! #
)}}# $
{~~ 
FDebug 
. 
throwException )
() *
ex* ,
), -
;- .
}
€€ 
finally
 
{
‚‚ 
}
„„ 
return
…… 
null
…… 
;
…… 
}
†† 
}
‡‡ 	
public
‹‹ 
object
‹‹ 
state
‹‹ 
{
ŒŒ 	
get
 
{
 
try
 
{
 
return
‘‘ 
m_state
‘‘ "
;
‘‘" #
}
’’ 
catch
““ 
(
““ 
	Exception
““  
ex
““! #
)
““# $
{
”” 
FDebug
•• 
.
•• 
throwException
•• )
(
••) *
ex
••* ,
)
••, -
;
••- .
}
–– 
finally
—— 
{
˜˜ 
}
šš 
return
›› 
null
›› 
;
›› 
}
œœ 
}
 	
public
¥¥ 
string
¥¥ 
dataToString
¥¥ "
(
¥¥" #
)
¦¦ 
{
§§ 	
try
¨¨ 
{
©© 
if
ªª 
(
ªª 
m_data
ªª 
==
ªª 
null
ªª "
)
ªª" #
{
«« 
return
¬¬ 
string
¬¬ !
.
¬¬! "
Empty
¬¬" '
;
¬¬' (
}
­­ 
return
®® 
Encoding
®® 
.
®®  
Default
®®  '
.
®®' (
	GetString
®®( 1
(
®®1 2
m_data
®®2 8
)
®®8 9
;
®®9 :
}
¯¯ 
catch
°° 
(
°° 
	Exception
°° 
ex
°° 
)
°°  
{
±± 
FDebug
²² 
.
²² 
throwException
²² %
(
²²% &
ex
²²& (
)
²²( )
;
²²) *
}
³³ 
finally
´´ 
{
µµ 
}
·· 
return
¸¸ 
string
¸¸ 
.
¸¸ 
Empty
¸¸ 
;
¸¸  
}
¹¹ 	
}
¿¿ 
}ÀÀ ‡
aD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Pipe\c_FPipeEventArgsBase.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
Serializable 
] 
public 

abstract 
class 
FPipeEventArgsBase ,
:- .
	EventArgs/ 8
,8 9
IDisposable: E
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FPipeEventId 
m_fPipeEventId +
=, -
FPipeEventId. :
.: ;
None; ?
;? @
internal## 
FPipeEventArgsBase## #
(### $
FPipeEventId$$ 
fPipeEventId$$ %
)%% 
{&& 	
m_fPipeEventId'' 
='' 
fPipeEventId'' )
;'') *
}(( 	
~,, 	
FPipeEventArgsBase,,	 
(,, 
)-- 
{.. 	
	myDispose// 
(// 
false// 
)// 
;// 
}00 	
	protected44 
virtual44 
void44 
	myDispose44 (
(44( )
bool55 
	disposing55 
)66 
{77 	
if88 
(88 
!88 

m_disposed88 
)88 
{99 
if:: 
(:: 
	disposing:: 
):: 
{;; 
}== 

m_disposed?? 
=?? 
true?? !
;??! "
}@@ 
}AA 	
publicII 
voidII 
DisposeII 
(II 
)JJ 
{KK 	
	myDisposeLL 
(LL 
trueLL 
)LL 
;LL 
GCMM 
.MM 
SuppressFinalizeMM 
(MM  
thisMM  $
)MM$ %
;MM% &
}NN 	
internalVV 
FPipeEventIdVV 
fPipeEventIdVV *
{WW 	
getXX 
{YY 
tryZZ 
{[[ 
return\\ 
m_fPipeEventId\\ )
;\\) *
}]] 
catch^^ 
(^^ 
	Exception^^  
ex^^! #
)^^# $
{__ 
FDebug`` 
.`` 
throwException`` )
(``) *
ex``* ,
)``, -
;``- .
}aa 
finallybb 
{cc 
}ee 
returnff 
FPipeEventIdff #
.ff# $
Noneff$ (
;ff( )
}gg 
}hh 	
}tt 
}uu Ÿ
iD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Pipe\c_FPipeStateChangedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
Serializable 
] 
public 

class &
FPipeStateChangedEventArgs +
:, -
FPipeEventArgsBase. @
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FIPipe 
m_fOwnerPipe #
=$ %
null& *
;* +
private 

FPipeState 
m_fState #
=$ %

FPipeState& 0
.0 1
Closed1 7
;7 8
internal## &
FPipeStateChangedEventArgs## +
(##+ ,
FIPipe$$ 

fOwnerPipe$$ 
,$$ 

FPipeState%% 
fState%% 
)&& 
:'' 
base'' 
('' 
FPipeEventId''  
.''  !
PipeStateChanged''! 1
)''1 2
{(( 	
m_fOwnerPipe)) 
=)) 

fOwnerPipe)) %
;))% &
m_fState** 
=** 
fState** 
;** 
}++ 	
~// 	&
FPipeStateChangedEventArgs//	 #
(//# $
)00 
{11 	
	myDispose22 
(22 
false22 
)22 
;22 
}33 	
	protected77 
override77 
void77 
	myDispose77  )
(77) *
bool88 
	disposing88 
)99 
{:: 	
if;; 
(;; 
!;; 

m_disposed;; 
);; 
{<< 
if== 
(== 
	disposing== 
)== 
{>> 
m_fOwnerPipe??  
=??! "
null??# '
;??' (
}@@ 

m_disposedAA 
=AA 
trueAA !
;AA! "
baseEE 
.EE 
	myDisposeEE 
(EE 
	disposingEE (
)EE( )
;EE) *
}FF 
}GG 	
publicOO 
FIPipeOO 

fOwnerPipeOO  
{PP 	
getQQ 
{RR 
trySS 
{TT 
returnUU 
m_fOwnerPipeUU '
;UU' (
}VV 
catchWW 
(WW 
	ExceptionWW  
exWW! #
)WW# $
{XX 
FDebugYY 
.YY 
throwExceptionYY )
(YY) *
exYY* ,
)YY, -
;YY- .
}ZZ 
finally[[ 
{\\ 
}^^ 
return__ 
null__ 
;__ 
}`` 
}aa 	
publicee 

FPipeStateee 
fStateee  
{ff 	
getgg 
{hh 
tryii 
{jj 
returnkk 
m_fStatekk #
;kk# $
}ll 
catchmm 
(mm 
	Exceptionmm  
exmm! #
)mm# $
{nn 
FDebugoo 
.oo 
throwExceptionoo )
(oo) *
exoo* ,
)oo, -
;oo- .
}pp 
finallyqq 
{rr 
}tt 
returnuu 

FPipeStateuu !
.uu! "
Closeduu" (
;uu( )
}vv 
}ww 	
}
ƒƒ 
}„„ ô‡
_D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Pipe\c_FPipeEventPusher.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
internal 
class 
FPipeEventPusher #
:$ %
IDisposable& 1
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
FIPipe 
m_fPipe 
= 
null 
; 
private 
FQueue 
< 
FPipeEventArgsBase )
>) *
	m_fEvents+ 4
=5 6
null7 ;
;; <
private 
FThread 
m_fEventPusher &
=' (
null) -
;- .
private   
bool   &
m_isCompletedEventHandling   /
=  0 1
false  2 7
;  7 8
public&& 
FPipeEventPusher&& 
(&&  
FIPipe'' 
fPipe'' 
)(( 
{)) 	
m_fPipe** 
=** 
fPipe** 
;** 
	m_fEvents++ 
=++ 
new++ 
FQueue++ "
<++" #
FPipeEventArgsBase++# 5
>++5 6
(++6 7
)++7 8
;++8 9
init// 
(// 
)// 
;// 
}00 	
~44 	
FPipeEventPusher44	 
(44 
)55 
{66 	
	myDispose77 
(77 
false77 
)77 
;77 
}88 	
	protected<< 
void<< 
	myDispose<<  
(<<  !
bool== 
	disposing== 
)>> 
{?? 	
if@@ 
(@@ 
!@@ 

m_disposed@@ 
)@@ 
{AA 
ifBB 
(BB 
	disposingBB 
)BB 
{CC 
termDD 
(DD 
)DD 
;DD 
ifHH 
(HH 
	m_fEventsHH !
!=HH" $
nullHH% )
)HH) *
{II 
	m_fEventsJJ !
.JJ! "
DisposeJJ" )
(JJ) *
)JJ* +
;JJ+ ,
	m_fEventsKK !
=KK" #
nullKK$ (
;KK( )
}LL 
m_fPipeNN 
=NN 
nullNN "
;NN" #
}OO 

m_disposedQQ 
=QQ 
trueQQ !
;QQ! "
}RR 
}SS 	
public[[ 
void[[ 
Dispose[[ 
([[ 
)\\ 
{]] 	
	myDispose^^ 
(^^ 
true^^ 
)^^ 
;^^ 
GC__ 
.__ 
SuppressFinalize__ 
(__  
this__  $
)__$ %
;__% &
}`` 	
publichh 
inthh 

eventCounthh 
{ii 	
getjj 
{kk 
tryll 
{mm 
returnnn 
	m_fEventsnn $
.nn$ %
countnn% *
;nn* +
}oo 
catchpp 
(pp 
	Exceptionpp  
expp! #
)pp# $
{qq 
FDebugrr 
.rr 
throwExceptionrr )
(rr) *
exrr* ,
)rr, -
;rr- .
}ss 
finallytt 
{uu 
}ww 
returnxx 
$numxx 
;xx 
}yy 
}zz 	
public~~ 
bool~~ $
isCompletedEventHandling~~ ,
{ 	
get
€€ 
{
 
try
‚‚ 
{
ƒƒ 
if
„„ 
(
„„ 
this
„„ 
.
„„ 

eventCount
„„ '
==
„„( *
$num
„„+ ,
&&
„„- /(
m_isCompletedEventHandling
„„0 J
)
„„J K
{
…… 
return
†† 
true
†† #
;
††# $
}
‡‡ 
return
ˆˆ 
false
ˆˆ  
;
ˆˆ  !
}
‰‰ 
catch
ŠŠ 
(
ŠŠ 
	Exception
ŠŠ  
ex
ŠŠ! #
)
ŠŠ# $
{
‹‹ 
FDebug
ŒŒ 
.
ŒŒ 
throwException
ŒŒ )
(
ŒŒ) *
ex
ŒŒ* ,
)
ŒŒ, -
;
ŒŒ- .
}
 
finally
 
{
 
}
‘‘ 
return
’’ 
false
’’ 
;
’’ 
}
““ 
}
”” 	
private
œœ 
void
œœ 
init
œœ 
(
œœ 
)
 
{
 	
try
ŸŸ 
{
   (
m_isCompletedEventHandling
¡¡ *
=
¡¡+ ,
true
¡¡- 1
;
¡¡1 2
m_fEventPusher
¢¢ 
=
¢¢  
new
¢¢! $
FThread
¢¢% ,
(
¢¢, -
$str
¢¢- D
,
¢¢D E
false
¢¢F K
,
¢¢K L
System
¢¢M S
.
¢¢S T
	Threading
¢¢T ]
.
¢¢] ^
ThreadPriority
¢¢^ l
.
¢¢l m
Normal
¢¢m s
,
¢¢s t
false
¢¢u z
)
¢¢z {
;
¢¢{ |
m_fEventPusher
££ 
.
££ 
ThreadJobCalled
££ .
+=
££/ 1
new
££2 5*
FThreadJobCalledEventHandler
££6 R
(
££R S,
m_fEventPusher_ThreadJobCalled
££S q
)
££q r
;
££r s
m_fEventPusher
¤¤ 
.
¤¤ 
start
¤¤ $
(
¤¤$ %
)
¤¤% &
;
¤¤& '
}
¥¥ 
catch
¦¦ 
(
¦¦ 
	Exception
¦¦ 
ex
¦¦ 
)
¦¦  
{
§§ 
FDebug
¨¨ 
.
¨¨ 
throwException
¨¨ %
(
¨¨% &
ex
¨¨& (
)
¨¨( )
;
¨¨) *
}
©© 
finally
ªª 
{
«« 
}
­­ 
}
®® 	
private
²² 
void
²² 
term
²² 
(
²² 
)
³³ 
{
´´ 	
try
µµ 
{
¶¶ 
if
·· 
(
·· 
m_fEventPusher
·· "
!=
··# %
null
··& *
)
··* +
{
¸¸ 
while
¹¹ 
(
¹¹ 
!
¹¹ 
this
¹¹  
.
¹¹  !&
isCompletedEventHandling
¹¹! 9
)
¹¹9 :
{
ºº 
System
»» 
.
»» 
	Threading
»» (
.
»»( )
Thread
»») /
.
»»/ 0
Sleep
»»0 5
(
»»5 6
$num
»»6 8
)
»»8 9
;
»»9 :
}
¼¼ 
m_fEventPusher
ÀÀ "
.
ÀÀ" #
ThreadJobCalled
ÀÀ# 2
-=
ÀÀ3 5
new
ÀÀ6 9*
FThreadJobCalledEventHandler
ÀÀ: V
(
ÀÀV W,
m_fEventPusher_ThreadJobCalled
ÀÀW u
)
ÀÀu v
;
ÀÀv w
m_fEventPusher
ÂÂ "
.
ÂÂ" #
stop
ÂÂ# '
(
ÂÂ' (
)
ÂÂ( )
;
ÂÂ) *
m_fEventPusher
ÃÃ "
.
ÃÃ" #
Dispose
ÃÃ# *
(
ÃÃ* +
)
ÃÃ+ ,
;
ÃÃ, -
m_fEventPusher
ÄÄ "
=
ÄÄ# $
null
ÄÄ% )
;
ÄÄ) *
}
ÅÅ 
}
ÆÆ 
catch
ÇÇ 
(
ÇÇ 
	Exception
ÇÇ 
ex
ÇÇ 
)
ÇÇ  
{
ÈÈ 
FDebug
ÉÉ 
.
ÉÉ 
throwException
ÉÉ %
(
ÉÉ% &
ex
ÉÉ& (
)
ÉÉ( )
;
ÉÉ) *
}
ÊÊ 
finally
ËË 
{
ÌÌ 
}
ÎÎ 
}
ÏÏ 	
public
ÓÓ 
void
ÓÓ 
	pushEvent
ÓÓ 
(
ÓÓ  
FPipeEventArgsBase
ÔÔ 

fPipeEvent
ÔÔ )
)
ÕÕ 
{
ÖÖ 	
try
×× 
{
ØØ 
	m_fEvents
ÙÙ 
.
ÙÙ 
enqueue
ÙÙ !
(
ÙÙ! "

fPipeEvent
ÙÙ" ,
)
ÙÙ, -
;
ÙÙ- .
}
ÚÚ 
catch
ÛÛ 
(
ÛÛ 
	Exception
ÛÛ 
ex
ÛÛ 
)
ÛÛ  
{
ÜÜ 
FDebug
İİ 
.
İİ 
throwException
İİ %
(
İİ% &
ex
İİ& (
)
İİ( )
;
İİ) *
}
ŞŞ 
finally
ßß 
{
àà 
}
ââ 
}
ãã 	
public
çç 
void
çç 
	pushEvent
çç 
(
çç  
FPipeEventArgsBase
èè 
[
èè 
]
èè  
fPipeEvents
èè! ,
)
éé 
{
êê 	
try
ëë 
{
ìì 
	m_fEvents
íí 
.
íí 
enqueue
íí !
(
íí! "
fPipeEvents
íí" -
)
íí- .
;
íí. /
}
îî 
catch
ïï 
(
ïï 
	Exception
ïï 
ex
ïï 
)
ïï  
{
ğğ 
FDebug
ññ 
.
ññ 
throwException
ññ %
(
ññ% &
ex
ññ& (
)
ññ( )
;
ññ) *
}
òò 
finally
óó 
{
ôô 
}
öö 
}
÷÷ 	
public
ûû 
void
ûû (
waitEventHandlingCompleted
ûû .
(
ûû. /
)
üü 
{
ıı 	
try
şş 
{
ÿÿ 
while
€€ 
(
€€ 
!
€€ 
this
€€ 
.
€€ &
isCompletedEventHandling
€€ 5
)
€€5 6
{
 
if
‚‚ 
(
‚‚ 
System
‚‚ 
.
‚‚ 
Windows
‚‚ &
.
‚‚& '
Forms
‚‚' ,
.
‚‚, -
Application
‚‚- 8
.
‚‚8 9
MessageLoop
‚‚9 D
)
‚‚D E
{
ƒƒ 
System
„„ 
.
„„ 
Windows
„„ &
.
„„& '
Forms
„„' ,
.
„„, -
Application
„„- 8
.
„„8 9
DoEvents
„„9 A
(
„„A B
)
„„B C
;
„„C D
}
…… 
System
†† 
.
†† 
	Threading
†† $
.
††$ %
Thread
††% +
.
††+ ,
Sleep
††, 1
(
††1 2
$num
††2 3
)
††3 4
;
††4 5
}
‡‡ 
}
ˆˆ 
catch
‰‰ 
(
‰‰ 
	Exception
‰‰ 
ex
‰‰ 
)
‰‰  
{
ŠŠ 
FDebug
‹‹ 
.
‹‹ 
throwException
‹‹ %
(
‹‹% &
ex
‹‹& (
)
‹‹( )
;
‹‹) *
}
ŒŒ 
finally
 
{
 
}
 
}
‘‘ 	
private
™™ 
void
™™ ,
m_fEventPusher_ThreadJobCalled
™™ 3
(
™™3 4
object
šš 
sender
šš 
,
šš 
FThreadEventArgs
›› 
e
›› 
)
œœ 
{
 	 
FPipeEventArgsBase
 
args
 #
=
$ %
null
& *
;
* +
try
   
{
¡¡ 
if
¢¢ 
(
¢¢ 
	m_fEvents
¢¢ 
.
¢¢ 
count
¢¢ #
==
¢¢$ &
$num
¢¢' (
)
¢¢( )
{
££ (
m_isCompletedEventHandling
¤¤ .
=
¤¤/ 0
true
¤¤1 5
;
¤¤5 6
e
¥¥ 
.
¥¥ 
sleepThread
¥¥ !
(
¥¥! "
$num
¥¥" #
)
¥¥# $
;
¥¥$ %
return
¦¦ 
;
¦¦ 
}
§§ (
m_isCompletedEventHandling
¨¨ *
=
¨¨+ ,
false
¨¨- 2
;
¨¨2 3
while
¬¬ 
(
¬¬ 
(
¬¬ 
args
¬¬ 
=
¬¬ 
	m_fEvents
¬¬ (
.
¬¬( )
dequeue
¬¬) 0
(
¬¬0 1
)
¬¬1 2
)
¬¬2 3
!=
¬¬4 6
null
¬¬7 ;
)
¬¬; <
{
­­ 
if
®® 
(
®® 
m_fPipe
®® 
.
®®  
	fPipeType
®®  )
==
®®* ,
	FPipeType
®®- 6
.
®®6 7
Server
®®7 =
)
®®= >
{
¯¯ 
if
³³ 
(
³³ 
args
³³  
.
³³  !
fPipeEventId
³³! -
==
³³. 0
FPipeEventId
³³1 =
.
³³= >
PipeStateChanged
³³> N
)
³³N O
{
´´ 
(
µµ 
(
µµ 
FPipeServer
µµ )
)
µµ) *
m_fPipe
µµ* 1
)
µµ1 2
.
µµ2 3 
onPipeStateChanged
µµ3 E
(
µµE F
args
µµF J
)
µµJ K
;
µµK L
}
¶¶ 
else
·· 
if
·· 
(
··  !
args
··! %
.
··% &
fPipeEventId
··& 2
==
··3 5
FPipeEventId
··6 B
.
··B C
PipeDataReceived
··C S
)
··S T
{
¸¸ 
(
¹¹ 
(
¹¹ 
FPipeServer
¹¹ )
)
¹¹) *
m_fPipe
¹¹* 1
)
¹¹1 2
.
¹¹2 3 
onPipeDataReceived
¹¹3 E
(
¹¹E F
args
¹¹F J
)
¹¹J K
;
¹¹K L
}
ºº 
else
»» 
if
»» 
(
»»  !
args
»»! %
.
»»% &
fPipeEventId
»»& 2
==
»»3 5
FPipeEventId
»»6 B
.
»»B C
PipeDataSent
»»C O
)
»»O P
{
¼¼ 
(
½½ 
(
½½ 
FPipeServer
½½ )
)
½½) *
m_fPipe
½½* 1
)
½½1 2
.
½½2 3
onPipeDataSent
½½3 A
(
½½A B
args
½½B F
)
½½F G
;
½½G H
}
¾¾ 
else
¿¿ 
if
¿¿ 
(
¿¿  !
args
¿¿! %
.
¿¿% &
fPipeEventId
¿¿& 2
==
¿¿3 5
FPipeEventId
¿¿6 B
.
¿¿B C 
PipeDataSendFailed
¿¿C U
)
¿¿U V
{
ÀÀ 
(
ÁÁ 
(
ÁÁ 
FPipeServer
ÁÁ )
)
ÁÁ) *
m_fPipe
ÁÁ* 1
)
ÁÁ1 2
.
ÁÁ2 3"
onPipeDataSendFailed
ÁÁ3 G
(
ÁÁG H
args
ÁÁH L
)
ÁÁL M
;
ÁÁM N
}
ÂÂ 
else
ÃÃ 
if
ÃÃ 
(
ÃÃ  !
args
ÃÃ! %
.
ÃÃ% &
fPipeEventId
ÃÃ& 2
==
ÃÃ3 5
FPipeEventId
ÃÃ6 B
.
ÃÃB C
PipeErrorRaised
ÃÃC R
)
ÃÃR S
{
ÄÄ 
(
ÅÅ 
(
ÅÅ 
FPipeServer
ÅÅ )
)
ÅÅ) *
m_fPipe
ÅÅ* 1
)
ÅÅ1 2
.
ÅÅ2 3
onPipeErrorRaised
ÅÅ3 D
(
ÅÅD E
args
ÅÅE I
)
ÅÅI J
;
ÅÅJ K
}
ÆÆ 
}
ÇÇ 
else
ÈÈ 
{
ÉÉ 
if
ÍÍ 
(
ÍÍ 
args
ÍÍ  
.
ÍÍ  !
fPipeEventId
ÍÍ! -
==
ÍÍ. 0
FPipeEventId
ÍÍ1 =
.
ÍÍ= >
PipeStateChanged
ÍÍ> N
)
ÍÍN O
{
ÎÎ 
(
ÏÏ 
(
ÏÏ 
FPipeClient
ÏÏ )
)
ÏÏ) *
m_fPipe
ÏÏ* 1
)
ÏÏ1 2
.
ÏÏ2 3 
onPipeStateChanged
ÏÏ3 E
(
ÏÏE F
args
ÏÏF J
)
ÏÏJ K
;
ÏÏK L
}
ĞĞ 
else
ÑÑ 
if
ÑÑ 
(
ÑÑ  !
args
ÑÑ! %
.
ÑÑ% &
fPipeEventId
ÑÑ& 2
==
ÑÑ3 5
FPipeEventId
ÑÑ6 B
.
ÑÑB C
PipeDataReceived
ÑÑC S
)
ÑÑS T
{
ÒÒ 
(
ÓÓ 
(
ÓÓ 
FPipeClient
ÓÓ )
)
ÓÓ) *
m_fPipe
ÓÓ* 1
)
ÓÓ1 2
.
ÓÓ2 3 
onPipeDataReceived
ÓÓ3 E
(
ÓÓE F
args
ÓÓF J
)
ÓÓJ K
;
ÓÓK L
}
ÔÔ 
else
ÕÕ 
if
ÕÕ 
(
ÕÕ  !
args
ÕÕ! %
.
ÕÕ% &
fPipeEventId
ÕÕ& 2
==
ÕÕ3 5
FPipeEventId
ÕÕ6 B
.
ÕÕB C
PipeDataSent
ÕÕC O
)
ÕÕO P
{
ÖÖ 
(
×× 
(
×× 
FPipeClient
×× )
)
××) *
m_fPipe
××* 1
)
××1 2
.
××2 3
onPipeDataSent
××3 A
(
××A B
args
××B F
)
××F G
;
××G H
}
ØØ 
else
ÙÙ 
if
ÙÙ 
(
ÙÙ  !
args
ÙÙ! %
.
ÙÙ% &
fPipeEventId
ÙÙ& 2
==
ÙÙ3 5
FPipeEventId
ÙÙ6 B
.
ÙÙB C 
PipeDataSendFailed
ÙÙC U
)
ÙÙU V
{
ÚÚ 
(
ÛÛ 
(
ÛÛ 
FPipeClient
ÛÛ )
)
ÛÛ) *
m_fPipe
ÛÛ* 1
)
ÛÛ1 2
.
ÛÛ2 3"
onPipeDataSendFailed
ÛÛ3 G
(
ÛÛG H
args
ÛÛH L
)
ÛÛL M
;
ÛÛM N
}
ÜÜ 
else
İİ 
if
İİ 
(
İİ  !
args
İİ! %
.
İİ% &
fPipeEventId
İİ& 2
==
İİ3 5
FPipeEventId
İİ6 B
.
İİB C
PipeErrorRaised
İİC R
)
İİR S
{
ŞŞ 
(
ßß 
(
ßß 
FPipeClient
ßß )
)
ßß) *
m_fPipe
ßß* 1
)
ßß1 2
.
ßß2 3
onPipeErrorRaised
ßß3 D
(
ßßD E
args
ßßE I
)
ßßI J
;
ßßJ K
}
àà 
}
áá 
}
ââ 
}
ãã 
catch
ää 
(
ää 
	Exception
ää 
ex
ää 
)
ää  
{
åå 
FDebug
ææ 
.
ææ 
writeLog
ææ 
(
ææ  
ex
ææ  "
)
ææ" #
;
ææ# $
}
çç 
finally
èè 
{
éé 
args
êê 
=
êê 
null
êê 
;
êê 
}
ëë 
}
ìì 	
}
òò 
}óó Ù(
iD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Pipe\c_FPipeDataReceivedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
Serializable 
] 
public 

class &
FPipeDataReceivedEventArgs +
:, -
FPipeEventArgsBase. @
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FIPipe 
m_fOwnerPipe #
=$ %
null& *
;* +
private 
byte 
[ 
] 
m_data 
= 
null  $
;$ %
internal## &
FPipeDataReceivedEventArgs## +
(##+ ,
FIPipe$$ 

fOwnerPipe$$ 
,$$ 
byte%% 
[%% 
]%% 
data%% 
)&& 
:'' 
base'' 
('' 
FPipeEventId''  
.''  !
PipeDataReceived''! 1
)''1 2
{(( 	
m_fOwnerPipe)) 
=)) 

fOwnerPipe)) %
;))% &
m_data** 
=** 
data** 
;** 
}++ 	
~// 	&
FPipeDataReceivedEventArgs//	 #
(//# $
)00 
{11 	
	myDispose22 
(22 
false22 
)22 
;22 
}33 	
	protected77 
override77 
void77 
	myDispose77  )
(77) *
bool88 
	disposing88 
)99 
{:: 	
if;; 
(;; 
!;; 

m_disposed;; 
);; 
{<< 
if== 
(== 
	disposing== 
)== 
{>> 
m_fOwnerPipe??  
=??! "
null??# '
;??' (
}@@ 

m_disposedAA 
=AA 
trueAA !
;AA! "
baseEE 
.EE 
	myDisposeEE 
(EE 
	disposingEE (
)EE( )
;EE) *
}FF 
}GG 	
publicOO 
FIPipeOO 

fOwnerPipeOO  
{PP 	
getQQ 
{RR 
trySS 
{TT 
returnUU 
m_fOwnerPipeUU '
;UU' (
}VV 
catchWW 
(WW 
	ExceptionWW  
exWW! #
)WW# $
{XX 
FDebugYY 
.YY 
throwExceptionYY )
(YY) *
exYY* ,
)YY, -
;YY- .
}ZZ 
finally[[ 
{\\ 
}^^ 
return__ 
null__ 
;__ 
}`` 
}aa 	
publicee 
byteee 
[ee 
]ee 
dataee 
{ff 	
getgg 
{hh 
tryii 
{jj 
returnkk 
m_datakk !
;kk! "
}ll 
catchmm 
(mm 
	Exceptionmm  
exmm! #
)mm# $
{nn 
FDebugoo 
.oo 
throwExceptionoo )
(oo) *
exoo* ,
)oo, -
;oo- .
}pp 
finallyqq 
{rr 
}tt 
returnuu 
nulluu 
;uu 
}vv 
}ww 	
public{{ 
int{{ 

dataLength{{ 
{|| 	
get}} 
{~~ 
try 
{
€€ 
return
 
m_data
 !
.
! "
Length
" (
;
( )
}
‚‚ 
catch
ƒƒ 
(
ƒƒ 
	Exception
ƒƒ  
ex
ƒƒ! #
)
ƒƒ# $
{
„„ 
FDebug
…… 
.
…… 
throwException
…… )
(
……) *
ex
……* ,
)
……, -
;
……- .
}
†† 
finally
‡‡ 
{
ˆˆ 
}
ŠŠ 
return
‹‹ 
$num
‹‹ 
;
‹‹ 
}
ŒŒ 
}
 	
public
•• 
string
•• 
dataToString
•• "
(
••" #
)
–– 
{
—— 	
try
˜˜ 
{
™™ 
if
šš 
(
šš 
m_data
šš 
==
šš 
null
šš "
)
šš" #
{
›› 
return
œœ 
string
œœ !
.
œœ! "
Empty
œœ" '
;
œœ' (
}
 
return
 
Encoding
 
.
  
Default
  '
.
' (
	GetString
( 1
(
1 2
m_data
2 8
)
8 9
;
9 :
}
ŸŸ 
catch
   
(
   
	Exception
   
ex
   
)
    
{
¡¡ 
FDebug
¢¢ 
.
¢¢ 
throwException
¢¢ %
(
¢¢% &
ex
¢¢& (
)
¢¢( )
;
¢¢) *
}
££ 
finally
¤¤ 
{
¥¥ 
}
§§ 
return
¨¨ 
string
¨¨ 
.
¨¨ 
Empty
¨¨ 
;
¨¨  
}
©© 	
}
¯¯ 
}°° š/
eD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Pipe\c_FPipeDataSentEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
Serializable 
] 
public 

class "
FPipeDataSentEventArgs '
:( )
FPipeEventArgsBase* <
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FIPipe 
m_fOwnerPipe #
=$ %
null& *
;* +
private 
FPipeSendData 
m_fData %
=& '
null( ,
;, -
internal## "
FPipeDataSentEventArgs## '
(##' (
FIPipe$$ 

fOwnerPipe$$ 
,$$ 
FPipeSendData%% 
fData%% 
)&& 
:'' 
base'' 
('' 
FPipeEventId''  
.''  !
PipeDataSent''! -
)''- .
{(( 	
m_fOwnerPipe)) 
=)) 

fOwnerPipe)) %
;))% &
m_fData** 
=** 
fData** 
;** 
}++ 	
~// 	"
FPipeDataSentEventArgs//	 
(//  
)00 
{11 	
	myDispose22 
(22 
false22 
)22 
;22 
}33 	
	protected77 
override77 
void77 
	myDispose77  )
(77) *
bool88 
	disposing88 
)99 
{:: 	
if;; 
(;; 
!;; 

m_disposed;; 
);; 
{<< 
if== 
(== 
	disposing== 
)== 
{>> 
m_fOwnerPipe??  
=??! "
null??# '
;??' (
}@@ 

m_disposedAA 
=AA 
trueAA !
;AA! "
baseEE 
.EE 
	myDisposeEE 
(EE 
	disposingEE (
)EE( )
;EE) *
}FF 
}GG 	
publicOO 
FIPipeOO 

fOwnerPipeOO  
{PP 	
getQQ 
{RR 
trySS 
{TT 
returnUU 
m_fOwnerPipeUU '
;UU' (
}VV 
catchWW 
(WW 
	ExceptionWW  
exWW! #
)WW# $
{XX 
FDebugYY 
.YY 
throwExceptionYY )
(YY) *
exYY* ,
)YY, -
;YY- .
}ZZ 
finally[[ 
{\\ 
}^^ 
return__ 
null__ 
;__ 
}`` 
}aa 	
publicee 
FPipeSendDataee 
fDataee "
{ff 	
getgg 
{hh 
tryii 
{jj 
returnkk 
m_fDatakk "
;kk" #
}ll 
catchmm 
(mm 
	Exceptionmm  
exmm! #
)mm# $
{nn 
FDebugoo 
.oo 
throwExceptionoo )
(oo) *
exoo* ,
)oo, -
;oo- .
}pp 
finallyqq 
{rr 
}tt 
returnuu 
nulluu 
;uu 
}vv 
}ww 	
public{{ 
byte{{ 
[{{ 
]{{ 
data{{ 
{|| 	
get}} 
{~~ 
try 
{
€€ 
return
 
m_fData
 "
.
" #
data
# '
;
' (
}
‚‚ 
catch
ƒƒ 
(
ƒƒ 
	Exception
ƒƒ  
ex
ƒƒ! #
)
ƒƒ# $
{
„„ 
FDebug
…… 
.
…… 
throwException
…… )
(
……) *
ex
……* ,
)
……, -
;
……- .
}
†† 
finally
‡‡ 
{
ˆˆ 
}
ŠŠ 
return
‹‹ 
null
‹‹ 
;
‹‹ 
}
ŒŒ 
}
 	
public
‘‘ 
int
‘‘ 

dataLength
‘‘ 
{
’’ 	
get
““ 
{
”” 
try
•• 
{
–– 
return
—— 
m_fData
—— "
.
——" #
data
——# '
.
——' (
Length
——( .
;
——. /
}
˜˜ 
catch
™™ 
(
™™ 
	Exception
™™  
ex
™™! #
)
™™# $
{
šš 
FDebug
›› 
.
›› 
throwException
›› )
(
››) *
ex
››* ,
)
››, -
;
››- .
}
œœ 
finally
 
{
 
}
   
return
¡¡ 
$num
¡¡ 
;
¡¡ 
}
¢¢ 
}
££ 	
public
«« 
string
«« 
dataToString
«« "
(
««" #
)
¬¬ 
{
­­ 	
try
®® 
{
¯¯ 
if
°° 
(
°° 
m_fData
°° 
==
°° 
null
°° #
||
°°$ &
m_fData
°°' .
.
°°. /
data
°°/ 3
==
°°4 6
null
°°7 ;
)
°°; <
{
±± 
return
²² 
string
²² !
.
²²! "
Empty
²²" '
;
²²' (
}
³³ 
return
´´ 
Encoding
´´ 
.
´´  
Default
´´  '
.
´´' (
	GetString
´´( 1
(
´´1 2
m_fData
´´2 9
.
´´9 :
data
´´: >
)
´´> ?
;
´´? @
}
µµ 
catch
¶¶ 
(
¶¶ 
	Exception
¶¶ 
ex
¶¶ 
)
¶¶  
{
·· 
FDebug
¸¸ 
.
¸¸ 
throwException
¸¸ %
(
¸¸% &
ex
¸¸& (
)
¸¸( )
;
¸¸) *
}
¹¹ 
finally
ºº 
{
»» 
}
½½ 
return
¾¾ 
string
¾¾ 
.
¾¾ 
Empty
¾¾ 
;
¾¾  
}
¿¿ 	
}
ÅÅ 
}ÆÆ ë"
hD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Pipe\c_FPipeErrorRaisedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
Serializable 
] 
public 

class %
FPipeErrorRaisedEventArgs *
:+ ,
FPipeEventArgsBase- ?
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FIPipe 
m_fOwnerPipe #
=$ %
null& *
;* +
private 
string 
	m_message  
=! "
string# )
.) *
Empty* /
;/ 0
private 
	Exception 
m_exception %
=& '
null( ,
;, -
internal%% %
FPipeErrorRaisedEventArgs%% *
(%%* +
FIPipe&& 

fOwnerPipe&& 
,&& 
string'' 
message'' 
,'' 
	Exception(( 
	exception(( 
))) 
:** 
base** 
(** 
FPipeEventId**  
.**  !
PipeErrorRaised**! 0
)**0 1
{++ 	
m_fOwnerPipe,, 
=,, 

fOwnerPipe,, %
;,,% &
	m_message-- 
=-- 
message-- 
;--  
m_exception.. 
=.. 
	exception.. #
;..# $
}// 	
~33 	%
FPipeErrorRaisedEventArgs33	 "
(33" #
)44 
{55 	
	myDispose66 
(66 
false66 
)66 
;66 
}77 	
	protected;; 
override;; 
void;; 
	myDispose;;  )
(;;) *
bool<< 
	disposing<< 
)== 
{>> 	
if?? 
(?? 
!?? 

m_disposed?? 
)?? 
{@@ 
ifAA 
(AA 
	disposingAA 
)AA 
{BB 
m_fOwnerPipeCC  
=CC! "
nullCC# '
;CC' (
m_exceptionDD 
=DD  !
nullDD" &
;DD& '
}EE 

m_disposedFF 
=FF 
trueFF !
;FF! "
baseJJ 
.JJ 
	myDisposeJJ 
(JJ 
	disposingJJ (
)JJ( )
;JJ) *
}KK 
}LL 	
publicTT 
FIPipeTT 

fOwnerPipeTT  
{UU 	
getVV 
{WW 
tryXX 
{YY 
returnZZ 
m_fOwnerPipeZZ '
;ZZ' (
}[[ 
catch\\ 
(\\ 
	Exception\\  
ex\\! #
)\\# $
{]] 
FDebug^^ 
.^^ 
throwException^^ )
(^^) *
ex^^* ,
)^^, -
;^^- .
}__ 
finally`` 
{aa 
}cc 
returndd 
nulldd 
;dd 
}ee 
}ff 	
publicjj 
stringjj 
messagejj 
{kk 	
getll 
{mm 
trynn 
{oo 
returnpp 
	m_messagepp $
;pp$ %
}qq 
catchrr 
(rr 
	Exceptionrr  
exrr! #
)rr# $
{ss 
FDebugtt 
.tt 
throwExceptiontt )
(tt) *
extt* ,
)tt, -
;tt- .
}uu 
finallyvv 
{ww 
}yy 
returnzz 
stringzz 
.zz 
Emptyzz #
;zz# $
}{{ 
}|| 	
public
€€ 
	Exception
€€ 
	exception
€€ "
{
 	
get
‚‚ 
{
ƒƒ 
try
„„ 
{
…… 
return
†† 
m_exception
†† &
;
††& '
}
‡‡ 
catch
ˆˆ 
(
ˆˆ 
	Exception
ˆˆ  
ex
ˆˆ! #
)
ˆˆ# $
{
‰‰ 
FDebug
ŠŠ 
.
ŠŠ 
throwException
ŠŠ )
(
ŠŠ) *
ex
ŠŠ* ,
)
ŠŠ, -
;
ŠŠ- .
}
‹‹ 
finally
ŒŒ 
{
 
}
 
return
 
null
 
;
 
}
‘‘ 
}
’’ 	
}
 
}ŸŸ 7
kD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Pipe\c_FPipeDataSendFailedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
Serializable 
] 
public 

class (
FPipeDataSendFailedEventArgs -
:. /
FPipeEventArgsBase0 B
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FIPipe 
m_fOwnerPipe #
=$ %
null& *
;* +
private 
FPipeSendData 
m_fData %
=& '
null( ,
;, -
private 
string 
	m_message  
=! "
string# )
.) *
Empty* /
;/ 0
internal$$ (
FPipeDataSendFailedEventArgs$$ -
($$- .
FIPipe%% 

fOwnerPipe%% 
,%% 
FPipeSendData&& 
fData&& 
,&&  
string'' 
message'' 
)(( 
:)) 
base)) 
()) 
FPipeEventId))  
.))  !
PipeDataSendFailed))! 3
)))3 4
{** 	
m_fOwnerPipe++ 
=++ 

fOwnerPipe++ %
;++% &
m_fData,, 
=,, 
fData,, 
;,, 
	m_message-- 
=-- 
message-- 
;--  
}.. 	
~22 	(
FPipeDataSendFailedEventArgs22	 %
(22% &
)33 
{44 	
	myDispose55 
(55 
false55 
)55 
;55 
}66 	
	protected:: 
override:: 
void:: 
	myDispose::  )
(::) *
bool;; 
	disposing;; 
)<< 
{== 	
if>> 
(>> 
!>> 

m_disposed>> 
)>> 
{?? 
if@@ 
(@@ 
	disposing@@ 
)@@ 
{AA 
m_fOwnerPipeBB  
=BB! "
nullBB# '
;BB' (
}CC 

m_disposedDD 
=DD 
trueDD !
;DD! "
baseHH 
.HH 
	myDisposeHH 
(HH 
	disposingHH (
)HH( )
;HH) *
}II 
}JJ 	
publicRR 
FIPipeRR 

fOwnerPipeRR  
{SS 	
getTT 
{UU 
tryVV 
{WW 
returnXX 
m_fOwnerPipeXX '
;XX' (
}YY 
catchZZ 
(ZZ 
	ExceptionZZ  
exZZ! #
)ZZ# $
{[[ 
FDebug\\ 
.\\ 
throwException\\ )
(\\) *
ex\\* ,
)\\, -
;\\- .
}]] 
finally^^ 
{__ 
}aa 
returnbb 
nullbb 
;bb 
}cc 
}dd 	
publichh 
FPipeSendDatahh 
fDatahh "
{ii 	
getjj 
{kk 
tryll 
{mm 
returnnn 
m_fDatann "
;nn" #
}oo 
catchpp 
(pp 
	Exceptionpp  
expp! #
)pp# $
{qq 
FDebugrr 
.rr 
throwExceptionrr )
(rr) *
exrr* ,
)rr, -
;rr- .
}ss 
finallytt 
{uu 
}ww 
returnxx 
nullxx 
;xx 
}yy 
}zz 	
public~~ 
byte~~ 
[~~ 
]~~ 
data~~ 
{ 	
get
€€ 
{
 
try
‚‚ 
{
ƒƒ 
return
„„ 
m_fData
„„ "
.
„„" #
data
„„# '
;
„„' (
}
…… 
catch
†† 
(
†† 
	Exception
††  
ex
††! #
)
††# $
{
‡‡ 
FDebug
ˆˆ 
.
ˆˆ 
throwException
ˆˆ )
(
ˆˆ) *
ex
ˆˆ* ,
)
ˆˆ, -
;
ˆˆ- .
}
‰‰ 
finally
ŠŠ 
{
‹‹ 
}
 
return
 
null
 
;
 
}
 
}
 	
public
”” 
int
”” 

dataLength
”” 
{
•• 	
get
–– 
{
—— 
try
˜˜ 
{
™™ 
return
šš 
m_fData
šš "
.
šš" #
data
šš# '
.
šš' (
Length
šš( .
;
šš. /
}
›› 
catch
œœ 
(
œœ 
	Exception
œœ  
ex
œœ! #
)
œœ# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
ŸŸ 
finally
   
{
¡¡ 
}
££ 
return
¤¤ 
$num
¤¤ 
;
¤¤ 
}
¥¥ 
}
¦¦ 	
public
ªª 
string
ªª 
message
ªª 
{
«« 	
get
¬¬ 
{
­­ 
try
®® 
{
¯¯ 
return
°° 
	m_message
°° $
;
°°$ %
}
±± 
catch
²² 
(
²² 
	Exception
²²  
ex
²²! #
)
²²# $
{
³³ 
FDebug
´´ 
.
´´ 
throwException
´´ )
(
´´) *
ex
´´* ,
)
´´, -
;
´´- .
}
µµ 
finally
¶¶ 
{
·· 
}
¹¹ 
return
ºº 
string
ºº 
.
ºº 
Empty
ºº #
;
ºº# $
}
»» 
}
¼¼ 	
public
ÄÄ 
string
ÄÄ 
dataToString
ÄÄ "
(
ÄÄ" #
)
ÅÅ 
{
ÆÆ 	
try
ÇÇ 
{
ÈÈ 
if
ÉÉ 
(
ÉÉ 
m_fData
ÉÉ 
==
ÉÉ 
null
ÉÉ #
||
ÉÉ$ &
m_fData
ÉÉ' .
.
ÉÉ. /
data
ÉÉ/ 3
==
ÉÉ4 6
null
ÉÉ7 ;
)
ÉÉ; <
{
ÊÊ 
return
ËË 
string
ËË !
.
ËË! "
Empty
ËË" '
;
ËË' (
}
ÌÌ 
return
ÍÍ 
Encoding
ÍÍ 
.
ÍÍ  
Default
ÍÍ  '
.
ÍÍ' (
	GetString
ÍÍ( 1
(
ÍÍ1 2
m_fData
ÍÍ2 9
.
ÍÍ9 :
data
ÍÍ: >
)
ÍÍ> ?
;
ÍÍ? @
}
ÎÎ 
catch
ÏÏ 
(
ÏÏ 
	Exception
ÏÏ 
ex
ÏÏ 
)
ÏÏ  
{
ĞĞ 
FDebug
ÑÑ 
.
ÑÑ 
throwException
ÑÑ %
(
ÑÑ% &
ex
ÑÑ& (
)
ÑÑ( )
;
ÑÑ) *
}
ÒÒ 
finally
ÓÓ 
{
ÔÔ 
}
ÖÖ 
return
×× 
string
×× 
.
×× 
Empty
×× 
;
××  
}
ØØ 	
}
ŞŞ 
}ßß Ê
UD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Pipe\i_FIPipe.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

	interface 
FIPipe 
{ 
	FPipeType 
	fPipeType 
{ 	
get 
; 
} 	
}** 
}++ ·
lD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Resource\c_FProcessResourceEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class %
FProcessResourceEventArgs *
:+ ,
IDisposable- 8
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private &
FProcessResourceCollection *
m_fProcResCol+ 8
=9 :
null; ?
;? @
public!! %
FProcessResourceEventArgs!! (
(!!( )&
FProcessResourceCollection"" &
fProcResCol""' 2
)## 
{$$ 	
m_fProcResCol%% 
=%% 
fProcResCol%% '
;%%' (
}&& 	
~** 	%
FProcessResourceEventArgs**	 "
(**" #
)++ 
{,, 	
	myDispose-- 
(-- 
false-- 
)-- 
;-- 
}.. 	
	protected22 
void22 
	myDispose22  
(22  !
bool33 
	disposing33 
)44 
{55 	
if66 
(66 
!66 

m_disposed66 
)66 
{77 
if88 
(88 
	disposing88 
)88 
{99 
m_fProcResCol:: !
=::" #
null::$ (
;::( )
};; 

m_disposed== 
=== 
true== !
;==! "
}>> 
}?? 	
publicGG 
voidGG 
DisposeGG 
(GG 
)HH 
{II 	
	myDisposeJJ 
(JJ 
trueJJ 
)JJ 
;JJ 
GCKK 
.KK 
SuppressFinalizeKK 
(KK  
thisKK  $
)KK$ %
;KK% &
}LL 	
publicTT &
FProcessResourceCollectionTT )
processNameTT* 5
{UU 	
getVV 
{WW 
tryXX 
{YY 
returnZZ 
m_fProcResColZZ (
;ZZ( )
}[[ 
catch\\ 
(\\ 
	Exception\\  
ex\\! #
)\\# $
{]] 
FDebug^^ 
.^^ 
throwException^^ )
(^^) *
ex^^* ,
)^^, -
;^^- .
}__ 
finally`` 
{aa 
}cc 
returndd 
nulldd 
;dd 
}ee 
}ff 	
}ss 
}tt “'
_D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Resource\c_FLogicalDisk.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FLogicalDisk 
: 
IDisposable  +
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
string 

m_deviceId !
=" #
string$ *
.* +
Empty+ 0
;0 1
private 
double 
m_freeSpace "
=# $
double% +
.+ ,
NaN, /
;/ 0
private 
double 
m_size 
= 
double  &
.& '
NaN' *
;* +
public$$ 
FLogicalDisk$$ 
($$ 
string%% 
deviceId%% 
)&& 
{'' 	

m_deviceId(( 
=(( 
deviceId(( !
;((! "
})) 	
~-- 	
FLogicalDisk--	 
(-- 
).. 
{// 	
	myDispose00 
(00 
false00 
)00 
;00 
}11 	
	protected55 
void55 
	myDispose55  
(55  !
bool66 
	disposing66 
)77 
{88 	
if99 
(99 
!99 

m_disposed99 
)99 
{:: 
if;; 
(;; 
	disposing;; 
);; 
{<< 
}>> 

m_disposed@@ 
=@@ 
true@@ !
;@@! "
}AA 
}BB 	
publicJJ 
voidJJ 
DisposeJJ 
(JJ 
)KK 
{LL 	
	myDisposeMM 
(MM 
trueMM 
)MM 
;MM 
GCNN 
.NN 
SuppressFinalizeNN 
(NN  
thisNN  $
)NN$ %
;NN% &
}OO 	
publicWW 
stringWW 
devceIdWW 
{XX 	
getYY 
{ZZ 
try[[ 
{\\ 
return]] 

m_deviceId]] %
;]]% &
}^^ 
catch__ 
(__ 
	Exception__  
ex__! #
)__# $
{`` 
FDebugaa 
.aa 
throwExceptionaa )
(aa) *
exaa* ,
)aa, -
;aa- .
}bb 
finallycc 
{dd 
}ff 
returngg 
nullgg 
;gg 
}hh 
}ii 	
publicmm 
doublemm 
	freeSpacemm 
{nn 	
getoo 
{pp 
tryqq 
{rr 
returnss 
m_freeSpacess &
;ss& '
}tt 
catchuu 
(uu 
	Exceptionuu  
exuu! #
)uu# $
{vv 
FDebugww 
.ww 
throwExceptionww )
(ww) *
exww* ,
)ww, -
;ww- .
}xx 
finallyyy 
{zz 
}|| 
return}} 
$num}} 
;}} 
}~~ 
set
€€ 
{
 
try
‚‚ 
{
ƒƒ 
m_freeSpace
„„ 
=
„„  !
value
„„" '
;
„„' (
}
…… 
catch
†† 
(
†† 
	Exception
††  
ex
††! #
)
††# $
{
‡‡ 
FDebug
ˆˆ 
.
ˆˆ 
throwException
ˆˆ )
(
ˆˆ) *
ex
ˆˆ* ,
)
ˆˆ, -
;
ˆˆ- .
}
‰‰ 
finally
ŠŠ 
{
‹‹ 
}
 
}
 
}
 	
public
““ 
double
““ 
size
““ 
{
”” 	
get
•• 
{
–– 
try
—— 
{
˜˜ 
return
™™ 
m_size
™™ !
;
™™! "
}
šš 
catch
›› 
(
›› 
	Exception
››  
ex
››! #
)
››# $
{
œœ 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
ŸŸ 
{
   
}
¢¢ 
return
££ 
$num
££ 
;
££ 
}
¤¤ 
set
¦¦ 
{
§§ 
try
¨¨ 
{
©© 
m_size
ªª 
=
ªª 
value
ªª "
;
ªª" #
}
«« 
catch
¬¬ 
(
¬¬ 
	Exception
¬¬  
ex
¬¬! #
)
¬¬# $
{
­­ 
FDebug
®® 
.
®® 
throwException
®® )
(
®®) *
ex
®®* ,
)
®®, -
;
®®- .
}
¯¯ 
finally
°° 
{
±± 
}
³³ 
}
´´ 
}
µµ 	
}
ÁÁ 
}ÂÂ è´
kD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Resource\c_FSystemResourceCollector.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class $
FSystemResourceCollector )
:* +
IDisposable, 7
{ 
public 
event '
FSystemResourceEventHandler 0 
ResourceDataReceived1 E
=F G
nullH L
;L M
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FThread 
m_fThdPusher $
=% &
null' +
;+ ,
private   
FStaticTimer   
m_fTmrPusher   )
=  * +
null  , 0
;  0 1
private!! 
ManagementScope!! 
m_scope!!  '
=!!( )
null!!* .
;!!. /
private"" 
PerformanceCounter"" "
m_perfCounter""# 0
=""1 2
null""3 7
;""7 8
private$$ 
string$$ 
m_cpu$$ 
=$$ 
string$$ %
.$$% &
Empty$$& +
;$$+ ,
private%% 
List%% 
<%% 
double%% 
>%% 
m_cpuUsageList%% +
=%%, -
null%%. 2
;%%2 3
private&& 
double&& 
m_memory&& 
=&&  !
double&&" (
.&&( )
NaN&&) ,
;&&, -
private'' 
double'' 
m_memoryFreeSize'' '
=''( )
double''* 0
.''0 1
NaN''1 4
;''4 5
private(( "
FLogicalDiskCollection(( &
m_fLogicalDiskCol((' 8
=((9 :
null((; ?
;((? @
private** 
int** 

m_interval** 
=**  
$num**! "
;**" #
public00 $
FSystemResourceCollector00 '
(00' (
)11 
{22 	
init33 
(33 
)33 
;33 
}44 	
~88 	$
FSystemResourceCollector88	 !
(88! "
)99 
{:: 	
	myDispose;; 
(;; 
false;; 
);; 
;;; 
}<< 	
	protected@@ 
void@@ 
	myDispose@@  
(@@  !
boolAA 
	disposingAA 
)BB 
{CC 	
ifDD 
(DD 
!DD 

m_disposedDD 
)DD 
{EE 
ifFF 
(FF 
	disposingFF 
)FF 
{GG 
termHH 
(HH 
)HH 
;HH 
m_scopeJJ 
=JJ 
nullJJ "
;JJ" #
m_perfCounterKK !
=KK" #
nullKK$ (
;KK( )
m_fLogicalDiskColLL %
=LL& '
nullLL( ,
;LL, -
m_cpuUsageListMM "
=MM# $
nullMM% )
;MM) *
}NN 

m_disposedPP 
=PP 
truePP !
;PP! "
}QQ 
}RR 	
publicZZ 
voidZZ 
DisposeZZ 
(ZZ 
)[[ 
{\\ 	
	myDispose]] 
(]] 
true]] 
)]] 
;]] 
GC^^ 
.^^ 
SuppressFinalize^^ 
(^^  
this^^  $
)^^$ %
;^^% &
}__ 	
publicgg 
stringgg 
cpugg 
{hh 	
getii 
{jj 
trykk 
{ll 
returnmm 
m_cpumm  
;mm  !
}nn 
catchoo 
(oo 
	Exceptionoo  
exoo! #
)oo# $
{pp 
FDebugqq 
.qq 
throwExceptionqq )
(qq) *
exqq* ,
)qq, -
;qq- .
}rr 
finallyss 
{tt 
}vv 
returnww 
stringww 
.ww 
Emptyww #
;ww# $
}xx 
}yy 	
public}} 
double}} 
cpuUsage}} 
{~~ 	
get 
{
€€ 
double
 
usage
 
=
 
$num
  
;
  !
try
‚‚ 
{
ƒƒ 
if
„„ 
(
„„ 
m_cpuUsageList
„„ &
.
„„& '
Count
„„' ,
>
„„- .
$num
„„/ 0
)
„„0 1
{
…… 
usage
†† 
=
†† 
m_cpuUsageList
††  .
.
††. /
Average
††/ 6
(
††6 7
)
††7 8
;
††8 9
}
‡‡ 
return
ˆˆ 
usage
ˆˆ  
;
ˆˆ  !
}
‰‰ 
catch
ŠŠ 
(
ŠŠ 
	Exception
ŠŠ  
ex
ŠŠ! #
)
ŠŠ# $
{
‹‹ 
FDebug
ŒŒ 
.
ŒŒ 
throwException
ŒŒ )
(
ŒŒ) *
ex
ŒŒ* ,
)
ŒŒ, -
;
ŒŒ- .
}
 
finally
 
{
 
}
‘‘ 
return
’’ 
$num
’’ 
;
’’ 
}
““ 
}
”” 	
public
™™ 
double
™™ 
memory
™™ 
{
šš 	
get
›› 
{
œœ 
try
 
{
 
return
ŸŸ 
m_memory
ŸŸ #
;
ŸŸ# $
}
   
catch
¡¡ 
(
¡¡ 
	Exception
¡¡  
ex
¡¡! #
)
¡¡# $
{
¢¢ 
FDebug
££ 
.
££ 
throwException
££ )
(
££) *
ex
££* ,
)
££, -
;
££- .
}
¤¤ 
finally
¥¥ 
{
¦¦ 
}
¨¨ 
return
©© 
$num
©© 
;
©© 
}
ªª 
}
«« 	
public
¯¯ 
double
¯¯ 
memoryFreeSize
¯¯ $
{
°° 	
get
±± 
{
²² 
try
³³ 
{
´´ 
return
µµ 
m_memoryFreeSize
µµ +
;
µµ+ ,
}
¶¶ 
catch
·· 
(
·· 
	Exception
··  
ex
··! #
)
··# $
{
¸¸ 
FDebug
¹¹ 
.
¹¹ 
throwException
¹¹ )
(
¹¹) *
ex
¹¹* ,
)
¹¹, -
;
¹¹- .
}
ºº 
finally
»» 
{
¼¼ 
}
¾¾ 
return
¿¿ 
$num
¿¿ 
;
¿¿ 
}
ÀÀ 
}
ÁÁ 	
public
ÅÅ $
FLogicalDiskCollection
ÅÅ %
logicalDiskCol
ÅÅ& 4
{
ÆÆ 	
get
ÇÇ 
{
ÈÈ 
try
ÉÉ 
{
ÊÊ 
return
ËË 
m_fLogicalDiskCol
ËË ,
;
ËË, -
}
ÌÌ 
catch
ÍÍ 
(
ÍÍ 
	Exception
ÍÍ  
ex
ÍÍ! #
)
ÍÍ# $
{
ÎÎ 
FDebug
ÏÏ 
.
ÏÏ 
throwException
ÏÏ )
(
ÏÏ) *
ex
ÏÏ* ,
)
ÏÏ, -
;
ÏÏ- .
}
ĞĞ 
finally
ÑÑ 
{
ÒÒ 
}
ÔÔ 
return
ÕÕ 
null
ÕÕ 
;
ÕÕ 
}
ÖÖ 
}
×× 	
private
ßß 
void
ßß 
init
ßß 
(
ßß 
)
àà 
{
áá 	
try
ââ 
{
ãã 
m_scope
ää 
=
ää 
new
ää 
ManagementScope
ää -
(
ää- .
$str
ää. ;
)
ää; <
;
ää< =
m_perfCounter
åå 
=
åå 
new
åå  # 
PerformanceCounter
åå$ 6
(
åå6 7
)
åå7 8
;
åå8 9
m_perfCounter
ææ 
.
ææ 
CategoryName
ææ *
=
ææ+ ,
$str
ææ- D
;
ææD E
m_perfCounter
çç 
.
çç 
CounterName
çç )
=
çç* +
(
çç, -
Environment
çç- 8
.
çç8 9
	OSVersion
çç9 B
.
ççB C
Version
ççC J
.
ççJ K
Major
ççK P
>=
ççQ S
$num
ççT U
&&
ççV X
Environment
ççY d
.
ççd e
	OSVersion
ççe n
.
ççn o
Version
çço v
.
ççv w
Minor
ççw |
>
çç} ~
$numçç €
)çç€ 
?çç‚ ƒ
$str
èè )
:
èè* +
$str
éé &
;
éé& '
m_perfCounter
êê 
.
êê 
InstanceName
êê *
=
êê+ ,
$str
êê- 5
;
êê5 6
m_cpuUsageList
îî 
=
îî  
new
îî! $
List
îî% )
<
îî) *
double
îî* 0
>
îî0 1
(
îî1 2
)
îî2 3
;
îî3 4
}
ïï 
catch
ğğ 
(
ğğ 
	Exception
ğğ 
ex
ğğ 
)
ğğ  
{
ññ 
FDebug
òò 
.
òò 
throwException
òò %
(
òò% &
ex
òò& (
)
òò( )
;
òò) *
}
óó 
finally
ôô 
{
õõ 
}
÷÷ 
}
øø 	
private
üü 
void
üü 
term
üü 
(
üü 
)
ıı 
{
şş 	
try
ÿÿ 
{
€€ 
if
 
(
 
m_fThdPusher
  
!=
! #
null
$ (
)
( )
{
‚‚ 
m_fThdPusher
ƒƒ  
.
ƒƒ  !
ThreadJobCalled
ƒƒ! 0
-=
ƒƒ1 3
new
ƒƒ4 7*
FThreadJobCalledEventHandler
ƒƒ8 T
(
ƒƒT U*
m_fThdPusher_ThreadJobCalled
ƒƒU q
)
ƒƒq r
;
ƒƒr s
m_fThdPusher
……  
.
……  !
stop
……! %
(
……% &
)
……& '
;
……' (
m_fThdPusher
††  
.
††  !
Dispose
††! (
(
††( )
)
††) *
;
††* +
m_fThdPusher
‡‡  
=
‡‡! "
null
‡‡# '
;
‡‡' (
}
ˆˆ 
if
ŒŒ 
(
ŒŒ 
m_fTmrPusher
ŒŒ  
!=
ŒŒ! #
null
ŒŒ$ (
)
ŒŒ( )
{
 
m_fTmrPusher
  
.
  !
Dispose
! (
(
( )
)
) *
;
* +
m_fThdPusher
  
=
! "
null
# '
;
' (
}
 
}
‘‘ 
catch
’’ 
(
’’ 
	Exception
’’ 
ex
’’ 
)
’’  
{
““ 
FDebug
”” 
.
”” 
throwException
”” %
(
””% &
ex
””& (
)
””( )
;
””) *
}
•• 
finally
–– 
{
—— 
}
™™ 
}
šš 	
private
 
void
 !
procSysResourcePush
 (
(
( )
)
ŸŸ 
{
   	
try
¡¡ 
{
¢¢ !
getSystemReresource
££ #
(
££# $
)
££$ %
;
££% &
if
§§ 
(
§§ "
ResourceDataReceived
§§ (
!=
§§) +
null
§§, 0
)
§§0 1
{
¨¨ "
ResourceDataReceived
©© (
(
©©( )
this
ªª 
,
ªª 
new
«« &
FSystemResourceEventArgs
«« 4
(
««4 5
this
««5 9
.
««9 :
cpu
««: =
,
««= >
this
««? C
.
««C D
cpuUsage
««D L
,
««L M
this
««N R
.
««R S
memory
««S Y
,
««Y Z
this
««[ _
.
««_ `
memoryFreeSize
««` n
,
««n o
this
««p t
.
««t u
logicalDiskCol««u ƒ
)««ƒ „
)
¬¬ 
;
¬¬ 
}
­­ 
}
®® 
catch
¯¯ 
(
¯¯ 
	Exception
¯¯ 
ex
¯¯ 
)
¯¯  
{
°° 
FDebug
±± 
.
±± 
throwException
±± %
(
±±% &
ex
±±& (
)
±±( )
;
±±) *
}
²² 
finally
³³ 
{
´´ 
}
¶¶ 
}
·· 	
public
»» 
void
»» 
startEventHandler
»» %
(
»»% &
int
¼¼ 
interval
¼¼ 
)
½½ 
{
¾¾ 	
try
¿¿ 
{
ÀÀ 

m_interval
ÁÁ 
=
ÁÁ 
interval
ÁÁ %
;
ÁÁ% &
term
ÅÅ 
(
ÅÅ 
)
ÅÅ 
;
ÅÅ 
m_fThdPusher
ÉÉ 
=
ÉÉ 
new
ÉÉ "
FThread
ÉÉ# *
(
ÉÉ* +
$str
ÉÉ+ @
,
ÉÉ@ A
false
ÉÉB G
,
ÉÉG H
System
ÉÉI O
.
ÉÉO P
	Threading
ÉÉP Y
.
ÉÉY Z
ThreadPriority
ÉÉZ h
.
ÉÉh i
Normal
ÉÉi o
,
ÉÉo p
true
ÉÉq u
)
ÉÉu v
;
ÉÉv w
m_fThdPusher
ÊÊ 
.
ÊÊ 
ThreadJobCalled
ÊÊ ,
+=
ÊÊ- /
new
ÊÊ0 3*
FThreadJobCalledEventHandler
ÊÊ4 P
(
ÊÊP Q*
m_fThdPusher_ThreadJobCalled
ÊÊQ m
)
ÊÊm n
;
ÊÊn o
m_fThdPusher
ËË 
.
ËË 
start
ËË "
(
ËË" #
)
ËË# $
;
ËË$ %
}
ÌÌ 
catch
ÍÍ 
(
ÍÍ 
	Exception
ÍÍ 
ex
ÍÍ 
)
ÍÍ  
{
ÎÎ 
FDebug
ÏÏ 
.
ÏÏ 
throwException
ÏÏ %
(
ÏÏ% &
ex
ÏÏ& (
)
ÏÏ( )
;
ÏÏ) *
}
ĞĞ 
finally
ÑÑ 
{
ÒÒ 
}
ÔÔ 
}
ÕÕ 	
public
ÙÙ 
void
ÙÙ 
stopEventHandler
ÙÙ $
(
ÙÙ$ %
)
ÚÚ 
{
ÛÛ 	
try
ÜÜ 
{
İİ 
term
ŞŞ 
(
ŞŞ 
)
ŞŞ 
;
ŞŞ 
}
ßß 
catch
àà 
(
àà 
	Exception
àà 
ex
àà 
)
àà  
{
áá 
FDebug
ââ 
.
ââ 
throwException
ââ %
(
ââ% &
ex
ââ& (
)
ââ( )
;
ââ) *
}
ãã 
finally
ää 
{
åå 
}
çç 
}
èè 	
public
ìì 
void
ìì !
getSystemReresource
ìì '
(
ìì' (
)
íí 
{
îî 	&
ManagementObjectSearcher
ïï $
searcher
ïï% -
=
ïï. /
null
ïï0 4
;
ïï4 5

Dictionary
ññ 
<
ññ 
string
ññ 
,
ññ 
FLogicalDisk
ññ +
>
ññ+ ,
diskDict
ññ- 5
=
ññ6 7
null
ññ8 <
;
ññ< =
List
òò 
<
òò 
FLogicalDisk
òò 
>
òò 
diskList
òò '
=
òò( )
null
òò* .
;
òò. /
try
ôô 
{
õõ 
searcher
ıı 
=
ıı 
new
ıı &
ManagementObjectSearcher
ıı 7
(
ıı7 8
m_scope
şş 
,
şş  
new
ÿÿ 
SelectQuery
ÿÿ '
(
ÿÿ' (
$str
ÿÿ( J
)
ÿÿJ K
)
€€ 
;
€€ 
foreach
 
(
 
ManagementObject
 )
mo
* ,
in
- /
searcher
0 8
.
8 9
Get
9 <
(
< =
)
= >
)
> ?
{
‚‚ 
m_cpu
ƒƒ 
=
ƒƒ 
mo
ƒƒ 
[
ƒƒ 
$str
ƒƒ %
]
ƒƒ% &
.
ƒƒ& '
ToString
ƒƒ' /
(
ƒƒ/ 0
)
ƒƒ0 1
;
ƒƒ1 2
break
„„ 
;
„„ 
}
…… 
m_cpuUsageList
ŒŒ 
.
ŒŒ 
Add
ŒŒ "
(
ŒŒ" #
Convert
ŒŒ# *
.
ŒŒ* +
ToDouble
ŒŒ+ 3
(
ŒŒ3 4
m_perfCounter
ŒŒ4 A
.
ŒŒA B
	NextValue
ŒŒB K
(
ŒŒK L
)
ŒŒL M
)
ŒŒM N
)
ŒŒN O
;
ŒŒO P
searcher
   
=
   
new
   &
ManagementObjectSearcher
   7
(
  7 8
m_scope
¡¡ 
,
¡¡ 
new
¢¢ 
SelectQuery
¢¢ #
(
¢¢# $
$str
¢¢$ Z
)
¢¢Z [
)
££ 
;
££ 
foreach
¤¤ 
(
¤¤ 
ManagementObject
¤¤ )
mo
¤¤* ,
in
¤¤- /
searcher
¤¤0 8
.
¤¤8 9
Get
¤¤9 <
(
¤¤< =
)
¤¤= >
)
¤¤> ?
{
¥¥ 
m_memory
¦¦ 
=
¦¦ 
Convert
¦¦ &
.
¦¦& '
ToDouble
¦¦' /
(
¦¦/ 0
mo
¦¦0 2
[
¦¦2 3
$str
¦¦3 H
]
¦¦H I
)
¦¦I J
/
¦¦K L
(
¦¦M N
$num
¦¦N R
*
¦¦S T
$num
¦¦U Y
)
¦¦Y Z
;
¦¦Z [
break
§§ 
;
§§ 
}
¨¨ 
searcher
¯¯ 
=
¯¯ 
new
¯¯ &
ManagementObjectSearcher
¯¯ 7
(
¯¯7 8
m_scope
°° 
,
°° 
new
±± 
SelectQuery
±± #
(
±±# $
$str
±±$ f
)
±±f g
)
²² 
;
²² 
foreach
³³ 
(
³³ 
ManagementObject
³³ )
mo
³³* ,
in
³³- /
searcher
³³0 8
.
³³8 9
Get
³³9 <
(
³³< =
)
³³= >
)
³³> ?
{
´´ 
m_memoryFreeSize
µµ $
=
µµ% &
Convert
µµ' .
.
µµ. /
ToDouble
µµ/ 7
(
µµ7 8
mo
µµ8 :
[
µµ: ;
$str
µµ; K
]
µµK L
)
µµL M
/
µµN O
(
µµP Q
$num
µµQ U
*
µµV W
$num
µµX \
)
µµ\ ]
;
µµ] ^
break
¶¶ 
;
¶¶ 
}
·· 
diskDict
ÂÂ 
=
ÂÂ 
new
ÂÂ 

Dictionary
ÂÂ )
<
ÂÂ) *
string
ÂÂ* 0
,
ÂÂ0 1
FLogicalDisk
ÂÂ2 >
>
ÂÂ> ?
(
ÂÂ? @
)
ÂÂ@ A
;
ÂÂA B
diskList
ÃÃ 
=
ÃÃ 
new
ÃÃ 
List
ÃÃ #
<
ÃÃ# $
FLogicalDisk
ÃÃ$ 0
>
ÃÃ0 1
(
ÃÃ1 2
)
ÃÃ2 3
;
ÃÃ3 4
searcher
ÇÇ 
=
ÇÇ 
new
ÇÇ &
ManagementObjectSearcher
ÇÇ 7
(
ÇÇ7 8
m_scope
ÈÈ 
,
ÈÈ 
new
ÉÉ 
SelectQuery
ÉÉ #
(
ÉÉ# $
$str
ÉÉ$ o
)
ÉÉo p
)
ÊÊ 
;
ÊÊ 
foreach
ËË 
(
ËË 
ManagementObject
ËË )
mo
ËË* ,
in
ËË- /
searcher
ËË0 8
.
ËË8 9
Get
ËË9 <
(
ËË< =
)
ËË= >
)
ËË> ?
{
ÌÌ 
FLogicalDisk
ÍÍ  
fDisk
ÍÍ! &
=
ÍÍ' (
new
ÍÍ) ,
FLogicalDisk
ÍÍ- 9
(
ÍÍ9 :
mo
ÍÍ: <
[
ÍÍ< =
$str
ÍÍ= G
]
ÍÍG H
.
ÍÍH I
ToString
ÍÍI Q
(
ÍÍQ R
)
ÍÍR S
)
ÍÍS T
;
ÍÍT U
fDisk
ÏÏ 
.
ÏÏ 
	freeSpace
ÏÏ #
=
ÏÏ$ %
Convert
ÏÏ& -
.
ÏÏ- .
ToDouble
ÏÏ. 6
(
ÏÏ6 7
mo
ÏÏ7 9
[
ÏÏ9 :
$str
ÏÏ: E
]
ÏÏE F
)
ÏÏF G
/
ÏÏH I
(
ÏÏJ K
$num
ÏÏK O
*
ÏÏP Q
$num
ÏÏR V
)
ÏÏV W
;
ÏÏW X
fDisk
ĞĞ 
.
ĞĞ 
size
ĞĞ 
=
ĞĞ  
Convert
ĞĞ! (
.
ĞĞ( )
ToDouble
ĞĞ) 1
(
ĞĞ1 2
mo
ĞĞ2 4
[
ĞĞ4 5
$str
ĞĞ5 ;
]
ĞĞ; <
)
ĞĞ< =
/
ĞĞ> ?
(
ĞĞ@ A
$num
ĞĞA E
*
ĞĞF G
$num
ĞĞH L
)
ĞĞL M
;
ĞĞM N
if
ÒÒ 
(
ÒÒ 
!
ÒÒ 
diskDict
ÒÒ !
.
ÒÒ! "
ContainsKey
ÒÒ" -
(
ÒÒ- .
fDisk
ÒÒ. 3
.
ÒÒ3 4
devceId
ÒÒ4 ;
)
ÒÒ; <
)
ÒÒ< =
{
ÓÓ 
diskDict
ÔÔ  
.
ÔÔ  !
Add
ÔÔ! $
(
ÔÔ$ %
fDisk
ÔÔ% *
.
ÔÔ* +
devceId
ÔÔ+ 2
,
ÔÔ2 3
fDisk
ÔÔ4 9
)
ÔÔ9 :
;
ÔÔ: ;
diskList
ÕÕ  
.
ÕÕ  !
Add
ÕÕ! $
(
ÕÕ$ %
fDisk
ÕÕ% *
)
ÕÕ* +
;
ÕÕ+ ,
}
ÖÖ 
}
×× 
m_fLogicalDiskCol
ÙÙ !
=
ÙÙ" #
(
ÙÙ$ %
new
ÙÙ% ($
FLogicalDiskCollection
ÙÙ) ?
(
ÙÙ? @
diskDict
ÙÙ@ H
,
ÙÙH I
diskList
ÙÙJ R
)
ÙÙR S
)
ÙÙS T
;
ÙÙT U
}
ÜÜ 
catch
İİ 
(
İİ 
	Exception
İİ 
ex
İİ 
)
İİ  
{
ŞŞ 
FDebug
ßß 
.
ßß 
throwException
ßß %
(
ßß% &
ex
ßß& (
)
ßß( )
;
ßß) *
}
àà 
finally
áá 
{
ââ 
searcher
ãã 
=
ãã 
null
ãã 
;
ãã  
diskDict
ää 
=
ää 
null
ää 
;
ää  
diskList
åå 
=
åå 
null
åå 
;
åå  
}
ææ 
}
çç 	
private
ïï 
void
ïï *
m_fThdPusher_ThreadJobCalled
ïï 1
(
ïï1 2
object
ğğ 
sender
ğğ 
,
ğğ 
FThreadEventArgs
ññ 
e
ññ 
)
òò 
{
óó 	
try
ôô 
{
õõ 
if
öö 
(
öö 
m_fTmrPusher
öö  
==
öö! #
null
öö$ (
)
öö( )
{
÷÷ 
m_fTmrPusher
øø  
=
øø! "
new
øø# &
FStaticTimer
øø' 3
(
øø3 4
)
øø4 5
;
øø5 6
m_fTmrPusher
úú  
.
úú  !
start
úú! &
(
úú& '
$num
úú' +
)
úú+ ,
;
úú, -
return
şş 
;
şş 
}
ÿÿ 
if
ƒƒ 
(
ƒƒ 
!
ƒƒ 
m_fTmrPusher
ƒƒ !
.
ƒƒ! "
elasped
ƒƒ" )
(
ƒƒ) *
true
ƒƒ* .
)
ƒƒ. /
)
ƒƒ/ 0
{
„„ 
e
…… 
.
…… 
sleepThread
…… !
(
……! "
$num
……" #
)
……# $
;
……$ %
return
†† 
;
†† 
}
‡‡ !
procSysResourcePush
‹‹ #
(
‹‹# $
)
‹‹$ %
;
‹‹% &
e
 
.
 
sleepThread
 
(
 
$num
  
)
  !
;
! "
}
 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘ 
ex
‘‘ 
)
‘‘  
{
’’ 
FDebug
““ 
.
““ 
writeLog
““ 
(
““  
ex
““  "
)
““" #
;
““# $
e
—— 
.
—— 
sleepThread
—— 
(
—— 
$num
—— "
)
——" #
;
——# $
}
˜˜ 
finally
™™ 
{
šš 
}
œœ 
}
 	
}
££ 
}¤¤ µF
`D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Ftp\c_FFtpDirectoryEntry.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FFtpDirectoryEntry #
:$ %
IDisposable& 1
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
string 
m_name 
; 
private 
string 
m_owner 
; 
private 
string 
m_flags 
; 
private 
bool 
m_isDirectory "
;" #
private 
DateTime 
m_createTime %
;% &
private 
Int64 
m_size 
; 
public$$ 
FFtpDirectoryEntry$$ !
($$! "
)%% 
{&& 	
}(( 	
~,, 	
FFtpDirectoryEntry,,	 
(,, 
)-- 
{.. 	
	myDispose// 
(// 
false// 
)// 
;// 
}00 	
private44 
void44 
	myDispose44 
(44 
bool55 
	disposing55 
)66 
{77 	
if88 
(88 
!88 

m_disposed88 
)88 
{99 
if:: 
(:: 
	disposing:: 
):: 
{;; 
}== 

m_disposed?? 
=?? 
true?? !
;??! "
}@@ 
}AA 	
publicII 
voidII 
DisposeII 
(II 
)JJ 
{KK 	
	myDisposeLL 
(LL 
trueLL 
)LL 
;LL 
GCMM 
.MM 
SuppressFinalizeMM 
(MM  
thisMM  $
)MM$ %
;MM% &
}NN 	
publicVV 
stringVV 
nameVV 
{WW 	
getXX 
{YY 
tryZZ 
{[[ 
return\\ 
m_name\\ !
;\\! "
}]] 
catch^^ 
(^^ 
	Exception^^  
ex^^! #
)^^# $
{__ 
FDebug`` 
.`` 
throwException`` )
(``) *
ex``* ,
)``, -
;``- .
}aa 
finallybb 
{cc 
}ee 
returnff 
nullff 
;ff 
}gg 
setii 
{jj 
trykk 
{ll 
m_namemm 
=mm 
valuemm "
;mm" #
}nn 
catchoo 
(oo 
	Exceptionoo  
exoo! #
)oo# $
{pp 
FDebugqq 
.qq 
throwExceptionqq )
(qq) *
exqq* ,
)qq, -
;qq- .
}rr 
finallyss 
{tt 
}vv 
}ww 
}xx 	
public|| 
string|| 
owner|| 
{}} 	
get~~ 
{ 
try
€€ 
{
 
return
‚‚ 
m_owner
‚‚ "
;
‚‚" #
}
ƒƒ 
catch
„„ 
(
„„ 
	Exception
„„  
ex
„„! #
)
„„# $
{
…… 
FDebug
†† 
.
†† 
throwException
†† )
(
††) *
ex
††* ,
)
††, -
;
††- .
}
‡‡ 
finally
ˆˆ 
{
‰‰ 
}
‹‹ 
return
ŒŒ 
null
ŒŒ 
;
ŒŒ 
}
 
set
 
{
 
try
‘‘ 
{
’’ 
m_owner
““ 
=
““ 
value
““ #
;
““# $
}
”” 
catch
•• 
(
•• 
	Exception
••  
ex
••! #
)
••# $
{
–– 
FDebug
—— 
.
—— 
throwException
—— )
(
——) *
ex
——* ,
)
——, -
;
——- .
}
˜˜ 
finally
™™ 
{
šš 
}
œœ 
}
 
}
 	
public
¢¢ 
string
¢¢ 
flags
¢¢ 
{
££ 	
get
¤¤ 
{
¥¥ 
try
¦¦ 
{
§§ 
return
¨¨ 
m_flags
¨¨ "
;
¨¨" #
}
©© 
catch
ªª 
(
ªª 
	Exception
ªª  
ex
ªª! #
)
ªª# $
{
«« 
FDebug
¬¬ 
.
¬¬ 
throwException
¬¬ )
(
¬¬) *
ex
¬¬* ,
)
¬¬, -
;
¬¬- .
}
­­ 
finally
®® 
{
¯¯ 
}
±± 
return
²² 
null
²² 
;
²² 
}
³³ 
set
µµ 
{
¶¶ 
try
·· 
{
¸¸ 
m_flags
¹¹ 
=
¹¹ 
value
¹¹ #
;
¹¹# $
}
ºº 
catch
»» 
(
»» 
	Exception
»»  
ex
»»! #
)
»»# $
{
¼¼ 
FDebug
½½ 
.
½½ 
throwException
½½ )
(
½½) *
ex
½½* ,
)
½½, -
;
½½- .
}
¾¾ 
finally
¿¿ 
{
ÀÀ 
}
ÂÂ 
}
ÃÃ 
}
ÄÄ 	
public
ÈÈ 
bool
ÈÈ 
isDirectory
ÈÈ 
{
ÉÉ 	
get
ÊÊ 
{
ËË 
try
ÌÌ 
{
ÍÍ 
return
ÎÎ 
m_isDirectory
ÎÎ (
;
ÎÎ( )
}
ÏÏ 
catch
ĞĞ 
(
ĞĞ 
	Exception
ĞĞ  
ex
ĞĞ! #
)
ĞĞ# $
{
ÑÑ 
FDebug
ÒÒ 
.
ÒÒ 
throwException
ÒÒ )
(
ÒÒ) *
ex
ÒÒ* ,
)
ÒÒ, -
;
ÒÒ- .
}
ÓÓ 
finally
ÔÔ 
{
ÕÕ 
}
×× 
return
ØØ 
false
ØØ 
;
ØØ 
}
ÙÙ 
set
ÛÛ 
{
ÜÜ 
try
İİ 
{
ŞŞ 
m_isDirectory
ßß !
=
ßß" #
value
ßß$ )
;
ßß) *
}
àà 
catch
áá 
(
áá 
	Exception
áá  
ex
áá! #
)
áá# $
{
ââ 
FDebug
ãã 
.
ãã 
throwException
ãã )
(
ãã) *
ex
ãã* ,
)
ãã, -
;
ãã- .
}
ää 
finally
åå 
{
ææ 
}
èè 
}
éé 
}
êê 	
public
îî 
DateTime
îî 

createTime
îî "
{
ïï 	
get
ğğ 
{
ññ 
try
òò 
{
óó 
return
ôô 
m_createTime
ôô '
;
ôô' (
}
õõ 
catch
öö 
(
öö 
	Exception
öö  
ex
öö! #
)
öö# $
{
÷÷ 
FDebug
øø 
.
øø 
throwException
øø )
(
øø) *
ex
øø* ,
)
øø, -
;
øø- .
}
ùù 
finally
úú 
{
ûû 
}
ıı 
return
şş 
DateTime
şş 
.
şş  
Now
şş  #
;
şş# $
}
ÿÿ 
set
 
{
‚‚ 
try
ƒƒ 
{
„„ 
m_createTime
……  
=
……! "
value
……# (
;
……( )
}
†† 
catch
‡‡ 
(
‡‡ 
	Exception
‡‡  
ex
‡‡! #
)
‡‡# $
{
ˆˆ 
FDebug
‰‰ 
.
‰‰ 
throwException
‰‰ )
(
‰‰) *
ex
‰‰* ,
)
‰‰, -
;
‰‰- .
}
ŠŠ 
finally
‹‹ 
{
ŒŒ 
}
 
}
 
}
 	
public
”” 
Int64
”” 
size
”” 
{
•• 	
get
–– 
{
—— 
try
˜˜ 
{
™™ 
return
šš 
m_size
šš !
;
šš! "
}
›› 
catch
œœ 
(
œœ 
	Exception
œœ  
ex
œœ! #
)
œœ# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
ŸŸ 
finally
   
{
¡¡ 
}
££ 
return
¤¤ 
-
¤¤ 
$num
¤¤ 
;
¤¤ 
}
¥¥ 
set
§§ 
{
¨¨ 
try
©© 
{
ªª 
m_size
«« 
=
«« 
value
«« "
;
««" #
}
¬¬ 
catch
­­ 
(
­­ 
	Exception
­­  
ex
­­! #
)
­­# $
{
®® 
FDebug
¯¯ 
.
¯¯ 
throwException
¯¯ )
(
¯¯) *
ex
¯¯* ,
)
¯¯, -
;
¯¯- .
}
°° 
finally
±± 
{
²² 
}
´´ 
}
µµ 
}
¶¶ 	
}
¼¼ 
}½½ ¬°
dD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\H101\c_FH101DataReceivedArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class !
FH101DataReceivedArgs &
:' (
IDisposable) 4
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FH101 
m_fH101 
= 
null  $
;$ %
private   
Message   
	m_message   !
=  " #
null  $ (
;  ( )
private!! 
string!! 
	m_channel!!  
=!!! "
string!!# )
.!!) *
Empty!!* /
;!!/ 0
private"" 
UInt32"" 
m_tid"" 
="" 
$num""  
;""  !
internal(( !
FH101DataReceivedArgs(( &
(((& '
FH101)) 
fH101)) 
,)) 
Message** 
message** 
,** 
string++ 
channel++ 
,++ 
UInt32,, 
tid,, 
)-- 
{.. 	
m_fH101// 
=// 
fH101// 
;// 
	m_message00 
=00 
message00 
;00  
	m_channel11 
=11 
channel11 
;11  
m_tid22 
=22 
tid22 
;22 
}33 	
~77 	!
FH101DataReceivedArgs77	 
(77 
)88 
{99 	
	myDispose:: 
(:: 
false:: 
):: 
;:: 
};; 	
	protected?? 
void?? 
	myDispose??  
(??  !
bool@@ 
	disposing@@ 
)AA 
{BB 	
ifCC 
(CC 
!CC 

m_disposedCC 
)CC 
{DD 
ifEE 
(EE 
	disposingEE 
)EE 
{FF 
m_fH101GG 
=GG 
nullGG "
;GG" #
	m_messageHH 
=HH 
nullHH  $
;HH$ %
}II 

m_disposedJJ 
=JJ 
trueJJ !
;JJ! "
}KK 
}LL 	
publicTT 
voidTT 
DisposeTT 
(TT 
)UU 
{VV 	
	myDisposeWW 
(WW 
trueWW 
)WW 
;WW 
GCXX 
.XX 
SuppressFinalizeXX 
(XX  
thisXX  $
)XX$ %
;XX% &
}YY 	
publicaa 
stringaa 
	operationaa 
{bb 	
getcc 
{dd 
stringee 
valueee 
=ee 
stringee %
.ee% &
Emptyee& +
;ee+ ,
trygg 
{hh 
valueii 
=ii 
(ii 
stringii #
)ii# $
	m_messageii$ -
.ii- .
getPropertyii. 9
(ii9 :
FH101ii: ?
.ii? @!
XGEN_TAG_SERVICE_NAMEii@ U
)iiU V
;iiV W
ifjj 
(jj 
valuejj 
==jj  
nulljj! %
)jj% &
{kk 
valuell 
=ll 
(ll  !
stringll! '
)ll' (
	m_messagell( 1
.ll1 2
getPropertyll2 =
(ll= >
FH101ll> C
.llC D
XGEN_TAG_OPERATIONllD V
)llV W
;llW X
}mm 
ifnn 
(nn 
valuenn 
==nn  
nullnn! %
)nn% &
{oo 
valuepp 
=pp 
(pp  !
stringpp! '
)pp' (
	m_messagepp( 1
.pp1 2
getPropertypp2 =
(pp= >
$strpp> L
)ppL M
;ppM N
}qq 
returnrr 
valuerr  
;rr  !
}ss 
catchtt 
(tt 
	Exceptiontt  
extt! #
)tt# $
{uu 
FDebugvv 
.vv 
throwExceptionvv )
(vv) *
exvv* ,
)vv, -
;vv- .
}ww 
finallyxx 
{yy 
}{{ 
return|| 
string|| 
.|| 
Empty|| #
;||# $
}}} 
}~~ 	
public
‚‚ 
string
‚‚ 
dataToString
‚‚ "
{
ƒƒ 	
get
„„ 
{
…… 
StreamTransformer
†† !
former
††" (
=
††) *
null
††+ /
;
††/ 0
try
ˆˆ 
{
‰‰ 
if
ŠŠ 
(
ŠŠ 
m_fH101
ŠŠ 
.
ŠŠ  
isTrs
ŠŠ  %
)
ŠŠ% &
{
‹‹ 
former
ŒŒ 
=
ŒŒ  
new
ŒŒ! $#
StreamTransformerImpl
ŒŒ% :
(
ŒŒ: ;
	m_message
ŒŒ; D
.
ŒŒD E
getData
ŒŒE L
(
ŒŒL M
)
ŒŒM N
,
ŒŒN O
$str
ŒŒP W
)
ŒŒW X
;
ŒŒX Y
return
 
former
 %
.
% &
readMsgString
& 3
(
3 4
)
4 5
;
5 6
}
 
if
 
(
 
m_fH101
 
.
  
isCompressed
  ,
)
, -
{
‘‘ 
return
’’ 
F7Zip
’’ $
.
’’$ %

decompress
’’% /
(
’’/ 0
	m_message
’’0 9
.
’’9 :
getDataAsString
’’: I
(
’’I J
)
’’J K
)
’’K L
;
’’L M
}
““ 
return
•• 
	m_message
•• $
.
••$ %
getDataAsString
••% 4
(
••4 5
)
••5 6
;
••6 7
}
—— 
catch
˜˜ 
(
˜˜ 
	Exception
˜˜  
ex
˜˜! #
)
˜˜# $
{
™™ 
FDebug
šš 
.
šš 
throwException
šš )
(
šš) *
ex
šš* ,
)
šš, -
;
šš- .
}
›› 
finally
œœ 
{
 
}
ŸŸ 
return
   
null
   
;
   
}
¡¡ 
}
¢¢ 	
public
¦¦ 
FXmlNode
¦¦ 
dataToXmlNode
¦¦ %
{
§§ 	
get
¨¨ 
{
©© 
try
ªª 
{
«« 
return
¬¬ 
FDataConvert
¬¬ '
.
¬¬' (
stringToXmlNode
¬¬( 7
(
¬¬7 8
m_fH101
¬¬8 ?
.
¬¬? @
isTrs
¬¬@ E
,
¬¬E F
this
¬¬G K
.
¬¬K L
dataToString
¬¬L X
)
¬¬X Y
;
¬¬Y Z
}
­­ 
catch
®® 
(
®® 
	Exception
®®  
ex
®®! #
)
®®# $
{
¯¯ 
FDebug
°° 
.
°° 
throwException
°° )
(
°°) *
ex
°°* ,
)
°°, -
;
°°- .
}
±± 
finally
²² 
{
³³ 
}
µµ 
return
¶¶ 
null
¶¶ 
;
¶¶ 
}
·· 
}
¸¸ 	
public
¼¼ 
string
¼¼ 
channel
¼¼ 
{
½½ 	
get
¾¾ 
{
¿¿ 
try
ÀÀ 
{
ÁÁ 
return
ÂÂ 
	m_channel
ÂÂ $
;
ÂÂ$ %
}
ÃÃ 
catch
ÄÄ 
(
ÄÄ 
	Exception
ÄÄ  
ex
ÄÄ! #
)
ÄÄ# $
{
ÅÅ 
FDebug
ÆÆ 
.
ÆÆ 
throwException
ÆÆ )
(
ÆÆ) *
ex
ÆÆ* ,
)
ÆÆ, -
;
ÆÆ- .
}
ÇÇ 
finally
ÈÈ 
{
ÉÉ 
}
ËË 
return
ÌÌ 
string
ÌÌ 
.
ÌÌ 
Empty
ÌÌ #
;
ÌÌ# $
}
ÍÍ 
}
ÎÎ 	
public
ÒÒ 
UInt32
ÒÒ 
tid
ÒÒ 
{
ÓÓ 	
get
ÔÔ 
{
ÕÕ 
try
ÖÖ 
{
×× 
return
ØØ 
m_tid
ØØ  
;
ØØ  !
}
ÙÙ 
catch
ÚÚ 
(
ÚÚ 
	Exception
ÚÚ  
ex
ÚÚ! #
)
ÚÚ# $
{
ÛÛ 
FDebug
ÜÜ 
.
ÜÜ 
throwException
ÜÜ )
(
ÜÜ) *
ex
ÜÜ* ,
)
ÜÜ, -
;
ÜÜ- .
}
İİ 
finally
ŞŞ 
{
ßß 
}
áá 
return
ââ 
$num
ââ 
;
ââ 
}
ãã 
}
ää 	
public
èè 
bool
èè 
	isRequest
èè 
{
éé 	
get
êê 
{
ëë 
try
ìì 
{
íí 
return
îî 
DeliveryType
îî '
.
îî' (
	isRequest
îî( 1
(
îî1 2
	m_message
îî2 ;
.
îî; <
getDeliveryMode
îî< K
(
îîK L
)
îîL M
)
îîM N
;
îîN O
}
ïï 
catch
ğğ 
(
ğğ 
	Exception
ğğ  
ex
ğğ! #
)
ğğ# $
{
ññ 
FDebug
òò 
.
òò 
throwException
òò )
(
òò) *
ex
òò* ,
)
òò, -
;
òò- .
}
óó 
finally
ôô 
{
õõ 
}
÷÷ 
return
øø 
false
øø 
;
øø 
}
ùù 
}
úú 	
public
şş 
bool
şş 
isReply
şş 
{
ÿÿ 	
get
€€ 
{
 
try
‚‚ 
{
ƒƒ 
return
„„ 
DeliveryType
„„ '
.
„„' (
isReply
„„( /
(
„„/ 0
	m_message
„„0 9
.
„„9 :
getDeliveryMode
„„: I
(
„„I J
)
„„J K
)
„„K L
;
„„L M
}
…… 
catch
†† 
(
†† 
	Exception
††  
ex
††! #
)
††# $
{
‡‡ 
FDebug
ˆˆ 
.
ˆˆ 
throwException
ˆˆ )
(
ˆˆ) *
ex
ˆˆ* ,
)
ˆˆ, -
;
ˆˆ- .
}
‰‰ 
finally
ŠŠ 
{
‹‹ 
}
 
return
 
false
 
;
 
}
 
}
 	
public
”” 
bool
”” 
	isUnicast
”” 
{
•• 	
get
–– 
{
—— 
try
˜˜ 
{
™™ 
return
šš 
DeliveryType
šš '
.
šš' (
	isUnicast
šš( 1
(
šš1 2
	m_message
šš2 ;
.
šš; <
getDeliveryMode
šš< K
(
ššK L
)
ššL M
)
ššM N
;
ššN O
}
›› 
catch
œœ 
(
œœ 
	Exception
œœ  
ex
œœ! #
)
œœ# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
ŸŸ 
finally
   
{
¡¡ 
}
££ 
return
¤¤ 
false
¤¤ 
;
¤¤ 
}
¥¥ 
}
¦¦ 	
public
ªª 
bool
ªª !
isGuaranteedUnicast
ªª '
{
«« 	
get
¬¬ 
{
­­ 
try
®® 
{
¯¯ 
return
°° 
DeliveryType
°° '
.
°°' (!
isGuaranteedUnicast
°°( ;
(
°°; <
	m_message
°°< E
.
°°E F
getDeliveryMode
°°F U
(
°°U V
)
°°V W
)
°°W X
;
°°X Y
}
±± 
catch
²² 
(
²² 
	Exception
²²  
ex
²²! #
)
²²# $
{
³³ 
FDebug
´´ 
.
´´ 
throwException
´´ )
(
´´) *
ex
´´* ,
)
´´, -
;
´´- .
}
µµ 
finally
¶¶ 
{
·· 
}
¹¹ 
return
ºº 
false
ºº 
;
ºº 
}
»» 
}
¼¼ 	
public
ÀÀ 
bool
ÀÀ 
isMulticast
ÀÀ 
{
ÁÁ 	
get
ÂÂ 
{
ÃÃ 
try
ÄÄ 
{
ÅÅ 
return
ÆÆ 
DeliveryType
ÆÆ '
.
ÆÆ' (
isMulticast
ÆÆ( 3
(
ÆÆ3 4
	m_message
ÆÆ4 =
.
ÆÆ= >
getDeliveryMode
ÆÆ> M
(
ÆÆM N
)
ÆÆN O
)
ÆÆO P
;
ÆÆP Q
}
ÇÇ 
catch
ÈÈ 
(
ÈÈ 
	Exception
ÈÈ  
ex
ÈÈ! #
)
ÈÈ# $
{
ÉÉ 
FDebug
ÊÊ 
.
ÊÊ 
throwException
ÊÊ )
(
ÊÊ) *
ex
ÊÊ* ,
)
ÊÊ, -
;
ÊÊ- .
}
ËË 
finally
ÌÌ 
{
ÍÍ 
}
ÏÏ 
return
ĞĞ 
false
ĞĞ 
;
ĞĞ 
}
ÑÑ 
}
ÒÒ 	
public
ÖÖ 
bool
ÖÖ #
isGuaranteedMulticast
ÖÖ )
{
×× 	
get
ØØ 
{
ÙÙ 
try
ÚÚ 
{
ÛÛ 
return
ÜÜ 
DeliveryType
ÜÜ '
.
ÜÜ' (#
isGuaranteedMulticast
ÜÜ( =
(
ÜÜ= >
	m_message
ÜÜ> G
.
ÜÜG H
getDeliveryMode
ÜÜH W
(
ÜÜW X
)
ÜÜX Y
)
ÜÜY Z
;
ÜÜZ [
}
İİ 
catch
ŞŞ 
(
ŞŞ 
	Exception
ŞŞ  
ex
ŞŞ! #
)
ŞŞ# $
{
ßß 
FDebug
àà 
.
àà 
throwException
àà )
(
àà) *
ex
àà* ,
)
àà, -
;
àà- .
}
áá 
finally
ââ 
{
ãã 
}
åå 
return
ææ 
false
ææ 
;
ææ 
}
çç 
}
èè 	
public
ìì 
FH101DeliveryType
ìì  
fDeliveryType
ìì! .
{
íí 	
get
îî 
{
ïï 
try
ğğ 
{
ññ 
if
òò 
(
òò 
this
òò 
.
òò 
	isRequest
òò &
)
òò& '
{
óó 
return
ôô 
FH101DeliveryType
ôô 0
.
ôô0 1
Request
ôô1 8
;
ôô8 9
}
õõ 
else
öö 
if
öö 
(
öö 
this
öö !
.
öö! "
isReply
öö" )
)
öö) *
{
÷÷ 
return
øø 
FH101DeliveryType
øø 0
.
øø0 1
Reply
øø1 6
;
øø6 7
}
ùù 
else
úú 
if
úú 
(
úú 
this
úú !
.
úú! "
	isUnicast
úú" +
)
úú+ ,
{
ûû 
return
üü 
FH101DeliveryType
üü 0
.
üü0 1
Unicast
üü1 8
;
üü8 9
}
ıı 
else
şş 
if
şş 
(
şş 
this
şş !
.
şş! "!
isGuaranteedUnicast
şş" 5
)
şş5 6
{
ÿÿ 
return
€€ 
FH101DeliveryType
€€ 0
.
€€0 1
GuaranteedUnicast
€€1 B
;
€€B C
}
 
else
‚‚ 
if
‚‚ 
(
‚‚ 
this
‚‚ !
.
‚‚! "
isMulticast
‚‚" -
)
‚‚- .
{
ƒƒ 
return
„„ 
FH101DeliveryType
„„ 0
.
„„0 1
	Mulitcast
„„1 :
;
„„: ;
}
…… 
return
†† 
FH101DeliveryType
†† ,
.
††, -!
GuaranteedMulticast
††- @
;
††@ A
}
‡‡ 
catch
ˆˆ 
(
ˆˆ 
	Exception
ˆˆ  
ex
ˆˆ! #
)
ˆˆ# $
{
‰‰ 
FDebug
ŠŠ 
.
ŠŠ 
throwException
ŠŠ )
(
ŠŠ) *
ex
ŠŠ* ,
)
ŠŠ, -
;
ŠŠ- .
}
‹‹ 
finally
ŒŒ 
{
 
}
 
return
 
FH101DeliveryType
 (
.
( )
Request
) 0
;
0 1
}
‘‘ 
}
’’ 	
public
šš 
void
šš 
	sendReply
šš 
(
šš 
string
›› 
errCode
›› 
,
›› 
string
œœ 

errMessage
œœ 
)
 
{
 	
Message
ŸŸ 
rep
ŸŸ 
=
ŸŸ 
null
ŸŸ 
;
ŸŸ 
try
¡¡ 
{
¢¢ 
rep
££ 
=
££ 
	m_message
££ 
.
££  
createReply
££  +
(
££+ ,
)
££, -
;
££- .
rep
¤¤ 
.
¤¤ 
setProperty
¤¤ 
(
¤¤  
FH101
¤¤  %
.
¤¤% &"
XGEN_TAG_RESULT_CODE
¤¤& :
,
¤¤: ;
errCode
¤¤< C
)
¤¤C D
;
¤¤D E
rep
¥¥ 
.
¥¥ 
setProperty
¥¥ 
(
¥¥  
FH101
¥¥  %
.
¥¥% &!
XGEN_TAG_RESULT_MSG
¥¥& 9
,
¥¥9 :

errMessage
¥¥; E
)
¥¥E F
;
¥¥F G
m_fH101
¦¦ 
.
¦¦ 
session
¦¦ 
.
¦¦  
	sendReply
¦¦  )
(
¦¦) *
	m_message
¦¦* 3
,
¦¦3 4
rep
¦¦5 8
)
¦¦8 9
;
¦¦9 :
}
§§ 
catch
¨¨ 
(
¨¨ 
	Exception
¨¨ 
ex
¨¨ 
)
¨¨  
{
©© 
FDebug
ªª 
.
ªª 
throwException
ªª %
(
ªª% &
ex
ªª& (
)
ªª( )
;
ªª) *
}
«« 
finally
¬¬ 
{
­­ 
rep
®® 
=
®® 
null
®® 
;
®® 
}
¯¯ 
}
°° 	
public
´´ 
void
´´ 
	sendReply
´´ 
(
´´ 
string
µµ 
data
µµ 
)
¶¶ 
{
·· 	
Message
¸¸ 
rep
¸¸ 
=
¸¸ 
null
¸¸ 
;
¸¸ 
StreamTransformer
¹¹ 
former
¹¹ $
=
¹¹% &
null
¹¹' +
;
¹¹+ ,
try
»» 
{
¼¼ 
rep
½½ 
=
½½ 
	m_message
½½ 
.
½½  
createReply
½½  +
(
½½+ ,
)
½½, -
;
½½- .
if
ÁÁ 
(
ÁÁ 
m_fH101
ÁÁ 
.
ÁÁ 
isTrs
ÁÁ !
)
ÁÁ! "
{
ÂÂ 
former
ÃÃ 
=
ÃÃ 
new
ÃÃ  #
StreamTransformerImpl
ÃÃ! 6
(
ÃÃ6 7
)
ÃÃ7 8
;
ÃÃ8 9
former
ÄÄ 
.
ÄÄ 
writeMsgString
ÄÄ )
(
ÄÄ) *
data
ÄÄ* .
)
ÄÄ. /
;
ÄÄ/ 0
rep
ÅÅ 
.
ÅÅ 
setData
ÅÅ 
(
ÅÅ  
former
ÅÅ  &
.
ÅÅ& '
getBytes
ÅÅ' /
(
ÅÅ/ 0
)
ÅÅ0 1
)
ÅÅ1 2
;
ÅÅ2 3
}
ÆÆ 
else
ÇÇ 
{
ÈÈ 
if
ÉÉ 
(
ÉÉ 
m_fH101
ÉÉ 
.
ÉÉ  
isCompressed
ÉÉ  ,
)
ÉÉ, -
{
ÊÊ 
rep
ËË 
.
ËË 
setData
ËË #
(
ËË# $
F7Zip
ËË$ )
.
ËË) *
compress
ËË* 2
(
ËË2 3
data
ËË3 7
)
ËË7 8
)
ËË8 9
;
ËË9 :
}
ÌÌ 
else
ÍÍ 
{
ÎÎ 
rep
ÏÏ 
.
ÏÏ 
setData
ÏÏ #
(
ÏÏ# $
data
ÏÏ$ (
)
ÏÏ( )
;
ÏÏ) *
}
ĞĞ 
}
ÑÑ 
m_fH101
ÕÕ 
.
ÕÕ 
session
ÕÕ 
.
ÕÕ  
	sendReply
ÕÕ  )
(
ÕÕ) *
	m_message
ÕÕ* 3
,
ÕÕ3 4
rep
ÕÕ5 8
)
ÕÕ8 9
;
ÕÕ9 :
}
ÖÖ 
catch
×× 
(
×× 
	Exception
×× 
ex
×× 
)
××  
{
ØØ 
FDebug
ÙÙ 
.
ÙÙ 
throwException
ÙÙ %
(
ÙÙ% &
ex
ÙÙ& (
)
ÙÙ( )
;
ÙÙ) *
}
ÚÚ 
finally
ÛÛ 
{
ÜÜ 
rep
İİ 
=
İİ 
null
İİ 
;
İİ 
}
ŞŞ 
}
ßß 	
public
ãã 
void
ãã 
	sendReply
ãã 
(
ãã 
FXmlNode
ää 
data
ää 
)
åå 
{
ææ 	
try
çç 
{
èè 
	sendReply
éé 
(
éé 
data
éé 
.
éé 
outerXml
éé '
)
éé' (
;
éé( )
}
êê 
catch
ëë 
(
ëë 
	Exception
ëë 
ex
ëë 
)
ëë  
{
ìì 
FDebug
íí 
.
íí 
throwException
íí %
(
íí% &
ex
íí& (
)
íí( )
;
íí) *
}
îî 
finally
ïï 
{
ğğ 
}
òò 
}
óó 	
public
øø 
void
øø 
sendReplyTrs
øø  
(
øø  !
FXmlNode
ùù 
data
ùù 
)
úú 
{
ûû 	
StreamTransformer
üü 
former
üü $
=
üü% &
null
üü' +
;
üü+ ,
Message
ıı 
rep
ıı 
=
ıı 
null
ıı 
;
ıı 
string
şş 
repData
şş 
=
şş 
string
şş #
.
şş# $
Empty
şş$ )
;
şş) *
try
€€ 
{
 
rep
‚‚ 
=
‚‚ 
	m_message
‚‚ 
.
‚‚  
createReply
‚‚  +
(
‚‚+ ,
)
‚‚, -
;
‚‚- .
repData
†† 
=
†† 
data
†† 
.
†† 
outerXml
†† '
;
††' (
former
ˆˆ 
=
ˆˆ 
new
ˆˆ #
StreamTransformerImpl
ˆˆ 2
(
ˆˆ2 3
)
ˆˆ3 4
;
ˆˆ4 5
former
‰‰ 
.
‰‰ 
writeMsgString
‰‰ %
(
‰‰% &
repData
‰‰& -
)
‰‰- .
;
‰‰. /
rep
ŠŠ 
.
ŠŠ 
setData
ŠŠ 
(
ŠŠ 
former
ŠŠ "
.
ŠŠ" #
getBytes
ŠŠ# +
(
ŠŠ+ ,
)
ŠŠ, -
)
ŠŠ- .
;
ŠŠ. /
m_fH101
 
.
 
session
 
.
  
	sendReply
  )
(
) *
	m_message
* 3
,
3 4
rep
5 8
)
8 9
;
9 :
}
 
catch
 
(
 
	Exception
 
ex
 
)
  
{
‘‘ 
FDebug
’’ 
.
’’ 
throwException
’’ %
(
’’% &
ex
’’& (
)
’’( )
;
’’) *
}
““ 
finally
”” 
{
•• 
rep
–– 
=
–– 
null
–– 
;
–– 
}
—— 
}
˜˜ 	
}
 
}ŸŸ „Ï
cD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\H101\c_FH101MessageConsumer.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{   
internal!! 
class!!  
FH101MessageConsumer!! '
:!!( )
MessageConsumer!!* 9
,!!9 :
IDisposable!!; F
{"" 
private&& 
bool&& 

m_disposed&& 
=&&  !
false&&" '
;&&' (
private(( 
FH101(( 
m_fH101(( 
=(( 
null((  $
;(($ %
private)) 
	Hashtable)) 
m_dispatchers)) '
=))( )
null))* .
;)). /
private** 
string** 
m_status_message** '
=**( )
string*** 0
.**0 1
Empty**1 6
;**6 7
public00  
FH101MessageConsumer00 #
(00# $
FH10111 
fH10111 
,11 
	Hashtable22 
dispatchers22 !
)33 
{44 	
m_fH10155 
=55 
fH10155 
;55 
m_dispatchers66 
=66 
dispatchers66 '
;66' (
}77 	
~;; 	 
FH101MessageConsumer;;	 
(;; 
)<< 
{== 	
	myDispose>> 
(>> 
false>> 
)>> 
;>> 
}?? 	
	protectedCC 
voidCC 
	myDisposeCC  
(CC  !
boolDD 
	disposingDD 
)EE 
{FF 	
ifGG 
(GG 
!GG 

m_disposedGG 
)GG 
{HH 
ifII 
(II 
	disposingII 
)II 
{JJ 
m_fH101KK 
=KK 
nullKK "
;KK" #
m_dispatchersLL !
=LL" #
nullLL$ (
;LL( )
}MM 

m_disposedOO 
=OO 
trueOO !
;OO! "
}PP 
}QQ 	
publicYY 
voidYY 
DisposeYY 
(YY 
)ZZ 
{[[ 	
	myDispose\\ 
(\\ 
true\\ 
)\\ 
;\\ 
GC]] 
.]] 
SuppressFinalize]] 
(]]  
this]]  $
)]]$ %
;]]% &
}^^ 	
publicff 
stringff 
statusMessageff #
{gg 	
gethh 
{ii 
tryjj 
{kk 
returnll 
m_status_messagell +
;ll+ ,
}mm 
catchnn 
(nn 
	Exceptionnn  
exnn! #
)nn# $
{oo 
FDebugpp 
.pp 
throwExceptionpp )
(pp) *
expp* ,
)pp, -
;pp- .
}qq 
finallyrr 
{ss 
}uu 
returnvv 
nullvv 
;vv 
}ww 
setyy 
{zz 
try{{ 
{|| 
m_status_message}} $
=}}% &
value}}' ,
;}}, -
}~~ 
catch 
( 
	Exception  
ex! #
)# $
{
€€ 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
‚‚ 
finally
ƒƒ 
{
„„ 
}
†† 
}
‡‡ 
}
ˆˆ 	
private
 
void
 %
requestReplyAsyncThread
 ,
(
, -
object
‘‘ 
ar
‘‘ 
)
’’ 
{
““ 	#
FH101RequestReplyData
”” !
fData
””" '
=
””( )
null
””* .
;
””. /
try
–– 
{
—— 
fData
˜˜ 
=
˜˜ 
(
˜˜ #
FH101RequestReplyData
˜˜ .
)
˜˜. /
ar
˜˜/ 1
;
˜˜1 2
procRequestReply
™™  
(
™™  !
fData
™™! &
)
™™& '
;
™™' (
}
šš 
catch
›› 
(
›› 
	Exception
›› 
ex
›› 
)
››  
{
œœ 
fData
 
.
 
message
 
=
 
ex
  "
.
" #
Message
# *
;
* +
fData
 
.
 
result
 
=
 
false
 $
;
$ %
fData
ŸŸ 
.
ŸŸ 
	completed
ŸŸ 
=
ŸŸ  !
true
ŸŸ" &
;
ŸŸ& '
}
   
finally
¡¡ 
{
¢¢ 
}
¤¤ 
}
¥¥ 	
private
©© 
void
©© 
procRequestReply
©© %
(
©©% &#
FH101RequestReplyData
ªª !
fData
ªª" '
)
«« 
{
¬¬ 	
try
­­ 
{
®® 
fData
¯¯ 
.
¯¯ 
rep
¯¯ 
=
¯¯ 
m_fH101
¯¯ #
.
¯¯# $
session
¯¯$ +
.
¯¯+ ,
sendRequest
¯¯, 7
(
¯¯7 8
fData
¯¯8 =
.
¯¯= >
req
¯¯> A
)
¯¯A B
;
¯¯B C
fData
±± 
.
±± 
result
±± 
=
±± 
true
±± #
;
±±# $
fData
²² 
.
²² 
	completed
²² 
=
²²  !
true
²²" &
;
²²& '
}
³³ 
catch
´´ 
(
´´ 
	Exception
´´ 
ex
´´ 
)
´´  
{
µµ 
if
¶¶ 
(
¶¶ 
ex
¶¶ 
.
¶¶ 
Message
¶¶ 
==
¶¶ !
SessionException
¶¶" 2
.
¶¶2 3$
CHANNEL_NOTFOUND_TUNER
¶¶3 I
)
¶¶I J
{
·· 
fData
¸¸ 
.
¸¸ 
message
¸¸ !
=
¸¸" #
$str
¸¸$ 7
;
¸¸7 8
}
¹¹ 
else
ºº 
if
ºº 
(
ºº 
ex
ºº 
.
ºº 
Message
ºº #
==
ºº$ &
SessionException
ºº' 7
.
ºº7 8
TIMEOUT
ºº8 ?
)
ºº? @
{
»» 
fData
¼¼ 
.
¼¼ 
message
¼¼ !
=
¼¼" #
$str
¼¼$ ;
;
¼¼; <
}
½½ 
else
¾¾ 
{
¿¿ 
fData
ÀÀ 
.
ÀÀ 
message
ÀÀ !
=
ÀÀ" #
ex
ÀÀ$ &
.
ÀÀ& '
Message
ÀÀ' .
;
ÀÀ. /
}
ÁÁ 
fData
ÃÃ 
.
ÃÃ 
result
ÃÃ 
=
ÃÃ 
false
ÃÃ $
;
ÃÃ$ %
fData
ÄÄ 
.
ÄÄ 
	completed
ÄÄ 
=
ÄÄ  !
true
ÄÄ" &
;
ÄÄ& '
}
ÅÅ 
finally
ÆÆ 
{
ÇÇ 
}
ÉÉ 
}
ÊÊ 	
private
ÎÎ 
void
ÎÎ 
	sendReply
ÎÎ 
(
ÎÎ 
Message
ÏÏ 
req
ÏÏ 
,
ÏÏ 
Message
ĞĞ 
rep
ĞĞ 
,
ĞĞ 
string
ÑÑ 
errCode
ÑÑ 
,
ÑÑ 
string
ÒÒ 

errMessage
ÒÒ 
)
ÓÓ 
{
ÔÔ 	
try
ÕÕ 
{
ÖÖ 
rep
×× 
.
×× 
setProperty
×× 
(
××  
FH101
××  %
.
××% &"
XGEN_TAG_RESULT_CODE
××& :
,
××: ;
errCode
××< C
)
××C D
;
××D E
rep
ØØ 
.
ØØ 
setProperty
ØØ 
(
ØØ  
FH101
ØØ  %
.
ØØ% &!
XGEN_TAG_RESULT_MSG
ØØ& 9
,
ØØ9 :

errMessage
ØØ; E
)
ØØE F
;
ØØF G
m_fH101
ÙÙ 
.
ÙÙ 
session
ÙÙ 
.
ÙÙ  
	sendReply
ÙÙ  )
(
ÙÙ) *
req
ÙÙ* -
,
ÙÙ- .
rep
ÙÙ/ 2
)
ÙÙ2 3
;
ÙÙ3 4
}
ÚÚ 
catch
ÛÛ 
(
ÛÛ 
	Exception
ÛÛ 
ex
ÛÛ 
)
ÛÛ  
{
ÜÜ 
FDebug
İİ 
.
İİ 
throwException
İİ %
(
İİ% &
ex
İİ& (
)
İİ( )
;
İİ) *
}
ŞŞ 
finally
ßß 
{
àà 
}
ââ 
}
ãã 	
public
çç 
Message
çç 
requestReply
çç #
(
çç# $
Message
èè 
req
èè 
,
èè 
bool
éé 
async
éé 
)
êê 
{
ëë 	#
FH101RequestReplyData
ìì !
fData
ìì" '
=
ìì( )
null
ìì* .
;
ìì. /
Thread
íí 
asyncThread
íí 
=
íí  
null
íí! %
;
íí% &
try
ïï 
{
ğğ 
fData
ññ 
=
ññ 
new
ññ #
FH101RequestReplyData
ññ 1
(
ññ1 2
req
ññ2 5
)
ññ5 6
;
ññ6 7
asyncThread
õõ 
=
õõ 
new
õõ !
Thread
õõ" (
(
õõ( )
new
õõ) ,&
ParameterizedThreadStart
õõ- E
(
õõE F%
requestReplyAsyncThread
õõF ]
)
õõ] ^
)
õõ^ _
;
õõ_ `
asyncThread
öö 
.
öö 
Start
öö !
(
öö! "
fData
öö" '
)
öö' (
;
öö( )
while
øø 
(
øø 
!
øø 
fData
øø 
.
øø 
	completed
øø '
)
øø' (
{
ùù 
if
úú 
(
úú 
async
úú 
)
úú 
{
ûû 
System
üü 
.
üü 
Windows
üü &
.
üü& '
Forms
üü' ,
.
üü, -
Application
üü- 8
.
üü8 9
DoEvents
üü9 A
(
üüA B
)
üüB C
;
üüC D
}
ıı 
System
şş 
.
şş 
	Threading
şş $
.
şş$ %
Thread
şş% +
.
şş+ ,
Sleep
şş, 1
(
şş1 2
$num
şş2 3
)
şş3 4
;
şş4 5
}
ÿÿ 
if
ƒƒ 
(
ƒƒ 
!
ƒƒ 
fData
ƒƒ 
.
ƒƒ 
result
ƒƒ !
)
ƒƒ! "
{
„„ 
FDebug
…… 
.
…… 
throwFException
…… *
(
……* +
fData
……+ 0
.
……0 1
message
……1 8
)
……8 9
;
……9 :
}
†† 
return
ŠŠ 
fData
ŠŠ 
.
ŠŠ 
rep
ŠŠ  
;
ŠŠ  !
}
‹‹ 
catch
ŒŒ 
(
ŒŒ 
	Exception
ŒŒ 
ex
ŒŒ 
)
ŒŒ  
{
 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
 
{
‘‘ 
if
’’ 
(
’’ 
fData
’’ 
!=
’’ 
null
’’ !
)
’’! "
{
““ 
fData
”” 
.
”” 
Dispose
”” !
(
””! "
)
””" #
;
””# $
fData
•• 
=
•• 
null
••  
;
••  !
}
–– 
asyncThread
—— 
=
—— 
null
—— "
;
——" #
}
˜˜ 
return
™™ 
null
™™ 
;
™™ 
}
šš 	
public
¢¢ 
void
¢¢ 
	onUnicast
¢¢ 
(
¢¢ 
Session
££ 
session
££ 
,
££ 
Message
¤¤ 
msg
¤¤ 
)
¥¥ 
{
¦¦ 	
FIH101Dispatcher
§§ 
tuner
§§ "
=
§§# $
null
§§% )
;
§§) *
string
¨¨ 
version
¨¨ 
=
¨¨ 
null
¨¨ !
;
¨¨! "
string
©© 
module
©© 
=
©© 
null
©©  
;
©©  !
UInt32
ªª 
tid
ªª 
=
ªª 
$num
ªª 
;
ªª 
string
«« 
strTid
«« 
=
«« 
string
«« "
.
««" #
Empty
««# (
;
««( )
try
­­ 
{
®® 
version
³³ 
=
³³ 
(
³³ 
string
³³ !
)
³³! "
msg
³³" %
.
³³% &
getProperty
³³& 1
(
³³1 2
FH101
³³2 7
.
³³7 8
XGEN_TAG_VERSION
³³8 H
)
³³H I
;
³³I J
module
»» 
=
»» 
(
»» 
string
»»  
)
»»  !
msg
»»! $
.
»»$ %
getProperty
»»% 0
(
»»0 1
FH101
»»1 6
.
»»6 7
XGEN_TAG_MODULE
»»7 F
)
»»F G
;
»»G H
if
¼¼ 
(
¼¼ 
string
¼¼ 
.
¼¼ 
IsNullOrEmpty
¼¼ (
(
¼¼( )
module
¼¼) /
)
¼¼/ 0
||
¼¼1 3
!
¼¼4 5
m_dispatchers
¼¼5 B
.
¼¼B C
ContainsKey
¼¼C N
(
¼¼N O
module
¼¼O U
)
¼¼U V
)
¼¼V W
{
½½ 
FDebug
¾¾ 
.
¾¾ 
throwFException
¾¾ *
(
¾¾* +
string
¾¾+ 1
.
¾¾1 2
Format
¾¾2 8
(
¾¾8 9
$str
¾¾9 Y
,
¾¾Y Z
module
¾¾[ a
)
¾¾a b
)
¾¾b c
;
¾¾c d
}
¿¿ 
strTid
ÃÃ 
=
ÃÃ 
(
ÃÃ 
string
ÃÃ  
)
ÃÃ  !
msg
ÃÃ! $
.
ÃÃ$ %
getProperty
ÃÃ% 0
(
ÃÃ0 1
FH101
ÃÃ1 6
.
ÃÃ6 7
XGEN_TAG_TID
ÃÃ7 C
)
ÃÃC D
;
ÃÃD E
if
ÄÄ 
(
ÄÄ 
string
ÄÄ 
.
ÄÄ 
IsNullOrEmpty
ÄÄ (
(
ÄÄ( )
strTid
ÄÄ) /
)
ÄÄ/ 0
||
ÄÄ1 3
!
ÄÄ4 5
UInt32
ÄÄ5 ;
.
ÄÄ; <
TryParse
ÄÄ< D
(
ÄÄD E
strTid
ÄÄE K
,
ÄÄK L
out
ÄÄM P
tid
ÄÄQ T
)
ÄÄT U
)
ÄÄU V
{
ÅÅ 
tid
ÆÆ 
=
ÆÆ 
m_fH101
ÆÆ !
.
ÆÆ! "
fTidPointer
ÆÆ" -
.
ÆÆ- .
uniqueId
ÆÆ. 6
;
ÆÆ6 7
}
ÇÇ 
tuner
ËË 
=
ËË 
(
ËË 
FIH101Dispatcher
ËË )
)
ËË) *
m_dispatchers
ËË* 7
[
ËË7 8
module
ËË8 >
]
ËË> ?
;
ËË? @
tuner
ÌÌ 
.
ÌÌ 
dispatch
ÌÌ 
(
ÌÌ 
new
ÌÌ "#
FH101DataReceivedArgs
ÌÌ# 8
(
ÌÌ8 9
m_fH101
ÌÌ9 @
,
ÌÌ@ A
msg
ÌÌB E
,
ÌÌE F
msg
ÌÌG J
.
ÌÌJ K

getChannel
ÌÌK U
(
ÌÌU V
)
ÌÌV W
,
ÌÌW X
tid
ÌÌY \
)
ÌÌ\ ]
)
ÌÌ] ^
;
ÌÌ^ _
}
ÍÍ 
catch
ÎÎ 
(
ÎÎ 
	Exception
ÎÎ 
ex
ÎÎ 
)
ÎÎ  
{
ÏÏ 
m_fH101
ĞĞ 
.
ĞĞ 
onH101ErrorRaised
ĞĞ )
(
ĞĞ) *
ex
ĞĞ* ,
)
ĞĞ, -
;
ĞĞ- .
}
ÑÑ 
finally
ÒÒ 
{
ÓÓ 
tuner
ÔÔ 
=
ÔÔ 
null
ÔÔ 
;
ÔÔ 
}
ÕÕ 
}
ÖÖ 	
public
ÚÚ 
void
ÚÚ 
onMulticast
ÚÚ 
(
ÚÚ  
Session
ÛÛ 
session
ÛÛ 
,
ÛÛ 
Message
ÜÜ 
msg
ÜÜ 
)
İİ 
{
ŞŞ 	
try
ßß 
{
àà 
	onUnicast
áá 
(
áá 
session
áá !
,
áá! "
msg
áá# &
)
áá& '
;
áá' (
}
ââ 
catch
ãã 
(
ãã 
	Exception
ãã 
ex
ãã 
)
ãã  
{
ää 
m_fH101
åå 
.
åå 
onH101ErrorRaised
åå )
(
åå) *
ex
åå* ,
)
åå, -
;
åå- .
}
ææ 
finally
çç 
{
èè 
}
êê 
}
ëë 	
public
ïï 
void
ïï 

onGUnicast
ïï 
(
ïï 
Session
ğğ 
session
ğğ 
,
ğğ 
Message
ññ 
msg
ññ 
)
òò 
{
óó 	
try
ôô 
{
õõ 
	onUnicast
öö 
(
öö 
session
öö !
,
öö! "
msg
öö# &
)
öö& '
;
öö' (
}
÷÷ 
catch
øø 
(
øø 
	Exception
øø 
ex
øø 
)
øø  
{
ùù 
m_fH101
úú 
.
úú 
onH101ErrorRaised
úú )
(
úú) *
ex
úú* ,
)
úú, -
;
úú- .
}
ûû 
finally
üü 
{
ıı 
}
ÿÿ 
}
€€ 	
public
„„ 
void
„„ 
onGMulticast
„„  
(
„„  !
Session
…… 
session
…… 
,
…… 
Message
†† 
msg
†† 
)
‡‡ 
{
ˆˆ 	
try
‰‰ 
{
ŠŠ 
	onUnicast
‹‹ 
(
‹‹ 
session
‹‹ !
,
‹‹! "
msg
‹‹# &
)
‹‹& '
;
‹‹' (
}
ŒŒ 
catch
 
(
 
	Exception
 
ex
 
)
  
{
 
m_fH101
 
.
 
onH101ErrorRaised
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
‘‘ 
{
’’ 
}
”” 
}
•• 	
public
™™ 
void
™™ 
	onRequest
™™ 
(
™™ 
Session
šš 
session
šš 
,
šš 
Message
›› 
msg
›› 
)
œœ 
{
 	
FIH101Dispatcher
 
tuner
 "
=
# $
null
% )
;
) *
string
ŸŸ 
version
ŸŸ 
=
ŸŸ 
null
ŸŸ !
;
ŸŸ! "
string
   
module
   
=
   
null
    
;
    !
UInt32
¡¡ 
tid
¡¡ 
=
¡¡ 
$num
¡¡ 
;
¡¡ 
string
¢¢ 
strTid
¢¢ 
=
¢¢ 
string
¢¢ "
.
¢¢" #
Empty
¢¢# (
;
¢¢( )
try
¤¤ 
{
¥¥ 
version
ªª 
=
ªª 
(
ªª 
string
ªª !
)
ªª! "
msg
ªª" %
.
ªª% &
getProperty
ªª& 1
(
ªª1 2
FH101
ªª2 7
.
ªª7 8
XGEN_TAG_VERSION
ªª8 H
)
ªªH I
;
ªªI J
module
³³ 
=
³³ 
(
³³ 
string
³³  
)
³³  !
msg
³³! $
.
³³$ %
getProperty
³³% 0
(
³³0 1
FH101
³³1 6
.
³³6 7
XGEN_TAG_MODULE
³³7 F
)
³³F G
;
³³G H
if
´´ 
(
´´ 
string
´´ 
.
´´ 
IsNullOrEmpty
´´ (
(
´´( )
module
´´) /
)
´´/ 0
||
´´1 3
!
´´4 5
m_dispatchers
´´5 B
.
´´B C
ContainsKey
´´C N
(
´´N O
module
´´O U
)
´´U V
)
´´V W
{
µµ 
	sendReply
¶¶ 
(
¶¶ 
msg
¶¶ !
,
¶¶! "
msg
¶¶# &
.
¶¶& '
createReply
¶¶' 2
(
¶¶2 3
)
¶¶3 4
,
¶¶4 5
$str
¶¶6 ;
,
¶¶; <
$str
¶¶= Q
)
¶¶Q R
;
¶¶R S
FDebug
·· 
.
·· 
throwFException
·· *
(
··* +
string
··+ 1
.
··1 2
Format
··2 8
(
··8 9
$str
··9 Y
,
··Y Z
module
··[ a
)
··a b
)
··b c
;
··c d
}
¸¸ 
strTid
¼¼ 
=
¼¼ 
(
¼¼ 
string
¼¼  
)
¼¼  !
msg
¼¼! $
.
¼¼$ %
getProperty
¼¼% 0
(
¼¼0 1
FH101
¼¼1 6
.
¼¼6 7
XGEN_TAG_TID
¼¼7 C
)
¼¼C D
;
¼¼D E
if
½½ 
(
½½ 
string
½½ 
.
½½ 
IsNullOrEmpty
½½ (
(
½½( )
strTid
½½) /
)
½½/ 0
||
½½1 3
!
½½4 5
UInt32
½½5 ;
.
½½; <
TryParse
½½< D
(
½½D E
strTid
½½E K
,
½½K L
out
½½M P
tid
½½Q T
)
½½T U
)
½½U V
{
¾¾ 
tid
¿¿ 
=
¿¿ 
m_fH101
¿¿ !
.
¿¿! "
fTidPointer
¿¿" -
.
¿¿- .
uniqueId
¿¿. 6
;
¿¿6 7
}
ÀÀ 
tuner
ÄÄ 
=
ÄÄ 
(
ÄÄ 
FIH101Dispatcher
ÄÄ )
)
ÄÄ) *
m_dispatchers
ÄÄ* 7
[
ÄÄ7 8
module
ÄÄ8 >
]
ÄÄ> ?
;
ÄÄ? @
tuner
ÅÅ 
.
ÅÅ 
dispatch
ÅÅ 
(
ÅÅ 
new
ÅÅ "#
FH101DataReceivedArgs
ÅÅ# 8
(
ÅÅ8 9
m_fH101
ÅÅ9 @
,
ÅÅ@ A
msg
ÅÅB E
,
ÅÅE F
msg
ÅÅG J
.
ÅÅJ K

getChannel
ÅÅK U
(
ÅÅU V
)
ÅÅV W
,
ÅÅW X
tid
ÅÅY \
)
ÅÅ\ ]
)
ÅÅ] ^
;
ÅÅ^ _
}
ÆÆ 
catch
ÇÇ 
(
ÇÇ 
	Exception
ÇÇ 
ex
ÇÇ 
)
ÇÇ  
{
ÈÈ 
m_fH101
ÉÉ 
.
ÉÉ 
onH101ErrorRaised
ÉÉ )
(
ÉÉ) *
ex
ÉÉ* ,
)
ÉÉ, -
;
ÉÉ- .
}
ÊÊ 
finally
ËË 
{
ÌÌ 
tuner
ÍÍ 
=
ÍÍ 
null
ÍÍ 
;
ÍÍ 
}
ÎÎ 
}
ÏÏ 	
public
ÓÓ 
void
ÓÓ 
onReply
ÓÓ 
(
ÓÓ 
Session
ÔÔ 
session
ÔÔ 
,
ÔÔ 
Message
ÕÕ 
req
ÕÕ 
,
ÕÕ 
Message
ÖÖ 
rep
ÖÖ 
,
ÖÖ 
object
×× 
hint
×× 
)
ØØ 
{
ÙÙ 	
FIH101Dispatcher
ÚÚ 
tuner
ÚÚ "
=
ÚÚ# $
null
ÚÚ% )
;
ÚÚ) *
string
ÛÛ 
version
ÛÛ 
=
ÛÛ 
null
ÛÛ !
;
ÛÛ! "
string
ÜÜ 
module
ÜÜ 
=
ÜÜ 
null
ÜÜ  
;
ÜÜ  !
UInt32
İİ 
tid
İİ 
=
İİ 
$num
İİ 
;
İİ 
string
ŞŞ 
strTid
ŞŞ 
=
ŞŞ 
string
ŞŞ "
.
ŞŞ" #
Empty
ŞŞ# (
;
ŞŞ( )
try
àà 
{
áá 
version
ææ 
=
ææ 
(
ææ 
string
ææ !
)
ææ! "
req
ææ" %
.
ææ% &
getProperty
ææ& 1
(
ææ1 2
FH101
ææ2 7
.
ææ7 8
XGEN_TAG_VERSION
ææ8 H
)
ææH I
;
ææI J
module
îî 
=
îî 
(
îî 
string
îî  
)
îî  !
req
îî! $
.
îî$ %
getProperty
îî% 0
(
îî0 1
FH101
îî1 6
.
îî6 7
XGEN_TAG_MODULE
îî7 F
)
îîF G
;
îîG H
if
ïï 
(
ïï 
string
ïï 
.
ïï 
IsNullOrEmpty
ïï (
(
ïï( )
module
ïï) /
)
ïï/ 0
||
ïï1 3
!
ïï4 5
m_dispatchers
ïï5 B
.
ïïB C
ContainsKey
ïïC N
(
ïïN O
module
ïïO U
)
ïïU V
)
ïïV W
{
ğğ 
FDebug
ññ 
.
ññ 
throwFException
ññ *
(
ññ* +
string
ññ+ 1
.
ññ1 2
Format
ññ2 8
(
ññ8 9
$str
ññ9 Y
,
ññY Z
module
ññ[ a
)
ñña b
)
ññb c
;
ññc d
}
òò 
strTid
öö 
=
öö 
(
öö 
string
öö  
)
öö  !
req
öö! $
.
öö$ %
getProperty
öö% 0
(
öö0 1
FH101
öö1 6
.
öö6 7
XGEN_TAG_TID
öö7 C
)
ööC D
;
ööD E
if
÷÷ 
(
÷÷ 
string
÷÷ 
.
÷÷ 
IsNullOrEmpty
÷÷ (
(
÷÷( )
strTid
÷÷) /
)
÷÷/ 0
||
÷÷1 3
!
÷÷4 5
UInt32
÷÷5 ;
.
÷÷; <
TryParse
÷÷< D
(
÷÷D E
strTid
÷÷E K
,
÷÷K L
out
÷÷M P
tid
÷÷Q T
)
÷÷T U
)
÷÷U V
{
øø 
tid
ùù 
=
ùù 
m_fH101
ùù !
.
ùù! "
fTidPointer
ùù" -
.
ùù- .
uniqueId
ùù. 6
;
ùù6 7
}
úú 
tuner
şş 
=
şş 
(
şş 
FIH101Dispatcher
şş )
)
şş) *
m_dispatchers
şş* 7
[
şş7 8
module
şş8 >
]
şş> ?
;
şş? @
tuner
ÿÿ 
.
ÿÿ 
dispatch
ÿÿ 
(
ÿÿ 
new
ÿÿ "#
FH101DataReceivedArgs
ÿÿ# 8
(
ÿÿ8 9
m_fH101
ÿÿ9 @
,
ÿÿ@ A
rep
ÿÿB E
,
ÿÿE F
req
ÿÿG J
.
ÿÿJ K

getChannel
ÿÿK U
(
ÿÿU V
)
ÿÿV W
,
ÿÿW X
tid
ÿÿY \
)
ÿÿ\ ]
)
ÿÿ] ^
;
ÿÿ^ _
}
€€ 
catch
 
(
 
	Exception
 
ex
 
)
  
{
‚‚ 
m_fH101
ƒƒ 
.
ƒƒ 
onH101ErrorRaised
ƒƒ )
(
ƒƒ) *
ex
ƒƒ* ,
)
ƒƒ, -
;
ƒƒ- .
}
„„ 
finally
…… 
{
†† 
tuner
‡‡ 
=
‡‡ 
null
‡‡ 
;
‡‡ 
}
ˆˆ 
}
‰‰ 	
public
 
void
 
	onTimeout
 
(
 
Session
 
sensor
 
,
 
Message
 
req
 
)
 
{
‘‘ 	
try
’’ 
{
““ 
FDebug
”” 
.
”” 
throwFException
”” &
(
””& '
$str
””' >
)
””> ?
;
””? @
}
•• 
catch
–– 
(
–– 
	Exception
–– 
ex
–– 
)
––  
{
—— 
m_fH101
˜˜ 
.
˜˜ 
onH101ErrorRaised
˜˜ )
(
˜˜) *
ex
˜˜* ,
)
˜˜, -
;
˜˜- .
}
™™ 
finally
šš 
{
›› 
}
 
}
 	
}
¤¤ 
}¥¥ ş
_D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\H101\i_FIH101Dispatcher.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

	interface 
FIH101Dispatcher %
{ 
	Exception 
dispatch 
( !
FH101DataReceivedArgs !
e" #
) 
; 
}## 
}$$ î
WD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Network\c_FPing.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

static 
class 
FPing 
{ 
static 
FPing 
( 
) 
{ 	
}   	
public.. 
static.. 
bool.. 
send.. 
(..  
string// 
address// 
,// 
params00 
int00 
[00 
]00 
timeouts00 !
)11 
{22 	
Ping33 
ping33 
=33 
null33 
;33 
PingOptions44 
pingOpt44 
=44  !
null44" &
;44& '
	PingReply55 
pingRep55 
=55 
null55  $
;55$ %
byte66 
[66 
]66 
buf66 
=66 
null66 
;66 
try88 
{99 
ping:: 
=:: 
new:: 
Ping:: 
(::  
)::  !
;::! "
pingOpt;; 
=;; 
new;; 
PingOptions;; )
(;;) *
);;* +
;;;+ ,
pingOpt<< 
.<< 
DontFragment<< $
=<<% &
true<<' +
;<<+ ,
buf== 
=== 
Encoding== 
.== 
ASCII== $
.==$ %
GetBytes==% -
(==- .
$str==. P
)==P Q
;==Q R
foreach?? 
(?? 
int?? 
timeout?? $
in??% '
timeouts??( 0
)??0 1
{@@ 
pingRepAA 
=AA 
pingAA "
.AA" #
SendAA# '
(AA' (
addressAA( /
,AA/ 0
timeoutAA1 8
,AA8 9
bufAA: =
,AA= >
pingOptAA? F
)AAF G
;AAG H
ifBB 
(BB 
pingRepBB 
.BB  
StatusBB  &
==BB' )
IPStatusBB* 2
.BB2 3
SuccessBB3 :
)BB: ;
{CC 
returnDD 
trueDD #
;DD# $
}EE 
}FF 
returnGG 
falseGG 
;GG 
}HH 
catchII 
(II 
	ExceptionII 
exII 
)II  
{JJ 
FDebugKK 
.KK 
throwExceptionKK %
(KK% &
exKK& (
)KK( )
;KK) *
}LL 
finallyMM 
{NN 
pingOO 
=OO 
nullOO 
;OO 
pingOptPP 
=PP 
nullPP 
;PP 
pingRepQQ 
=QQ 
nullQQ 
;QQ 
bufRR 
=RR 
nullRR 
;RR 
}SS 
returnTT 
falseTT 
;TT 
}UU 	
}[[ 
}\\ ˆ1
kD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Resource\c_FSystemResourceEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class $
FSystemResourceEventArgs )
:* +
IDisposable, 7
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
string 
m_cpu 
= 
string %
.% &
Empty& +
;+ ,
private 
double 

m_cpuUsage !
=" #
$num$ %
;% &
private 
double 
m_memory 
=  !
$num" #
;# $
private 
double 
m_memoryFreeSize '
=( )
$num* +
;+ ,
private "
FLogicalDiskCollection &
m_fLogicalDiskCol' 8
=9 :
null; ?
;? @
public%% $
FSystemResourceEventArgs%% '
(%%' (
string&& 
cpu&& 
,&& 
double'' 
cpuUsage'' 
,'' 
double(( 
memory(( 
,(( 
double)) 
memoryFreeSize)) !
,))! ""
FLogicalDiskCollection** "
fLogicalDiskCol**# 2
)++ 
{,, 	
m_cpu-- 
=-- 
cpu-- 
;-- 

m_cpuUsage.. 
=.. 
cpuUsage.. !
;..! "
m_memory// 
=// 
memory// 
;// 
m_memoryFreeSize00 
=00 
memoryFreeSize00 -
;00- .
m_fLogicalDiskCol11 
=11 
fLogicalDiskCol11  /
;11/ 0
}22 	
~66 	$
FSystemResourceEventArgs66	 !
(66! "
)77 
{88 	
	myDispose99 
(99 
false99 
)99 
;99 
}:: 	
	protected>> 
void>> 
	myDispose>>  
(>>  !
bool?? 
	disposing?? 
)@@ 
{AA 	
ifBB 
(BB 
!BB 

m_disposedBB 
)BB 
{CC 
ifDD 
(DD 
	disposingDD 
)DD 
{EE 
m_fLogicalDiskColFF %
=FF& '
nullFF( ,
;FF, -
}GG 

m_disposedII 
=II 
trueII !
;II! "
}JJ 
}KK 	
publicSS 
voidSS 
DisposeSS 
(SS 
)TT 
{UU 	
	myDisposeVV 
(VV 
trueVV 
)VV 
;VV 
GCWW 
.WW 
SuppressFinalizeWW 
(WW  
thisWW  $
)WW$ %
;WW% &
}XX 	
public`` 
string`` 
cpu`` 
{aa 	
getbb 
{cc 
trydd 
{ee 
returnff 
m_cpuff  
;ff  !
}gg 
catchhh 
(hh 
	Exceptionhh  
exhh! #
)hh# $
{ii 
FDebugjj 
.jj 
throwExceptionjj )
(jj) *
exjj* ,
)jj, -
;jj- .
}kk 
finallyll 
{mm 
}oo 
returnpp 
stringpp 
.pp 
Emptypp #
;pp# $
}qq 
}rr 	
publicvv 
doublevv 
cpuUsagevv 
{ww 	
getxx 
{yy 
tryzz 
{{{ 
return|| 

m_cpuUsage|| %
;||% &
}}} 
catch~~ 
(~~ 
	Exception~~  
ex~~! #
)~~# $
{ 
FDebug
€€ 
.
€€ 
throwException
€€ )
(
€€) *
ex
€€* ,
)
€€, -
;
€€- .
}
 
finally
‚‚ 
{
ƒƒ 
}
…… 
return
†† 
$num
†† 
;
†† 
}
‡‡ 
}
ˆˆ 	
public
ŒŒ 
double
ŒŒ 
memory
ŒŒ 
{
 	
get
 
{
 
try
 
{
‘‘ 
return
’’ 
m_memory
’’ #
;
’’# $
}
““ 
catch
”” 
(
”” 
	Exception
””  
ex
””! #
)
””# $
{
•• 
FDebug
–– 
.
–– 
throwException
–– )
(
––) *
ex
––* ,
)
––, -
;
––- .
}
—— 
finally
˜˜ 
{
™™ 
}
›› 
return
œœ 
$num
œœ 
;
œœ 
}
 
}
 	
public
¢¢ 
double
¢¢ 
memoryFreeSize
¢¢ $
{
££ 	
get
¤¤ 
{
¥¥ 
try
¦¦ 
{
§§ 
return
¨¨ 
m_memoryFreeSize
¨¨ +
;
¨¨+ ,
}
©© 
catch
ªª 
(
ªª 
	Exception
ªª  
ex
ªª! #
)
ªª# $
{
«« 
FDebug
¬¬ 
.
¬¬ 
throwException
¬¬ )
(
¬¬) *
ex
¬¬* ,
)
¬¬, -
;
¬¬- .
}
­­ 
finally
®® 
{
¯¯ 
}
±± 
return
²² 
$num
²² 
;
²² 
}
³³ 
}
´´ 	
public
¸¸ $
FLogicalDiskCollection
¸¸ %
logicalDiskCol
¸¸& 4
{
¹¹ 	
get
ºº 
{
»» 
try
½½ 
{
¾¾ 
return
¿¿ 
m_fLogicalDiskCol
¿¿ ,
;
¿¿, -
}
ÀÀ 
catch
ÁÁ 
(
ÁÁ 
	Exception
ÁÁ  
ex
ÁÁ! #
)
ÁÁ# $
{
ÂÂ 
FDebug
ÃÃ 
.
ÃÃ 
throwException
ÃÃ )
(
ÃÃ) *
ex
ÃÃ* ,
)
ÃÃ, -
;
ÃÃ- .
}
ÄÄ 
finally
ÅÅ 
{
ÆÆ 
}
ÈÈ 
return
ÉÉ 
null
ÉÉ 
;
ÉÉ 
}
ÊÊ 
}
ËË 	
}
×× 
}ØØ Õ:
iD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Resource\c_FLogicalDiskCollection.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class "
FLogicalDiskCollection '
:( )
IDisposable* 5
,5 6
IEnumerable7 B
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 

Dictionary 
< 
string !
,! "
FLogicalDisk# /
>/ 0

m_diskDict1 ;
=< =
null> B
;B C
private 
List 
< 
FLogicalDisk !
>! "

m_diskList# -
=. /
null0 4
;4 5
internal## "
FLogicalDiskCollection## '
(##' (

Dictionary$$ 
<$$ 
string$$ 
,$$ 
FLogicalDisk$$ +
>$$+ ,
diskDict$$- 5
,$$5 6
List%% 
<%% 
FLogicalDisk%% 
>%% 
diskList%% '
)&& 
{'' 	

m_diskDict(( 
=(( 
diskDict(( !
;((! "

m_diskList)) 
=)) 
diskList)) !
;))! "
}** 	
~.. 	"
FLogicalDiskCollection..	 
(..  
)// 
{00 	
	myDispose11 
(11 
false11 
)11 
;11 
}22 	
	protected66 
void66 
	myDispose66  
(66  !
bool77 
	disposing77 
)88 
{99 	
if:: 
(:: 
!:: 

m_disposed:: 
):: 
{;; 
if<< 
(<< 
	disposing<< 
)<< 
{== 

m_diskDict>> 
=>>  
null>>! %
;>>% &

m_diskList?? 
=??  
null??! %
;??% &
}@@ 
}AA 

m_disposedCC 
=CC 
trueCC 
;CC 
}DD 	
publicLL 
voidLL 
DisposeLL 
(LL 
)MM 
{NN 	
	myDisposeOO 
(OO 
trueOO 
)OO 
;OO 
GCPP 
.PP 
SuppressFinalizePP 
(PP  
thisPP  $
)PP$ %
;PP% &
}QQ 	
publicYY 
IEnumeratorYY 
GetEnumeratorYY (
(YY( )
)ZZ 
{[[ 	
try\\ 
{]] 
return^^ 
new^^ ,
 FLogicalDiskCollectionEnumerator^^ ;
(^^; <
this^^< @
)^^@ A
;^^A B
}__ 
catch`` 
(`` 
	Exception`` 
ex`` 
)``  
{aa 
FDebugbb 
.bb 
throwExceptionbb %
(bb% &
exbb& (
)bb( )
;bb) *
}cc 
finallydd 
{ee 
}ff 
returngg 
nullgg 
;gg 
}hh 	
publicll 
intll 
countll 
{mm 	
getnn 
{oo 
trypp 
{qq 
returnrr 

m_diskListrr %
.rr% &
Countrr& +
;rr+ ,
}ss 
catchtt 
(tt 
	Exceptiontt  
extt! #
)tt# $
{uu 
FDebugvv 
.vv 
throwExceptionvv )
(vv) *
exvv* ,
)vv, -
;vv- .
}ww 
finallyxx 
{yy 
}{{ 
return|| 
$num|| 
;|| 
}}} 
}~~ 	
public
‚‚ 
FLogicalDisk
‚‚ 
this
‚‚  
[
‚‚  !
int
‚‚! $
i
‚‚% &
]
‚‚& '
{
ƒƒ 	
get
„„ 
{
…… 
try
†† 
{
‡‡ 
if
ˆˆ 
(
ˆˆ 
i
ˆˆ 
<
ˆˆ 
$num
ˆˆ 
||
ˆˆ  
i
ˆˆ! "
>=
ˆˆ# %

m_diskList
ˆˆ& 0
.
ˆˆ0 1
Count
ˆˆ1 6
)
ˆˆ6 7
{
‰‰ 
return
ŠŠ 
null
ŠŠ #
;
ŠŠ# $
}
‹‹ 
return
ŒŒ 

m_diskList
ŒŒ %
[
ŒŒ% &
i
ŒŒ& '
]
ŒŒ' (
;
ŒŒ( )
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
‘‘ 
finally
’’ 
{
““ 
}
•• 
return
–– 
null
–– 
;
–– 
}
—— 
}
˜˜ 	
public
œœ 
FLogicalDisk
œœ 
this
œœ  
[
œœ  !
string
œœ! '
name
œœ( ,
]
œœ, -
{
 	
get
 
{
ŸŸ 
try
   
{
¡¡ 
if
¢¢ 
(
¢¢ 
!
¢¢ 

m_diskDict
¢¢ #
.
¢¢# $
ContainsKey
¢¢$ /
(
¢¢/ 0
name
¢¢0 4
)
¢¢4 5
)
¢¢5 6
{
££ 
return
¤¤ 
null
¤¤ #
;
¤¤# $
}
¥¥ 
return
¦¦ 

m_diskDict
¦¦ %
[
¦¦% &
name
¦¦& *
]
¦¦* +
;
¦¦+ ,
}
§§ 
catch
¨¨ 
(
¨¨ 
	Exception
¨¨  
ex
¨¨! #
)
¨¨# $
{
©© 
FDebug
ªª 
.
ªª 
throwException
ªª )
(
ªª) *
ex
ªª* ,
)
ªª, -
;
ªª- .
}
«« 
finally
¬¬ 
{
­­ 
}
¯¯ 
return
°° 
null
°° 
;
°° 
}
±± 
}
²² 	
public
ºº 
object
ºº 
item
ºº 
(
ºº 
int
»» 
index
»» 
)
¼¼ 
{
½½ 	
try
¾¾ 
{
¿¿ 
return
ÀÀ 
this
ÀÀ 
[
ÀÀ 
index
ÀÀ !
]
ÀÀ! "
;
ÀÀ" #
}
ÁÁ 
catch
ÂÂ 
(
ÂÂ 
	Exception
ÂÂ 
ex
ÂÂ 
)
ÂÂ  
{
ÃÃ 
FDebug
ÄÄ 
.
ÄÄ 
throwException
ÄÄ %
(
ÄÄ% &
ex
ÄÄ& (
)
ÄÄ( )
;
ÄÄ) *
}
ÅÅ 
finally
ÆÆ 
{
ÇÇ 
}
ÉÉ 
return
ÊÊ 
null
ÊÊ 
;
ÊÊ 
}
ËË 	
public
ÏÏ 
object
ÏÏ 
item
ÏÏ 
(
ÏÏ 
string
ĞĞ 
name
ĞĞ 
)
ÑÑ 
{
ÒÒ 	
try
ÓÓ 
{
ÔÔ 
return
ÕÕ 
this
ÕÕ 
[
ÕÕ 
name
ÕÕ  
]
ÕÕ  !
;
ÕÕ! "
}
ÖÖ 
catch
×× 
(
×× 
	Exception
×× 
ex
×× 
)
××  
{
ØØ 
FDebug
ÙÙ 
.
ÙÙ 
throwException
ÙÙ %
(
ÙÙ% &
ex
ÙÙ& (
)
ÙÙ( )
;
ÙÙ) *
}
ÚÚ 
finally
ÛÛ 
{
ÜÜ 
}
ŞŞ 
return
ßß 
null
ßß 
;
ßß 
}
àà 	
}
ææ 
}çç Å
sD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Resource\c_FLogicalDiskCollectionEnumerator.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class ,
 FLogicalDiskCollectionEnumerator 1
:2 3
IEnumerator4 ?
,? @
IDisposableA L
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
int 
m_index 
= 
- 
$num  
;  !
private "
FLogicalDiskCollection &
m_diskCollection' 7
=8 9
null: >
;> ?
public## ,
 FLogicalDiskCollectionEnumerator## /
(##/ 0"
FLogicalDiskCollection$$ "
diskCollection$$# 1
)%% 
{&& 	
m_diskCollection'' 
='' 
diskCollection'' -
;''- .
}(( 	
~,, 	,
 FLogicalDiskCollectionEnumerator,,	 )
(,,) *
)-- 
{.. 	
}00 	
	protected44 
void44 
	myDispose44  
(44  !
bool55 
	disposing55 
)66 
{77 	
if88 
(88 
!88 

m_disposed88 
)88 
{99 
if:: 
(:: 
	disposing:: 
):: 
{;; 
m_diskCollection<< $
=<<% &
null<<' +
;<<+ ,
}== 
}>> 

m_disposed?? 
=?? 
true?? 
;?? 
}@@ 	
publicHH 
voidHH 
DisposeHH 
(HH 
)II 
{JJ 	
	myDisposeKK 
(KK 
trueKK 
)KK 
;KK 
}LL 	
publicTT 
objectTT 
CurrentTT 
{UU 	
getVV 
{WW 
tryXX 
{YY 
returnZZ 
m_diskCollectionZZ +
[ZZ+ ,
m_indexZZ, 3
]ZZ3 4
;ZZ4 5
}[[ 
catch\\ 
(\\ 
	Exception\\  
ex\\! #
)\\# $
{]] 
FDebug^^ 
.^^ 
throwException^^ )
(^^) *
ex^^* ,
)^^, -
;^^- .
}__ 
finally`` 
{aa 
}cc 
returndd 
nulldd 
;dd 
}ee 
}ff 	
publicjj 
booljj 
MoveNextjj 
(jj 
)kk 
{ll 	
trymm 
{nn 
m_indexoo 
++oo 
;oo 
returnpp 
(pp 
m_indexpp 
<pp  !
m_diskCollectionpp" 2
.pp2 3
countpp3 8
)pp8 9
;pp9 :
}qq 
catchrr 
(rr 
Systemrr 
.rr 
	Exceptionrr #
exrr$ &
)rr& '
{ss 
FDebugtt 
.tt 
throwExceptiontt %
(tt% &
extt& (
)tt( )
;tt) *
}uu 
finallyvv 
{ww 
}yy 
returnzz 
falsezz 
;zz 
}{{ 	
public 
void 
Reset 
( 
)
€€ 
{
 	
try
‚‚ 
{
ƒƒ 
m_index
„„ 
=
„„ 
-
„„ 
$num
„„ 
;
„„ 
}
…… 
catch
†† 
(
†† 
System
†† 
.
†† 
	Exception
†† #
ex
††$ &
)
††& '
{
‡‡ 
FDebug
ˆˆ 
.
ˆˆ 
throwException
ˆˆ %
(
ˆˆ% &
ex
ˆˆ& (
)
ˆˆ( )
;
ˆˆ) *
}
‰‰ 
finally
ŠŠ 
{
‹‹ 
}
 
}
 	
}
”” 
}•• úü
YD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Security\c_FCrypt.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FCrypt 
: 
IDisposable %
{ 
[ 	
	DllImport	 
( 
$str <
,< =

EntryPoint> H
=I J
$strK U
,U V
CallingConventionW h
=i j
CallingConventionk |
.| }
Cdecl	} ‚
)
‚ ƒ
]
ƒ „
internal 
static 
extern 
IntPtr %
	encrypt32& /
(/ 0
IntPtr0 6
	plainData7 @
)@ A
;A B
[!! 	
	DllImport!!	 
(!! 
$str!! <
,!!< =

EntryPoint!!> H
=!!I J
$str!!K U
,!!U V
CallingConvention!!W h
=!!i j
CallingConvention!!k |
.!!| }
Cdecl	!!} ‚
)
!!‚ ƒ
]
!!ƒ „
internal"" 
static"" 
extern"" 
IntPtr"" %
	decrypt32""& /
(""/ 0
IntPtr""0 6

cipherData""7 A
)""A B
;""B C
[&& 	
	DllImport&&	 
(&& 
$str&& <
,&&< =

EntryPoint&&> H
=&&I J
$str&&K U
,&&U V
CallingConvention&&W h
=&&i j
CallingConvention&&k |
.&&| }
Cdecl	&&} ‚
)
&&‚ ƒ
]
&&ƒ „
internal'' 
static'' 
extern'' 
IntPtr'' %
	encrypt64''& /
(''/ 0
IntPtr''0 6
	plainData''7 @
)''@ A
;''A B
[++ 	
	DllImport++	 
(++ 
$str++ <
,++< =

EntryPoint++> H
=++I J
$str++K U
,++U V
CallingConvention++W h
=++i j
CallingConvention++k |
.++| }
Cdecl	++} ‚
)
++‚ ƒ
]
++ƒ „
internal,, 
static,, 
extern,, 
IntPtr,, %
	decrypt64,,& /
(,,/ 0
IntPtr,,0 6

cipherData,,7 A
),,A B
;,,B C
private00 
const00 
string00 

DefaultKey00 '
=00( )
$str00* 4
;004 5
private11 
const11 
int11 
	BlockSize11 #
=11$ %
$num11& (
;11( )
private55 
bool55 

m_disposed55 
=55  !
false55" '
;55' (
private77 
byte77 
[77 
]77 
m_key77 
=77 
null77 #
;77# $
private99 
IntPtr99 
inputPtr99 
=99  !
IntPtr99" (
.99( )
Zero99) -
;99- .
private:: 
IntPtr:: 
	outputPtr::  
=::! "
IntPtr::# )
.::) *
Zero::* .
;::. /
public@@ 
FCrypt@@ 
(@@ 
stringAA 
keyAA 
)BB 
{CC 	
m_keyDD 
=DD 
ASCIIEncodingDD !
.DD! "
ASCIIDD" '
.DD' (
GetBytesDD( 0
(DD0 1
keyDD1 4
)DD4 5
;DD5 6
}EE 	
publicII 
FCryptII 
(II 
)JJ 
:KK 
thisKK 
(KK 

DefaultKeyKK 
)KK 
{LL 	
}NN 	
~RR 	
FCryptRR	 
(RR 
)SS 
{TT 	
	myDisposeUU 
(UU 
falseUU 
)UU 
;UU 
}VV 	
	protectedZZ 
voidZZ 
	myDisposeZZ  
(ZZ  !
bool[[ 
	disposing[[ 
)\\ 
{]] 	
if^^ 
(^^ 
!^^ 

m_disposed^^ 
)^^ 
{__ 
if`` 
(`` 
	disposing`` 
)`` 
{aa 
m_keybb 
=bb 
nullbb  
;bb  !
}cc 

m_disposeddd 
=dd 
truedd !
;dd! "
}ee 
}ff 	
publicnn 
voidnn 
Disposenn 
(nn 
)oo 
{pp 	
	myDisposeqq 
(qq 
trueqq 
)qq 
;qq 
GCrr 
.rr 
SuppressFinalizerr 
(rr  
thisrr  $
)rr$ %
;rr% &
}ss 	
public
 
string
 
encrypt
 
(
 
string
‚‚ 
plainStr
‚‚ 
)
ƒƒ 
{
„„ 	&
DESCryptoServiceProvider
…… $
desCES
……% +
=
……, -
null
……. 2
;
……2 3
MemoryStream
†† 
ms
†† 
=
†† 
null
†† "
;
††" #
CryptoStream
‡‡ 
cs
‡‡ 
=
‡‡ 
null
‡‡ "
;
‡‡" #
byte
ˆˆ 
[
ˆˆ 
]
ˆˆ 
data
ˆˆ 
=
ˆˆ 
null
ˆˆ 
;
ˆˆ 
try
ŠŠ 
{
‹‹ 
if
ŒŒ 
(
ŒŒ 
m_key
ŒŒ 
==
ŒŒ 
null
ŒŒ !
||
ŒŒ" $
m_key
ŒŒ% *
.
ŒŒ* +
Length
ŒŒ+ 1
!=
ŒŒ2 4
$num
ŒŒ5 6
)
ŒŒ6 7
{
 
FDebug
 
.
 
throwFException
 *
(
* +

FConstants
+ 5
.
5 6

err_m_0006
6 @
)
@ A
;
A B
}
 
if
““ 
(
““ 
plainStr
““ 
==
““ 
string
““  &
.
““& '
Empty
““' ,
)
““, -
{
”” 
return
•• 
string
•• !
.
••! "
Empty
••" '
;
••' (
}
–– 
desCES
šš 
=
šš 
new
šš &
DESCryptoServiceProvider
šš 5
(
šš5 6
)
šš6 7
;
šš7 8
ms
›› 
=
›› 
new
›› 
MemoryStream
›› %
(
››% &
)
››& '
;
››' (
cs
œœ 
=
œœ 
new
œœ 
CryptoStream
œœ %
(
œœ% &
ms
œœ& (
,
œœ( )
desCES
œœ* 0
.
œœ0 1
CreateEncryptor
œœ1 @
(
œœ@ A
m_key
œœA F
,
œœF G
m_key
œœH M
)
œœM N
,
œœN O
CryptoStreamMode
œœP `
.
œœ` a
Write
œœa f
)
œœf g
;
œœg h
data
   
=
   
Encoding
   
.
    
UTF8
    $
.
  $ %
GetBytes
  % -
(
  - .
plainStr
  . 6
.
  6 7
ToCharArray
  7 B
(
  C D
)
  D E
)
  E F
;
  F G
cs
¡¡ 
.
¡¡ 
Write
¡¡ 
(
¡¡ 
data
¡¡ 
,
¡¡ 
$num
¡¡  
,
¡¡  !
data
¡¡" &
.
¡¡& '
Length
¡¡' -
)
¡¡- .
;
¡¡. /
cs
¢¢ 
.
¢¢ 
FlushFinalBlock
¢¢ "
(
¢¢" #
)
¢¢# $
;
¢¢$ %
return
¦¦ 
Convert
¦¦ 
.
¦¦ 
ToBase64String
¦¦ -
(
¦¦- .
ms
¦¦. 0
.
¦¦0 1
ToArray
¦¦1 8
(
¦¦8 9
)
¦¦9 :
)
¦¦: ;
;
¦¦; <
}
§§ 
catch
¨¨ 
(
¨¨ 
	Exception
¨¨ 
ex
¨¨ 
)
¨¨  
{
©© 
FDebug
ªª 
.
ªª 
throwException
ªª %
(
ªª% &
ex
ªª& (
)
ªª( )
;
ªª) *
}
«« 
finally
¬¬ 
{
­­ 
if
®® 
(
®® 
cs
®® 
!=
®® 
null
®® 
)
®® 
{
¯¯ 
cs
°° 
.
°° 
Dispose
°° 
(
°° 
)
°°  
;
°°  !
cs
±± 
=
±± 
null
±± 
;
±± 
}
²² 
if
³³ 
(
³³ 
ms
³³ 
!=
³³ 
null
³³ 
)
³³ 
{
´´ 
ms
µµ 
.
µµ 
Dispose
µµ 
(
µµ 
)
µµ  
;
µµ  !
ms
¶¶ 
=
¶¶ 
null
¶¶ 
;
¶¶ 
}
·· 
if
¹¹ 
(
¹¹ 
desCES
¹¹ 
!=
¹¹ 
null
¹¹ "
)
¹¹" #
{
ºº 
desCES
»» 
.
»» 
Dispose
»» "
(
»»" #
)
»»# $
;
»»$ %
desCES
¼¼ 
=
¼¼ 
null
¼¼ !
;
¼¼! "
}
½½ 
}
¾¾ 
return
¿¿ 
null
¿¿ 
;
¿¿ 
}
ÀÀ 	
public
ÄÄ 
string
ÄÄ 
decrypt
ÄÄ 
(
ÄÄ 
string
ÅÅ 
	cypherStr
ÅÅ 
)
ÆÆ 
{
ÇÇ 	&
DESCryptoServiceProvider
ÈÈ $
desCSP
ÈÈ% +
=
ÈÈ, -
null
ÈÈ. 2
;
ÈÈ2 3
MemoryStream
ÉÉ 
ms
ÉÉ 
=
ÉÉ 
null
ÉÉ "
;
ÉÉ" #
CryptoStream
ÊÊ 
cs
ÊÊ 
=
ÊÊ 
null
ÊÊ "
;
ÊÊ" #
byte
ËË 
[
ËË 
]
ËË 
data
ËË 
=
ËË 
null
ËË 
;
ËË 
try
ÍÍ 
{
ÎÎ 
if
ÏÏ 
(
ÏÏ 
m_key
ÏÏ 
==
ÏÏ 
null
ÏÏ !
||
ÏÏ" $
m_key
ÏÏ% *
.
ÏÏ* +
Length
ÏÏ+ 1
!=
ÏÏ2 4
$num
ÏÏ5 6
)
ÏÏ6 7
{
ĞĞ 
FDebug
ÑÑ 
.
ÑÑ 
throwFException
ÑÑ *
(
ÑÑ* +

FConstants
ÑÑ+ 5
.
ÑÑ5 6

err_m_0006
ÑÑ6 @
)
ÑÑ@ A
;
ÑÑA B
}
ÒÒ 
if
ÖÖ 
(
ÖÖ 
	cypherStr
ÖÖ 
==
ÖÖ  
string
ÖÖ! '
.
ÖÖ' (
Empty
ÖÖ( -
)
ÖÖ- .
{
×× 
return
ØØ 
string
ØØ !
.
ØØ! "
Empty
ØØ" '
;
ØØ' (
}
ÙÙ 
desCSP
İİ 
=
İİ 
new
İİ &
DESCryptoServiceProvider
İİ 5
(
İİ5 6
)
İİ6 7
;
İİ7 8
ms
ŞŞ 
=
ŞŞ 
new
ŞŞ 
MemoryStream
ŞŞ %
(
ŞŞ% &
)
ŞŞ& '
;
ŞŞ' (
cs
ßß 
=
ßß 
new
ßß 
CryptoStream
ßß %
(
ßß% &
ms
ßß& (
,
ßß( )
desCSP
ßß* 0
.
ßß0 1
CreateDecryptor
ßß1 @
(
ßß@ A
m_key
ßßA F
,
ßßF G
m_key
ßßH M
)
ßßM N
,
ßßN O
CryptoStreamMode
ßßP `
.
ßß` a
Write
ßßa f
)
ßßf g
;
ßßg h
data
ãã 
=
ãã 
Convert
ãã 
.
ãã 
FromBase64String
ãã /
(
ãã/ 0
	cypherStr
ãã0 9
)
ãã9 :
;
ãã: ;
cs
ää 
.
ää 
Write
ää 
(
ää 
data
ää 
,
ää 
$num
ää  
,
ää  !
data
ää" &
.
ää& '
Length
ää' -
)
ää- .
;
ää. /
cs
åå 
.
åå 
FlushFinalBlock
åå "
(
åå" #
)
åå# $
;
åå$ %
return
éé 
Encoding
éé 
.
éé  
UTF8
éé  $
.
éé$ %
	GetString
éé% .
(
éé. /
ms
éé/ 1
.
éé1 2
	GetBuffer
éé2 ;
(
éé; <
)
éé< =
)
éé= >
.
éé> ?
Trim
éé? C
(
ééC D
(
ééD E
char
ééE I
)
ééI J
$num
ééJ N
)
ééN O
;
ééO P
}
êê 
catch
ëë 
(
ëë 
	Exception
ëë 
ex
ëë 
)
ëë  
{
ìì 
FDebug
íí 
.
íí 
throwException
íí %
(
íí% &
ex
íí& (
)
íí( )
;
íí) *
}
îî 
finally
ïï 
{
ğğ 
if
ññ 
(
ññ 
cs
ññ 
!=
ññ 
null
ññ 
)
ññ 
{
òò 
cs
óó 
.
óó 
Dispose
óó 
(
óó 
)
óó  
;
óó  !
cs
ôô 
=
ôô 
null
ôô 
;
ôô 
}
õõ 
if
öö 
(
öö 
ms
öö 
!=
öö 
null
öö 
)
öö 
{
÷÷ 
ms
øø 
.
øø 
Dispose
øø 
(
øø 
)
øø  
;
øø  !
ms
ùù 
=
ùù 
null
ùù 
;
ùù 
}
úú 
if
üü 
(
üü 
desCSP
üü 
!=
üü 
null
üü "
)
üü" #
{
ıı 
desCSP
şş 
.
şş 
Dispose
şş "
(
şş" #
)
şş# $
;
şş$ %
desCSP
ÿÿ 
=
ÿÿ 
null
ÿÿ !
;
ÿÿ! "
}
€€ 
}
 
return
‚‚ 
null
‚‚ 
;
‚‚ 
}
ƒƒ 	
public
‡‡ 
string
‡‡ 
encrypt2
‡‡ 
(
‡‡ 
string
ˆˆ 
plainStr
ˆˆ 
)
‰‰ 
{
ŠŠ 	
int
‹‹ 
	binCursor
‹‹ 
=
‹‹ 
$num
‹‹ 
;
‹‹ 
int
ŒŒ 

dataLength
ŒŒ 
=
ŒŒ 
$num
ŒŒ 
;
ŒŒ 
byte
 
[
 
]
 
binData
 
=
 
null
 !
;
! "
byte
 
[
 
]
 
	blockData
 
=
 
null
 #
;
# $
string
 

dataBuffer
 
=
 
string
  &
.
& '
Empty
' ,
;
, -
try
‘‘ 
{
’’ 
	binCursor
““ 
=
““ 
$num
““ 
;
““ 

dataBuffer
”” 
=
”” 
string
”” #
.
””# $
Empty
””$ )
;
””) *
binData
•• 
=
•• 
Encoding
•• "
.
••" #
ASCII
••# (
.
••( )
GetBytes
••) 1
(
••1 2
plainStr
••2 :
)
••: ;
;
••; <
	blockData
–– 
=
–– 
new
–– 
byte
––  $
[
––$ %
	BlockSize
––% .
]
––. /
;
––/ 0
while
šš 
(
šš 
	binCursor
šš 
<
šš  !
binData
šš" )
.
šš) *
Length
šš* 0
)
šš0 1
{
›› 

dataLength
œœ 
=
œœ  
(
œœ! "
	binCursor
œœ" +
+
œœ, -
	BlockSize
œœ. 7
<
œœ8 9
binData
œœ: A
.
œœA B
Length
œœB H
)
œœH I
?
œœJ K
	BlockSize
œœL U
:
œœV W
binData
œœX _
.
œœ_ `
Length
œœ` f
-
œœg h
	binCursor
œœi r
;
œœr s
if
 
(
 

dataLength
 "
<
# $
	BlockSize
% .
)
. /
{
 
	blockData
ŸŸ !
=
ŸŸ" #
new
ŸŸ$ '
byte
ŸŸ( ,
[
ŸŸ, -
	BlockSize
ŸŸ- 6
]
ŸŸ6 7
;
ŸŸ7 8
}
   
Buffer
¡¡ 
.
¡¡ 
	BlockCopy
¡¡ $
(
¡¡$ %
binData
¡¡% ,
,
¡¡, -
	binCursor
¡¡. 7
,
¡¡7 8
	blockData
¡¡9 B
,
¡¡B C
$num
¡¡D E
,
¡¡E F

dataLength
¡¡G Q
)
¡¡Q R
;
¡¡R S

dataBuffer
¢¢ 
+=
¢¢ !
encrypt2_ecb
¢¢" .
(
¢¢. /
	blockData
¢¢/ 8
)
¢¢8 9
;
¢¢9 :
	binCursor
££ 
+=
££  

dataLength
££! +
;
££+ ,
}
¤¤ 
return
¨¨ 

dataBuffer
¨¨ !
;
¨¨! "
}
©© 
catch
ªª 
(
ªª 
	Exception
ªª 
ex
ªª 
)
ªª  
{
«« 
FDebug
¬¬ 
.
¬¬ 
throwException
¬¬ %
(
¬¬% &
ex
¬¬& (
)
¬¬( )
;
¬¬) *
}
­­ 
finally
®® 
{
¯¯ 
}
±± 
return
²² 
string
²² 
.
²² 
Empty
²² 
;
²²  
}
³³ 	
public
·· 
string
·· 
decrypt2
·· 
(
·· 
string
¸¸ 
	cipherStr
¸¸ 
)
¹¹ 
{
ºº 	
int
»» 
	binCursor
»» 
=
»» 
$num
»» 
;
»» 
int
¼¼ 

dataLength
¼¼ 
=
¼¼ 
$num
¼¼ 
;
¼¼ 
byte
½½ 
[
½½ 
]
½½ 
binData
½½ 
=
½½ 
null
½½ !
;
½½! "
byte
¾¾ 
[
¾¾ 
]
¾¾ 
	blockData
¾¾ 
=
¾¾ 
null
¾¾ #
;
¾¾# $
string
¿¿ 

dataBuffer
¿¿ 
=
¿¿ 
string
¿¿  &
.
¿¿& '
Empty
¿¿' ,
;
¿¿, -
try
ÁÁ 
{
ÂÂ 
	cipherStr
ÃÃ 
=
ÃÃ 
	cipherStr
ÃÃ %
.
ÃÃ% &
Replace
ÃÃ& -
(
ÃÃ- .
$str
ÃÃ. 2
,
ÃÃ2 3
$str
ÃÃ4 6
)
ÃÃ6 7
;
ÃÃ7 8
	cipherStr
ÄÄ 
=
ÄÄ 
	cipherStr
ÄÄ %
.
ÄÄ% &
Replace
ÄÄ& -
(
ÄÄ- .
$str
ÄÄ. 2
,
ÄÄ2 3
$str
ÄÄ4 6
)
ÄÄ6 7
;
ÄÄ7 8
	binCursor
ÈÈ 
=
ÈÈ 
$num
ÈÈ 
;
ÈÈ 

dataBuffer
ÉÉ 
=
ÉÉ 
string
ÉÉ #
.
ÉÉ# $
Empty
ÉÉ$ )
;
ÉÉ) *
binData
ÊÊ 
=
ÊÊ 
	Hex2Bytes
ÊÊ #
(
ÊÊ# $
	cipherStr
ÊÊ$ -
)
ÊÊ- .
;
ÊÊ. /
	blockData
ËË 
=
ËË 
new
ËË 
byte
ËË  $
[
ËË$ %
	BlockSize
ËË% .
]
ËË. /
;
ËË/ 0
while
ÏÏ 
(
ÏÏ 
	binCursor
ÏÏ  
<
ÏÏ! "
binData
ÏÏ# *
.
ÏÏ* +
Length
ÏÏ+ 1
)
ÏÏ1 2
{
ĞĞ 

dataLength
ÑÑ 
=
ÑÑ  
(
ÑÑ! "
	binCursor
ÑÑ" +
+
ÑÑ, -
	BlockSize
ÑÑ. 7
<
ÑÑ8 9
binData
ÑÑ: A
.
ÑÑA B
Length
ÑÑB H
)
ÑÑH I
?
ÑÑJ K
	BlockSize
ÑÑL U
:
ÑÑV W
binData
ÑÑX _
.
ÑÑ_ `
Length
ÑÑ` f
-
ÑÑg h
	binCursor
ÑÑi r
;
ÑÑr s
if
ÒÒ 
(
ÒÒ 

dataLength
ÒÒ "
<
ÒÒ# $
	BlockSize
ÒÒ% .
)
ÒÒ. /
{
ÓÓ 
	blockData
ÔÔ !
=
ÔÔ" #
new
ÔÔ$ '
byte
ÔÔ( ,
[
ÔÔ, -
	BlockSize
ÔÔ- 6
]
ÔÔ6 7
;
ÔÔ7 8
}
ÕÕ 
Buffer
ÖÖ 
.
ÖÖ 
	BlockCopy
ÖÖ $
(
ÖÖ$ %
binData
ÖÖ% ,
,
ÖÖ, -
	binCursor
ÖÖ. 7
,
ÖÖ7 8
	blockData
ÖÖ9 B
,
ÖÖB C
$num
ÖÖD E
,
ÖÖE F

dataLength
ÖÖG Q
)
ÖÖQ R
;
ÖÖR S

dataBuffer
×× 
+=
×× !
decrypt2_ecb
××" .
(
××. /
	blockData
××/ 8
)
××8 9
;
××9 :
	binCursor
ØØ 
+=
ØØ  

dataLength
ØØ! +
;
ØØ+ ,
}
ÙÙ 
return
İİ 

dataBuffer
İİ !
.
İİ! "
Replace
İİ" )
(
İİ) *
$str
İİ* .
,
İİ. /
$str
İİ0 2
)
İİ2 3
;
İİ3 4
}
ŞŞ 
catch
ßß 
(
ßß 
	Exception
ßß 
ex
ßß 
)
ßß  
{
àà 
FDebug
áá 
.
áá 
throwException
áá %
(
áá% &
ex
áá& (
)
áá( )
;
áá) *
}
ââ 
finally
ãã 
{
ää 
}
ææ 
return
çç 
string
çç 
.
çç 
Empty
çç 
;
çç  
}
èè 	
private
ìì 
string
ìì 
encrypt2_ecb
ìì #
(
ìì# $
byte
íí 
[
íí 
]
íí 
plainBin
íí 
)
îî 
{
ïï 	
byte
ğğ 
[
ğğ 
]
ğğ 

dataBuffer
ğğ 
=
ğğ 
null
ğğ  $
;
ğğ$ %
try
òò 
{
óó 
if
ôô 
(
ôô 
plainBin
ôô 
.
ôô 
Length
ôô #
>
ôô$ %
	BlockSize
ôô& /
)
ôô/ 0
{
õõ 
FDebug
öö 
.
öö 
throwFException
öö *
(
öö* +
string
öö+ 1
.
öö1 2
Format
öö2 8
(
öö8 9

FConstants
öö9 C
.
ööC D

err_m_0005
ööD N
,
ööN O
$str
ööP `
)
öö` a
)
ööa b
;
ööb c
}
÷÷ 

dataBuffer
şş 
=
şş 
new
şş  
byte
şş! %
[
şş% &
	BlockSize
şş& /
]
şş/ 0
;
şş0 1
Buffer
ÿÿ 
.
ÿÿ 
	BlockCopy
ÿÿ  
(
ÿÿ  !
plainBin
ÿÿ! )
,
ÿÿ) *
$num
ÿÿ+ ,
,
ÿÿ, -

dataBuffer
ÿÿ. 8
,
ÿÿ8 9
$num
ÿÿ: ;
,
ÿÿ; <
plainBin
ÿÿ= E
.
ÿÿE F
Length
ÿÿF L
)
ÿÿL M
;
ÿÿM N
inputPtr
€€ 
=
€€ 
Marshal
€€ "
.
€€" #
AllocHGlobal
€€# /
(
€€/ 0
	BlockSize
€€0 9
)
€€9 :
;
€€: ;
Marshal
 
.
 
Copy
 
(
 

dataBuffer
 '
,
' (
$num
) *
,
* +
inputPtr
, 4
,
4 5
	BlockSize
6 ?
)
? @
;
@ A
if
„„ 
(
„„ 
Environment
„„ 
.
„„  
Is64BitProcess
„„  .
)
„„. /
{
…… 
	outputPtr
†† 
=
†† 
	encrypt64
††  )
(
††) *
inputPtr
††* 2
)
††2 3
;
††3 4
}
‡‡ 
else
ˆˆ 
{
‰‰ 
	outputPtr
ŠŠ 
=
ŠŠ 
	encrypt32
ŠŠ  )
(
ŠŠ) *
inputPtr
ŠŠ* 2
)
ŠŠ2 3
;
ŠŠ3 4
}
‹‹ 

dataBuffer
’’ 
=
’’ 
new
’’  
byte
’’! %
[
’’% &
	BlockSize
’’& /
]
’’/ 0
;
’’0 1
Marshal
““ 
.
““ 
Copy
““ 
(
““ 
	outputPtr
““ &
,
““& '

dataBuffer
““( 2
,
““2 3
$num
““4 5
,
““5 6
	BlockSize
““7 @
)
““@ A
;
““A B
return
—— 
	Bytes2Hex
——  
(
——  !

dataBuffer
——! +
)
——+ ,
;
——, -
}
˜˜ 
catch
™™ 
(
™™ 
	Exception
™™ 
ex
™™ 
)
™™  
{
šš 
FDebug
›› 
.
›› 
throwException
›› %
(
››% &
ex
››& (
)
››( )
;
››) *
}
œœ 
finally
 
{
 
if
ŸŸ 
(
ŸŸ 
inputPtr
ŸŸ 
!=
ŸŸ 
IntPtr
ŸŸ  &
.
ŸŸ& '
Zero
ŸŸ' +
)
ŸŸ+ ,
{
   
Marshal
¡¡ 
.
¡¡ 
FreeHGlobal
¡¡ '
(
¡¡' (
inputPtr
¡¡( 0
)
¡¡0 1
;
¡¡1 2
inputPtr
¢¢ 
=
¢¢ 
IntPtr
¢¢ %
.
¢¢% &
Zero
¢¢& *
;
¢¢* +
}
££ 
}
¤¤ 
return
¥¥ 
string
¥¥ 
.
¥¥ 
Empty
¥¥ 
;
¥¥  
}
¦¦ 	
private
ªª 
string
ªª 
decrypt2_ecb
ªª #
(
ªª# $
byte
«« 
[
«« 
]
«« 
	cipherBin
«« 
)
¬¬ 
{
­­ 	
byte
®® 
[
®® 
]
®® 

dataBuffer
®® 
=
®® 
null
®®  $
;
®®$ %
try
°° 
{
±± 
if
²² 
(
²² 
	cipherBin
²² 
.
²² 
Length
²² $
>
²²% &
	BlockSize
²²' 0
)
²²0 1
{
³³ 
FDebug
´´ 
.
´´ 
throwFException
´´ *
(
´´* +
string
´´+ 1
.
´´1 2
Format
´´2 8
(
´´8 9

FConstants
´´9 C
.
´´C D

err_m_0005
´´D N
,
´´N O
$str
´´P `
)
´´` a
)
´´a b
;
´´b c
}
µµ 

dataBuffer
¼¼ 
=
¼¼ 
new
¼¼  
byte
¼¼! %
[
¼¼% &
	BlockSize
¼¼& /
]
¼¼/ 0
;
¼¼0 1
Buffer
½½ 
.
½½ 
	BlockCopy
½½  
(
½½  !
	cipherBin
½½! *
,
½½* +
$num
½½, -
,
½½- .

dataBuffer
½½/ 9
,
½½9 :
$num
½½; <
,
½½< =
	cipherBin
½½> G
.
½½G H
Length
½½H N
)
½½N O
;
½½O P
inputPtr
¾¾ 
=
¾¾ 
Marshal
¾¾ "
.
¾¾" #
AllocHGlobal
¾¾# /
(
¾¾/ 0
	BlockSize
¾¾0 9
)
¾¾9 :
;
¾¾: ;
Marshal
¿¿ 
.
¿¿ 
Copy
¿¿ 
(
¿¿ 

dataBuffer
¿¿ '
,
¿¿' (
$num
¿¿) *
,
¿¿* +
inputPtr
¿¿, 4
,
¿¿4 5
	BlockSize
¿¿6 ?
)
¿¿? @
;
¿¿@ A
if
ÂÂ 
(
ÂÂ 
Environment
ÂÂ 
.
ÂÂ  
Is64BitProcess
ÂÂ  .
)
ÂÂ. /
{
ÃÃ 
	outputPtr
ÄÄ 
=
ÄÄ 
	decrypt64
ÄÄ  )
(
ÄÄ) *
inputPtr
ÄÄ* 2
)
ÄÄ2 3
;
ÄÄ3 4
}
ÅÅ 
else
ÆÆ 
{
ÇÇ 
	outputPtr
ÈÈ 
=
ÈÈ 
	decrypt32
ÈÈ  )
(
ÈÈ) *
inputPtr
ÈÈ* 2
)
ÈÈ2 3
;
ÈÈ3 4
}
ÉÉ 

dataBuffer
ÏÏ 
=
ÏÏ 
new
ÏÏ  
byte
ÏÏ! %
[
ÏÏ% &
	BlockSize
ÏÏ& /
]
ÏÏ/ 0
;
ÏÏ0 1
Marshal
ĞĞ 
.
ĞĞ 
Copy
ĞĞ 
(
ĞĞ 
	outputPtr
ĞĞ &
,
ĞĞ& '

dataBuffer
ĞĞ( 2
,
ĞĞ2 3
$num
ĞĞ4 5
,
ĞĞ5 6
	BlockSize
ĞĞ7 @
)
ĞĞ@ A
;
ĞĞA B
return
ÔÔ 
Encoding
ÔÔ 
.
ÔÔ  
ASCII
ÔÔ  %
.
ÔÔ% &
	GetString
ÔÔ& /
(
ÔÔ/ 0

dataBuffer
ÔÔ0 :
)
ÔÔ: ;
;
ÔÔ; <
}
ÕÕ 
catch
ÖÖ 
(
ÖÖ 
	Exception
ÖÖ 
ex
ÖÖ 
)
ÖÖ  
{
×× 
FDebug
ØØ 
.
ØØ 
throwException
ØØ %
(
ØØ% &
ex
ØØ& (
)
ØØ( )
;
ØØ) *
}
ÙÙ 
finally
ÚÚ 
{
ÛÛ 
if
ÜÜ 
(
ÜÜ 
inputPtr
ÜÜ 
!=
ÜÜ 
IntPtr
ÜÜ  &
.
ÜÜ& '
Zero
ÜÜ' +
)
ÜÜ+ ,
{
İİ 
Marshal
ŞŞ 
.
ŞŞ 
FreeHGlobal
ŞŞ '
(
ŞŞ' (
inputPtr
ŞŞ( 0
)
ŞŞ0 1
;
ŞŞ1 2
inputPtr
ßß 
=
ßß 
IntPtr
ßß %
.
ßß% &
Zero
ßß& *
;
ßß* +
}
àà 
}
áá 
return
ââ 
string
ââ 
.
ââ 
Empty
ââ 
;
ââ  
}
ãã 	
private
çç 
string
çç 
	Bytes2Hex
çç  
(
çç  !
byte
èè 
[
èè 
]
èè 
binData
èè 
,
èè 
bool
éé 
isLowerCase
éé 
=
éé 
false
éé $
)
êê 
{
ëë 	
StringBuilder
ìì 
hexExpr
ìì !
=
ìì" #
null
ìì$ (
;
ìì( )
string
íí 
notationFormat
íí !
=
íí" #
string
íí$ *
.
íí* +
Empty
íí+ 0
;
íí0 1
try
ïï 
{
ğğ 
hexExpr
ññ 
=
ññ 
new
ññ 
StringBuilder
ññ +
(
ññ+ ,
)
ññ, -
;
ññ- .
notationFormat
òò 
=
òò  
isLowerCase
òò! ,
?
òò- .
$str
òò/ 7
:
òò8 9
$str
òò: B
;
òòB C
foreach
óó 
(
óó 
byte
óó 
bin
óó !
in
óó" $
binData
óó% ,
)
óó, -
{
ôô 
hexExpr
õõ 
.
õõ 
AppendFormat
õõ (
(
õõ( )
notationFormat
õõ) 7
,
õõ7 8
bin
õõ9 <
)
õõ< =
;
õõ= >
}
öö 
return
÷÷ 
hexExpr
÷÷ 
.
÷÷ 
ToString
÷÷ '
(
÷÷' (
)
÷÷( )
;
÷÷) *
}
øø 
catch
ùù 
(
ùù 
	Exception
ùù 
ex
ùù 
)
ùù  
{
úú 
FDebug
ûû 
.
ûû 
throwException
ûû %
(
ûû% &
ex
ûû& (
)
ûû( )
;
ûû) *
}
üü 
finally
ıı 
{
şş 
}
€€ 
return
 
string
 
.
 
Empty
 
;
  
}
‚‚ 	
private
†† 
byte
†† 
[
†† 
]
†† 
	Hex2Bytes
††  
(
††  !
string
‡‡ 
hexExpr
‡‡ 
)
ˆˆ 
{
‰‰ 	
int
ŠŠ 
	binLength
ŠŠ 
=
ŠŠ 
$num
ŠŠ 
;
ŠŠ 
byte
‹‹ 
[
‹‹ 
]
‹‹ 
binData
‹‹ 
=
‹‹ 
null
‹‹ !
;
‹‹! "
try
 
{
 
hexExpr
 
.
 
Replace
 
(
  
$str
  #
,
# $
$str
% '
)
' (
;
( )
	binLength
““ 
=
““ 
hexExpr
““ #
.
““# $
Length
““$ *
/
““+ ,
$num
““- .
;
““. /
binData
”” 
=
”” 
new
”” 
byte
”” "
[
””" #
	binLength
””# ,
]
””, -
;
””- .
for
–– 
(
–– 
int
–– 
i
–– 
=
–– 
$num
–– 
;
–– 
i
––  !
<
––" #
	binLength
––$ -
;
––- .
i
––/ 0
++
––0 2
)
––2 3
{
—— 
binData
˜˜ 
[
˜˜ 
i
˜˜ 
]
˜˜ 
=
˜˜  
(
˜˜! "
byte
˜˜" &
)
˜˜& '
Convert
˜˜' .
.
˜˜. /
ToByte
˜˜/ 5
(
˜˜5 6
hexExpr
˜˜6 =
.
˜˜= >
	Substring
˜˜> G
(
˜˜G H
i
˜˜H I
*
˜˜J K
$num
˜˜L M
,
˜˜M N
$num
˜˜O P
)
˜˜P Q
,
˜˜Q R
$num
˜˜S U
)
˜˜U V
;
˜˜V W
}
™™ 
return
›› 
binData
›› 
;
›› 
}
œœ 
catch
 
(
 
	Exception
 
ex
 
)
 
{
 
FDebug
ŸŸ 
.
ŸŸ 
throwException
ŸŸ %
(
ŸŸ% &
ex
ŸŸ& (
)
ŸŸ( )
;
ŸŸ) *
}
   
finally
¡¡ 
{
¢¢ 
}
¤¤ 
return
¥¥ 
null
¥¥ 
;
¥¥ 
}
¦¦ 	
}
¬¬ 
}­­ ’
`D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Serial\c_FSerialSendData.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FSerialSendData  
:! "
IDisposable# .
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
byte 
[ 
] 
m_data 
= 
null  $
;$ %
private 
object 
m_state 
=  
null! %
;% &
public"" 
FSerialSendData"" 
("" 
byte## 
[## 
]## 
data## 
)$$ 
{%% 	
m_data&& 
=&& 
data&& 
;&& 
}'' 	
public++ 
FSerialSendData++ 
(++ 
byte,, 
[,, 
],, 
data,, 
,,, 
object-- 
state-- 
).. 
:// 
this// 
(// 
data// 
)// 
{00 	
m_state11 
=11 
state11 
;11 
}22 	
~66 	
FSerialSendData66	 
(66 
)77 
{88 	
	myDispose99 
(99 
false99 
)99 
;99 
}:: 	
	protected>> 
void>> 
	myDispose>>  
(>>  !
bool?? 
	disposing?? 
)@@ 
{AA 	
ifBB 
(BB 
!BB 

m_disposedBB 
)BB 
{CC 
ifDD 
(DD 
	disposingDD 
)DD 
{EE 
m_dataFF 
=FF 
nullFF !
;FF! "
m_stateGG 
=GG 
nullGG "
;GG" #
}HH 

m_disposedJJ 
=JJ 
trueJJ !
;JJ! "
}KK 
}LL 	
publicTT 
voidTT 
DisposeTT 
(TT 
)UU 
{VV 	
	myDisposeWW 
(WW 
trueWW 
)WW 
;WW 
GCXX 
.XX 
SuppressFinalizeXX 
(XX  
thisXX  $
)XX$ %
;XX% &
}YY 	
publicaa 
byteaa 
[aa 
]aa 
dataaa 
{bb 	
getcc 
{dd 
tryee 
{ff 
returngg 
m_datagg !
;gg! "
}hh 
catchii 
(ii 
	Exceptionii  
exii! #
)ii# $
{jj 
FDebugkk 
.kk 
throwExceptionkk )
(kk) *
exkk* ,
)kk, -
;kk- .
}ll 
finallymm 
{nn 
}pp 
returnqq 
nullqq 
;qq 
}rr 
}ss 	
publicww 
objectww 
stateww 
{xx 	
getyy 
{zz 
try{{ 
{|| 
return}} 
m_state}} "
;}}" #
}~~ 
catch 
( 
	Exception  
ex! #
)# $
{
€€ 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
‚‚ 
finally
ƒƒ 
{
„„ 
}
†† 
return
‡‡ 
null
‡‡ 
;
‡‡ 
}
ˆˆ 
}
‰‰ 	
}
•• 
}–– ÷*
mD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Serial\c_FSerialDataReceivedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
Serializable 
] 
public 

class (
FSerialDataReceivedEventArgs -
:. / 
FSerialEventArgsBase0 D
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FISerial 
m_fOwnerSerial '
=( )
null* .
;. /
private 
byte 
[ 
] 
m_data 
= 
null  $
;$ %
private 
int 
m_bytesToRead !
=" #
$num$ %
;% &
internal$$ (
FSerialDataReceivedEventArgs$$ -
($$- .
FISerial%% 
fOwnerSerial%% !
,%%! "
byte&& 
[&& 
]&& 
data&& 
)'' 
:(( 
base(( 
((( 
FSerialEventId(( "
.((" #
SerialDataReceived((# 5
)((5 6
{)) 	
m_fOwnerSerial** 
=** 
fOwnerSerial** )
;**) *
m_data++ 
=++ 
data++ 
;++ 
},, 	
internal00 (
FSerialDataReceivedEventArgs00 -
(00- .
FISerial11 
fOwnerSerial11 !
,11! "
byte22 
[22 
]22 
data22 
,22 
int33 
bytesToRead33 
)44 
:55 
this55 
(55 
fOwnerSerial55 
,55  
data55! %
)55% &
{66 	
m_bytesToRead77 
=77 
bytesToRead77 '
;77' (
}88 	
~<< 	(
FSerialDataReceivedEventArgs<<	 %
(<<% &
)== 
{>> 	
	myDispose?? 
(?? 
false?? 
)?? 
;?? 
}@@ 	
	protectedDD 
overrideDD 
voidDD 
	myDisposeDD  )
(DD) *
boolEE 
	disposingEE 
)FF 
{GG 	
ifHH 
(HH 
!HH 

m_disposedHH 
)HH 
{II 
ifJJ 
(JJ 
	disposingJJ 
)JJ 
{KK 
m_fOwnerSerialLL "
=LL# $
nullLL% )
;LL) *
}MM 

m_disposedNN 
=NN 
trueNN !
;NN! "
baseRR 
.RR 
	myDisposeRR 
(RR 
	disposingRR (
)RR( )
;RR) *
}SS 
}TT 	
public\\ 
FISerial\\ 
fOwnerSerial\\ $
{]] 	
get^^ 
{__ 
try`` 
{aa 
returnbb 
m_fOwnerSerialbb )
;bb) *
}cc 
catchdd 
(dd 
	Exceptiondd  
exdd! #
)dd# $
{ee 
FDebugff 
.ff 
throwExceptionff )
(ff) *
exff* ,
)ff, -
;ff- .
}gg 
finallyhh 
{ii 
}kk 
returnll 
nullll 
;ll 
}mm 
}nn 	
publicrr 
byterr 
[rr 
]rr 
datarr 
{ss 	
gettt 
{uu 
tryvv 
{ww 
returnxx 
m_dataxx !
;xx! "
}yy 
catchzz 
(zz 
	Exceptionzz  
exzz! #
)zz# $
{{{ 
FDebug|| 
.|| 
throwException|| )
(||) *
ex||* ,
)||, -
;||- .
}}} 
finally~~ 
{ 
}
 
return
‚‚ 
null
‚‚ 
;
‚‚ 
}
ƒƒ 
}
„„ 	
public
ˆˆ 
int
ˆˆ 

dataLength
ˆˆ 
{
‰‰ 	
get
ŠŠ 
{
‹‹ 
try
ŒŒ 
{
 
return
 
m_data
 !
.
! "
Length
" (
;
( )
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
‘‘ 
FDebug
’’ 
.
’’ 
throwException
’’ )
(
’’) *
ex
’’* ,
)
’’, -
;
’’- .
}
““ 
finally
”” 
{
•• 
}
—— 
return
˜˜ 
$num
˜˜ 
;
˜˜ 
}
™™ 
}
šš 	
public
 
int
 
bytesToRead
 
{
ŸŸ 	
get
   
{
¡¡ 
try
¢¢ 
{
££ 
return
¤¤ 
m_bytesToRead
¤¤ (
;
¤¤( )
}
¥¥ 
catch
¦¦ 
(
¦¦ 
	Exception
¦¦  
ex
¦¦! #
)
¦¦# $
{
§§ 
FDebug
¨¨ 
.
¨¨ 
throwException
¨¨ )
(
¨¨) *
ex
¨¨* ,
)
¨¨, -
;
¨¨- .
}
©© 
finally
ªª 
{
«« 
}
­­ 
return
®® 
$num
®® 
;
®® 
}
¯¯ 
}
°° 	
}
¼¼ 
}½½ ó-
oD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Serial\c_FSerialDataSendFailedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
Serializable 
] 
public 

class *
FSerialDataSendFailedEventArgs /
:0 1 
FSerialEventArgsBase2 F
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FISerial 
m_fOwnerSerial '
=( )
null* .
;. /
private 
FSerialSendData 
m_fData  '
=( )
null* .
;. /
private 
string 
	m_message  
=! "
string# )
.) *
Empty* /
;/ 0
internal$$ *
FSerialDataSendFailedEventArgs$$ /
($$/ 0
FISerial%% 
fOwnerSerial%% !
,%%! "
FSerialSendData&& 
fData&& !
,&&! "
string'' 
message'' 
)(( 
:)) 
base)) 
()) 
FSerialEventId)) "
.))" # 
SerialDataSendFailed))# 7
)))7 8
{** 	
m_fOwnerSerial++ 
=++ 
fOwnerSerial++ )
;++) *
m_fData,, 
=,, 
fData,, 
;,, 
	m_message-- 
=-- 
message-- 
;--  
}.. 	
~22 	*
FSerialDataSendFailedEventArgs22	 '
(22' (
)33 
{44 	
	myDispose55 
(55 
false55 
)55 
;55 
}66 	
	protected:: 
override:: 
void:: 
	myDispose::  )
(::) *
bool;; 
	disposing;; 
)<< 
{== 	
if>> 
(>> 
!>> 

m_disposed>> 
)>> 
{?? 
if@@ 
(@@ 
	disposing@@ 
)@@ 
{AA 
m_fOwnerSerialBB "
=BB# $
nullBB% )
;BB) *
}CC 

m_disposedDD 
=DD 
trueDD !
;DD! "
baseHH 
.HH 
	myDisposeHH 
(HH 
	disposingHH (
)HH( )
;HH) *
}II 
}JJ 	
publicRR 
FISerialRR 
fOwnerSerialRR $
{SS 	
getTT 
{UU 
tryVV 
{WW 
returnXX 
m_fOwnerSerialXX )
;XX) *
}YY 
catchZZ 
(ZZ 
	ExceptionZZ  
exZZ! #
)ZZ# $
{[[ 
FDebug\\ 
.\\ 
throwException\\ )
(\\) *
ex\\* ,
)\\, -
;\\- .
}]] 
finally^^ 
{__ 
}aa 
returnbb 
nullbb 
;bb 
}cc 
}dd 	
publichh 
FSerialSendDatahh 
fDatahh $
{ii 	
getjj 
{kk 
tryll 
{mm 
returnnn 
m_fDatann "
;nn" #
}oo 
catchpp 
(pp 
	Exceptionpp  
expp! #
)pp# $
{qq 
FDebugrr 
.rr 
throwExceptionrr )
(rr) *
exrr* ,
)rr, -
;rr- .
}ss 
finallytt 
{uu 
}ww 
returnxx 
nullxx 
;xx 
}yy 
}zz 	
public~~ 
byte~~ 
[~~ 
]~~ 
data~~ 
{ 	
get
€€ 
{
 
try
‚‚ 
{
ƒƒ 
return
„„ 
m_fData
„„ "
.
„„" #
data
„„# '
;
„„' (
}
…… 
catch
†† 
(
†† 
	Exception
††  
ex
††! #
)
††# $
{
‡‡ 
FDebug
ˆˆ 
.
ˆˆ 
throwException
ˆˆ )
(
ˆˆ) *
ex
ˆˆ* ,
)
ˆˆ, -
;
ˆˆ- .
}
‰‰ 
finally
ŠŠ 
{
‹‹ 
}
 
return
 
null
 
;
 
}
 
}
 	
public
”” 
int
”” 

dataLength
”” 
{
•• 	
get
–– 
{
—— 
try
˜˜ 
{
™™ 
return
šš 
m_fData
šš "
.
šš" #
data
šš# '
.
šš' (
Length
šš( .
;
šš. /
}
›› 
catch
œœ 
(
œœ 
	Exception
œœ  
ex
œœ! #
)
œœ# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
ŸŸ 
finally
   
{
¡¡ 
}
££ 
return
¤¤ 
$num
¤¤ 
;
¤¤ 
}
¥¥ 
}
¦¦ 	
public
ªª 
string
ªª 
message
ªª 
{
«« 	
get
¬¬ 
{
­­ 
try
®® 
{
¯¯ 
return
°° 
	m_message
°° $
;
°°$ %
}
±± 
catch
²² 
(
²² 
	Exception
²²  
ex
²²! #
)
²²# $
{
³³ 
FDebug
´´ 
.
´´ 
throwException
´´ )
(
´´) *
ex
´´* ,
)
´´, -
;
´´- .
}
µµ 
finally
¶¶ 
{
·· 
}
¹¹ 
return
ºº 
string
ºº 
.
ºº 
Empty
ºº #
;
ºº# $
}
»» 
}
¼¼ 	
}
ÈÈ 
}ÉÉ €&
iD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Serial\c_FSerialDataSentEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
Serializable 
] 
public 

class $
FSerialDataSentEventArgs )
:* + 
FSerialEventArgsBase, @
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FISerial 
m_fOwnerSerial '
=( )
null* .
;. /
private 
FSerialSendData 
m_fData  '
=( )
null* .
;. /
internal## $
FSerialDataSentEventArgs## )
(##) *
FISerial$$ 
fOwnerSerial$$ !
,$$! "
FSerialSendData%% 
fData%% !
)&& 
:'' 
base'' 
('' 
FSerialEventId'' "
.''" #
SerialDataSent''# 1
)''1 2
{(( 	
m_fOwnerSerial)) 
=)) 
fOwnerSerial)) )
;))) *
m_fData** 
=** 
fData** 
;** 
}++ 	
~// 	$
FSerialDataSentEventArgs//	 !
(//! "
)00 
{11 	
	myDispose22 
(22 
false22 
)22 
;22 
}33 	
	protected77 
override77 
void77 
	myDispose77  )
(77) *
bool88 
	disposing88 
)99 
{:: 	
if;; 
(;; 
!;; 

m_disposed;; 
);; 
{<< 
if== 
(== 
	disposing== 
)== 
{>> 
m_fOwnerSerial?? "
=??# $
null??% )
;??) *
}@@ 

m_disposedAA 
=AA 
trueAA !
;AA! "
baseEE 
.EE 
	myDisposeEE 
(EE 
	disposingEE (
)EE( )
;EE) *
}FF 
}GG 	
publicOO 
FISerialOO 
fOwnerSerialOO $
{PP 	
getQQ 
{RR 
trySS 
{TT 
returnUU 
m_fOwnerSerialUU )
;UU) *
}VV 
catchWW 
(WW 
	ExceptionWW  
exWW! #
)WW# $
{XX 
FDebugYY 
.YY 
throwExceptionYY )
(YY) *
exYY* ,
)YY, -
;YY- .
}ZZ 
finally[[ 
{\\ 
}^^ 
return__ 
null__ 
;__ 
}`` 
}aa 	
publicee 
FSerialSendDataee 
fDataee $
{ff 	
getgg 
{hh 
tryii 
{jj 
returnkk 
m_fDatakk "
;kk" #
}ll 
catchmm 
(mm 
	Exceptionmm  
exmm! #
)mm# $
{nn 
FDebugoo 
.oo 
throwExceptionoo )
(oo) *
exoo* ,
)oo, -
;oo- .
}pp 
finallyqq 
{rr 
}tt 
returnuu 
nulluu 
;uu 
}vv 
}ww 	
public{{ 
byte{{ 
[{{ 
]{{ 
data{{ 
{|| 	
get}} 
{~~ 
try 
{
€€ 
return
 
m_fData
 "
.
" #
data
# '
;
' (
}
‚‚ 
catch
ƒƒ 
(
ƒƒ 
	Exception
ƒƒ  
ex
ƒƒ! #
)
ƒƒ# $
{
„„ 
FDebug
…… 
.
…… 
throwException
…… )
(
……) *
ex
……* ,
)
……, -
;
……- .
}
†† 
finally
‡‡ 
{
ˆˆ 
}
ŠŠ 
return
‹‹ 
null
‹‹ 
;
‹‹ 
}
ŒŒ 
}
 	
public
‘‘ 
int
‘‘ 

dataLength
‘‘ 
{
’’ 	
get
““ 
{
”” 
try
•• 
{
–– 
return
—— 
m_fData
—— "
.
——" #
data
——# '
.
——' (
Length
——( .
;
——. /
}
˜˜ 
catch
™™ 
(
™™ 
	Exception
™™  
ex
™™! #
)
™™# $
{
šš 
FDebug
›› 
.
›› 
throwException
›› )
(
››) *
ex
››* ,
)
››, -
;
››- .
}
œœ 
finally
 
{
 
}
   
return
¡¡ 
$num
¡¡ 
;
¡¡ 
}
¢¢ 
}
££ 	
}
¯¯ 
}°° #
lD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Serial\c_FSerialErrorRaisedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
Serializable 
] 
public 

class '
FSerialErrorRaisedEventArgs ,
:- . 
FSerialEventArgsBase/ C
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FISerial 
m_fOwnerSerial '
=( )
null* .
;. /
private 
string 
	m_message  
=! "
string# )
.) *
Empty* /
;/ 0
private 
	Exception 
m_exception %
=& '
null( ,
;, -
internal%% '
FSerialErrorRaisedEventArgs%% ,
(%%, -
FISerial&& 
fOwnerSerial&& !
,&&! "
string'' 
message'' 
,'' 
	Exception(( 
	exception(( 
))) 
:** 
base** 
(** 
FSerialEventId** "
.**" #
SerialErrorRaised**# 4
)**4 5
{++ 	
m_fOwnerSerial,, 
=,, 
fOwnerSerial,, )
;,,) *
	m_message-- 
=-- 
message-- 
;--  
m_exception.. 
=.. 
	exception.. #
;..# $
}// 	
~33 	'
FSerialErrorRaisedEventArgs33	 $
(33$ %
)44 
{55 	
	myDispose66 
(66 
false66 
)66 
;66 
}77 	
	protected;; 
override;; 
void;; 
	myDispose;;  )
(;;) *
bool<< 
	disposing<< 
)== 
{>> 	
if?? 
(?? 
!?? 

m_disposed?? 
)?? 
{@@ 
ifAA 
(AA 
	disposingAA 
)AA 
{BB 
m_fOwnerSerialCC "
=CC# $
nullCC% )
;CC) *
m_exceptionDD 
=DD  !
nullDD" &
;DD& '
}EE 

m_disposedFF 
=FF 
trueFF !
;FF! "
baseJJ 
.JJ 
	myDisposeJJ 
(JJ 
	disposingJJ (
)JJ( )
;JJ) *
}KK 
}LL 	
publicTT 
FISerialTT 
fOwnerSerialTT $
{UU 	
getVV 
{WW 
tryXX 
{YY 
returnZZ 
m_fOwnerSerialZZ )
;ZZ) *
}[[ 
catch\\ 
(\\ 
	Exception\\  
ex\\! #
)\\# $
{]] 
FDebug^^ 
.^^ 
throwException^^ )
(^^) *
ex^^* ,
)^^, -
;^^- .
}__ 
finally`` 
{aa 
}cc 
returndd 
nulldd 
;dd 
}ee 
}ff 	
publicjj 
stringjj 
messagejj 
{kk 	
getll 
{mm 
trynn 
{oo 
returnpp 
	m_messagepp $
;pp$ %
}qq 
catchrr 
(rr 
	Exceptionrr  
exrr! #
)rr# $
{ss 
FDebugtt 
.tt 
throwExceptiontt )
(tt) *
extt* ,
)tt, -
;tt- .
}uu 
finallyvv 
{ww 
}yy 
returnzz 
stringzz 
.zz 
Emptyzz #
;zz# $
}{{ 
}|| 	
public
€€ 
	Exception
€€ 
	exception
€€ "
{
 	
get
‚‚ 
{
ƒƒ 
try
„„ 
{
…… 
return
†† 
m_exception
†† &
;
††& '
}
‡‡ 
catch
ˆˆ 
(
ˆˆ 
	Exception
ˆˆ  
ex
ˆˆ! #
)
ˆˆ# $
{
‰‰ 
FDebug
ŠŠ 
.
ŠŠ 
throwException
ŠŠ )
(
ŠŠ) *
ex
ŠŠ* ,
)
ŠŠ, -
;
ŠŠ- .
}
‹‹ 
finally
ŒŒ 
{
 
}
 
return
 
null
 
;
 
}
‘‘ 
}
’’ 	
}
 
}ŸŸ ¢*
mD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Serial\c_FSerialStateChangedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
Serializable 
] 
public 

class (
FSerialStateChangedEventArgs -
:. / 
FSerialEventArgsBase0 D
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FISerial 
m_fOwnerSerial '
=( )
null* .
;. /
private 
FSerialState 
m_fState %
=& '
FSerialState( 4
.4 5
Closed5 ;
;; <
private 
string 

m_portName !
=" #
string$ *
.* +
Empty+ 0
;0 1
private 
int 

m_baudRate 
=  
$num! "
;" #
internal$$ (
FSerialStateChangedEventArgs$$ -
($$- .
FISerial%% 
fOwnerSerial%% !
,%%! "
FSerialState&& 
fState&& 
,&&  
string'' 
portName'' 
,'' 
int(( 
baudRate(( 
))) 
:** 
base** 
(** 
FSerialEventId** "
.**" #
SerialStateChanged**# 5
)**5 6
{++ 	
m_fOwnerSerial,, 
=,, 
fOwnerSerial,, )
;,,) *
m_fState-- 
=-- 
fState-- 
;-- 

m_portName.. 
=.. 
portName.. !
;..! "

m_baudRate// 
=// 
baudRate// !
;//! "
}00 	
~44 	(
FSerialStateChangedEventArgs44	 %
(44% &
)55 
{66 	
	myDispose77 
(77 
false77 
)77 
;77 
}88 	
	protected<< 
override<< 
void<< 
	myDispose<<  )
(<<) *
bool== 
	disposing== 
)>> 
{?? 	
if@@ 
(@@ 
!@@ 

m_disposed@@ 
)@@ 
{AA 
ifBB 
(BB 
	disposingBB 
)BB 
{CC 
m_fOwnerSerialDD "
=DD# $
nullDD% )
;DD) *
}EE 

m_disposedFF 
=FF 
trueFF !
;FF! "
baseJJ 
.JJ 
	myDisposeJJ 
(JJ 
	disposingJJ (
)JJ( )
;JJ) *
}KK 
}LL 	
publicTT 
FISerialTT 
fOwnerSerialTT $
{UU 	
getVV 
{WW 
tryXX 
{YY 
returnZZ 
m_fOwnerSerialZZ )
;ZZ) *
}[[ 
catch\\ 
(\\ 
	Exception\\  
ex\\! #
)\\# $
{]] 
FDebug^^ 
.^^ 
throwException^^ )
(^^) *
ex^^* ,
)^^, -
;^^- .
}__ 
finally`` 
{aa 
}cc 
returndd 
nulldd 
;dd 
}ee 
}ff 	
publicjj 
FSerialStatejj 
fStatejj "
{kk 	
getll 
{mm 
trynn 
{oo 
returnpp 
m_fStatepp #
;pp# $
}qq 
catchrr 
(rr 
	Exceptionrr  
exrr! #
)rr# $
{ss 
FDebugtt 
.tt 
throwExceptiontt )
(tt) *
extt* ,
)tt, -
;tt- .
}uu 
finallyvv 
{ww 
}yy 
returnzz 
FSerialStatezz #
.zz# $
Closedzz$ *
;zz* +
}{{ 
}|| 	
public
€€ 
string
€€ 
portName
€€ 
{
 	
get
‚‚ 
{
ƒƒ 
try
„„ 
{
…… 
return
†† 

m_portName
†† %
;
††% &
}
‡‡ 
catch
ˆˆ 
(
ˆˆ 
	Exception
ˆˆ  
ex
ˆˆ! #
)
ˆˆ# $
{
‰‰ 
FDebug
ŠŠ 
.
ŠŠ 
throwException
ŠŠ )
(
ŠŠ) *
ex
ŠŠ* ,
)
ŠŠ, -
;
ŠŠ- .
}
‹‹ 
finally
ŒŒ 
{
 
}
 
return
 
string
 
.
 
Empty
 #
;
# $
}
‘‘ 
}
’’ 	
public
–– 
int
–– 
baudRate
–– 
{
—— 	
get
˜˜ 
{
™™ 
try
šš 
{
›› 
return
œœ 

m_baudRate
œœ %
;
œœ% &
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
ŸŸ 
FDebug
   
.
   
throwException
   )
(
  ) *
ex
  * ,
)
  , -
;
  - .
}
¡¡ 
finally
¢¢ 
{
££ 
}
¥¥ 
return
¦¦ 
$num
¦¦ 
;
¦¦ 
}
§§ 
}
¨¨ 	
}
³³ 
}´´ Ñ‚
XD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Serial\c_FSerial.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FSerial 
: 
FISerial #
,# $
IDisposable% 0
{ 
public 
event +
FSerialStateChangedEventHandler 4
SerialStateChanged5 G
=H I
nullJ N
;N O
public 
event +
FSerialDataReceivedEventHandler 4
SerialDataReceived5 G
=H I
nullJ N
;N O
public 
event '
FSerialDataSentEventHandler 0
SerialDataSent1 ?
=@ A
nullB F
;F G
public 
event -
!FSerialDataSendFailedEventHandler 6 
SerialDataSendFailed7 K
=L M
nullN R
;R S
public 
event *
FSerialErrorRaisedEventHandler 3
SerialErrorRaised4 E
=F G
nullH L
;L M
private!! 
bool!! 

m_disposed!! 
=!!  !
false!!" '
;!!' (
private## 
string## 

m_portName## !
=##" #
string##$ *
.##* +
Empty##+ 0
;##0 1
private$$ 
int$$ 

m_baudRate$$ 
=$$  
$num$$! %
;$$% &
private%% 
Parity%% 
m_parity%% 
=%%  !
Parity%%" (
.%%( )
None%%) -
;%%- .
private&& 
int&& 

m_dataBits&& 
=&&  
$num&&! "
;&&" #
private'' 
StopBits'' 

m_stopBits'' #
=''$ %
StopBits''& .
.''. /
One''/ 2
;''2 3
private)) 
FSerialState)) 
m_fState)) %
=))& '
FSerialState))( 4
.))4 5
Closed))5 ;
;)); <
private** 

SerialPort** 
m_serialPort** '
=**( )
null*** .
;**. /
private++ 
FSerialFlag++ 
m_fSerialFlag++ )
=++* +
null++, 0
;++0 1
private-- 
byte-- 
[-- 
]-- 
	m_recvBuf--  
=--! "
null--# '
;--' (
private.. 
const.. 
int.. 
RecvBufferSize.. (
=..) *
$num..+ /
;../ 0
private// 
const// 
int// 
SendBufferSize// (
=//) *
$num//+ /
;/// 0
private11 
	FCodeLock11 
m_fMainSync11 %
=11& '
null11( ,
;11, -
private22 
FSerialEventPusher22 "
m_fEventPusher22# 1
=222 3
null224 8
;228 9
private33 
FThread33 

m_fThdMain33 "
=33# $
null33% )
;33) *
public99 
FSerial99 
(99 
):: 
{;; 	
init<< 
(<< 
)<< 
;<< 
}== 	
publicAA 
FSerialAA 
(AA 
stringBB 
portNameBB 
,BB 
intCC 
baudRateCC 
)DD 
:EE 
thisEE 
(EE 
)EE 
{FF 	
m_fStateGG 
=GG 
FSerialStateGG #
.GG# $
ClosedGG$ *
;GG* +

m_portNameII 
=II 
portNameII !
;II! "

m_baudRateJJ 
=JJ 
baudRateJJ !
;JJ! "
m_parityLL 
=LL 
ParityLL 
.LL 
NoneLL "
;LL" #

m_dataBitsMM 
=MM 
$numMM 
;MM 

m_stopBitsNN 
=NN 
StopBitsNN !
.NN! "
OneNN" %
;NN% &
}OO 	
publicQQ 
FSerialQQ 
(QQ 
stringRR 
portNameRR 
,RR 
intSS 
baudRateSS 
,SS 
ParityTT 
parityTT 
,TT 
intUU 
dataBitsUU 
,UU 
StopBitsVV 
stopBitsVV 
)WW 
:XX 
thisXX 
(XX 
)XX 
{YY 	
m_fStateZZ 
=ZZ 
FSerialStateZZ #
.ZZ# $
ClosedZZ$ *
;ZZ* +

m_portName\\ 
=\\ 
portName\\ !
;\\! "

m_baudRate]] 
=]] 
baudRate]] !
;]]! "
m_parity^^ 
=^^ 
parity^^ 
;^^ 

m_dataBits__ 
=__ 
dataBits__ !
;__! "

m_stopBits`` 
=`` 
stopBits`` !
;``! "
}aa 	
~ee 	
FSerialee	 
(ee 
)ff 
{gg 	
	myDisposehh 
(hh 
falsehh 
)hh 
;hh 
}ii 	
	protectedmm 
voidmm 
	myDisposemm  
(mm  !
boolnn 
	disposingnn 
)oo 
{pp 	
ifqq 
(qq 
!qq 

m_disposedqq 
)qq 
{rr 
ifss 
(ss 
	disposingss 
)ss 
{tt 
termuu 
(uu 
)uu 
;uu 
}vv 

m_disposedww 
=ww 
trueww !
;ww! "
}xx 
}yy 	
public
 
void
 
Dispose
 
(
 
)
‚‚ 
{
ƒƒ 	
	myDispose
„„ 
(
„„ 
true
„„ 
)
„„ 
;
„„ 
GC
…… 
.
…… 
SuppressFinalize
…… 
(
……  
this
……  $
)
……$ %
;
……% &
}
†† 	
public
 
string
 
portName
 
{
 	
get
 
{
‘‘ 
try
’’ 
{
““ 
return
”” 

m_portName
”” %
;
””% &
}
•• 
catch
–– 
(
–– 
	Exception
––  
ex
––! #
)
––# $
{
—— 
FDebug
˜˜ 
.
˜˜ 
throwException
˜˜ )
(
˜˜) *
ex
˜˜* ,
)
˜˜, -
;
˜˜- .
}
™™ 
finally
šš 
{
›› 
}
 
return
 
string
 
.
 
Empty
 #
;
# $
}
ŸŸ 
set
¡¡ 
{
¢¢ 
try
££ 
{
¤¤ 

m_portName
¥¥ 
=
¥¥  
value
¥¥! &
;
¥¥& '
}
¦¦ 
catch
§§ 
(
§§ 
	Exception
§§  
ex
§§! #
)
§§# $
{
¨¨ 
FDebug
©© 
.
©© 
throwException
©© )
(
©©) *
ex
©©* ,
)
©©, -
;
©©- .
}
ªª 
finally
«« 
{
¬¬ 
}
®® 
}
¯¯ 
}
°° 	
public
´´ 
int
´´ 
baudRate
´´ 
{
µµ 	
get
¶¶ 
{
·· 
try
¸¸ 
{
¹¹ 
return
ºº 

m_baudRate
ºº %
;
ºº% &
}
»» 
catch
¼¼ 
(
¼¼ 
	Exception
¼¼  
ex
¼¼! #
)
¼¼# $
{
½½ 
FDebug
¾¾ 
.
¾¾ 
throwException
¾¾ )
(
¾¾) *
ex
¾¾* ,
)
¾¾, -
;
¾¾- .
}
¿¿ 
finally
ÀÀ 
{
ÁÁ 
}
ÃÃ 
return
ÄÄ 
$num
ÄÄ 
;
ÄÄ 
}
ÅÅ 
set
ÇÇ 
{
ÈÈ 
try
ÉÉ 
{
ÊÊ 

m_baudRate
ËË 
=
ËË  
value
ËË! &
;
ËË& '
}
ÌÌ 
catch
ÍÍ 
(
ÍÍ 
	Exception
ÍÍ  
ex
ÍÍ! #
)
ÍÍ# $
{
ÎÎ 
FDebug
ÏÏ 
.
ÏÏ 
throwException
ÏÏ )
(
ÏÏ) *
ex
ÏÏ* ,
)
ÏÏ, -
;
ÏÏ- .
}
ĞĞ 
finally
ÑÑ 
{
ÒÒ 
}
ÔÔ 
}
ÕÕ 
}
ÖÖ 	
public
ÚÚ 
Parity
ÚÚ 
parity
ÚÚ 
{
ÛÛ 	
get
ÜÜ 
{
İİ 
try
ŞŞ 
{
ßß 
return
àà 
m_parity
àà #
;
àà# $
}
áá 
catch
ââ 
(
ââ 
	Exception
ââ  
ex
ââ! #
)
ââ# $
{
ãã 
FDebug
ää 
.
ää 
throwException
ää )
(
ää) *
ex
ää* ,
)
ää, -
;
ää- .
}
åå 
finally
ææ 
{
çç 
}
éé 
return
êê 
Parity
êê 
.
êê 
None
êê "
;
êê" #
}
ëë 
set
íí 
{
îî 
try
ïï 
{
ğğ 
m_parity
ññ 
=
ññ 
value
ññ $
;
ññ$ %
}
òò 
catch
óó 
(
óó 
	Exception
óó  
ex
óó! #
)
óó# $
{
ôô 
FDebug
õõ 
.
õõ 
throwException
õõ )
(
õõ) *
ex
õõ* ,
)
õõ, -
;
õõ- .
}
öö 
finally
÷÷ 
{
øø 
}
úú 
}
ûû 
}
üü 	
public
€€ 
int
€€ 
dataBits
€€ 
{
 	
get
‚‚ 
{
ƒƒ 
try
„„ 
{
…… 
return
†† 

m_dataBits
†† %
;
††% &
}
‡‡ 
catch
ˆˆ 
(
ˆˆ 
	Exception
ˆˆ  
ex
ˆˆ! #
)
ˆˆ# $
{
‰‰ 
FDebug
ŠŠ 
.
ŠŠ 
throwException
ŠŠ )
(
ŠŠ) *
ex
ŠŠ* ,
)
ŠŠ, -
;
ŠŠ- .
}
‹‹ 
finally
ŒŒ 
{
 
}
 
return
 
$num
 
;
 
}
‘‘ 
set
““ 
{
”” 
try
•• 
{
–– 

m_dataBits
—— 
=
——  
value
——! &
;
——& '
}
˜˜ 
catch
™™ 
(
™™ 
	Exception
™™ 
ex
™™  "
)
™™" #
{
šš 
FDebug
›› 
.
›› 
throwException
›› )
(
››) *
ex
››* ,
)
››, -
;
››- .
}
œœ 
finally
 
{
 
}
   
}
¡¡ 
}
¢¢ 	
public
¦¦ 
StopBits
¦¦ 
stopBits
¦¦  
{
§§ 	
get
¨¨ 
{
©© 
try
ªª 
{
«« 
return
¬¬ 

m_stopBits
¬¬ %
;
¬¬% &
}
­­ 
catch
®® 
(
®® 
	Exception
®®  
ex
®®! #
)
®®# $
{
¯¯ 
FDebug
°° 
.
°° 
throwException
°° )
(
°°) *
ex
°°* ,
)
°°, -
;
°°- .
}
±± 
finally
²² 
{
³³ 
}
µµ 
return
¶¶ 
StopBits
¶¶ 
.
¶¶  
One
¶¶  #
;
¶¶# $
}
·· 
set
¹¹ 
{
ºº 
try
»» 
{
¼¼ 

m_stopBits
½½ 
=
½½  
value
½½! &
;
½½& '
}
¾¾ 
catch
¿¿ 
(
¿¿ 
	Exception
¿¿  
ex
¿¿! #
)
¿¿# $
{
ÀÀ 
FDebug
ÁÁ 
.
ÁÁ 
throwException
ÁÁ )
(
ÁÁ) *
ex
ÁÁ* ,
)
ÁÁ, -
;
ÁÁ- .
}
ÂÂ 
finally
ÃÃ 
{
ÄÄ 
}
ÆÆ 
}
ÇÇ 
}
ÈÈ 	
public
ÌÌ 
FSerialState
ÌÌ 
fState
ÌÌ "
{
ÍÍ 	
get
ÎÎ 
{
ÏÏ 
try
ĞĞ 
{
ÑÑ 
return
ÒÒ 
m_fState
ÒÒ #
;
ÒÒ# $
}
ÓÓ 
catch
ÔÔ 
(
ÔÔ 
	Exception
ÔÔ  
ex
ÔÔ! #
)
ÔÔ# $
{
ÕÕ 
FDebug
ÖÖ 
.
ÖÖ 
throwException
ÖÖ )
(
ÖÖ) *
ex
ÖÖ* ,
)
ÖÖ, -
;
ÖÖ- .
}
×× 
finally
ØØ 
{
ÙÙ 
}
ÛÛ 
return
ÜÜ 
FSerialState
ÜÜ #
.
ÜÜ# $
Closed
ÜÜ$ *
;
ÜÜ* +
}
İİ 
}
ŞŞ 	
public
ââ 
bool
ââ 
sendCompleted
ââ !
{
ãã 	
get
ää 
{
åå 
try
ææ 
{
çç 
return
èè 
m_fSerialFlag
èè (
.
èè( )
doSendCompleted
èè) 8
;
èè8 9
}
éé 
catch
êê 
(
êê 
	Exception
êê  
ex
êê! #
)
êê# $
{
ëë 
FDebug
ìì 
.
ìì 
throwException
ìì )
(
ìì) *
ex
ìì* ,
)
ìì, -
;
ìì- .
}
íí 
finally
îî 
{
ïï 
}
ññ 
return
òò 
false
òò 
;
òò 
}
óó 
}
ôô 	
private
üü 
void
üü 
init
üü 
(
üü 
)
ıı 
{
şş 	
try
ÿÿ 
{
€€ 
m_fMainSync
 
=
 
new
 !
	FCodeLock
" +
(
+ ,
)
, -
;
- .
m_fSerialFlag
‚‚ 
=
‚‚ 
new
‚‚  #
FSerialFlag
‚‚$ /
(
‚‚/ 0
)
‚‚0 1
;
‚‚1 2
	m_recvBuf
ƒƒ 
=
ƒƒ 
new
ƒƒ 
byte
ƒƒ  $
[
ƒƒ$ %
RecvBufferSize
ƒƒ% 3
]
ƒƒ3 4
;
ƒƒ4 5
m_fEventPusher
…… 
=
……  
new
……! $ 
FSerialEventPusher
……% 7
(
……7 8
this
……8 <
)
……< =
;
……= >

m_fThdMain
‡‡ 
=
‡‡ 
new
‡‡  
FThread
‡‡! (
(
‡‡( )
$str
‡‡) <
)
‡‡< =
;
‡‡= >

m_fThdMain
ˆˆ 
.
ˆˆ 
ThreadJobCalled
ˆˆ *
+=
ˆˆ+ -
new
ˆˆ. 1*
FThreadJobCalledEventHandler
ˆˆ2 N
(
ˆˆN O(
m_fThdMain_ThreadJobCalled
ˆˆO i
)
ˆˆi j
;
ˆˆj k

m_fThdMain
‰‰ 
.
‰‰ 
start
‰‰  
(
‰‰  !
)
‰‰! "
;
‰‰" #
}
ŠŠ 
catch
‹‹ 
(
‹‹ 
	Exception
‹‹ 
ex
‹‹ 
)
‹‹  
{
ŒŒ 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
 
{
 
}
’’ 
}
““ 	
private
—— 
void
—— 
term
—— 
(
—— 
)
˜˜ 
{
™™ 	
try
šš 
{
›› 
if
œœ 
(
œœ 

m_fThdMain
œœ 
!=
œœ !
null
œœ" &
)
œœ& '
{
 

m_fThdMain
 
.
 
stop
 #
(
# $
)
$ %
;
% &

m_fThdMain
ŸŸ 
.
ŸŸ 
Dispose
ŸŸ &
(
ŸŸ& '
)
ŸŸ' (
;
ŸŸ( )

m_fThdMain
   
.
   
ThreadJobCalled
   .
-=
  / 1
new
  2 5*
FThreadJobCalledEventHandler
  6 R
(
  R S(
m_fThdMain_ThreadJobCalled
  S m
)
  m n
;
  n o

m_fThdMain
¡¡ 
=
¡¡  
null
¡¡! %
;
¡¡% &
}
¢¢ 
close
££ 
(
££ 
)
££ 
;
££ 
if
§§ 
(
§§ 
m_fEventPusher
§§ "
!=
§§# %
null
§§& *
)
§§* +
{
¨¨ 
m_fEventPusher
©© "
.
©©" #(
waitEventHandlingCompleted
©©# =
(
©©= >
)
©©> ?
;
©©? @
m_fEventPusher
ªª "
.
ªª" #
Dispose
ªª# *
(
ªª* +
)
ªª+ ,
;
ªª, -
m_fEventPusher
«« "
=
««# $
null
««% )
;
««) *
}
¬¬ 
if
°° 
(
°° 
m_fSerialFlag
°° !
!=
°°" $
null
°°% )
)
°°) *
{
±± 
m_fSerialFlag
²² !
.
²²! "
Dispose
²²" )
(
²²) *
)
²²* +
;
²²+ ,
m_fSerialFlag
³³ !
=
³³" #
null
³³$ (
;
³³( )
}
´´ 
if
¸¸ 
(
¸¸ 
m_fMainSync
¸¸ 
!=
¸¸  "
null
¸¸# '
)
¸¸' (
{
¹¹ 
m_fMainSync
ºº 
.
ºº  
Dispose
ºº  '
(
ºº' (
)
ºº( )
;
ºº) *
m_fMainSync
»» 
=
»»  !
null
»»" &
;
»»& '
}
¼¼ 
}
½½ 
catch
¾¾ 
(
¾¾ 
	Exception
¾¾ 
ex
¾¾ 
)
¾¾  
{
¿¿ 
FDebug
ÀÀ 
.
ÀÀ 
throwException
ÀÀ %
(
ÀÀ% &
ex
ÀÀ& (
)
ÀÀ( )
;
ÀÀ) *
}
ÁÁ 
finally
ÂÂ 
{
ÃÃ 
}
ÅÅ 
}
ÆÆ 	
private
ÊÊ 
void
ÊÊ 
changeState
ÊÊ  
(
ÊÊ  !
FSerialState
ËË 
fState
ËË 
)
ÌÌ 
{
ÍÍ 	
try
ÎÎ 
{
ÏÏ 
m_fState
ĞĞ 
=
ĞĞ 
fState
ĞĞ !
;
ĞĞ! "
m_fEventPusher
ÑÑ 
.
ÑÑ 
	pushEvent
ÑÑ (
(
ÑÑ( )
new
ÒÒ *
FSerialStateChangedEventArgs
ÒÒ 4
(
ÒÒ4 5
this
ÒÒ5 9
,
ÒÒ9 :
fState
ÒÒ; A
,
ÒÒA B

m_portName
ÒÒC M
,
ÒÒM N

m_baudRate
ÒÒO Y
)
ÒÒY Z
)
ÓÓ 
;
ÓÓ 
}
ÔÔ 
catch
ÕÕ 
(
ÕÕ 
	Exception
ÕÕ 
ex
ÕÕ 
)
ÕÕ  
{
ÖÖ 
FDebug
×× 
.
×× 
throwException
×× %
(
××% &
ex
××& (
)
××( )
;
××) *
}
ØØ 
finally
ÙÙ 
{
ÚÚ 
}
ÜÜ 
}
İİ 	
private
áá 
void
áá %
pushDataSendFailedEvent
áá ,
(
áá, -
FSerialSendData
ââ 
fData
ââ !
,
ââ! "
string
ãã 
message
ãã 
)
ää 
{
åå 	
try
ææ 
{
çç 
m_fEventPusher
èè 
.
èè 
	pushEvent
èè (
(
èè( )
new
èè) ,,
FSerialDataSendFailedEventArgs
èè- K
(
èèK L
this
èèL P
,
èèP Q
fData
èèR W
,
èèW X
message
èèY `
)
èè` a
)
èèa b
;
èèb c
}
éé 
catch
êê 
(
êê 
	Exception
êê 
ex
êê 
)
êê  
{
ëë 
FDebug
ìì 
.
ìì 
writeLog
ìì 
(
ìì  
ex
ìì  "
)
ìì" #
;
ìì# $
}
íí 
finally
îî 
{
ïï 
}
ññ 
}
òò 	
private
öö 
void
öö 
pushErrorEvent
öö #
(
öö# $
	Exception
÷÷ 
ex
÷÷ 
)
øø 
{
ùù 	
try
úú 
{
ûû 
FDebug
üü 
.
üü 
writeLog
üü 
(
üü  
ex
üü  "
)
üü" #
;
üü# $
m_fEventPusher
şş 
.
şş 
	pushEvent
şş (
(
şş( )
new
şş) ,)
FSerialErrorRaisedEventArgs
şş- H
(
şşH I
this
şşI M
,
şşM N
ex
şşO Q
.
şşQ R
Message
şşR Y
,
şşY Z
ex
şş[ ]
)
şş] ^
)
şş^ _
;
şş_ `
}
ÿÿ 
catch
€€ 
(
€€ 
	Exception
€€ 
ex1
€€  
)
€€  !
{
 
FDebug
‚‚ 
.
‚‚ 
writeLog
‚‚ 
(
‚‚  
ex1
‚‚  #
)
‚‚# $
;
‚‚$ %
}
ƒƒ 
finally
„„ 
{
…… 
}
‡‡ 
}
ˆˆ 	
private
ŒŒ 
void
ŒŒ 
initPort
ŒŒ 
(
ŒŒ 
)
 
{
 	
try
 
{
 

termSerial
‘‘ 
(
‘‘ 
)
‘‘ 
;
‘‘ 
m_fSerialFlag
•• 
.
•• 
init
•• "
(
••" #
)
••# $
;
••$ %
m_serialPort
™™ 
=
™™ 
new
™™ "

SerialPort
™™# -
(
™™- .
)
™™. /
;
™™/ 0
m_serialPort
›› 
.
›› 
PortName
›› %
=
››& '

m_portName
››( 2
;
››2 3
m_serialPort
œœ 
.
œœ 
BaudRate
œœ %
=
œœ& '

m_baudRate
œœ( 2
;
œœ2 3
m_serialPort
 
.
 
Parity
 #
=
$ %
m_parity
& .
;
. /
m_serialPort
 
.
 
DataBits
 %
=
& '

m_dataBits
( 2
;
2 3
m_serialPort
ŸŸ 
.
ŸŸ 
StopBits
ŸŸ %
=
ŸŸ& '

m_stopBits
ŸŸ( 2
;
ŸŸ2 3
m_serialPort
¡¡ 
.
¡¡ 
ReadBufferSize
¡¡ +
=
¡¡, -
RecvBufferSize
¡¡. <
;
¡¡< =
m_serialPort
¢¢ 
.
¢¢ 
WriteBufferSize
¢¢ ,
=
¢¢- .
SendBufferSize
¢¢/ =
;
¢¢= >
}
££ 
catch
¤¤ 
(
¤¤ 
	Exception
¤¤ 
ex
¤¤ 
)
¤¤  
{
¥¥ 
FDebug
¦¦ 
.
¦¦ 
throwException
¦¦ %
(
¦¦% &
ex
¦¦& (
)
¦¦( )
;
¦¦) *
}
§§ 
finally
¨¨ 
{
©© 
}
«« 
}
¬¬ 	
public
°° 
void
°° 
open
°° 
(
°° 
)
±± 
{
²² 	
try
³³ 
{
´´ 
m_fMainSync
µµ 
.
µµ 
wait
µµ  
(
µµ  !
)
µµ! "
;
µµ" #
if
¼¼ 
(
¼¼ 
m_fState
¼¼ 
!=
¼¼ 
FSerialState
¼¼  ,
.
¼¼, -
Closed
¼¼- 3
)
¼¼3 4
{
½½ 
FDebug
¾¾ 
.
¾¾ 
throwFException
¾¾ *
(
¾¾* +
string
¾¾+ 1
.
¾¾1 2
Format
¾¾2 8
(
¾¾8 9

FConstants
¾¾9 C
.
¾¾C D

err_m_0011
¾¾D N
,
¾¾N O
$str
¾¾P f
,
¾¾f g
$str
¾¾h p
)
¾¾p q
)
¾¾q r
;
¾¾r s
}
¿¿ 
initPort
ÃÃ 
(
ÃÃ 
)
ÃÃ 
;
ÃÃ 
m_serialPort
ÅÅ 
.
ÅÅ 
Open
ÅÅ !
(
ÅÅ! "
)
ÅÅ" #
;
ÅÅ# $
m_fSerialFlag
ÆÆ 
.
ÆÆ 
closed
ÆÆ $
=
ÆÆ% &
false
ÆÆ' ,
;
ÆÆ, -
changeState
ÈÈ 
(
ÈÈ 
FSerialState
ÈÈ (
.
ÈÈ( )
Opened
ÈÈ) /
)
ÈÈ/ 0
;
ÈÈ0 1
}
ÉÉ 
catch
ÊÊ 
(
ÊÊ 
	Exception
ÊÊ 
ex
ÊÊ 
)
ÊÊ  
{
ËË 
FDebug
ÌÌ 
.
ÌÌ 
throwException
ÌÌ %
(
ÌÌ% &
ex
ÌÌ& (
)
ÌÌ( )
;
ÌÌ) *
}
ÍÍ 
finally
ÎÎ 
{
ÏÏ 
m_fMainSync
ĞĞ 
.
ĞĞ 
set
ĞĞ 
(
ĞĞ  
)
ĞĞ  !
;
ĞĞ! "
}
ÑÑ 
}
ÒÒ 	
public
ÖÖ 
void
ÖÖ 
send
ÖÖ 
(
ÖÖ 
FSerialSendData
×× 
fData
×× !
)
ØØ 
{
ÙÙ 	
try
ÚÚ 
{
ÛÛ 
m_fMainSync
ÜÜ 
.
ÜÜ 
wait
ÜÜ  
(
ÜÜ  !
)
ÜÜ! "
;
ÜÜ" #
if
ãã 
(
ãã 
m_fState
ãã 
!=
ãã 
FSerialState
ãã  ,
.
ãã, -
Opened
ãã- 3
)
ãã3 4
{
ää 
FDebug
åå 
.
åå 
throwFException
åå *
(
åå* +
string
åå+ 1
.
åå1 2
Format
åå2 8
(
åå8 9

FConstants
åå9 C
.
ååC D

err_m_0013
ååD N
,
ååN O
$str
ååP W
)
ååW X
)
ååX Y
;
ååY Z
}
ææ 
doSend
êê 
(
êê 
fData
êê 
)
êê 
;
êê 
}
ëë 
catch
ìì 
(
ìì 
	Exception
ìì 
ex
ìì 
)
ìì  
{
íí 
FDebug
îî 
.
îî 
throwException
îî %
(
îî% &
ex
îî& (
)
îî( )
;
îî) *
}
ïï 
finally
ğğ 
{
ññ 
m_fMainSync
òò 
.
òò 
set
òò 
(
òò  
)
òò  !
;
òò! "
}
óó 
}
ôô 	
public
øø 
void
øø 
close
øø 
(
øø 
)
ùù 
{
úú 	
try
ûû 
{
üü 
m_fMainSync
ıı 
.
ıı 
wait
ıı  
(
ıı  !
)
ıı! "
;
ıı" #
doClose
 
(
 
)
 
;
 
}
‚‚ 
catch
ƒƒ 
(
ƒƒ 
	Exception
ƒƒ 
ex
ƒƒ 
)
ƒƒ  
{
„„ 
FDebug
…… 
.
…… 
throwException
…… %
(
……% &
ex
……& (
)
……( )
;
……) *
}
†† 
finally
‡‡ 
{
ˆˆ 
m_fMainSync
‰‰ 
.
‰‰ 
set
‰‰ 
(
‰‰  
)
‰‰  !
;
‰‰! "
}
ŠŠ 
}
‹‹ 	
private
 
void
 

termSerial
 
(
  
)
 
{
‘‘ 	
try
’’ 
{
““ 
if
”” 
(
”” 
m_serialPort
””  
==
””! #
null
””$ (
)
””( )
{
•• 
return
–– 
;
–– 
}
—— 
m_fSerialFlag
 
.
 
waitSendCompleted
 /
(
/ 0
)
0 1
;
1 2
m_serialPort
ŸŸ 
.
ŸŸ 
Close
ŸŸ "
(
ŸŸ" #
)
ŸŸ# $
;
ŸŸ$ %
m_fSerialFlag
   
.
   
closed
   $
=
  % &
true
  ' +
;
  + ,
m_fSerialFlag
¦¦ 
.
¦¦ 
waitAllCompleted
¦¦ .
(
¦¦. /
)
¦¦/ 0
;
¦¦0 1
m_serialPort
©© 
=
©© 
null
©© #
;
©©# $
}
ªª 
catch
«« 
(
«« 
	Exception
«« 
ex
«« 
)
««  
{
¬¬ 
FDebug
­­ 
.
­­ 
throwException
­­ %
(
­­% &
ex
­­& (
)
­­( )
;
­­) *
}
®® 
finally
¯¯ 
{
°° 
}
²² 
}
³³ 	
private
·· 
void
·· 
doOpen
·· 
(
·· 
)
¸¸ 
{
¹¹ 	
FDebugLogArgs
ºº 
fLogArgs
ºº "
=
ºº# $
null
ºº% )
;
ºº) *
try
¼¼ 
{
½½ 
m_fSerialFlag
¾¾ 
.
¾¾ 
	beginOpen
¾¾ '
(
¾¾' (
)
¾¾( )
;
¾¾) *
open
ÀÀ 
(
ÀÀ 
)
ÀÀ 
;
ÀÀ 
changeState
ÂÂ 
(
ÂÂ 
FSerialState
ÂÂ (
.
ÂÂ( )
Opened
ÂÂ) /
)
ÂÂ/ 0
;
ÂÂ0 1
fLogArgs
ÇÇ 
=
ÇÇ 
new
ÇÇ 
FDebugLogArgs
ÇÇ ,
(
ÇÇ, -
FDebugLogCategory
ÇÇ- >
.
ÇÇ> ?
Information
ÇÇ? J
,
ÇÇJ K
$str
ÇÇL \
,
ÇÇ\ ]
this
ÇÇ^ b
.
ÇÇb c
GetType
ÇÇc j
(
ÇÇj k
)
ÇÇk l
,
ÇÇl m
$str
ÇÇn v
)
ÇÇv w
;
ÇÇw x
fLogArgs
ÈÈ 
.
ÈÈ 
additionInfo
ÈÈ %
=
ÈÈ& '
$str
ÈÈ( 4
+
ÈÈ5 6

m_portName
ÈÈ7 A
+
ÈÈB C
$str
ÈÈD S
+
ÈÈT U

m_baudRate
ÈÈV `
+
ÈÈa b
$str
ÈÈc p
+
ÈÈq r
m_parity
ÈÈs {
.
ÈÈ{ |
ToStringÈÈ| „
(ÈÈ„ …
)ÈÈ… †
+ÈÈ‡ ˆ
$strÈÈ‰ ˜
+ÈÈ™ š

m_dataBitsÈÈ› ¥
.ÈÈ¥ ¦
ToStringÈÈ¦ ®
(ÈÈ® ¯
)ÈÈ¯ °
+ÈÈ± ²
$strÈÈ³ Â
+ÈÈÃ Ä

m_stopBitsÈÈÅ Ï
.ÈÈÏ Ğ
ToStringÈÈĞ Ø
(ÈÈØ Ù
)ÈÈÙ Ú
+ÈÈÛ Ü
$strÈÈİ à
;ÈÈà á
FDebug
ÉÉ 
.
ÉÉ 
writeLog
ÉÉ 
(
ÉÉ  
fLogArgs
ÉÉ  (
)
ÉÉ( )
;
ÉÉ) *
m_fSerialFlag
ÍÍ 
.
ÍÍ 
endOpen
ÍÍ %
(
ÍÍ% &
)
ÍÍ& '
;
ÍÍ' (
}
ÎÎ 
catch
ÏÏ 
(
ÏÏ 
	Exception
ÏÏ 
ex
ÏÏ 
)
ÏÏ  
{
ĞĞ 
if
ÑÑ 
(
ÑÑ 
ex
ÑÑ 
is
ÑÑ %
ObjectDisposedException
ÑÑ 1
)
ÑÑ1 2
{
ÒÒ 
System
ÓÓ 
.
ÓÓ 
Diagnostics
ÓÓ &
.
ÓÓ& '
Debug
ÓÓ' ,
.
ÓÓ, -
	WriteLine
ÓÓ- 6
(
ÓÓ6 7
ex
ÓÓ7 9
.
ÓÓ9 :
ToString
ÓÓ: B
(
ÓÓB C
)
ÓÓC D
)
ÓÓD E
;
ÓÓE F
}
ÔÔ 
else
ÕÕ 
{
ÖÖ 
pushErrorEvent
×× "
(
××" #
ex
××# %
)
××% &
;
××& '
}
ØØ 
m_fSerialFlag
ÙÙ 
.
ÙÙ 
endOpen
ÙÙ %
(
ÙÙ% &
)
ÙÙ& '
;
ÙÙ' (
}
ÚÚ 
finally
ÛÛ 
{
ÜÜ 
}
ŞŞ 
}
ßß 	
private
ãã 
void
ãã 
doClose
ãã 
(
ãã 
)
ää 
{
åå 	
FDebugLogArgs
ææ 
fLogArgs
ææ "
=
ææ# $
null
ææ% )
;
ææ) *
try
èè 
{
éé 
if
êê 
(
êê 
m_fSerialFlag
êê !
.
êê! "
closed
êê" (
)
êê( )
{
ëë 
return
ìì 
;
ìì 
}
íí 

termSerial
ğğ 
(
ğğ 
)
ğğ 
;
ğğ 
changeState
ññ 
(
ññ 
FSerialState
ññ (
.
ññ( )
Closed
ññ) /
)
ññ/ 0
;
ññ0 1
fLogArgs
öö 
=
öö 
new
öö 
FDebugLogArgs
öö ,
(
öö, -
FDebugLogCategory
öö- >
.
öö> ?
Information
öö? J
,
ööJ K
$str
ööL ]
,
öö] ^
this
öö_ c
.
ööc d
GetType
ööd k
(
öök l
)
ööl m
,
ööm n
$str
ööo x
)
ööx y
;
ööy z
fLogArgs
÷÷ 
.
÷÷ 
additionInfo
÷÷ %
=
÷÷& '
$str
÷÷( 4
+
÷÷5 6

m_portName
÷÷7 A
+
÷÷B C
$str
÷÷D G
;
÷÷G H
FDebug
øø 
.
øø 
writeLog
øø 
(
øø  
fLogArgs
øø  (
)
øø( )
;
øø) *
}
ıı 
catch
şş 
(
şş 
	Exception
şş 
ex
şş 
)
şş  
{
ÿÿ 
FDebug
€€ 
.
€€ 
throwException
€€ %
(
€€% &
ex
€€& (
)
€€( )
;
€€) *
}
 
finally
‚‚ 
{
ƒƒ 
}
…… 
}
†† 	
private
ŠŠ 
void
ŠŠ 
	doReceive
ŠŠ 
(
ŠŠ 
)
‹‹ 
{
ŒŒ 	
try
 
{
 
m_fSerialFlag
 
.
 
beginReceive
 *
(
* +
)
+ ,
;
, -
m_serialPort
 
.
 

BaseStream
 '
.
' (
	BeginRead
( 1
(
1 2
	m_recvBuf
2 ;
,
; <
$num
= >
,
> ?
	m_recvBuf
@ I
.
I J
Length
J P
,
P Q
new
R U
AsyncCallback
V c
(
c d
doReceiveCallback
d u
)
u v
,
v w
this
x |
)
| }
;
} ~
}
‘‘ 
catch
’’ 
(
’’ 
	Exception
’’ 
ex
’’ 
)
’’  
{
““ 
if
”” 
(
”” 
ex
”” 
is
”” 
IOException
”” %
)
””% &
{
•• 
pushErrorEvent
–– "
(
––" #
ex
––# %
)
––% &
;
––& '
doClose
 
(
 
)
 
;
 
}
 
else
ŸŸ 
if
ŸŸ 
(
ŸŸ 
ex
ŸŸ 
is
ŸŸ %
ObjectDisposedException
ŸŸ 6
)
ŸŸ6 7
{
   
System
¡¡ 
.
¡¡ 
Diagnostics
¡¡ &
.
¡¡& '
Debug
¡¡' ,
.
¡¡, -
	WriteLine
¡¡- 6
(
¡¡6 7
ex
¡¡7 9
)
¡¡9 :
;
¡¡: ;
}
¢¢ 
else
££ 
{
¤¤ 
pushErrorEvent
¥¥ "
(
¥¥" #
ex
¥¥# %
)
¥¥% &
;
¥¥& '
}
¦¦ 
m_fSerialFlag
§§ 
.
§§ 

endReceive
§§ (
(
§§( )
)
§§) *
;
§§* +
}
¨¨ 
finally
©© 
{
ªª 
}
¬¬ 
}
­­ 	
private
±± 
void
±± 
doSend
±± 
(
±± 
FSerialSendData
²² 
fData
²² !
)
³³ 
{
´´ 	
try
µµ 
{
¶¶ 
m_fSerialFlag
·· 
.
·· 
	beginSend
·· '
(
··' (
)
··( )
;
··) *
m_serialPort
¸¸ 
.
¸¸ 

BaseStream
¸¸ '
.
¸¸' (

BeginWrite
¸¸( 2
(
¸¸2 3
fData
¸¸3 8
.
¸¸8 9
data
¸¸9 =
,
¸¸= >
$num
¸¸? @
,
¸¸@ A
fData
¸¸B G
.
¸¸G H
data
¸¸H L
.
¸¸L M
Length
¸¸M S
,
¸¸S T
new
¸¸U X
AsyncCallback
¸¸Y f
(
¸¸f g
doSendCallback
¸¸g u
)
¸¸u v
,
¸¸v w
fData
¸¸x }
)
¸¸} ~
;
¸¸~ 
}
¹¹ 
catch
ºº 
(
ºº 
	Exception
ºº 
ex
ºº 
)
ºº  
{
»» 
if
¼¼ 
(
¼¼ 
ex
¼¼ 
is
¼¼ 
IOException
¼¼ %
)
¼¼% &
{
½½ 
pushErrorEvent
¾¾ "
(
¾¾" #
ex
¾¾# %
)
¾¾% &
;
¾¾& '%
pushDataSendFailedEvent
¿¿ +
(
¿¿+ ,
fData
¿¿, 1
,
¿¿1 2
ex
¿¿3 5
.
¿¿5 6
Message
¿¿6 =
)
¿¿= >
;
¿¿> ?
doClose
ÆÆ 
(
ÆÆ 
)
ÆÆ 
;
ÆÆ 
}
ÇÇ 
else
ÈÈ 
if
ÈÈ 
(
ÈÈ 
ex
ÈÈ 
is
ÈÈ %
ObjectDisposedException
ÈÈ 6
)
ÈÈ6 7
{
ÉÉ 
System
ÊÊ 
.
ÊÊ 
Diagnostics
ÊÊ &
.
ÊÊ& '
Debug
ÊÊ' ,
.
ÊÊ, -
	WriteLine
ÊÊ- 6
(
ÊÊ6 7
ex
ÊÊ7 9
)
ÊÊ9 :
;
ÊÊ: ;
}
ËË 
else
ÌÌ 
{
ÍÍ 
pushErrorEvent
ÎÎ "
(
ÎÎ" #
ex
ÎÎ# %
)
ÎÎ% &
;
ÎÎ& '%
pushDataSendFailedEvent
ÏÏ +
(
ÏÏ+ ,
fData
ÏÏ, 1
,
ÏÏ1 2
ex
ÏÏ3 5
.
ÏÏ5 6
Message
ÏÏ6 =
)
ÏÏ= >
;
ÏÏ> ?
}
ĞĞ 
m_fSerialFlag
ÑÑ 
.
ÑÑ 
endSend
ÑÑ %
(
ÑÑ% &
)
ÑÑ& '
;
ÑÑ' (
}
ÒÒ 
finally
ÓÓ 
{
ÔÔ 
}
ÖÖ 
}
×× 	
private
ÛÛ 
void
ÛÛ 
doReceiveCallback
ÛÛ &
(
ÛÛ& '
IAsyncResult
ÜÜ 
ar
ÜÜ 
)
İİ 
{
ŞŞ 	
int
ßß 
length
ßß 
=
ßß 
$num
ßß 
;
ßß 
byte
àà 
[
àà 
]
àà 
data
àà 
=
àà 
null
àà 
;
àà 
try
ââ 
{
ãã 
if
ää 
(
ää 
!
ää 
m_serialPort
ää !
.
ää! "
IsOpen
ää" (
)
ää( )
return
ää* 0
;
ää0 1
length
åå 
=
åå 
m_serialPort
åå %
.
åå% &

BaseStream
åå& 0
.
åå0 1
EndRead
åå1 8
(
åå8 9
ar
åå9 ;
)
åå; <
;
åå< =
if
ææ 
(
ææ 
length
ææ 
==
ææ 
$num
ææ 
)
ææ  
{
çç 
doClose
èè 
(
èè 
)
èè 
;
èè 
return
éé 
;
éé 
}
êê 
data
îî 
=
îî 
new
îî 
byte
îî 
[
îî  
length
îî  &
]
îî& '
;
îî' (
Buffer
ïï 
.
ïï 
	BlockCopy
ïï  
(
ïï  !
	m_recvBuf
ïï! *
,
ïï* +
$num
ïï, -
,
ïï- .
data
ïï/ 3
,
ïï3 4
$num
ïï5 6
,
ïï6 7
length
ïï8 >
)
ïï> ?
;
ïï? @
m_fEventPusher
ğğ 
.
ğğ 
	pushEvent
ğğ (
(
ğğ( )
new
ğğ) ,*
FSerialDataReceivedEventArgs
ğğ- I
(
ğğI J
this
ğğJ N
,
ğğN O
data
ğğP T
,
ğğT U
m_serialPort
ğğV b
.
ğğb c
BytesToRead
ğğc n
)
ğğn o
)
ğğo p
;
ğğp q
}
ññ 
catch
òò 
(
òò 
	Exception
òò 
ex
òò 
)
òò  
{
óó 
if
ôô 
(
ôô 
ex
ôô 
is
ôô 
IOException
ôô %
)
ôô% &
{
õõ 
pushErrorEvent
öö "
(
öö" #
ex
öö# %
)
öö% &
;
öö& '
doClose
ıı 
(
ıı 
)
ıı 
;
ıı 
}
şş 
else
ÿÿ 
if
ÿÿ 
(
ÿÿ 
ex
ÿÿ 
is
ÿÿ %
ObjectDisposedException
ÿÿ 6
)
ÿÿ6 7
{
€€ 
System
 
.
 
Diagnostics
 &
.
& '
Debug
' ,
.
, -
	WriteLine
- 6
(
6 7
ex
7 9
)
9 :
;
: ;
}
‚‚ 
else
ƒƒ 
{
„„ 
pushErrorEvent
…… "
(
……" #
ex
……# %
)
……% &
;
……& '
}
†† 
}
‡‡ 
finally
ˆˆ 
{
‰‰ 
m_fSerialFlag
ŠŠ 
.
ŠŠ 

endReceive
ŠŠ (
(
ŠŠ( )
)
ŠŠ) *
;
ŠŠ* +
}
‹‹ 
}
ŒŒ 	
private
 
void
 
doSendCallback
 #
(
# $
IAsyncResult
‘‘ 
ar
‘‘ 
)
’’ 
{
““ 	
FSerialSendData
”” 
fData
”” !
=
””" #
null
””$ (
;
””( )
try
–– 
{
—— 
fData
˜˜ 
=
˜˜ 
(
˜˜ 
FSerialSendData
˜˜ (
)
˜˜( )
ar
˜˜) +
.
˜˜+ ,

AsyncState
˜˜, 6
;
˜˜6 7
m_serialPort
™™ 
.
™™ 

BaseStream
™™ '
.
™™' (
EndWrite
™™( 0
(
™™0 1
ar
™™1 3
)
™™3 4
;
™™4 5
m_fEventPusher
šš 
.
šš 
	pushEvent
šš (
(
šš( )
new
šš) ,&
FSerialDataSentEventArgs
šš- E
(
ššE F
this
ššF J
,
ššJ K
fData
ššL Q
)
ššQ R
)
ššR S
;
ššS T
}
›› 
catch
œœ 
(
œœ 
	Exception
œœ 
ex
œœ 
)
œœ  
{
 
if
 
(
 
ex
 
is
 
IOException
 %
)
% &
{
ŸŸ 
pushErrorEvent
   "
(
  " #
ex
  # %
)
  % &
;
  & '%
pushDataSendFailedEvent
¡¡ +
(
¡¡+ ,
fData
¡¡, 1
,
¡¡1 2
ex
¡¡3 5
.
¡¡5 6
Message
¡¡6 =
)
¡¡= >
;
¡¡> ?
doClose
¨¨ 
(
¨¨ 
)
¨¨ 
;
¨¨ 
}
©© 
else
ªª 
if
ªª 
(
ªª 
ex
ªª 
is
ªª %
ObjectDisposedException
ªª 6
)
ªª6 7
{
«« 
System
¬¬ 
.
¬¬ 
Diagnostics
¬¬ &
.
¬¬& '
Debug
¬¬' ,
.
¬¬, -
	WriteLine
¬¬- 6
(
¬¬6 7
ex
¬¬7 9
.
¬¬9 :
ToString
¬¬: B
(
¬¬B C
)
¬¬C D
)
¬¬D E
;
¬¬E F
}
­­ 
else
®® 
{
¯¯ 
pushErrorEvent
°° "
(
°°" #
ex
°°# %
)
°°% &
;
°°& '%
pushDataSendFailedEvent
±± +
(
±±+ ,
fData
±±, 1
,
±±1 2
ex
±±3 5
.
±±5 6
Message
±±6 =
)
±±= >
;
±±> ?
}
²² 
}
³³ 
finally
´´ 
{
µµ 
m_fSerialFlag
¶¶ 
.
¶¶ 
endSend
¶¶ %
(
¶¶% &
)
¶¶& '
;
¶¶' (
}
·· 
}
¸¸ 	
internal
¼¼ 
void
¼¼ "
onSerialStateChanged
¼¼ *
(
¼¼* +"
FSerialEventArgsBase
½½  
args
½½! %
)
¾¾ 
{
¿¿ 	
try
ÀÀ 
{
ÁÁ 
if
ÂÂ 
(
ÂÂ  
SerialStateChanged
ÂÂ &
!=
ÂÂ' )
null
ÂÂ* .
)
ÂÂ. /
{
ÃÃ  
SerialStateChanged
ÄÄ &
(
ÄÄ& '
this
ÄÄ' +
,
ÄÄ+ ,
(
ÄÄ- .*
FSerialStateChangedEventArgs
ÄÄ. J
)
ÄÄJ K
args
ÄÄK O
)
ÄÄO P
;
ÄÄP Q
}
ÅÅ 
}
ÆÆ 
catch
ÇÇ 
(
ÇÇ 
	Exception
ÇÇ 
ex
ÇÇ 
)
ÇÇ  
{
ÈÈ 
FDebug
ÉÉ 
.
ÉÉ 
writeLog
ÉÉ 
(
ÉÉ  
ex
ÉÉ  "
)
ÉÉ" #
;
ÉÉ# $
}
ÊÊ 
finally
ËË 
{
ÌÌ 
}
ÎÎ 
}
ÏÏ 	
internal
ÓÓ 
void
ÓÓ "
onSerialDataReceived
ÓÓ *
(
ÓÓ* +"
FSerialEventArgsBase
ÔÔ  
args
ÔÔ! %
)
ÕÕ 
{
ÖÖ 	
try
×× 
{
ØØ 
if
ÙÙ 
(
ÙÙ  
SerialDataReceived
ÙÙ &
!=
ÙÙ' )
null
ÙÙ* .
)
ÙÙ. /
{
ÚÚ  
SerialDataReceived
ÛÛ &
(
ÛÛ& '
this
ÛÛ' +
,
ÛÛ+ ,
(
ÛÛ- .*
FSerialDataReceivedEventArgs
ÛÛ. J
)
ÛÛJ K
args
ÛÛK O
)
ÛÛO P
;
ÛÛP Q
}
ÜÜ 
}
İİ 
catch
ŞŞ 
(
ŞŞ 
	Exception
ŞŞ 
ex
ŞŞ 
)
ŞŞ  
{
ßß 
FDebug
àà 
.
àà 
writeLog
àà 
(
àà  
ex
àà  "
)
àà" #
;
àà# $
}
áá 
finally
ââ 
{
ãã 
}
åå 
}
ææ 	
internal
êê 
void
êê 
onSerialDataSent
êê &
(
êê& '"
FSerialEventArgsBase
ëë  
args
ëë! %
)
ìì 
{
íí 	
try
îî 
{
ïï 
if
ğğ 
(
ğğ 
SerialDataSent
ğğ "
!=
ğğ# %
null
ğğ& *
)
ğğ* +
{
ññ 
SerialDataSent
òò "
(
òò" #
this
òò# '
,
òò' (
(
òò) *&
FSerialDataSentEventArgs
òò* B
)
òòB C
args
òòC G
)
òòG H
;
òòH I
}
óó 
}
ôô 
catch
õõ 
(
õõ 
	Exception
õõ 
ex
õõ 
)
õõ  
{
öö 
FDebug
÷÷ 
.
÷÷ 
writeLog
÷÷ 
(
÷÷  
ex
÷÷  "
)
÷÷" #
;
÷÷# $
}
øø 
finally
ùù 
{
úú 
}
üü 
}
ıı 	
internal
 
void
 $
onSerialDataSendFailed
 ,
(
, -"
FSerialEventArgsBase
‚‚  
args
‚‚! %
)
ƒƒ 
{
„„ 	
try
…… 
{
†† 
if
‡‡ 
(
‡‡ "
SerialDataSendFailed
‡‡ (
!=
‡‡) +
null
‡‡, 0
)
‡‡0 1
{
ˆˆ "
SerialDataSendFailed
‰‰ (
(
‰‰( )
this
‰‰) -
,
‰‰- .
(
‰‰/ 0,
FSerialDataSendFailedEventArgs
‰‰0 N
)
‰‰N O
args
‰‰O S
)
‰‰S T
;
‰‰T U
}
ŠŠ 
}
‹‹ 
catch
ŒŒ 
(
ŒŒ 
	Exception
ŒŒ 
ex
ŒŒ 
)
ŒŒ  
{
 
FDebug
 
.
 
writeLog
 
(
  
ex
  "
)
" #
;
# $
}
 
finally
 
{
‘‘ 
}
““ 
}
”” 	
internal
˜˜ 
void
˜˜ !
onSerialErrorRaised
˜˜ )
(
˜˜) *"
FSerialEventArgsBase
™™  
args
™™! %
)
šš 
{
›› 	
try
œœ 
{
 
if
 
(
 
SerialErrorRaised
 %
!=
& (
null
) -
)
- .
{
ŸŸ 
SerialErrorRaised
   %
(
  % &
this
  & *
,
  * +
(
  , -)
FSerialErrorRaisedEventArgs
  - H
)
  H I
args
  I M
)
  M N
;
  N O
}
¡¡ 
}
¢¢ 
catch
££ 
(
££ 
	Exception
££ 
ex
££ 
)
££  
{
¤¤ 
FDebug
¥¥ 
.
¥¥ 
writeLog
¥¥ 
(
¥¥  
ex
¥¥  "
)
¥¥" #
;
¥¥# $
}
¦¦ 
finally
§§ 
{
¨¨ 
}
ªª 
}
«« 	
private
³³ 
void
³³ (
m_fThdMain_ThreadJobCalled
³³ /
(
³³/ 0
object
´´ 
sender
´´ 
,
´´ 
FThreadEventArgs
µµ 
e
µµ 
)
¶¶ 
{
·· 	
bool
¸¸ 
waited
¸¸ 
=
¸¸ 
false
¸¸ 
;
¸¸  
try
ºº 
{
»» 
waited
¼¼ 
=
¼¼ 
m_fMainSync
¼¼ $
.
¼¼$ %
tryWait
¼¼% ,
(
¼¼, -
$num
¼¼- .
)
¼¼. /
;
¼¼/ 0
if
½½ 
(
½½ 
!
½½ 
waited
½½ 
)
½½ 
{
¾¾ 
return
¿¿ 
;
¿¿ 
}
ÀÀ 
if
ÄÄ 
(
ÄÄ 
m_fState
ÄÄ 
==
ÄÄ 
FSerialState
ÄÄ  ,
.
ÄÄ, -
Opened
ÄÄ- 3
)
ÄÄ3 4
{
ÅÅ 
if
ÆÆ 
(
ÆÆ 
m_fSerialFlag
ÆÆ %
.
ÆÆ% & 
doReceiveCompleted
ÆÆ& 8
)
ÆÆ8 9
{
ÇÇ 
	doReceive
ÈÈ !
(
ÈÈ! "
)
ÈÈ" #
;
ÈÈ# $
return
ÉÉ 
;
ÉÉ 
}
ÊÊ 
}
ËË 
else
ÌÌ 
if
ÌÌ 
(
ÌÌ 
m_fState
ÌÌ !
==
ÌÌ" $
FSerialState
ÌÌ% 1
.
ÌÌ1 2
Closed
ÌÌ2 8
)
ÌÌ8 9
{
ÍÍ 
}
ÏÏ 
e
ÓÓ 
.
ÓÓ 
sleepThread
ÓÓ 
(
ÓÓ 
$num
ÓÓ 
)
ÓÓ  
;
ÓÓ  !
}
ÔÔ 
catch
ÕÕ 
(
ÕÕ 
	Exception
ÕÕ 
ex
ÕÕ 
)
ÕÕ  
{
ÖÖ 
pushErrorEvent
×× 
(
×× 
ex
×× !
)
××! "
;
××" #
}
ØØ 
finally
ÙÙ 
{
ÚÚ 
if
ÛÛ 
(
ÛÛ 
waited
ÛÛ 
)
ÛÛ 
{
ÜÜ 
m_fMainSync
İİ 
.
İİ  
set
İİ  #
(
İİ# $
)
İİ$ %
;
İİ% &
}
ŞŞ 
}
ßß 
}
àà 	
}
ææ 
}çç ã
eD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Serial\c_FSerialEventArgsBase.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
Serializable 
] 
public 

abstract 
class  
FSerialEventArgsBase .
:/ 0
	EventArgs1 :
,: ;
IDisposable< G
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FSerialEventId 
m_fSerialEventId /
=0 1
FSerialEventId2 @
.@ A
NoneA E
;E F
internal""  
FSerialEventArgsBase"" %
(""% &
FSerialEventId## 
fSerialEventId## )
)$$ 
{%% 	
m_fSerialEventId&& 
=&& 
fSerialEventId&& -
;&&- .
}'' 	
	protected++ 
virtual++ 
void++ 
	myDispose++ (
(++( )
bool,, 
	disposing,, 
)-- 
{.. 	
if// 
(// 
!// 

m_disposed// 
)// 
{00 
if11 
(11 
	disposing11 
)11 
{22 
}44 

m_disposed66 
=66 
true66 !
;66! "
}77 
}88 	
public@@ 
void@@ 
Dispose@@ 
(@@ 
)AA 
{BB 	
	myDisposeCC 
(CC 
trueCC 
)CC 
;CC 
GCDD 
.DD 
SuppressFinalizeDD 
(DD  
thisDD  $
)DD$ %
;DD% &
}EE 	
internalMM 
FSerialEventIdMM 
fSerialEventIdMM  .
{NN 	
getOO 
{PP 
tryQQ 
{RR 
returnSS 
m_fSerialEventIdSS +
;SS+ ,
}TT 
catchUU 
(UU 
	ExceptionUU  
exUU! #
)UU# $
{VV 
FDebugWW 
.WW 
throwExceptionWW )
(WW) *
exWW* ,
)WW, -
;WW- .
}XX 
finallyYY 
{ZZ 
}\\ 
return]] 
FSerialEventId]] %
.]]% &
None]]& *
;]]* +
}^^ 
}__ 	
}kk 
}ll ×r
cD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Serial\c_FSerialEventPusher.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
internal 
class 
FSerialEventPusher %
:& '
IDisposable( 3
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
FISerial 
	m_fSerial 
= 
null !
;! "
private 
FQueue 
<  
FSerialEventArgsBase +
>+ ,
	m_fEvents- 6
=7 8
null9 =
;= >
private 
FThread 
m_fEventPusher &
=' (
null) -
;- .
private 
bool &
m_isCompletedEventHandling /
=0 1
false2 7
;7 8
public%% 
FSerialEventPusher%% !
(%%! "
FISerial&& 
fSerial&& 
)'' 
{(( 	
	m_fSerial)) 
=)) 
fSerial)) 
;))  
	m_fEvents** 
=** 
new** 
FQueue** "
<**" # 
FSerialEventArgsBase**# 7
>**7 8
(**8 9
)**9 :
;**: ;
init.. 
(.. 
).. 
;.. 
}// 	
~33 	
FSerialEventPusher33	 
(33 
)44 
{55 	
	myDispose66 
(66 
false66 
)66 
;66 
}77 	
	protected;; 
void;; 
	myDispose;;  
(;;  !
bool<< 
	disposing<< 
)== 
{>> 	
if?? 
(?? 
!?? 

m_disposed?? 
)?? 
{@@ 
ifAA 
(AA 
	disposingAA 
)AA 
{BB 
termCC 
(CC 
)CC 
;CC 
ifGG 
(GG 
	m_fEventsGG !
!=GG" $
nullGG% )
)GG) *
{HH 
	m_fEventsII !
.II! "
DisposeII" )
(II) *
)II* +
;II+ ,
	m_fEventsJJ !
=JJ" #
nullJJ$ (
;JJ( )
}KK 
	m_fSerialMM 
=MM 
nullMM  $
;MM$ %
}NN 

m_disposedPP 
=PP 
truePP !
;PP! "
}QQ 
}RR 	
publicZZ 
voidZZ 
DisposeZZ 
(ZZ 
)[[ 
{\\ 	
	myDispose]] 
(]] 
true]] 
)]] 
;]] 
GC^^ 
.^^ 
SuppressFinalize^^ 
(^^  
this^^  $
)^^$ %
;^^% &
}__ 	
publicgg 
intgg 

eventCountgg 
{hh 	
getii 
{jj 
trykk 
{ll 
returnmm 
	m_fEventsmm $
.mm$ %
countmm% *
;mm* +
}nn 
catchoo 
(oo 
	Exceptionoo  
exoo! #
)oo# $
{pp 
FDebugqq 
.qq 
throwExceptionqq )
(qq) *
exqq* ,
)qq, -
;qq- .
}rr 
finallyss 
{tt 
}vv 
returnww 
$numww 
;ww 
}xx 
}yy 	
public}} 
bool}} $
isCompletedEventHandling}} ,
{~~ 	
get 
{
€€ 
try
 
{
‚‚ 
if
ƒƒ 
(
ƒƒ 
this
ƒƒ 
.
ƒƒ 

eventCount
ƒƒ '
==
ƒƒ( *
$num
ƒƒ+ ,
&&
ƒƒ- /(
m_isCompletedEventHandling
ƒƒ0 J
)
ƒƒJ K
{
„„ 
return
…… 
true
…… #
;
……# $
}
†† 
return
‡‡ 
false
‡‡  
;
‡‡  !
}
ˆˆ 
catch
‰‰ 
(
‰‰ 
	Exception
‰‰  
ex
‰‰! #
)
‰‰# $
{
ŠŠ 
FDebug
‹‹ 
.
‹‹ 
throwException
‹‹ )
(
‹‹) *
ex
‹‹* ,
)
‹‹, -
;
‹‹- .
}
ŒŒ 
finally
 
{
 
}
 
return
‘‘ 
false
‘‘ 
;
‘‘ 
}
’’ 
}
““ 	
private
›› 
void
›› 
init
›› 
(
›› 
)
œœ 
{
 	
try
 
{
ŸŸ (
m_isCompletedEventHandling
   *
=
  + ,
true
  - 1
;
  1 2
m_fEventPusher
¡¡ 
=
¡¡  
new
¡¡! $
FThread
¡¡% ,
(
¡¡, -
$str
¡¡- F
,
¡¡F G
false
¡¡H M
,
¡¡M N
System
¡¡O U
.
¡¡U V
	Threading
¡¡V _
.
¡¡_ `
ThreadPriority
¡¡` n
.
¡¡n o
Normal
¡¡o u
,
¡¡u v
false
¡¡w |
)
¡¡| }
;
¡¡} ~
m_fEventPusher
¢¢ 
.
¢¢ 
ThreadJobCalled
¢¢ .
+=
¢¢/ 1
new
¢¢2 5*
FThreadJobCalledEventHandler
¢¢6 R
(
¢¢R S,
m_fEventPusher_ThreadJobCalled
¢¢S q
)
¢¢q r
;
¢¢r s
m_fEventPusher
££ 
.
££ 
start
££ $
(
££$ %
)
££% &
;
££& '
}
¤¤ 
catch
¥¥ 
(
¥¥ 
	Exception
¥¥ 
ex
¥¥ 
)
¥¥  
{
¦¦ 
FDebug
§§ 
.
§§ 
throwException
§§ %
(
§§% &
ex
§§& (
)
§§( )
;
§§) *
}
¨¨ 
finally
©© 
{
ªª 
}
¬¬ 
}
®® 	
private
²² 
void
²² 
term
²² 
(
²² 
)
³³ 
{
´´ 	
try
µµ 
{
¶¶ 
if
·· 
(
·· 
m_fEventPusher
·· "
!=
··# %
null
··& *
)
··* +
{
¸¸ 
while
¹¹ 
(
¹¹ 
!
¹¹ 
this
¹¹  
.
¹¹  !(
m_isCompletedEventHandling
¹¹! ;
)
¹¹; <
{
ºº 
System
»» 
.
»» 
	Threading
»» (
.
»»( )
Thread
»») /
.
»»/ 0
Sleep
»»0 5
(
»»5 6
$num
»»6 8
)
»»8 9
;
»»9 :
}
¼¼ 
m_fEventPusher
ÀÀ "
.
ÀÀ" #
ThreadJobCalled
ÀÀ# 2
-=
ÀÀ3 5
new
ÀÀ6 9*
FThreadJobCalledEventHandler
ÀÀ: V
(
ÀÀV W,
m_fEventPusher_ThreadJobCalled
ÀÀW u
)
ÀÀu v
;
ÀÀv w
m_fEventPusher
ÂÂ "
.
ÂÂ" #
stop
ÂÂ# '
(
ÂÂ' (
)
ÂÂ( )
;
ÂÂ) *
m_fEventPusher
ÃÃ "
.
ÃÃ" #
Dispose
ÃÃ# *
(
ÃÃ* +
)
ÃÃ+ ,
;
ÃÃ, -
m_fEventPusher
ÄÄ "
=
ÄÄ# $
null
ÄÄ% )
;
ÄÄ) *
}
ÅÅ 
}
ÆÆ 
catch
ÇÇ 
(
ÇÇ 
	Exception
ÇÇ 
ex
ÇÇ 
)
ÇÇ  
{
ÈÈ 
FDebug
ÉÉ 
.
ÉÉ 
throwException
ÉÉ %
(
ÉÉ% &
ex
ÉÉ& (
)
ÉÉ( )
;
ÉÉ) *
}
ÊÊ 
finally
ËË 
{
ÌÌ 
}
ÎÎ 
}
ÏÏ 	
public
ÓÓ 
void
ÓÓ 
	pushEvent
ÓÓ 
(
ÓÓ "
FSerialEventArgsBase
ÔÔ  
fSerialEvent
ÔÔ! -
)
ÕÕ 
{
ÖÖ 	
try
×× 
{
ØØ 
	m_fEvents
ÙÙ 
.
ÙÙ 
enqueue
ÙÙ !
(
ÙÙ! "
fSerialEvent
ÙÙ" .
)
ÙÙ. /
;
ÙÙ/ 0
}
ÚÚ 
catch
ÛÛ 
(
ÛÛ 
	Exception
ÛÛ 
ex
ÛÛ 
)
ÛÛ  
{
ÜÜ 
FDebug
İİ 
.
İİ 
throwException
İİ %
(
İİ% &
ex
İİ& (
)
İİ( )
;
İİ) *
}
ŞŞ 
finally
ßß 
{
àà 
}
ââ 
}
ãã 	
public
çç 
void
çç 
	pushEvent
çç 
(
çç "
FSerialEventArgsBase
èè  
[
èè  !
]
èè! "
fSerialEvents
èè# 0
)
éé 
{
êê 	
try
ëë 
{
ìì 
	m_fEvents
íí 
.
íí 
enqueue
íí !
(
íí! "
fSerialEvents
íí" /
)
íí/ 0
;
íí0 1
}
îî 
catch
ïï 
(
ïï 
	Exception
ïï 
ex
ïï 
)
ïï  
{
ğğ 
FDebug
ññ 
.
ññ 
throwException
ññ %
(
ññ% &
ex
ññ& (
)
ññ( )
;
ññ) *
}
òò 
finally
óó 
{
ôô 
}
öö 
}
÷÷ 	
public
ûû 
void
ûû (
waitEventHandlingCompleted
ûû .
(
ûû. /
)
üü 
{
ıı 	
try
şş 
{
ÿÿ 
while
€€ 
(
€€ 
!
€€ 
this
€€ 
.
€€ (
m_isCompletedEventHandling
€€ 7
)
€€7 8
{
 
if
‚‚ 
(
‚‚ 
System
‚‚ 
.
‚‚ 
Windows
‚‚ &
.
‚‚& '
Forms
‚‚' ,
.
‚‚, -
Application
‚‚- 8
.
‚‚8 9
MessageLoop
‚‚9 D
)
‚‚D E
{
ƒƒ 
System
„„ 
.
„„ 
Windows
„„ &
.
„„& '
Forms
„„' ,
.
„„, -
Application
„„- 8
.
„„8 9
DoEvents
„„9 A
(
„„A B
)
„„B C
;
„„C D
}
…… 
System
†† 
.
†† 
	Threading
†† $
.
††$ %
Thread
††% +
.
††+ ,
Sleep
††, 1
(
††1 2
$num
††2 3
)
††3 4
;
††4 5
}
‡‡ 
}
ˆˆ 
catch
‰‰ 
(
‰‰ 
	Exception
‰‰ 
ex
‰‰ 
)
‰‰  
{
ŠŠ 
FDebug
‹‹ 
.
‹‹ 
throwException
‹‹ %
(
‹‹% &
ex
‹‹& (
)
‹‹( )
;
‹‹) *
}
ŒŒ 
finally
 
{
 
}
 
}
‘‘ 	
private
™™ 
void
™™ ,
m_fEventPusher_ThreadJobCalled
™™ 3
(
™™3 4
object
šš 
sender
šš 
,
šš 
FThreadEventArgs
›› 
e
›› 
)
œœ 
{
 	"
FSerialEventArgsBase
  
args
! %
=
& '
null
( ,
;
, -
try
   
{
¡¡ 
if
¢¢ 
(
¢¢ 
	m_fEvents
¢¢ 
.
¢¢ 
count
¢¢ #
==
¢¢$ &
$num
¢¢' (
)
¢¢( )
{
££ (
m_isCompletedEventHandling
¤¤ .
=
¤¤/ 0
true
¤¤1 5
;
¤¤5 6
e
¥¥ 
.
¥¥ 
sleepThread
¥¥ !
(
¥¥! "
$num
¥¥" #
)
¥¥# $
;
¥¥$ %
return
¦¦ 
;
¦¦ 
}
§§ (
m_isCompletedEventHandling
¨¨ *
=
¨¨+ ,
false
¨¨- 2
;
¨¨2 3
while
¬¬ 
(
¬¬ 
(
¬¬ 
args
¬¬ 
=
¬¬ 
	m_fEvents
¬¬ (
.
¬¬( )
dequeue
¬¬) 0
(
¬¬0 1
)
¬¬1 2
)
¬¬2 3
!=
¬¬4 6
null
¬¬7 ;
)
¬¬; <
{
­­ 
if
®® 
(
®® 
args
®® 
.
®® 
fSerialEventId
®® +
==
®®, .
FSerialEventId
®®/ =
.
®®= > 
SerialStateChanged
®®> P
)
®®P Q
{
¯¯ 
(
°° 
(
°° 
FSerial
°° !
)
°°! "
	m_fSerial
°°" +
)
°°+ ,
.
°°, -"
onSerialStateChanged
°°- A
(
°°A B
args
°°B F
)
°°F G
;
°°G H
}
±± 
else
²² 
if
²² 
(
²² 
args
²² !
.
²²! "
fSerialEventId
²²" 0
==
²²1 3
FSerialEventId
²²4 B
.
²²B C 
SerialDataReceived
²²C U
)
²²U V
{
³³ 
(
´´ 
(
´´ 
FSerial
´´ !
)
´´! "
	m_fSerial
´´" +
)
´´+ ,
.
´´, -"
onSerialDataReceived
´´- A
(
´´A B
args
´´B F
)
´´F G
;
´´G H
}
µµ 
else
¶¶ 
if
¶¶ 
(
¶¶ 
args
¶¶ !
.
¶¶! "
fSerialEventId
¶¶" 0
==
¶¶1 3
FSerialEventId
¶¶4 B
.
¶¶B C
SerialDataSent
¶¶C Q
)
¶¶Q R
{
·· 
(
¸¸ 
(
¸¸ 
FSerial
¸¸ !
)
¸¸! "
	m_fSerial
¸¸" +
)
¸¸+ ,
.
¸¸, -
onSerialDataSent
¸¸- =
(
¸¸= >
args
¸¸> B
)
¸¸B C
;
¸¸C D
}
¹¹ 
else
ºº 
if
ºº 
(
ºº 
args
ºº !
.
ºº! "
fSerialEventId
ºº" 0
==
ºº1 3
FSerialEventId
ºº4 B
.
ººB C"
SerialDataSendFailed
ººC W
)
ººW X
{
»» 
(
¼¼ 
(
¼¼ 
FSerial
¼¼ !
)
¼¼! "
	m_fSerial
¼¼" +
)
¼¼+ ,
.
¼¼, -$
onSerialDataSendFailed
¼¼- C
(
¼¼C D
args
¼¼D H
)
¼¼H I
;
¼¼I J
}
½½ 
else
¾¾ 
if
¾¾ 
(
¾¾ 
args
¾¾ !
.
¾¾! "
fSerialEventId
¾¾" 0
==
¾¾1 3
FSerialEventId
¾¾4 B
.
¾¾B C
SerialErrorRaised
¾¾C T
)
¾¾T U
{
¿¿ 
(
ÀÀ 
(
ÀÀ 
FSerial
ÀÀ !
)
ÀÀ! "
	m_fSerial
ÀÀ" +
)
ÀÀ+ ,
.
ÀÀ, -!
onSerialErrorRaised
ÀÀ- @
(
ÀÀ@ A
args
ÀÀA E
)
ÀÀE F
;
ÀÀF G
}
ÁÁ 
}
ÂÂ 
}
ÃÃ 
catch
ÄÄ 
(
ÄÄ 
	Exception
ÄÄ 
ex
ÄÄ 
)
ÄÄ  
{
ÅÅ 
FDebug
ÆÆ 
.
ÆÆ 
writeLog
ÆÆ 
(
ÆÆ  
ex
ÆÆ  "
)
ÆÆ" #
;
ÆÆ# $
}
ÇÇ 
finally
ÈÈ 
{
ÉÉ 
args
ÊÊ 
=
ÊÊ 
null
ÊÊ 
;
ÊÊ 
}
ËË 
}
ÌÌ 	
}
ÒÒ 
}ÓÓ ïg
\D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Serial\c_FSerialFlag.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FSerialFlag 
: 
IDisposable *
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
	FCodeLock 
m_fLock !
=" #
null$ (
;( )
private 
int 
m_sendCount 
=  !
$num" #
;# $
private 
int 
m_receiveCount "
=# $
$num% &
;& '
private 
bool 
m_closed 
= 
false  %
;% &
public%% 
FSerialFlag%% 
(%% 
)&& 
{'' 	
m_fLock(( 
=(( 
new(( 
	FCodeLock(( #
(((# $
)(($ %
;((% &
})) 	
~-- 	
FSerialFlag--	 
(-- 
).. 
{// 	
	myDispose00 
(00 
false00 
)00 
;00 
}11 	
	protected55 
void55 
	myDispose55  
(55  !
bool66 
	disposing66 
)77 
{88 	
if99 
(99 
!99 

m_disposed99 
)99 
{:: 
if;; 
(;; 
	disposing;; 
);; 
{<< 
if== 
(== 
m_fLock== 
!===  "
null==# '
)==' (
{>> 
m_fLock?? 
.??  
Dispose??  '
(??' (
)??( )
;??) *
m_fLock@@ 
=@@  !
null@@" &
;@@& '
}AA 
}BB 

m_disposedDD 
=DD 
trueDD !
;DD! "
}EE 
}FF 	
publicNN 
voidNN 
DisposeNN 
(NN 
)OO 
{PP 	
	myDisposeQQ 
(QQ 
trueQQ 
)QQ 
;QQ 
GCRR 
.RR 
SuppressFinalizeRR 
(RR  
thisRR  $
)RR$ %
;RR% &
}SS 	
public[[ 
bool[[ 
doReceiveCompleted[[ &
{\\ 	
get]] 
{^^ 
try__ 
{`` 
returnaa 
m_receiveCountaa )
==aa* ,
$numaa- .
?aa/ 0
trueaa1 5
:aa6 7
falseaa8 =
;aa= >
}bb 
catchcc 
(cc 
	Exceptioncc  
excc! #
)cc# $
{dd 
FDebugee 
.ee 
throwExceptionee )
(ee) *
exee* ,
)ee, -
;ee- .
}ff 
finallygg 
{hh 
}jj 
returnkk 
falsekk 
;kk 
}ll 
}mm 	
publicqq 
boolqq 
doSendCompletedqq #
{rr 	
getss 
{tt 
tryuu 
{vv 
returnww 
m_sendCountww &
==ww' )
$numww* +
?ww, -
trueww. 2
:ww3 4
falseww5 :
;ww: ;
}xx 
catchyy 
(yy 
	Exceptionyy  
exyy! #
)yy# $
{zz 
FDebug{{ 
.{{ 
throwException{{ )
({{) *
ex{{* ,
){{, -
;{{- .
}|| 
finally}} 
{~~ 
}
€€ 
return
 
false
 
;
 
}
‚‚ 
}
ƒƒ 	
public
‡‡ 
bool
‡‡ 
closed
‡‡ 
{
ˆˆ 	
get
‰‰ 
{
ŠŠ 
try
‹‹ 
{
ŒŒ 
return
 
m_closed
 #
;
# $
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
‘‘ 
.
‘‘ 
throwException
‘‘ )
(
‘‘) *
ex
‘‘* ,
)
‘‘, -
;
‘‘- .
}
’’ 
finally
““ 
{
”” 
}
–– 
return
—— 
false
—— 
;
—— 
}
˜˜ 
set
šš 
{
›› 
try
œœ 
{
 
m_closed
 
=
 
value
 $
;
$ %
}
ŸŸ 
catch
   
(
   
	Exception
    
ex
  ! #
)
  # $
{
¡¡ 
FDebug
¢¢ 
.
¢¢ 
throwException
¢¢ )
(
¢¢) *
ex
¢¢* ,
)
¢¢, -
;
¢¢- .
}
££ 
finally
¤¤ 
{
¥¥ 
}
§§ 
}
¨¨ 
}
©© 	
public
±± 
void
±± 
init
±± 
(
±± 
)
²² 
{
³³ 	
try
´´ 
{
µµ 
m_sendCount
¶¶ 
=
¶¶ 
$num
¶¶ 
;
¶¶  
m_receiveCount
·· 
=
··  
$num
··! "
;
··" #
m_closed
¹¹ 
=
¹¹ 
false
¹¹  
;
¹¹  !
}
ºº 
catch
»» 
(
»» 
	Exception
»» 
ex
»» 
)
»»  
{
¼¼ 
FDebug
½½ 
.
½½ 
throwException
½½ %
(
½½% &
ex
½½& (
)
½½( )
;
½½) *
}
¾¾ 
finally
¿¿ 
{
ÀÀ 
}
ÂÂ 
}
ÃÃ 	
public
ÇÇ 
int
ÇÇ 
	beginOpen
ÇÇ 
(
ÇÇ 
)
ÈÈ 
{
ÉÉ 	
try
ÊÊ 
{
ËË 
}
ÍÍ 
catch
ÎÎ 
(
ÎÎ 
	Exception
ÎÎ 
ex
ÎÎ 
)
ÎÎ  
{
ÏÏ 
FDebug
ĞĞ 
.
ĞĞ 
throwException
ĞĞ %
(
ĞĞ% &
ex
ĞĞ& (
)
ĞĞ( )
;
ĞĞ) *
}
ÑÑ 
finally
ÒÒ 
{
ÓÓ 
}
ÕÕ 
return
ÖÖ 
$num
ÖÖ 
;
ÖÖ 
}
×× 	
public
ÛÛ 
int
ÛÛ 
endOpen
ÛÛ 
(
ÛÛ 
)
ÜÜ 
{
İİ 	
try
ŞŞ 
{
ßß 
}
áá 
catch
ââ 
(
ââ 
	Exception
ââ 
ex
ââ 
)
ââ  
{
ãã 
FDebug
ää 
.
ää 
throwException
ää %
(
ää% &
ex
ää& (
)
ää( )
;
ää) *
}
åå 
finally
ææ 
{
çç 
}
éé 
return
êê 
$num
êê 
;
êê 
}
ëë 	
public
ïï 
int
ïï 
	beginSend
ïï 
(
ïï 
)
ğğ 
{
ññ 	
try
òò 
{
óó 
m_fLock
ôô 
.
ôô 
wait
ôô 
(
ôô 
)
ôô 
;
ôô 
return
õõ 
++
õõ 
m_sendCount
õõ $
;
õõ$ %
}
öö 
catch
÷÷ 
(
÷÷ 
	Exception
÷÷ 
ex
÷÷ 
)
÷÷  
{
øø 
FDebug
ùù 
.
ùù 
throwException
ùù %
(
ùù% &
ex
ùù& (
)
ùù( )
;
ùù) *
}
úú 
finally
ûû 
{
üü 
m_fLock
ıı 
.
ıı 
set
ıı 
(
ıı 
)
ıı 
;
ıı 
}
şş 
return
ÿÿ 
$num
ÿÿ 
;
ÿÿ 
}
€€ 	
public
„„ 
int
„„ 
endSend
„„ 
(
„„ 
)
…… 
{
†† 	
try
‡‡ 
{
ˆˆ 
m_fLock
‰‰ 
.
‰‰ 
wait
‰‰ 
(
‰‰ 
)
‰‰ 
;
‰‰ 
return
ŠŠ 
--
ŠŠ 
m_sendCount
ŠŠ $
;
ŠŠ$ %
}
‹‹ 
catch
ŒŒ 
(
ŒŒ 
	Exception
ŒŒ 
ex
ŒŒ 
)
ŒŒ  
{
 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
 
{
‘‘ 
m_fLock
’’ 
.
’’ 
set
’’ 
(
’’ 
)
’’ 
;
’’ 
}
““ 
return
”” 
$num
”” 
;
”” 
}
•• 	
public
™™ 
int
™™ 
beginReceive
™™ 
(
™™  
)
šš 
{
›› 	
try
œœ 
{
 
m_fLock
 
.
 
wait
 
(
 
)
 
;
 
return
ŸŸ 
++
ŸŸ 
m_receiveCount
ŸŸ '
;
ŸŸ' (
}
   
catch
¡¡ 
(
¡¡ 
	Exception
¡¡ 
ex
¡¡ 
)
¡¡  
{
¢¢ 
FDebug
££ 
.
££ 
throwException
££ %
(
££% &
ex
££& (
)
££( )
;
££) *
}
¤¤ 
finally
¥¥ 
{
¦¦ 
m_fLock
§§ 
.
§§ 
set
§§ 
(
§§ 
)
§§ 
;
§§ 
}
¨¨ 
return
©© 
$num
©© 
;
©© 
}
ªª 	
public
®® 
int
®® 

endReceive
®® 
(
®® 
)
¯¯ 
{
°° 	
try
±± 
{
²² 
m_fLock
³³ 
.
³³ 
wait
³³ 
(
³³ 
)
³³ 
;
³³ 
return
´´ 
--
´´ 
m_receiveCount
´´ '
;
´´' (
}
µµ 
catch
¶¶ 
(
¶¶ 
	Exception
¶¶ 
ex
¶¶ 
)
¶¶  
{
·· 
FDebug
¸¸ 
.
¸¸ 
throwException
¸¸ %
(
¸¸% &
ex
¸¸& (
)
¸¸( )
;
¸¸) *
}
¹¹ 
finally
ºº 
{
»» 
m_fLock
¼¼ 
.
¼¼ 
set
¼¼ 
(
¼¼ 
)
¼¼ 
;
¼¼ 
}
½½ 
return
¾¾ 
$num
¾¾ 
;
¾¾ 
}
¿¿ 	
public
ÃÃ 
void
ÃÃ 
waitSendCompleted
ÃÃ %
(
ÃÃ% &
)
ÄÄ 
{
ÅÅ 	
try
ÆÆ 
{
ÇÇ 
while
ÈÈ 
(
ÈÈ 
!
ÈÈ 
this
ÈÈ 
.
ÈÈ 
doSendCompleted
ÈÈ ,
)
ÈÈ, -
{
ÉÉ 
System
ÊÊ 
.
ÊÊ 
	Threading
ÊÊ $
.
ÊÊ$ %
Thread
ÊÊ% +
.
ÊÊ+ ,
Sleep
ÊÊ, 1
(
ÊÊ1 2
$num
ÊÊ2 3
)
ÊÊ3 4
;
ÊÊ4 5
}
ËË 
}
ÌÌ 
catch
ÍÍ 
(
ÍÍ 
	Exception
ÍÍ 
ex
ÍÍ 
)
ÍÍ  
{
ÎÎ 
FDebug
ÏÏ 
.
ÏÏ 
throwException
ÏÏ %
(
ÏÏ% &
ex
ÏÏ& (
)
ÏÏ( )
;
ÏÏ) *
}
ĞĞ 
finally
ÑÑ 
{
ÒÒ 
}
ÔÔ 
}
ÕÕ 	
public
ÙÙ 
void
ÙÙ "
waitReceiveCompleted
ÙÙ (
(
ÙÙ( )
)
ÚÚ 
{
ÛÛ 	
try
ÜÜ 
{
İİ 
while
ŞŞ 
(
ŞŞ 
!
ŞŞ 
this
ŞŞ 
.
ŞŞ  
doReceiveCompleted
ŞŞ /
)
ŞŞ/ 0
{
ßß 
System
àà 
.
àà 
	Threading
àà $
.
àà$ %
Thread
àà% +
.
àà+ ,
Sleep
àà, 1
(
àà1 2
$num
àà2 3
)
àà3 4
;
àà4 5
}
áá 
}
ââ 
catch
ãã 
(
ãã 
	Exception
ãã 
ex
ãã 
)
ãã  
{
ää 
FDebug
åå 
.
åå 
throwException
åå %
(
åå% &
ex
åå& (
)
åå( )
;
åå) *
}
ææ 
finally
çç 
{
èè 
}
êê 
}
ëë 	
public
ïï 
void
ïï 
waitAllCompleted
ïï $
(
ïï$ %
)
ğğ 
{
ññ 	
try
òò 
{
óó 
while
ôô 
(
ôô 
!
ôô 
this
ôô 
.
ôô 
doSendCompleted
ôô ,
||
ôô- /
!
ôô0 1
this
ôô1 5
.
ôô5 6 
doReceiveCompleted
ôô6 H
)
ôôH I
{
õõ 
System
öö 
.
öö 
	Threading
öö $
.
öö$ %
Thread
öö% +
.
öö+ ,
Sleep
öö, 1
(
öö1 2
$num
öö2 3
)
öö3 4
;
öö4 5
}
÷÷ 
}
øø 
catch
ùù 
(
ùù 
	Exception
ùù 
ex
ùù 
)
ùù  
{
úú 
FDebug
ûû 
.
ûû 
throwException
ûû %
(
ûû% &
ex
ûû& (
)
ûû( )
;
ûû) *
}
üü 
finally
ıı 
{
şş 
}
€€ 
}
 	
}
‡‡ 
}ˆˆ ä
YD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Serial\i_FISerial.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

	interface 
FISerial 
{ 
}%% 
}&& ‰
xD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\ServiceTrace\c_FServiceTraceErrorRaisedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
Serializable 
] 
public 

class -
!FServiceTraceErrorRaisedEventArgs 2
:3 4
	EventArgs5 >
,> ?
IDisposable@ K
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
string 
	m_message  
=! "
string# )
.) *
Empty* /
;/ 0
private 
	Exception 
m_exception %
=& '
null( ,
;, -
internal%% -
!FServiceTraceErrorRaisedEventArgs%% 2
(%%2 3
string&& 
message&& 
,&& 
	Exception'' 
	exception'' 
)(( 
{)) 	
	m_message** 
=** 
message** 
;**  
m_exception++ 
=++ 
	exception++ #
;++# $
},, 	
~00 	-
!FServiceTraceErrorRaisedEventArgs00	 *
(00* +
)11 
{22 	
	myDispose33 
(33 
false33 
)33 
;33 
}44 	
	protected88 
void88 
	myDispose88  
(88  !
bool99 
	disposing99 
):: 
{;; 	
if<< 
(<< 
!<< 

m_disposed<< 
)<< 
{== 
if>> 
(>> 
	disposing>> 
)>> 
{?? 
m_exception@@ 
=@@  !
null@@" &
;@@& '
}AA 

m_disposedBB 
=BB 
trueBB !
;BB! "
}CC 
}DD 	
publicLL 
voidLL 
DisposeLL 
(LL 
)MM 
{NN 	
	myDisposeOO 
(OO 
trueOO 
)OO 
;OO 
GCPP 
.PP 
SuppressFinalizePP 
(PP  
thisPP  $
)PP$ %
;PP% &
}QQ 	
publicYY 
stringYY 
messageYY 
{ZZ 	
get[[ 
{\\ 
try]] 
{^^ 
return__ 
	m_message__ $
;__$ %
}`` 
catchaa 
(aa 
	Exceptionaa  
exaa! #
)aa# $
{bb 
FDebugcc 
.cc 
throwExceptioncc )
(cc) *
excc* ,
)cc, -
;cc- .
}dd 
finallyee 
{ff 
}hh 
returnii 
stringii 
.ii 
Emptyii #
;ii# $
}jj 
}kk 	
publicoo 
	Exceptionoo 
	exceptionoo "
{pp 	
getqq 
{rr 
tryss 
{tt 
returnuu 
m_exceptionuu &
;uu& '
}vv 
catchww 
(ww 
	Exceptionww  
exww! #
)ww# $
{xx 
FDebugyy 
.yy 
throwExceptionyy )
(yy) *
exyy* ,
)yy, -
;yy- .
}zz 
finally{{ 
{|| 
}~~ 
return 
null 
; 
}
€€ 
}
 	
}
 
} Ğ
|D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\ServiceTrace\c_FServiceTraceMessageReceivedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
Serializable 
] 
public 

class 1
%FServiceTraceMessageReceivedEventArgs 6
:7 8
	EventArgs9 B
,B C
IDisposableD O
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
string 
	m_message  
=! "
string# )
.) *
Empty* /
;/ 0
internal"" 1
%FServiceTraceMessageReceivedEventArgs"" 6
(""6 7
string## 
message## 
)$$ 
{%% 	
	m_message&& 
=&& 
message&& 
;&&  
}'' 	
~++ 	1
%FServiceTraceMessageReceivedEventArgs++	 .
(++. /
),, 
{-- 	
	myDispose.. 
(.. 
false.. 
).. 
;.. 
}// 	
	protected33 
void33 
	myDispose33  
(33  !
bool44 
	disposing44 
)55 
{66 	
if77 
(77 
!77 

m_disposed77 
)77 
{88 
if99 
(99 
	disposing99 
)99 
{:: 
}<< 

m_disposed== 
=== 
true== !
;==! "
}>> 
}?? 	
publicGG 
voidGG 
DisposeGG 
(GG 
)HH 
{II 	
	myDisposeJJ 
(JJ 
trueJJ 
)JJ 
;JJ 
GCKK 
.KK 
SuppressFinalizeKK 
(KK  
thisKK  $
)KK$ %
;KK% &
}LL 	
publicTT 
stringTT 
messageTT 
{UU 	
getVV 
{WW 
tryXX 
{YY 
returnZZ 
	m_messageZZ $
;ZZ$ %
}[[ 
catch\\ 
(\\ 
	Exception\\  
ex\\! #
)\\# $
{]] 
FDebug^^ 
.^^ 
throwException^^ )
(^^) *
ex^^* ,
)^^, -
;^^- .
}__ 
finally`` 
{aa 
}cc 
returndd 
nulldd 
;dd 
}ee 
}ff 	
}rr 
}ss å
jD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\ServiceTrace\c_FServiceTraceServer.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FServiceTraceServer $
:% &
IDisposable' 2
{ 
public 
event 0
$FServiceTraceErrorRaisedEventHandler 9#
ServiceTraceErrorRaised: Q
=R S
nullT X
;X Y
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
string 
m_serviceName $
=% &
string' -
.- .
Empty. 3
;3 4
private 
bool 
m_dateTimeUsed #
=$ %
false& +
;+ ,
private   
bool   
m_endStringUsed   $
=  % &
false  ' ,
;  , -
private!! 
int!! 
m_messageSendPeriod!! '
=!!( )
$num!!* .
;!!. /
private"" 
string"" 
m_endString"" "
=""# $
$str""% (
;""( )
private$$ $
FServiceTraceMessageList$$ (
m_fMessageList$$) 7
=$$8 9
null$$: >
;$$> ?
private%% 
FStaticTimer%% 
m_fSendTimer%% )
=%%* +
null%%, 0
;%%0 1
private&& 
FPipeServer&& 
m_fPipeServer&& )
=&&* +
null&&, 0
;&&0 1
private'' 
FThread'' 

m_fThdMain'' "
=''# $
null''% )
;'') *
public-- 
FServiceTraceServer-- "
(--" #
string.. 
serviceName.. 
)// 
:00 
this00 
(00 
serviceName00 
,00 
false00  %
,00% &
false00' ,
)00, -
{11 	
}33 	
public77 
FServiceTraceServer77 "
(77" #
string88 
serviceName88 
,88 
bool99 
dataTimeUsed99 
,99 
bool:: 
endStringUsed:: 
);; 
{<< 	
m_serviceName== 
=== 
serviceName== '
;==' (
m_dateTimeUsed>> 
=>> 
dataTimeUsed>> )
;>>) *
m_endStringUsed?? 
=?? 
endStringUsed?? +
;??+ ,
initAA 
(AA 
)AA 
;AA 
}BB 	
~FF 	
FServiceTraceServerFF	 
(FF 
)GG 
{HH 	
	myDisposeII 
(II 
falseII 
)II 
;II 
}JJ 	
	protectedNN 
voidNN 
	myDisposeNN  
(NN  !
boolOO 
	disposingOO 
)PP 
{QQ 	
ifRR 
(RR 
!RR 

m_disposedRR 
)RR 
{SS 
ifTT 
(TT 
	disposingTT 
)TT 
{UU 
termVV 
(VV 
)VV 
;VV 
}WW 

m_disposedYY 
=YY 
trueYY !
;YY! "
}ZZ 
}[[ 	
publiccc 
voidcc 
Disposecc 
(cc 
)dd 
{ee 	
	myDisposeff 
(ff 
trueff 
)ff 
;ff 
GCgg 
.gg 
SuppressFinalizegg 
(gg  
thisgg  $
)gg$ %
;gg% &
}hh 	
publicpp 
stringpp 
serviceNamepp !
{qq 	
getrr 
{ss 
trytt 
{uu 
returnvv 
m_serviceNamevv (
;vv( )
}ww 
catchxx 
(xx 
	Exceptionxx  
exxx! #
)xx# $
{yy 
FDebugzz 
.zz 
throwExceptionzz )
(zz) *
exzz* ,
)zz, -
;zz- .
}{{ 
finally|| 
{}} 
} 
return
€€ 
string
€€ 
.
€€ 
Empty
€€ #
;
€€# $
}
 
}
‚‚ 	
public
†† 
bool
†† 
dateTimeUsed
††  
{
‡‡ 	
get
ˆˆ 
{
‰‰ 
try
ŠŠ 
{
‹‹ 
return
ŒŒ 
m_dateTimeUsed
ŒŒ )
;
ŒŒ) *
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
‘‘ 
finally
’’ 
{
““ 
}
•• 
return
–– 
false
–– 
;
–– 
}
—— 
}
˜˜ 	
public
œœ 
bool
œœ 
endStringUsed
œœ !
{
 	
get
 
{
ŸŸ 
try
   
{
¡¡ 
return
¢¢ 
m_endStringUsed
¢¢ *
;
¢¢* +
}
££ 
catch
¤¤ 
(
¤¤ 
	Exception
¤¤  
ex
¤¤! #
)
¤¤# $
{
¥¥ 
FDebug
¦¦ 
.
¦¦ 
throwException
¦¦ )
(
¦¦) *
ex
¦¦* ,
)
¦¦, -
;
¦¦- .
}
§§ 
finally
¨¨ 
{
©© 
}
«« 
return
¬¬ 
false
¬¬ 
;
¬¬ 
}
­­ 
}
®® 	
public
²² 
string
²² 
	endString
²² 
{
³³ 	
get
´´ 
{
µµ 
try
¶¶ 
{
·· 
return
¸¸ 
m_endString
¸¸ &
;
¸¸& '
}
¹¹ 
catch
ºº 
(
ºº 
	Exception
ºº  
ex
ºº! #
)
ºº# $
{
»» 
FDebug
¼¼ 
.
¼¼ 
throwException
¼¼ )
(
¼¼) *
ex
¼¼* ,
)
¼¼, -
;
¼¼- .
}
½½ 
finally
¾¾ 
{
¿¿ 
}
ÁÁ 
return
ÂÂ 
string
ÂÂ 
.
ÂÂ 
Empty
ÂÂ #
;
ÂÂ# $
}
ÃÃ 
set
ÅÅ 
{
ÆÆ 
try
ÇÇ 
{
ÈÈ 
	endString
ÉÉ 
=
ÉÉ 
value
ÉÉ  %
;
ÉÉ% &
}
ÊÊ 
catch
ËË 
(
ËË 
	Exception
ËË  
ex
ËË! #
)
ËË# $
{
ÌÌ 
FDebug
ÍÍ 
.
ÍÍ 
throwException
ÍÍ )
(
ÍÍ) *
ex
ÍÍ* ,
)
ÍÍ, -
;
ÍÍ- .
}
ÎÎ 
finally
ÏÏ 
{
ĞĞ 
}
ÒÒ 
}
ÓÓ 
}
ÔÔ 	
public
ØØ 
int
ØØ 
maxMessageCount
ØØ "
{
ÙÙ 	
get
ÚÚ 
{
ÛÛ 
try
ÜÜ 
{
İİ 
return
ŞŞ 
m_fMessageList
ŞŞ )
.
ŞŞ) *
maxMessageCount
ŞŞ* 9
;
ŞŞ9 :
}
ßß 
catch
àà 
(
àà 
	Exception
àà  
ex
àà! #
)
àà# $
{
áá 
FDebug
ââ 
.
ââ 
throwException
ââ )
(
ââ) *
ex
ââ* ,
)
ââ, -
;
ââ- .
}
ãã 
finally
ää 
{
åå 
}
çç 
return
èè 
$num
èè 
;
èè 
}
éé 
set
ëë 
{
ìì 
try
íí 
{
îî 
m_fMessageList
ïï "
.
ïï" #
maxMessageCount
ïï# 2
=
ïï3 4
value
ïï5 :
;
ïï: ;
}
ğğ 
catch
ññ 
(
ññ 
	Exception
ññ  
ex
ññ! #
)
ññ# $
{
òò 
FDebug
óó 
.
óó 
throwException
óó )
(
óó) *
ex
óó* ,
)
óó, -
;
óó- .
}
ôô 
finally
õõ 
{
öö 
}
øø 
}
ùù 
}
úú 	
public
şş 
int
şş 
messageSendPeriod
şş $
{
ÿÿ 	
get
€€ 
{
 
try
‚‚ 
{
ƒƒ 
return
‡‡ !
m_messageSendPeriod
‡‡ .
;
‡‡. /
}
ˆˆ 
catch
‰‰ 
(
‰‰ 
	Exception
‰‰  
ex
‰‰! #
)
‰‰# $
{
ŠŠ 
FDebug
‹‹ 
.
‹‹ 
throwException
‹‹ )
(
‹‹) *
ex
‹‹* ,
)
‹‹, -
;
‹‹- .
}
ŒŒ 
finally
 
{
 
}
 
return
‘‘ 
$num
‘‘ 
;
‘‘ 
}
’’ 
set
”” 
{
•• 
try
–– 
{
—— 
if
˜˜ 
(
˜˜ 
value
˜˜ 
<
˜˜ 
$num
˜˜  !
)
˜˜! "
{
™™ 
FDebug
šš 
.
šš 
throwFException
šš .
(
šš. /
string
šš/ 5
.
šš5 6
Format
šš6 <
(
šš< =

FConstants
šš= G
.
ššG H

err_m_0005
ššH R
,
ššR S
$str
ššT i
)
šši j
)
ššj k
;
ššk l
}
›› !
m_messageSendPeriod
¢¢ '
=
¢¢( )
value
¢¢* /
;
¢¢/ 0
m_fSendTimer
££  
.
££  !
restart
££! (
(
££( )!
m_messageSendPeriod
££) <
)
££< =
;
££= >
}
¤¤ 
catch
¥¥ 
(
¥¥ 
	Exception
¥¥  
ex
¥¥! #
)
¥¥# $
{
¦¦ 
FDebug
§§ 
.
§§ 
throwException
§§ )
(
§§) *
ex
§§* ,
)
§§, -
;
§§- .
}
¨¨ 
finally
©© 
{
ªª 
}
¬¬ 
}
­­ 
}
®® 	
private
¶¶ 
void
¶¶ 
init
¶¶ 
(
¶¶ 
)
·· 
{
¸¸ 	
try
¹¹ 
{
ºº 
m_fMessageList
»» 
=
»»  
new
»»! $&
FServiceTraceMessageList
»»% =
(
»»= >
)
»»> ?
;
»»? @
m_fSendTimer
¿¿ 
=
¿¿ 
new
¿¿ "
FStaticTimer
¿¿# /
(
¿¿/ 0
)
¿¿0 1
;
¿¿1 2
m_fSendTimer
ÀÀ 
.
ÀÀ 
start
ÀÀ "
(
ÀÀ" #!
m_messageSendPeriod
ÀÀ# 6
)
ÀÀ6 7
;
ÀÀ7 8
m_fPipeServer
ÄÄ 
=
ÄÄ 
new
ÄÄ  #
FPipeServer
ÄÄ$ /
(
ÄÄ/ 0
m_serviceName
ÄÄ0 =
)
ÄÄ= >
;
ÄÄ> ?
m_fPipeServer
ÅÅ 
.
ÅÅ  
PipeDataSendFailed
ÅÅ 0
+=
ÅÅ1 3
new
ÅÅ4 7-
FPipeDataSendFailedEventHandler
ÅÅ8 W
(
ÅÅW X.
 m_fPipeServer_PipeDataSendFailed
ÅÅX x
)
ÅÅx y
;
ÅÅy z
m_fPipeServer
ÆÆ 
.
ÆÆ 
PipeErrorRaised
ÆÆ -
+=
ÆÆ. 0
new
ÆÆ1 4*
FPipeErrorRaisedEventHandler
ÆÆ5 Q
(
ÆÆQ R+
m_fPipeServer_PipeErrorRaised
ÆÆR o
)
ÆÆo p
;
ÆÆp q
m_fPipeServer
ÇÇ 
.
ÇÇ 
start
ÇÇ #
(
ÇÇ# $
)
ÇÇ$ %
;
ÇÇ% &

m_fThdMain
ËË 
=
ËË 
new
ËË  
FThread
ËË! (
(
ËË( )
$str
ËË) H
)
ËËH I
;
ËËI J

m_fThdMain
ÌÌ 
.
ÌÌ 
ThreadJobCalled
ÌÌ *
+=
ÌÌ+ -
new
ÌÌ. 1*
FThreadJobCalledEventHandler
ÌÌ2 N
(
ÌÌN O(
m_fThdMain_ThreadJobCalled
ÌÌO i
)
ÌÌi j
;
ÌÌj k

m_fThdMain
ÍÍ 
.
ÍÍ 
start
ÍÍ  
(
ÍÍ  !
)
ÍÍ! "
;
ÍÍ" #
}
ÎÎ 
catch
ÏÏ 
(
ÏÏ 
	Exception
ÏÏ 
ex
ÏÏ 
)
ÏÏ  
{
ĞĞ 
FDebug
ÑÑ 
.
ÑÑ 
throwException
ÑÑ %
(
ÑÑ% &
ex
ÑÑ& (
)
ÑÑ( )
;
ÑÑ) *
}
ÒÒ 
finally
ÓÓ 
{
ÔÔ 
}
ÖÖ 
}
×× 	
private
ÛÛ 
void
ÛÛ 
term
ÛÛ 
(
ÛÛ 
)
ÜÜ 
{
İİ 	
try
ŞŞ 
{
ßß 
if
àà 
(
àà 

m_fThdMain
àà 
!=
àà !
null
àà" &
)
àà& '
{
áá 

m_fThdMain
ââ 
.
ââ 
stop
ââ #
(
ââ# $
)
ââ$ %
;
ââ% &

m_fThdMain
ãã 
.
ãã 
Dispose
ãã &
(
ãã& '
)
ãã' (
;
ãã( )

m_fThdMain
ää 
.
ää 
ThreadJobCalled
ää .
-=
ää/ 1
new
ää2 5*
FThreadJobCalledEventHandler
ää6 R
(
ääR S(
m_fThdMain_ThreadJobCalled
ääS m
)
ääm n
;
ään o

m_fThdMain
åå 
=
åå  
null
åå! %
;
åå% &
}
ææ 
if
êê 
(
êê 
m_fPipeServer
êê !
!=
êê" $
null
êê% )
)
êê) *
{
ëë 
m_fPipeServer
ìì !
.
ìì! "
stop
ìì" &
(
ìì& '
)
ìì' (
;
ìì( )
m_fPipeServer
íí !
.
íí! "
Dispose
íí" )
(
íí) *
)
íí* +
;
íí+ ,
m_fPipeServer
îî !
.
îî! " 
PipeDataSendFailed
îî" 4
-=
îî5 7
new
îî8 ;-
FPipeDataSendFailedEventHandler
îî< [
(
îî[ \.
 m_fPipeServer_PipeDataSendFailed
îî\ |
)
îî| }
;
îî} ~
m_fPipeServer
ïï !
.
ïï! "
PipeErrorRaised
ïï" 1
-=
ïï2 4
new
ïï5 8*
FPipeErrorRaisedEventHandler
ïï9 U
(
ïïU V+
m_fPipeServer_PipeErrorRaised
ïïV s
)
ïïs t
;
ïït u
m_fPipeServer
ğğ !
=
ğğ" #
null
ğğ$ (
;
ğğ( )
}
ññ 
if
õõ 
(
õõ 
m_fSendTimer
õõ  
!=
õõ! #
null
õõ$ (
)
õõ( )
{
öö 
m_fSendTimer
÷÷  
.
÷÷  !
Dispose
÷÷! (
(
÷÷( )
)
÷÷) *
;
÷÷* +
m_fSendTimer
øø  
=
øø! "
null
øø# '
;
øø' (
}
ùù 
if
ıı 
(
ıı 
m_fMessageList
ıı "
!=
ıı# %
null
ıı& *
)
ıı* +
{
şş 
m_fMessageList
ÿÿ "
.
ÿÿ" #
Dispose
ÿÿ# *
(
ÿÿ* +
)
ÿÿ+ ,
;
ÿÿ, -
m_fMessageList
€€ "
=
€€# $
null
€€% )
;
€€) *
}
 
}
‚‚ 
catch
ƒƒ 
(
ƒƒ 
	Exception
ƒƒ 
ex
ƒƒ 
)
ƒƒ  
{
„„ 
FDebug
…… 
.
…… 
throwException
…… %
(
……% &
ex
……& (
)
……( )
;
……) *
}
†† 
finally
‡‡ 
{
ˆˆ 
}
ŠŠ 
}
‹‹ 	
private
 
void
 '
onServiceTraceErrorRaised
 .
(
. /
	Exception
 
ex
 
)
‘‘ 
{
’’ 	
try
““ 
{
”” 
FDebug
•• 
.
•• 
writeLog
•• 
(
••  
ex
••  "
)
••" #
;
••# $
if
—— 
(
—— %
ServiceTraceErrorRaised
—— +
!=
——, .
null
——/ 3
)
——3 4
{
˜˜ %
ServiceTraceErrorRaised
™™ +
(
™™+ ,
this
™™, 0
,
™™0 1
new
™™2 5/
!FServiceTraceErrorRaisedEventArgs
™™6 W
(
™™W X
ex
™™X Z
.
™™Z [
Message
™™[ b
,
™™b c
ex
™™d f
)
™™f g
)
™™g h
;
™™h i
}
šš 
}
›› 
catch
œœ 
(
œœ 
	Exception
œœ 
ex1
œœ  
)
œœ  !
{
 
FDebug
 
.
 
writeLog
 
(
  
ex1
  #
)
# $
;
$ %
}
ŸŸ 
finally
   
{
¡¡ 
}
££ 
}
¤¤ 	
public
¨¨ 
void
¨¨ 
sendMessage
¨¨ 
(
¨¨  
string
©© 
message
©© 
)
ªª 
{
«« 	
StringBuilder
¬¬ 
sb
¬¬ 
=
¬¬ 
null
¬¬ #
;
¬¬# $
string
­­ 
dateTime
­­ 
=
­­ 
string
­­ $
.
­­$ %
Empty
­­% *
;
­­* +
try
¯¯ 
{
°° 
sb
±± 
=
±± 
new
±± 
StringBuilder
±± &
(
±±& '
)
±±' (
;
±±( )
if
µµ 
(
µµ 
m_dateTimeUsed
µµ "
)
µµ" #
{
¶¶ 
dateTime
·· 
=
·· 
$str
·· "
+
··# $
FDataConvert
··% 1
.
··1 2(
defaultNowDateTimeToString
··2 L
(
··L M
)
··M N
+
··O P
$str
··Q U
;
··U V
foreach
¸¸ 
(
¸¸ 
string
¸¸ #
s
¸¸$ %
in
¸¸& (
message
¸¸) 0
.
¸¸0 1
Split
¸¸1 6
(
¸¸6 7
Environment
¸¸7 B
.
¸¸B C
NewLine
¸¸C J
.
¸¸J K
ToArray
¸¸K R
(
¸¸R S
)
¸¸S T
,
¸¸T U 
StringSplitOptions
¸¸V h
.
¸¸h i 
RemoveEmptyEntries
¸¸i {
)
¸¸{ |
)
¸¸| }
{
¹¹ 
sb
ºº 
.
ºº 

AppendLine
ºº %
(
ºº% &
dateTime
ºº& .
+
ºº/ 0
s
ºº1 2
)
ºº2 3
;
ºº3 4
}
»» 
}
¼¼ 
else
½½ 
{
¾¾ 
sb
¿¿ 
.
¿¿ 

AppendLine
¿¿ !
(
¿¿! "
message
¿¿" )
)
¿¿) *
;
¿¿* +
}
ÀÀ 
if
ÂÂ 
(
ÂÂ 
m_endStringUsed
ÂÂ #
)
ÂÂ# $
{
ÃÃ 
sb
ÄÄ 
.
ÄÄ 

AppendLine
ÄÄ !
(
ÄÄ! "
m_endString
ÄÄ" -
)
ÄÄ- .
;
ÄÄ. /
}
ÅÅ 
m_fMessageList
ÉÉ 
.
ÉÉ 
add
ÉÉ "
(
ÉÉ" #
new
ÉÉ# &"
FServiceTraceMessage
ÉÉ' ;
(
ÉÉ; <
Encoding
ÉÉ< D
.
ÉÉD E
Default
ÉÉE L
.
ÉÉL M
GetBytes
ÉÉM U
(
ÉÉU V
sb
ÉÉV X
.
ÉÉX Y
ToString
ÉÉY a
(
ÉÉa b
)
ÉÉb c
)
ÉÉc d
)
ÉÉd e
)
ÉÉe f
;
ÉÉf g
}
ÊÊ 
catch
ËË 
(
ËË 
	Exception
ËË 
ex
ËË 
)
ËË  
{
ÌÌ 
FDebug
ÍÍ 
.
ÍÍ 
throwException
ÍÍ %
(
ÍÍ% &
ex
ÍÍ& (
)
ÍÍ( )
;
ÍÍ) *
}
ÎÎ 
finally
ÏÏ 
{
ĞĞ 
}
ÒÒ 
}
ÓÓ 	
public
×× 
void
×× 
sendMessage
×× 
(
××  #
FServiceTraceCategory
ØØ !
	fCategory
ØØ" +
,
ØØ+ ,
string
ÙÙ 
action
ÙÙ 
,
ÙÙ 
string
ÚÚ 
typeNamespace
ÚÚ  
,
ÚÚ  !
string
ÛÛ 
typeName
ÛÛ 
,
ÛÛ 
string
ÜÜ 
functionName
ÜÜ 
,
ÜÜ  
string
İİ 
message
İİ 
)
ŞŞ 
{
ßß 	
StringBuilder
àà 
sb
àà 
=
àà 
null
àà #
;
àà# $
try
ââ 
{
ãã 
sb
ää 
=
ää 
new
ää 
StringBuilder
ää &
(
ää& '
)
ää' (
;
ää( )
if
ææ 
(
ææ 
	fCategory
ææ 
==
ææ  #
FServiceTraceCategory
ææ! 6
.
ææ6 7
Information
ææ7 B
)
ææB C
{
çç 
sb
èè 
.
èè 
Append
èè 
(
èè 
$str
èè .
)
èè. /
;
èè/ 0
}
éé 
else
êê 
if
êê 
(
êê 
	fCategory
êê "
==
êê# %#
FServiceTraceCategory
êê& ;
.
êê; <
Warning
êê< C
)
êêC D
{
ëë 
sb
ìì 
.
ìì 
Append
ìì 
(
ìì 
$str
ìì .
)
ìì. /
;
ìì/ 0
}
íí 
else
îî 
{
ïï 
sb
ğğ 
.
ğğ 
Append
ğğ 
(
ğğ 
$str
ğğ .
)
ğğ. /
;
ğğ/ 0
}
ññ 
sb
õõ 
.
õõ 
Append
õõ 
(
õõ 
$str
õõ $
+
õõ% &
action
õõ' -
+
õõ. /
$str
õõ0 5
)
õõ5 6
;
õõ6 7
sb
öö 
.
öö 
Append
öö 
(
öö 
$str
öö '
+
öö( )
typeNamespace
öö* 7
+
öö8 9
$str
öö: ?
)
öö? @
;
öö@ A
sb
÷÷ 
.
÷÷ 
Append
÷÷ 
(
÷÷ 
$str
÷÷ &
+
÷÷' (
typeName
÷÷) 1
+
÷÷2 3
$str
÷÷4 9
)
÷÷9 :
;
÷÷: ;
sb
øø 
.
øø 
Append
øø 
(
øø 
$str
øø &
+
øø' (
functionName
øø) 5
+
øø6 7
$str
øø8 ;
)
øø; <
;
øø< =
if
üü 
(
üü 
message
üü 
!=
üü 
string
üü %
.
üü% &
Empty
üü& +
)
üü+ ,
{
ıı 
sb
şş 
.
şş 
Append
şş 
(
şş 
Environment
şş )
.
şş) *
NewLine
şş* 1
)
şş1 2
;
şş2 3
sb
ÿÿ 
.
ÿÿ 
Append
ÿÿ 
(
ÿÿ 
$str
ÿÿ :
)
ÿÿ: ;
;
ÿÿ; <
sb
 
.
 
Append
 
(
 
Environment
 )
.
) *
NewLine
* 1
)
1 2
;
2 3
sb
‚‚ 
.
‚‚ 
Append
‚‚ 
(
‚‚ 
message
‚‚ %
)
‚‚% &
;
‚‚& '
}
ƒƒ 
sendMessage
‡‡ 
(
‡‡ 
sb
‡‡ 
.
‡‡ 
ToString
‡‡ '
(
‡‡' (
)
‡‡( )
)
‡‡) *
;
‡‡* +
}
ˆˆ 
catch
‰‰ 
(
‰‰ 
	Exception
‰‰ 
ex
‰‰ 
)
‰‰  
{
ŠŠ 
FDebug
‹‹ 
.
‹‹ 
throwException
‹‹ %
(
‹‹% &
ex
‹‹& (
)
‹‹( )
;
‹‹) *
}
ŒŒ 
finally
 
{
 
}
 
}
‘‘ 	
public
•• 
void
•• 
sendMessage
•• 
(
••  #
FServiceTraceCategory
–– !
	fCategory
––" +
,
––+ ,
string
—— 
action
—— 
,
—— 
Type
˜˜ 
type
˜˜ 
,
˜˜ 
string
™™ 
functionName
™™ 
,
™™  
string
šš 
message
šš 
)
›› 
{
œœ 	
try
 
{
 
sendMessage
ŸŸ 
(
ŸŸ 
	fCategory
ŸŸ %
,
ŸŸ% &
action
ŸŸ' -
,
ŸŸ- .
type
ŸŸ/ 3
.
ŸŸ3 4
	Namespace
ŸŸ4 =
,
ŸŸ= >
type
ŸŸ? C
.
ŸŸC D
Name
ŸŸD H
,
ŸŸH I
functionName
ŸŸJ V
,
ŸŸV W
message
ŸŸX _
)
ŸŸ_ `
;
ŸŸ` a
}
   
catch
¡¡ 
(
¡¡ 
	Exception
¡¡ 
ex
¡¡ 
)
¡¡  
{
¢¢ 
FDebug
££ 
.
££ 
throwException
££ %
(
££% &
ex
££& (
)
££( )
;
££) *
}
¤¤ 
finally
¥¥ 
{
¦¦ 
}
¨¨ 
}
©© 	
private
­­ 
void
­­ 
transferMessage
­­ $
(
­­$ %
)
®® 
{
¯¯ 	"
FServiceTraceMessage
°°  
[
°°  !
]
°°! "
	fMessages
°°# ,
=
°°- .
null
°°/ 3
;
°°3 4
	ArrayList
±± 
data
±± 
=
±± 
null
±± !
;
±±! "
try
´´ 
{
µµ 
	fMessages
¶¶ 
=
¶¶ 
m_fMessageList
¶¶ *
.
¶¶* +
getMessageAll
¶¶+ 8
(
¶¶8 9
true
¶¶9 =
)
¶¶= >
;
¶¶> ?
if
·· 
(
·· 
	fMessages
·· 
==
··  
null
··! %
)
··% &
{
¸¸ 
return
¹¹ 
;
¹¹ 
}
ºº 
data
¾¾ 
=
¾¾ 
new
¾¾ 
	ArrayList
¾¾ $
(
¾¾$ %
)
¾¾% &
;
¾¾& '
foreach
¿¿ 
(
¿¿ "
FServiceTraceMessage
¿¿ -
fMsg
¿¿. 2
in
¿¿3 5
	fMessages
¿¿6 ?
)
¿¿? @
{
ÀÀ 
data
ÁÁ 
.
ÁÁ 
AddRange
ÁÁ !
(
ÁÁ! "
fMsg
ÁÁ" &
.
ÁÁ& '
message
ÁÁ' .
)
ÁÁ. /
;
ÁÁ/ 0
}
ÂÂ 
m_fPipeServer
ÆÆ 
.
ÆÆ 
send
ÆÆ "
(
ÆÆ" #
new
ÇÇ 
FPipeSendData
ÇÇ %
(
ÇÇ% &
(
ÇÇ& '
byte
ÇÇ' +
[
ÇÇ+ ,
]
ÇÇ, -
)
ÇÇ- .
data
ÇÇ. 2
.
ÇÇ2 3
ToArray
ÇÇ3 :
(
ÇÇ: ;
typeof
ÇÇ; A
(
ÇÇA B
byte
ÇÇB F
)
ÇÇF G
)
ÇÇG H
)
ÇÇH I
)
ÈÈ 
;
ÈÈ 
}
ÉÉ 
catch
ÊÊ 
(
ÊÊ 
	Exception
ÊÊ 
ex
ÊÊ 
)
ÊÊ  
{
ËË 
FDebug
ÌÌ 
.
ÌÌ 
throwException
ÌÌ %
(
ÌÌ% &
ex
ÌÌ& (
)
ÌÌ( )
;
ÌÌ) *
}
ÍÍ 
finally
ÎÎ 
{
ÏÏ 
}
ÑÑ 
}
ÒÒ 	
private
ØØ 
void
ØØ .
 m_fPipeServer_PipeDataSendFailed
ØØ 5
(
ØØ5 6
object
ÙÙ 
sender
ÙÙ 
,
ÙÙ *
FPipeDataSendFailedEventArgs
ÚÚ (
e
ÚÚ) *
)
ÛÛ 
{
ÜÜ 	
try
İİ 
{
ŞŞ '
onServiceTraceErrorRaised
ßß )
(
ßß) *
new
ßß* -

FException
ßß. 8
(
ßß8 9
e
ßß9 :
.
ßß: ;
message
ßß; B
)
ßßB C
)
ßßC D
;
ßßD E
}
àà 
catch
áá 
(
áá 
	Exception
áá 
ex
áá 
)
áá  
{
ââ 
FDebug
ãã 
.
ãã 
writeLog
ãã 
(
ãã  
ex
ãã  "
)
ãã" #
;
ãã# $
}
ää 
finally
åå 
{
ææ 
}
èè 
}
éé 	
private
íí 
void
íí +
m_fPipeServer_PipeErrorRaised
íí 2
(
íí2 3
object
îî 
sender
îî 
,
îî '
FPipeErrorRaisedEventArgs
ïï %
e
ïï& '
)
ğğ 
{
ññ 	
try
òò 
{
óó '
onServiceTraceErrorRaised
ôô )
(
ôô) *
e
ôô* +
.
ôô+ ,
	exception
ôô, 5
)
ôô5 6
;
ôô6 7
}
õõ 
catch
öö 
(
öö 
	Exception
öö 
ex
öö 
)
öö  
{
÷÷ 
FDebug
øø 
.
øø 
writeLog
øø 
(
øø  
ex
øø  "
)
øø" #
;
øø# $
}
ùù 
finally
úú 
{
ûû 
}
ıı 
}
şş 	
private
„„ 
void
„„ (
m_fThdMain_ThreadJobCalled
„„ /
(
„„/ 0
object
…… 
sender
…… 
,
…… 
FThreadEventArgs
†† 
e
†† 
)
‡‡ 
{
ˆˆ 	
try
‰‰ 
{
ŠŠ 
if
‹‹ 
(
‹‹ 
m_fPipeServer
‹‹ !
.
‹‹! "
fState
‹‹" (
==
‹‹) +

FPipeState
‹‹, 6
.
‹‹6 7
	Connected
‹‹7 @
&&
‹‹A C
m_fSendTimer
‹‹D P
.
‹‹P Q
elasped
‹‹Q X
(
‹‹X Y
true
‹‹Y ]
)
‹‹] ^
)
‹‹^ _
{
ŒŒ 
transferMessage
 #
(
# $
)
$ %
;
% &
return
 
;
 
}
 
e
‘‘ 
.
‘‘ 
sleepThread
‘‘ 
(
‘‘ 
$num
‘‘ 
)
‘‘  
;
‘‘  !
}
’’ 
catch
““ 
(
““ 
	Exception
““ 
ex
““ 
)
““  
{
”” '
onServiceTraceErrorRaised
•• )
(
••) *
ex
••* ,
)
••, -
;
••- .
}
–– 
finally
—— 
{
˜˜ 
}
šš 
}
›› 	
}
¡¡ 
}¢¢ ÌF
jD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\ServiceTrace\c_FServiceTraceClient.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FServiceTraceClient $
:% &
IDisposable' 2
{ 
public 
event 4
(FServiceTraceMessageReceivedEventHandler ='
ServiceTraceMessageReceived> Y
=Z [
null\ `
;` a
public 
event 0
$FServiceTraceErrorRaisedEventHandler 9#
ServiceTraceErrorRaised: Q
=R S
nullT X
;X Y
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
string 
m_serviceName $
=% &
string' -
.- .
Empty. 3
;3 4
private 
FPipeClient 
m_fPipeClient )
=* +
null, 0
;0 1
public%% 
FServiceTraceClient%% "
(%%" #
string&& 
serviceName&& 
)'' 
{(( 	
m_serviceName)) 
=)) 
serviceName)) '
;))' (
init** 
(** 
)** 
;** 
}++ 	
~// 	
FServiceTraceClient//	 
(// 
)00 
{11 	
	myDispose22 
(22 
false22 
)22 
;22 
}33 	
	protected77 
void77 
	myDispose77  
(77  !
bool88 
	disposing88 
)99 
{:: 	
if;; 
(;; 
!;; 

m_disposed;; 
);; 
{<< 
if== 
(== 
	disposing== 
)== 
{>> 
term?? 
(?? 
)?? 
;?? 
}@@ 

m_disposedBB 
=BB 
trueBB !
;BB! "
}CC 
}DD 	
publicLL 
voidLL 
DisposeLL 
(LL 
)MM 
{NN 	
	myDisposeOO 
(OO 
trueOO 
)OO 
;OO 
GCPP 
.PP 
SuppressFinalizePP 
(PP  
thisPP  $
)PP$ %
;PP% &
}QQ 	
publicYY 
stringYY 
serviceNameYY !
{ZZ 	
get[[ 
{\\ 
try]] 
{^^ 
return__ 
m_serviceName__ (
;__( )
}`` 
catchaa 
(aa 
	Exceptionaa  
exaa! #
)aa# $
{bb 
FDebugcc 
.cc 
throwExceptioncc )
(cc) *
excc* ,
)cc, -
;cc- .
}dd 
finallyee 
{ff 
}hh 
returnii 
stringii 
.ii 
Emptyii #
;ii# $
}jj 
}kk 	
privatess 
voidss 
initss 
(ss 
)tt 
{uu 	
tryvv 
{ww 
m_fPipeClientxx 
=xx 
newxx  #
FPipeClientxx$ /
(xx/ 0
m_serviceNamexx0 =
)xx= >
;xx> ?
m_fPipeClientyy 
.yy 
PipeDataReceivedyy .
+=yy/ 1
newyy2 5)
FPipeDataReceivedEventHandleryy6 S
(yyS T*
m_fPipeClient_PipeDataReceivedyyT r
)yyr s
;yys t
m_fPipeClientzz 
.zz 
PipeErrorRaisedzz -
+=zz. 0
newzz1 4(
FPipeErrorRaisedEventHandlerzz5 Q
(zzQ R)
m_fPipeClient_PipeErrorRaisedzzR o
)zzo p
;zzp q
m_fPipeClient{{ 
.{{ 
start{{ #
({{# $
){{$ %
;{{% &
}|| 
catch}} 
(}} 
	Exception}} 
ex}} 
)}}  
{~~ 
FDebug 
. 
throwException %
(% &
ex& (
)( )
;) *
}
€€ 
finally
 
{
‚‚ 
}
„„ 
}
…… 	
private
‰‰ 
void
‰‰ 
term
‰‰ 
(
‰‰ 
)
ŠŠ 
{
‹‹ 	
try
ŒŒ 
{
 
if
 
(
 
m_fPipeClient
 !
!=
" $
null
% )
)
) *
{
 
m_fPipeClient
 !
.
! "
stop
" &
(
& '
)
' (
;
( )
m_fPipeClient
‘‘ !
.
‘‘! "
Dispose
‘‘" )
(
‘‘) *
)
‘‘* +
;
‘‘+ ,
m_fPipeClient
’’ !
.
’’! "
PipeDataReceived
’’" 2
-=
’’3 5
new
’’6 9+
FPipeDataReceivedEventHandler
’’: W
(
’’W X,
m_fPipeClient_PipeDataReceived
’’X v
)
’’v w
;
’’w x
m_fPipeClient
““ !
=
““" #
null
““$ (
;
““( )
}
”” 
}
•• 
catch
–– 
(
–– 
	Exception
–– 
ex
–– 
)
––  
{
—— 
FDebug
˜˜ 
.
˜˜ 
throwException
˜˜ %
(
˜˜% &
ex
˜˜& (
)
˜˜( )
;
˜˜) *
}
™™ 
finally
šš 
{
›› 
}
 
}
 	
private
¢¢ 
void
¢¢ '
onServiceTraceErrorRaised
¢¢ .
(
¢¢. /
	Exception
££ 
ex
££ 
)
¤¤ 
{
¥¥ 	
try
¦¦ 
{
§§ 
FDebug
¨¨ 
.
¨¨ 
writeLog
¨¨ 
(
¨¨  
ex
¨¨  "
)
¨¨" #
;
¨¨# $
if
ªª 
(
ªª %
ServiceTraceErrorRaised
ªª +
!=
ªª, .
null
ªª/ 3
)
ªª3 4
{
«« %
ServiceTraceErrorRaised
¬¬ +
(
¬¬+ ,
this
¬¬, 0
,
¬¬0 1
new
¬¬2 5/
!FServiceTraceErrorRaisedEventArgs
¬¬6 W
(
¬¬W X
ex
¬¬X Z
.
¬¬Z [
Message
¬¬[ b
,
¬¬b c
ex
¬¬d f
)
¬¬f g
)
¬¬g h
;
¬¬h i
}
­­ 
}
®® 
catch
¯¯ 
(
¯¯ 
	Exception
¯¯ 
ex1
¯¯  
)
¯¯  !
{
°° 
FDebug
±± 
.
±± 
writeLog
±± 
(
±±  
ex1
±±  #
)
±±# $
;
±±$ %
}
²² 
finally
³³ 
{
´´ 
}
¶¶ 
}
·· 	
private
¿¿ 
void
¿¿ ,
m_fPipeClient_PipeDataReceived
¿¿ 3
(
¿¿3 4
object
ÀÀ 
sender
ÀÀ 
,
ÀÀ (
FPipeDataReceivedEventArgs
ÁÁ &
e
ÁÁ' (
)
ÂÂ 
{
ÃÃ 	
string
ÄÄ 
message
ÄÄ 
=
ÄÄ 
string
ÄÄ #
.
ÄÄ# $
Empty
ÄÄ$ )
;
ÄÄ) *
try
ÆÆ 
{
ÇÇ 
if
ÈÈ 
(
ÈÈ )
ServiceTraceMessageReceived
ÈÈ /
!=
ÈÈ0 2
null
ÈÈ3 7
)
ÈÈ7 8
{
ÉÉ 
message
ÊÊ 
=
ÊÊ 
Encoding
ÊÊ &
.
ÊÊ& '
Default
ÊÊ' .
.
ÊÊ. /
	GetString
ÊÊ/ 8
(
ÊÊ8 9
e
ÊÊ9 :
.
ÊÊ: ;
data
ÊÊ; ?
)
ÊÊ? @
;
ÊÊ@ A)
ServiceTraceMessageReceived
ËË /
(
ËË/ 0
this
ËË0 4
,
ËË4 5
new
ËË6 93
%FServiceTraceMessageReceivedEventArgs
ËË: _
(
ËË_ `
message
ËË` g
)
ËËg h
)
ËËh i
;
ËËi j
}
ÌÌ 
}
ÍÍ 
catch
ÎÎ 
(
ÎÎ 
	Exception
ÎÎ 
ex
ÎÎ 
)
ÎÎ  
{
ÏÏ 
FDebug
ĞĞ 
.
ĞĞ 
writeLog
ĞĞ 
(
ĞĞ  
ex
ĞĞ  "
)
ĞĞ" #
;
ĞĞ# $
}
ÑÑ 
finally
ÒÒ 
{
ÓÓ 
}
ÕÕ 
}
ÖÖ 	
private
ÚÚ 
void
ÚÚ +
m_fPipeClient_PipeErrorRaised
ÚÚ 2
(
ÚÚ2 3
object
ÛÛ 
sender
ÛÛ 
,
ÛÛ '
FPipeErrorRaisedEventArgs
ÜÜ %
e
ÜÜ& '
)
İİ 
{
ŞŞ 	
try
ßß 
{
àà '
onServiceTraceErrorRaised
áá )
(
áá) *
e
áá* +
.
áá+ ,
	exception
áá, 5
)
áá5 6
;
áá6 7
}
ââ 
catch
ãã 
(
ãã 
	Exception
ãã 
ex
ãã 
)
ãã  
{
ää 
FDebug
åå 
.
åå 
writeLog
åå 
(
åå  
ex
åå  "
)
åå" #
;
åå# $
}
ææ 
finally
çç 
{
èè 
}
êê 
}
ëë 	
}
ññ 
}òò Ş
kD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\ServiceTrace\c_FServiceTraceMessage.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
internal 
class  
FServiceTraceMessage '
:( )
IDisposable* 5
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
byte 
[ 
] 
	m_message  
=! "
null# '
;' (
public!!  
FServiceTraceMessage!! #
(!!# $
byte"" 
["" 
]"" 
message"" 
)## 
{$$ 	
	m_message%% 
=%% 
message%% 
;%%  
}&& 	
~** 	 
FServiceTraceMessage**	 
(** 
)++ 
{,, 	
	myDispose-- 
(-- 
false-- 
)-- 
;-- 
}.. 	
	protected22 
void22 
	myDispose22  
(22  !
bool33 
	disposing33 
)44 
{55 	
if66 
(66 
!66 

m_disposed66 
)66 
{77 
if88 
(88 
	disposing88 
)88 
{99 
};; 

m_disposed== 
=== 
true== !
;==! "
}>> 
}?? 	
publicGG 
voidGG 
DisposeGG 
(GG 
)HH 
{II 	
	myDisposeJJ 
(JJ 
trueJJ 
)JJ 
;JJ 
GCKK 
.KK 
SuppressFinalizeKK 
(KK  
thisKK  $
)KK$ %
;KK% &
}LL 	
publicTT 
byteTT 
[TT 
]TT 
messageTT 
{UU 	
getVV 
{WW 
tryXX 
{YY 
returnZZ 
	m_messageZZ $
;ZZ$ %
}[[ 
catch\\ 
(\\ 
	Exception\\  
ex\\! #
)\\# $
{]] 
FDebug^^ 
.^^ 
throwException^^ )
(^^) *
ex^^* ,
)^^, -
;^^- .
}__ 
finally`` 
{aa 
}cc 
returndd 
nulldd 
;dd 
}ee 
}ff 	
}rr 
}ss •[
oD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\ServiceTrace\c_FServiceTraceMessageList.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
internal 
class $
FServiceTraceMessageList +
:, -
IDisposable. 9
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
int 
m_maxMessageCount %
=& '
$num( +
;+ ,
private 
	FCodeLock 
m_fLock !
=" #
null$ (
;( )
private 
List 
<  
FServiceTraceMessage )
>) *
m_fMessageList+ 9
=: ;
null< @
;@ A
public## $
FServiceTraceMessageList## '
(##' (
)$$ 
{%% 	
m_fLock&& 
=&& 
new&& 
	FCodeLock&& #
(&&# $
)&&$ %
;&&% &
m_fMessageList'' 
='' 
new''  
List''! %
<''% & 
FServiceTraceMessage''& :
>'': ;
(''; <
)''< =
;''= >
}(( 	
~,, 	$
FServiceTraceMessageList,,	 !
(,,! "
)-- 
{.. 	
	myDispose// 
(// 
false// 
)// 
;// 
}00 	
	protected44 
void44 
	myDispose44  
(44  !
bool55 
	disposing55 
)66 
{77 	
if88 
(88 
!88 

m_disposed88 
)88 
{99 
if:: 
(:: 
	disposing:: 
):: 
{;; 
if<< 
(<< 
m_fLock<< 
!=<<  "
null<<# '
)<<' (
{== 
m_fLock>> 
.>>  
Dispose>>  '
(>>' (
)>>( )
;>>) *
m_fLock?? 
=??  !
null??" &
;??& '
}@@ 
}AA 

m_disposedCC 
=CC 
trueCC !
;CC! "
}DD 
}EE 	
publicMM 
voidMM 
DisposeMM 
(MM 
)NN 
{OO 	
	myDisposePP 
(PP 
truePP 
)PP 
;PP 
GCQQ 
.QQ 
SuppressFinalizeQQ 
(QQ  
thisQQ  $
)QQ$ %
;QQ% &
}RR 	
publicZZ 
intZZ 
maxMessageCountZZ "
{[[ 	
get\\ 
{]] 
try^^ 
{__ 
return`` 
m_maxMessageCount`` ,
;``, -
}aa 
catchbb 
(bb 
	Exceptionbb  
exbb! #
)bb# $
{cc 
FDebugdd 
.dd 
throwExceptiondd )
(dd) *
exdd* ,
)dd, -
;dd- .
}ee 
finallyff 
{gg 
}ii 
returnjj 
$numjj 
;jj 
}kk 
setmm 
{nn 
tryoo 
{pp 
ifqq 
(qq 
valueqq 
<qq 
$numqq  !
)qq! "
{rr 
FDebugss 
.ss 
throwFExceptionss .
(ss. /
stringss/ 5
.ss5 6
Formatss6 <
(ss< =

FConstantsss= G
.ssG H

err_m_0005ssH R
,ssR S
$strssT g
)ssg h
)ssh i
;ssi j
}tt 
m_maxMessageCountxx %
=xx& '
valuexx( -
;xx- .
}yy 
catchzz 
(zz 
	Exceptionzz  
exzz! #
)zz# $
{{{ 
FDebug|| 
.|| 
throwException|| )
(||) *
ex||* ,
)||, -
;||- .
}}} 
finally~~ 
{ 
}
 
}
‚‚ 
}
ƒƒ 	
public
‡‡ 
int
‡‡ 
count
‡‡ 
{
ˆˆ 	
get
‰‰ 
{
ŠŠ 
try
‹‹ 
{
ŒŒ 
return
 
m_fMessageList
 )
.
) *
Count
* /
;
/ 0
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
‘‘ 
.
‘‘ 
throwException
‘‘ )
(
‘‘) *
ex
‘‘* ,
)
‘‘, -
;
‘‘- .
}
’’ 
finally
““ 
{
”” 
}
–– 
return
—— 
$num
—— 
;
—— 
}
˜˜ 
}
™™ 	
public
 "
FServiceTraceMessage
 #
this
$ (
[
( )
int
) ,
index
- 2
]
2 3
{
 	
get
ŸŸ 
{
   
try
¡¡ 
{
¢¢ 
if
££ 
(
££ 
index
££ 
<
££ 
m_fMessageList
££  .
.
££. /
Count
££/ 4
)
££4 5
{
¤¤ 
return
¥¥ 
m_fMessageList
¥¥ -
[
¥¥- .
index
¥¥. 3
]
¥¥3 4
;
¥¥4 5
}
¦¦ 
return
§§ 
null
§§ 
;
§§  
}
¨¨ 
catch
©© 
(
©© 
	Exception
©©  
ex
©©! #
)
©©# $
{
ªª 
FDebug
«« 
.
«« 
throwException
«« )
(
««) *
ex
««* ,
)
««, -
;
««- .
}
¬¬ 
finally
­­ 
{
®® 
}
°° 
return
±± 
null
±± 
;
±± 
}
²² 
}
³³ 	
public
»» 
void
»» 
add
»» 
(
»» "
FServiceTraceMessage
¼¼  
fMessage
¼¼! )
)
½½ 
{
¾¾ 	
try
¿¿ 
{
ÀÀ 
m_fLock
ÁÁ 
.
ÁÁ 
wait
ÁÁ 
(
ÁÁ 
)
ÁÁ 
;
ÁÁ 
m_fMessageList
ÅÅ 
.
ÅÅ 
Add
ÅÅ "
(
ÅÅ" #
fMessage
ÅÅ# +
)
ÅÅ+ ,
;
ÅÅ, -
if
ÉÉ 
(
ÉÉ 
m_fMessageList
ÉÉ "
.
ÉÉ" #
Count
ÉÉ# (
>
ÉÉ) *
m_maxMessageCount
ÉÉ+ <
)
ÉÉ< =
{
ÊÊ 
m_fMessageList
ËË "
.
ËË" #
RemoveRange
ËË# .
(
ËË. /
$num
ËË/ 0
,
ËË0 1
m_fMessageList
ËË2 @
.
ËË@ A
Count
ËËA F
-
ËËG H
m_maxMessageCount
ËËI Z
)
ËËZ [
;
ËË[ \
}
ÌÌ 
}
ÍÍ 
catch
ÎÎ 
(
ÎÎ 
	Exception
ÎÎ 
ex
ÎÎ 
)
ÎÎ  
{
ÏÏ 
FDebug
ĞĞ 
.
ĞĞ 
throwException
ĞĞ %
(
ĞĞ% &
ex
ĞĞ& (
)
ĞĞ( )
;
ĞĞ) *
}
ÑÑ 
finally
ÒÒ 
{
ÓÓ 
m_fLock
ÔÔ 
.
ÔÔ 
set
ÔÔ 
(
ÔÔ 
)
ÔÔ 
;
ÔÔ 
}
ÕÕ 
}
ÖÖ 	
public
ÚÚ 
void
ÚÚ 
remove
ÚÚ 
(
ÚÚ "
FServiceTraceMessage
ÛÛ  
fMessage
ÛÛ! )
)
ÜÜ 
{
İİ 	
try
ŞŞ 
{
ßß 
m_fLock
àà 
.
àà 
wait
àà 
(
àà 
)
àà 
;
àà 
m_fMessageList
áá 
.
áá 
Remove
áá %
(
áá% &
fMessage
áá& .
)
áá. /
;
áá/ 0
}
ââ 
catch
ãã 
(
ãã 
	Exception
ãã 
ex
ãã 
)
ãã  
{
ää 
FDebug
åå 
.
åå 
throwException
åå %
(
åå% &
ex
åå& (
)
åå( )
;
åå) *
}
ææ 
finally
çç 
{
èè 
m_fLock
éé 
.
éé 
set
éé 
(
éé 
)
éé 
;
éé 
}
êê 
}
ëë 	
public
ïï 
void
ïï 
rmeoveAt
ïï 
(
ïï 
int
ğğ 
index
ğğ 
)
ññ 
{
òò 	
try
óó 
{
ôô 
m_fLock
õõ 
.
õõ 
wait
õõ 
(
õõ 
)
õõ 
;
õõ 
m_fMessageList
öö 
.
öö 
RemoveAt
öö '
(
öö' (
index
öö( -
)
öö- .
;
öö. /
}
÷÷ 
catch
øø 
(
øø 
	Exception
øø 
ex
øø 
)
øø  
{
ùù 
FDebug
úú 
.
úú 
throwException
úú %
(
úú% &
ex
úú& (
)
úú( )
;
úú) *
}
ûû 
finally
üü 
{
ıı 
m_fLock
şş 
.
şş 
set
şş 
(
şş 
)
şş 
;
şş 
}
ÿÿ 
}
€€ 	
public
„„ 
void
„„ 
clear
„„ 
(
„„ 
)
…… 
{
†† 	
try
‡‡ 
{
ˆˆ 
m_fLock
‰‰ 
.
‰‰ 
wait
‰‰ 
(
‰‰ 
)
‰‰ 
;
‰‰ 
m_fMessageList
ŠŠ 
.
ŠŠ 
Clear
ŠŠ $
(
ŠŠ$ %
)
ŠŠ% &
;
ŠŠ& '
}
‹‹ 
catch
ŒŒ 
(
ŒŒ 
	Exception
ŒŒ 
ex
ŒŒ 
)
ŒŒ  
{
 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
 
{
‘‘ 
m_fLock
’’ 
.
’’ 
set
’’ 
(
’’ 
)
’’ 
;
’’ 
}
““ 
}
”” 	
public
˜˜ "
FServiceTraceMessage
˜˜ #
[
˜˜# $
]
˜˜$ %
getMessageAll
˜˜& 3
(
˜˜3 4
bool
™™ 
isRemoveAll
™™ 
)
šš 
{
›› 	"
FServiceTraceMessage
œœ  
[
œœ  !
]
œœ! "
	fMessages
œœ# ,
=
œœ- .
null
œœ/ 3
;
œœ3 4
try
 
{
ŸŸ 
m_fLock
   
.
   
wait
   
(
   
)
   
;
   
if
¤¤ 
(
¤¤ 
m_fMessageList
¤¤ "
.
¤¤" #
Count
¤¤# (
==
¤¤) +
$num
¤¤, -
)
¤¤- .
{
¥¥ 
return
¦¦ 
null
¦¦ 
;
¦¦  
}
§§ 
	fMessages
«« 
=
«« 
m_fMessageList
«« +
.
««+ ,
ToArray
««, 3
(
««3 4
)
««4 5
;
««5 6
m_fMessageList
¬¬ 
.
¬¬ 
Clear
¬¬ $
(
¬¬$ %
)
¬¬% &
;
¬¬& '
return
­­ 
	fMessages
­­  
;
­­  !
}
®® 
catch
¯¯ 
(
¯¯ 
	Exception
¯¯ 
ex
¯¯ 
)
¯¯  
{
°° 
FDebug
±± 
.
±± 
throwException
±± %
(
±±% &
ex
±±& (
)
±±( )
;
±±) *
}
²² 
finally
³³ 
{
´´ 
m_fLock
µµ 
.
µµ 
set
µµ 
(
µµ 
)
µµ 
;
µµ 
}
¶¶ 
return
·· 
null
·· 
;
·· 
}
¸¸ 	
}
¾¾ 
}¿¿ §
eD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Socket\c_FSocketEventArgsBase.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
Serializable 
] 
public 

abstract 
class  
FSocketEventArgsBase .
:/ 0
	EventArgs1 :
,: ;
IDisposable< G
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FSocketEventId 
m_fSocketEventId /
=0 1
FSocketEventId2 @
.@ A
NoneA E
;E F
internal##  
FSocketEventArgsBase## %
(##% &
FSocketEventId$$ 
fSocketEventId$$ )
)%% 
{&& 	
m_fSocketEventId'' 
='' 
fSocketEventId'' -
;''- .
}(( 	
~,, 	 
FSocketEventArgsBase,,	 
(,, 
)-- 
{.. 	
	myDispose// 
(// 
false// 
)// 
;// 
}00 	
	protected44 
virtual44 
void44 
	myDispose44 (
(44( )
bool55 
	disposing55 
)66 
{77 	
if88 
(88 
!88 

m_disposed88 
)88 
{99 
if:: 
(:: 
	disposing:: 
):: 
{;; 
}== 

m_disposed?? 
=?? 
true?? !
;??! "
}@@ 
}AA 	
publicII 
voidII 
DisposeII 
(II 
)JJ 
{KK 	
	myDisposeLL 
(LL 
trueLL 
)LL 
;LL 
GCMM 
.MM 
SuppressFinalizeMM 
(MM  
thisMM  $
)MM$ %
;MM% &
}NN 	
internalVV 
FSocketEventIdVV 
fSocketEventIdVV  .
{WW 	
getXX 
{YY 
tryZZ 
{[[ 
return\\ 
m_fSocketEventId\\ +
;\\+ ,
}]] 
catch^^ 
(^^ 
	Exception^^  
ex^^! #
)^^# $
{__ 
FDebug`` 
.`` 
throwException`` )
(``) *
ex``* ,
)``, -
;``- .
}aa 
finallybb 
{cc 
}ee 
returnff 
FSocketEventIdff %
.ff% &
Noneff& *
;ff* +
}gg 
}hh 	
}tt 
}uu È
cD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Socket\c_FSocketEventPusher.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
internal 
class 
FSocketEventPusher %
:& '
IDisposable( 3
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
FISocket 
	m_fSocket 
= 
null !
;! "
private 
FQueue 
<  
FSocketEventArgsBase +
>+ ,
	m_fEvents- 6
=7 8
null9 =
;= >
private 
FThread 
m_fEventPusher &
=' (
null) -
;- .
private   
bool   &
m_isCompletedEventHandling   /
=  0 1
false  2 7
;  7 8
private!! 
bool!! 
m_suspended!!  
=!!! "
false!!# (
;!!( )
public'' 
FSocketEventPusher'' !
(''! "
FISocket(( 
fSocket(( 
,(( 
bool)) 
	suspended)) 
)** 
{++ 	
	m_fSocket,, 
=,, 
fSocket,, 
;,,  
	m_fEvents-- 
=-- 
new-- 
FQueue-- "
<--" # 
FSocketEventArgsBase--# 7
>--7 8
(--8 9
)--9 :
;--: ;
m_suspended.. 
=.. 
	suspended.. #
;..# $
init22 
(22 
)22 
;22 
}33 	
~77 	
FSocketEventPusher77	 
(77 
)88 
{99 	
	myDispose:: 
(:: 
false:: 
):: 
;:: 
};; 	
	protected?? 
void?? 
	myDispose??  
(??  !
bool@@ 
	disposing@@ 
)AA 
{BB 	
ifCC 
(CC 
!CC 

m_disposedCC 
)CC 
{DD 
ifEE 
(EE 
	disposingEE 
)EE 
{FF 
termGG 
(GG 
)GG 
;GG 
ifKK 
(KK 
	m_fEventsKK !
!=KK" $
nullKK% )
)KK) *
{LL 
	m_fEventsMM !
.MM! "
DisposeMM" )
(MM) *
)MM* +
;MM+ ,
	m_fEventsNN !
=NN" #
nullNN$ (
;NN( )
}OO 
	m_fSocketQQ 
=QQ 
nullQQ  $
;QQ$ %
}RR 

m_disposedTT 
=TT 
trueTT !
;TT! "
}UU 
}VV 	
public^^ 
void^^ 
Dispose^^ 
(^^ 
)__ 
{`` 	
	myDisposeaa 
(aa 
trueaa 
)aa 
;aa 
GCbb 
.bb 
SuppressFinalizebb 
(bb  
thisbb  $
)bb$ %
;bb% &
}cc 	
publickk 
intkk 

eventCountkk 
{ll 	
getmm 
{nn 
tryoo 
{pp 
returnqq 
	m_fEventsqq $
.qq$ %
countqq% *
;qq* +
}rr 
catchss 
(ss 
	Exceptionss  
exss! #
)ss# $
{tt 
FDebuguu 
.uu 
throwExceptionuu )
(uu) *
exuu* ,
)uu, -
;uu- .
}vv 
finallyww 
{xx 
}zz 
return{{ 
$num{{ 
;{{ 
}|| 
}}} 	
public
 
bool
 &
isCompletedEventHandling
 ,
{
‚‚ 	
get
ƒƒ 
{
„„ 
try
…… 
{
†† 
if
‡‡ 
(
‡‡ 
this
‡‡ 
.
‡‡ 

eventCount
‡‡ '
==
‡‡( *
$num
‡‡+ ,
&&
‡‡- /(
m_isCompletedEventHandling
‡‡0 J
)
‡‡J K
{
ˆˆ 
return
‰‰ 
true
‰‰ #
;
‰‰# $
}
ŠŠ 
return
‹‹ 
false
‹‹  
;
‹‹  !
}
ŒŒ 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
‘‘ 
{
’’ 
}
”” 
return
•• 
false
•• 
;
•• 
}
–– 
}
—— 	
public
›› 
bool
›› 
	suspended
›› 
{
œœ 	
get
 
{
 
try
ŸŸ 
{
   
return
¡¡ 
m_suspended
¡¡ &
;
¡¡& '
}
¢¢ 
catch
££ 
(
££ 
	Exception
££  
ex
££! #
)
££# $
{
¤¤ 
FDebug
¥¥ 
.
¥¥ 
throwException
¥¥ )
(
¥¥) *
ex
¥¥* ,
)
¥¥, -
;
¥¥- .
}
¦¦ 
finally
§§ 
{
¨¨ 
}
ªª 
return
«« 
false
«« 
;
«« 
}
¬¬ 
}
­­ 	
private
µµ 
void
µµ 
init
µµ 
(
µµ 
)
¶¶ 
{
·· 	
try
¸¸ 
{
¹¹ (
m_isCompletedEventHandling
ºº *
=
ºº+ ,
true
ºº- 1
;
ºº1 2
m_fEventPusher
»» 
=
»»  
new
»»! $
FThread
»»% ,
(
»», -
$str
»»- F
,
»»F G
false
»»H M
,
»»M N
System
»»O U
.
»»U V
	Threading
»»V _
.
»»_ `
ThreadPriority
»»` n
.
»»n o
Normal
»»o u
,
»»u v
false
»»w |
)
»»| }
;
»»} ~
m_fEventPusher
¼¼ 
.
¼¼ 
ThreadJobCalled
¼¼ .
+=
¼¼/ 1
new
¼¼2 5*
FThreadJobCalledEventHandler
¼¼6 R
(
¼¼R S,
m_fEventPusher_ThreadJobCalled
¼¼S q
)
¼¼q r
;
¼¼r s
m_fEventPusher
½½ 
.
½½ 
start
½½ $
(
½½$ %
)
½½% &
;
½½& '
}
¾¾ 
catch
¿¿ 
(
¿¿ 
	Exception
¿¿ 
ex
¿¿ 
)
¿¿  
{
ÀÀ 
FDebug
ÁÁ 
.
ÁÁ 
throwException
ÁÁ %
(
ÁÁ% &
ex
ÁÁ& (
)
ÁÁ( )
;
ÁÁ) *
}
ÂÂ 
finally
ÃÃ 
{
ÄÄ 
}
ÆÆ 
}
ÇÇ 	
private
ËË 
void
ËË 
term
ËË 
(
ËË 
)
ÌÌ 
{
ÍÍ 	
try
ÎÎ 
{
ÏÏ 
if
ĞĞ 
(
ĞĞ 
m_fEventPusher
ĞĞ "
!=
ĞĞ# %
null
ĞĞ& *
)
ĞĞ* +
{
ÑÑ 
while
ÒÒ 
(
ÒÒ 
!
ÒÒ 
this
ÒÒ  
.
ÒÒ  !&
isCompletedEventHandling
ÒÒ! 9
)
ÒÒ9 :
{
ÓÓ 
System
ÔÔ 
.
ÔÔ 
	Threading
ÔÔ (
.
ÔÔ( )
Thread
ÔÔ) /
.
ÔÔ/ 0
Sleep
ÔÔ0 5
(
ÔÔ5 6
$num
ÔÔ6 8
)
ÔÔ8 9
;
ÔÔ9 :
}
ÕÕ 
m_fEventPusher
ÙÙ "
.
ÙÙ" #
ThreadJobCalled
ÙÙ# 2
-=
ÙÙ3 5
new
ÙÙ6 9*
FThreadJobCalledEventHandler
ÙÙ: V
(
ÙÙV W,
m_fEventPusher_ThreadJobCalled
ÙÙW u
)
ÙÙu v
;
ÙÙv w
m_fEventPusher
ÛÛ "
.
ÛÛ" #
stop
ÛÛ# '
(
ÛÛ' (
)
ÛÛ( )
;
ÛÛ) *
m_fEventPusher
ÜÜ "
.
ÜÜ" #
Dispose
ÜÜ# *
(
ÜÜ* +
)
ÜÜ+ ,
;
ÜÜ, -
m_fEventPusher
İİ "
=
İİ# $
null
İİ% )
;
İİ) *
}
ŞŞ 
}
ßß 
catch
àà 
(
àà 
	Exception
àà 
ex
àà 
)
àà  
{
áá 
FDebug
ââ 
.
ââ 
throwException
ââ %
(
ââ% &
ex
ââ& (
)
ââ( )
;
ââ) *
}
ãã 
finally
ää 
{
åå 
}
çç 
}
èè 	
public
ìì 
void
ìì 
	pushEvent
ìì 
(
ìì "
FSocketEventArgsBase
íí  
fSocketEvent
íí! -
)
îî 
{
ïï 	
try
ğğ 
{
ññ 
	m_fEvents
òò 
.
òò 
enqueue
òò !
(
òò! "
fSocketEvent
òò" .
)
òò. /
;
òò/ 0
}
óó 
catch
ôô 
(
ôô 
	Exception
ôô 
ex
ôô 
)
ôô  
{
õõ 
FDebug
öö 
.
öö 
throwException
öö %
(
öö% &
ex
öö& (
)
öö( )
;
öö) *
}
÷÷ 
finally
øø 
{
ùù 
}
ûû 
}
üü 	
public
€€ 
void
€€ 
	pushEvent
€€ 
(
€€ "
FSocketEventArgsBase
  
[
  !
]
! "
fSocketEvents
# 0
)
‚‚ 
{
ƒƒ 	
try
„„ 
{
…… 
	m_fEvents
†† 
.
†† 
enqueue
†† !
(
††! "
fSocketEvents
††" /
)
††/ 0
;
††0 1
}
‡‡ 
catch
ˆˆ 
(
ˆˆ 
	Exception
ˆˆ 
ex
ˆˆ 
)
ˆˆ  
{
‰‰ 
FDebug
ŠŠ 
.
ŠŠ 
throwException
ŠŠ %
(
ŠŠ% &
ex
ŠŠ& (
)
ŠŠ( )
;
ŠŠ) *
}
‹‹ 
finally
ŒŒ 
{
 
}
 
}
 	
public
”” 
void
”” 
suspend
”” 
(
”” 
)
•• 
{
–– 	
try
—— 
{
˜˜ 
m_suspended
™™ 
=
™™ 
true
™™ "
;
™™" #
}
šš 
catch
›› 
(
›› 
	Exception
›› 
ex
›› 
)
››  
{
œœ 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
ŸŸ 
{
   
}
¢¢ 
}
££ 	
public
§§ 
void
§§ 
resume
§§ 
(
§§ 
)
¨¨ 
{
©© 	
try
ªª 
{
«« 
m_suspended
¬¬ 
=
¬¬ 
false
¬¬ #
;
¬¬# $
}
­­ 
catch
®® 
(
®® 
	Exception
®® 
ex
®® 
)
®®  
{
¯¯ 
FDebug
°° 
.
°° 
throwException
°° %
(
°°% &
ex
°°& (
)
°°( )
;
°°) *
}
±± 
finally
²² 
{
³³ 
}
µµ 
}
¶¶ 	
public
ºº 
void
ºº (
waitEventHandlingCompleted
ºº .
(
ºº. /
)
»» 
{
¼¼ 	
try
½½ 
{
¾¾ 
while
¿¿ 
(
¿¿ 
!
¿¿ 
this
¿¿ 
.
¿¿ &
isCompletedEventHandling
¿¿ 5
)
¿¿5 6
{
ÀÀ 
if
ÁÁ 
(
ÁÁ 
System
ÁÁ 
.
ÁÁ 
Windows
ÁÁ &
.
ÁÁ& '
Forms
ÁÁ' ,
.
ÁÁ, -
Application
ÁÁ- 8
.
ÁÁ8 9
MessageLoop
ÁÁ9 D
)
ÁÁD E
{
ÂÂ 
System
ÃÃ 
.
ÃÃ 
Windows
ÃÃ &
.
ÃÃ& '
Forms
ÃÃ' ,
.
ÃÃ, -
Application
ÃÃ- 8
.
ÃÃ8 9
DoEvents
ÃÃ9 A
(
ÃÃA B
)
ÃÃB C
;
ÃÃC D
}
ÄÄ 
System
ÅÅ 
.
ÅÅ 
	Threading
ÅÅ $
.
ÅÅ$ %
Thread
ÅÅ% +
.
ÅÅ+ ,
Sleep
ÅÅ, 1
(
ÅÅ1 2
$num
ÅÅ2 3
)
ÅÅ3 4
;
ÅÅ4 5
}
ÆÆ 
}
ÇÇ 
catch
ÈÈ 
(
ÈÈ 
	Exception
ÈÈ 
ex
ÈÈ 
)
ÈÈ  
{
ÉÉ 
FDebug
ÊÊ 
.
ÊÊ 
throwException
ÊÊ %
(
ÊÊ% &
ex
ÊÊ& (
)
ÊÊ( )
;
ÊÊ) *
}
ËË 
finally
ÌÌ 
{
ÍÍ 
}
ÏÏ 
}
ĞĞ 	
private
ØØ 
void
ØØ ,
m_fEventPusher_ThreadJobCalled
ØØ 3
(
ØØ3 4
object
ÙÙ 
sender
ÙÙ 
,
ÙÙ 
FThreadEventArgs
ÚÚ 
e
ÚÚ 
)
ÛÛ 
{
ÜÜ 	"
FSocketEventArgsBase
İİ  
args
İİ! %
=
İİ& '
null
İİ( ,
;
İİ, -
try
ßß 
{
àà 
if
áá 
(
áá 
	m_fEvents
áá 
.
áá 
count
áá #
==
áá$ &
$num
áá' (
)
áá( )
{
ââ (
m_isCompletedEventHandling
ãã .
=
ãã/ 0
true
ãã1 5
;
ãã5 6
e
ää 
.
ää 
sleepThread
ää !
(
ää! "
$num
ää" #
)
ää# $
;
ää$ %
return
åå 
;
åå 
}
ææ (
m_isCompletedEventHandling
çç *
=
çç+ ,
false
çç- 2
;
çç2 3
if
ëë 
(
ëë 
m_suspended
ëë 
)
ëë  
{
ìì 
e
íí 
.
íí 
sleepThread
íí !
(
íí! "
$num
íí" #
)
íí# $
;
íí$ %
return
îî 
;
îî 
}
ïï 
while
óó 
(
óó 
!
óó 
m_suspended
óó #
&&
óó$ &
(
óó' (
args
óó( ,
=
óó- .
	m_fEvents
óó/ 8
.
óó8 9
dequeue
óó9 @
(
óó@ A
)
óóA B
)
óóB C
!=
óóD F
null
óóG K
)
óóK L
{
ôô 
if
õõ 
(
õõ 
	m_fSocket
õõ !
.
õõ! "
fSocketType
õõ" -
==
õõ. 0
FSocketType
õõ1 <
.
õõ< =
Listener
õõ= E
)
õõE F
{
öö 
if
úú 
(
úú 
args
úú  
.
úú  !
fSocketEventId
úú! /
==
úú0 2
FSocketEventId
úú3 A
.
úúA B(
TcpListenerAcceptCompleted
úúB \
)
úú\ ]
{
ûû 
(
üü 
(
üü 
FTcpListener
üü *
)
üü* +
	m_fSocket
üü+ 4
)
üü4 5
.
üü5 6*
onTcpListenerAcceptCompleted
üü6 R
(
üüR S
args
üüS W
)
üüW X
;
üüX Y
}
ıı 
else
şş 
if
şş 
(
şş  !
args
şş! %
.
şş% &
fSocketEventId
şş& 4
==
şş5 7
FSocketEventId
şş8 F
.
şşF G$
TcpListenerErrorRaised
şşG ]
)
şş] ^
{
ÿÿ 
(
€€ 
(
€€ 
FTcpListener
€€ *
)
€€* +
	m_fSocket
€€+ 4
)
€€4 5
.
€€5 6&
onTcpListenerErrorRaised
€€6 N
(
€€N O
args
€€O S
)
€€S T
;
€€T U
}
 
}
‚‚ 
else
ƒƒ 
{
„„ 
if
ˆˆ 
(
ˆˆ 
args
ˆˆ  
.
ˆˆ  !
fSocketEventId
ˆˆ! /
==
ˆˆ0 2
FSocketEventId
ˆˆ3 A
.
ˆˆA B#
TcpClientStateChanged
ˆˆB W
)
ˆˆW X
{
‰‰ 
(
ŠŠ 
(
ŠŠ 

FTcpClient
ŠŠ (
)
ŠŠ( )
	m_fSocket
ŠŠ) 2
)
ŠŠ2 3
.
ŠŠ3 4%
onTcpClientStateChanged
ŠŠ4 K
(
ŠŠK L
args
ŠŠL P
)
ŠŠP Q
;
ŠŠQ R
}
‹‹ 
else
ŒŒ 
if
ŒŒ 
(
ŒŒ  !
args
ŒŒ! %
.
ŒŒ% &
fSocketEventId
ŒŒ& 4
==
ŒŒ5 7
FSocketEventId
ŒŒ8 F
.
ŒŒF G#
TcpClientDataReceived
ŒŒG \
)
ŒŒ\ ]
{
 
(
 
(
 

FTcpClient
 (
)
( )
	m_fSocket
) 2
)
2 3
.
3 4%
onTcpClientDataReceived
4 K
(
K L
args
L P
)
P Q
;
Q R
}
 
else
 
if
 
(
  !
args
! %
.
% &
fSocketEventId
& 4
==
5 7
FSocketEventId
8 F
.
F G
TcpClientDataSent
G X
)
X Y
{
‘‘ 
(
’’ 
(
’’ 

FTcpClient
’’ (
)
’’( )
	m_fSocket
’’) 2
)
’’2 3
.
’’3 4!
onTcpClientDataSent
’’4 G
(
’’G H
args
’’H L
)
’’L M
;
’’M N
}
““ 
else
”” 
if
”” 
(
””  !
args
””! %
.
””% &
fSocketEventId
””& 4
==
””5 7
FSocketEventId
””8 F
.
””F G%
TcpClientDataSendFailed
””G ^
)
””^ _
{
•• 
(
–– 
(
–– 

FTcpClient
–– (
)
––( )
	m_fSocket
––) 2
)
––2 3
.
––3 4'
onTcpClientDataSendFailed
––4 M
(
––M N
args
––N R
)
––R S
;
––S T
}
—— 
else
˜˜ 
if
˜˜ 
(
˜˜  !
args
˜˜! %
.
˜˜% &
fSocketEventId
˜˜& 4
==
˜˜5 7
FSocketEventId
˜˜8 F
.
˜˜F G"
TcpClientErrorRaised
˜˜G [
)
˜˜[ \
{
™™ 
(
šš 
(
šš 

FTcpClient
šš (
)
šš( )
	m_fSocket
šš) 2
)
šš2 3
.
šš3 4$
onTcpClientErrorRaised
šš4 J
(
ššJ K
args
ššK O
)
ššO P
;
ššP Q
}
›› 
}
œœ 
}
 
}
 
catch
ŸŸ 
(
ŸŸ 
	Exception
ŸŸ 
ex
ŸŸ 
)
ŸŸ  
{
   
FDebug
¡¡ 
.
¡¡ 
writeLog
¡¡ 
(
¡¡  
ex
¡¡  "
)
¡¡" #
;
¡¡# $
}
¢¢ 
finally
££ 
{
¤¤ 
args
¥¥ 
=
¥¥ 
null
¥¥ 
;
¥¥ 
}
¦¦ 
}
§§ 	
}
­­ 
}®® ª&
lD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Socket\c_FTcpClientDataSentEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
Serializable 
] 
public 

class '
FTcpClientDataSentEventArgs ,
:- . 
FSocketEventArgsBase/ C
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 

FTcpClient 
m_fOwnerTcpClient ,
=- .
null/ 3
;3 4
private 
FSocketSendData 
m_fData  '
=( )
null* .
;. /
internal## '
FTcpClientDataSentEventArgs## ,
(##, -

FTcpClient$$ 
fOwnerTcpClient$$ &
,$$& '
FSocketSendData%% 
fData%% !
)&& 
:'' 
base'' 
('' 
FSocketEventId'' "
.''" #
TcpClientDataSent''# 4
)''4 5
{(( 	
m_fOwnerTcpClient)) 
=)) 
fOwnerTcpClient))  /
;))/ 0
m_fData** 
=** 
fData** 
;** 
}++ 	
~// 	'
FTcpClientDataSentEventArgs//	 $
(//$ %
)00 
{11 	
	myDispose22 
(22 
false22 
)22 
;22 
}33 	
	protected77 
override77 
void77 
	myDispose77  )
(77) *
bool88 
	disposing88 
)99 
{:: 	
if;; 
(;; 
!;; 

m_disposed;; 
);; 
{<< 
if== 
(== 
	disposing== 
)== 
{>> 
m_fOwnerTcpClient?? %
=??& '
null??( ,
;??, -
}@@ 

m_disposedAA 
=AA 
trueAA !
;AA! "
baseEE 
.EE 
	myDisposeEE 
(EE 
	disposingEE (
)EE( )
;EE) *
}FF 
}GG 	
publicOO 

FTcpClientOO 
fOwnerTcpClientOO )
{PP 	
getQQ 
{RR 
trySS 
{TT 
returnUU 
m_fOwnerTcpClientUU ,
;UU, -
}VV 
catchWW 
(WW 
	ExceptionWW  
exWW! #
)WW# $
{XX 
FDebugYY 
.YY 
throwExceptionYY )
(YY) *
exYY* ,
)YY, -
;YY- .
}ZZ 
finally[[ 
{\\ 
}^^ 
return__ 
null__ 
;__ 
}`` 
}aa 	
publicee 
FSocketSendDataee 
fDataee $
{ff 	
getgg 
{hh 
tryii 
{jj 
returnkk 
m_fDatakk "
;kk" #
}ll 
catchmm 
(mm 
	Exceptionmm  
exmm! #
)mm# $
{nn 
FDebugoo 
.oo 
throwExceptionoo )
(oo) *
exoo* ,
)oo, -
;oo- .
}pp 
finallyqq 
{rr 
}tt 
returnuu 
nulluu 
;uu 
}vv 
}ww 	
public{{ 
byte{{ 
[{{ 
]{{ 
data{{ 
{|| 	
get}} 
{~~ 
try 
{
€€ 
return
 
m_fData
 "
.
" #
data
# '
;
' (
}
‚‚ 
catch
ƒƒ 
(
ƒƒ 
	Exception
ƒƒ  
ex
ƒƒ! #
)
ƒƒ# $
{
„„ 
FDebug
…… 
.
…… 
throwException
…… )
(
……) *
ex
……* ,
)
……, -
;
……- .
}
†† 
finally
‡‡ 
{
ˆˆ 
}
ŠŠ 
return
‹‹ 
null
‹‹ 
;
‹‹ 
}
ŒŒ 
}
 	
public
‘‘ 
int
‘‘ 

dataLength
‘‘ 
{
’’ 	
get
““ 
{
”” 
try
•• 
{
–– 
return
—— 
m_fData
—— "
.
——" #
data
——# '
.
——' (
Length
——( .
;
——. /
}
˜˜ 
catch
™™ 
(
™™ 
	Exception
™™  
ex
™™! #
)
™™# $
{
šš 
FDebug
›› 
.
›› 
throwException
›› )
(
››) *
ex
››* ,
)
››, -
;
››- .
}
œœ 
finally
 
{
 
}
   
return
¡¡ 
$num
¡¡ 
;
¡¡ 
}
¢¢ 
}
££ 	
}
¯¯ 
}°° Øî
]D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Socket\c_FTcpListener.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FTcpListener 
: 
FISocket  (
,( )
IDisposable* 5
{ 
public 
event 3
'FTcpListenerAcceptCompletedEventHandler <&
TcpListenerAcceptCompleted= W
=X Y
nullZ ^
;^ _
public 
event /
#FTcpListenerErrorRaisedEventHandler 8"
TcpListenerErrorRaised9 O
=P Q
nullR V
;V W
private 
bool 

m_disposed 
=  !
false" '
;' (
private   
string   
	m_localIp    
=  ! "
string  # )
.  ) *
Empty  * /
;  / 0
private!! 
int!! 
m_localPort!! 
=!!  !
$num!!" #
;!!# $
private"" 
int"" 
	m_backlog"" 
="" 
$num""  !
;""! "
private## 
bool## 
	m_started## 
=##  
false##! &
;##& '
private$$ 
TcpListener$$ 
m_tcpListener$$ )
=$$* +
null$$, 0
;$$0 1
private%% 
FSocketFlag%% 
m_fSocketFlag%% )
=%%* +
null%%, 0
;%%0 1
private'' 
	FCodeLock'' 
m_fMainSync'' %
=''& '
null''( ,
;'', -
private(( 
FSocketEventPusher(( "
m_fEventPusher((# 1
=((2 3
null((4 8
;((8 9
private)) 
FThread)) 

m_fThdMain)) "
=))# $
null))% )
;))) *
public// 
FTcpListener// 
(// 
string00 
localIp00 
,00 
int11 
	localPort11 
,11 
int22 
backlog22 
)33 
{44 	
	m_localIp55 
=55 
localIp55 
;55  
m_localPort66 
=66 
	localPort66 #
;66# $
	m_backlog77 
=77 
backlog77 
;77  
init99 
(99 
)99 
;99 
}:: 	
~>> 	
FTcpListener>>	 
(>> 
)?? 
{@@ 	
	myDisposeAA 
(AA 
falseAA 
)AA 
;AA 
}BB 	
	protectedFF 
voidFF 
	myDisposeFF  
(FF  !
boolGG 
	disposingGG 
)HH 
{II 	
ifJJ 
(JJ 
!JJ 

m_disposedJJ 
)JJ 
{KK 
ifLL 
(LL 
	disposingLL 
)LL 
{MM 
termNN 
(NN 
)NN 
;NN 
}OO 

m_disposedQQ 
=QQ 
trueQQ !
;QQ! "
}RR 
}SS 	
public[[ 
void[[ 
Dispose[[ 
([[ 
)\\ 
{]] 	
	myDispose^^ 
(^^ 
true^^ 
)^^ 
;^^ 
GC__ 
.__ 
SuppressFinalize__ 
(__  
this__  $
)__$ %
;__% &
}`` 	
publichh 
FSocketTypehh 
fSocketTypehh &
{ii 	
getjj 
{kk 
tryll 
{mm 
returnnn 
FSocketTypenn &
.nn& '
Listenernn' /
;nn/ 0
}oo 
catchpp 
(pp 
	Exceptionpp  
expp! #
)pp# $
{qq 
FDebugrr 
.rr 
throwExceptionrr )
(rr) *
exrr* ,
)rr, -
;rr- .
}ss 
finallytt 
{uu 
}ww 
returnxx 
FSocketTypexx "
.xx" #
Listenerxx# +
;xx+ ,
}yy 
}zz 	
public~~ 
string~~ 
localIp~~ 
{ 	
get
€€ 
{
 
try
‚‚ 
{
ƒƒ 
return
„„ 
	m_localIp
„„ $
;
„„$ %
}
…… 
catch
†† 
(
†† 
	Exception
††  
ex
††! #
)
††# $
{
‡‡ 
FDebug
ˆˆ 
.
ˆˆ 
throwException
ˆˆ )
(
ˆˆ) *
ex
ˆˆ* ,
)
ˆˆ, -
;
ˆˆ- .
}
‰‰ 
finally
ŠŠ 
{
‹‹ 
}
 
return
 
string
 
.
 
Empty
 #
;
# $
}
 
}
 	
public
”” 
int
”” 
	localPort
”” 
{
•• 	
get
–– 
{
—— 
try
˜˜ 
{
™™ 
return
šš 
m_localPort
šš &
;
šš& '
}
›› 
catch
œœ 
(
œœ 
	Exception
œœ  
ex
œœ! #
)
œœ# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
ŸŸ 
finally
   
{
¡¡ 
}
££ 
return
¤¤ 
$num
¤¤ 
;
¤¤ 
}
¥¥ 
}
¦¦ 	
public
ªª 
bool
ªª 
started
ªª 
{
«« 	
get
¬¬ 
{
­­ 
try
®® 
{
¯¯ 
return
°° 
	m_started
°° $
;
°°$ %
}
±± 
catch
²² 
(
²² 
	Exception
²²  
ex
²²! #
)
²²# $
{
³³ 
FDebug
´´ 
.
´´ 
throwException
´´ )
(
´´) *
ex
´´* ,
)
´´, -
;
´´- .
}
µµ 
finally
¶¶ 
{
·· 
}
¹¹ 
return
ºº 
false
ºº 
;
ºº 
}
»» 
}
¼¼ 	
private
ÄÄ 
void
ÄÄ "
pushSocketErrorEvent
ÄÄ )
(
ÄÄ) *
string
ÅÅ 
function
ÅÅ 
,
ÅÅ 
SocketException
ÆÆ 
sckEx
ÆÆ !
)
ÇÇ 
{
ÈÈ 	
FDebugLogArgs
ÉÉ 
fLogArgs
ÉÉ "
=
ÉÉ# $
null
ÉÉ% )
;
ÉÉ) *
try
ËË 
{
ÌÌ 
System
ÍÍ 
.
ÍÍ 
Diagnostics
ÍÍ "
.
ÍÍ" #
Debug
ÍÍ# (
.
ÍÍ( )
	WriteLine
ÍÍ) 2
(
ÍÍ2 3
$str
ÍÍ3 A
+
ÍÍB C
sckEx
ÍÍD I
.
ÍÍI J
SocketErrorCode
ÍÍJ Y
.
ÍÍY Z
ToString
ÍÍZ b
(
ÍÍb c
)
ÍÍc d
)
ÍÍd e
;
ÍÍe f
fLogArgs
ÔÔ 
=
ÔÔ 
new
ÔÔ 
FDebugLogArgs
ÔÔ ,
(
ÔÔ, -
FDebugLogCategory
ÔÔ- >
.
ÔÔ> ?
	Exception
ÔÔ? H
,
ÔÔH I
$str
ÔÔJ ]
,
ÔÔ] ^
this
ÔÔ_ c
.
ÔÔc d
GetType
ÔÔd k
(
ÔÔk l
)
ÔÔl m
,
ÔÔm n
function
ÔÔo w
)
ÔÔw x
;
ÔÔx y
fLogArgs
ÕÕ 
.
ÕÕ 
additionInfo
ÕÕ %
=
ÕÕ& '
$str
ÕÕ( ;
+
ÕÕ< =
sckEx
ÕÕ> C
.
ÕÕC D
SocketErrorCode
ÕÕD S
.
ÕÕS T
ToString
ÕÕT \
(
ÕÕ\ ]
)
ÕÕ] ^
+
ÕÕ_ `
$str
ÕÕa d
+
ÕÕe f
Environment
ÕÕg r
.
ÕÕr s
NewLine
ÕÕs z
+
ÕÕ{ |
sckExÕÕ} ‚
.ÕÕ‚ ƒ
ToStringÕÕƒ ‹
(ÕÕ‹ Œ
)ÕÕŒ 
;ÕÕ 
FDebug
ÖÖ 
.
ÖÖ 
writeLog
ÖÖ 
(
ÖÖ  
fLogArgs
ÖÖ  (
)
ÖÖ( )
;
ÖÖ) *
m_fEventPusher
ØØ 
.
ØØ 
	pushEvent
ØØ (
(
ØØ( )
new
ÙÙ .
 FTcpListenerErrorRaisedEventArgs
ÙÙ 8
(
ÙÙ8 9
this
ÙÙ9 =
,
ÙÙ= >
sckEx
ÙÙ? D
.
ÙÙD E
Message
ÙÙE L
,
ÙÙL M
sckEx
ÙÙN S
)
ÙÙS T
)
ÚÚ 
;
ÚÚ 
}
ÛÛ 
catch
ÜÜ 
(
ÜÜ 
	Exception
ÜÜ 
ex
ÜÜ 
)
ÜÜ  
{
İİ 
FDebug
ŞŞ 
.
ŞŞ 
writeLog
ŞŞ 
(
ŞŞ  
ex
ŞŞ  "
)
ŞŞ" #
;
ŞŞ# $
}
ßß 
finally
àà 
{
áá 
fLogArgs
ââ 
=
ââ 
null
ââ 
;
ââ  
}
ãã 
}
ää 	
private
èè 
void
èè 
pushErrorEvent
èè #
(
èè# $
	Exception
éé 
ex
éé 
)
êê 
{
ëë 	
try
ìì 
{
íí 
FDebug
îî 
.
îî 
writeLog
îî 
(
îî  
ex
îî  "
)
îî" #
;
îî# $
m_fEventPusher
ğğ 
.
ğğ 
	pushEvent
ğğ (
(
ğğ( )
new
ğğ) ,.
 FTcpListenerErrorRaisedEventArgs
ğğ- M
(
ğğM N
this
ğğN R
,
ğğR S
ex
ğğT V
.
ğğV W
Message
ğğW ^
,
ğğ^ _
ex
ğğ` b
)
ğğb c
)
ğğc d
;
ğğd e
}
ññ 
catch
òò 
(
òò 
	Exception
òò 
ex1
òò  
)
òò  !
{
óó 
FDebug
ôô 
.
ôô 
writeLog
ôô 
(
ôô  
ex1
ôô  #
)
ôô# $
;
ôô$ %
}
õõ 
finally
öö 
{
÷÷ 
}
ùù 
}
úú 	
private
şş 
void
şş 
init
şş 
(
şş 
)
ÿÿ 
{
€€ 	
try
 
{
‚‚ 
m_fMainSync
ƒƒ 
=
ƒƒ 
new
ƒƒ !
	FCodeLock
ƒƒ" +
(
ƒƒ+ ,
)
ƒƒ, -
;
ƒƒ- .
m_fSocketFlag
„„ 
=
„„ 
new
„„  #
FSocketFlag
„„$ /
(
„„/ 0
)
„„0 1
;
„„1 2
m_fEventPusher
…… 
=
……  
new
……! $ 
FSocketEventPusher
……% 7
(
……7 8
this
……8 <
,
……< =
false
……> C
)
……C D
;
……D E

m_fThdMain
‡‡ 
=
‡‡ 
new
‡‡  
FThread
‡‡! (
(
‡‡( )
$str
‡‡) A
)
‡‡A B
;
‡‡B C

m_fThdMain
ˆˆ 
.
ˆˆ 
ThreadJobCalled
ˆˆ *
+=
ˆˆ+ -
new
ˆˆ. 1*
FThreadJobCalledEventHandler
ˆˆ2 N
(
ˆˆN O(
m_fThdMain_ThreadJobCalled
ˆˆO i
)
ˆˆi j
;
ˆˆj k

m_fThdMain
‰‰ 
.
‰‰ 
start
‰‰  
(
‰‰  !
)
‰‰! "
;
‰‰" #
}
ŠŠ 
catch
‹‹ 
(
‹‹ 
	Exception
‹‹ 
ex
‹‹ 
)
‹‹  
{
ŒŒ 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
 
{
 
}
’’ 
}
““ 	
private
—— 
void
—— 
term
—— 
(
—— 
)
˜˜ 
{
™™ 	
try
šš 
{
›› 
if
œœ 
(
œœ 

m_fThdMain
œœ 
!=
œœ !
null
œœ" &
)
œœ& '
{
 

m_fThdMain
 
.
 
stop
 #
(
# $
)
$ %
;
% &

m_fThdMain
ŸŸ 
.
ŸŸ 
Dispose
ŸŸ &
(
ŸŸ& '
)
ŸŸ' (
;
ŸŸ( )

m_fThdMain
   
.
   
ThreadJobCalled
   .
-=
  / 1
new
  2 5*
FThreadJobCalledEventHandler
  6 R
(
  R S(
m_fThdMain_ThreadJobCalled
  S m
)
  m n
;
  n o

m_fThdMain
¡¡ 
=
¡¡  
null
¡¡! %
;
¡¡% &
}
¢¢ 
stop
££ 
(
££ 
)
££ 
;
££ 
if
§§ 
(
§§ 
m_fEventPusher
§§ "
!=
§§# %
null
§§& *
)
§§* +
{
¨¨ 
m_fEventPusher
©© "
.
©©" #(
waitEventHandlingCompleted
©©# =
(
©©= >
)
©©> ?
;
©©? @
m_fEventPusher
ªª "
.
ªª" #
Dispose
ªª# *
(
ªª* +
)
ªª+ ,
;
ªª, -
m_fEventPusher
«« "
=
««# $
null
««% )
;
««) *
}
¬¬ 
if
°° 
(
°° 
m_fSocketFlag
°° !
!=
°°" $
null
°°% )
)
°°) *
{
±± 
m_fSocketFlag
²² !
.
²²! "
Dispose
²²" )
(
²²) *
)
²²* +
;
²²+ ,
m_fSocketFlag
³³ !
=
³³" #
null
³³$ (
;
³³( )
}
´´ 
if
¸¸ 
(
¸¸ 
m_fMainSync
¸¸ 
!=
¸¸  "
null
¸¸# '
)
¸¸' (
{
¹¹ 
m_fMainSync
ºº 
.
ºº  
Dispose
ºº  '
(
ºº' (
)
ºº( )
;
ºº) *
m_fMainSync
»» 
=
»»  !
null
»»" &
;
»»& '
}
¼¼ 
}
½½ 
catch
¾¾ 
(
¾¾ 
	Exception
¾¾ 
ex
¾¾ 
)
¾¾  
{
¿¿ 
FDebug
ÀÀ 
.
ÀÀ 
throwException
ÀÀ %
(
ÀÀ% &
ex
ÀÀ& (
)
ÀÀ( )
;
ÀÀ) *
}
ÁÁ 
finally
ÂÂ 
{
ÃÃ 
}
ÅÅ 
}
ÆÆ 	
public
ÊÊ 
void
ÊÊ 
start
ÊÊ 
(
ÊÊ 
)
ËË 
{
ÌÌ 	
FDebugLogArgs
ÍÍ 
fLogArgs
ÍÍ "
=
ÍÍ# $
null
ÍÍ% )
;
ÍÍ) *
try
ÏÏ 
{
ĞĞ 
m_fMainSync
ÑÑ 
.
ÑÑ 
wait
ÑÑ  
(
ÑÑ  !
)
ÑÑ! "
;
ÑÑ" #
if
ÕÕ 
(
ÕÕ 
	m_started
ÕÕ 
)
ÕÕ 
{
ÖÖ 
FDebug
×× 
.
×× 
throwFException
×× *
(
××* +
string
××+ 1
.
××1 2
Format
××2 8
(
××8 9

FConstants
××9 C
.
××C D

err_m_0001
××D N
,
××N O
$str
××P ^
)
××^ _
)
××_ `
;
××` a
}
ØØ 
fLogArgs
ßß 
=
ßß 
new
ßß 
FDebugLogArgs
ßß ,
(
ßß, -
FDebugLogCategory
ßß- >
.
ßß> ?
Information
ßß? J
,
ßßJ K
$str
ßßL ^
,
ßß^ _
this
ßß` d
.
ßßd e
GetType
ßße l
(
ßßl m
)
ßßm n
,
ßßn o
$str
ßßp w
)
ßßw x
;
ßßx y
FDebug
àà 
.
àà 
writeLog
àà 
(
àà  
fLogArgs
àà  (
)
àà( )
;
àà) *
initTcpListener
ää 
(
ää  
)
ää  !
;
ää! "
	m_started
åå 
=
åå 
true
åå  
;
åå  !
}
ææ 
catch
çç 
(
çç 
	Exception
çç 
ex
çç 
)
çç  
{
èè 
FDebug
éé 
.
éé 
throwException
éé %
(
éé% &
ex
éé& (
)
éé( )
;
éé) *
}
êê 
finally
ëë 
{
ìì 
fLogArgs
íí 
=
íí 
null
íí 
;
íí  
m_fMainSync
îî 
.
îî 
set
îî 
(
îî  
)
îî  !
;
îî! "
}
ïï 
}
ğğ 	
public
ôô 
void
ôô 
stop
ôô 
(
ôô 
)
õõ 
{
öö 	
FDebugLogArgs
÷÷ 
fLogArgs
÷÷ "
=
÷÷# $
null
÷÷% )
;
÷÷) *
try
ùù 
{
úú 
m_fMainSync
ûû 
.
ûû 
wait
ûû  
(
ûû  !
)
ûû! "
;
ûû" #
if
ÿÿ 
(
ÿÿ 
!
ÿÿ 
	m_started
ÿÿ 
)
ÿÿ 
{
€€ 
return
 
;
 
}
‚‚ 
	m_started
†† 
=
†† 
false
†† !
;
††! "
termTcpListener
‡‡ 
(
‡‡  
)
‡‡  !
;
‡‡! "
fLogArgs
 
=
 
new
 
FDebugLogArgs
 ,
(
, -
FDebugLogCategory
- >
.
> ?
Information
? J
,
J K
$str
L ]
,
] ^
this
_ c
.
c d
GetType
d k
(
k l
)
l m
,
m n
$str
o u
)
u v
;
v w
FDebug
 
.
 
writeLog
 
(
  
fLogArgs
  (
)
( )
;
) *
}
 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘ 
ex
‘‘ 
)
‘‘  
{
’’ 
FDebug
““ 
.
““ 
throwException
““ %
(
““% &
ex
““& (
)
““( )
;
““) *
}
”” 
finally
•• 
{
–– 
fLogArgs
—— 
=
—— 
null
—— 
;
——  
m_fMainSync
˜˜ 
.
˜˜ 
set
˜˜ 
(
˜˜  
)
˜˜  !
;
˜˜! "
}
™™ 
}
šš 	
private
 
void
 
initTcpListener
 $
(
$ %
)
ŸŸ 
{
   	
try
¡¡ 
{
¢¢ 
termTcpListener
££ 
(
££  
)
££  !
;
££! "
m_fSocketFlag
§§ 
.
§§ 
init
§§ "
(
§§" #
)
§§# $
;
§§$ %
m_tcpListener
«« 
=
«« 
new
««  #
TcpListener
««$ /
(
««/ 0
Dns
««0 3
.
««3 4
GetHostAddresses
««4 D
(
««D E
	m_localIp
««E N
)
««N O
[
««O P
$num
««P Q
]
««Q R
,
««R S
m_localPort
««T _
)
««_ `
;
««` a
m_tcpListener
¬¬ 
.
¬¬ 
Start
¬¬ #
(
¬¬# $
	m_backlog
¬¬$ -
)
¬¬- .
;
¬¬. /
}
­­ 
catch
®® 
(
®® 
	Exception
®® 
ex
®® 
)
®®  
{
¯¯ 
FDebug
°° 
.
°° 
throwException
°° %
(
°°% &
ex
°°& (
)
°°( )
;
°°) *
}
±± 
finally
²² 
{
³³ 
}
µµ 
}
¶¶ 	
private
ºº 
void
ºº 
termTcpListener
ºº $
(
ºº$ %
)
»» 
{
¼¼ 	
try
½½ 
{
¾¾ 
if
¿¿ 
(
¿¿ 
m_tcpListener
¿¿ !
==
¿¿" $
null
¿¿% )
)
¿¿) *
{
ÀÀ 
return
ÁÁ 
;
ÁÁ 
}
ÂÂ 
m_tcpListener
ÃÃ 
.
ÃÃ 
Stop
ÃÃ "
(
ÃÃ" #
)
ÃÃ# $
;
ÃÃ$ %
m_fSocketFlag
ÊÊ 
.
ÊÊ 
waitAllCompleted
ÊÊ .
(
ÊÊ. /
)
ÊÊ/ 0
;
ÊÊ0 1
m_tcpListener
ÎÎ 
=
ÎÎ 
null
ÎÎ  $
;
ÎÎ$ %
}
ÏÏ 
catch
ĞĞ 
(
ĞĞ 
	Exception
ĞĞ 
ex
ĞĞ 
)
ĞĞ  
{
ÑÑ 
FDebug
ÒÒ 
.
ÒÒ 
throwException
ÒÒ %
(
ÒÒ% &
ex
ÒÒ& (
)
ÒÒ( )
;
ÒÒ) *
}
ÓÓ 
finally
ÔÔ 
{
ÕÕ 
}
×× 
}
ØØ 	
private
ÜÜ 
void
ÜÜ 
doAccept
ÜÜ 
(
ÜÜ 
)
İİ 
{
ŞŞ 	
try
ßß 
{
àà 
m_fSocketFlag
áá 
.
áá 
beginAccept
áá )
(
áá) *
)
áá* +
;
áá+ ,
m_tcpListener
ââ 
.
ââ "
BeginAcceptTcpClient
ââ 2
(
ââ2 3
new
ââ3 6
AsyncCallback
ââ7 D
(
ââD E
doAcceptCallback
ââE U
)
ââU V
,
ââV W
this
ââX \
)
ââ\ ]
;
ââ] ^
}
ãã 
catch
ää 
(
ää 
	Exception
ää 
ex
ää 
)
ää  
{
åå 
if
ææ 
(
ææ 
ex
ææ 
is
ææ 
SocketException
ææ )
)
ææ) *
{
çç "
pushSocketErrorEvent
èè (
(
èè( )
$str
èè) 3
,
èè3 4
(
èè5 6
SocketException
èè6 E
)
èèE F
ex
èèF H
)
èèH I
;
èèI J
}
éé 
else
êê 
if
êê 
(
êê 
ex
êê 
is
êê %
ObjectDisposedException
êê 6
)
êê6 7
{
ëë 
System
ìì 
.
ìì 
Diagnostics
ìì &
.
ìì& '
Debug
ìì' ,
.
ìì, -
	WriteLine
ìì- 6
(
ìì6 7
ex
ìì7 9
.
ìì9 :
ToString
ìì: B
(
ììB C
)
ììC D
)
ììD E
;
ììE F
}
íí 
else
îî 
{
ïï 
pushErrorEvent
ğğ "
(
ğğ" #
ex
ğğ# %
)
ğğ% &
;
ğğ& '
}
ññ 
m_fSocketFlag
òò 
.
òò 
	endAccept
òò '
(
òò' (
)
òò( )
;
òò) *
}
óó 
finally
ôô 
{
õõ 
}
÷÷ 
}
øø 	
private
üü 
void
üü 
doAcceptCallback
üü %
(
üü% &
IAsyncResult
ıı 
ar
ıı 
)
şş 
{
ÿÿ 	
	TcpClient
€€ 
	tcpClient
€€ 
=
€€  !
null
€€" &
;
€€& '
FDebugLogArgs
 
fLogArgs
 "
=
# $
null
% )
;
) *

IPEndPoint
‚‚ 
localIpEndPoint
‚‚ &
=
‚‚' (
null
‚‚) -
;
‚‚- .

IPEndPoint
ƒƒ 
remoteIpEndPoint
ƒƒ '
=
ƒƒ( )
null
ƒƒ* .
;
ƒƒ. /
try
…… 
{
†† 
	tcpClient
‡‡ 
=
‡‡ 
m_tcpListener
‡‡ )
.
‡‡) * 
EndAcceptTcpClient
‡‡* <
(
‡‡< =
ar
‡‡= ?
)
‡‡? @
;
‡‡@ A
localIpEndPoint
ˆˆ 
=
ˆˆ  !
(
ˆˆ" #

IPEndPoint
ˆˆ# -
)
ˆˆ- .
	tcpClient
ˆˆ. 7
.
ˆˆ7 8
Client
ˆˆ8 >
.
ˆˆ> ?
LocalEndPoint
ˆˆ? L
;
ˆˆL M
remoteIpEndPoint
‰‰  
=
‰‰! "
(
‰‰# $

IPEndPoint
‰‰$ .
)
‰‰. /
	tcpClient
‰‰/ 8
.
‰‰8 9
Client
‰‰9 ?
.
‰‰? @
RemoteEndPoint
‰‰@ N
;
‰‰N O
fLogArgs
 
=
 
new
 
FDebugLogArgs
 ,
(
, -
FDebugLogCategory
- >
.
> ?
Information
? J
,
J K
$str
L _
,
_ `
this
a e
.
e f
GetType
f m
(
m n
)
n o
,
o p
$strq ƒ
)ƒ „
;„ …
fLogArgs
‘‘ 
.
‘‘ 
additionInfo
‘‘ %
=
‘‘& '
$str
‘‘( 3
+
‘‘4 5
localIpEndPoint
‘‘6 E
.
‘‘E F
Address
‘‘F M
.
‘‘M N
ToString
‘‘N V
(
‘‘V W
)
‘‘W X
+
‘‘Y Z
$str
‘‘[ k
+
‘‘l m
localIpEndPoint
‘‘n }
.
‘‘} ~
Port‘‘~ ‚
.‘‘‚ ƒ
ToString‘‘ƒ ‹
(‘‘‹ Œ
)‘‘Œ 
+‘‘ 
$str‘‘ Ÿ
+‘‘  ¡ 
remoteIpEndPoint‘‘¢ ²
.‘‘² ³
Address‘‘³ º
.‘‘º »
ToString‘‘» Ã
(‘‘Ã Ä
)‘‘Ä Å
+‘‘Æ Ç
$str‘‘È Ù
+‘‘Ú Û 
remoteIpEndPoint‘‘Ü ì
.‘‘ì í
Port‘‘í ñ
.‘‘ñ ò
ToString‘‘ò ú
(‘‘ú û
)‘‘û ü
+‘‘ı ş
$str‘‘ÿ ‚
;‘‘‚ ƒ
FDebug
’’ 
.
’’ 
writeLog
’’ 
(
’’  
fLogArgs
’’  (
)
’’( )
;
’’) *
m_fEventPusher
–– 
.
–– 
	pushEvent
–– (
(
––( )
new
––) ,2
$FTcpListenerAcceptCompletedEventArgs
––- Q
(
––Q R
this
––R V
,
––V W
new
––X [

FTcpClient
––\ f
(
––f g
	tcpClient
––g p
)
––p q
)
––q r
)
––r s
;
––s t
}
—— 
catch
˜˜ 
(
˜˜ 
	Exception
˜˜ 
ex
˜˜ 
)
˜˜  
{
™™ 
if
šš 
(
šš 
ex
šš 
is
šš 
SocketException
šš )
)
šš) *
{
›› "
pushSocketErrorEvent
œœ (
(
œœ( )
$str
œœ) ;
,
œœ; <
(
œœ= >
SocketException
œœ> M
)
œœM N
ex
œœN P
)
œœP Q
;
œœQ R
}
 
else
 
if
 
(
 
ex
 
is
 %
ObjectDisposedException
 6
)
6 7
{
ŸŸ 
System
   
.
   
Diagnostics
   &
.
  & '
Debug
  ' ,
.
  , -
	WriteLine
  - 6
(
  6 7
ex
  7 9
.
  9 :
ToString
  : B
(
  B C
)
  C D
)
  D E
;
  E F
}
¡¡ 
else
¢¢ 
{
££ 
pushErrorEvent
¤¤ "
(
¤¤" #
ex
¤¤# %
)
¤¤% &
;
¤¤& '
}
¥¥ 
}
¦¦ 
finally
§§ 
{
¨¨ 
	tcpClient
©© 
=
©© 
null
©©  
;
©©  !
fLogArgs
ªª 
=
ªª 
null
ªª 
;
ªª  
localIpEndPoint
«« 
=
««  !
null
««" &
;
««& '
remoteIpEndPoint
¬¬  
=
¬¬! "
null
¬¬# '
;
¬¬' (
m_fSocketFlag
®® 
.
®® 
	endAccept
®® '
(
®®' (
)
®®( )
;
®®) *
}
¯¯ 
}
°° 	
internal
´´ 
void
´´ *
onTcpListenerAcceptCompleted
´´ 2
(
´´2 3"
FSocketEventArgsBase
µµ  
args
µµ! %
)
¶¶ 
{
·· 	
try
¸¸ 
{
¹¹ 
if
ºº 
(
ºº (
TcpListenerAcceptCompleted
ºº .
!=
ºº/ 1
null
ºº2 6
)
ºº6 7
{
»» (
TcpListenerAcceptCompleted
¼¼ .
(
¼¼. /
this
¼¼/ 3
,
¼¼3 4
(
¼¼5 62
$FTcpListenerAcceptCompletedEventArgs
¼¼6 Z
)
¼¼Z [
args
¼¼[ _
)
¼¼_ `
;
¼¼` a
}
½½ 
}
¾¾ 
catch
¿¿ 
(
¿¿ 
	Exception
¿¿ 
ex
¿¿ 
)
¿¿  
{
ÀÀ 
FDebug
ÁÁ 
.
ÁÁ 
writeLog
ÁÁ 
(
ÁÁ  
ex
ÁÁ  "
)
ÁÁ" #
;
ÁÁ# $
}
ÂÂ 
finally
ÃÃ 
{
ÄÄ 
}
ÆÆ 
}
ÇÇ 	
internal
ËË 
void
ËË &
onTcpListenerErrorRaised
ËË .
(
ËË. /"
FSocketEventArgsBase
ÌÌ  
args
ÌÌ! %
)
ÍÍ 
{
ÎÎ 	
try
ÏÏ 
{
ĞĞ 
if
ÑÑ 
(
ÑÑ $
TcpListenerErrorRaised
ÑÑ *
!=
ÑÑ+ -
null
ÑÑ. 2
)
ÑÑ2 3
{
ÒÒ $
TcpListenerErrorRaised
ÓÓ *
(
ÓÓ* +
this
ÓÓ+ /
,
ÓÓ/ 0
(
ÓÓ1 2.
 FTcpListenerErrorRaisedEventArgs
ÓÓ2 R
)
ÓÓR S
args
ÓÓS W
)
ÓÓW X
;
ÓÓX Y
}
ÔÔ 
}
ÕÕ 
catch
ÖÖ 
(
ÖÖ 
	Exception
ÖÖ 
ex
ÖÖ 
)
ÖÖ  
{
×× 
FDebug
ØØ 
.
ØØ 
writeLog
ØØ 
(
ØØ  
ex
ØØ  "
)
ØØ" #
;
ØØ# $
}
ÙÙ 
finally
ÚÚ 
{
ÛÛ 
}
İİ 
}
ŞŞ 	
private
ææ 
void
ææ (
m_fThdMain_ThreadJobCalled
ææ /
(
ææ/ 0
object
çç 
sender
çç 
,
çç 
FThreadEventArgs
èè 
e
èè 
)
éé 
{
êê 	
bool
ëë 
waited
ëë 
=
ëë 
false
ëë 
;
ëë  
try
íí 
{
îî 
waited
ïï 
=
ïï 
m_fMainSync
ïï $
.
ïï$ %
tryWait
ïï% ,
(
ïï, -
$num
ïï- .
)
ïï. /
;
ïï/ 0
if
ğğ 
(
ğğ 
!
ğğ 
waited
ğğ 
)
ğğ 
{
ññ 
return
òò 
;
òò 
}
óó 
if
÷÷ 
(
÷÷ 
	m_started
÷÷ 
)
÷÷ 
{
øø 
if
ùù 
(
ùù 
m_fSocketFlag
ùù %
.
ùù% &
doAcceptCompleted
ùù& 7
)
ùù7 8
{
úú 
doAccept
ûû  
(
ûû  !
)
ûû! "
;
ûû" #
return
üü 
;
üü 
}
ıı 
}
şş 
e
‚‚ 
.
‚‚ 
sleepThread
‚‚ 
(
‚‚ 
$num
‚‚ 
)
‚‚  
;
‚‚  !
}
ƒƒ 
catch
„„ 
(
„„ 
	Exception
„„ 
ex
„„ 
)
„„  
{
…… 
pushErrorEvent
†† 
(
†† 
ex
†† !
)
††! "
;
††" #
}
‡‡ 
finally
ˆˆ 
{
‰‰ 
if
ŠŠ 
(
ŠŠ 
waited
ŠŠ 
)
ŠŠ 
{
‹‹ 
m_fMainSync
ŒŒ 
.
ŒŒ  
set
ŒŒ  #
(
ŒŒ# $
)
ŒŒ$ %
;
ŒŒ% &
}
 
}
 
}
 	
}
•• 
}–– Å¸
RD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Ftp\c_FFtp.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FFtp 
: 
IDisposable #
{ 
delegate 
FFtpDirectoryEntry #
	ParseLine$ -
(- .
string. 4
lines5 :
): ;
;; <
private 
const 
string 
	ftpString &
=' (
$str) 1
;1 2
private   
const   
string   
ForwardSlash   )
=  * +
$str  , /
;  / 0
private!! 
const!! 
string!! 
	BackSlash!! &
=!!' (
$str!!) -
;!!- .
private## 
bool## 

m_disposed## 
=##  !
false##" '
;##' (
private%% 
string%% 

m_userName%% !
;%%! "
private&& 
string&& 

m_password&& !
;&&! "
private'' 
string'' 
m_domain'' 
;''  
private(( 
string(( 
m_cwd(( 
=(( 
string(( %
.((% &
Empty((& +
;((+ ,
private)) 
char)) 
[)) 
])) 
	m_slashes))  
=))! "
{))# $
$char))% (
,))( )
$char))* .
}))/ 0
;))0 1
private-- 
bool-- 
m_isPassiveMode-- $
=--% &
false--' ,
;--, -
private33 
enum33 
FtpDirectoryFormat33 '
{44 	
Windows55 
,55 
Unknown66 
}77 	
public?? 
FFtp?? 
(?? 
bool@@ 
isPassiveMode@@ 
,@@ 
stringAA 
urlBaseStringAA  
)BB 
{CC 	
m_isPassiveModeDD 
=DD 
isPassiveModeDD +
;DD+ ,

m_userNameEE 
=EE 
$strEE $
;EE$ %

m_passwordFF 
=FF 
$strFF 
;FF 
setUrlGG 
(GG 
urlBaseStringGG  
)GG  !
;GG! "
}HH 	
publicLL 
FFtpLL 
(LL 
boolMM 
isPassiveModeMM 
,MM 
stringNN 
urlBaseStringNN  
,NN  !
stringOO 
usernameOO 
,OO 
stringPP 
passwordPP 
)QQ 
:RR 
thisRR 
(RR 
isPassiveModeRR  
,RR  !
urlBaseStringRR" /
)RR/ 0
{SS 	

m_userNameTT 
=TT 
usernameTT !
;TT! "

m_passwordUU 
=UU 
passwordUU !
;UU! "
}VV 	
~ZZ 	
FFtpZZ	 
(ZZ 
)[[ 
{\\ 	
	myDispose]] 
(]] 
false]] 
)]] 
;]] 
}^^ 	
privatebb 
voidbb 
	myDisposebb 
(bb 
boolcc 
	disposingcc 
)dd 
{ee 	
ifff 
(ff 
!ff 

m_disposedff 
)ff 
{gg 
ifhh 
(hh 
	disposinghh 
)hh 
{ii 
}kk 

m_disposedll 
=ll 
truell !
;ll! "
}mm 
}nn 	
publicvv 
voidvv 
Disposevv 
(vv 
)ww 
{xx 	
	myDisposeyy 
(yy 
trueyy 
)yy 
;yy 
GCzz 
.zz 
SuppressFinalizezz 
(zz  
thiszz  $
)zz$ %
;zz% &
}{{ 	
public
‰‰ 
void
‰‰ 
uploadFiles
‰‰ 
(
‰‰  
params
ŠŠ 
string
ŠŠ 
[
ŠŠ 
]
ŠŠ 
paths
ŠŠ !
)
‹‹ 
{
ŒŒ 	
FtpWebRequest
 

ftpRequest
 $
;
$ %
FtpWebResponse
 
ftpResponse
 &
;
& '
FileInfo
 
info
 
;
 

FileStream
 
instream
 
;
  
Stream
‘‘ 
	outstream
‘‘ 
;
‘‘ 
int
’’ 
bufferLength
’’ 
;
’’ 
int
““ 
	bytesRead
““ 
;
““ 
byte
”” 
[
”” 
]
”” 
buffer
”” 
;
”” 
try
–– 
{
—— 
foreach
˜˜ 
(
˜˜ 
string
˜˜ 
path
˜˜  $
in
˜˜% '
paths
˜˜( -
)
˜˜- .
{
™™ 

ftpRequest
šš 
=
šš  

getRequest
šš! +
(
šš+ ,
Path
šš, 0
.
šš0 1
GetFileName
šš1 <
(
šš< =
path
šš= A
)
ššA B
)
ššB C
;
ššC D

ftpRequest
›› 
.
›› 
Method
›› %
=
››& '
WebRequestMethods
››( 9
.
››9 :
Ftp
››: =
.
››= >

UploadFile
››> H
;
››H I

ftpRequest
œœ 
.
œœ 
	UseBinary
œœ (
=
œœ) *
true
œœ+ /
;
œœ/ 0
info
 
=
 
new
 
FileInfo
 '
(
' (
path
( ,
)
, -
;
- .

ftpRequest
ŸŸ 
.
ŸŸ 
ContentLength
ŸŸ ,
=
ŸŸ- .
info
ŸŸ/ 3
.
ŸŸ3 4
Length
ŸŸ4 :
;
ŸŸ: ;
bufferLength
¡¡  
=
¡¡! "
$num
¡¡# (
;
¡¡( )
buffer
¢¢ 
=
¢¢ 
new
¢¢  
byte
¢¢! %
[
¢¢% &
bufferLength
¢¢& 2
]
¢¢2 3
;
¢¢3 4
using
¤¤ 
(
¤¤ 
instream
¤¤ #
=
¤¤$ %
info
¤¤& *
.
¤¤* +
OpenRead
¤¤+ 3
(
¤¤3 4
)
¤¤4 5
)
¤¤5 6
{
¥¥ 
using
¦¦ 
(
¦¦ 
	outstream
¦¦ (
=
¦¦) *

ftpRequest
¦¦+ 5
.
¦¦5 6
GetRequestStream
¦¦6 F
(
¦¦F G
)
¦¦G H
)
¦¦H I
{
§§ 
	bytesRead
¨¨ %
=
¨¨& '
instream
¨¨( 0
.
¨¨0 1
Read
¨¨1 5
(
¨¨5 6
buffer
¨¨6 <
,
¨¨< =
$num
¨¨> ?
,
¨¨? @
bufferLength
¨¨A M
)
¨¨M N
;
¨¨N O
while
ªª !
(
ªª" #
	bytesRead
ªª# ,
>
ªª- .
$num
ªª/ 0
)
ªª0 1
{
«« 
	outstream
¬¬  )
.
¬¬) *
Write
¬¬* /
(
¬¬/ 0
buffer
¬¬0 6
,
¬¬6 7
$num
¬¬8 9
,
¬¬9 :
	bytesRead
¬¬; D
)
¬¬D E
;
¬¬E F
	bytesRead
­­  )
=
­­* +
instream
­­, 4
.
­­4 5
Read
­­5 9
(
­­9 :
buffer
­­: @
,
­­@ A
$num
­­B C
,
­­C D
bufferLength
­­E Q
)
­­Q R
;
­­R S
}
®® 
	outstream
¯¯ %
.
¯¯% &
Close
¯¯& +
(
¯¯+ ,
)
¯¯, -
;
¯¯- .
}
°° 
instream
±±  
.
±±  !
Close
±±! &
(
±±& '
)
±±' (
;
±±( )
}
²² 
ftpResponse
³³ 
=
³³  !
(
³³" #
FtpWebResponse
³³# 1
)
³³1 2

ftpRequest
³³2 <
.
³³< =
GetResponse
³³= H
(
³³H I
)
³³I J
;
³³J K
ftpResponse
´´ 
.
´´  
Close
´´  %
(
´´% &
)
´´& '
;
´´' (
}
µµ 
}
¶¶ 
catch
·· 
(
·· 
	Exception
·· 
ex
·· 
)
··  
{
¸¸ 
FDebug
¹¹ 
.
¹¹ 
throwException
¹¹ %
(
¹¹% &
ex
¹¹& (
)
¹¹( )
;
¹¹) *
}
ºº 
finally
»» 
{
¼¼ 
}
¾¾ 
}
¿¿ 	
public
ÃÃ 
void
ÃÃ  
uploadFilesOverSSL
ÃÃ &
(
ÃÃ& '
params
ÄÄ 
string
ÄÄ 
[
ÄÄ 
]
ÄÄ 
paths
ÄÄ !
)
ÅÅ 
{
ÆÆ 	
FtpWebRequest
ÇÇ 

ftpRequest
ÇÇ $
;
ÇÇ$ %
FtpWebResponse
ÈÈ 
ftpResponse
ÈÈ &
;
ÈÈ& '
FileInfo
ÉÉ 
info
ÉÉ 
;
ÉÉ 

FileStream
ÊÊ 
instream
ÊÊ 
;
ÊÊ  
Stream
ËË 
	outstream
ËË 
;
ËË 
int
ÌÌ 
bufferLength
ÌÌ 
;
ÌÌ 
int
ÍÍ 
	bytesRead
ÍÍ 
;
ÍÍ 
byte
ÎÎ 
[
ÎÎ 
]
ÎÎ 
buffer
ÎÎ 
;
ÎÎ 
try
ĞĞ 
{
ÑÑ 
foreach
ÒÒ 
(
ÒÒ 
string
ÒÒ 
path
ÒÒ  $
in
ÒÒ% '
paths
ÒÒ( -
)
ÒÒ- .
{
ÓÓ 

ftpRequest
ÔÔ 
=
ÔÔ  

getRequest
ÔÔ! +
(
ÔÔ+ ,
Path
ÔÔ, 0
.
ÔÔ0 1
GetFileName
ÔÔ1 <
(
ÔÔ< =
path
ÔÔ= A
)
ÔÔA B
)
ÔÔB C
;
ÔÔC D

ftpRequest
ÕÕ 
.
ÕÕ 
Method
ÕÕ %
=
ÕÕ& '
WebRequestMethods
ÕÕ( 9
.
ÕÕ9 :
Ftp
ÕÕ: =
.
ÕÕ= >

UploadFile
ÕÕ> H
;
ÕÕH I

ftpRequest
ÖÖ 
.
ÖÖ 
	UseBinary
ÖÖ (
=
ÖÖ) *
true
ÖÖ+ /
;
ÖÖ/ 0
info
ØØ 
=
ØØ 
new
ØØ 
FileInfo
ØØ '
(
ØØ' (
path
ØØ( ,
)
ØØ, -
;
ØØ- .

ftpRequest
ÙÙ 
.
ÙÙ 
ContentLength
ÙÙ ,
=
ÙÙ- .
info
ÙÙ/ 3
.
ÙÙ3 4
Length
ÙÙ4 :
;
ÙÙ: ;
bufferLength
ÛÛ  
=
ÛÛ! "
$num
ÛÛ# (
;
ÛÛ( )
buffer
ÜÜ 
=
ÜÜ 
new
ÜÜ  
byte
ÜÜ! %
[
ÜÜ% &
bufferLength
ÜÜ& 2
]
ÜÜ2 3
;
ÜÜ3 4
using
ŞŞ 
(
ŞŞ 
instream
ŞŞ #
=
ŞŞ$ %
info
ŞŞ& *
.
ŞŞ* +
OpenRead
ŞŞ+ 3
(
ŞŞ3 4
)
ŞŞ4 5
)
ŞŞ5 6
{
ßß 
using
àà 
(
àà 
	outstream
àà (
=
àà) *

ftpRequest
àà+ 5
.
àà5 6
GetRequestStream
àà6 F
(
ààF G
)
ààG H
)
ààH I
{
áá 
	bytesRead
ââ %
=
ââ& '
instream
ââ( 0
.
ââ0 1
Read
ââ1 5
(
ââ5 6
buffer
ââ6 <
,
ââ< =
$num
ââ> ?
,
ââ? @
bufferLength
ââA M
)
ââM N
;
ââN O
while
ää !
(
ää" #
	bytesRead
ää# ,
>
ää- .
$num
ää/ 0
)
ää0 1
{
åå 
	outstream
ææ  )
.
ææ) *
Write
ææ* /
(
ææ/ 0
buffer
ææ0 6
,
ææ6 7
$num
ææ8 9
,
ææ9 :
	bytesRead
ææ; D
)
ææD E
;
ææE F
	bytesRead
çç  )
=
çç* +
instream
çç, 4
.
çç4 5
Read
çç5 9
(
çç9 :
buffer
çç: @
,
çç@ A
$num
ççB C
,
ççC D
bufferLength
ççE Q
)
ççQ R
;
ççR S
}
èè 
	outstream
éé %
.
éé% &
Close
éé& +
(
éé+ ,
)
éé, -
;
éé- .
}
êê 
instream
ëë  
.
ëë  !
Close
ëë! &
(
ëë& '
)
ëë' (
;
ëë( )
}
ìì 

ftpRequest
ññ 
.
ññ 
	EnableSsl
ññ (
=
ññ) *
true
ññ+ /
;
ññ/ 0!
ServicePointManager
òò '
.
òò' (1
#ServerCertificateValidationCallback
òò( K
=
òòL M
new
òòN Q1
#RemoteCertificateValidationCallback
òòR u
(
òòu v#
AcceptCertificationsòòv Š
)òòŠ ‹
;òò‹ Œ!
ServicePointManager
óó '
.
óó' (
Expect100Continue
óó( 9
=
óó: ;
true
óó< @
;
óó@ A
ftpResponse
÷÷ 
=
÷÷  !
(
÷÷" #
FtpWebResponse
÷÷# 1
)
÷÷1 2

ftpRequest
÷÷2 <
.
÷÷< =
GetResponse
÷÷= H
(
÷÷H I
)
÷÷I J
;
÷÷J K
ftpResponse
øø 
.
øø  
Close
øø  %
(
øø% &
)
øø& '
;
øø' (
}
ùù 
}
úú 
catch
ûû 
(
ûû 
	Exception
ûû 
ex
ûû 
)
ûû  
{
üü 
FDebug
ıı 
.
ıı 
throwException
ıı %
(
ıı% &
ex
ıı& (
)
ıı( )
;
ıı) *
}
şş 
finally
ÿÿ 
{
€€ 
}
‚‚ 
}
ƒƒ 	
public
‡‡ 
void
‡‡ 
downloadFiles
‡‡ !
(
‡‡! "
string
ˆˆ 
path
ˆˆ 
,
ˆˆ 
params
‰‰ 
string
‰‰ 
[
‰‰ 
]
‰‰ 
files
‰‰ !
)
ŠŠ 
{
‹‹ 	
FtpWebRequest
ŒŒ 

ftpRequest
ŒŒ $
;
ŒŒ$ %
FtpWebResponse
 
ftpResponse
 &
;
& '
Stream
 
instream
 
;
 
int
 

buffLength
 
;
 
int
 
	bytesRead
 
;
 
byte
‘‘ 
[
‘‘ 
]
‘‘ 
buffer
‘‘ 
;
‘‘ 
try
““ 
{
”” 
foreach
•• 
(
•• 
string
•• 
file
••  $
in
••% '
files
••( -
)
••- .
{
–– 

ftpRequest
—— 
=
——  

getRequest
——! +
(
——+ ,
file
——, 0
)
——0 1
;
——1 2

ftpRequest
˜˜ 
.
˜˜ 
Method
˜˜ %
=
˜˜& '
WebRequestMethods
˜˜( 9
.
˜˜9 :
Ftp
˜˜: =
.
˜˜= >
DownloadFile
˜˜> J
;
˜˜J K

ftpRequest
™™ 
.
™™ 
	UseBinary
™™ (
=
™™) *
true
™™+ /
;
™™/ 0
using
›› 
(
›› 

FileStream
›› %
	outstream
››& /
=
››0 1
new
››2 5

FileStream
››6 @
(
››@ A
Path
››A E
.
››E F
Combine
››F M
(
››M N
path
››N R
,
››R S
Path
››T X
.
››X Y
GetFileName
››Y d
(
››d e
file
››e i
)
››i j
)
››j k
,
››k l
FileMode
››m u
.
››u v
Create
››v |
)
››| }
)
››} ~
{
œœ 
ftpResponse
 #
=
$ %
(
& '
FtpWebResponse
' 5
)
5 6

ftpRequest
6 @
.
@ A
GetResponse
A L
(
L M
)
M N
;
N O
using
 
(
 
instream
 '
=
( )
ftpResponse
* 5
.
5 6
GetResponseStream
6 G
(
G H
)
H I
)
I J
{
ŸŸ 

buffLength
   &
=
  ' (
$num
  ) .
;
  . /
buffer
¡¡ "
=
¡¡# $
new
¡¡% (
byte
¡¡) -
[
¡¡- .

buffLength
¡¡. 8
]
¡¡8 9
;
¡¡9 :
	bytesRead
££ %
=
££& '
instream
££( 0
.
££0 1
Read
££1 5
(
££5 6
buffer
££6 <
,
££< =
$num
££> ?
,
££? @

buffLength
££A K
)
££K L
;
££L M
while
¥¥ !
(
¥¥" #
	bytesRead
¥¥# ,
>
¥¥- .
$num
¥¥/ 0
)
¥¥0 1
{
¦¦ 
	outstream
§§  )
.
§§) *
Write
§§* /
(
§§/ 0
buffer
§§0 6
,
§§6 7
$num
§§8 9
,
§§9 :
	bytesRead
§§; D
)
§§D E
;
§§E F
	bytesRead
¨¨  )
=
¨¨* +
instream
¨¨, 4
.
¨¨4 5
Read
¨¨5 9
(
¨¨9 :
buffer
¨¨: @
,
¨¨@ A
$num
¨¨B C
,
¨¨C D

buffLength
¨¨E O
)
¨¨O P
;
¨¨P Q
}
©© 
instream
ªª $
.
ªª$ %
Close
ªª% *
(
ªª* +
)
ªª+ ,
;
ªª, -
}
«« 
	outstream
¬¬ !
.
¬¬! "
Close
¬¬" '
(
¬¬' (
)
¬¬( )
;
¬¬) *
ftpResponse
­­ #
.
­­# $
Close
­­$ )
(
­­) *
)
­­* +
;
­­+ ,
}
®® 
}
¯¯ 
}
°° 
catch
±± 
(
±± 
	Exception
±± 
ex
±± 
)
±±  
{
²² 
FDebug
³³ 
.
³³ 
throwException
³³ %
(
³³% &
ex
³³& (
)
³³( )
;
³³) *
}
´´ 
finally
µµ 
{
¶¶ 
}
¸¸ 
}
¹¹ 	
public
½½ 
void
½½ "
downloadFilesOverSSL
½½ (
(
½½( )
string
¾¾ 
path
¾¾ 
,
¾¾ 
params
¿¿ 
string
¿¿ 
[
¿¿ 
]
¿¿ 
files
¿¿ !
)
ÀÀ 
{
ÁÁ 	
FtpWebRequest
ÂÂ 

ftpRequest
ÂÂ $
;
ÂÂ$ %
FtpWebResponse
ÃÃ 
ftpResponse
ÃÃ &
;
ÃÃ& '
Stream
ÄÄ 
instream
ÄÄ 
;
ÄÄ 
int
ÅÅ 

buffLength
ÅÅ 
;
ÅÅ 
int
ÆÆ 
	bytesRead
ÆÆ 
;
ÆÆ 
byte
ÇÇ 
[
ÇÇ 
]
ÇÇ 
buffer
ÇÇ 
;
ÇÇ 
try
ÉÉ 
{
ÊÊ 
foreach
ËË 
(
ËË 
string
ËË 
file
ËË  $
in
ËË% '
files
ËË( -
)
ËË- .
{
ÌÌ 

ftpRequest
ÍÍ 
=
ÍÍ  

getRequest
ÍÍ! +
(
ÍÍ+ ,
file
ÍÍ, 0
)
ÍÍ0 1
;
ÍÍ1 2

ftpRequest
ÎÎ 
.
ÎÎ 
Method
ÎÎ %
=
ÎÎ& '
WebRequestMethods
ÎÎ( 9
.
ÎÎ9 :
Ftp
ÎÎ: =
.
ÎÎ= >
DownloadFile
ÎÎ> J
;
ÎÎJ K

ftpRequest
ÏÏ 
.
ÏÏ 
	UseBinary
ÏÏ (
=
ÏÏ) *
true
ÏÏ+ /
;
ÏÏ/ 0
using
ÑÑ 
(
ÑÑ 

FileStream
ÑÑ %
	outstream
ÑÑ& /
=
ÑÑ0 1
new
ÑÑ2 5

FileStream
ÑÑ6 @
(
ÑÑ@ A
Path
ÑÑA E
.
ÑÑE F
Combine
ÑÑF M
(
ÑÑM N
path
ÑÑN R
,
ÑÑR S
file
ÑÑT X
)
ÑÑX Y
,
ÑÑY Z
FileMode
ÑÑ[ c
.
ÑÑc d
Create
ÑÑd j
)
ÑÑj k
)
ÑÑk l
{
ÒÒ 

ftpRequest
ÖÖ "
.
ÖÖ" #
	EnableSsl
ÖÖ# ,
=
ÖÖ- .
true
ÖÖ/ 3
;
ÖÖ3 4!
ServicePointManager
×× +
.
××+ ,1
#ServerCertificateValidationCallback
××, O
=
××P Q
new
××R U1
#RemoteCertificateValidationCallback
××V y
(
××y z#
AcceptCertifications××z 
)×× 
;×× !
ServicePointManager
ØØ +
.
ØØ+ ,
Expect100Continue
ØØ, =
=
ØØ> ?
true
ØØ@ D
;
ØØD E
ftpResponse
ÜÜ #
=
ÜÜ$ %
(
ÜÜ& '
FtpWebResponse
ÜÜ' 5
)
ÜÜ5 6

ftpRequest
ÜÜ6 @
.
ÜÜ@ A
GetResponse
ÜÜA L
(
ÜÜL M
)
ÜÜM N
;
ÜÜN O
using
İİ 
(
İİ 
instream
İİ '
=
İİ( )
ftpResponse
İİ* 5
.
İİ5 6
GetResponseStream
İİ6 G
(
İİG H
)
İİH I
)
İİI J
{
ŞŞ 

buffLength
ßß &
=
ßß' (
$num
ßß) .
;
ßß. /
buffer
àà "
=
àà# $
new
àà% (
byte
àà) -
[
àà- .

buffLength
àà. 8
]
àà8 9
;
àà9 :
	bytesRead
ââ %
=
ââ& '
instream
ââ( 0
.
ââ0 1
Read
ââ1 5
(
ââ5 6
buffer
ââ6 <
,
ââ< =
$num
ââ> ?
,
ââ? @

buffLength
ââA K
)
ââK L
;
ââL M
while
ää !
(
ää" #
	bytesRead
ää# ,
>
ää- .
$num
ää/ 0
)
ää0 1
{
åå 
	outstream
ææ  )
.
ææ) *
Write
ææ* /
(
ææ/ 0
buffer
ææ0 6
,
ææ6 7
$num
ææ8 9
,
ææ9 :
	bytesRead
ææ; D
)
ææD E
;
ææE F
	bytesRead
çç  )
=
çç* +
instream
çç, 4
.
çç4 5
Read
çç5 9
(
çç9 :
buffer
çç: @
,
çç@ A
$num
ççB C
,
ççC D

buffLength
ççE O
)
ççO P
;
ççP Q
}
èè 
instream
éé $
.
éé$ %
Close
éé% *
(
éé* +
)
éé+ ,
;
éé, -
}
êê 
	outstream
ëë !
.
ëë! "
Close
ëë" '
(
ëë' (
)
ëë( )
;
ëë) *
ftpResponse
ìì #
.
ìì# $
Close
ìì$ )
(
ìì) *
)
ìì* +
;
ìì+ ,
}
íí 
}
îî 
}
ïï 
catch
ğğ 
(
ğğ 
	Exception
ğğ 
ex
ğğ 
)
ğğ  
{
ññ 
FDebug
òò 
.
òò 
throwException
òò %
(
òò% &
ex
òò& (
)
òò( )
;
òò) *
}
óó 
finally
ôô 
{
õõ 
}
÷÷ 
}
øø 	
public
üü 
void
üü 
downloadFiles
üü !
(
üü! "
string
ıı 
path
ıı 
,
ıı 
string
şş 
file
şş 
,
şş 
bool
ÿÿ 

deleteFlag
ÿÿ 
)
€€ 
{
 	
try
‚‚ 
{
ƒƒ 
downloadFiles
„„ 
(
„„ 
path
„„ "
,
„„" #
file
„„$ (
)
„„( )
;
„„) *
if
…… 
(
…… 

deleteFlag
…… 
==
…… !
true
……" &
)
……& '
{
†† 
deleteFiles
‡‡ 
(
‡‡  
file
‡‡  $
)
‡‡$ %
;
‡‡% &
}
ˆˆ 
}
‰‰ 
catch
ŠŠ 
(
ŠŠ 
	Exception
ŠŠ 
ex
ŠŠ 
)
ŠŠ  
{
‹‹ 
FDebug
ŒŒ 
.
ŒŒ 
throwException
ŒŒ %
(
ŒŒ% &
ex
ŒŒ& (
)
ŒŒ( )
;
ŒŒ) *
}
 
finally
 
{
 
}
‘‘ 
}
’’ 	
public
–– 
void
–– "
downloadFilesOverSSL
–– (
(
––( )
string
—— 
path
—— 
,
—— 
string
˜˜ 
file
˜˜ 
,
˜˜ 
bool
™™ 

deleteFlag
™™ 
)
šš 
{
›› 	
try
œœ 
{
 
downloadFiles
 
(
 
path
 "
,
" #
file
$ (
)
( )
;
) *
if
ŸŸ 
(
ŸŸ 

deleteFlag
ŸŸ 
==
ŸŸ !
true
ŸŸ" &
)
ŸŸ& '
{
    
deleteFilesOverSSL
¡¡ &
(
¡¡& '
file
¡¡' +
)
¡¡+ ,
;
¡¡, -
}
¢¢ 
}
££ 
catch
¤¤ 
(
¤¤ 
	Exception
¤¤ 
ex
¤¤ 
)
¤¤  
{
¥¥ 
FDebug
¦¦ 
.
¦¦ 
throwException
¦¦ %
(
¦¦% &
ex
¦¦& (
)
¦¦( )
;
¦¦) *
}
§§ 
finally
¨¨ 
{
©© 
}
«« 
}
¬¬ 	
public
°° 
void
°° 
deleteFiles
°° 
(
°°  
params
±± 
string
±± 
[
±± 
]
±± 
files
±± !
)
²² 
{
³³ 	
FtpWebRequest
´´ 

ftpRequest
´´ $
=
´´% &
null
´´' +
;
´´+ ,
FtpWebResponse
µµ 
ftpResponse
µµ &
=
µµ' (
null
µµ) -
;
µµ- .
try
·· 
{
¸¸ 
foreach
¹¹ 
(
¹¹ 
string
¹¹ 
file
¹¹  $
in
¹¹% '
files
¹¹( -
)
¹¹- .
{
ºº 

ftpRequest
»» 
=
»»  

getRequest
»»! +
(
»»+ ,
file
»», 0
)
»»0 1
;
»»1 2

ftpRequest
¼¼ 
.
¼¼ 
Method
¼¼ %
=
¼¼& '
WebRequestMethods
¼¼( 9
.
¼¼9 :
Ftp
¼¼: =
.
¼¼= >

DeleteFile
¼¼> H
;
¼¼H I
ftpResponse
½½ 
=
½½  !
(
½½" #
FtpWebResponse
½½# 1
)
½½1 2

ftpRequest
½½2 <
.
½½< =
GetResponse
½½= H
(
½½H I
)
½½I J
;
½½J K
ftpResponse
¾¾ 
.
¾¾  
Close
¾¾  %
(
¾¾% &
)
¾¾& '
;
¾¾' (
}
¿¿ 
}
ÀÀ 
catch
ÁÁ 
(
ÁÁ 
	Exception
ÁÁ 
ex
ÁÁ 
)
ÁÁ  
{
ÂÂ 
FDebug
ÃÃ 
.
ÃÃ 
throwException
ÃÃ %
(
ÃÃ% &
ex
ÃÃ& (
)
ÃÃ( )
;
ÃÃ) *
}
ÄÄ 
finally
ÅÅ 
{
ÆÆ 
if
ÇÇ 
(
ÇÇ 
ftpResponse
ÇÇ 
!=
ÇÇ  "
null
ÇÇ# '
)
ÇÇ' (
{
ÈÈ 
ftpResponse
ÉÉ 
.
ÉÉ  
Close
ÉÉ  %
(
ÉÉ% &
)
ÉÉ& '
;
ÉÉ' (
ftpResponse
ÊÊ 
=
ÊÊ  !
null
ÊÊ" &
;
ÊÊ& '
}
ËË 

ftpRequest
ÌÌ 
=
ÌÌ 
null
ÌÌ !
;
ÌÌ! "
}
ÍÍ 
}
ÎÎ 	
public
ÒÒ 
void
ÒÒ  
deleteFilesOverSSL
ÒÒ &
(
ÒÒ& '
params
ÓÓ 
string
ÓÓ 
[
ÓÓ 
]
ÓÓ 
files
ÓÓ !
)
ÔÔ 
{
ÕÕ 	
FtpWebRequest
ÖÖ 

ftpRequest
ÖÖ $
=
ÖÖ% &
null
ÖÖ' +
;
ÖÖ+ ,
FtpWebResponse
×× 
ftpResponse
×× &
=
××' (
null
××) -
;
××- .
try
ÙÙ 
{
ÚÚ 
foreach
ÛÛ 
(
ÛÛ 
string
ÛÛ 
file
ÛÛ  $
in
ÛÛ% '
files
ÛÛ( -
)
ÛÛ- .
{
ÜÜ 

ftpRequest
İİ 
=
İİ  

getRequest
İİ! +
(
İİ+ ,
file
İİ, 0
)
İİ0 1
;
İİ1 2

ftpRequest
ŞŞ 
.
ŞŞ 
Method
ŞŞ %
=
ŞŞ& '
WebRequestMethods
ŞŞ( 9
.
ŞŞ9 :
Ftp
ŞŞ: =
.
ŞŞ= >

DeleteFile
ŞŞ> H
;
ŞŞH I

ftpRequest
ãã 
.
ãã 
	EnableSsl
ãã (
=
ãã) *
true
ãã+ /
;
ãã/ 0!
ServicePointManager
ää '
.
ää' (1
#ServerCertificateValidationCallback
ää( K
=
ääL M
new
ääN Q1
#RemoteCertificateValidationCallback
ääR u
(
ääu v#
AcceptCertificationsääv Š
)ääŠ ‹
;ää‹ Œ!
ServicePointManager
åå '
.
åå' (
Expect100Continue
åå( 9
=
åå: ;
true
åå< @
;
åå@ A
ftpResponse
éé 
=
éé  !
(
éé" #
FtpWebResponse
éé# 1
)
éé1 2

ftpRequest
éé2 <
.
éé< =
GetResponse
éé= H
(
ééH I
)
ééI J
;
ééJ K
ftpResponse
êê 
.
êê  
Close
êê  %
(
êê% &
)
êê& '
;
êê' (
}
ëë 
}
ìì 
catch
íí 
(
íí 
	Exception
íí 
ex
íí 
)
íí  
{
îî 
FDebug
ïï 
.
ïï 
throwException
ïï %
(
ïï% &
ex
ïï& (
)
ïï( )
;
ïï) *
}
ğğ 
finally
ññ 
{
òò 
if
óó 
(
óó 
ftpResponse
óó 
!=
óó  "
null
óó# '
)
óó' (
{
ôô 
ftpResponse
õõ 
.
õõ  
Close
õõ  %
(
õõ% &
)
õõ& '
;
õõ' (
ftpResponse
öö 
=
öö  !
null
öö" &
;
öö& '
}
÷÷ 

ftpRequest
øø 
=
øø 
null
øø !
;
øø! "
}
ùù 
}
úú 	
public
şş 
void
şş 
createDirectory
şş #
(
şş# $
string
ÿÿ 
	directory
ÿÿ 
)
€€ 
{
 	
FtpWebRequest
‚‚ 

ftpRequest
‚‚ $
;
‚‚$ %
FtpWebResponse
ƒƒ 
ftpResponse
ƒƒ &
;
ƒƒ& '
List
„„ 
<
„„ 
string
„„ 
>
„„ 
paths
„„ 
;
„„ 
string
…… 
[
…… 
]
…… 
steps
…… 
;
…… 
int
†† 
createIndex
†† 
;
†† 
try
ˆˆ 
{
‰‰ 
	directory
‹‹ 
=
‹‹ 
applyDirectory
‹‹ *
(
‹‹* +
	directory
‹‹+ 4
)
‹‹4 5
;
‹‹5 6
steps
 
=
 
	directory
 !
.
! "
Split
" '
(
' (
new
( +
char
, 0
[
0 1
]
1 2
{
3 4
$char
5 8
}
9 :
,
: ; 
StringSplitOptions
< N
.
N O 
RemoveEmptyEntries
O a
)
a b
;
b c
paths
‘‘ 
=
‘‘ 
new
‘‘ 
List
‘‘  
<
‘‘  !
string
‘‘! '
>
‘‘' (
(
‘‘( )
)
‘‘) *
;
‘‘* +
for
’’ 
(
’’ 
int
’’ 
i
’’ 
=
’’ 
$num
’’ 
;
’’ 
i
’’  !
<=
’’" $
steps
’’% *
.
’’* +
Length
’’+ 1
;
’’1 2
i
’’3 4
++
’’4 6
)
’’6 7
{
““ 
paths
”” 
.
”” 
Add
”” 
(
”” 
ForwardSlash
”” *
+
””+ ,
String
””- 3
.
””3 4
Join
””4 8
(
””8 9
ForwardSlash
””9 E
,
””E F
steps
””G L
,
””L M
$num
””N O
,
””O P
i
””Q R
)
””R S
)
””S T
;
””T U
}
•• 
for
˜˜ 
(
˜˜ 
createIndex
˜˜  
=
˜˜! "
paths
˜˜# (
.
˜˜( )
Count
˜˜) .
;
˜˜. /
createIndex
˜˜0 ;
>
˜˜< =
$num
˜˜> ?
;
˜˜? @
createIndex
˜˜A L
--
˜˜L N
)
˜˜N O
{
™™ 
if
šš 
(
šš 
directoryExists
šš '
(
šš' (
paths
šš( -
[
šš- .
createIndex
šš. 9
-
šš: ;
$num
šš< =
]
šš= >
)
šš> ?
)
šš? @
{
›› 
break
œœ 
;
œœ 
}
 
}
 
for
¡¡ 
(
¡¡ 
createIndex
¡¡  
=
¡¡! "
$num
¡¡# $
;
¡¡$ %
createIndex
¡¡& 1
<
¡¡2 3
paths
¡¡4 9
.
¡¡9 :
Count
¡¡: ?
;
¡¡? @
createIndex
¡¡A L
++
¡¡L N
)
¡¡N O
{
¢¢ 

ftpRequest
££ 
=
££  

getRequest
££! +
(
££+ ,
paths
££, 1
[
££1 2
createIndex
££2 =
]
££= >
)
££> ?
;
££? @

ftpRequest
¤¤ 
.
¤¤ 
Method
¤¤ %
=
¤¤& '
WebRequestMethods
¤¤( 9
.
¤¤9 :
Ftp
¤¤: =
.
¤¤= >
MakeDirectory
¤¤> K
;
¤¤K L
ftpResponse
¥¥ 
=
¥¥  !
(
¥¥" #
FtpWebResponse
¥¥# 1
)
¥¥1 2

ftpRequest
¥¥2 <
.
¥¥< =
GetResponse
¥¥= H
(
¥¥H I
)
¥¥I J
;
¥¥J K
ftpResponse
¦¦ 
.
¦¦  
Close
¦¦  %
(
¦¦% &
)
¦¦& '
;
¦¦' (
}
§§ 
}
¨¨ 
catch
©© 
(
©© 
	Exception
©© 
ex
©© 
)
©©  
{
ªª 
FDebug
«« 
.
«« 
throwException
«« %
(
««% &
ex
««& (
)
««( )
;
««) *
}
¬¬ 
finally
­­ 
{
®® 
}
°° 
}
±± 	
public
µµ 
void
µµ $
createDirectoryOverSSL
µµ *
(
µµ* +
string
¶¶ 
	directory
¶¶ 
)
·· 
{
¸¸ 	
FtpWebRequest
¹¹ 

ftpRequest
¹¹ $
;
¹¹$ %
FtpWebResponse
ºº 
ftpResponse
ºº &
;
ºº& '
List
»» 
<
»» 
string
»» 
>
»» 
paths
»» 
;
»» 
string
¼¼ 
[
¼¼ 
]
¼¼ 
steps
¼¼ 
;
¼¼ 
int
½½ 
createIndex
½½ 
;
½½ 
try
¿¿ 
{
ÀÀ 
	directory
ÂÂ 
=
ÂÂ 
applyDirectory
ÂÂ *
(
ÂÂ* +
	directory
ÂÂ+ 4
)
ÂÂ4 5
;
ÂÂ5 6
steps
ÅÅ 
=
ÅÅ 
	directory
ÅÅ !
.
ÅÅ! "
Split
ÅÅ" '
(
ÅÅ' (
new
ÅÅ( +
char
ÅÅ, 0
[
ÅÅ0 1
]
ÅÅ1 2
{
ÅÅ3 4
$char
ÅÅ5 8
}
ÅÅ9 :
,
ÅÅ: ; 
StringSplitOptions
ÅÅ< N
.
ÅÅN O 
RemoveEmptyEntries
ÅÅO a
)
ÅÅa b
;
ÅÅb c
paths
ÈÈ 
=
ÈÈ 
new
ÈÈ 
List
ÈÈ  
<
ÈÈ  !
string
ÈÈ! '
>
ÈÈ' (
(
ÈÈ( )
)
ÈÈ) *
;
ÈÈ* +
for
ÉÉ 
(
ÉÉ 
int
ÉÉ 
i
ÉÉ 
=
ÉÉ 
$num
ÉÉ 
;
ÉÉ 
i
ÉÉ  !
<=
ÉÉ" $
steps
ÉÉ% *
.
ÉÉ* +
Length
ÉÉ+ 1
;
ÉÉ1 2
i
ÉÉ3 4
++
ÉÉ4 6
)
ÉÉ6 7
{
ÊÊ 
paths
ËË 
.
ËË 
Add
ËË 
(
ËË 
ForwardSlash
ËË *
+
ËË+ ,
String
ËË- 3
.
ËË3 4
Join
ËË4 8
(
ËË8 9
ForwardSlash
ËË9 E
,
ËËE F
steps
ËËG L
,
ËËL M
$num
ËËN O
,
ËËO P
i
ËËQ R
)
ËËR S
)
ËËS T
;
ËËT U
}
ÌÌ 
for
ÏÏ 
(
ÏÏ 
createIndex
ÏÏ  
=
ÏÏ! "
paths
ÏÏ# (
.
ÏÏ( )
Count
ÏÏ) .
;
ÏÏ. /
createIndex
ÏÏ0 ;
>
ÏÏ< =
$num
ÏÏ> ?
;
ÏÏ? @
createIndex
ÏÏA L
--
ÏÏL N
)
ÏÏN O
{
ĞĞ 
if
ÑÑ 
(
ÑÑ 
directoryExists
ÑÑ '
(
ÑÑ' (
paths
ÑÑ( -
[
ÑÑ- .
createIndex
ÑÑ. 9
-
ÑÑ: ;
$num
ÑÑ< =
]
ÑÑ= >
)
ÑÑ> ?
)
ÑÑ? @
{
ÒÒ 
break
ÓÓ 
;
ÓÓ 
}
ÔÔ 
}
ÕÕ 
for
ØØ 
(
ØØ 
createIndex
ØØ  
=
ØØ! "
$num
ØØ# $
;
ØØ$ %
createIndex
ØØ& 1
<
ØØ2 3
paths
ØØ4 9
.
ØØ9 :
Count
ØØ: ?
;
ØØ? @
createIndex
ØØA L
++
ØØL N
)
ØØN O
{
ÙÙ 

ftpRequest
ÚÚ 
=
ÚÚ  

getRequest
ÚÚ! +
(
ÚÚ+ ,
paths
ÚÚ, 1
[
ÚÚ1 2
createIndex
ÚÚ2 =
]
ÚÚ= >
)
ÚÚ> ?
;
ÚÚ? @

ftpRequest
ÛÛ 
.
ÛÛ 
Method
ÛÛ %
=
ÛÛ& '
WebRequestMethods
ÛÛ( 9
.
ÛÛ9 :
Ftp
ÛÛ: =
.
ÛÛ= >
MakeDirectory
ÛÛ> K
;
ÛÛK L

ftpRequest
àà 
.
àà 
	EnableSsl
àà (
=
àà) *
true
àà+ /
;
àà/ 0!
ServicePointManager
áá '
.
áá' (1
#ServerCertificateValidationCallback
áá( K
=
ááL M
new
ááN Q1
#RemoteCertificateValidationCallback
ááR u
(
ááu v#
AcceptCertificationsááv Š
)ááŠ ‹
;áá‹ Œ!
ServicePointManager
ââ '
.
ââ' (
Expect100Continue
ââ( 9
=
ââ: ;
true
ââ< @
;
ââ@ A
ftpResponse
ææ 
=
ææ  !
(
ææ" #
FtpWebResponse
ææ# 1
)
ææ1 2

ftpRequest
ææ2 <
.
ææ< =
GetResponse
ææ= H
(
ææH I
)
ææI J
;
ææJ K
ftpResponse
çç 
.
çç  
Close
çç  %
(
çç% &
)
çç& '
;
çç' (
}
èè 
}
éé 
catch
êê 
(
êê 
	Exception
êê 
ex
êê 
)
êê  
{
ëë 
FDebug
ìì 
.
ìì 
throwException
ìì %
(
ìì% &
ex
ìì& (
)
ìì( )
;
ìì) *
}
íí 
finally
îî 
{
ïï 
}
ññ 
}
òò 	
public
öö 
void
öö 
deleteDirectory
öö #
(
öö# $
string
÷÷ 
	directory
÷÷ 
)
øø 
{
ùù 	
FtpWebRequest
úú 

ftpRequest
úú $
;
úú$ %
FtpWebResponse
ûû 
ftpResponse
ûû &
;
ûû& '
try
ıı 
{
şş 

ftpRequest
ÿÿ 
=
ÿÿ 

getRequest
ÿÿ '
(
ÿÿ' (
	directory
ÿÿ( 1
)
ÿÿ1 2
;
ÿÿ2 3

ftpRequest
€€ 
.
€€ 
Method
€€ !
=
€€" #
WebRequestMethods
€€$ 5
.
€€5 6
Ftp
€€6 9
.
€€9 :
RemoveDirectory
€€: I
;
€€I J
ftpResponse
 
=
 
(
 
FtpWebResponse
 -
)
- .

ftpRequest
. 8
.
8 9
GetResponse
9 D
(
D E
)
E F
;
F G
ftpResponse
‚‚ 
.
‚‚ 
Close
‚‚ !
(
‚‚! "
)
‚‚" #
;
‚‚# $
}
ƒƒ 
catch
„„ 
(
„„ 
	Exception
„„ 
ex
„„ 
)
„„  
{
…… 
FDebug
†† 
.
†† 
throwException
†† %
(
††% &
ex
††& (
)
††( )
;
††) *
}
‡‡ 
finally
ˆˆ 
{
‰‰ 
}
‹‹ 
}
ŒŒ 	
public
 
void
 $
deleteDirectoryOverSSL
 *
(
* +
string
‘‘ 
	directory
‘‘ 
)
’’ 
{
““ 	
FtpWebRequest
”” 

ftpRequest
”” $
;
””$ %
FtpWebResponse
•• 
ftpResponse
•• &
;
••& '
try
—— 
{
˜˜ 

ftpRequest
™™ 
=
™™ 

getRequest
™™ '
(
™™' (
	directory
™™( 1
)
™™1 2
;
™™2 3

ftpRequest
šš 
.
šš 
Method
šš !
=
šš" #
WebRequestMethods
šš$ 5
.
šš5 6
Ftp
šš6 9
.
šš9 :
RemoveDirectory
šš: I
;
ššI J

ftpRequest
ŸŸ 
.
ŸŸ 
	EnableSsl
ŸŸ $
=
ŸŸ% &
true
ŸŸ' +
;
ŸŸ+ ,!
ServicePointManager
   #
.
  # $1
#ServerCertificateValidationCallback
  $ G
=
  H I
new
  J M1
#RemoteCertificateValidationCallback
  N q
(
  q r#
AcceptCertifications  r †
)  † ‡
;  ‡ ˆ!
ServicePointManager
¡¡ #
.
¡¡# $
Expect100Continue
¡¡$ 5
=
¡¡6 7
true
¡¡8 <
;
¡¡< =
ftpResponse
¥¥ 
=
¥¥ 
(
¥¥ 
FtpWebResponse
¥¥ -
)
¥¥- .

ftpRequest
¥¥. 8
.
¥¥8 9
GetResponse
¥¥9 D
(
¥¥D E
)
¥¥E F
;
¥¥F G
ftpResponse
¦¦ 
.
¦¦ 
Close
¦¦ !
(
¦¦! "
)
¦¦" #
;
¦¦# $
}
§§ 
catch
¨¨ 
(
¨¨ 
	Exception
¨¨ 
ex
¨¨ 
)
¨¨  
{
©© 
FDebug
ªª 
.
ªª 
throwException
ªª %
(
ªª% &
ex
ªª& (
)
ªª( )
;
ªª) *
}
«« 
finally
¬¬ 
{
­­ 
}
¯¯ 
}
°° 	
public
´´ *
FFtpDirectoryEntryCollection
´´ +*
fFtpDirectoryEntryCollection
´´, H
(
´´H I
)
µµ 
{
¶¶ 	
FtpWebRequest
·· 

ftpRequest
·· $
;
··$ %
FtpWebResponse
¸¸ 
ftpResponse
¸¸ &
;
¸¸& '
StreamReader
¹¹ 
streamReader
¹¹ %
;
¹¹% &
string
ºº 
listing
ºº 
;
ºº 
try
¼¼ 
{
½½ 

ftpRequest
¾¾ 
=
¾¾ 

getRequest
¾¾ '
(
¾¾' (
$str
¾¾( *
)
¾¾* +
;
¾¾+ ,

ftpRequest
¿¿ 
.
¿¿ 
Method
¿¿ !
=
¿¿" #
WebRequestMethods
¿¿$ 5
.
¿¿5 6
Ftp
¿¿6 9
.
¿¿9 :"
ListDirectoryDetails
¿¿: N
;
¿¿N O
using
ÁÁ 
(
ÁÁ 
ftpResponse
ÁÁ "
=
ÁÁ# $

ftpRequest
ÁÁ% /
.
ÁÁ/ 0
GetResponse
ÁÁ0 ;
(
ÁÁ; <
)
ÁÁ< =
as
ÁÁ> @
FtpWebResponse
ÁÁA O
)
ÁÁO P
{
ÂÂ 
streamReader
ÃÃ  
=
ÃÃ! "
new
ÃÃ# &
StreamReader
ÃÃ' 3
(
ÃÃ3 4
ftpResponse
ÃÃ4 ?
.
ÃÃ? @
GetResponseStream
ÃÃ@ Q
(
ÃÃQ R
)
ÃÃR S
,
ÃÃS T
System
ÃÃU [
.
ÃÃ[ \
Text
ÃÃ\ `
.
ÃÃ` a
Encoding
ÃÃa i
.
ÃÃi j
UTF8
ÃÃj n
)
ÃÃn o
;
ÃÃo p
listing
ÄÄ 
=
ÄÄ 
streamReader
ÄÄ *
.
ÄÄ* +
	ReadToEnd
ÄÄ+ 4
(
ÄÄ4 5
)
ÄÄ5 6
;
ÄÄ6 7
ftpResponse
ÅÅ 
.
ÅÅ  
Close
ÅÅ  %
(
ÅÅ% &
)
ÅÅ& '
;
ÅÅ' (
}
ÆÆ 
return
ÇÇ #
parseDirectoryListing
ÇÇ ,
(
ÇÇ, -
listing
ÇÇ- 4
)
ÇÇ4 5
;
ÇÇ5 6
}
ÈÈ 
catch
ÉÉ 
(
ÉÉ 
	Exception
ÉÉ 
ex
ÉÉ 
)
ÉÉ  
{
ÊÊ 
FDebug
ËË 
.
ËË 
throwException
ËË %
(
ËË% &
ex
ËË& (
)
ËË( )
;
ËË) *
}
ÌÌ 
finally
ÍÍ 
{
ÎÎ 
}
ĞĞ 
return
ÑÑ 
null
ÑÑ 
;
ÑÑ 
}
ÒÒ 	
public
ÖÖ *
FFtpDirectoryEntryCollection
ÖÖ +1
#fFtpDirectoryEntryCollectionOverSSL
ÖÖ, O
(
ÖÖO P
)
×× 
{
ØØ 	
FtpWebRequest
ÙÙ 

ftpRequest
ÙÙ $
;
ÙÙ$ %
FtpWebResponse
ÚÚ 
ftpResponse
ÚÚ &
;
ÚÚ& '
StreamReader
ÛÛ 
streamReader
ÛÛ %
;
ÛÛ% &
string
ÜÜ 
listing
ÜÜ 
;
ÜÜ 
try
ŞŞ 
{
ßß 

ftpRequest
àà 
=
àà 

getRequest
àà '
(
àà' (
$str
àà( *
)
àà* +
;
àà+ ,

ftpRequest
áá 
.
áá 
Method
áá !
=
áá" #
WebRequestMethods
áá$ 5
.
áá5 6
Ftp
áá6 9
.
áá9 :"
ListDirectoryDetails
áá: N
;
ááN O

ftpRequest
ææ 
.
ææ 
	EnableSsl
ææ $
=
ææ% &
true
ææ' +
;
ææ+ ,!
ServicePointManager
çç #
.
çç# $1
#ServerCertificateValidationCallback
çç$ G
=
ççH I
new
ççJ M1
#RemoteCertificateValidationCallback
ççN q
(
ççq r#
AcceptCertificationsççr †
)çç† ‡
;çç‡ ˆ!
ServicePointManager
èè #
.
èè# $
Expect100Continue
èè$ 5
=
èè6 7
true
èè8 <
;
èè< =
using
ìì 
(
ìì 
ftpResponse
ìì "
=
ìì# $

ftpRequest
ìì% /
.
ìì/ 0
GetResponse
ìì0 ;
(
ìì; <
)
ìì< =
as
ìì> @
FtpWebResponse
ììA O
)
ììO P
{
íí 
streamReader
îî  
=
îî! "
new
îî# &
StreamReader
îî' 3
(
îî3 4
ftpResponse
îî4 ?
.
îî? @
GetResponseStream
îî@ Q
(
îîQ R
)
îîR S
,
îîS T
System
îîU [
.
îî[ \
Text
îî\ `
.
îî` a
Encoding
îîa i
.
îîi j
UTF8
îîj n
)
îîn o
;
îîo p
listing
ïï 
=
ïï 
streamReader
ïï *
.
ïï* +
	ReadToEnd
ïï+ 4
(
ïï4 5
)
ïï5 6
;
ïï6 7
ftpResponse
ğğ 
.
ğğ  
Close
ğğ  %
(
ğğ% &
)
ğğ& '
;
ğğ' (
}
ññ 
return
òò #
parseDirectoryListing
òò ,
(
òò, -
listing
òò- 4
)
òò4 5
;
òò5 6
}
óó 
catch
ôô 
(
ôô 
	Exception
ôô 
ex
ôô 
)
ôô  
{
õõ 
FDebug
öö 
.
öö 
throwException
öö %
(
öö% &
ex
öö& (
)
öö( )
;
öö) *
}
÷÷ 
finally
øø 
{
ùù 
}
ûû 
return
üü 
null
üü 
;
üü 
}
ıı 	
public
 *
FFtpDirectoryEntryCollection
 +*
fFtpDirectoryEntryCollection
, H
(
H I
string
‚‚ 
url
‚‚ 
)
ƒƒ 
{
„„ 	
try
…… 
{
†† 
setUrl
‡‡ 
(
‡‡ 
url
‡‡ 
)
‡‡ 
;
‡‡ 
return
ˆˆ *
fFtpDirectoryEntryCollection
ˆˆ 3
(
ˆˆ3 4
)
ˆˆ4 5
;
ˆˆ5 6
}
‰‰ 
catch
ŠŠ 
(
ŠŠ 
	Exception
ŠŠ 
ex
ŠŠ 
)
ŠŠ  
{
‹‹ 
FDebug
ŒŒ 
.
ŒŒ 
throwException
ŒŒ %
(
ŒŒ% &
ex
ŒŒ& (
)
ŒŒ( )
;
ŒŒ) *
}
 
finally
 
{
 
}
‘‘ 
return
’’ 
null
’’ 
;
’’ 
}
““ 	
public
—— *
FFtpDirectoryEntryCollection
—— +1
#fFtpDirectoryEntryCollectionOverSSL
——, O
(
——O P
string
˜˜ 
url
˜˜ 
)
™™ 
{
šš 	
try
›› 
{
œœ 
setUrl
 
(
 
url
 
)
 
;
 
return
 1
#fFtpDirectoryEntryCollectionOverSSL
 :
(
: ;
)
; <
;
< =
}
ŸŸ 
catch
   
(
   
	Exception
   
ex
   
)
    
{
¡¡ 
FDebug
¢¢ 
.
¢¢ 
throwException
¢¢ %
(
¢¢% &
ex
¢¢& (
)
¢¢( )
;
¢¢) *
}
££ 
finally
¤¤ 
{
¥¥ 
}
§§ 
return
¨¨ 
null
¨¨ 
;
¨¨ 
}
©© 	
private
­­ 
bool
­­ 
directoryExists
­­ $
(
­­$ %
string
®® 
	directory
®® 
)
¯¯ 
{
°° 	
FtpWebRequest
±± 

ftpRequest
±± $
;
±±$ %
FtpWebResponse
²² 
ftpResponse
²² &
;
²²& '
StreamReader
³³ 
streamReader
³³ %
;
³³% &
try
µµ 
{
¶¶ 

ftpRequest
·· 
=
·· 

getRequest
·· '
(
··' (
	directory
··( 1
)
··1 2
;
··2 3

ftpRequest
¸¸ 
.
¸¸ 
Method
¸¸ !
=
¸¸" #
WebRequestMethods
¸¸$ 5
.
¸¸5 6
Ftp
¸¸6 9
.
¸¸9 :
ListDirectory
¸¸: G
;
¸¸G H
using
ºº 
(
ºº 
ftpResponse
ºº "
=
ºº# $

ftpRequest
ºº% /
.
ºº/ 0
GetResponse
ºº0 ;
(
ºº; <
)
ºº< =
as
ºº> @
FtpWebResponse
ººA O
)
ººO P
{
»» 
streamReader
¼¼  
=
¼¼! "
new
¼¼# &
StreamReader
¼¼' 3
(
¼¼3 4
ftpResponse
¼¼4 ?
.
¼¼? @
GetResponseStream
¼¼@ Q
(
¼¼Q R
)
¼¼R S
,
¼¼S T
System
¼¼T Z
.
¼¼Z [
Text
¼¼[ _
.
¼¼_ `
Encoding
¼¼` h
.
¼¼h i
UTF8
¼¼i m
)
¼¼m n
;
¼¼n o
streamReader
½½  
.
½½  !
	ReadToEnd
½½! *
(
½½* +
)
½½+ ,
;
½½, -
streamReader
¾¾  
.
¾¾  !
Close
¾¾! &
(
¾¾& '
)
¾¾' (
;
¾¾( )
ftpResponse
¿¿ 
.
¿¿  
Close
¿¿  %
(
¿¿% &
)
¿¿& '
;
¿¿' (
}
ÀÀ 
return
ÁÁ 
true
ÁÁ 
;
ÁÁ 
}
ÂÂ 
catch
ÃÃ 
(
ÃÃ 
	Exception
ÃÃ 
ex
ÃÃ 
)
ÃÃ  
{
ÄÄ 
FDebug
ÅÅ 
.
ÅÅ 
throwException
ÅÅ %
(
ÅÅ% &
ex
ÅÅ& (
)
ÅÅ( )
;
ÅÅ) *
}
ÆÆ 
finally
ÇÇ 
{
ÈÈ 
}
ÊÊ 
return
ËË 
false
ËË 
;
ËË 
}
ÌÌ 	
private
ĞĞ 
bool
ĞĞ $
directoryExistsOverSSL
ĞĞ +
(
ĞĞ+ ,
string
ÑÑ 
	directory
ÑÑ 
)
ÒÒ 
{
ÓÓ 	
FtpWebRequest
ÔÔ 

ftpRequest
ÔÔ $
;
ÔÔ$ %
FtpWebResponse
ÕÕ 
ftpResponse
ÕÕ &
;
ÕÕ& '
StreamReader
ÖÖ 
streamReader
ÖÖ %
;
ÖÖ% &
try
ØØ 
{
ÙÙ 

ftpRequest
ÚÚ 
=
ÚÚ 

getRequest
ÚÚ '
(
ÚÚ' (
	directory
ÚÚ( 1
)
ÚÚ1 2
;
ÚÚ2 3

ftpRequest
ÛÛ 
.
ÛÛ 
Method
ÛÛ !
=
ÛÛ" #
WebRequestMethods
ÛÛ$ 5
.
ÛÛ5 6
Ftp
ÛÛ6 9
.
ÛÛ9 :
ListDirectory
ÛÛ: G
;
ÛÛG H

ftpRequest
àà 
.
àà 
	EnableSsl
àà $
=
àà% &
true
àà' +
;
àà+ ,!
ServicePointManager
áá #
.
áá# $1
#ServerCertificateValidationCallback
áá$ G
=
ááH I
new
ááJ M1
#RemoteCertificateValidationCallback
ááN q
(
ááq r#
AcceptCertificationsáár †
)áá† ‡
;áá‡ ˆ!
ServicePointManager
ââ #
.
ââ# $
Expect100Continue
ââ$ 5
=
ââ6 7
true
ââ8 <
;
ââ< =
using
ææ 
(
ææ 
ftpResponse
ææ "
=
ææ# $

ftpRequest
ææ% /
.
ææ/ 0
GetResponse
ææ0 ;
(
ææ; <
)
ææ< =
as
ææ> @
FtpWebResponse
ææA O
)
ææO P
{
çç 
streamReader
èè  
=
èè! "
new
èè# &
StreamReader
èè' 3
(
èè3 4
ftpResponse
èè4 ?
.
èè? @
GetResponseStream
èè@ Q
(
èèQ R
)
èèR S
,
èèS T
System
èèU [
.
èè[ \
Text
èè\ `
.
èè` a
Encoding
èèa i
.
èèi j
UTF8
èèj n
)
èèn o
;
èèo p
streamReader
éé  
.
éé  !
	ReadToEnd
éé! *
(
éé* +
)
éé+ ,
;
éé, -
streamReader
êê  
.
êê  !
Close
êê! &
(
êê& '
)
êê' (
;
êê( )
ftpResponse
ëë 
.
ëë  
Close
ëë  %
(
ëë% &
)
ëë& '
;
ëë' (
}
ìì 
return
íí 
true
íí 
;
íí 
}
îî 
catch
ïï 
(
ïï 
	Exception
ïï 
ex
ïï 
)
ïï  
{
ğğ 
FDebug
ññ 
.
ññ 
throwException
ññ %
(
ññ% &
ex
ññ& (
)
ññ( )
;
ññ) *
}
òò 
finally
óó 
{
ôô 
}
öö 
return
÷÷ 
false
÷÷ 
;
÷÷ 
}
øø 	
private
üü 
void
üü 
setUrl
üü 
(
üü 
string
ıı 
url
ıı 
)
şş 
{
ÿÿ 	
int
€€ 
pos
€€ 
;
€€ 
try
‚‚ 
{
ƒƒ 
pos
…… 
=
…… 
url
…… 
.
…… 
IndexOf
…… !
(
……! "
$str
……" *
)
……* +
;
……+ ,
pos
†† 
=
†† 
url
†† 
.
†† 

IndexOfAny
†† $
(
††$ %
	m_slashes
††% .
,
††. /
(
††0 1
pos
††1 4
<
††5 6
$num
††7 8
)
††8 9
?
††: ;
$num
††< =
:
††> ?
pos
††@ C
+
††D E
$num
††F G
)
††G H
;
††H I
if
ˆˆ 
(
ˆˆ 
pos
ˆˆ 
<
ˆˆ 
$num
ˆˆ 
)
ˆˆ 
{
‰‰ 
m_domain
ŠŠ 
=
ŠŠ 
	ftpString
ŠŠ (
+
ŠŠ( )
url
ŠŠ) ,
;
ŠŠ, -
m_cwd
‹‹ 
=
‹‹ 
ForwardSlash
‹‹ (
;
‹‹( )
}
ŒŒ 
else
 
{
 
m_domain
 
=
 
url
 "
.
" #
	Substring
# ,
(
, -
$num
- .
,
. /
pos
0 3
)
3 4
;
4 5
m_cwd
‘‘ 
=
‘‘ 
applyDirectory
‘‘ *
(
‘‘* +
url
‘‘+ .
.
‘‘. /
	Substring
‘‘/ 8
(
‘‘8 9
pos
‘‘9 <
)
‘‘< =
)
‘‘= >
;
‘‘> ?
}
’’ 
}
““ 
catch
”” 
(
”” 
	Exception
”” 
ex
”” 
)
””  
{
•• 
FDebug
–– 
.
–– 
throwException
–– %
(
––% &
ex
––& (
)
––( )
;
––) *
}
—— 
finally
˜˜ 
{
™™ 
}
›› 
}
œœ 	
private
   
string
   
getUrl
   
(
   
string
¡¡ 
	directory
¡¡ 
)
¢¢ 
{
££ 	
try
¤¤ 
{
¥¥ 
if
¦¦ 
(
¦¦ 
	directory
¦¦ 
.
¦¦ 
Length
¦¦ $
==
¦¦% '
$num
¦¦( )
)
¦¦) *
{
§§ 
return
¨¨ 
m_domain
¨¨ #
+
¨¨$ %
m_cwd
¨¨& +
;
¨¨+ ,
}
©© 
return
ªª 
m_domain
ªª 
+
ªª  !
applyDirectory
ªª" 0
(
ªª0 1
	directory
ªª1 :
)
ªª: ;
;
ªª; <
}
«« 
catch
¬¬ 
(
¬¬ 
	Exception
¬¬ 
ex
¬¬ 
)
¬¬  
{
­­ 
FDebug
®® 
.
®® 
throwException
®® %
(
®®% &
ex
®®& (
)
®®( )
;
®®) *
}
¯¯ 
finally
°° 
{
±± 
}
³³ 
return
´´ 
string
´´ 
.
´´ 
Empty
´´ 
;
´´  
}
µµ 	
private
¹¹ 
string
¹¹ 
applyDirectory
¹¹ %
(
¹¹% &
string
ºº 
	directory
ºº 
)
»» 
{
¼¼ 	
int
½½ 
pos
½½ 
;
½½ 
try
¿¿ 
{
ÀÀ 
	directory
ÂÂ 
=
ÂÂ 
	directory
ÂÂ %
.
ÂÂ% &
Trim
ÂÂ& *
(
ÂÂ* +
)
ÂÂ+ ,
;
ÂÂ, -
	directory
ÃÃ 
=
ÃÃ 
	directory
ÃÃ %
.
ÃÃ% &
Replace
ÃÃ& -
(
ÃÃ- .
	BackSlash
ÃÃ. 7
,
ÃÃ7 8
ForwardSlash
ÃÃ9 E
)
ÃÃE F
;
ÃÃF G
	directory
ÄÄ 
=
ÄÄ 
	directory
ÄÄ %
.
ÄÄ% &
TrimEnd
ÄÄ& -
(
ÄÄ- .
	m_slashes
ÄÄ. 7
)
ÄÄ7 8
;
ÄÄ8 9
if
ÆÆ 
(
ÆÆ 
	directory
ÆÆ 
==
ÆÆ  
$str
ÆÆ! %
)
ÆÆ% &
{
ÇÇ 
pos
ÈÈ 
=
ÈÈ 
m_cwd
ÈÈ 
.
ÈÈ  
LastIndexOf
ÈÈ  +
(
ÈÈ+ ,
ForwardSlash
ÈÈ, 8
)
ÈÈ8 9
;
ÈÈ9 :
return
ÉÉ 
(
ÉÉ 
pos
ÉÉ 
<=
ÉÉ  "
$num
ÉÉ# $
)
ÉÉ$ %
?
ÉÉ& '
ForwardSlash
ÉÉ( 4
:
ÉÉ5 6
m_cwd
ÉÉ7 <
.
ÉÉ< =
	Substring
ÉÉ= F
(
ÉÉF G
$num
ÉÉG H
,
ÉÉH I
pos
ÉÉJ M
)
ÉÉM N
;
ÉÉN O
}
ÊÊ 
else
ËË 
if
ËË 
(
ËË 
m_cwd
ËË 
==
ËË !
string
ËË" (
.
ËË( )
Empty
ËË) .
&&
ËË/ 1
	directory
ËË2 ;
.
ËË; <

StartsWith
ËË< F
(
ËËF G
ForwardSlash
ËËG S
)
ËËS T
)
ËËT U
{
ÌÌ 
return
ÎÎ 
	directory
ÎÎ $
;
ÎÎ$ %
}
ÏÏ 
else
ĞĞ 
{
ÑÑ 
if
ÓÓ 
(
ÓÓ 
m_cwd
ÓÓ 
==
ÓÓ  
ForwardSlash
ÓÓ! -
)
ÓÓ- .
{
ÔÔ 
return
ÕÕ 
m_cwd
ÕÕ $
+
ÕÕ% &
	directory
ÕÕ' 0
;
ÕÕ0 1
}
ÖÖ 
}
×× 
return
ØØ 
m_cwd
ØØ 
+
ØØ 
ForwardSlash
ØØ +
+
ØØ, -
	directory
ØØ. 7
;
ØØ7 8
}
ÙÙ 
catch
ÚÚ 
(
ÚÚ 
	Exception
ÚÚ 
ex
ÚÚ 
)
ÚÚ  
{
ÛÛ 
FDebug
ÜÜ 
.
ÜÜ 
throwException
ÜÜ %
(
ÜÜ% &
ex
ÜÜ& (
)
ÜÜ( )
;
ÜÜ) *
}
İİ 
finally
ŞŞ 
{
ßß 
}
áá 
return
ââ 
string
ââ 
.
ââ 
Empty
ââ 
;
ââ  
}
ãã 	
private
çç 
FtpWebRequest
çç 

getRequest
çç (
(
çç( )
string
èè 
fileName
èè 
)
éé 
{
êê 	
FtpWebRequest
ëë 

ftpRequest
ëë $
;
ëë$ %
string
ìì 
url
ìì 
;
ìì 
try
îî 
{
ïï 
url
ğğ 
=
ğğ 
getUrl
ğğ 
(
ğğ 
fileName
ğğ %
)
ğğ% &
;
ğğ& '
if
òò 
(
òò 
url
òò 
.
òò 
IndexOf
òò 
(
òò  
	ftpString
òò  )
)
òò) *
<
òò+ ,
$num
òò- .
)
òò. /
{
óó 
url
ôô 
=
ôô 
	ftpString
ôô #
+
ôô$ %
url
ôô& )
;
ôô) *
}
õõ 

ftpRequest
÷÷ 
=
÷÷ 

WebRequest
÷÷ '
.
÷÷' (
Create
÷÷( .
(
÷÷. /
url
÷÷/ 2
)
÷÷2 3
as
÷÷4 6
FtpWebRequest
÷÷7 D
;
÷÷D E

ftpRequest
øø 
.
øø 
Credentials
øø &
=
øø' (
new
øø) ,
NetworkCredential
øø- >
(
øø> ?

m_userName
øø? I
,
øøI J

m_password
øøK U
)
øøU V
;
øøV W

ftpRequest
ùù 
.
ùù 
Proxy
ùù  
=
ùù! "
null
ùù# '
;
ùù' (

ftpRequest
úú 
.
úú 

UsePassive
úú %
=
úú& '
m_isPassiveMode
úú( 7
;
úú7 8

ftpRequest
ûû 
.
ûû 
	KeepAlive
ûû $
=
ûû% &
false
ûû' ,
;
ûû, -
return
üü 

ftpRequest
üü !
;
üü! "
}
ıı 
catch
şş 
(
şş 
	Exception
şş 
ex
şş 
)
şş  
{
ÿÿ 
FDebug
€€ 
.
€€ 
throwException
€€ %
(
€€% &
ex
€€& (
)
€€( )
;
€€) *
}
 
finally
‚‚ 
{
ƒƒ 
}
…… 
return
†† 
null
†† 
;
†† 
}
‡‡ 	
private
‹‹ *
FFtpDirectoryEntryCollection
‹‹ ,#
parseDirectoryListing
‹‹- B
(
‹‹B C
string
ŒŒ 
listing
ŒŒ 
)
 
{
 	
	ParseLine
 
parseFunction
 #
;
# $

Dictionary
 
<
 
string
 
,
  
FFtpDirectoryEntry
 1
>
1 2
	entryDict
3 <
;
< =
List
‘‘ 
<
‘‘  
FFtpDirectoryEntry
‘‘ #
>
‘‘# $
	entryList
‘‘% .
;
‘‘. / 
FtpDirectoryFormat
’’ 
format
’’ %
;
’’% & 
FFtpDirectoryEntry
““ 
entry
““ $
;
““$ %
string
”” 
[
”” 
]
”” 
lines
”” 
;
”” 
try
–– 
{
—— 
parseFunction
˜˜ 
=
˜˜ 
null
˜˜  $
;
˜˜$ %
	entryDict
™™ 
=
™™ 
new
™™ 

Dictionary
™™  *
<
™™* +
string
™™+ 1
,
™™1 2 
FFtpDirectoryEntry
™™3 E
>
™™E F
(
™™F G
)
™™G H
;
™™H I
	entryList
šš 
=
šš 
new
šš 
List
šš  $
<
šš$ % 
FFtpDirectoryEntry
šš% 7
>
šš7 8
(
šš8 9
)
šš9 :
;
šš: ;
lines
›› 
=
›› 
listing
›› 
.
››  
Split
››  %
(
››% &
$char
››& *
)
››* +
;
››+ ,
format
œœ 
=
œœ "
guessDirectoryFormat
œœ -
(
œœ- .
lines
œœ. 3
)
œœ3 4
;
œœ4 5
if
 
(
 
format
 
==
  
FtpDirectoryFormat
 0
.
0 1
Windows
1 8
)
8 9
{
ŸŸ 
parseFunction
   !
=
  " #*
parseWindowsDirectoryListing
  $ @
;
  @ A
}
¡¡ 
if
££ 
(
££ 
parseFunction
££ !
!=
££" $
null
££% )
)
££) *
{
¤¤ 
foreach
¥¥ 
(
¥¥ 
string
¥¥ #
line
¥¥$ (
in
¥¥) +
lines
¥¥, 1
)
¥¥1 2
{
¦¦ 
if
§§ 
(
§§ 
line
§§  
.
§§  !
Length
§§! '
>
§§( )
$num
§§* +
)
§§+ ,
{
¨¨ 
entry
©© !
=
©©" #
parseFunction
©©$ 1
(
©©1 2
line
©©2 6
)
©©6 7
;
©©7 8
if
«« 
(
««  
entry
««  %
.
««% &
name
««& *
!=
««+ -
$str
««. 1
&&
««2 4
entry
««5 :
.
««: ;
name
««; ?
!=
««@ B
$str
««C G
)
««G H
{
¬¬ 
	entryDict
­­  )
.
­­) *
Add
­­* -
(
­­- .
entry
­­. 3
.
­­3 4
name
­­4 8
,
­­8 9
entry
­­: ?
)
­­? @
;
­­@ A
	entryList
®®  )
.
®®) *
Add
®®* -
(
®®- .
entry
®®. 3
)
®®3 4
;
®®4 5
}
¯¯ 
}
°° 
}
±± 
}
²² 
return
´´ 
new
´´ *
FFtpDirectoryEntryCollection
´´ 7
(
´´7 8
	entryDict
´´8 A
,
´´A B
	entryList
´´C L
)
´´L M
;
´´M N
}
µµ 
catch
¶¶ 
(
¶¶ 
	Exception
¶¶ 
ex
¶¶ 
)
¶¶  
{
·· 
FDebug
¸¸ 
.
¸¸ 
throwException
¸¸ %
(
¸¸% &
ex
¸¸& (
)
¸¸( )
;
¸¸) *
}
¹¹ 
finally
ºº 
{
»» 
}
½½ 
return
¾¾ 
null
¾¾ 
;
¾¾ 
}
¿¿ 	
private
ÃÃ  
FtpDirectoryFormat
ÃÃ ""
guessDirectoryFormat
ÃÃ# 7
(
ÃÃ7 8
string
ÄÄ 
[
ÄÄ 
]
ÄÄ 
lines
ÄÄ 
)
ÅÅ 
{
ÆÆ 	
try
ÇÇ 
{
ÈÈ 
foreach
ÉÉ 
(
ÉÉ 
string
ÉÉ 
s
ÉÉ  !
in
ÉÉ" $
lines
ÉÉ% *
)
ÉÉ* +
{
ÊÊ 
if
ËË 
(
ËË 
s
ËË 
.
ËË 
Length
ËË  
>
ËË! "
$num
ËË# $
&&
ËË% '
Regex
ËË( -
.
ËË- .
IsMatch
ËË. 5
(
ËË5 6
s
ËË6 7
.
ËË7 8
	Substring
ËË8 A
(
ËËA B
$num
ËËB C
,
ËËC D
$num
ËËE F
)
ËËF G
,
ËËG H
$str
ËËH j
)
ËËj k
)
ËËk l
{
ÌÌ 
return
ÍÍ  
FtpDirectoryFormat
ÍÍ 1
.
ÍÍ1 2
Windows
ÍÍ2 9
;
ÍÍ9 :
}
ÎÎ 
}
ÏÏ 
}
ĞĞ 
catch
ÑÑ 
(
ÑÑ 
	Exception
ÑÑ 
ex
ÑÑ 
)
ÑÑ  
{
ÒÒ 
FDebug
ÓÓ 
.
ÓÓ 
throwException
ÓÓ %
(
ÓÓ% &
ex
ÓÓ& (
)
ÓÓ( )
;
ÓÓ) *
}
ÔÔ 
finally
ÕÕ 
{
ÖÖ 
}
ØØ 
return
ÙÙ  
FtpDirectoryFormat
ÙÙ %
.
ÙÙ% &
Unknown
ÙÙ& -
;
ÙÙ- .
}
ÚÚ 	
private
ŞŞ  
FFtpDirectoryEntry
ŞŞ "*
parseWindowsDirectoryListing
ŞŞ# ?
(
ŞŞ? @
string
ßß 
text
ßß 
)
àà 
{
áá 	 
FFtpDirectoryEntry
ââ 
entry
ââ $
;
ââ$ %
DateTime
ãã 
dateTime
ãã 
;
ãã 
string
ää 

dateString
ää 
;
ää 
string
åå 
	dateValue
åå 
;
åå 
bool
ææ 
result
ææ 
;
ææ 
int
çç 
pos
çç 
;
çç 
try
éé 
{
êê 
entry
ëë 
=
ëë 
new
ëë  
FFtpDirectoryEntry
ëë .
(
ëë. /
)
ëë/ 0
;
ëë0 1
text
íí 
=
íí 
text
íí 
.
íí 
Trim
íí  
(
íí  !
)
íí! "
;
íí" #

dateString
îî 
=
îî 
text
îî !
.
îî! "
	Substring
îî" +
(
îî+ ,
$num
îî, -
,
îî- .
$num
îî/ 1
)
îî1 2
;
îî2 3
text
ïï 
=
ïï 
text
ïï 
.
ïï 
	Substring
ïï %
(
ïï% &
$num
ïï& (
)
ïï( )
.
ïï) *
Trim
ïï* .
(
ïï. /
)
ïï/ 0
;
ïï0 1
	dateValue
ññ 
=
ññ 

dateString
ññ &
;
ññ& '
	dateValue
òò 
=
òò 
	dateValue
òò %
.
òò% &
	Substring
òò& /
(
òò/ 0
$num
òò0 1
,
òò1 2
	dateValue
òò3 <
.
òò< =
Length
òò= C
-
òòD E
$num
òòF G
)
òòG H
;
òòH I
result
óó 
=
óó 
DateTime
óó !
.
óó! "
TryParseExact
óó" /
(
óó/ 0
	dateValue
óó0 9
,
óó9 :
$str
óó; K
,
óóK L
null
óóM Q
,
óóQ R
DateTimeStyles
óóS a
.
óóa b
AllowWhiteSpaces
óób r
,
óór s
out
óót w
dateTimeóóx €
)óó€ 
;óó ‚
if
õõ 
(
õõ 
!
õõ 
result
õõ 
)
õõ 
{
öö 
FDebug
÷÷ 
.
÷÷ 
throwFException
÷÷ *
(
÷÷+ ,
$str
÷÷, =
)
÷÷= >
;
÷÷> ?
}
øø 

dateString
úú 
=
úú 
dateTime
úú %
.
úú% &
ToString
úú& .
(
úú. /
$str
úú/ D
)
úúD E
;
úúE F
entry
ûû 
.
ûû 

createTime
ûû  
=
ûû! "
DateTime
ûû# +
.
ûû+ ,
Parse
ûû, 1
(
ûû1 2
String
ûû2 8
.
ûû8 9
Format
ûû9 ?
(
ûû? @
$str
ûû@ F
,
ûûF G

dateString
ûûH R
)
ûûR S
)
ûûS T
;
ûûT U
if
ıı 
(
ıı 
text
ıı 
.
ıı 
	Substring
ıı "
(
ıı" #
$num
ıı# $
,
ıı$ %
$num
ıı& '
)
ıı' (
==
ıı) +
$str
ıı, 3
)
ıı3 4
{
şş 
entry
ÿÿ 
.
ÿÿ 
isDirectory
ÿÿ %
=
ÿÿ& '
true
ÿÿ( ,
;
ÿÿ, -
text
€	€	 
=
€	€	 
text
€	€	 
.
€	€	  
	Substring
€	€	  )
(
€	€	) *
$num
€	€	* +
)
€	€	+ ,
.
€	€	, -
Trim
€	€	- 1
(
€	€	1 2
)
€	€	2 3
;
€	€	3 4
}
		 
else
‚	‚	 
{
ƒ	ƒ	 
entry
„	„	 
.
„	„	 
isDirectory
„	„	 %
=
„	„	& '
false
„	„	( -
;
„	„	- .
pos
…	…	 
=
…	…	 
text
…	…	 
.
…	…	 
IndexOf
…	…	 &
(
…	…	& '
$char
…	…	' *
)
…	…	* +
;
…	…	+ ,
entry
†	†	 
.
†	†	 
size
†	†	 
=
†	†	  
Int64
†	†	! &
.
†	†	& '
Parse
†	†	' ,
(
†	†	, -
text
†	†	- 1
.
†	†	1 2
	Substring
†	†	2 ;
(
†	†	; <
$num
†	†	< =
,
†	†	= >
pos
†	†	? B
)
†	†	B C
)
†	†	C D
;
†	†	D E
text
‡	‡	 
=
‡	‡	 
text
‡	‡	 
.
‡	‡	  
	Substring
‡	‡	  )
(
‡	‡	) *
pos
‡	‡	* -
)
‡	‡	- .
.
‡	‡	. /
Trim
‡	‡	/ 3
(
‡	‡	3 4
)
‡	‡	4 5
;
‡	‡	5 6
}
ˆ	ˆ	 
entry
‰	‰	 
.
‰	‰	 
name
‰	‰	 
=
‰	‰	 
text
‰	‰	 !
;
‰	‰	! "
return
‹	‹	 
entry
‹	‹	 
;
‹	‹	 
}
Œ	Œ	 
catch
		 
(
		 
	Exception
		 
ex
		 
)
		  
{
		 
FDebug
		 
.
		 
throwException
		 %
(
		% &
ex
		& (
)
		( )
;
		) *
}
		 
finally
‘	‘	 
{
’	’	 
}
”	”	 
return
•	•	 
null
•	•	 
;
•	•	 
}
–	–	 	
public
š	š	 
static
š	š	 
bool
š	š	 "
AcceptCertifications
š	š	 /
(
š	š	/ 0
object
›	›	 
sender
›	›	 
,
›	›	 
X509Certificate
œ	œ	 
certification
œ	œ	 )
,
œ	œ	) *
	X509Chain
		 
chain
		 
,
		 
SslPolicyErrors
		 
sslPolicyErrors
		 +
)
Ÿ	Ÿ	 
{
 	 	 	
return
¡	¡	 
true
¡	¡	 
;
¡	¡	 
}
¢	¢	 	
}
¨	¨	 
}©	©	 ª
uD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Socket\c_FTcpListenerAcceptCompletedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
Serializable 
] 
public 

class 0
$FTcpListenerAcceptCompletedEventArgs 5
:6 7 
FSocketEventArgsBase8 L
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FTcpListener 
m_fOwnerTcpListener 0
=1 2
null3 7
;7 8
private 

FTcpClient 
m_fTcpClient '
=( )
null* .
;. /
internal## 0
$FTcpListenerAcceptCompletedEventArgs## 5
(##5 6
FTcpListener$$ 
fOwnerTcpListener$$ *
,$$* +

FTcpClient%% 

fTcpClient%% !
)&& 
:'' 
base'' 
('' 
FSocketEventId'' "
.''" #&
TcpListenerAcceptCompleted''# =
)''= >
{(( 	
m_fOwnerTcpListener)) 
=))  !
fOwnerTcpListener))" 3
;))3 4
m_fTcpClient** 
=** 

fTcpClient** %
;**% &
}++ 	
~// 	0
$FTcpListenerAcceptCompletedEventArgs//	 -
(//- .
)00 
{11 	
	myDispose22 
(22 
false22 
)22 
;22 
}33 	
	protected77 
override77 
void77 
	myDispose77  )
(77) *
bool88 
	disposing88 
)99 
{:: 	
if;; 
(;; 
!;; 

m_disposed;; 
);; 
{<< 
if== 
(== 
	disposing== 
)== 
{>> 
m_fOwnerTcpListener?? '
=??( )
null??* .
;??. /
m_fTcpClient@@  
=@@! "
null@@# '
;@@' (
}AA 

m_disposedBB 
=BB 
trueBB !
;BB! "
baseFF 
.FF 
	myDisposeFF 
(FF 
	disposingFF (
)FF( )
;FF) *
}GG 
}HH 	
publicPP 
FTcpListenerPP 
fOwnerTcpListenerPP -
{QQ 	
getRR 
{SS 
tryTT 
{UU 
returnVV 
m_fOwnerTcpListenerVV .
;VV. /
}WW 
catchXX 
(XX 
	ExceptionXX  
exXX! #
)XX# $
{YY 
FDebugZZ 
.ZZ 
throwExceptionZZ )
(ZZ) *
exZZ* ,
)ZZ, -
;ZZ- .
}[[ 
finally\\ 
{]] 
}__ 
return`` 
null`` 
;`` 
}aa 
}bb 	
publicff 

FTcpClientff 

fTcpClientff $
{gg 	
gethh 
{ii 
tryjj 
{kk 
returnll 
m_fTcpClientll '
;ll' (
}mm 
catchnn 
(nn 
	Exceptionnn  
exnn! #
)nn# $
{oo 
FDebugpp 
.pp 
throwExceptionpp )
(pp) *
expp* ,
)pp, -
;pp- .
}qq 
finallyrr 
{ss 
}uu 
returnvv 
nullvv 
;vv 
}ww 
}xx 	
}
„„ 
}…… ×#
qD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Socket\c_FTcpListenerErrorRaisedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
Serializable 
] 
public 

class ,
 FTcpListenerErrorRaisedEventArgs 1
:2 3 
FSocketEventArgsBase4 H
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FTcpListener 
m_fOwnerTcpListener 0
=1 2
null3 7
;7 8
private 
string 
	m_message  
=! "
string# )
.) *
Empty* /
;/ 0
private 
	Exception 
m_exception %
=& '
null( ,
;, -
internal%% ,
 FTcpListenerErrorRaisedEventArgs%% 1
(%%1 2
FTcpListener&& 
fOwnerTcpListener&& *
,&&* +
string'' 
message'' 
,'' 
	Exception(( 
	exception(( 
))) 
:** 
base** 
(** 
FSocketEventId** "
.**" #"
TcpListenerErrorRaised**# 9
)**9 :
{++ 	
m_fOwnerTcpListener,, 
=,,  !
fOwnerTcpListener,," 3
;,,3 4
	m_message-- 
=-- 
message-- 
;--  
m_exception.. 
=.. 
	exception.. #
;..# $
}// 	
~33 	,
 FTcpListenerErrorRaisedEventArgs33	 )
(33) *
)44 
{55 	
	myDispose66 
(66 
false66 
)66 
;66 
}77 	
	protected;; 
override;; 
void;; 
	myDispose;;  )
(;;) *
bool<< 
	disposing<< 
)== 
{>> 	
if?? 
(?? 
!?? 

m_disposed?? 
)?? 
{@@ 
ifAA 
(AA 
	disposingAA 
)AA 
{BB 
m_fOwnerTcpListenerCC '
=CC( )
nullCC* .
;CC. /
m_exceptionDD 
=DD  !
nullDD" &
;DD& '
}EE 

m_disposedFF 
=FF 
trueFF !
;FF! "
baseJJ 
.JJ 
	myDisposeJJ 
(JJ 
	disposingJJ (
)JJ( )
;JJ) *
}KK 
}LL 	
publicTT 
FTcpListenerTT 
fOwnerTcpListenerTT -
{UU 	
getVV 
{WW 
tryXX 
{YY 
returnZZ 
m_fOwnerTcpListenerZZ .
;ZZ. /
}[[ 
catch\\ 
(\\ 
	Exception\\  
ex\\! #
)\\# $
{]] 
FDebug^^ 
.^^ 
throwException^^ )
(^^) *
ex^^* ,
)^^, -
;^^- .
}__ 
finally`` 
{aa 
}cc 
returndd 
nulldd 
;dd 
}ee 
}ff 	
publicjj 
stringjj 
messagejj 
{kk 	
getll 
{mm 
trynn 
{oo 
returnpp 
	m_messagepp $
;pp$ %
}qq 
catchrr 
(rr 
	Exceptionrr  
exrr! #
)rr# $
{ss 
FDebugtt 
.tt 
throwExceptiontt )
(tt) *
extt* ,
)tt, -
;tt- .
}uu 
finallyvv 
{ww 
}yy 
returnzz 
stringzz 
.zz 
Emptyzz #
;zz# $
}{{ 
}|| 	
public
€€ 
	Exception
€€ 
	exception
€€ "
{
 	
get
‚‚ 
{
ƒƒ 
try
„„ 
{
…… 
return
†† 
m_exception
†† &
;
††& '
}
‡‡ 
catch
ˆˆ 
(
ˆˆ 
	Exception
ˆˆ  
ex
ˆˆ! #
)
ˆˆ# $
{
‰‰ 
FDebug
ŠŠ 
.
ŠŠ 
throwException
ŠŠ )
(
ŠŠ) *
ex
ŠŠ* ,
)
ŠŠ, -
;
ŠŠ- .
}
‹‹ 
finally
ŒŒ 
{
 
}
 
return
 
null
 
;
 
}
‘‘ 
}
’’ 	
}
 
}ŸŸ Ö
YD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Socket\i_FISocket.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
internal 
	interface 
FISocket 
{ 
FSocketType 
fSocketType 
{ 	
get 
; 
} 	
}** 
}++ ş 
pD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Socket\c_FTcpClientDataReceivedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
Serializable 
] 
public 

class +
FTcpClientDataReceivedEventArgs 0
:1 2 
FSocketEventArgsBase3 G
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 

FTcpClient 
m_fOwnerTcpClient ,
=- .
null/ 3
;3 4
private 
byte 
[ 
] 
m_data 
= 
null  $
;$ %
internal## +
FTcpClientDataReceivedEventArgs## 0
(##0 1

FTcpClient$$ 
fOwnerTcpClient$$ &
,$$& '
byte%% 
[%% 
]%% 
data%% 
)&& 
:'' 
base'' 
('' 
FSocketEventId'' "
.''" #!
TcpClientDataReceived''# 8
)''8 9
{(( 	
m_fOwnerTcpClient)) 
=)) 
fOwnerTcpClient))  /
;))/ 0
m_data** 
=** 
data** 
;** 
}++ 	
~// 	+
FTcpClientDataReceivedEventArgs//	 (
(//( )
)00 
{11 	
	myDispose22 
(22 
false22 
)22 
;22 
}33 	
	protected77 
override77 
void77 
	myDispose77  )
(77) *
bool88 
	disposing88 
)99 
{:: 	
if;; 
(;; 
!;; 

m_disposed;; 
);; 
{<< 
if== 
(== 
	disposing== 
)== 
{>> 
m_fOwnerTcpClient?? %
=??& '
null??( ,
;??, -
}@@ 

m_disposedAA 
=AA 
trueAA !
;AA! "
baseEE 
.EE 
	myDisposeEE 
(EE 
	disposingEE (
)EE( )
;EE) *
}FF 
}GG 	
publicOO 

FTcpClientOO 
fOwnerTcpClientOO )
{PP 	
getQQ 
{RR 
trySS 
{TT 
returnUU 
m_fOwnerTcpClientUU ,
;UU, -
}VV 
catchWW 
(WW 
	ExceptionWW  
exWW! #
)WW# $
{XX 
FDebugYY 
.YY 
throwExceptionYY )
(YY) *
exYY* ,
)YY, -
;YY- .
}ZZ 
finally[[ 
{\\ 
}^^ 
return__ 
null__ 
;__ 
}`` 
}aa 	
publicee 
byteee 
[ee 
]ee 
dataee 
{ff 	
getgg 
{hh 
tryii 
{jj 
returnkk 
m_datakk !
;kk! "
}ll 
catchmm 
(mm 
	Exceptionmm  
exmm! #
)mm# $
{nn 
FDebugoo 
.oo 
throwExceptionoo )
(oo) *
exoo* ,
)oo, -
;oo- .
}pp 
finallyqq 
{rr 
}tt 
returnuu 
nulluu 
;uu 
}vv 
}ww 	
public{{ 
int{{ 

dataLength{{ 
{|| 	
get}} 
{~~ 
try 
{
€€ 
return
 
m_data
 !
.
! "
Length
" (
;
( )
}
‚‚ 
catch
ƒƒ 
(
ƒƒ 
	Exception
ƒƒ  
ex
ƒƒ! #
)
ƒƒ# $
{
„„ 
FDebug
…… 
.
…… 
throwException
…… )
(
……) *
ex
……* ,
)
……, -
;
……- .
}
†† 
finally
‡‡ 
{
ˆˆ 
}
ŠŠ 
return
‹‹ 
$num
‹‹ 
;
‹‹ 
}
ŒŒ 
}
 	
}
™™ 
}šš Ì9
pD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Socket\c_FTcpClientStateChangedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
Serializable 
] 
public 

class +
FTcpClientStateChangedEventArgs 0
:1 2 
FSocketEventArgsBase3 G
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 

FTcpClient 
m_fOwnerTcpClient ,
=- .
null/ 3
;3 4
private 
FTcpClientState 
m_fState  (
=) *
FTcpClientState+ :
.: ;
Closed; A
;A B
private 
string 
	m_localIp  
=! "
string# )
.) *
Empty* /
;/ 0
private 
int 
m_localPort 
=  !
$num" #
;# $
private   
string   

m_remoteIp   !
=  " #
string  $ *
.  * +
Empty  + 0
;  0 1
private!! 
int!! 
m_remotePort!!  
=!!! "
$num!!# $
;!!$ %
internal'' +
FTcpClientStateChangedEventArgs'' 0
(''0 1

FTcpClient(( 
fOwnerTcpClient(( &
,((& '
FTcpClientState)) 
fState)) "
,))" #
string** 
localIp** 
,** 
int++ 
	localPort++ 
,++ 
string,, 
remoteIp,, 
,,, 
int-- 

remotePort-- 
).. 
:// 
base// 
(// 
FSocketEventId// "
.//" #!
TcpClientStateChanged//# 8
)//8 9
{00 	
m_fOwnerTcpClient11 
=11 
fOwnerTcpClient11  /
;11/ 0
m_fState22 
=22 
fState22 
;22 
	m_localIp33 
=33 
localIp33 
;33  
m_localPort44 
=44 
	localPort44 #
;44# $

m_remoteIp55 
=55 
remoteIp55 !
;55! "
m_remotePort66 
=66 

remotePort66 %
;66% &
}77 	
~;; 	+
FTcpClientStateChangedEventArgs;;	 (
(;;( )
)<< 
{== 	
	myDispose>> 
(>> 
false>> 
)>> 
;>> 
}?? 	
	protectedCC 
overrideCC 
voidCC 
	myDisposeCC  )
(CC) *
boolDD 
	disposingDD 
)EE 
{FF 	
ifGG 
(GG 
!GG 

m_disposedGG 
)GG 
{HH 
ifII 
(II 
	disposingII 
)II 
{JJ 
m_fOwnerTcpClientKK %
=KK& '
nullKK( ,
;KK, -
}LL 

m_disposedMM 
=MM 
trueMM !
;MM! "
baseQQ 
.QQ 
	myDisposeQQ 
(QQ 
	disposingQQ (
)QQ( )
;QQ) *
}RR 
}SS 	
public[[ 

FTcpClient[[ 
fOwnerTcpClient[[ )
{\\ 	
get]] 
{^^ 
try__ 
{`` 
returnaa 
m_fOwnerTcpClientaa ,
;aa, -
}bb 
catchcc 
(cc 
	Exceptioncc  
excc! #
)cc# $
{dd 
FDebugee 
.ee 
throwExceptionee )
(ee) *
exee* ,
)ee, -
;ee- .
}ff 
finallygg 
{hh 
}jj 
returnkk 
nullkk 
;kk 
}ll 
}mm 	
publicqq 
FTcpClientStateqq 
fStateqq %
{rr 	
getss 
{tt 
tryuu 
{vv 
returnww 
m_fStateww #
;ww# $
}xx 
catchyy 
(yy 
	Exceptionyy  
exyy! #
)yy# $
{zz 
FDebug{{ 
.{{ 
throwException{{ )
({{) *
ex{{* ,
){{, -
;{{- .
}|| 
finally}} 
{~~ 
}
€€ 
return
 
FTcpClientState
 &
.
& '
Closed
' -
;
- .
}
‚‚ 
}
ƒƒ 	
public
‡‡ 
string
‡‡ 
localIp
‡‡ 
{
ˆˆ 	
get
‰‰ 
{
ŠŠ 
try
‹‹ 
{
ŒŒ 
return
 
	m_localIp
 $
;
$ %
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
‘‘ 
.
‘‘ 
throwException
‘‘ )
(
‘‘) *
ex
‘‘* ,
)
‘‘, -
;
‘‘- .
}
’’ 
finally
““ 
{
”” 
}
–– 
return
—— 
string
—— 
.
—— 
Empty
—— #
;
——# $
}
˜˜ 
}
™™ 	
public
 
int
 
	localPort
 
{
 	
get
ŸŸ 
{
   
try
¡¡ 
{
¢¢ 
return
££ 
m_localPort
££ &
;
££& '
}
¤¤ 
catch
¥¥ 
(
¥¥ 
	Exception
¥¥  
ex
¥¥! #
)
¥¥# $
{
¦¦ 
FDebug
§§ 
.
§§ 
throwException
§§ )
(
§§) *
ex
§§* ,
)
§§, -
;
§§- .
}
¨¨ 
finally
©© 
{
ªª 
}
¬¬ 
return
­­ 
$num
­­ 
;
­­ 
}
®® 
}
¯¯ 	
public
³³ 
string
³³ 
remoteIp
³³ 
{
´´ 	
get
µµ 
{
¶¶ 
try
·· 
{
¸¸ 
return
¹¹ 

m_remoteIp
¹¹ %
;
¹¹% &
}
ºº 
catch
»» 
(
»» 
	Exception
»»  
ex
»»! #
)
»»# $
{
¼¼ 
FDebug
½½ 
.
½½ 
throwException
½½ )
(
½½) *
ex
½½* ,
)
½½, -
;
½½- .
}
¾¾ 
finally
¿¿ 
{
ÀÀ 
}
ÂÂ 
return
ÃÃ 
string
ÃÃ 
.
ÃÃ 
Empty
ÃÃ #
;
ÃÃ# $
}
ÄÄ 
}
ÅÅ 	
public
ÉÉ 
int
ÉÉ 

remotePort
ÉÉ 
{
ÊÊ 	
get
ËË 
{
ÌÌ 
try
ÍÍ 
{
ÎÎ 
return
ÏÏ 
m_remotePort
ÏÏ '
;
ÏÏ' (
}
ĞĞ 
catch
ÑÑ 
(
ÑÑ 
	Exception
ÑÑ  
ex
ÑÑ! #
)
ÑÑ# $
{
ÒÒ 
FDebug
ÓÓ 
.
ÓÓ 
throwException
ÓÓ )
(
ÓÓ) *
ex
ÓÓ* ,
)
ÓÓ, -
;
ÓÓ- .
}
ÔÔ 
finally
ÕÕ 
{
ÖÖ 
}
ØØ 
return
ÙÙ 
$num
ÙÙ 
;
ÙÙ 
}
ÚÚ 
}
ÛÛ 	
}
çç 
}èè ¹#
oD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Socket\c_FTcpClientErrorRaisedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
Serializable 
] 
public 

class *
FTcpClientErrorRaisedEventArgs /
:0 1 
FSocketEventArgsBase2 F
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 

FTcpClient 
m_fOwnerTcpClient ,
=- .
null/ 3
;3 4
private 
string 
	m_message  
=! "
string# )
.) *
Empty* /
;/ 0
private 
	Exception 
m_exception %
=& '
null( ,
;, -
internal%% *
FTcpClientErrorRaisedEventArgs%% /
(%%/ 0

FTcpClient&& 
fOwnerTcpClient&& &
,&&& '
string'' 
message'' 
,'' 
	Exception(( 
	exception(( 
))) 
:** 
base** 
(** 
FSocketEventId** "
.**" # 
TcpClientErrorRaised**# 7
)**7 8
{++ 	
m_fOwnerTcpClient,, 
=,, 
fOwnerTcpClient,,  /
;,,/ 0
	m_message-- 
=-- 
message-- 
;--  
m_exception.. 
=.. 
	exception.. #
;..# $
}// 	
~33 	*
FTcpClientErrorRaisedEventArgs33	 '
(33' (
)44 
{55 	
	myDispose66 
(66 
false66 
)66 
;66 
}77 	
	protected;; 
override;; 
void;; 
	myDispose;;  )
(;;) *
bool<< 
	disposing<< 
)== 
{>> 	
if?? 
(?? 
!?? 

m_disposed?? 
)?? 
{@@ 
ifAA 
(AA 
	disposingAA 
)AA 
{BB 
m_fOwnerTcpClientCC %
=CC& '
nullCC( ,
;CC, -
m_exceptionDD 
=DD  !
nullDD" &
;DD& '
}EE 

m_disposedFF 
=FF 
trueFF !
;FF! "
baseJJ 
.JJ 
	myDisposeJJ 
(JJ 
	disposingJJ (
)JJ( )
;JJ) *
}KK 
}LL 	
publicTT 

FTcpClientTT 
fOwnerTcpClientTT )
{UU 	
getVV 
{WW 
tryXX 
{YY 
returnZZ 
m_fOwnerTcpClientZZ ,
;ZZ, -
}[[ 
catch\\ 
(\\ 
	Exception\\  
ex\\! #
)\\# $
{]] 
FDebug^^ 
.^^ 
throwException^^ )
(^^) *
ex^^* ,
)^^, -
;^^- .
}__ 
finally`` 
{aa 
}cc 
returndd 
nulldd 
;dd 
}ee 
}ff 	
publicjj 
stringjj 
messagejj 
{kk 	
getll 
{mm 
trynn 
{oo 
returnpp 
	m_messagepp $
;pp$ %
}qq 
catchrr 
(rr 
	Exceptionrr  
exrr! #
)rr# $
{ss 
FDebugtt 
.tt 
throwExceptiontt )
(tt) *
extt* ,
)tt, -
;tt- .
}uu 
finallyvv 
{ww 
}yy 
returnzz 
stringzz 
.zz 
Emptyzz #
;zz# $
}{{ 
}|| 	
public
€€ 
	Exception
€€ 
	exception
€€ "
{
 	
get
‚‚ 
{
ƒƒ 
try
„„ 
{
…… 
return
†† 
m_exception
†† &
;
††& '
}
‡‡ 
catch
ˆˆ 
(
ˆˆ 
	Exception
ˆˆ  
ex
ˆˆ! #
)
ˆˆ# $
{
‰‰ 
FDebug
ŠŠ 
.
ŠŠ 
throwException
ŠŠ )
(
ŠŠ) *
ex
ŠŠ* ,
)
ŠŠ, -
;
ŠŠ- .
}
‹‹ 
finally
ŒŒ 
{
 
}
 
return
 
null
 
;
 
}
‘‘ 
}
’’ 	
}
 
}ŸŸ œ
`D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Socket\c_FSocketSendData.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FSocketSendData  
:! "
IDisposable# .
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
byte 
[ 
] 
m_data 
= 
null  $
;$ %
private 
object 
m_state 
=  
null! %
;% &
public## 
FSocketSendData## 
(## 
byte$$ 
[$$ 
]$$ 
data$$ 
)%% 
{&& 	
m_data'' 
='' 
data'' 
;'' 
}(( 	
public,, 
FSocketSendData,, 
(,, 
byte-- 
[-- 
]-- 
data-- 
,-- 
object.. 
state.. 
)// 
:00 
this00 
(00 
data00 
)00 
{11 	
m_state22 
=22 
state22 
;22 
}33 	
~77 	
FSocketSendData77	 
(77 
)88 
{99 	
	myDispose:: 
(:: 
false:: 
):: 
;:: 
};; 	
	protected?? 
void?? 
	myDispose??  
(??  !
bool@@ 
	disposing@@ 
)AA 
{BB 	
ifCC 
(CC 
!CC 

m_disposedCC 
)CC 
{DD 
ifEE 
(EE 
	disposingEE 
)EE 
{FF 
m_dataGG 
=GG 
nullGG !
;GG! "
m_stateHH 
=HH 
nullHH "
;HH" #
}II 

m_disposedKK 
=KK 
trueKK !
;KK! "
}LL 
}MM 	
publicUU 
voidUU 
DisposeUU 
(UU 
)VV 
{WW 	
	myDisposeXX 
(XX 
trueXX 
)XX 
;XX 
GCYY 
.YY 
SuppressFinalizeYY 
(YY  
thisYY  $
)YY$ %
;YY% &
}ZZ 	
publicbb 
bytebb 
[bb 
]bb 
databb 
{cc 	
getdd 
{ee 
tryff 
{gg 
returnhh 
m_datahh !
;hh! "
}ii 
catchjj 
(jj 
	Exceptionjj  
exjj! #
)jj# $
{kk 
FDebugll 
.ll 
throwExceptionll )
(ll) *
exll* ,
)ll, -
;ll- .
}mm 
finallynn 
{oo 
}qq 
returnrr 
nullrr 
;rr 
}ss 
}tt 	
publicxx 
objectxx 
statexx 
{yy 	
getzz 
{{{ 
try|| 
{}} 
return~~ 
m_state~~ "
;~~" #
} 
catch
€€ 
(
€€ 
	Exception
€€  
ex
€€! #
)
€€# $
{
 
FDebug
‚‚ 
.
‚‚ 
throwException
‚‚ )
(
‚‚) *
ex
‚‚* ,
)
‚‚, -
;
‚‚- .
}
ƒƒ 
finally
„„ 
{
…… 
}
‡‡ 
return
ˆˆ 
null
ˆˆ 
;
ˆˆ 
}
‰‰ 
}
ŠŠ 	
}
–– 
}—— ‚†
[D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Socket\c_FTcpClient.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 

FTcpClient 
: 
FISocket &
,& '
IDisposable( 3
{ 
public 
event .
"FTcpClientStateChangedEventHandler 7!
TcpClientStateChanged8 M
=N O
nullP T
;T U
public   
event   .
"FTcpClientDataReceivedEventHandler   7!
TcpClientDataReceived  8 M
=  N O
null  P T
;  T U
public!! 
event!! *
FTcpClientDataSentEventHandler!! 3
TcpClientDataSent!!4 E
=!!F G
null!!H L
;!!L M
public"" 
event"" 0
$FTcpClientDataSendFailedEventHandler"" 9#
TcpClientDataSendFailed"": Q
=""R S
null""T X
;""X Y
public## 
event## -
!FTcpClientErrorRaisedEventHandler## 6 
TcpClientErrorRaised##7 K
=##L M
null##N R
;##R S
private%% 
const%% 
int%% 
RecvBufferSize%% (
=%%) *
$num%%+ 0
;%%0 1
private&& 
const&& 
int&& 
SendBufferSize&& (
=&&) *
$num&&+ 0
;&&0 1
private(( 
bool(( 

m_disposed(( 
=((  !
false((" '
;((' (
private** 
string** 
	m_localIp**  
=**! "
string**# )
.**) *
Empty*** /
;**/ 0
private++ 
int++ 
m_localPort++ 
=++  !
$num++" #
;++# $
private,, 
string,, 

m_remoteIp,, !
=,," #
string,,$ *
.,,* +
Empty,,+ 0
;,,0 1
private-- 
int-- 
m_remotePort--  
=--! "
$num--# $
;--$ %
private.. 
int..  
m_retryConnectPeriod.. (
=..) *
$num..+ /
;../ 0
private00 
FTcpClientMode00 
m_fMode00 &
=00' (
FTcpClientMode00) 7
.007 8
Client008 >
;00> ?
private11 
FTcpClientState11 
m_fState11  (
=11) *
FTcpClientState11+ :
.11: ;
Closed11; A
;11A B
private22 
	TcpClient22 
m_tcpClient22 %
=22& '
null22( ,
;22, -
private33 
FSocketFlag33 
m_fSocketFlag33 )
=33* +
null33, 0
;330 1
private44 
NetworkStream44 
m_networkStream44 -
=44. /
null440 4
;444 5
private55 
byte55 
[55 
]55 
	m_recvBuf55  
=55! "
null55# '
;55' (
private66 
FStaticTimer66  
m_fRetryConnectTimer66 1
=662 3
null664 8
;668 9
private88 
	FCodeLock88 
m_fMainSync88 %
=88& '
null88( ,
;88, -
private99 
	FCodeLock99 
m_fDisconnectSync99 +
=99, -
null99. 2
;992 3
private:: 
FSocketEventPusher:: "
m_fEventPusher::# 1
=::2 3
null::4 8
;::8 9
private;; 
FThread;; 

m_fThdMain;; "
=;;# $
null;;% )
;;;) *
publicAA 

FTcpClientAA 
(AA 
stringBB 
localIpBB 
,BB 
stringCC 
remoteIpCC 
,CC 
intDD 

remotePortDD 
)EE 
{FF 	
m_fModeGG 
=GG 
FTcpClientModeGG $
.GG$ %
ClientGG% +
;GG+ ,
m_fStateHH 
=HH 
FTcpClientStateHH &
.HH& '
ClosedHH' -
;HH- .
	m_localIpJJ 
=JJ 
localIpJJ 
;JJ  
m_localPortKK 
=KK 
$numKK 
;KK 

m_remoteIpLL 
=LL 
remoteIpLL !
;LL! "
m_remotePortMM 
=MM 

remotePortMM %
;MM% &
initOO 
(OO 
)OO 
;OO 
}PP 	
internalTT 

FTcpClientTT 
(TT 
	TcpClientUU 
	tcpClientUU 
)VV 
{WW 	

IPEndPointXX 

ipEndPointXX !
=XX" #
nullXX$ (
;XX( )
m_fModeZZ 
=ZZ 
FTcpClientModeZZ $
.ZZ$ %
ServerZZ% +
;ZZ+ ,
m_fState[[ 
=[[ 
FTcpClientState[[ &
.[[& '
	Connected[[' 0
;[[0 1
m_tcpClient__ 
=__ 
	tcpClient__ #
;__# $
setSocketKeepAlive`` 
(`` 
)``  
;``  !
m_tcpClientbb 
.bb 
ReceiveBufferSizebb )
=bb* +
RecvBufferSizebb, :
;bb: ;
m_tcpClientcc 
.cc 
SendBufferSizecc &
=cc' (
SendBufferSizecc) 7
;cc7 8
m_networkStreamee 
=ee 
m_tcpClientee )
.ee) *
	GetStreamee* 3
(ee3 4
)ee4 5
;ee5 6

ipEndPointii 
=ii 
(ii 

IPEndPointii $
)ii$ %
m_tcpClientii% 0
.ii0 1
Clientii1 7
.ii7 8
LocalEndPointii8 E
;iiE F
	m_localIpjj 
=jj 

ipEndPointjj "
.jj" #
Addressjj# *
.jj* +
ToStringjj+ 3
(jj3 4
)jj4 5
;jj5 6
m_localPortkk 
=kk 

ipEndPointkk $
.kk$ %
Portkk% )
;kk) *

ipEndPointmm 
=mm 
(mm 

IPEndPointmm $
)mm$ %
m_tcpClientmm% 0
.mm0 1
Clientmm1 7
.mm7 8
RemoteEndPointmm8 F
;mmF G

m_remoteIpnn 
=nn 

ipEndPointnn #
.nn# $
Addressnn$ +
.nn+ ,
ToStringnn, 4
(nn4 5
)nn5 6
;nn6 7
m_remotePortoo 
=oo 

ipEndPointoo %
.oo% &
Portoo& *
;oo* +
initqq 
(qq 
)qq 
;qq 
}rr 	
~vv 	

FTcpClientvv	 
(vv 
)ww 
{xx 	
	myDisposeyy 
(yy 
falseyy 
)yy 
;yy 
}zz 	
	protected~~ 
void~~ 
	myDispose~~  
(~~  !
bool 
	disposing 
)
€€ 
{
 	
if
‚‚ 
(
‚‚ 
!
‚‚ 

m_disposed
‚‚ 
)
‚‚ 
{
ƒƒ 
if
„„ 
(
„„ 
	disposing
„„ 
)
„„ 
{
…… 
term
†† 
(
†† 
)
†† 
;
†† 
}
‡‡ 

m_disposed
‰‰ 
=
‰‰ 
true
‰‰ !
;
‰‰! "
}
ŠŠ 
}
‹‹ 	
public
““ 
void
““ 
Dispose
““ 
(
““ 
)
”” 
{
•• 	
	myDispose
–– 
(
–– 
true
–– 
)
–– 
;
–– 
GC
—— 
.
—— 
SuppressFinalize
—— 
(
——  
this
——  $
)
——$ %
;
——% &
}
˜˜ 	
public
   
FSocketType
   
fSocketType
   &
{
¡¡ 	
get
¢¢ 
{
££ 
try
¤¤ 
{
¥¥ 
return
¦¦ 
FSocketType
¦¦ &
.
¦¦& '
Client
¦¦' -
;
¦¦- .
}
§§ 
catch
¨¨ 
(
¨¨ 
	Exception
¨¨  
ex
¨¨! #
)
¨¨# $
{
©© 
FDebug
ªª 
.
ªª 
throwException
ªª )
(
ªª) *
ex
ªª* ,
)
ªª, -
;
ªª- .
}
«« 
finally
¬¬ 
{
­­ 
}
¯¯ 
return
°° 
FSocketType
°° "
.
°°" #
Client
°°# )
;
°°) *
}
±± 
}
²² 	
public
¶¶ 
FTcpClientMode
¶¶ 
fMode
¶¶ #
{
·· 	
get
¸¸ 
{
¹¹ 
try
ºº 
{
»» 
return
¼¼ 
m_fMode
¼¼ "
;
¼¼" #
}
½½ 
catch
¾¾ 
(
¾¾ 
	Exception
¾¾  
ex
¾¾! #
)
¾¾# $
{
¿¿ 
FDebug
ÀÀ 
.
ÀÀ 
throwException
ÀÀ )
(
ÀÀ) *
ex
ÀÀ* ,
)
ÀÀ, -
;
ÀÀ- .
}
ÁÁ 
finally
ÂÂ 
{
ÃÃ 
}
ÅÅ 
return
ÆÆ 
FTcpClientMode
ÆÆ %
.
ÆÆ% &
Client
ÆÆ& ,
;
ÆÆ, -
}
ÇÇ 
}
ÈÈ 	
public
ÌÌ 
FTcpClientState
ÌÌ 
fState
ÌÌ %
{
ÍÍ 	
get
ÎÎ 
{
ÏÏ 
try
ĞĞ 
{
ÑÑ 
return
ÒÒ 
m_fState
ÒÒ #
;
ÒÒ# $
}
ÓÓ 
catch
ÔÔ 
(
ÔÔ 
	Exception
ÔÔ  
ex
ÔÔ! #
)
ÔÔ# $
{
ÕÕ 
FDebug
ÖÖ 
.
ÖÖ 
throwException
ÖÖ )
(
ÖÖ) *
ex
ÖÖ* ,
)
ÖÖ, -
;
ÖÖ- .
}
×× 
finally
ØØ 
{
ÙÙ 
}
ÛÛ 
return
ÜÜ 
FTcpClientState
ÜÜ &
.
ÜÜ& '
Closed
ÜÜ' -
;
ÜÜ- .
}
İİ 
}
ŞŞ 	
public
ââ 
string
ââ 
localIp
ââ 
{
ãã 	
get
ää 
{
åå 
try
ææ 
{
çç 
return
èè 
	m_localIp
èè $
;
èè$ %
}
éé 
catch
êê 
(
êê 
	Exception
êê  
ex
êê! #
)
êê# $
{
ëë 
FDebug
ìì 
.
ìì 
throwException
ìì )
(
ìì) *
ex
ìì* ,
)
ìì, -
;
ìì- .
}
íí 
finally
îî 
{
ïï 
}
ññ 
return
òò 
string
òò 
.
òò 
Empty
òò #
;
òò# $
}
óó 
}
ôô 	
public
øø 
int
øø 
	localPort
øø 
{
ùù 	
get
úú 
{
ûû 
try
üü 
{
ıı 
return
şş 
m_localPort
şş &
;
şş& '
}
ÿÿ 
catch
€€ 
(
€€ 
	Exception
€€  
ex
€€! #
)
€€# $
{
 
FDebug
‚‚ 
.
‚‚ 
throwException
‚‚ )
(
‚‚) *
ex
‚‚* ,
)
‚‚, -
;
‚‚- .
}
ƒƒ 
finally
„„ 
{
…… 
}
‡‡ 
return
ˆˆ 
$num
ˆˆ 
;
ˆˆ 
}
‰‰ 
}
ŠŠ 	
public
 
string
 
remoteIp
 
{
 	
get
 
{
‘‘ 
try
’’ 
{
““ 
return
”” 

m_remoteIp
”” %
;
””% &
}
•• 
catch
–– 
(
–– 
	Exception
––  
ex
––! #
)
––# $
{
—— 
FDebug
˜˜ 
.
˜˜ 
throwException
˜˜ )
(
˜˜) *
ex
˜˜* ,
)
˜˜, -
;
˜˜- .
}
™™ 
finally
šš 
{
›› 
}
 
return
 
string
 
.
 
Empty
 #
;
# $
}
ŸŸ 
}
   	
public
¤¤ 
int
¤¤ 

remotePort
¤¤ 
{
¥¥ 	
get
¦¦ 
{
§§ 
try
¨¨ 
{
©© 
return
ªª 
m_remotePort
ªª '
;
ªª' (
}
«« 
catch
¬¬ 
(
¬¬ 
	Exception
¬¬  
ex
¬¬! #
)
¬¬# $
{
­­ 
FDebug
®® 
.
®® 
throwException
®® )
(
®®) *
ex
®®* ,
)
®®, -
;
®®- .
}
¯¯ 
finally
°° 
{
±± 
}
³³ 
return
´´ 
$num
´´ 
;
´´ 
}
µµ 
}
¶¶ 	
public
ºº 
int
ºº  
retryConnectPeriod
ºº %
{
»» 	
get
¼¼ 
{
½½ 
try
¾¾ 
{
¿¿ 
return
ÃÃ "
m_retryConnectPeriod
ÃÃ /
;
ÃÃ/ 0
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
	Exception
ÅÅ  
ex
ÅÅ! #
)
ÅÅ# $
{
ÆÆ 
FDebug
ÇÇ 
.
ÇÇ 
throwException
ÇÇ )
(
ÇÇ) *
ex
ÇÇ* ,
)
ÇÇ, -
;
ÇÇ- .
}
ÈÈ 
finally
ÉÉ 
{
ÊÊ 
}
ÌÌ 
return
ÍÍ 
$num
ÍÍ 
;
ÍÍ 
}
ÎÎ 
set
ĞĞ 
{
ÑÑ 
try
ÒÒ 
{
ÓÓ 
if
ÔÔ 
(
ÔÔ 
value
ÔÔ 
<
ÔÔ 
$num
ÔÔ  !
)
ÔÔ! "
{
ÕÕ 
FDebug
ÖÖ 
.
ÖÖ 
throwFException
ÖÖ .
(
ÖÖ. /
string
ÖÖ/ 5
.
ÖÖ5 6
Format
ÖÖ6 <
(
ÖÖ< =

FConstants
ÖÖ= G
.
ÖÖG H

err_m_0005
ÖÖH R
,
ÖÖR S
$str
ÖÖT j
)
ÖÖj k
)
ÖÖk l
;
ÖÖl m
}
×× "
m_retryConnectPeriod
ŞŞ (
=
ŞŞ) *
value
ŞŞ+ 0
;
ŞŞ0 1
}
ßß 
catch
àà 
(
àà 
	Exception
àà  
ex
àà! #
)
àà# $
{
áá 
FDebug
ââ 
.
ââ 
throwException
ââ )
(
ââ) *
ex
ââ* ,
)
ââ, -
;
ââ- .
}
ãã 
finally
ää 
{
åå 
}
çç 
}
èè 
}
éé 	
public
íí 
bool
íí 
eventSuspended
íí "
{
îî 	
get
ïï 
{
ğğ 
try
ññ 
{
òò 
return
óó 
m_fEventPusher
óó )
.
óó) *
	suspended
óó* 3
;
óó3 4
}
ôô 
catch
õõ 
(
õõ 
	Exception
õõ  
ex
õõ! #
)
õõ# $
{
öö 
FDebug
÷÷ 
.
÷÷ 
throwException
÷÷ )
(
÷÷) *
ex
÷÷* ,
)
÷÷, -
;
÷÷- .
}
øø 
finally
ùù 
{
úú 
}
üü 
return
ıı 
false
ıı 
;
ıı 
}
şş 
}
ÿÿ 	
public
ƒƒ 
bool
ƒƒ 
receiveCompleted
ƒƒ $
{
„„ 	
get
…… 
{
†† 
try
‡‡ 
{
ˆˆ 
return
‰‰ 
m_fSocketFlag
‰‰ (
.
‰‰( ) 
doReceiveCompleted
‰‰) ;
;
‰‰; <
}
ŠŠ 
catch
‹‹ 
(
‹‹ 
	Exception
‹‹  
ex
‹‹! #
)
‹‹# $
{
ŒŒ 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
 
{
 
}
’’ 
return
““ 
false
““ 
;
““ 
}
”” 
}
•• 	
public
™™ 
bool
™™ 
sendCompleted
™™ !
{
šš 	
get
›› 
{
œœ 
try
 
{
 
return
ŸŸ 
m_fSocketFlag
ŸŸ (
.
ŸŸ( )
doSendCompleted
ŸŸ) 8
;
ŸŸ8 9
}
   
catch
¡¡ 
(
¡¡ 
	Exception
¡¡  
ex
¡¡! #
)
¡¡# $
{
¢¢ 
FDebug
££ 
.
££ 
throwException
££ )
(
££) *
ex
££* ,
)
££, -
;
££- .
}
¤¤ 
finally
¥¥ 
{
¦¦ 
}
¨¨ 
return
©© 
false
©© 
;
©© 
}
ªª 
}
«« 	
private
³³ 
void
³³ 
changeState
³³  
(
³³  !
FTcpClientState
´´ 
fState
´´ "
)
µµ 
{
¶¶ 	
try
·· 
{
¸¸ 
if
¹¹ 
(
¹¹ 
m_fState
¹¹ 
==
¹¹ 
fState
¹¹  &
)
¹¹& '
{
ºº 
return
»» 
;
»» 
}
¼¼ 
m_fState
ÀÀ 
=
ÀÀ 
fState
ÀÀ !
;
ÀÀ! "
m_fEventPusher
ÁÁ 
.
ÁÁ 
	pushEvent
ÁÁ (
(
ÁÁ( )
new
ÂÂ -
FTcpClientStateChangedEventArgs
ÂÂ 7
(
ÂÂ7 8
this
ÂÂ8 <
,
ÂÂ< =
fState
ÂÂ> D
,
ÂÂD E
	m_localIp
ÂÂF O
,
ÂÂO P
m_localPort
ÂÂQ \
,
ÂÂ\ ]

m_remoteIp
ÂÂ^ h
,
ÂÂh i
m_remotePort
ÂÂj v
)
ÂÂv w
)
ÃÃ 
;
ÃÃ 
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
	Exception
ÅÅ 
ex
ÅÅ 
)
ÅÅ  
{
ÆÆ 
FDebug
ÇÇ 
.
ÇÇ 
throwException
ÇÇ %
(
ÇÇ% &
ex
ÇÇ& (
)
ÇÇ( )
;
ÇÇ) *
}
ÈÈ 
finally
ÉÉ 
{
ÊÊ 
}
ÌÌ 
}
ÍÍ 	
private
ÑÑ 
void
ÑÑ %
pushDataSendFailedEvent
ÑÑ ,
(
ÑÑ, -
FSocketSendData
ÒÒ 
fData
ÒÒ !
,
ÒÒ! "
string
ÓÓ 
message
ÓÓ 
)
ÔÔ 
{
ÕÕ 	
try
ÖÖ 
{
×× 
m_fEventPusher
ØØ 
.
ØØ 
	pushEvent
ØØ (
(
ØØ( )
new
ØØ) ,/
!FTcpClientDataSendFailedEventArgs
ØØ- N
(
ØØN O
this
ØØO S
,
ØØS T
fData
ØØU Z
,
ØØZ [
message
ØØ\ c
)
ØØc d
)
ØØd e
;
ØØe f
}
ÙÙ 
catch
ÚÚ 
(
ÚÚ 
	Exception
ÚÚ 
ex
ÚÚ 
)
ÚÚ  
{
ÛÛ 
FDebug
ÜÜ 
.
ÜÜ 
writeLog
ÜÜ 
(
ÜÜ  
ex
ÜÜ  "
)
ÜÜ" #
;
ÜÜ# $
}
İİ 
finally
ŞŞ 
{
ßß 
}
áá 
}
ââ 	
private
ææ 
void
ææ "
pushSocketErrorEvent
ææ )
(
ææ) *
string
çç 
function
çç 
,
çç 
SocketException
èè 
sckEx
èè !
)
éé 
{
êê 	
FDebugLogArgs
ëë 
fLogArgs
ëë "
=
ëë# $
null
ëë% )
;
ëë) *
try
íí 
{
îî 
System
ïï 
.
ïï 
Diagnostics
ïï "
.
ïï" #
Debug
ïï# (
.
ïï( )
	WriteLine
ïï) 2
(
ïï2 3
$str
ïï3 A
+
ïïB C
sckEx
ïïD I
.
ïïI J
SocketErrorCode
ïïJ Y
.
ïïY Z
ToString
ïïZ b
(
ïïb c
)
ïïc d
)
ïïd e
;
ïïe f
fLogArgs
öö 
=
öö 
new
öö 
FDebugLogArgs
öö ,
(
öö, -
FDebugLogCategory
öö- >
.
öö> ?
	Exception
öö? H
,
ööH I
$str
ööJ ]
,
öö] ^
this
öö_ c
.
ööc d
GetType
ööd k
(
öök l
)
ööl m
,
ööm n
function
ööo w
)
ööw x
;
ööx y
fLogArgs
÷÷ 
.
÷÷ 
additionInfo
÷÷ %
=
÷÷& '
$str
øø 
+
øø 
m_fMode
øø &
.
øø& '
ToString
øø' /
(
øø/ 0
)
øø0 1
+
øø2 3
$str
øø4 J
+
øøK L
sckEx
øøM R
.
øøR S
SocketErrorCode
øøS b
.
øøb c
ToString
øøc k
(
øøk l
)
øøl m
+
øøn o
$str
øøp s
+
øøt u
Environmentøøv 
.øø ‚
NewLineøø‚ ‰
+øøŠ ‹
sckEx
ùù 
.
ùù 
ToString
ùù "
(
ùù" #
)
ùù# $
;
ùù$ %
FDebug
úú 
.
úú 
writeLog
úú 
(
úú  
fLogArgs
úú  (
)
úú( )
;
úú) *
m_fEventPusher
üü 
.
üü 
	pushEvent
üü (
(
üü( )
new
ıı ,
FTcpClientErrorRaisedEventArgs
ıı 6
(
ıı6 7
this
ıı7 ;
,
ıı; <
sckEx
ıı= B
.
ııB C
Message
ııC J
,
ııJ K
sckEx
ııL Q
)
ııQ R
)
şş 
;
şş 
}
ÿÿ 
catch
€€ 
(
€€ 
	Exception
€€ 
ex
€€ 
)
€€  
{
 
FDebug
‚‚ 
.
‚‚ 
writeLog
‚‚ 
(
‚‚  
ex
‚‚  "
)
‚‚" #
;
‚‚# $
}
ƒƒ 
finally
„„ 
{
…… 
fLogArgs
†† 
=
†† 
null
†† 
;
††  
}
‡‡ 
}
ˆˆ 	
private
ŒŒ 
void
ŒŒ 
pushErrorEvent
ŒŒ #
(
ŒŒ# $
	Exception
 
ex
 
)
 
{
 	
try
 
{
‘‘ 
FDebug
’’ 
.
’’ 
writeLog
’’ 
(
’’  
ex
’’  "
)
’’" #
;
’’# $
m_fEventPusher
”” 
.
”” 
	pushEvent
”” (
(
””( )
new
””) ,,
FTcpClientErrorRaisedEventArgs
””- K
(
””K L
this
””L P
,
””P Q
ex
””R T
.
””T U
Message
””U \
,
””\ ]
ex
””^ `
)
””` a
)
””a b
;
””b c
}
•• 
catch
–– 
(
–– 
	Exception
–– 
ex1
––  
)
––  !
{
—— 
FDebug
˜˜ 
.
˜˜ 
writeLog
˜˜ 
(
˜˜  
ex1
˜˜  #
)
˜˜# $
;
˜˜$ %
}
™™ 
finally
šš 
{
›› 
}
 
}
 	
private
¢¢ 
void
¢¢ 
pushErrorEvent
¢¢ #
(
¢¢# $
string
££ 
localIP
££ 
,
££ 
string
¤¤ 
remoteIP
¤¤ 
,
¤¤ 
Type
¥¥ 
funcType
¥¥ 
,
¥¥ 
string
¦¦ 
function
¦¦ 
,
¦¦ 
	Exception
§§ 
ex
§§ 
)
¨¨ 
{
©© 	
FDebugLogArgs
ªª 
args
ªª 
=
ªª  
null
ªª! %
;
ªª% &
try
¬¬ 
{
­­ 
args
®® 
=
®® 
new
®® 
FDebugLogArgs
®® (
(
®®( )
FDebugLogCategory
®®) :
.
®®: ;
	Exception
®®; D
,
®®D E
$str
®®F V
,
®®V W
funcType
®®X `
,
®®` a
function
®®b j
)
®®j k
;
®®k l
args
¯¯ 
.
¯¯ 
additionInfo
¯¯ !
=
¯¯" #
$str
¯¯$ @
+
¯¯A B
localIP
¯¯C J
+
¯¯K L
$str
¯¯M `
+
¯¯a b
remoteIP
¯¯c k
+
¯¯l m
$str
¯¯n s
+
°°$ %
$str
°°& 2
+
°°3 4
ex
°°5 7
.
°°7 8
ToString
°°8 @
(
°°@ A
)
°°A B
+
°°C D
$str
°°E H
;
°°H I
FDebug
±± 
.
±± 
writeLog
±± 
(
±±  
args
±±  $
)
±±$ %
;
±±% &
m_fEventPusher
³³ 
.
³³ 
	pushEvent
³³ (
(
³³( )
new
³³) ,,
FTcpClientErrorRaisedEventArgs
³³- K
(
³³K L
this
³³L P
,
³³P Q
ex
³³R T
.
³³T U
Message
³³U \
,
³³\ ]
ex
³³^ `
)
³³` a
)
³³a b
;
³³b c
}
´´ 
catch
µµ 
(
µµ 
	Exception
µµ 
ex1
µµ  
)
µµ  !
{
¶¶ 
FDebug
·· 
.
·· 
writeLog
·· 
(
··  
ex1
··  #
)
··# $
;
··$ %
}
¸¸ 
finally
¹¹ 
{
ºº 
args
»» 
=
»» 
null
»» 
;
»» 
}
¼¼ 
}
½½ 	
private
ÁÁ 
void
ÁÁ  
setSocketKeepAlive
ÁÁ '
(
ÁÁ' (
)
ÂÂ 
{
ÃÃ 	
uint
ÄÄ 
dummy
ÄÄ 
=
ÄÄ 
$num
ÄÄ 
;
ÄÄ 
byte
ÅÅ 
[
ÅÅ 
]
ÅÅ 
inValue
ÅÅ 
=
ÅÅ 
null
ÅÅ !
;
ÅÅ! "
try
ÇÇ 
{
ÈÈ 
inValue
ÉÉ 
=
ÉÉ 
new
ÉÉ 
byte
ÉÉ "
[
ÉÉ" #
Marshal
ÉÉ# *
.
ÉÉ* +
SizeOf
ÉÉ+ 1
(
ÉÉ1 2
dummy
ÉÉ2 7
)
ÉÉ7 8
*
ÉÉ9 :
$num
ÉÉ; <
]
ÉÉ< =
;
ÉÉ= >
BitConverter
ÊÊ 
.
ÊÊ 
GetBytes
ÊÊ %
(
ÊÊ% &
(
ÊÊ& '
uint
ÊÊ' +
)
ÊÊ+ ,
$num
ÊÊ, -
)
ÊÊ- .
.
ÊÊ. /
CopyTo
ÊÊ/ 5
(
ÊÊ5 6
inValue
ÊÊ6 =
,
ÊÊ= >
$num
ÊÊ? @
)
ÊÊ@ A
;
ÊÊA B
BitConverter
ËË 
.
ËË 
GetBytes
ËË %
(
ËË% &
(
ËË& '
uint
ËË' +
)
ËË+ ,
$num
ËË, /
)
ËË/ 0
.
ËË0 1
CopyTo
ËË1 7
(
ËË7 8
inValue
ËË8 ?
,
ËË? @
Marshal
ËËA H
.
ËËH I
SizeOf
ËËI O
(
ËËO P
dummy
ËËP U
)
ËËU V
)
ËËV W
;
ËËW X
BitConverter
ÌÌ 
.
ÌÌ 
GetBytes
ÌÌ %
(
ÌÌ% &
(
ÌÌ& '
uint
ÌÌ' +
)
ÌÌ+ ,
$num
ÌÌ, /
)
ÌÌ/ 0
.
ÌÌ0 1
CopyTo
ÌÌ1 7
(
ÌÌ7 8
inValue
ÌÌ8 ?
,
ÌÌ? @
Marshal
ÌÌA H
.
ÌÌH I
SizeOf
ÌÌI O
(
ÌÌO P
dummy
ÌÌP U
)
ÌÌU V
*
ÌÌW X
$num
ÌÌY Z
)
ÌÌZ [
;
ÌÌ[ \
m_tcpClient
ĞĞ 
.
ĞĞ 
Client
ĞĞ "
.
ĞĞ" #
SetSocketOption
ĞĞ# 2
(
ĞĞ2 3
SocketOptionLevel
ĞĞ3 D
.
ĞĞD E
Socket
ĞĞE K
,
ĞĞK L
SocketOptionName
ĞĞM ]
.
ĞĞ] ^
	KeepAlive
ĞĞ^ g
,
ĞĞg h
true
ĞĞi m
)
ĞĞm n
;
ĞĞn o
m_tcpClient
ÑÑ 
.
ÑÑ 
Client
ÑÑ "
.
ÑÑ" #
	IOControl
ÑÑ# ,
(
ÑÑ, -
IOControlCode
ÑÑ- :
.
ÑÑ: ;
KeepAliveValues
ÑÑ; J
,
ÑÑJ K
inValue
ÑÑL S
,
ÑÑS T
null
ÑÑU Y
)
ÑÑY Z
;
ÑÑZ [
}
ÒÒ 
catch
ÓÓ 
(
ÓÓ 
	Exception
ÓÓ 
ex
ÓÓ 
)
ÓÓ  
{
ÔÔ 
FDebug
ÕÕ 
.
ÕÕ 
throwException
ÕÕ %
(
ÕÕ% &
ex
ÕÕ& (
)
ÕÕ( )
;
ÕÕ) *
}
ÖÖ 
finally
×× 
{
ØØ 
}
ÚÚ 
}
ÛÛ 	
private
ßß 
void
ßß 
init
ßß 
(
ßß 
)
àà 
{
áá 	
try
ââ 
{
ãã 
m_fMainSync
ää 
=
ää 
new
ää !
	FCodeLock
ää" +
(
ää+ ,
)
ää, -
;
ää- .
m_fDisconnectSync
åå !
=
åå" #
new
åå$ '
	FCodeLock
åå( 1
(
åå1 2
)
åå2 3
;
åå3 4
	m_recvBuf
ææ 
=
ææ 
new
ææ 
byte
ææ  $
[
ææ$ %
RecvBufferSize
ææ% 3
]
ææ3 4
;
ææ4 5
m_fSocketFlag
çç 
=
çç 
new
çç  #
FSocketFlag
çç$ /
(
çç/ 0
)
çç0 1
;
çç1 2"
m_fRetryConnectTimer
èè $
=
èè% &
new
èè' *
FStaticTimer
èè+ 7
(
èè7 8
)
èè8 9
;
èè9 :
m_fEventPusher
êê 
=
êê  
new
êê! $ 
FSocketEventPusher
êê% 7
(
êê7 8
this
êê8 <
,
êê< =
m_fMode
êê> E
==
êêF H
FTcpClientMode
êêI W
.
êêW X
Server
êêX ^
?
êê_ `
true
êêa e
:
êêf g
false
êêh m
)
êêm n
;
êên o

m_fThdMain
ìì 
=
ìì 
new
ìì  
FThread
ìì! (
(
ìì( )
$str
ìì) ?
)
ìì? @
;
ìì@ A

m_fThdMain
íí 
.
íí 
ThreadJobCalled
íí *
+=
íí+ -
new
íí. 1*
FThreadJobCalledEventHandler
íí2 N
(
ííN O(
m_fThdMain_ThreadJobCalled
ííO i
)
ííi j
;
ííj k

m_fThdMain
îî 
.
îî 
start
îî  
(
îî  !
)
îî! "
;
îî" #
}
ïï 
catch
ğğ 
(
ğğ 
	Exception
ğğ 
ex
ğğ 
)
ğğ  
{
ññ 
FDebug
òò 
.
òò 
throwException
òò %
(
òò% &
ex
òò& (
)
òò( )
;
òò) *
}
óó 
finally
ôô 
{
õõ 
}
÷÷ 
}
øø 	
private
üü 
void
üü 
term
üü 
(
üü 
)
ıı 
{
şş 	
try
ÿÿ 
{
€€ 
if
 
(
 

m_fThdMain
 
!=
 !
null
" &
)
& '
{
‚‚ 

m_fThdMain
ƒƒ 
.
ƒƒ 
stop
ƒƒ #
(
ƒƒ# $
)
ƒƒ$ %
;
ƒƒ% &

m_fThdMain
„„ 
.
„„ 
Dispose
„„ &
(
„„& '
)
„„' (
;
„„( )

m_fThdMain
…… 
.
…… 
ThreadJobCalled
…… .
-=
……/ 1
new
……2 5*
FThreadJobCalledEventHandler
……6 R
(
……R S(
m_fThdMain_ThreadJobCalled
……S m
)
……m n
;
……n o

m_fThdMain
†† 
=
††  
null
††! %
;
††% &
}
‡‡ 
close
ˆˆ 
(
ˆˆ 
)
ˆˆ 
;
ˆˆ 
if
ŒŒ 
(
ŒŒ 
m_fEventPusher
ŒŒ "
!=
ŒŒ# %
null
ŒŒ& *
)
ŒŒ* +
{
 
m_fEventPusher
 "
.
" #(
waitEventHandlingCompleted
# =
(
= >
)
> ?
;
? @
m_fEventPusher
 "
.
" #
Dispose
# *
(
* +
)
+ ,
;
, -
m_fEventPusher
 "
=
# $
null
% )
;
) *
}
‘‘ 
if
•• 
(
•• 
m_fSocketFlag
•• !
!=
••" $
null
••% )
)
••) *
{
–– 
m_fSocketFlag
—— !
.
——! "
Dispose
——" )
(
——) *
)
——* +
;
——+ ,
m_fSocketFlag
˜˜ !
=
˜˜" #
null
˜˜$ (
;
˜˜( )
}
™™ 
if
›› 
(
›› "
m_fRetryConnectTimer
›› (
!=
››) +
null
››, 0
)
››0 1
{
œœ "
m_fRetryConnectTimer
 (
.
( )
Dispose
) 0
(
0 1
)
1 2
;
2 3"
m_fRetryConnectTimer
 (
=
) *
null
+ /
;
/ 0
}
ŸŸ 
if
££ 
(
££ 
m_fDisconnectSync
££ %
!=
££& (
null
££) -
)
££- .
{
¤¤ 
m_fDisconnectSync
¥¥ %
.
¥¥% &
Dispose
¥¥& -
(
¥¥- .
)
¥¥. /
;
¥¥/ 0
m_fDisconnectSync
¦¦ %
=
¦¦& '
null
¦¦( ,
;
¦¦, -
}
§§ 
if
©© 
(
©© 
m_fMainSync
©© 
!=
©©  "
null
©©# '
)
©©' (
{
ªª 
m_fMainSync
«« 
.
««  
Dispose
««  '
(
««' (
)
««( )
;
««) *
m_fMainSync
¬¬ 
=
¬¬  !
null
¬¬" &
;
¬¬& '
}
­­ 
}
®® 
catch
¯¯ 
(
¯¯ 
	Exception
¯¯ 
ex
¯¯ 
)
¯¯  
{
°° 
FDebug
±± 
.
±± 
throwException
±± %
(
±±% &
ex
±±& (
)
±±( )
;
±±) *
}
²² 
finally
³³ 
{
´´ 
}
¶¶ 
}
·· 	
private
»» 
void
»» 
initTcpClient
»» "
(
»»" #
)
¼¼ 
{
½½ 	
try
¾¾ 
{
¿¿ 
termTcpClient
ÀÀ 
(
ÀÀ 
)
ÀÀ 
;
ÀÀ  
m_localPort
ÄÄ 
=
ÄÄ 
$num
ÄÄ 
;
ÄÄ  
m_tcpClient
ÅÅ 
=
ÅÅ 
new
ÅÅ !
	TcpClient
ÅÅ" +
(
ÅÅ+ ,
new
ÅÅ, /

IPEndPoint
ÅÅ0 :
(
ÅÅ: ;
Dns
ÅÅ; >
.
ÅÅ> ?
GetHostAddresses
ÅÅ? O
(
ÅÅO P
	m_localIp
ÅÅP Y
)
ÅÅY Z
[
ÅÅZ [
$num
ÅÅ[ \
]
ÅÅ\ ]
,
ÅÅ] ^
m_localPort
ÅÅ_ j
)
ÅÅj k
)
ÅÅk l
;
ÅÅl m
m_tcpClient
ÆÆ 
.
ÆÆ 
ReceiveBufferSize
ÆÆ -
=
ÆÆ. /
RecvBufferSize
ÆÆ0 >
;
ÆÆ> ?
m_tcpClient
ÇÇ 
.
ÇÇ 
SendBufferSize
ÇÇ *
=
ÇÇ+ ,
SendBufferSize
ÇÇ- ;
;
ÇÇ; <
m_fSocketFlag
ËË 
.
ËË 
init
ËË "
(
ËË" #
)
ËË# $
;
ËË$ %
}
ÌÌ 
catch
ÍÍ 
(
ÍÍ 
	Exception
ÍÍ 
ex
ÍÍ 
)
ÍÍ  
{
ÎÎ 
FDebug
ÏÏ 
.
ÏÏ 
throwException
ÏÏ %
(
ÏÏ% &
ex
ÏÏ& (
)
ÏÏ( )
;
ÏÏ) *
}
ĞĞ 
finally
ÑÑ 
{
ÒÒ 
}
ÔÔ 
}
ÕÕ 	
private
ÙÙ 
void
ÙÙ 
termTcpClient
ÙÙ "
(
ÙÙ" #
)
ÚÚ 
{
ÛÛ 	
try
ÜÜ 
{
İİ 
if
ŞŞ 
(
ŞŞ 
m_tcpClient
ŞŞ 
==
ŞŞ  "
null
ŞŞ# '
)
ŞŞ' (
{
ßß 
return
àà 
;
àà 
}
áá 
m_fSocketFlag
èè 
.
èè 
waitSendCompleted
èè /
(
èè/ 0
)
èè0 1
;
èè1 2
m_tcpClient
éé 
.
éé 
Close
éé !
(
éé! "
)
éé" #
;
éé# $
m_fSocketFlag
ğğ 
.
ğğ 
waitAllCompleted
ğğ .
(
ğğ. /
)
ğğ/ 0
;
ğğ0 1
if
ôô 
(
ôô 
m_networkStream
ôô #
!=
ôô$ &
null
ôô' +
)
ôô+ ,
{
õõ 
m_networkStream
öö #
.
öö# $
Dispose
öö$ +
(
öö+ ,
)
öö, -
;
öö- .
m_networkStream
÷÷ #
=
÷÷$ %
null
÷÷& *
;
÷÷* +
}
øø 
m_tcpClient
ùù 
=
ùù 
null
ùù "
;
ùù" #
}
úú 
catch
ûû 
(
ûû 
	Exception
ûû 
ex
ûû 
)
ûû  
{
üü 
FDebug
ıı 
.
ıı 
throwException
ıı %
(
ıı% &
ex
ıı& (
)
ıı( )
;
ıı) *
}
şş 
finally
ÿÿ 
{
€€ 
}
‚‚ 
}
ƒƒ 	
public
‡‡ 
void
‡‡ 
connect
‡‡ 
(
‡‡ 
)
ˆˆ 
{
‰‰ 	
try
ŠŠ 
{
‹‹ 
m_fMainSync
ŒŒ 
.
ŒŒ 
wait
ŒŒ  
(
ŒŒ  !
)
ŒŒ! "
;
ŒŒ" #
if
““ 
(
““ 
m_fMode
““ 
==
““ 
FTcpClientMode
““ -
.
““- .
Server
““. 4
)
““4 5
{
”” 
FDebug
•• 
.
•• 
throwFException
•• *
(
••* +
string
••+ 1
.
••1 2
Format
••2 8
(
••8 9

FConstants
••9 C
.
••C D

err_m_0009
••D N
,
••N O
$str
••P ]
,
••] ^
$str
••_ o
)
••o p
)
••p q
;
••q r
}
–– 
if
›› 
(
›› 
m_fState
›› 
!=
›› 
FTcpClientState
››  /
.
››/ 0
Closed
››0 6
)
››6 7
{
œœ 
FDebug
 
.
 
throwFException
 *
(
* +
string
+ 1
.
1 2
Format
2 8
(
8 9

FConstants
9 C
.
C D

err_m_0011
D N
,
N O
$str
P e
,
e f
$str
g o
)
o p
)
p q
;
q r
}
 
initTcpClient
¢¢ 
(
¢¢ 
)
¢¢ 
;
¢¢  
changeState
££ 
(
££ 
FTcpClientState
££ +
.
££+ ,
Opened
££, 2
)
££2 3
;
££3 4
}
¤¤ 
catch
¥¥ 
(
¥¥ 
	Exception
¥¥ 
ex
¥¥ 
)
¥¥  
{
¦¦ 
FDebug
§§ 
.
§§ 
throwException
§§ %
(
§§% &
ex
§§& (
)
§§( )
;
§§) *
}
¨¨ 
finally
©© 
{
ªª 
m_fMainSync
«« 
.
«« 
set
«« 
(
««  
)
««  !
;
««! "
}
¬¬ 
}
­­ 	
public
±± 
void
±± 
	reconnect
±± 
(
±± 
)
²² 
{
³³ 	
try
´´ 
{
µµ 
m_fMainSync
¶¶ 
.
¶¶ 
wait
¶¶  
(
¶¶  !
)
¶¶! "
;
¶¶" #
if
½½ 
(
½½ 
m_fMode
½½ 
==
½½ 
FTcpClientMode
½½ -
.
½½- .
Server
½½. 4
)
½½4 5
{
¾¾ 
FDebug
¿¿ 
.
¿¿ 
throwFException
¿¿ *
(
¿¿* +
string
¿¿+ 1
.
¿¿1 2
Format
¿¿2 8
(
¿¿8 9

FConstants
¿¿9 C
.
¿¿C D

err_m_0009
¿¿D N
,
¿¿N O
$str
¿¿P ]
,
¿¿] ^
$str
¿¿_ q
)
¿¿q r
)
¿¿r s
;
¿¿s t
}
ÀÀ 
if
ÂÂ 
(
ÂÂ 
m_fState
ÂÂ 
!=
ÂÂ 
FTcpClientState
ÂÂ  /
.
ÂÂ/ 0
	Connected
ÂÂ0 9
)
ÂÂ9 :
{
ÃÃ 
return
ÄÄ 
;
ÄÄ 
}
ÅÅ 
doReconnect
ÉÉ 
(
ÉÉ 
)
ÉÉ 
;
ÉÉ 
}
ÊÊ 
catch
ËË 
(
ËË 
	Exception
ËË 
ex
ËË 
)
ËË  
{
ÌÌ 
FDebug
ÍÍ 
.
ÍÍ 
throwException
ÍÍ %
(
ÍÍ% &
ex
ÍÍ& (
)
ÍÍ( )
;
ÍÍ) *
}
ÎÎ 
finally
ÏÏ 
{
ĞĞ 
m_fMainSync
ÑÑ 
.
ÑÑ 
set
ÑÑ 
(
ÑÑ  
)
ÑÑ  !
;
ÑÑ! "
}
ÒÒ 
}
ÓÓ 	
public
×× 
void
×× 
send
×× 
(
×× 
FSocketSendData
ØØ 
fData
ØØ !
)
ÙÙ 
{
ÚÚ 	
try
ÛÛ 
{
ÜÜ 
m_fMainSync
İİ 
.
İİ 
wait
İİ  
(
İİ  !
)
İİ! "
;
İİ" #
if
ää 
(
ää 
m_fState
ää 
!=
ää 
FTcpClientState
ää  /
.
ää/ 0
	Connected
ää0 9
)
ää9 :
{
åå 
FDebug
ææ 
.
ææ 
throwFException
ææ *
(
ææ* +
string
ææ+ 1
.
ææ1 2
Format
ææ2 8
(
ææ8 9

FConstants
ææ9 C
.
ææC D

err_m_0012
ææD N
,
ææN O
$str
ææP W
)
ææW X
)
ææX Y
;
ææY Z
}
çç 
doSend
ëë 
(
ëë 
fData
ëë 
)
ëë 
;
ëë 
}
ìì 
catch
íí 
(
íí 
	Exception
íí 
ex
íí 
)
íí  
{
îî 
FDebug
ïï 
.
ïï 
throwException
ïï %
(
ïï% &
ex
ïï& (
)
ïï( )
;
ïï) *
}
ğğ 
finally
ññ 
{
òò 
m_fMainSync
óó 
.
óó 
set
óó 
(
óó  
)
óó  !
;
óó! "
}
ôô 
}
õõ 	
public
ùù 
void
ùù 
close
ùù 
(
ùù 
)
úú 
{
ûû 	
try
üü 
{
ıı 
m_fMainSync
şş 
.
şş 
wait
şş  
(
şş  !
)
şş! "
;
şş" #
doClose
‚‚ 
(
‚‚ 
)
‚‚ 
;
‚‚ 
}
ƒƒ 
catch
„„ 
(
„„ 
	Exception
„„ 
ex
„„ 
)
„„  
{
…… 
FDebug
†† 
.
†† 
throwException
†† %
(
††% &
ex
††& (
)
††( )
;
††) *
}
‡‡ 
finally
ˆˆ 
{
‰‰ 
m_fMainSync
ŠŠ 
.
ŠŠ 
set
ŠŠ 
(
ŠŠ  
)
ŠŠ  !
;
ŠŠ! "
}
‹‹ 
}
ŒŒ 	
public
 
void
 
suspendEvent
  
(
  !
)
‘‘ 
{
’’ 	
try
““ 
{
”” 
m_fEventPusher
•• 
.
•• 
suspend
•• &
(
••& '
)
••' (
;
••( )
}
–– 
catch
—— 
(
—— 
	Exception
—— 
ex
—— 
)
——  
{
˜˜ 
FDebug
™™ 
.
™™ 
throwException
™™ %
(
™™% &
ex
™™& (
)
™™( )
;
™™) *
}
šš 
finally
›› 
{
œœ 
}
 
}
ŸŸ 	
public
££ 
void
££ 
resumeEvent
££ 
(
££  
)
¤¤ 
{
¥¥ 	
try
¦¦ 
{
§§ 
m_fEventPusher
¨¨ 
.
¨¨ 
resume
¨¨ %
(
¨¨% &
)
¨¨& '
;
¨¨' (
}
©© 
catch
ªª 
(
ªª 
	Exception
ªª 
ex
ªª 
)
ªª  
{
«« 
FDebug
¬¬ 
.
¬¬ 
throwException
¬¬ %
(
¬¬% &
ex
¬¬& (
)
¬¬( )
;
¬¬) *
}
­­ 
finally
®® 
{
¯¯ 
}
±± 
}
²² 	
private
¶¶ 
void
¶¶ 
doClose
¶¶ 
(
¶¶ 
)
·· 
{
¸¸ 	
FDebugLogArgs
¹¹ 
fLogArgs
¹¹ "
=
¹¹# $
null
¹¹% )
;
¹¹) *
try
»» 
{
¼¼ 
if
½½ 
(
½½ 
m_fState
½½ 
==
½½ 
FTcpClientState
½½  /
.
½½/ 0
Closed
½½0 6
)
½½6 7
{
¾¾ 
return
¿¿ 
;
¿¿ 
}
ÀÀ 
termTcpClient
ÄÄ 
(
ÄÄ 
)
ÄÄ 
;
ÄÄ  
changeState
ÅÅ 
(
ÅÅ 
FTcpClientState
ÅÅ +
.
ÅÅ+ ,
Closed
ÅÅ, 2
)
ÅÅ2 3
;
ÅÅ3 4
fLogArgs
ÌÌ 
=
ÌÌ 
new
ÌÌ 
FDebugLogArgs
ÌÌ ,
(
ÌÌ, -
FDebugLogCategory
ÌÌ- >
.
ÌÌ> ?
Information
ÌÌ? J
,
ÌÌJ K
$str
ÌÌL \
,
ÌÌ\ ]
this
ÌÌ^ b
.
ÌÌb c
GetType
ÌÌc j
(
ÌÌj k
)
ÌÌk l
,
ÌÌl m
$str
ÌÌn w
)
ÌÌw x
;
ÌÌx y
fLogArgs
ÍÍ 
.
ÍÍ 
additionInfo
ÍÍ %
=
ÍÍ& '
$str
ÍÍ( 0
+
ÍÍ1 2
m_fMode
ÍÍ3 :
.
ÍÍ: ;
ToString
ÍÍ; C
(
ÍÍC D
)
ÍÍD E
+
ÍÍF G
$str
ÍÍH V
+
ÍÍW X
	m_localIp
ÍÍY b
+
ÍÍc d
$str
ÍÍe u
+
ÍÍv w
m_localPortÍÍx ƒ
.ÍÍƒ „
ToStringÍÍ„ Œ
(ÍÍŒ 
)ÍÍ 
+ÍÍ 
$strÍÍ‘  
+ÍÍ¡ ¢

m_remoteIpÍÍ£ ­
+ÍÍ® ¯
$strÍÍ° Á
+ÍÍÂ Ã
m_remotePortÍÍÄ Ğ
.ÍÍĞ Ñ
ToStringÍÍÑ Ù
(ÍÍÙ Ú
)ÍÍÚ Û
+ÍÍÜ İ
$strÍÍŞ á
;ÍÍá â
FDebug
ÎÎ 
.
ÎÎ 
writeLog
ÎÎ 
(
ÎÎ  
fLogArgs
ÎÎ  (
)
ÎÎ( )
;
ÎÎ) *
}
ÏÏ 
catch
ĞĞ 
(
ĞĞ 
	Exception
ĞĞ 
ex
ĞĞ 
)
ĞĞ  
{
ÑÑ 
FDebug
ÒÒ 
.
ÒÒ 
throwException
ÒÒ %
(
ÒÒ% &
ex
ÒÒ& (
)
ÒÒ( )
;
ÒÒ) *
}
ÓÓ 
finally
ÔÔ 
{
ÕÕ 
}
×× 
}
ØØ 	
private
ÜÜ 
void
ÜÜ 
doReconnect
ÜÜ  
(
ÜÜ  !
)
İİ 
{
ŞŞ 	
try
ßß 
{
àà "
m_fRetryConnectTimer
ää $
.
ää$ %
start
ää% *
(
ää* +"
m_retryConnectPeriod
ää+ ?
)
ää? @
;
ää@ A
changeState
èè 
(
èè 
FTcpClientState
èè +
.
èè+ ,
Opened
èè, 2
)
èè2 3
;
èè3 4
initTcpClient
éé 
(
éé 
)
éé 
;
éé  
}
êê 
catch
ëë 
(
ëë 
	Exception
ëë 
ex
ëë 
)
ëë  
{
ìì 
FDebug
íí 
.
íí 
throwException
íí %
(
íí% &
ex
íí& (
)
íí( )
;
íí) *
}
îî 
finally
ïï 
{
ğğ 
}
òò 
}
óó 	
private
÷÷ 
void
÷÷ 
doDisconnect
÷÷ !
(
÷÷! "
)
øø 
{
ùù 	
FDebugLogArgs
úú 
fLogArgs
úú "
=
úú# $
null
úú% )
;
úú) *
try
üü 
{
ıı 
m_fDisconnectSync
şş !
.
şş! "
wait
şş" &
(
şş& '
)
şş' (
;
şş( )
if
‚‚ 
(
‚‚ 
m_fSocketFlag
‚‚ !
.
‚‚! "
disconnected
‚‚" .
)
‚‚. /
{
ƒƒ 
return
„„ 
;
„„ 
}
…… 
fLogArgs
ŒŒ 
=
ŒŒ 
new
ŒŒ 
FDebugLogArgs
ŒŒ ,
(
ŒŒ, -
FDebugLogCategory
ŒŒ- >
.
ŒŒ> ?
Information
ŒŒ? J
,
ŒŒJ K
$str
ŒŒL a
,
ŒŒa b
this
ŒŒc g
.
ŒŒg h
GetType
ŒŒh o
(
ŒŒo p
)
ŒŒp q
,
ŒŒq r
$strŒŒs 
)ŒŒ ‚
;ŒŒ‚ ƒ
fLogArgs
 
.
 
additionInfo
 %
=
& '
$str
( 0
+
1 2
m_fMode
3 :
.
: ;
ToString
; C
(
C D
)
D E
+
F G
$str
H V
+
W X
	m_localIp
Y b
+
c d
$str
e u
+
v w
m_localPortx ƒ
.ƒ „
ToString„ Œ
(Œ 
) 
+ 
$str‘  
+¡ ¢

m_remoteIp£ ­
+® ¯
$str° Á
+Â Ã
m_remotePortÄ Ğ
.Ğ Ñ
ToStringÑ Ù
(Ù Ú
)Ú Û
+Ü İ
$strŞ á
;á â
FDebug
 
.
 
writeLog
 
(
  
fLogArgs
  (
)
( )
;
) *
m_fSocketFlag
’’ 
.
’’ 
disconnected
’’ *
=
’’+ ,
true
’’- 1
;
’’1 2
}
““ 
catch
”” 
(
”” 
	Exception
”” 
ex
”” 
)
””  
{
•• 
pushErrorEvent
–– 
(
–– 
ex
–– !
)
––! "
;
––" #
}
—— 
finally
˜˜ 
{
™™ 
m_fDisconnectSync
šš !
.
šš! "
set
šš" %
(
šš% &
)
šš& '
;
šš' (
}
›› 
}
œœ 	
private
   
void
   
	doConnect
   
(
   
)
¡¡ 
{
¢¢ 	
string
££ 
local
££ 
=
££ 
string
££ !
.
££! "
Empty
££" '
;
££' (
string
¤¤ 
remote
¤¤ 
=
¤¤ 
string
¤¤ "
.
¤¤" #
Empty
¤¤# (
;
¤¤( )
try
¥¥ 
{
¦¦ 
m_fSocketFlag
§§ 
.
§§ 
beginConnect
§§ *
(
§§* +
)
§§+ ,
;
§§, -
m_tcpClient
¨¨ 
.
¨¨ 
BeginConnect
¨¨ (
(
¨¨( )

m_remoteIp
¨¨) 3
,
¨¨3 4
m_remotePort
¨¨5 A
,
¨¨A B
new
¨¨C F
AsyncCallback
¨¨G T
(
¨¨T U
doConnectCallback
¨¨U f
)
¨¨f g
,
¨¨g h
this
¨¨i m
)
¨¨m n
;
¨¨n o
}
©© 
catch
ªª 
(
ªª 
	Exception
ªª 
ex
ªª 
)
ªª  
{
«« 
if
¬¬ 
(
¬¬ 
ex
¬¬ 
is
¬¬ 
SocketException
¬¬ )
)
¬¬) *
{
­­ 
if
®® 
(
®® 
(
®® 
ex
®® 
as
®® 
SocketException
®® .
)
®®. /
.
®®/ 0
	ErrorCode
®®0 9
.
®®9 :
Equals
®®: @
(
®®@ A
$num
®®A F
)
®®F G
)
®®G H
{
¯¯ 
close
°° 
(
°° 
)
°° 
;
°°  
}
±± "
pushSocketErrorEvent
³³ (
(
³³( )
$str
³³) 4
,
³³4 5
(
³³6 7
SocketException
³³7 F
)
³³F G
ex
³³G I
)
³³I J
;
³³J K
}
´´ 
else
µµ 
if
µµ 
(
µµ 
ex
µµ 
is
µµ %
ObjectDisposedException
µµ 6
)
µµ6 7
{
¶¶ 
System
·· 
.
·· 
Diagnostics
·· &
.
··& '
Debug
··' ,
.
··, -
	WriteLine
··- 6
(
··6 7
ex
··7 9
.
··9 :
ToString
··: B
(
··B C
)
··C D
)
··D E
;
··E F
}
¸¸ 
else
¹¹ 
{
ºº 
local
¼¼ 
=
¼¼ 
	m_localIp
¼¼ %
+
¼¼& '
$str
¼¼( +
+
¼¼, -
m_localPort
¼¼. 9
.
¼¼9 :
ToString
¼¼: B
(
¼¼B C
)
¼¼C D
;
¼¼D E
remote
½½ 
=
½½ 

m_remoteIp
½½ '
+
½½( )
$str
½½* -
+
½½. /
m_remotePort
½½0 <
.
½½< =
ToString
½½= E
(
½½E F
)
½½F G
;
½½G H
pushErrorEvent
¾¾ "
(
¾¾" #
local
¾¾# (
,
¾¾( )
remote
¾¾* 0
,
¾¾0 1
this
¾¾2 6
.
¾¾6 7
GetType
¾¾7 >
(
¾¾> ?
)
¾¾? @
,
¾¾@ A
$str
¾¾B M
,
¾¾M N
ex
¾¾O Q
)
¾¾Q R
;
¾¾R S
}
¿¿ 
m_fSocketFlag
ÀÀ 
.
ÀÀ 

endConnect
ÀÀ (
(
ÀÀ( )
)
ÀÀ) *
;
ÀÀ* +"
m_fRetryConnectTimer
ÉÉ $
.
ÉÉ$ %
start
ÉÉ% *
(
ÉÉ* +"
m_retryConnectPeriod
ÉÉ+ ?
)
ÉÉ? @
;
ÉÉ@ A
}
ÊÊ 
finally
ËË 
{
ÌÌ 
}
ÎÎ 
}
ÏÏ 	
private
ÓÓ 
void
ÓÓ 
doConnectCallback
ÓÓ &
(
ÓÓ& '
IAsyncResult
ÔÔ 
ar
ÔÔ 
)
ÕÕ 
{
ÖÖ 	
FDebugLogArgs
×× 
fLogArgs
×× "
=
××# $
null
××% )
;
××) *
try
ÙÙ 
{
ÚÚ 
if
ÛÛ 
(
ÛÛ 
m_tcpClient
ÛÛ 
==
ÛÛ  "
null
ÛÛ# '
||
ÛÛ( *
m_tcpClient
ÛÛ+ 6
.
ÛÛ6 7
Client
ÛÛ7 =
==
ÛÛ> @
null
ÛÛA E
)
ÛÛE F
{
ÜÜ 
return
İİ 
;
İİ 
}
ŞŞ 
m_tcpClient
ââ 
.
ââ 

EndConnect
ââ &
(
ââ& '
ar
ââ' )
)
ââ) *
;
ââ* + 
setSocketKeepAlive
ãã "
(
ãã" #
)
ãã# $
;
ãã$ %
m_networkStream
åå 
=
åå  !
m_tcpClient
åå" -
.
åå- .
	GetStream
åå. 7
(
åå7 8
)
åå8 9
;
åå9 :
m_localPort
çç 
=
çç 
(
çç 
(
çç  

IPEndPoint
çç  *
)
çç* +
m_tcpClient
çç+ 6
.
çç6 7
Client
çç7 =
.
çç= >
LocalEndPoint
çç> K
)
ççK L
.
ççL M
Port
ççM Q
;
ççQ R
fLogArgs
îî 
=
îî 
new
îî 
FDebugLogArgs
îî ,
(
îî, -
FDebugLogCategory
îî- >
.
îî> ?
Information
îî? J
,
îîJ K
$str
îîL ^
,
îî^ _
this
îî` d
.
îîd e
GetType
îîe l
(
îîl m
)
îîm n
,
îîn o
$strîîp ƒ
)îîƒ „
;îî„ …
fLogArgs
ïï 
.
ïï 
additionInfo
ïï %
=
ïï& '
$str
ïï( 0
+
ïï1 2
m_fMode
ïï3 :
.
ïï: ;
ToString
ïï; C
(
ïïC D
)
ïïD E
+
ïïF G
$str
ïïH V
+
ïïW X
	m_localIp
ïïY b
+
ïïc d
$str
ïïe u
+
ïïv w
m_localPortïïx ƒ
.ïïƒ „
ToStringïï„ Œ
(ïïŒ 
)ïï 
+ïï 
$strïï‘  
+ïï¡ ¢

m_remoteIpïï£ ­
+ïï® ¯
$strïï° Á
+ïïÂ Ã
m_remotePortïïÄ Ğ
.ïïĞ Ñ
ToStringïïÑ Ù
(ïïÙ Ú
)ïïÚ Û
+ïïÜ İ
$strïïŞ á
;ïïá â
FDebug
ğğ 
.
ğğ 
writeLog
ğğ 
(
ğğ  
fLogArgs
ğğ  (
)
ğğ( )
;
ğğ) *
changeState
ôô 
(
ôô 
FTcpClientState
ôô +
.
ôô+ ,
	Connected
ôô, 5
)
ôô5 6
;
ôô6 7
}
õõ 
catch
öö 
(
öö 
	Exception
öö 
ex
öö 
)
öö  
{
÷÷ 
if
øø 
(
øø 
ex
øø 
is
øø 
SocketException
øø )
)
øø) *
{
ùù 
if
úú 
(
úú 
(
ûû 
(
ûû 
SocketException
ûû )
)
ûû) *
ex
ûû* ,
)
ûû, -
.
ûû- .
SocketErrorCode
ûû. =
==
ûû> @
SocketError
ûûA L
.
ûûL M
ConnectionRefused
ûûM ^
||
ûû_ a
(
üü 
(
üü 
SocketException
üü )
)
üü) *
ex
üü* ,
)
üü, -
.
üü- .
SocketErrorCode
üü. =
==
üü> @
SocketError
üüA L
.
üüL M
TimedOut
üüM U
)
ıı 
{
şş 
return
ÿÿ 
;
ÿÿ 
}
€	€	 
else
		 
{
‚	‚	 "
pushSocketErrorEvent
ƒ	ƒ	 ,
(
ƒ	ƒ	, -
$str
ƒ	ƒ	- @
,
ƒ	ƒ	@ A
(
ƒ	ƒ	B C
SocketException
ƒ	ƒ	C R
)
ƒ	ƒ	R S
ex
ƒ	ƒ	S U
)
ƒ	ƒ	U V
;
ƒ	ƒ	V W
}
„	„	 
}
…	…	 
else
†	†	 
if
†	†	 
(
†	†	 
ex
†	†	 
is
†	†	 %
ObjectDisposedException
†	†	 6
)
†	†	6 7
{
‡	‡	 
System
ˆ	ˆ	 
.
ˆ	ˆ	 
Diagnostics
ˆ	ˆ	 &
.
ˆ	ˆ	& '
Debug
ˆ	ˆ	' ,
.
ˆ	ˆ	, -
	WriteLine
ˆ	ˆ	- 6
(
ˆ	ˆ	6 7
ex
ˆ	ˆ	7 9
.
ˆ	ˆ	9 :
ToString
ˆ	ˆ	: B
(
ˆ	ˆ	B C
)
ˆ	ˆ	C D
)
ˆ	ˆ	D E
;
ˆ	ˆ	E F
}
‰	‰	 
else
Š	Š	 
{
‹	‹	 
pushErrorEvent
Œ	Œ	 "
(
Œ	Œ	" #
ex
Œ	Œ	# %
)
Œ	Œ	% &
;
Œ	Œ	& '
}
		 "
m_fRetryConnectTimer
–	–	 $
.
–	–	$ %
start
–	–	% *
(
–	–	* +"
m_retryConnectPeriod
–	–	+ ?
)
–	–	? @
;
–	–	@ A
}
—	—	 
finally
˜	˜	 
{
™	™	 
fLogArgs
š	š	 
=
š	š	 
null
š	š	 
;
š	š	  
m_fSocketFlag
›	›	 
.
›	›	 

endConnect
›	›	 (
(
›	›	( )
)
›	›	) *
;
›	›	* +
}
œ	œ	 
}
		 	
private
¡	¡	 
void
¡	¡	 
	doReceive
¡	¡	 
(
¡	¡	 
)
¢	¢	 
{
£	£	 	
try
¤	¤	 
{
¥	¥	 
m_fSocketFlag
¦	¦	 
.
¦	¦	 
beginReceive
¦	¦	 *
(
¦	¦	* +
)
¦	¦	+ ,
;
¦	¦	, -
m_networkStream
§	§	 
.
§	§	  
	BeginRead
§	§	  )
(
§	§	) *
	m_recvBuf
§	§	* 3
,
§	§	3 4
$num
§	§	5 6
,
§	§	6 7
	m_recvBuf
§	§	8 A
.
§	§	A B
Length
§	§	B H
,
§	§	H I
new
§	§	J M
AsyncCallback
§	§	N [
(
§	§	[ \
doReceiveCallback
§	§	\ m
)
§	§	m n
,
§	§	n o
this
§	§	p t
)
§	§	t u
;
§	§	u v
}
¨	¨	 
catch
©	©	 
(
©	©	 
	Exception
©	©	 
ex
©	©	 
)
©	©	  
{
ª	ª	 
if
«	«	 
(
«	«	 
ex
«	«	 
is
«	«	 
IOException
«	«	 %
)
«	«	% &
{
¬	¬	 
if
­	­	 
(
­	­	 
ex
­	­	 
.
­	­	 
InnerException
­	­	 )
is
­	­	* ,
SocketException
­	­	- <
)
­	­	< =
{
®	®	 "
pushSocketErrorEvent
¯	¯	 ,
(
¯	¯	, -
$str
¯	¯	- 8
,
¯	¯	8 9
(
¯	¯	: ;
SocketException
¯	¯	; J
)
¯	¯	J K
ex
¯	¯	K M
.
¯	¯	M N
InnerException
¯	¯	N \
)
¯	¯	\ ]
;
¯	¯	] ^
doDisconnect
¶	¶	 $
(
¶	¶	$ %
)
¶	¶	% &
;
¶	¶	& '
}
·	·	 
else
¸	¸	 
if
¸	¸	 
(
¸	¸	 
ex
¸	¸	 
.
¸	¸	  
InnerException
¸	¸	  .
is
¸	¸	/ 1%
ObjectDisposedException
¸	¸	2 I
)
¸	¸	I J
{
¹	¹	 
System
º	º	 
.
º	º	 
Diagnostics
º	º	 *
.
º	º	* +
Debug
º	º	+ 0
.
º	º	0 1
	WriteLine
º	º	1 :
(
º	º	: ;
ex
º	º	; =
.
º	º	= >
InnerException
º	º	> L
.
º	º	L M
ToString
º	º	M U
(
º	º	U V
)
º	º	V W
)
º	º	W X
;
º	º	X Y
}
»	»	 
else
¼	¼	 
{
½	½	 
pushErrorEvent
¾	¾	 &
(
¾	¾	& '
ex
¾	¾	' )
.
¾	¾	) *
InnerException
¾	¾	* 8
==
¾	¾	9 ;
null
¾	¾	< @
?
¾	¾	A B
ex
¾	¾	C E
:
¾	¾	F G
ex
¾	¾	H J
.
¾	¾	J K
InnerException
¾	¾	K Y
)
¾	¾	Y Z
;
¾	¾	Z [
}
¿	¿	 
}
À	À	 
else
Á	Á	 
if
Á	Á	 
(
Á	Á	 
ex
Á	Á	 
is
Á	Á	 %
ObjectDisposedException
Á	Á	 6
)
Á	Á	6 7
{
Â	Â	 
System
Ã	Ã	 
.
Ã	Ã	 
Diagnostics
Ã	Ã	 &
.
Ã	Ã	& '
Debug
Ã	Ã	' ,
.
Ã	Ã	, -
	WriteLine
Ã	Ã	- 6
(
Ã	Ã	6 7
ex
Ã	Ã	7 9
.
Ã	Ã	9 :
ToString
Ã	Ã	: B
(
Ã	Ã	B C
)
Ã	Ã	C D
)
Ã	Ã	D E
;
Ã	Ã	E F
}
Ä	Ä	 
else
Å	Å	 
{
Æ	Æ	 
pushErrorEvent
Ç	Ç	 "
(
Ç	Ç	" #
ex
Ç	Ç	# %
)
Ç	Ç	% &
;
Ç	Ç	& '
}
È	È	 
m_fSocketFlag
É	É	 
.
É	É	 

endReceive
É	É	 (
(
É	É	( )
)
É	É	) *
;
É	É	* +
}
Ê	Ê	 
finally
Ë	Ë	 
{
Ì	Ì	 
}
Î	Î	 
}
Ï	Ï	 	
private
Ó	Ó	 
void
Ó	Ó	 
doReceiveCallback
Ó	Ó	 &
(
Ó	Ó	& '
IAsyncResult
Ô	Ô	 
ar
Ô	Ô	 
)
Õ	Õ	 
{
Ö	Ö	 	
int
×	×	 
length
×	×	 
=
×	×	 
$num
×	×	 
;
×	×	 
byte
Ø	Ø	 
[
Ø	Ø	 
]
Ø	Ø	 
data
Ø	Ø	 
=
Ø	Ø	 
null
Ø	Ø	 
;
Ø	Ø	 
try
Ú	Ú	 
{
Û	Û	 
m_fSocketFlag
Ü	Ü	 
.
Ü	Ü	 
waitSendCompleted
Ü	Ü	 /
(
Ü	Ü	/ 0
)
Ü	Ü	0 1
;
Ü	Ü	1 2
length
à	à	 
=
à	à	 
m_networkStream
à	à	 (
.
à	à	( )
EndRead
à	à	) 0
(
à	à	0 1
ar
à	à	1 3
)
à	à	3 4
;
à	à	4 5
if
á	á	 
(
á	á	 
length
á	á	 
==
á	á	 
$num
á	á	 
)
á	á	  
{
â	â	 
doDisconnect
ã	ã	  
(
ã	ã	  !
)
ã	ã	! "
;
ã	ã	" #
return
ä	ä	 
;
ä	ä	 
}
å	å	 
data
é	é	 
=
é	é	 
new
é	é	 
byte
é	é	 
[
é	é	  
length
é	é	  &
]
é	é	& '
;
é	é	' (
Buffer
ê	ê	 
.
ê	ê	 
	BlockCopy
ê	ê	  
(
ê	ê	  !
	m_recvBuf
ê	ê	! *
,
ê	ê	* +
$num
ê	ê	, -
,
ê	ê	- .
data
ê	ê	/ 3
,
ê	ê	3 4
$num
ê	ê	5 6
,
ê	ê	6 7
length
ê	ê	8 >
)
ê	ê	> ?
;
ê	ê	? @
m_fEventPusher
ë	ë	 
.
ë	ë	 
	pushEvent
ë	ë	 (
(
ë	ë	( )
new
ë	ë	) ,-
FTcpClientDataReceivedEventArgs
ë	ë	- L
(
ë	ë	L M
this
ë	ë	M Q
,
ë	ë	Q R
data
ë	ë	S W
)
ë	ë	W X
)
ë	ë	X Y
;
ë	ë	Y Z
}
ì	ì	 
catch
í	í	 
(
í	í	 
	Exception
í	í	 
ex
í	í	 
)
í	í	  
{
î	î	 
if
ï	ï	 
(
ï	ï	 
ex
ï	ï	 
is
ï	ï	 
IOException
ï	ï	 %
)
ï	ï	% &
{
ğ	ğ	 
if
ñ	ñ	 
(
ñ	ñ	 
ex
ñ	ñ	 
.
ñ	ñ	 
InnerException
ñ	ñ	 )
is
ñ	ñ	* ,
SocketException
ñ	ñ	- <
)
ñ	ñ	< =
{
ò	ò	 "
pushSocketErrorEvent
ó	ó	 ,
(
ó	ó	, -
$str
ó	ó	- @
,
ó	ó	@ A
(
ó	ó	B C
SocketException
ó	ó	C R
)
ó	ó	R S
ex
ó	ó	S U
.
ó	ó	U V
InnerException
ó	ó	V d
)
ó	ó	d e
;
ó	ó	e f
doDisconnect
ú	ú	 $
(
ú	ú	$ %
)
ú	ú	% &
;
ú	ú	& '
}
û	û	 
else
ü	ü	 
if
ü	ü	 
(
ü	ü	 
ex
ü	ü	 
.
ü	ü	  
InnerException
ü	ü	  .
is
ü	ü	/ 1%
ObjectDisposedException
ü	ü	2 I
)
ü	ü	I J
{
ı	ı	 
System
ş	ş	 
.
ş	ş	 
Diagnostics
ş	ş	 *
.
ş	ş	* +
Debug
ş	ş	+ 0
.
ş	ş	0 1
	WriteLine
ş	ş	1 :
(
ş	ş	: ;
ex
ş	ş	; =
.
ş	ş	= >
InnerException
ş	ş	> L
.
ş	ş	L M
ToString
ş	ş	M U
(
ş	ş	U V
)
ş	ş	V W
)
ş	ş	W X
;
ş	ş	X Y
}
ÿ	ÿ	 
else
€
€
 
{


 
pushErrorEvent
‚
‚
 &
(
‚
‚
& '
ex
‚
‚
' )
.
‚
‚
) *
InnerException
‚
‚
* 8
==
‚
‚
9 ;
null
‚
‚
< @
?
‚
‚
A B
ex
‚
‚
C E
:
‚
‚
F G
ex
‚
‚
H J
.
‚
‚
J K
InnerException
‚
‚
K Y
)
‚
‚
Y Z
;
‚
‚
Z [
}
ƒ
ƒ
 
}
„
„
 
else
…
…
 
if
…
…
 
(
…
…
 
ex
…
…
 
is
…
…
 %
ObjectDisposedException
…
…
 6
)
…
…
6 7
{
†
†
 
System
‡
‡
 
.
‡
‡
 
Diagnostics
‡
‡
 &
.
‡
‡
& '
Debug
‡
‡
' ,
.
‡
‡
, -
	WriteLine
‡
‡
- 6
(
‡
‡
6 7
ex
‡
‡
7 9
.
‡
‡
9 :
ToString
‡
‡
: B
(
‡
‡
B C
)
‡
‡
C D
)
‡
‡
D E
;
‡
‡
E F
}
ˆ
ˆ
 
else
‰
‰
 
{
Š
Š
 
pushErrorEvent
‹
‹
 "
(
‹
‹
" #
ex
‹
‹
# %
)
‹
‹
% &
;
‹
‹
& '
}
Œ
Œ
 
}


 
finally


 
{


 
m_fSocketFlag


 
.


 

endReceive


 (
(


( )
)


) *
;


* +
}
‘
‘
 
}
’
’
 	
private
–
–
 
void
–
–
 
doSend
–
–
 
(
–
–
 
FSocketSendData
—
—
 
fData
—
—
 !
)
˜
˜
 
{
™
™
 	
try
š
š
 
{
›
›
 
m_fSocketFlag
œ
œ
 
.
œ
œ
 
	beginSend
œ
œ
 '
(
œ
œ
' (
)
œ
œ
( )
;
œ
œ
) *
m_networkStream


 
.


  

BeginWrite


  *
(


* +
fData


+ 0
.


0 1
data


1 5
,


5 6
$num


7 8
,


8 9
fData


: ?
.


? @
data


@ D
.


D E
Length


E K
,


K L
new


M P
AsyncCallback


Q ^
(


^ _
doSendCallback


_ m
)


m n
,


n o
fData


p u
)


u v
;


v w
}


 
catch
Ÿ
Ÿ
 
(
Ÿ
Ÿ
 
	Exception
Ÿ
Ÿ
 
ex
Ÿ
Ÿ
 
)
Ÿ
Ÿ
  
{
 
 
 
if
¡
¡
 
(
¡
¡
 
ex
¡
¡
 
is
¡
¡
 
IOException
¡
¡
 %
)
¡
¡
% &
{
¢
¢
 
if
£
£
 
(
£
£
 
ex
£
£
 
.
£
£
 
InnerException
£
£
 )
is
£
£
* ,
SocketException
£
£
- <
)
£
£
< =
{
¤
¤
 "
pushSocketErrorEvent
¥
¥
 ,
(
¥
¥
, -
$str
¥
¥
- 5
,
¥
¥
5 6
(
¥
¥
7 8
SocketException
¥
¥
8 G
)
¥
¥
G H
ex
¥
¥
H J
.
¥
¥
J K
InnerException
¥
¥
K Y
)
¥
¥
Y Z
;
¥
¥
Z [%
pushDataSendFailedEvent
¦
¦
 /
(
¦
¦
/ 0
fData
¦
¦
0 5
,
¦
¦
5 6
ex
¦
¦
7 9
.
¦
¦
9 :
InnerException
¦
¦
: H
.
¦
¦
H I
Message
¦
¦
I P
)
¦
¦
P Q
;
¦
¦
Q R
doDisconnect
­
­
 $
(
­
­
$ %
)
­
­
% &
;
­
­
& '
}
®
®
 
else
¯
¯
 
if
¯
¯
 
(
¯
¯
 
ex
¯
¯
 
.
¯
¯
  
InnerException
¯
¯
  .
is
¯
¯
/ 1%
ObjectDisposedException
¯
¯
2 I
)
¯
¯
I J
{
°
°
 
System
±
±
 
.
±
±
 
Diagnostics
±
±
 *
.
±
±
* +
Debug
±
±
+ 0
.
±
±
0 1
	WriteLine
±
±
1 :
(
±
±
: ;
ex
±
±
; =
.
±
±
= >
InnerException
±
±
> L
.
±
±
L M
ToString
±
±
M U
(
±
±
U V
)
±
±
V W
)
±
±
W X
;
±
±
X Y
}
²
²
 
else
³
³
 
{
´
´
 
pushErrorEvent
µ
µ
 &
(
µ
µ
& '
ex
µ
µ
' )
.
µ
µ
) *
InnerException
µ
µ
* 8
==
µ
µ
9 ;
null
µ
µ
< @
?
µ
µ
A B
ex
µ
µ
C E
:
µ
µ
F G
ex
µ
µ
H J
.
µ
µ
J K
InnerException
µ
µ
K Y
)
µ
µ
Y Z
;
µ
µ
Z [%
pushDataSendFailedEvent
¶
¶
 /
(
¶
¶
/ 0
fData
¶
¶
0 5
,
¶
¶
5 6
ex
¶
¶
7 9
.
¶
¶
9 :
Message
¶
¶
: A
)
¶
¶
A B
;
¶
¶
B C
}
·
·
 
}
¸
¸
 
else
¹
¹
 
if
¹
¹
 
(
¹
¹
 
ex
¹
¹
 
is
¹
¹
 %
ObjectDisposedException
¹
¹
 6
)
¹
¹
6 7
{
º
º
 
System
»
»
 
.
»
»
 
Diagnostics
»
»
 &
.
»
»
& '
Debug
»
»
' ,
.
»
»
, -
	WriteLine
»
»
- 6
(
»
»
6 7
ex
»
»
7 9
.
»
»
9 :
ToString
»
»
: B
(
»
»
B C
)
»
»
C D
)
»
»
D E
;
»
»
E F
}
¼
¼
 
else
½
½
 
{
¾
¾
 
pushErrorEvent
¿
¿
 "
(
¿
¿
" #
ex
¿
¿
# %
)
¿
¿
% &
;
¿
¿
& '%
pushDataSendFailedEvent
À
À
 +
(
À
À
+ ,
fData
À
À
, 1
,
À
À
1 2
ex
À
À
3 5
.
À
À
5 6
Message
À
À
6 =
)
À
À
= >
;
À
À
> ?
}
Á
Á
 
m_fSocketFlag
Â
Â
 
.
Â
Â
 
endSend
Â
Â
 %
(
Â
Â
% &
)
Â
Â
& '
;
Â
Â
' (
}
Ã
Ã
 
finally
Ä
Ä
 
{
Å
Å
 
}
Ç
Ç
 
}
È
È
 	
private
Ì
Ì
 
void
Ì
Ì
 
doSendCallback
Ì
Ì
 #
(
Ì
Ì
# $
IAsyncResult
Í
Í
 
ar
Í
Í
 
)
Î
Î
 
{
Ï
Ï
 	
FSocketSendData
Ğ
Ğ
 
fData
Ğ
Ğ
 !
=
Ğ
Ğ
" #
null
Ğ
Ğ
$ (
;
Ğ
Ğ
( )
try
Ò
Ò
 
{
Ó
Ó
 
fData
Ô
Ô
 
=
Ô
Ô
 
(
Ô
Ô
 
FSocketSendData
Ô
Ô
 (
)
Ô
Ô
( )
ar
Ô
Ô
) +
.
Ô
Ô
+ ,

AsyncState
Ô
Ô
, 6
;
Ô
Ô
6 7
m_networkStream
Õ
Õ
 
.
Õ
Õ
  
EndWrite
Õ
Õ
  (
(
Õ
Õ
( )
ar
Õ
Õ
) +
)
Õ
Õ
+ ,
;
Õ
Õ
, -
m_fEventPusher
Ö
Ö
 
.
Ö
Ö
 
	pushEvent
Ö
Ö
 (
(
Ö
Ö
( )
new
Ö
Ö
) ,)
FTcpClientDataSentEventArgs
Ö
Ö
- H
(
Ö
Ö
H I
this
Ö
Ö
I M
,
Ö
Ö
M N
fData
Ö
Ö
O T
)
Ö
Ö
T U
)
Ö
Ö
U V
;
Ö
Ö
V W
}
×
×
 
catch
Ø
Ø
 
(
Ø
Ø
 
	Exception
Ø
Ø
 
ex
Ø
Ø
 
)
Ø
Ø
  
{
Ù
Ù
 
if
Ú
Ú
 
(
Ú
Ú
 
ex
Ú
Ú
 
is
Ú
Ú
 
IOException
Ú
Ú
 %
)
Ú
Ú
% &
{
Û
Û
 
if
Ü
Ü
 
(
Ü
Ü
 
ex
Ü
Ü
 
.
Ü
Ü
 
InnerException
Ü
Ü
 )
is
Ü
Ü
* ,
SocketException
Ü
Ü
- <
)
Ü
Ü
< =
{
İ
İ
 "
pushSocketErrorEvent
Ş
Ş
 ,
(
Ş
Ş
, -
$str
Ş
Ş
- =
,
Ş
Ş
= >
(
Ş
Ş
? @
SocketException
Ş
Ş
@ O
)
Ş
Ş
O P
ex
Ş
Ş
P R
.
Ş
Ş
R S
InnerException
Ş
Ş
S a
)
Ş
Ş
a b
;
Ş
Ş
b c%
pushDataSendFailedEvent
ß
ß
 /
(
ß
ß
/ 0
fData
ß
ß
0 5
,
ß
ß
5 6
ex
ß
ß
7 9
.
ß
ß
9 :
InnerException
ß
ß
: H
.
ß
ß
H I
Message
ß
ß
I P
)
ß
ß
P Q
;
ß
ß
Q R
doDisconnect
æ
æ
 $
(
æ
æ
$ %
)
æ
æ
% &
;
æ
æ
& '
}
ç
ç
 
else
è
è
 
if
è
è
 
(
è
è
 
ex
è
è
 
.
è
è
  
InnerException
è
è
  .
is
è
è
/ 1%
ObjectDisposedException
è
è
2 I
)
è
è
I J
{
é
é
 
System
ê
ê
 
.
ê
ê
 
Diagnostics
ê
ê
 *
.
ê
ê
* +
Debug
ê
ê
+ 0
.
ê
ê
0 1
	WriteLine
ê
ê
1 :
(
ê
ê
: ;
ex
ê
ê
; =
.
ê
ê
= >
InnerException
ê
ê
> L
.
ê
ê
L M
ToString
ê
ê
M U
(
ê
ê
U V
)
ê
ê
V W
)
ê
ê
W X
;
ê
ê
X Y
}
ë
ë
 
else
ì
ì
 
{
í
í
 
pushErrorEvent
î
î
 &
(
î
î
& '
ex
î
î
' )
.
î
î
) *
InnerException
î
î
* 8
==
î
î
9 ;
null
î
î
< @
?
î
î
A B
ex
î
î
C E
:
î
î
F G
ex
î
î
H J
.
î
î
J K
InnerException
î
î
K Y
)
î
î
Y Z
;
î
î
Z [%
pushDataSendFailedEvent
ï
ï
 /
(
ï
ï
/ 0
fData
ï
ï
0 5
,
ï
ï
5 6
ex
ï
ï
7 9
.
ï
ï
9 :
Message
ï
ï
: A
)
ï
ï
A B
;
ï
ï
B C
}
ğ
ğ
 
}
ñ
ñ
 
else
ò
ò
 
if
ò
ò
 
(
ò
ò
 
ex
ò
ò
 
is
ò
ò
 %
ObjectDisposedException
ò
ò
 6
)
ò
ò
6 7
{
ó
ó
 
System
ô
ô
 
.
ô
ô
 
Diagnostics
ô
ô
 &
.
ô
ô
& '
Debug
ô
ô
' ,
.
ô
ô
, -
	WriteLine
ô
ô
- 6
(
ô
ô
6 7
ex
ô
ô
7 9
.
ô
ô
9 :
ToString
ô
ô
: B
(
ô
ô
B C
)
ô
ô
C D
)
ô
ô
D E
;
ô
ô
E F
}
õ
õ
 
else
ö
ö
 
{
÷
÷
 
pushErrorEvent
ø
ø
 "
(
ø
ø
" #
ex
ø
ø
# %
)
ø
ø
% &
;
ø
ø
& '%
pushDataSendFailedEvent
ù
ù
 +
(
ù
ù
+ ,
fData
ù
ù
, 1
,
ù
ù
1 2
ex
ù
ù
3 5
.
ù
ù
5 6
Message
ù
ù
6 =
)
ù
ù
= >
;
ù
ù
> ?
}
ú
ú
 
}
û
û
 
finally
ü
ü
 
{
ı
ı
 
fData
ş
ş
 
=
ş
ş
 
null
ş
ş
 
;
ş
ş
 
m_fSocketFlag
ÿ
ÿ
 
.
ÿ
ÿ
 
endSend
ÿ
ÿ
 %
(
ÿ
ÿ
% &
)
ÿ
ÿ
& '
;
ÿ
ÿ
' (
}
€€ 
}
 	
internal
…… 
void
…… %
onTcpClientStateChanged
…… -
(
……- ."
FSocketEventArgsBase
††  
args
††! %
)
‡‡ 
{
ˆˆ 	
try
‰‰ 
{
ŠŠ 
if
‹‹ 
(
‹‹ #
TcpClientStateChanged
‹‹ )
!=
‹‹* ,
null
‹‹- 1
)
‹‹1 2
{
ŒŒ #
TcpClientStateChanged
 )
(
) *
this
* .
,
. /
(
0 1-
FTcpClientStateChangedEventArgs
1 P
)
P Q
args
Q U
)
U V
;
V W
}
 
}
 
catch
 
(
 
	Exception
 
ex
 
)
  
{
‘‘ 
FDebug
’’ 
.
’’ 
writeLog
’’ 
(
’’  
ex
’’  "
)
’’" #
;
’’# $
}
““ 
finally
”” 
{
•• 
}
—— 
}
˜˜ 	
internal
œœ 
void
œœ %
onTcpClientDataReceived
œœ -
(
œœ- ."
FSocketEventArgsBase
  
args
! %
)
 
{
ŸŸ 	
try
   
{
¡¡ 
if
¢¢ 
(
¢¢ #
TcpClientDataReceived
¢¢ )
!=
¢¢* ,
null
¢¢- 1
)
¢¢1 2
{
££ #
TcpClientDataReceived
¤¤ )
(
¤¤) *
this
¤¤* .
,
¤¤. /
(
¤¤0 1-
FTcpClientDataReceivedEventArgs
¤¤1 P
)
¤¤P Q
args
¤¤Q U
)
¤¤U V
;
¤¤V W
}
¥¥ 
}
¦¦ 
catch
§§ 
(
§§ 
	Exception
§§ 
ex
§§ 
)
§§  
{
¨¨ 
FDebug
©© 
.
©© 
writeLog
©© 
(
©©  
ex
©©  "
)
©©" #
;
©©# $
}
ªª 
finally
«« 
{
¬¬ 
}
®® 
}
¯¯ 	
internal
³³ 
void
³³ !
onTcpClientDataSent
³³ )
(
³³) *"
FSocketEventArgsBase
´´  
args
´´! %
)
µµ 
{
¶¶ 	
try
·· 
{
¸¸ 
if
¹¹ 
(
¹¹ 
TcpClientDataSent
¹¹ %
!=
¹¹& (
null
¹¹) -
)
¹¹- .
{
ºº 
TcpClientDataSent
»» %
(
»»% &
this
»»& *
,
»»* +
(
»», -)
FTcpClientDataSentEventArgs
»»- H
)
»»H I
args
»»I M
)
»»M N
;
»»N O
}
¼¼ 
}
½½ 
catch
¾¾ 
(
¾¾ 
	Exception
¾¾ 
ex
¾¾ 
)
¾¾  
{
¿¿ 
FDebug
ÀÀ 
.
ÀÀ 
writeLog
ÀÀ 
(
ÀÀ  
ex
ÀÀ  "
)
ÀÀ" #
;
ÀÀ# $
}
ÁÁ 
finally
ÂÂ 
{
ÃÃ 
}
ÅÅ 
}
ÆÆ 	
internal
ÊÊ 
void
ÊÊ '
onTcpClientDataSendFailed
ÊÊ /
(
ÊÊ/ 0"
FSocketEventArgsBase
ËË  
args
ËË! %
)
ÌÌ 
{
ÍÍ 	
try
ÎÎ 
{
ÏÏ 
if
ĞĞ 
(
ĞĞ %
TcpClientDataSendFailed
ĞĞ +
!=
ĞĞ, .
null
ĞĞ/ 3
)
ĞĞ3 4
{
ÑÑ %
TcpClientDataSendFailed
ÒÒ +
(
ÒÒ+ ,
this
ÒÒ, 0
,
ÒÒ0 1
(
ÒÒ2 3/
!FTcpClientDataSendFailedEventArgs
ÒÒ3 T
)
ÒÒT U
args
ÒÒU Y
)
ÒÒY Z
;
ÒÒZ [
}
ÓÓ 
}
ÔÔ 
catch
ÕÕ 
(
ÕÕ 
	Exception
ÕÕ 
ex
ÕÕ 
)
ÕÕ  
{
ÖÖ 
FDebug
×× 
.
×× 
writeLog
×× 
(
××  
ex
××  "
)
××" #
;
××# $
}
ØØ 
finally
ÙÙ 
{
ÚÚ 
}
ÜÜ 
}
İİ 	
internal
áá 
void
áá $
onTcpClientErrorRaised
áá ,
(
áá, -"
FSocketEventArgsBase
ââ  
args
ââ! %
)
ãã 
{
ää 	
try
åå 
{
ææ 
if
çç 
(
çç "
TcpClientErrorRaised
çç (
!=
çç) +
null
çç, 0
)
çç0 1
{
èè "
TcpClientErrorRaised
éé (
(
éé( )
this
éé) -
,
éé- .
(
éé/ 0,
FTcpClientErrorRaisedEventArgs
éé0 N
)
ééN O
args
ééO S
)
ééS T
;
ééT U
}
êê 
}
ëë 
catch
ìì 
(
ìì 
	Exception
ìì 
ex
ìì 
)
ìì  
{
íí 
FDebug
îî 
.
îî 
writeLog
îî 
(
îî  
ex
îî  "
)
îî" #
;
îî# $
}
ïï 
finally
ğğ 
{
ññ 
}
óó 
}
ôô 	
private
üü 
void
üü (
m_fThdMain_ThreadJobCalled
üü /
(
üü/ 0
object
ıı 
sender
ıı 
,
ıı 
FThreadEventArgs
şş 
e
şş 
)
ÿÿ 
{
€€ 	
bool
 
waited
 
=
 
false
 
;
  
try
ƒƒ 
{
„„ 
waited
…… 
=
…… 
m_fMainSync
…… $
.
……$ %
tryWait
……% ,
(
……, -
$num
……- .
)
……. /
;
……/ 0
if
†† 
(
†† 
!
†† 
waited
†† 
)
†† 
{
‡‡ 
return
ˆˆ 
;
ˆˆ 
}
‰‰ 
if
 
(
 
m_fState
 
==
 
FTcpClientState
  /
.
/ 0
Opened
0 6
)
6 7
{
 
if
’’ 
(
’’ 
!
’’ "
m_fRetryConnectTimer
’’ -
.
’’- .
enabled
’’. 5
||
’’6 8"
m_fRetryConnectTimer
’’9 M
.
’’M N
elasped
’’N U
(
’’U V
false
’’V [
)
’’[ \
)
’’\ ]
{
““ 
if
”” 
(
”” 
m_tcpClient
”” '
==
””( *
null
””+ /
)
””/ 0
{
•• 
doReconnect
–– '
(
––' (
)
––( )
;
––) *
}
—— 
if
™™ 
(
™™ 
m_fSocketFlag
™™ )
.
™™) * 
doConnectCompleted
™™* <
)
™™< =
{
šš 
	doConnect
›› %
(
››% &
)
››& '
;
››' (
return
œœ "
;
œœ" #
}
 
}
 
}
ŸŸ 
else
   
if
   
(
   
m_fState
   !
==
  " $
FTcpClientState
  % 4
.
  4 5
	Connected
  5 >
)
  > ?
{
¡¡ 
if
¢¢ 
(
¢¢ 
m_fSocketFlag
¢¢ %
.
¢¢% &
disconnected
¢¢& 2
)
¢¢2 3
{
££ 
if
¤¤ 
(
¤¤ 
m_fMode
¤¤ #
==
¤¤$ &
FTcpClientMode
¤¤' 5
.
¤¤5 6
Server
¤¤6 <
)
¤¤< =
{
¥¥ 
doClose
¦¦ #
(
¦¦# $
)
¦¦$ %
;
¦¦% &
}
§§ 
else
¨¨ 
{
©© 
doReconnect
ªª '
(
ªª' (
)
ªª( )
;
ªª) *
}
«« 
return
¬¬ 
;
¬¬ 
}
­­ 
if
±± 
(
±± 
m_fSocketFlag
±± %
.
±±% & 
doReceiveCompleted
±±& 8
)
±±8 9
{
²² 
if
³³ 
(
³³ 
m_fSocketFlag
³³ )
.
³³) * 
doReceiveCompleted
³³* <
)
³³< =
{
´´ 
	doReceive
µµ %
(
µµ% &
)
µµ& '
;
µµ' (
return
¶¶ "
;
¶¶" #
}
·· 
}
¸¸ 
if
½½ 
(
½½ 
!
½½ 
m_tcpClient
½½ $
.
½½$ %
	Connected
½½% .
)
½½. /
{
¾¾ 
System
¿¿ 
.
¿¿ 
Diagnostics
¿¿ *
.
¿¿* +
Debug
¿¿+ 0
.
¿¿0 1
	WriteLine
¿¿1 :
(
¿¿: ;
$str
¿¿; Q
)
¿¿Q R
;
¿¿R S
}
ÀÀ 
}
ÁÁ 
else
ÂÂ 
if
ÂÂ 
(
ÂÂ 
m_fState
ÂÂ !
==
ÂÂ" $
FTcpClientState
ÂÂ% 4
.
ÂÂ4 5
Closed
ÂÂ5 ;
)
ÂÂ; <
{
ÃÃ 
}
ÅÅ 
e
ÉÉ 
.
ÉÉ 
sleepThread
ÉÉ 
(
ÉÉ 
$num
ÉÉ 
)
ÉÉ  
;
ÉÉ  !
}
ÊÊ 
catch
ËË 
(
ËË 
	Exception
ËË 
ex
ËË 
)
ËË  
{
ÌÌ 
pushErrorEvent
ÍÍ 
(
ÍÍ 
ex
ÍÍ !
)
ÍÍ! "
;
ÍÍ" #
}
ÎÎ 
finally
ÏÏ 
{
ĞĞ 
if
ÑÑ 
(
ÑÑ 
waited
ÑÑ 
)
ÑÑ 
{
ÒÒ 
m_fMainSync
ÓÓ 
.
ÓÓ  
set
ÓÓ  #
(
ÓÓ# $
)
ÓÓ$ %
;
ÓÓ% &
}
ÔÔ 
}
ÕÕ 
}
ÖÖ 	
}
ÜÜ 
}İİ š
\D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Socket\c_FSocketFlag.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FSocketFlag 
: 
IDisposable *
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
	FCodeLock 
m_fLock !
=" #
null$ (
;( )
private 
int 
m_acceptCount !
=" #
$num$ %
;% &
private 
int 
m_connectCount "
=# $
$num% &
;& '
private 
int 
m_sendCount 
=  !
$num" #
;# $
private 
int 
m_receiveCount "
=# $
$num% &
;& '
private!! 
bool!! 
m_disconnected!! #
=!!$ %
false!!& +
;!!+ ,
public'' 
FSocketFlag'' 
('' 
)(( 
{)) 	
m_fLock** 
=** 
new** 
	FCodeLock** #
(**# $
)**$ %
;**% &
}++ 	
~// 	
FSocketFlag//	 
(// 
)00 
{11 	
	myDispose22 
(22 
false22 
)22 
;22 
}33 	
	protected77 
void77 
	myDispose77  
(77  !
bool88 
	disposing88 
)99 
{:: 	
if;; 
(;; 
!;; 

m_disposed;; 
);; 
{<< 
if== 
(== 
	disposing== 
)== 
{>> 
if?? 
(?? 
m_fLock?? 
!=??  "
null??# '
)??' (
{@@ 
m_fLockAA 
.AA  
DisposeAA  '
(AA' (
)AA( )
;AA) *
m_fLockBB 
=BB  !
nullBB" &
;BB& '
}CC 
}DD 

m_disposedFF 
=FF 
trueFF !
;FF! "
}GG 
}HH 	
publicPP 
voidPP 
DisposePP 
(PP 
)QQ 
{RR 	
	myDisposeSS 
(SS 
trueSS 
)SS 
;SS 
GCTT 
.TT 
SuppressFinalizeTT 
(TT  
thisTT  $
)TT$ %
;TT% &
}UU 	
public]] 
bool]] 
doAcceptCompleted]] %
{^^ 	
get__ 
{`` 
tryaa 
{bb 
returncc 
m_acceptCountcc (
==cc) +
$numcc, -
?cc. /
truecc0 4
:cc5 6
falsecc7 <
;cc< =
}dd 
catchee 
(ee 
	Exceptionee  
exee! #
)ee# $
{ff 
FDebuggg 
.gg 
throwExceptiongg )
(gg) *
exgg* ,
)gg, -
;gg- .
}hh 
finallyii 
{jj 
}ll 
returnmm 
falsemm 
;mm 
}nn 
}oo 	
publicss 
boolss 
doConnectCompletedss &
{tt 	
getuu 
{vv 
tryww 
{xx 
returnyy 
m_connectCountyy )
==yy* ,
$numyy- .
?yy/ 0
trueyy1 5
:yy6 7
falseyy8 =
;yy= >
}zz 
catch{{ 
({{ 
	Exception{{  
ex{{! #
){{# $
{|| 
FDebug}} 
.}} 
throwException}} )
(}}) *
ex}}* ,
)}}, -
;}}- .
}~~ 
finally 
{
€€ 
}
‚‚ 
return
ƒƒ 
false
ƒƒ 
;
ƒƒ 
}
„„ 
}
…… 	
public
‰‰ 
bool
‰‰  
doReceiveCompleted
‰‰ &
{
ŠŠ 	
get
‹‹ 
{
ŒŒ 
try
 
{
 
return
 
m_receiveCount
 )
==
* ,
$num
- .
?
/ 0
true
1 5
:
6 7
false
8 =
;
= >
}
 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘  
ex
‘‘! #
)
‘‘# $
{
’’ 
FDebug
““ 
.
““ 
throwException
““ )
(
““) *
ex
““* ,
)
““, -
;
““- .
}
”” 
finally
•• 
{
–– 
}
˜˜ 
return
™™ 
false
™™ 
;
™™ 
}
šš 
}
›› 	
public
ŸŸ 
bool
ŸŸ 
doSendCompleted
ŸŸ #
{
   	
get
¡¡ 
{
¢¢ 
try
££ 
{
¤¤ 
return
¥¥ 
m_sendCount
¥¥ &
==
¥¥' )
$num
¥¥* +
?
¥¥, -
true
¥¥. 2
:
¥¥3 4
false
¥¥5 :
;
¥¥: ;
}
¦¦ 
catch
§§ 
(
§§ 
	Exception
§§  
ex
§§! #
)
§§# $
{
¨¨ 
FDebug
©© 
.
©© 
throwException
©© )
(
©©) *
ex
©©* ,
)
©©, -
;
©©- .
}
ªª 
finally
«« 
{
¬¬ 
}
®® 
return
¯¯ 
false
¯¯ 
;
¯¯ 
}
°° 
}
±± 	
public
µµ 
bool
µµ 
disconnected
µµ  
{
¶¶ 	
get
·· 
{
¸¸ 
try
¹¹ 
{
ºº 
return
»» 
m_disconnected
»» )
;
»») *
}
¼¼ 
catch
½½ 
(
½½ 
	Exception
½½  
ex
½½! #
)
½½# $
{
¾¾ 
FDebug
¿¿ 
.
¿¿ 
throwException
¿¿ )
(
¿¿) *
ex
¿¿* ,
)
¿¿, -
;
¿¿- .
}
ÀÀ 
finally
ÁÁ 
{
ÂÂ 
}
ÄÄ 
return
ÅÅ 
false
ÅÅ 
;
ÅÅ 
}
ÆÆ 
set
ÈÈ 
{
ÉÉ 
try
ÊÊ 
{
ËË 
m_disconnected
ÌÌ "
=
ÌÌ# $
value
ÌÌ% *
;
ÌÌ* +
}
ÍÍ 
catch
ÎÎ 
(
ÎÎ 
	Exception
ÎÎ  
ex
ÎÎ! #
)
ÎÎ# $
{
ÏÏ 
FDebug
ĞĞ 
.
ĞĞ 
throwException
ĞĞ )
(
ĞĞ) *
ex
ĞĞ* ,
)
ĞĞ, -
;
ĞĞ- .
}
ÑÑ 
finally
ÒÒ 
{
ÓÓ 
}
ÕÕ 
}
ÖÖ 
}
×× 	
public
ßß 
void
ßß 
init
ßß 
(
ßß 
)
àà 
{
áá 	
try
ââ 
{
ãã 
m_acceptCount
ää 
=
ää 
$num
ää  !
;
ää! "
m_connectCount
åå 
=
åå  
$num
åå! "
;
åå" #
m_sendCount
ææ 
=
ææ 
$num
ææ 
;
ææ  
m_receiveCount
çç 
=
çç  
$num
çç! "
;
çç" #
m_disconnected
éé 
=
éé  
false
éé! &
;
éé& '
}
êê 
catch
ëë 
(
ëë 
	Exception
ëë 
ex
ëë 
)
ëë  
{
ìì 
FDebug
íí 
.
íí 
throwException
íí %
(
íí% &
ex
íí& (
)
íí( )
;
íí) *
}
îî 
finally
ïï 
{
ğğ 
}
òò 
}
óó 	
public
÷÷ 
int
÷÷ 
beginAccept
÷÷ 
(
÷÷ 
)
øø 
{
ùù 	
try
úú 
{
ûû 
m_fLock
üü 
.
üü 
wait
üü 
(
üü 
)
üü 
;
üü 
return
ıı 
++
ıı 
m_acceptCount
ıı &
;
ıı& '
}
şş 
catch
ÿÿ 
(
ÿÿ 
	Exception
ÿÿ 
ex
ÿÿ 
)
ÿÿ  
{
€€ 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
‚‚ 
finally
ƒƒ 
{
„„ 
m_fLock
…… 
.
…… 
set
…… 
(
…… 
)
…… 
;
…… 
}
†† 
return
‡‡ 
$num
‡‡ 
;
‡‡ 
}
ˆˆ 	
public
ŒŒ 
int
ŒŒ 
	endAccept
ŒŒ 
(
ŒŒ 
)
 
{
 	
try
 
{
 
m_fLock
‘‘ 
.
‘‘ 
wait
‘‘ 
(
‘‘ 
)
‘‘ 
;
‘‘ 
return
’’ 
--
’’ 
m_acceptCount
’’ &
;
’’& '
}
““ 
catch
”” 
(
”” 
	Exception
”” 
ex
”” 
)
””  
{
•• 
FDebug
–– 
.
–– 
throwException
–– %
(
––% &
ex
––& (
)
––( )
;
––) *
}
—— 
finally
˜˜ 
{
™™ 
m_fLock
šš 
.
šš 
set
šš 
(
šš 
)
šš 
;
šš 
}
›› 
return
œœ 
$num
œœ 
;
œœ 
}
 	
public
¡¡ 
int
¡¡ 
beginConnect
¡¡ 
(
¡¡  
)
¢¢ 
{
££ 	
try
¤¤ 
{
¥¥ 
m_fLock
¦¦ 
.
¦¦ 
wait
¦¦ 
(
¦¦ 
)
¦¦ 
;
¦¦ 
return
§§ 
++
§§ 
m_connectCount
§§ '
;
§§' (
}
¨¨ 
catch
©© 
(
©© 
	Exception
©© 
ex
©© 
)
©©  
{
ªª 
FDebug
«« 
.
«« 
throwException
«« %
(
««% &
ex
««& (
)
««( )
;
««) *
}
¬¬ 
finally
­­ 
{
®® 
m_fLock
¯¯ 
.
¯¯ 
set
¯¯ 
(
¯¯ 
)
¯¯ 
;
¯¯ 
}
°° 
return
±± 
$num
±± 
;
±± 
}
²² 	
public
¶¶ 
int
¶¶ 

endConnect
¶¶ 
(
¶¶ 
)
·· 
{
¸¸ 	
try
¹¹ 
{
ºº 
m_fLock
»» 
.
»» 
wait
»» 
(
»» 
)
»» 
;
»» 
return
¼¼ 
--
¼¼ 
m_connectCount
¼¼ '
;
¼¼' (
}
½½ 
catch
¾¾ 
(
¾¾ 
	Exception
¾¾ 
ex
¾¾ 
)
¾¾  
{
¿¿ 
FDebug
ÀÀ 
.
ÀÀ 
throwException
ÀÀ %
(
ÀÀ% &
ex
ÀÀ& (
)
ÀÀ( )
;
ÀÀ) *
}
ÁÁ 
finally
ÂÂ 
{
ÃÃ 
m_fLock
ÄÄ 
.
ÄÄ 
set
ÄÄ 
(
ÄÄ 
)
ÄÄ 
;
ÄÄ 
}
ÅÅ 
return
ÆÆ 
$num
ÆÆ 
;
ÆÆ 
}
ÇÇ 	
public
ËË 
int
ËË 
	beginSend
ËË 
(
ËË 
)
ÌÌ 
{
ÍÍ 	
try
ÎÎ 
{
ÏÏ 
m_fLock
ĞĞ 
.
ĞĞ 
wait
ĞĞ 
(
ĞĞ 
)
ĞĞ 
;
ĞĞ 
return
ÑÑ 
++
ÑÑ 
m_sendCount
ÑÑ $
;
ÑÑ$ %
}
ÒÒ 
catch
ÓÓ 
(
ÓÓ 
	Exception
ÓÓ 
ex
ÓÓ 
)
ÓÓ  
{
ÔÔ 
FDebug
ÕÕ 
.
ÕÕ 
throwException
ÕÕ %
(
ÕÕ% &
ex
ÕÕ& (
)
ÕÕ( )
;
ÕÕ) *
}
ÖÖ 
finally
×× 
{
ØØ 
m_fLock
ÙÙ 
.
ÙÙ 
set
ÙÙ 
(
ÙÙ 
)
ÙÙ 
;
ÙÙ 
}
ÚÚ 
return
ÛÛ 
$num
ÛÛ 
;
ÛÛ 
}
ÜÜ 	
public
àà 
int
àà 
endSend
àà 
(
àà 
)
áá 
{
ââ 	
try
ãã 
{
ää 
m_fLock
åå 
.
åå 
wait
åå 
(
åå 
)
åå 
;
åå 
return
ææ 
--
ææ 
m_sendCount
ææ $
;
ææ$ %
}
çç 
catch
èè 
(
èè 
	Exception
èè 
ex
èè 
)
èè  
{
éé 
FDebug
êê 
.
êê 
throwException
êê %
(
êê% &
ex
êê& (
)
êê( )
;
êê) *
}
ëë 
finally
ìì 
{
íí 
m_fLock
îî 
.
îî 
set
îî 
(
îî 
)
îî 
;
îî 
}
ïï 
return
ğğ 
$num
ğğ 
;
ğğ 
}
ññ 	
public
õõ 
int
õõ 
beginReceive
õõ 
(
õõ  
)
öö 
{
÷÷ 	
try
øø 
{
ùù 
m_fLock
úú 
.
úú 
wait
úú 
(
úú 
)
úú 
;
úú 
return
ûû 
++
ûû 
m_receiveCount
ûû '
;
ûû' (
}
üü 
catch
ıı 
(
ıı 
	Exception
ıı 
ex
ıı 
)
ıı  
{
şş 
FDebug
ÿÿ 
.
ÿÿ 
throwException
ÿÿ %
(
ÿÿ% &
ex
ÿÿ& (
)
ÿÿ( )
;
ÿÿ) *
}
€€ 
finally
 
{
‚‚ 
m_fLock
ƒƒ 
.
ƒƒ 
set
ƒƒ 
(
ƒƒ 
)
ƒƒ 
;
ƒƒ 
}
„„ 
return
…… 
$num
…… 
;
…… 
}
†† 	
public
ŠŠ 
int
ŠŠ 

endReceive
ŠŠ 
(
ŠŠ 
)
‹‹ 
{
ŒŒ 	
try
 
{
 
m_fLock
 
.
 
wait
 
(
 
)
 
;
 
return
 
--
 
m_receiveCount
 '
;
' (
}
‘‘ 
catch
’’ 
(
’’ 
	Exception
’’ 
ex
’’ 
)
’’  
{
““ 
FDebug
”” 
.
”” 
throwException
”” %
(
””% &
ex
””& (
)
””( )
;
””) *
}
•• 
finally
–– 
{
—— 
m_fLock
˜˜ 
.
˜˜ 
set
˜˜ 
(
˜˜ 
)
˜˜ 
;
˜˜ 
}
™™ 
return
šš 
$num
šš 
;
šš 
}
›› 	
public
ŸŸ 
void
ŸŸ !
waitAcceptCompleted
ŸŸ '
(
ŸŸ' (
)
   
{
¡¡ 	
try
¢¢ 
{
££ 
while
¤¤ 
(
¤¤ 
!
¤¤ 
this
¤¤ 
.
¤¤ 
doAcceptCompleted
¤¤ .
)
¤¤. /
{
¥¥ 
System
¦¦ 
.
¦¦ 
	Threading
¦¦ $
.
¦¦$ %
Thread
¦¦% +
.
¦¦+ ,
Sleep
¦¦, 1
(
¦¦1 2
$num
¦¦2 3
)
¦¦3 4
;
¦¦4 5
}
§§ 
}
¨¨ 
catch
©© 
(
©© 
	Exception
©© 
ex
©© 
)
©©  
{
ªª 
FDebug
«« 
.
«« 
throwException
«« %
(
««% &
ex
««& (
)
««( )
;
««) *
}
¬¬ 
finally
­­ 
{
®® 
}
°° 
}
±± 	
public
µµ 
void
µµ "
waitConnectCompleted
µµ (
(
µµ( )
)
¶¶ 
{
·· 	
try
¸¸ 
{
¹¹ 
while
ºº 
(
ºº 
!
ºº 
this
ºº 
.
ºº  
doConnectCompleted
ºº /
)
ºº/ 0
{
»» 
System
¼¼ 
.
¼¼ 
	Threading
¼¼ $
.
¼¼$ %
Thread
¼¼% +
.
¼¼+ ,
Sleep
¼¼, 1
(
¼¼1 2
$num
¼¼2 3
)
¼¼3 4
;
¼¼4 5
}
½½ 
}
¾¾ 
catch
¿¿ 
(
¿¿ 
	Exception
¿¿ 
ex
¿¿ 
)
¿¿  
{
ÀÀ 
FDebug
ÁÁ 
.
ÁÁ 
throwException
ÁÁ %
(
ÁÁ% &
ex
ÁÁ& (
)
ÁÁ( )
;
ÁÁ) *
}
ÂÂ 
finally
ÃÃ 
{
ÄÄ 
}
ÆÆ 
}
ÇÇ 	
public
ËË 
void
ËË 
waitSendCompleted
ËË %
(
ËË% &
)
ÌÌ 
{
ÍÍ 	
try
ÎÎ 
{
ÏÏ 
while
ĞĞ 
(
ĞĞ 
!
ĞĞ 
this
ĞĞ 
.
ĞĞ 
doSendCompleted
ĞĞ ,
)
ĞĞ, -
{
ÑÑ 
System
ÒÒ 
.
ÒÒ 
	Threading
ÒÒ $
.
ÒÒ$ %
Thread
ÒÒ% +
.
ÒÒ+ ,
Sleep
ÒÒ, 1
(
ÒÒ1 2
$num
ÒÒ2 3
)
ÒÒ3 4
;
ÒÒ4 5
}
ÓÓ 
}
ÔÔ 
catch
ÕÕ 
(
ÕÕ 
	Exception
ÕÕ 
ex
ÕÕ 
)
ÕÕ  
{
ÖÖ 
FDebug
×× 
.
×× 
throwException
×× %
(
××% &
ex
××& (
)
××( )
;
××) *
}
ØØ 
finally
ÙÙ 
{
ÚÚ 
}
ÜÜ 
}
İİ 	
public
áá 
void
áá "
waitReceiveCompleted
áá (
(
áá( )
)
ââ 
{
ãã 	
try
ää 
{
åå 
while
ææ 
(
ææ 
!
ææ 
this
ææ 
.
ææ  
doReceiveCompleted
ææ /
)
ææ/ 0
{
çç 
System
èè 
.
èè 
	Threading
èè $
.
èè$ %
Thread
èè% +
.
èè+ ,
Sleep
èè, 1
(
èè1 2
$num
èè2 3
)
èè3 4
;
èè4 5
}
éé 
}
êê 
catch
ëë 
(
ëë 
	Exception
ëë 
ex
ëë 
)
ëë  
{
ìì 
FDebug
íí 
.
íí 
throwException
íí %
(
íí% &
ex
íí& (
)
íí( )
;
íí) *
}
îî 
finally
ïï 
{
ğğ 
}
òò 
}
óó 	
public
÷÷ 
void
÷÷ 
waitAllCompleted
÷÷ $
(
÷÷$ %
)
øø 
{
ùù 	
try
úú 
{
ûû 
while
üü 
(
üü 
!
üü 
this
üü 
.
üü 
doAcceptCompleted
üü .
||
üü/ 1
!
üü2 3
this
üü3 7
.
üü7 8 
doConnectCompleted
üü8 J
||
üüK M
!
üüN O
this
üüO S
.
üüS T
doSendCompleted
üüT c
||
üüd f
!
üüg h
this
üüh l
.
üül m 
doReceiveCompleted
üüm 
)üü €
{
ıı 
System
şş 
.
şş 
	Threading
şş $
.
şş$ %
Thread
şş% +
.
şş+ ,
Sleep
şş, 1
(
şş1 2
$num
şş2 3
)
şş3 4
;
şş4 5
}
ÿÿ 
}
€€ 
catch
 
(
 
	Exception
 
ex
 
)
  
{
‚‚ 
FDebug
ƒƒ 
.
ƒƒ 
throwException
ƒƒ %
(
ƒƒ% &
ex
ƒƒ& (
)
ƒƒ( )
;
ƒƒ) *
}
„„ 
finally
…… 
{
†† 
}
ˆˆ 
}
‰‰ 	
}
 
} .
rD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Socket\c_FTcpClientDataSendFailedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
Serializable 
] 
public 

class -
!FTcpClientDataSendFailedEventArgs 2
:3 4 
FSocketEventArgsBase5 I
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 

FTcpClient 
m_fOwnerTcpClient ,
=- .
null/ 3
;3 4
private 
FSocketSendData 
m_fData  '
=( )
null* .
;. /
private 
string 
	m_message  
=! "
string# )
.) *
Empty* /
;/ 0
internal$$ -
!FTcpClientDataSendFailedEventArgs$$ 2
($$2 3

FTcpClient%% 
fOwnerTcpClient%% &
,%%& '
FSocketSendData&& 
fData&& !
,&&! "
string'' 
message'' 
)(( 
:)) 
base)) 
()) 
FSocketEventId)) "
.))" ##
TcpClientDataSendFailed))# :
))): ;
{** 	
m_fOwnerTcpClient++ 
=++ 
fOwnerTcpClient++  /
;++/ 0
m_fData,, 
=,, 
fData,, 
;,, 
	m_message-- 
=-- 
message-- 
;--  
}.. 	
~22 	-
!FTcpClientDataSendFailedEventArgs22	 *
(22* +
)33 
{44 	
	myDispose55 
(55 
false55 
)55 
;55 
}66 	
	protected:: 
override:: 
void:: 
	myDispose::  )
(::) *
bool;; 
	disposing;; 
)<< 
{== 	
if>> 
(>> 
!>> 

m_disposed>> 
)>> 
{?? 
if@@ 
(@@ 
	disposing@@ 
)@@ 
{AA 
m_fOwnerTcpClientBB %
=BB& '
nullBB( ,
;BB, -
}CC 

m_disposedDD 
=DD 
trueDD !
;DD! "
baseHH 
.HH 
	myDisposeHH 
(HH 
	disposingHH (
)HH( )
;HH) *
}II 
}JJ 	
publicRR 

FTcpClientRR 
fOwnerTcpClientRR )
{SS 	
getTT 
{UU 
tryVV 
{WW 
returnXX 
m_fOwnerTcpClientXX ,
;XX, -
}YY 
catchZZ 
(ZZ 
	ExceptionZZ  
exZZ! #
)ZZ# $
{[[ 
FDebug\\ 
.\\ 
throwException\\ )
(\\) *
ex\\* ,
)\\, -
;\\- .
}]] 
finally^^ 
{__ 
}aa 
returnbb 
nullbb 
;bb 
}cc 
}dd 	
publichh 
FSocketSendDatahh 
fDatahh $
{ii 	
getjj 
{kk 
tryll 
{mm 
returnnn 
m_fDatann "
;nn" #
}oo 
catchpp 
(pp 
	Exceptionpp  
expp! #
)pp# $
{qq 
FDebugrr 
.rr 
throwExceptionrr )
(rr) *
exrr* ,
)rr, -
;rr- .
}ss 
finallytt 
{uu 
}ww 
returnxx 
nullxx 
;xx 
}yy 
}zz 	
public~~ 
byte~~ 
[~~ 
]~~ 
data~~ 
{ 	
get
€€ 
{
 
try
‚‚ 
{
ƒƒ 
return
„„ 
m_fData
„„ "
.
„„" #
data
„„# '
;
„„' (
}
…… 
catch
†† 
(
†† 
	Exception
††  
ex
††! #
)
††# $
{
‡‡ 
FDebug
ˆˆ 
.
ˆˆ 
throwException
ˆˆ )
(
ˆˆ) *
ex
ˆˆ* ,
)
ˆˆ, -
;
ˆˆ- .
}
‰‰ 
finally
ŠŠ 
{
‹‹ 
}
 
return
 
null
 
;
 
}
 
}
 	
public
”” 
int
”” 

dataLength
”” 
{
•• 	
get
–– 
{
—— 
try
˜˜ 
{
™™ 
return
šš 
m_fData
šš "
.
šš" #
data
šš# '
.
šš' (
Length
šš( .
;
šš. /
}
›› 
catch
œœ 
(
œœ 
	Exception
œœ  
ex
œœ! #
)
œœ# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
ŸŸ 
finally
   
{
¡¡ 
}
££ 
return
¤¤ 
$num
¤¤ 
;
¤¤ 
}
¥¥ 
}
¦¦ 	
public
ªª 
string
ªª 
message
ªª 
{
«« 	
get
¬¬ 
{
­­ 
try
®® 
{
¯¯ 
return
°° 
	m_message
°° $
;
°°$ %
}
±± 
catch
²² 
(
²² 
	Exception
²²  
ex
²²! #
)
²²# $
{
³³ 
FDebug
´´ 
.
´´ 
throwException
´´ )
(
´´) *
ex
´´* ,
)
´´, -
;
´´- .
}
µµ 
finally
¶¶ 
{
·· 
}
¹¹ 
return
ºº 
string
ºº 
.
ºº 
Empty
ºº #
;
ºº# $
}
»» 
}
¼¼ 	
}
ÈÈ 
}ÉÉ ‰
YD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Xml\c_FXmlComment.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FXmlComment 
: 
IDisposable *
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FXmlCore 

m_fXmlCore #
=$ %
null& *
;* +
private 

XmlComment 
m_xmlComment '
=( )
null* .
;. /
internal## 
FXmlComment## 
(## 
FXmlCore$$ 
fXmlCore$$ 
,$$ 

XmlComment%% 

xmlComment%% !
)&& 
{'' 	

m_fXmlCore(( 
=(( 
fXmlCore(( !
;((! "
m_xmlComment)) 
=)) 

xmlComment)) %
;))% &
}** 	
~.. 	
FXmlComment..	 
(.. 
)// 
{00 	
	myDispose11 
(11 
false11 
)11 
;11 
}22 	
	protected66 
void66 
	myDispose66  
(66  !
bool77 
	disposing77 
)88 
{99 	
if:: 
(:: 
!:: 

m_disposed:: 
):: 
{;; 
if<< 
(<< 
	disposing<< 
)<< 
{== 
m_xmlComment>>  
=>>! "
null>># '
;>>' (
}?? 

m_disposedAA 
=AA 
trueAA !
;AA! "
}BB 
}CC 	
publicKK 
voidKK 
DisposeKK 
(KK 
)LL 
{MM 	
	myDisposeNN 
(NN 
trueNN 
)NN 
;NN 
GCOO 
.OO 
SuppressFinalizeOO 
(OO  
thisOO  $
)OO$ %
;OO% &
}PP 	
internalXX 

XmlCommentXX 
baseXmlXX #
{YY 	
getZZ 
{[[ 
try\\ 
{]] 

m_fXmlCore^^ 
.^^ 
wait^^ #
(^^# $
)^^$ %
;^^% &
return__ 
m_xmlComment__ '
;__' (
}`` 
catchaa 
(aa 
	Exceptionaa  
exaa! #
)aa# $
{bb 
FDebugcc 
.cc 
throwExceptioncc )
(cc) *
excc* ,
)cc, -
;cc- .
}dd 
finallyee 
{ff 

m_fXmlCoregg 
.gg 
setgg "
(gg" #
)gg# $
;gg$ %
}hh 
returnii 
nullii 
;ii 
}jj 
}kk 	
}ww 
}xx ’Z
WD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Zip\c_FZipEntry.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
	FZipEntry 
: 
IDisposable (
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
string 
m_name 
= 
string  &
.& '
Empty' ,
;, -
private 
DateTime 
m_creationTime '
;' (
private 
DateTime 
m_lastWriteTime (
;( )
private 
DateTime 
m_lastAccessTime )
;) *
private 
long 
m_size 
= 
$num 
;  
private 
long 
m_compressedSize %
=& '
$num( )
;) *
private 
bool 
m_isFile 
= 
false  %
;% &
public$$ 
	FZipEntry$$ 
($$ 
string%% 
name%% 
)&& 
{'' 	
m_name(( 
=(( 
name(( 
;(( 
})) 	
~-- 	
	FZipEntry--	 
(-- 
).. 
{// 	
	myDispose00 
(00 
false00 
)00 
;00 
}11 	
private55 
void55 
	myDispose55 
(55 
bool66 
	disposing66 
)77 
{88 	
if99 
(99 
!99 

m_disposed99 
)99 
{:: 
if;; 
(;; 
	disposing;; 
);; 
{<< 
}>> 

m_disposed@@ 
=@@ 
true@@ !
;@@! "
}AA 
}BB 	
publicJJ 
voidJJ 
DisposeJJ 
(JJ 
)KK 
{LL 	
	myDisposeMM 
(MM 
trueMM 
)MM 
;MM 
GCNN 
.NN 
SuppressFinalizeNN 
(NN  
thisNN  $
)NN$ %
;NN% &
}OO 	
publicWW 
stringWW 
nameWW 
{XX 	
getYY 
{ZZ 
try[[ 
{\\ 
return]] 
m_name]] !
;]]! "
}^^ 
catch__ 
(__ 
	Exception__  
ex__! #
)__# $
{`` 
FDebugaa 
.aa 
throwExceptionaa )
(aa) *
exaa* ,
)aa, -
;aa- .
}bb 
finallycc 
{dd 
}ff 
returngg 
nullgg 
;gg 
}hh 
}ii 	
publicmm 
DateTimemm 
creationTimemm $
{nn 	
getoo 
{pp 
tryqq 
{rr 
returnss 
m_creationTimess )
;ss) *
}tt 
catchuu 
(uu 
	Exceptionuu  
exuu! #
)uu# $
{vv 
FDebugww 
.ww 
throwExceptionww )
(ww) *
exww* ,
)ww, -
;ww- .
}xx 
finallyyy 
{zz 
}|| 
return}} 
DateTime}} 
.}}  
Now}}  #
;}}# $
}~~ 
set
€€ 
{
 
try
‚‚ 
{
ƒƒ 
m_creationTime
„„ "
=
„„# $
value
„„% *
;
„„* +
}
…… 
catch
†† 
(
†† 
	Exception
††  
ex
††! #
)
††# $
{
‡‡ 
FDebug
ˆˆ 
.
ˆˆ 
throwException
ˆˆ )
(
ˆˆ) *
ex
ˆˆ* ,
)
ˆˆ, -
;
ˆˆ- .
}
‰‰ 
finally
ŠŠ 
{
‹‹ 
}
 
}
 
}
 	
public
““ 
DateTime
““ 
lastWriteTime
““ %
{
”” 	
get
•• 
{
–– 
try
—— 
{
˜˜ 
return
™™ 
m_lastWriteTime
™™ *
;
™™* +
}
šš 
catch
›› 
(
›› 
	Exception
››  
ex
››! #
)
››# $
{
œœ 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
ŸŸ 
{
   
}
¢¢ 
return
££ 
DateTime
££ 
.
££  
Now
££  #
;
££# $
}
¤¤ 
set
¦¦ 
{
§§ 
try
¨¨ 
{
©© 
m_lastWriteTime
ªª #
=
ªª$ %
value
ªª& +
;
ªª+ ,
}
«« 
catch
¬¬ 
(
¬¬ 
	Exception
¬¬  
ex
¬¬! #
)
¬¬# $
{
­­ 
FDebug
®® 
.
®® 
throwException
®® )
(
®®) *
ex
®®* ,
)
®®, -
;
®®- .
}
¯¯ 
finally
°° 
{
±± 
}
³³ 
}
´´ 
}
µµ 	
public
¹¹ 
DateTime
¹¹ 
lastAccessTime
¹¹ &
{
ºº 	
get
»» 
{
¼¼ 
try
½½ 
{
¾¾ 
return
¿¿ 
m_lastAccessTime
¿¿ +
;
¿¿+ ,
}
ÀÀ 
catch
ÁÁ 
(
ÁÁ 
	Exception
ÁÁ  
ex
ÁÁ! #
)
ÁÁ# $
{
ÂÂ 
FDebug
ÃÃ 
.
ÃÃ 
throwException
ÃÃ )
(
ÃÃ) *
ex
ÃÃ* ,
)
ÃÃ, -
;
ÃÃ- .
}
ÄÄ 
finally
ÅÅ 
{
ÆÆ 
}
ÈÈ 
return
ÉÉ 
DateTime
ÉÉ 
.
ÉÉ  
Now
ÉÉ  #
;
ÉÉ# $
}
ÊÊ 
set
ÌÌ 
{
ÍÍ 
try
ÎÎ 
{
ÏÏ 
m_lastAccessTime
ĞĞ $
=
ĞĞ% &
value
ĞĞ' ,
;
ĞĞ, -
}
ÑÑ 
catch
ÒÒ 
(
ÒÒ 
	Exception
ÒÒ  
ex
ÒÒ! #
)
ÒÒ# $
{
ÓÓ 
FDebug
ÔÔ 
.
ÔÔ 
throwException
ÔÔ )
(
ÔÔ) *
ex
ÔÔ* ,
)
ÔÔ, -
;
ÔÔ- .
}
ÕÕ 
finally
ÖÖ 
{
×× 
}
ÙÙ 
}
ÚÚ 
}
ÛÛ 	
public
ßß 
long
ßß 
size
ßß 
{
àà 	
get
áá 
{
ââ 
try
ãã 
{
ää 
return
åå 
m_size
åå !
;
åå! "
}
ææ 
catch
çç 
(
çç 
	Exception
çç  
ex
çç! #
)
çç# $
{
èè 
FDebug
éé 
.
éé 
throwException
éé )
(
éé) *
ex
éé* ,
)
éé, -
;
éé- .
}
êê 
finally
ëë 
{
ìì 
}
îî 
return
ïï 
$num
ïï 
;
ïï 
}
ğğ 
set
òò 
{
óó 
try
ôô 
{
õõ 
m_size
öö 
=
öö 
value
öö "
;
öö" #
}
÷÷ 
catch
øø 
(
øø 
	Exception
øø  
ex
øø! #
)
øø# $
{
ùù 
FDebug
úú 
.
úú 
throwException
úú )
(
úú) *
ex
úú* ,
)
úú, -
;
úú- .
}
ûû 
finally
üü 
{
ıı 
}
ÿÿ 
}
€€ 
}
 	
public
…… 
long
…… 
compressedSize
…… "
{
†† 	
get
‡‡ 
{
ˆˆ 
try
‰‰ 
{
ŠŠ 
return
‹‹ 
m_compressedSize
‹‹ +
;
‹‹+ ,
}
ŒŒ 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
‘‘ 
{
’’ 
}
”” 
return
•• 
$num
•• 
;
•• 
}
–– 
set
˜˜ 
{
™™ 
try
šš 
{
›› 
m_compressedSize
œœ $
=
œœ% &
value
œœ' ,
;
œœ, -
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
ŸŸ 
FDebug
   
.
   
throwException
   )
(
  ) *
ex
  * ,
)
  , -
;
  - .
}
¡¡ 
finally
¢¢ 
{
££ 
}
¥¥ 
}
¦¦ 
}
§§ 	
public
«« 
bool
«« 
isFile
«« 
{
¬¬ 	
get
­­ 
{
®® 
try
¯¯ 
{
°° 
return
±± 
m_isFile
±± #
;
±±# $
}
²² 
catch
³³ 
(
³³ 
	Exception
³³  
ex
³³! #
)
³³# $
{
´´ 
FDebug
µµ 
.
µµ 
throwException
µµ )
(
µµ) *
ex
µµ* ,
)
µµ, -
;
µµ- .
}
¶¶ 
finally
·· 
{
¸¸ 
}
ºº 
return
»» 
false
»» 
;
»» 
}
¼¼ 
set
¾¾ 
{
¿¿ 
try
ÀÀ 
{
ÁÁ 
m_isFile
ÂÂ 
=
ÂÂ 
value
ÂÂ $
;
ÂÂ$ %
}
ÃÃ 
catch
ÄÄ 
(
ÄÄ 
	Exception
ÄÄ  
ex
ÄÄ! #
)
ÄÄ# $
{
ÅÅ 
FDebug
ÆÆ 
.
ÆÆ 
throwException
ÆÆ )
(
ÆÆ) *
ex
ÆÆ* ,
)
ÆÆ, -
;
ÆÆ- .
}
ÇÇ 
finally
ÈÈ 
{
ÉÉ 
}
ËË 
}
ÌÌ 
}
ÍÍ 	
public
ÑÑ 
int
ÑÑ 
compressionRatio
ÑÑ #
{
ÒÒ 	
get
ÓÓ 
{
ÔÔ 
try
ÕÕ 
{
ÖÖ 
if
×× 
(
×× 
m_size
×× 
>
××  
$num
××! "
&&
××# %
m_size
××& ,
>=
××- /
m_compressedSize
××0 @
)
××@ A
{
ØØ 
return
ÙÙ 
(
ÙÙ  
int
ÙÙ  #
)
ÙÙ# $
Math
ÙÙ$ (
.
ÙÙ( )
Round
ÙÙ) .
(
ÙÙ. /
(
ÙÙ/ 0
$num
ÙÙ0 3
-
ÙÙ4 5
(
ÙÙ6 7
(
ÙÙ7 8
double
ÙÙ8 >
)
ÙÙ> ?
m_compressedSize
ÙÙ? O
/
ÙÙP Q
(
ÙÙR S
double
ÙÙS Y
)
ÙÙY Z
m_size
ÙÙZ `
)
ÙÙ` a
)
ÙÙa b
*
ÙÙc d
$num
ÙÙe j
)
ÙÙj k
;
ÙÙk l
}
ÚÚ 
return
ÛÛ 
$num
ÛÛ 
;
ÛÛ 
}
ÜÜ 
catch
İİ 
(
İİ 
	Exception
İİ  
ex
İİ! #
)
İİ# $
{
ŞŞ 
FDebug
ßß 
.
ßß 
throwException
ßß )
(
ßß) *
ex
ßß* ,
)
ßß, -
;
ßß- .
}
àà 
finally
áá 
{
ââ 
}
ää 
return
åå 
$num
åå 
;
åå 
}
ææ 
}
çç 	
}
óó 
}ôô ü˜
TD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\H101\c_FH101.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{   
public!! 

class!! 
FH101!! 
:!! 
IDisposable!! $
{"" 
public&& 
event&& (
FH101ErrorRaisedEventHandler&& 1
H101ErrorRaised&&2 A
=&&B C
null&&D H
;&&H I
public'' 
event'' &
FH101ConnectedEventHandler'' /
H101Connected''0 =
=''> ?
null''@ D
;''D E
public(( 
event(( )
FH101DisconnectedEventHandler(( 2
H101Disconnected((3 C
=((D E
null((F J
;((J K
public,, 
const,, 
string,, 
XGEN_TAG_VERSION,, ,
=,,- .
$str,,/ 8
;,,8 9
public-- 
const-- 
string-- 
XGEN_TAG_INTERFACE-- .
=--/ 0
$str--1 <
;--< =
public.. 
const.. 
string.. 
XGEN_TAG_MODULE.. +
=.., -
$str... 6
;..6 7
public// 
const// 
string// 
XGEN_TAG_OPERATION// .
=/// 0
$str//1 <
;//< =
public00 
const00 
string00 
XGEN_TAG_TID00 (
=00) *
$str00+ 0
;000 1
public11 
const11 
string11 !
XGEN_TAG_SERVICE_NAME11 1
=112 3
$str114 C
;11C D
public33 
const33 
string33  
XGEN_TAG_RESULT_CODE33 0
=331 2
$str333 @
;33@ A
public44 
const44 
string44 
XGEN_TAG_RESULT_MSG44 /
=440 1
$str442 >
;44> ?
public66 
const66 
string66  
XGEN_DEFAULT_VERSION66 0
=661 2
$str663 8
;668 9
public77 
const77 
int77 
XGEN_DEFAULT_TTL77 )
=77* +
$num77, 0
;770 1
public88 
const88 
int88 '
XGEN_DEFAULT_GUARANTEED_TTL88 4
=885 6
$num887 ?
;88? @
public:: 
const:: 
string:: 
INVALID_CHANNEL:: +
=::, -
$str::. ?
;::? @
public;; 
const;; 
string;; 
INVALID_MESSAGE;; +
=;;, -
$str;;. ?
;;;? @
private?? 
bool?? 

m_disposed?? 
=??  !
false??" '
;??' (
privateAA 
FIDPointer32AA 
m_fTidPointerAA *
=AA+ ,
nullAA- 1
;AA1 2
privateBB 
SessionBB 
	m_sessionBB !
=BB" #
nullBB$ (
;BB( )
privateCC 
	HashtableCC 
m_dispatchersCC '
=CC( )
nullCC* .
;CC. /
privateDD  
FH101MessageConsumerDD $

m_consumerDD% /
=DD0 1
nullDD2 6
;DD6 7
privateEE %
FH101SessionEventListenerEE )
m_eventListenerEE* 9
=EE: ;
nullEE< @
;EE@ A
privateGG 
stringGG 
m_sessionIdGG "
=GG# $
stringGG% +
.GG+ ,
EmptyGG, 1
;GG1 2
privateHH 
stringHH 
m_connectStringHH &
=HH' (
stringHH) /
.HH/ 0
EmptyHH0 5
;HH5 6
privateII 
stringII 
	m_versionII  
=II! "
stringII# )
.II) *
EmptyII* /
;II/ 0
privateJJ 
intJJ 
m_ttlJJ 
=JJ 
$numJJ 
;JJ 
privateKK 
intKK 
m_guaranteedTtlKK #
=KK$ %
$numKK& '
;KK' (
privateLL 
boolLL 
m_isCompressedLL #
=LL$ %
falseLL& +
;LL+ ,
privateMM 
boolMM 
m_isTrsMM 
=MM 
falseMM $
;MM$ %
publicSS 
FH101SS 
(SS 
)TT 
{UU 	
m_fTidPointerVV 
=VV 
newVV 
FIDPointer32VV  ,
(VV, -
)VV- .
;VV. /
m_sessionIdXX 
=XX 
$strXX !
;XX! "
m_connectStringYY 
=YY 
$strYY /
;YY/ 0
	m_versionZZ 
=ZZ  
XGEN_DEFAULT_VERSIONZZ ,
;ZZ, -
m_ttl[[ 
=[[ 
XGEN_DEFAULT_TTL[[ $
;[[$ %
m_guaranteedTtl\\ 
=\\ '
XGEN_DEFAULT_GUARANTEED_TTL\\ 9
;\\9 :
m_isCompressed]] 
=]] 
true]] !
;]]! "
m_isTrs^^ 
=^^ 
false^^ 
;^^ 
}__ 	
publiccc 
FH101cc 
(cc 
stringdd 
	sessionIddd 
,dd 
stringee 
connectStringee  
,ee  !
stringff 
versionff 
,ff 
intgg 
ttlgg 
,gg 
inthh 
guaranteedTtlhh 
,hh 
boolii 
isCompressedii 
,ii 
booljj 
isTrsjj 
)kk 
{ll 	
m_fTidPointermm 
=mm 
newmm 
FIDPointer32mm  ,
(mm, -
)mm- .
;mm. /
m_sessionIdoo 
=oo 
	sessionIdoo #
;oo# $
m_connectStringpp 
=pp 
connectStringpp +
;pp+ ,
	m_versionqq 
=qq 
versionqq 
;qq  
m_ttlrr 
=rr 
ttlrr 
;rr 
m_guaranteedTtlss 
=ss 
guaranteedTtlss +
;ss+ ,
m_isCompressedtt 
=tt 
isCompressedtt )
;tt) *
m_isTrsuu 
=uu 
isTrsuu 
;uu 
}vv 	
~zz 	
FH101zz	 
(zz 
){{ 
{|| 	
	myDispose}} 
(}} 
false}} 
)}} 
;}} 
}~~ 	
	protected
‚‚ 
void
‚‚ 
	myDispose
‚‚  
(
‚‚  !
bool
ƒƒ 
	disposing
ƒƒ 
)
„„ 
{
…… 	
if
†† 
(
†† 
!
†† 

m_disposed
†† 
)
†† 
{
‡‡ 
if
ˆˆ 
(
ˆˆ 
	disposing
ˆˆ 
)
ˆˆ 
{
‰‰ 
term
ŠŠ 
(
ŠŠ 
)
ŠŠ 
;
ŠŠ 
if
ŒŒ 
(
ŒŒ 
m_fTidPointer
ŒŒ %
!=
ŒŒ& (
null
ŒŒ) -
)
ŒŒ- .
{
 
m_fTidPointer
 %
.
% &
Dispose
& -
(
- .
)
. /
;
/ 0
m_fTidPointer
 %
=
& '
null
( ,
;
, -
}
 
}
‘‘ 

m_disposed
’’ 
=
’’ 
true
’’ !
;
’’! "
}
““ 
}
”” 	
public
œœ 
void
œœ 
Dispose
œœ 
(
œœ 
)
 
{
 	
	myDispose
ŸŸ 
(
ŸŸ 
true
ŸŸ 
)
ŸŸ 
;
ŸŸ 
GC
   
.
   
SuppressFinalize
   
(
    
this
    $
)
  $ %
;
  % &
}
¡¡ 	
public
©© 
string
©© 
	sessionId
©© 
{
ªª 	
get
«« 
{
¬¬ 
try
­­ 
{
®® 
return
¯¯ 
m_sessionId
¯¯ &
;
¯¯& '
}
°° 
catch
±± 
(
±± 
	Exception
±±  
ex
±±! #
)
±±# $
{
²² 
FDebug
³³ 
.
³³ 
throwException
³³ )
(
³³) *
ex
³³* ,
)
³³, -
;
³³- .
}
´´ 
finally
µµ 
{
¶¶ 
}
¸¸ 
return
¹¹ 
string
¹¹ 
.
¹¹ 
Empty
¹¹ #
;
¹¹# $
}
ºº 
}
»» 	
public
¿¿ 
string
¿¿ 
connectString
¿¿ #
{
ÀÀ 	
get
ÁÁ 
{
ÂÂ 
try
ÃÃ 
{
ÄÄ 
return
ÅÅ 
m_connectString
ÅÅ *
;
ÅÅ* +
}
ÆÆ 
catch
ÇÇ 
(
ÇÇ 
	Exception
ÇÇ  
ex
ÇÇ! #
)
ÇÇ# $
{
ÈÈ 
FDebug
ÉÉ 
.
ÉÉ 
throwException
ÉÉ )
(
ÉÉ) *
ex
ÉÉ* ,
)
ÉÉ, -
;
ÉÉ- .
}
ÊÊ 
finally
ËË 
{
ÌÌ 
}
ÎÎ 
return
ÏÏ 
string
ÏÏ 
.
ÏÏ 
Empty
ÏÏ #
;
ÏÏ# $
}
ĞĞ 
}
ÑÑ 	
public
ÕÕ 
string
ÕÕ 
version
ÕÕ 
{
ÖÖ 	
get
×× 
{
ØØ 
try
ÙÙ 
{
ÚÚ 
return
ÛÛ 
	m_version
ÛÛ $
;
ÛÛ$ %
}
ÜÜ 
catch
İİ 
(
İİ 
	Exception
İİ  
ex
İİ! #
)
İİ# $
{
ŞŞ 
FDebug
ßß 
.
ßß 
throwException
ßß )
(
ßß) *
ex
ßß* ,
)
ßß, -
;
ßß- .
}
àà 
finally
áá 
{
ââ 
}
ää 
return
åå 
string
åå 
.
åå 
Empty
åå #
;
åå# $
}
ææ 
}
çç 	
public
ëë 
int
ëë 
ttl
ëë 
{
ìì 	
get
íí 
{
îî 
try
ïï 
{
ğğ 
return
ññ 
m_ttl
ññ  
;
ññ  !
}
òò 
catch
óó 
(
óó 
	Exception
óó  
ex
óó! #
)
óó# $
{
ôô 
FDebug
õõ 
.
õõ 
throwException
õõ )
(
õõ) *
ex
õõ* ,
)
õõ, -
;
õõ- .
}
öö 
finally
÷÷ 
{
øø 
}
úú 
return
ûû 
$num
ûû 
;
ûû 
}
üü 
}
ıı 	
public
 
int
 
guaranteedTtl
  
{
‚‚ 	
get
ƒƒ 
{
„„ 
try
…… 
{
†† 
return
‡‡ 
m_guaranteedTtl
‡‡ *
;
‡‡* +
}
ˆˆ 
catch
‰‰ 
(
‰‰ 
	Exception
‰‰  
ex
‰‰! #
)
‰‰# $
{
ŠŠ 
FDebug
‹‹ 
.
‹‹ 
throwException
‹‹ )
(
‹‹) *
ex
‹‹* ,
)
‹‹, -
;
‹‹- .
}
ŒŒ 
finally
 
{
 
}
 
return
‘‘ 
$num
‘‘ 
;
‘‘ 
}
’’ 
}
““ 	
public
—— 
bool
—— 
isCompressed
——  
{
˜˜ 	
get
™™ 
{
šš 
try
›› 
{
œœ 
return
 
m_isCompressed
 )
;
) *
}
 
catch
ŸŸ 
(
ŸŸ 
	Exception
ŸŸ  
ex
ŸŸ! #
)
ŸŸ# $
{
   
FDebug
¡¡ 
.
¡¡ 
throwException
¡¡ )
(
¡¡) *
ex
¡¡* ,
)
¡¡, -
;
¡¡- .
}
¢¢ 
finally
££ 
{
¤¤ 
}
¦¦ 
return
§§ 
false
§§ 
;
§§ 
}
¨¨ 
}
©© 	
public
­­ 
bool
­­ 
isTrs
­­ 
{
®® 	
get
¯¯ 
{
°° 
try
±± 
{
²² 
return
³³ 
m_isTrs
³³ "
;
³³" #
}
´´ 
catch
µµ 
(
µµ 
	Exception
µµ  
ex
µµ! #
)
µµ# $
{
¶¶ 
FDebug
·· 
.
·· 
throwException
·· )
(
··) *
ex
··* ,
)
··, -
;
··- .
}
¸¸ 
finally
¹¹ 
{
ºº 
}
¼¼ 
return
½½ 
false
½½ 
;
½½ 
}
¾¾ 
}
¿¿ 	
public
ÃÃ 
bool
ÃÃ 
started
ÃÃ 
{
ÄÄ 	
get
ÅÅ 
{
ÆÆ 
try
ÇÇ 
{
ÈÈ 
if
ÉÉ 
(
ÉÉ 
	m_session
ÉÉ !
!=
ÉÉ" $
null
ÉÉ% )
&&
ÉÉ* ,
	m_session
ÉÉ- 6
.
ÉÉ6 7
	isStarted
ÉÉ7 @
(
ÉÉ@ A
)
ÉÉA B
)
ÉÉB C
{
ÊÊ 
return
ËË 
true
ËË #
;
ËË# $
}
ÌÌ 
return
ÍÍ 
false
ÍÍ  
;
ÍÍ  !
}
ÎÎ 
catch
ÏÏ 
(
ÏÏ 
	Exception
ÏÏ  
ex
ÏÏ! #
)
ÏÏ# $
{
ĞĞ 
FDebug
ÑÑ 
.
ÑÑ 
throwException
ÑÑ )
(
ÑÑ) *
ex
ÑÑ* ,
)
ÑÑ, -
;
ÑÑ- .
}
ÒÒ 
finally
ÓÓ 
{
ÔÔ 
}
ÖÖ 
return
×× 
false
×× 
;
×× 
}
ØØ 
}
ÙÙ 	
internal
İİ 
Session
İİ 
session
İİ  
{
ŞŞ 	
get
ßß 
{
àà 
try
áá 
{
ââ 
return
ãã 
	m_session
ãã $
;
ãã$ %
}
ää 
catch
åå 
(
åå 
	Exception
åå  
ex
åå! #
)
åå# $
{
ææ 
FDebug
çç 
.
çç 
throwException
çç )
(
çç) *
ex
çç* ,
)
çç, -
;
çç- .
}
èè 
finally
éé 
{
êê 
}
ìì 
return
íí 
null
íí 
;
íí 
}
îî 
}
ïï 	
internal
óó 
FIDPointer32
óó 
fTidPointer
óó )
{
ôô 	
get
õõ 
{
öö 
try
÷÷ 
{
øø 
return
ùù 
m_fTidPointer
ùù (
;
ùù( )
}
úú 
catch
ûû 
(
ûû 
	Exception
ûû  
ex
ûû! #
)
ûû# $
{
üü 
FDebug
ıı 
.
ıı 
throwException
ıı )
(
ıı) *
ex
ıı* ,
)
ıı, -
;
ıı- .
}
şş 
finally
ÿÿ 
{
€€ 
}
‚‚ 
return
ƒƒ 
null
ƒƒ 
;
ƒƒ 
}
„„ 
}
…… 	
public
‰‰ 
bool
‰‰ 
isConnected
‰‰ 
{
ŠŠ 	
get
‹‹ 
{
ŒŒ 
try
 
{
 
return
 
	m_session
 $
.
$ %
isConnected
% 0
(
0 1
)
1 2
;
2 3
}
 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘  
ex
‘‘! #
)
‘‘# $
{
’’ 
FDebug
““ 
.
““ 
throwException
““ )
(
““) *
ex
““* ,
)
““, -
;
““- .
}
”” 
finally
•• 
{
–– 
}
˜˜ 
return
™™ 
false
™™ 
;
™™ 
}
šš 
}
›› 	
public
££ 
void
££ 
init
££ 
(
££ 
FH101StationMode
¤¤ 
mode
¤¤ !
)
¥¥ 
{
¦¦ 	
try
§§ 
{
¨¨ 
if
©© 
(
©© 
	m_session
©© 
==
©©  
null
©©! %
)
©©% &
{
ªª 
m_dispatchers
«« !
=
««" #
new
««$ '
	Hashtable
««( 1
(
««1 2
)
««2 3
;
««3 4

m_consumer
¬¬ 
=
¬¬  
new
¬¬! $"
FH101MessageConsumer
¬¬% 9
(
¬¬9 :
this
¬¬: >
,
¬¬> ?
m_dispatchers
¬¬@ M
)
¬¬M N
;
¬¬N O
m_eventListener
­­ #
=
­­$ %
new
­­& )'
FH101SessionEventListener
­­* C
(
­­C D
this
­­D H
)
­­H I
;
­­I J
	m_session
¯¯ 
=
¯¯ 
Transceiver
¯¯  +
.
¯¯+ ,
createSession
¯¯, 9
(
¯¯9 :
m_sessionId
°° #
,
°°# $
(
±± 
mode
±± 
==
±±  
FH101StationMode
±±! 1
.
±±1 2
Inner
±±2 7
?
±±8 9
Session_Fields
±±: H
.
±±H I(
SESSION_INNER_STATION_MODE
±±I c
:
±±d e
Session_Fields
±±f t
.
±±t u)
SESSION_INTER_STATION_MODE±±u 
)±± 
|±±‘ ’
Session_Fields±±“ ¡
.±±¡ ¢*
SESSION_PUSH_DELIVERY_MODE±±¢ ¼
)
²² 
;
²² 
	m_session
³³ 
.
³³  
addMessageConsumer
³³ 0
(
³³0 1

m_consumer
³³1 ;
)
³³; <
;
³³< =
	m_session
´´ 
.
´´ %
addSessionEventListener
´´ 5
(
´´5 6
m_eventListener
´´6 E
)
´´E F
;
´´F G
	m_session
µµ 
.
µµ 
setAutoRecovery
µµ -
(
µµ- .
true
µµ. 2
)
µµ2 3
;
µµ3 4
	m_session
¶¶ 
.
¶¶ 
connect
¶¶ %
(
¶¶% &
m_connectString
¶¶& 5
)
¶¶5 6
;
¶¶6 7
}
·· 
}
¸¸ 
catch
¹¹ 
(
¹¹ 
	Exception
¹¹ 
ex
¹¹ 
)
¹¹  
{
ºº 
FDebug
»» 
.
»» 
throwFException
»» &
(
»»& '
ex
¼¼ 
.
¼¼ 
InnerException
¼¼ %
==
¼¼& (
null
¼¼) -
?
¼¼. /
ex
¼¼0 2
.
¼¼2 3
Message
¼¼3 :
:
¼¼; <
ex
¼¼= ?
.
¼¼? @
InnerException
¼¼@ N
.
¼¼N O
Message
¼¼O V
)
½½ 
;
½½ 
}
¾¾ 
finally
¿¿ 
{
ÀÀ 
}
ÂÂ 
}
ÃÃ 	
public
ÇÇ 
void
ÇÇ 
init
ÇÇ 
(
ÇÇ 
)
ÈÈ 
{
ÉÉ 	
try
ÊÊ 
{
ËË 
init
ÌÌ 
(
ÌÌ 
FH101StationMode
ÌÌ %
.
ÌÌ% &
Inner
ÌÌ& +
)
ÌÌ+ ,
;
ÌÌ, -
}
ÍÍ 
catch
ÎÎ 
(
ÎÎ 
	Exception
ÎÎ 
ex
ÎÎ 
)
ÎÎ  
{
ÏÏ 
FDebug
ĞĞ 
.
ĞĞ 
throwFException
ĞĞ &
(
ĞĞ& '
ex
ĞĞ' )
.
ĞĞ) *
Message
ĞĞ* 1
)
ĞĞ1 2
;
ĞĞ2 3
}
ÑÑ 
finally
ÒÒ 
{
ÓÓ 
}
ÕÕ 
}
ÖÖ 	
public
ÚÚ 
void
ÚÚ 
term
ÚÚ 
(
ÚÚ 
)
ÛÛ 
{
ÜÜ 	
try
İİ 
{
ŞŞ 
if
ßß 
(
ßß 
	m_session
ßß 
!=
ßß  
null
ßß! %
)
ßß% &
{
àà 
if
áá 
(
áá 
	m_session
áá !
.
áá! "
isConnected
áá" -
(
áá- .
)
áá. /
)
áá/ 0
{
ââ 
	m_session
ãã !
.
ãã! "

disconnect
ãã" ,
(
ãã, -
)
ãã- .
;
ãã. /
}
ää 
	m_session
ëë 
.
ëë 
destroy
ëë %
(
ëë% &
)
ëë& '
;
ëë' (
	m_session
ìì 
=
ìì 
null
ìì  $
;
ìì$ %
}
íí 
if
ïï 
(
ïï 

m_consumer
ïï 
!=
ïï !
null
ïï" &
)
ïï& '
{
ğğ 

m_consumer
ññ 
.
ññ 
Dispose
ññ &
(
ññ& '
)
ññ' (
;
ññ( )

m_consumer
òò 
=
òò  
null
òò! %
;
òò% &
}
óó 
if
õõ 
(
õõ 
m_eventListener
õõ #
!=
õõ$ &
null
õõ' +
)
õõ+ ,
{
öö 
m_eventListener
÷÷ #
.
÷÷# $
Dispose
÷÷$ +
(
÷÷+ ,
)
÷÷, -
;
÷÷- .
m_eventListener
øø #
=
øø$ %
null
øø& *
;
øø* +
}
ùù 
m_dispatchers
ûû 
=
ûû 
null
ûû  $
;
ûû$ %
}
üü 
catch
ıı 
(
ıı 
	Exception
ıı 
ex
ıı 
)
ıı  
{
şş 
FDebug
ÿÿ 
.
ÿÿ 
throwException
ÿÿ %
(
ÿÿ% &
ex
ÿÿ& (
)
ÿÿ( )
;
ÿÿ) *
}
€€ 
finally
 
{
‚‚ 
}
„„ 
}
…… 	
internal
‰‰ 
void
‰‰ 
onH101Connected
‰‰ %
(
‰‰% &
)
ŠŠ 
{
‹‹ 	
try
ŒŒ 
{
 
if
 
(
 
H101Connected
 !
==
" $
null
% )
)
) *
{
 
return
 
;
 
}
‘‘ 
H101Connected
•• 
(
•• 
this
•• "
)
••" #
;
••# $
}
–– 
catch
—— 
{
˜˜ 
}
šš 
finally
›› 
{
œœ 
}
 
}
ŸŸ 	
internal
££ 
void
££  
onH101Disconnected
££ (
(
££( )
)
¤¤ 
{
¥¥ 	
try
¦¦ 
{
§§ 
if
¨¨ 
(
¨¨ 
H101Disconnected
¨¨ $
==
¨¨% '
null
¨¨( ,
)
¨¨, -
{
©© 
return
ªª 
;
ªª 
}
«« 
H101Disconnected
¯¯  
(
¯¯  !
this
¯¯! %
)
¯¯% &
;
¯¯& '
}
°° 
catch
±± 
{
²² 
}
´´ 
finally
µµ 
{
¶¶ 
}
¸¸ 
}
¹¹ 	
internal
½½ 
void
½½ 
onH101ErrorRaised
½½ '
(
½½' (
	Exception
¾¾ 
inEx
¾¾ 
)
¿¿ 
{
ÀÀ 	
try
ÁÁ 
{
ÂÂ 
if
ÃÃ 
(
ÃÃ 
H101ErrorRaised
ÃÃ #
==
ÃÃ$ &
null
ÃÃ' +
)
ÃÃ+ ,
{
ÄÄ 
return
ÅÅ 
;
ÅÅ 
}
ÆÆ 
H101ErrorRaised
ÊÊ 
(
ÊÊ  
this
ÊÊ  $
,
ÊÊ$ %
new
ÊÊ& )'
FH101ErrorRaisedEventArgs
ÊÊ* C
(
ÊÊC D
this
ÊÊD H
,
ÊÊH I
inEx
ÊÊJ N
.
ÊÊN O
Message
ÊÊO V
,
ÊÊV W
inEx
ÊÊX \
)
ÊÊ\ ]
)
ÊÊ] ^
;
ÊÊ^ _
}
ËË 
catch
ÌÌ 
(
ÌÌ 
	Exception
ÌÌ 
ex
ÌÌ 
)
ÌÌ  
{
ÍÍ 
FDebug
ÎÎ 
.
ÎÎ 
writeLog
ÎÎ 
(
ÎÎ  
ex
ÎÎ  "
)
ÎÎ" #
;
ÎÎ# $
}
ÏÏ 
finally
ĞĞ 
{
ÑÑ 
}
ÓÓ 
}
ÔÔ 	
public
ØØ 
void
ØØ  
registerDispatcher
ØØ &
(
ØØ& '
string
ÙÙ 
module
ÙÙ 
,
ÙÙ 
object
ÚÚ 
tuner
ÚÚ 
)
ÛÛ 
{
ÜÜ 	
try
İİ 
{
ŞŞ 
m_dispatchers
ßß 
.
ßß 
Add
ßß !
(
ßß! "
module
ßß" (
,
ßß( )
tuner
ßß* /
)
ßß/ 0
;
ßß0 1
}
àà 
catch
áá 
(
áá 
	Exception
áá 
ex
áá 
)
áá  
{
ââ 
FDebug
ãã 
.
ãã 
throwException
ãã %
(
ãã% &
ex
ãã& (
)
ãã( )
;
ãã) *
}
ää 
finally
åå 
{
ææ 
}
èè 
}
éé 	
public
íí 
void
íí "
unregisterDispatcher
íí (
(
íí( )
string
îî 
module
îî 
)
ïï 
{
ğğ 	
try
ññ 
{
òò 
if
óó 
(
óó 
m_dispatchers
óó !
.
óó! "
ContainsKey
óó" -
(
óó- .
module
óó. 4
)
óó4 5
)
óó5 6
{
ôô 
m_dispatchers
õõ !
.
õõ! "
Remove
õõ" (
(
õõ( )
module
õõ) /
)
õõ/ 0
;
õõ0 1
}
öö 
}
÷÷ 
catch
øø 
(
øø 
	Exception
øø 
ex
øø 
)
øø  
{
ùù 
FDebug
úú 
.
úú 
throwException
úú %
(
úú% &
ex
úú& (
)
úú( )
;
úú) *
}
ûû 
finally
üü 
{
ıı 
}
ÿÿ 
}
€€ 	
public
„„ 
void
„„ 
tune
„„ 
(
„„ 
string
…… 
channel
…… 
,
…… 
bool
†† 
isMulticast
†† 
,
†† 
bool
‡‡ 
isGuaranteed
‡‡ 
)
ˆˆ 
{
‰‰ 	
try
ŠŠ 
{
‹‹ 
if
ŒŒ 
(
ŒŒ 
isMulticast
ŒŒ 
)
ŒŒ  
{
 
if
 
(
 
isGuaranteed
 $
)
$ %
{
 
	m_session
 !
.
! "%
tuneGuaranteedMulticast
" 9
(
9 :
channel
: A
)
A B
;
B C
}
‘‘ 
else
’’ 
{
““ 
	m_session
”” !
.
””! "
tuneMulticast
””" /
(
””/ 0
channel
””0 7
)
””7 8
;
””8 9
}
•• 
}
–– 
else
—— 
{
˜˜ 
if
™™ 
(
™™ 
isGuaranteed
™™ $
)
™™$ %
{
šš 
	m_session
›› !
.
››! "#
tuneGuaranteedUnicast
››" 7
(
››7 8
channel
››8 ?
)
››? @
;
››@ A
}
œœ 
else
 
{
 
	m_session
ŸŸ !
.
ŸŸ! "
tuneUnicast
ŸŸ" -
(
ŸŸ- .
channel
ŸŸ. 5
)
ŸŸ5 6
;
ŸŸ6 7
}
   
}
¡¡ 
}
¢¢ 
catch
££ 
(
££ 
	Exception
££ 
ex
££ 
)
££  
{
¤¤ 
FDebug
¥¥ 
.
¥¥ 
throwException
¥¥ %
(
¥¥% &
ex
¥¥& (
)
¥¥( )
;
¥¥) *
}
¦¦ 
finally
§§ 
{
¨¨ 
}
ªª 
}
«« 	
public
¯¯ 
void
¯¯ 
untune
¯¯ 
(
¯¯ 
string
°° 
channel
°° 
,
°° 
bool
±± 
isMulticast
±± 
,
±± 
bool
²² 
isGuaranteed
²² 
)
³³ 
{
´´ 	
try
µµ 
{
¶¶ 
if
·· 
(
·· 
!
·· 
	m_session
·· 
.
·· 
isConnected
·· *
(
··* +
)
··+ ,
)
··, -
{
¸¸ 
return
¹¹ 
;
¹¹ 
}
ºº 
if
¾¾ 
(
¾¾ 
isMulticast
¾¾ 
)
¾¾  
{
¿¿ 
if
ÀÀ 
(
ÀÀ 
isGuaranteed
ÀÀ $
)
ÀÀ$ %
{
ÁÁ 
	m_session
ÂÂ !
.
ÂÂ! "'
untuneGuaranteedMulticast
ÂÂ" ;
(
ÂÂ; <
channel
ÂÂ< C
)
ÂÂC D
;
ÂÂD E
}
ÃÃ 
else
ÄÄ 
{
ÅÅ 
	m_session
ÆÆ !
.
ÆÆ! "
untuneMulticast
ÆÆ" 1
(
ÆÆ1 2
channel
ÆÆ2 9
)
ÆÆ9 :
;
ÆÆ: ;
}
ÇÇ 
}
ÈÈ 
else
ÉÉ 
{
ÊÊ 
if
ËË 
(
ËË 
isGuaranteed
ËË $
)
ËË$ %
{
ÌÌ 
	m_session
ÍÍ !
.
ÍÍ! "%
untuneGuaranteedUnicast
ÍÍ" 9
(
ÍÍ9 :
channel
ÍÍ: A
)
ÍÍA B
;
ÍÍB C
}
ÎÎ 
else
ÏÏ 
{
ĞĞ 
	m_session
ÑÑ !
.
ÑÑ! "
untuneUnicast
ÑÑ" /
(
ÑÑ/ 0
channel
ÑÑ0 7
)
ÑÑ7 8
;
ÑÑ8 9
}
ÒÒ 
}
ÓÓ 
}
ÔÔ 
catch
ÕÕ 
{
ÖÖ 
}
ÛÛ 
finally
ÜÜ 
{
İİ 
}
ßß 
}
àà 	
private
ää 
Message
ää 
setProperties
ää %
(
ää% &
Message
åå 
req
åå 
,
åå 
string
ææ 
serviceName
ææ 
,
ææ 
string
çç 
module
çç 
,
çç 
string
èè 
	operation
èè 
,
èè 
FXmlNode
éé 
property
éé 
,
éé 
UInt32
êê 
tid
êê 
)
ëë 
{
ìì 	
string
íí 
name
íí 
=
íí 
string
íí  
.
íí  !
Empty
íí! &
;
íí& '
if
îî 
(
îî 
req
îî 
==
îî 
null
îî 
)
îî 
return
îî #
req
îî$ '
;
îî' (
try
ğğ 
{
ññ 
req
òò 
.
òò 
setProperty
òò 
(
òò  
XGEN_TAG_VERSION
òò  0
,
òò0 1
	m_version
òò2 ;
)
òò; <
;
òò< =
req
óó 
.
óó 
setProperty
óó 
(
óó  
XGEN_TAG_MODULE
óó  /
,
óó/ 0
module
óó1 7
)
óó7 8
;
óó8 9
req
ôô 
.
ôô 
setProperty
ôô 
(
ôô   
XGEN_TAG_INTERFACE
ôô  2
,
ôô2 3
module
ôô4 :
)
ôô: ;
;
ôô; <
req
õõ 
.
õõ 
setProperty
õõ 
(
õõ   
XGEN_TAG_OPERATION
õõ  2
,
õõ2 3
	operation
õõ4 =
)
õõ= >
;
õõ> ?
req
öö 
.
öö 
setProperty
öö 
(
öö  
XGEN_TAG_TID
öö  ,
,
öö, -
tid
öö. 1
.
öö1 2
ToString
öö2 :
(
öö: ;
)
öö; <
)
öö< =
;
öö= >
if
÷÷ 
(
÷÷ 
serviceName
÷÷ 
!=
÷÷  "
string
÷÷# )
.
÷÷) *
Empty
÷÷* /
)
÷÷/ 0
{
øø 
req
ùù 
.
ùù 
setProperty
ùù #
(
ùù# $#
XGEN_TAG_SERVICE_NAME
ùù$ 9
,
ùù9 :
serviceName
ùù; F
)
ùùF G
;
ùùG H
}
úú 
if
‚‚ 
(
‚‚ 
property
‚‚ 
!=
‚‚ 
null
‚‚ #
)
‚‚# $
{
ƒƒ 
foreach
„„ 
(
„„ 
FXmlNode
„„ %
pItem
„„& +
in
„„, .
property
„„/ 7
.
„„7 8
fChildNodes
„„8 C
)
„„C D
{
…… 
if
†† 
(
†† 
pItem
†† !
.
††! "
innerXml
††" *
!=
††+ -
$str
††. 0
)
††0 1
{
‡‡ 
name
ˆˆ  
=
ˆˆ! "
pItem
ˆˆ# (
.
ˆˆ( )
get_attrVal
ˆˆ) 4
(
ˆˆ4 5
$str
ˆˆ5 8
)
ˆˆ8 9
;
ˆˆ9 :
req
‰‰ 
.
‰‰  
setProperty
‰‰  +
(
‰‰+ ,
name
‰‰, 0
,
‰‰0 1
pItem
‰‰2 7
.
‰‰7 8
innerXml
‰‰8 @
)
‰‰@ A
;
‰‰A B
}
ŠŠ 
}
ŒŒ 
}
 
}
 
catch
 
(
 
	Exception
 
ex
 
)
  
{
 
FDebug
‘‘ 
.
‘‘ 
throwException
‘‘ %
(
‘‘% &
ex
‘‘& (
)
‘‘( )
;
‘‘) *
}
’’ 
finally
““ 
{
”” 
}
–– 
return
˜˜ 
req
˜˜ 
;
˜˜ 
}
šš 	
public
ŸŸ 
void
ŸŸ 
sendUnicast
ŸŸ 
(
ŸŸ  
string
   
serviceName
   
,
   
string
¡¡ 
module
¡¡ 
,
¡¡ 
string
¢¢ 
	operation
¢¢ 
,
¢¢ 
string
££ 
data
££ 
,
££ 
string
¤¤ 
channel
¤¤ 
,
¤¤ 
int
¥¥ 
ttl
¥¥ 
,
¥¥ 
UInt32
¦¦ 
tid
¦¦ 
)
§§ 
{
¨¨ 	
Message
©© 
req
©© 
=
©© 
null
©© 
;
©© 
StreamTransformer
ªª 
former
ªª $
=
ªª% &
null
ªª' +
;
ªª+ ,
try
¬¬ 
{
­­ 
req
®® 
=
®® 
	m_session
®® 
.
®®  
createMessage
®®  -
(
®®- .
)
®®. /
;
®®/ 0
req
¯¯ 
=
¯¯ 
setProperties
¯¯ #
(
¯¯# $
req
¯¯$ '
,
¯¯' (
serviceName
¯¯) 4
,
¯¯4 5
module
¯¯6 <
,
¯¯< =
	operation
¯¯> G
,
¯¯G H
null
¯¯I M
,
¯¯M N
tid
¯¯O R
)
¯¯R S
;
¯¯S T
req
³³ 
.
³³ 
setDeliveryMode
³³ #
(
³³# $
DeliveryType
³³$ 0
.
³³0 1
UNICAST
³³1 8
)
³³8 9
;
³³9 :
req
´´ 
.
´´ 

setChannel
´´ 
(
´´ 
channel
´´ &
)
´´& '
;
´´' (
req
µµ 
.
µµ 
setTTL
µµ 
(
µµ 
$num
µµ 
<
µµ 
ttl
µµ "
?
µµ# $
ttl
µµ% (
:
µµ) *
m_ttl
µµ+ 0
)
µµ0 1
;
µµ1 2
if
¹¹ 
(
¹¹ 
m_isTrs
¹¹ 
)
¹¹ 
{
ºº 
former
»» 
=
»» 
new
»»  #
StreamTransformerImpl
»»! 6
(
»»6 7
$str
»»7 >
)
»»> ?
;
»»? @
former
¼¼ 
.
¼¼ 
writeMsgString
¼¼ )
(
¼¼) *
data
¼¼* .
)
¼¼. /
;
¼¼/ 0
req
½½ 
.
½½ 
setData
½½ 
(
½½  
former
½½  &
.
½½& '
getBytes
½½' /
(
½½/ 0
)
½½0 1
)
½½1 2
;
½½2 3
}
¾¾ 
else
¿¿ 
{
ÀÀ 
if
ÁÁ 
(
ÁÁ 
m_isCompressed
ÁÁ &
)
ÁÁ& '
{
ÂÂ 
req
ÃÃ 
.
ÃÃ 
setData
ÃÃ #
(
ÃÃ# $
F7Zip
ÃÃ$ )
.
ÃÃ) *
compress
ÃÃ* 2
(
ÃÃ2 3
data
ÃÃ3 7
)
ÃÃ7 8
)
ÃÃ8 9
;
ÃÃ9 :
}
ÄÄ 
else
ÅÅ 
{
ÆÆ 
req
ÇÇ 
.
ÇÇ 
setData
ÇÇ #
(
ÇÇ# $
data
ÇÇ$ (
)
ÇÇ( )
;
ÇÇ) *
}
ÈÈ 
}
ÉÉ 
	m_session
ÍÍ 
.
ÍÍ 
sendUnicast
ÍÍ %
(
ÍÍ% &
req
ÍÍ& )
)
ÍÍ) *
;
ÍÍ* +
}
ÎÎ 
catch
ÏÏ 
(
ÏÏ 
	Exception
ÏÏ 
ex
ÏÏ 
)
ÏÏ  
{
ĞĞ 
FDebug
ÑÑ 
.
ÑÑ 
throwException
ÑÑ %
(
ÑÑ% &
ex
ÑÑ& (
)
ÑÑ( )
;
ÑÑ) *
}
ÒÒ 
finally
ÓÓ 
{
ÔÔ 
req
ÕÕ 
=
ÕÕ 
null
ÕÕ 
;
ÕÕ 
}
ÖÖ 
}
×× 	
public
ÛÛ 
void
ÛÛ 
sendUnicast
ÛÛ 
(
ÛÛ  
string
ÜÜ 
serviceName
ÜÜ 
,
ÜÜ 
string
İİ 
module
İİ 
,
İİ 
string
ŞŞ 
	operation
ŞŞ 
,
ŞŞ 
FXmlNode
ßß 
property
ßß 
,
ßß 
string
àà 
data
àà 
,
àà 
string
áá 
channel
áá 
,
áá 
int
ââ 
ttl
ââ 
,
ââ 
UInt32
ãã 
tid
ãã 
)
ää 
{
åå 	
Message
ææ 
req
ææ 
=
ææ 
null
ææ 
;
ææ 
StreamTransformer
çç 
former
çç $
=
çç% &
null
çç' +
;
çç+ ,
try
éé 
{
êê 
req
ëë 
=
ëë 
	m_session
ëë 
.
ëë  
createMessage
ëë  -
(
ëë- .
)
ëë. /
;
ëë/ 0
req
ìì 
=
ìì 
setProperties
ìì #
(
ìì# $
req
ìì$ '
,
ìì' (
serviceName
ìì) 4
,
ìì4 5
module
ìì6 <
,
ìì< =
	operation
ìì> G
,
ììG H
property
ììI Q
,
ììQ R
tid
ììS V
)
ììV W
;
ììW X
req
ğğ 
.
ğğ 
setDeliveryMode
ğğ #
(
ğğ# $
DeliveryType
ğğ$ 0
.
ğğ0 1
UNICAST
ğğ1 8
)
ğğ8 9
;
ğğ9 :
req
ññ 
.
ññ 

setChannel
ññ 
(
ññ 
channel
ññ &
)
ññ& '
;
ññ' (
req
òò 
.
òò 
setTTL
òò 
(
òò 
$num
òò 
<
òò 
ttl
òò "
?
òò# $
ttl
òò% (
:
òò) *
m_ttl
òò+ 0
)
òò0 1
;
òò1 2
if
öö 
(
öö 
m_isTrs
öö 
)
öö 
{
÷÷ 
former
øø 
=
øø 
new
øø  #
StreamTransformerImpl
øø! 6
(
øø6 7
$str
øø7 >
)
øø> ?
;
øø? @
former
ùù 
.
ùù 
writeMsgString
ùù )
(
ùù) *
data
ùù* .
)
ùù. /
;
ùù/ 0
req
úú 
.
úú 
setData
úú 
(
úú  
former
úú  &
.
úú& '
getBytes
úú' /
(
úú/ 0
)
úú0 1
)
úú1 2
;
úú2 3
}
ûû 
else
üü 
{
ıı 
if
şş 
(
şş 
m_isCompressed
şş &
)
şş& '
{
ÿÿ 
req
€€ 
.
€€ 
setData
€€ #
(
€€# $
F7Zip
€€$ )
.
€€) *
compress
€€* 2
(
€€2 3
data
€€3 7
)
€€7 8
)
€€8 9
;
€€9 :
}
 
else
‚‚ 
{
ƒƒ 
req
„„ 
.
„„ 
setData
„„ #
(
„„# $
data
„„$ (
)
„„( )
;
„„) *
}
†† 
}
‡‡ 
	m_session
‹‹ 
.
‹‹ 
sendUnicast
‹‹ %
(
‹‹% &
req
‹‹& )
)
‹‹) *
;
‹‹* +
}
ŒŒ 
catch
 
(
 
	Exception
 
ex
 
)
  
{
 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
‘‘ 
{
’’ 
req
““ 
=
““ 
null
““ 
;
““ 
}
”” 
}
•• 	
public
™™ 
void
™™ 
sendUnicast
™™ 
(
™™  
string
šš 
serviceName
šš 
,
šš 
string
›› 
module
›› 
,
›› 
string
œœ 
	operation
œœ 
,
œœ 
FXmlNode
 
data
 
,
 
string
 
channel
 
,
 
int
ŸŸ 
ttl
ŸŸ 
,
ŸŸ 
UInt32
   
tid
   
)
¡¡ 
{
¢¢ 	
Message
££ 
req
££ 
=
££ 
null
££ 
;
££ 
StreamTransformer
¤¤ 
former
¤¤ $
=
¤¤% &
null
¤¤' +
;
¤¤+ ,
try
¦¦ 
{
§§ 
req
¨¨ 
=
¨¨ 
	m_session
¨¨ 
.
¨¨  
createMessage
¨¨  -
(
¨¨- .
)
¨¨. /
;
¨¨/ 0
req
©© 
=
©© 
setProperties
©© #
(
©©# $
req
©©$ '
,
©©' (
serviceName
©©) 4
,
©©4 5
module
©©6 <
,
©©< =
	operation
©©> G
,
©©G H
null
©©I M
,
©©M N
tid
©©O R
)
©©R S
;
©©S T
req
­­ 
.
­­ 
setDeliveryMode
­­ #
(
­­# $
DeliveryType
­­$ 0
.
­­0 1
UNICAST
­­1 8
)
­­8 9
;
­­9 :
req
®® 
.
®® 

setChannel
®® 
(
®® 
channel
®® &
)
®®& '
;
®®' (
req
¯¯ 
.
¯¯ 
setTTL
¯¯ 
(
¯¯ 
$num
¯¯ 
<
¯¯ 
ttl
¯¯ "
?
¯¯# $
ttl
¯¯% (
:
¯¯) *
m_ttl
¯¯+ 0
)
¯¯0 1
;
¯¯1 2
if
³³ 
(
³³ 
m_isTrs
³³ 
)
³³ 
{
´´ 
former
µµ 
=
µµ 
new
µµ  #
StreamTransformerImpl
µµ! 6
(
µµ6 7
$str
µµ7 >
)
µµ> ?
;
µµ? @
former
¶¶ 
.
¶¶ 
writeMsgString
¶¶ )
(
¶¶) *
data
¶¶* .
.
¶¶. /
outerXml
¶¶/ 7
)
¶¶7 8
;
¶¶8 9
req
·· 
.
·· 
setData
·· 
(
··  
former
··  &
.
··& '
getBytes
··' /
(
··/ 0
)
··0 1
)
··1 2
;
··2 3
}
¸¸ 
else
¹¹ 
{
ºº 
if
»» 
(
»» 
m_isCompressed
»» &
)
»»& '
{
¼¼ 
req
½½ 
.
½½ 
setData
½½ #
(
½½# $
F7Zip
½½$ )
.
½½) *
compress
½½* 2
(
½½2 3
data
½½3 7
.
½½7 8
outerXml
½½8 @
)
½½@ A
)
½½A B
;
½½B C
}
¾¾ 
else
¿¿ 
{
ÀÀ 
req
ÁÁ 
.
ÁÁ 
setData
ÁÁ #
(
ÁÁ# $
data
ÁÁ$ (
.
ÁÁ( )
outerXml
ÁÁ) 1
)
ÁÁ1 2
;
ÁÁ2 3
}
ÂÂ 
}
ÃÃ 
	m_session
ÇÇ 
.
ÇÇ 
sendUnicast
ÇÇ %
(
ÇÇ% &
req
ÇÇ& )
)
ÇÇ) *
;
ÇÇ* +
}
ÈÈ 
catch
ÉÉ 
(
ÉÉ 
	Exception
ÉÉ 
ex
ÉÉ 
)
ÉÉ  
{
ÊÊ 
FDebug
ËË 
.
ËË 
throwException
ËË %
(
ËË% &
ex
ËË& (
)
ËË( )
;
ËË) *
}
ÌÌ 
finally
ÍÍ 
{
ÎÎ 
req
ÏÏ 
=
ÏÏ 
null
ÏÏ 
;
ÏÏ 
}
ĞĞ 
}
ÑÑ 	
public
ÕÕ 
void
ÕÕ 
sendUnicast
ÕÕ 
(
ÕÕ  
string
ÖÖ 
serviceName
ÖÖ 
,
ÖÖ 
string
×× 
module
×× 
,
×× 
string
ØØ 
	operation
ØØ 
,
ØØ 
FXmlNode
ÙÙ 
data
ÙÙ 
,
ÙÙ 
string
ÚÚ 
channel
ÚÚ 
,
ÚÚ 
int
ÛÛ 
ttl
ÛÛ 
)
ÜÜ 
{
İİ 	
try
ŞŞ 
{
ßß 
sendUnicast
àà 
(
àà 
serviceName
àà '
,
àà' (
module
àà) /
,
àà/ 0
	operation
àà1 :
,
àà: ;
data
àà< @
,
àà@ A
channel
ààB I
,
ààI J
ttl
ààK N
,
ààN O
this
ààP T
.
ààT U
fTidPointer
ààU `
.
àà` a
uniqueId
ààa i
)
àài j
;
ààj k
}
áá 
catch
ââ 
(
ââ 
	Exception
ââ 
ex
ââ 
)
ââ  
{
ãã 
FDebug
ää 
.
ää 
throwException
ää %
(
ää% &
ex
ää& (
)
ää( )
;
ää) *
}
åå 
finally
ææ 
{
çç 
}
éé 
}
êê 	
public
îî 
void
îî 
sendUnicast
îî 
(
îî  
string
ïï 
module
ïï 
,
ïï 
string
ğğ 
	operation
ğğ 
,
ğğ 
FXmlNode
ññ 
data
ññ 
,
ññ 
string
òò 
channel
òò 
,
òò 
int
óó 
ttl
óó 
,
óó 
UInt32
ôô 
tid
ôô 
)
õõ 
{
öö 	
try
÷÷ 
{
øø 
sendUnicast
ùù 
(
ùù 
string
ùù "
.
ùù" #
Empty
ùù# (
,
ùù( )
module
ùù* 0
,
ùù0 1
	operation
ùù2 ;
,
ùù; <
data
ùù= A
,
ùùA B
channel
ùùC J
,
ùùJ K
ttl
ùùL O
,
ùùO P
tid
ùùQ T
)
ùùT U
;
ùùU V
}
úú 
catch
ûû 
(
ûû 
	Exception
ûû 
ex
ûû 
)
ûû  
{
üü 
FDebug
ıı 
.
ıı 
throwException
ıı %
(
ıı% &
ex
ıı& (
)
ıı( )
;
ıı) *
}
şş 
finally
€€ 
{
 
}
ƒƒ 
}
„„ 	
public
ˆˆ 
void
ˆˆ 
sendUnicast
ˆˆ 
(
ˆˆ  
string
‰‰ 
module
‰‰ 
,
‰‰ 
string
ŠŠ 
	operation
ŠŠ 
,
ŠŠ 
FXmlNode
‹‹ 
data
‹‹ 
,
‹‹ 
string
ŒŒ 
channel
ŒŒ 
,
ŒŒ 
int
 
ttl
 
)
 
{
 	
try
 
{
‘‘ 
sendUnicast
’’ 
(
’’ 
string
’’ "
.
’’" #
Empty
’’# (
,
’’( )
module
’’* 0
,
’’0 1
	operation
’’2 ;
,
’’; <
data
’’= A
,
’’A B
channel
’’C J
,
’’J K
ttl
’’L O
,
’’O P
this
’’Q U
.
’’U V
fTidPointer
’’V a
.
’’a b
uniqueId
’’b j
)
’’j k
;
’’k l
}
““ 
catch
”” 
(
”” 
	Exception
”” 
ex
”” 
)
””  
{
•• 
FDebug
–– 
.
–– 
throwException
–– %
(
––% &
ex
––& (
)
––( )
;
––) *
}
—— 
finally
˜˜ 
{
™™ 
}
›› 
}
œœ 	
public
¡¡ 
void
¡¡ #
sendGuaranteedUnicast
¡¡ )
(
¡¡) *
string
¢¢ 
module
¢¢ 
,
¢¢ 
string
££ 
	operation
££ 
,
££ 
string
¤¤ 
data
¤¤ 
,
¤¤ 
string
¥¥ 
channel
¥¥ 
,
¥¥ 
int
¦¦ 
guaranteedTtl
¦¦ 
,
¦¦ 
UInt32
§§ 
tid
§§ 
)
¨¨ 
{
©© 	
Message
ªª 
req
ªª 
=
ªª 
null
ªª 
;
ªª 
StreamTransformer
«« 
former
«« $
=
««% &
null
««' +
;
««+ ,
try
­­ 
{
®® 
req
¯¯ 
=
¯¯ 
	m_session
¯¯ 
.
¯¯  
createMessage
¯¯  -
(
¯¯- .
)
¯¯. /
;
¯¯/ 0
req
°° 
=
°° 
setProperties
°° #
(
°°# $
req
°°$ '
,
°°' (
$str
°°) +
,
°°+ ,
module
°°- 3
,
°°3 4
	operation
°°5 >
,
°°> ?
null
°°@ D
,
°°D E
tid
°°F I
)
°°I J
;
°°J K
req
´´ 
.
´´ 
setDeliveryMode
´´ #
(
´´# $
DeliveryType
´´$ 0
.
´´0 1 
GUARANTEED_UNICAST
´´1 C
)
´´C D
;
´´D E
req
µµ 
.
µµ 

setChannel
µµ 
(
µµ 
channel
µµ &
)
µµ& '
;
µµ' (
req
¶¶ 
.
¶¶ 
setTTL
¶¶ 
(
¶¶ 
$num
¶¶ 
<
¶¶ 
guaranteedTtl
¶¶ ,
?
¶¶- .
guaranteedTtl
¶¶/ <
:
¶¶= >
m_guaranteedTtl
¶¶? N
)
¶¶N O
;
¶¶O P
if
ºº 
(
ºº 
m_isTrs
ºº 
)
ºº 
{
»» 
former
¼¼ 
=
¼¼ 
new
¼¼  #
StreamTransformerImpl
¼¼! 6
(
¼¼6 7
)
¼¼7 8
;
¼¼8 9
former
½½ 
.
½½ 
writeMsgString
½½ )
(
½½) *
data
½½* .
)
½½. /
;
½½/ 0
req
¾¾ 
.
¾¾ 
setData
¾¾ 
(
¾¾  
former
¾¾  &
.
¾¾& '
getBytes
¾¾' /
(
¾¾/ 0
)
¾¾0 1
)
¾¾1 2
;
¾¾2 3
}
¿¿ 
else
ÀÀ 
{
ÁÁ 
if
ÂÂ 
(
ÂÂ 
m_isCompressed
ÂÂ &
)
ÂÂ& '
{
ÃÃ 
req
ÄÄ 
.
ÄÄ 
setData
ÄÄ #
(
ÄÄ# $
F7Zip
ÄÄ$ )
.
ÄÄ) *
compress
ÄÄ* 2
(
ÄÄ2 3
data
ÄÄ3 7
)
ÄÄ7 8
)
ÄÄ8 9
;
ÄÄ9 :
}
ÅÅ 
else
ÆÆ 
{
ÇÇ 
req
ÈÈ 
.
ÈÈ 
setData
ÈÈ #
(
ÈÈ# $
data
ÈÈ$ (
)
ÈÈ( )
;
ÈÈ) *
}
ÉÉ 
}
ÊÊ 
	m_session
ÎÎ 
.
ÎÎ #
sendGuaranteedUnicast
ÎÎ /
(
ÎÎ/ 0
channel
ÎÎ0 7
,
ÎÎ7 8
req
ÎÎ9 <
)
ÎÎ< =
;
ÎÎ= >
}
ÏÏ 
catch
ĞĞ 
(
ĞĞ 
	Exception
ĞĞ 
ex
ĞĞ 
)
ĞĞ  
{
ÑÑ 
FDebug
ÒÒ 
.
ÒÒ 
throwException
ÒÒ %
(
ÒÒ% &
ex
ÒÒ& (
)
ÒÒ( )
;
ÒÒ) *
}
ÓÓ 
finally
ÔÔ 
{
ÕÕ 
req
ÖÖ 
=
ÖÖ 
null
ÖÖ 
;
ÖÖ 
}
×× 
}
ØØ 	
public
ÜÜ 
void
ÜÜ #
sendGuaranteedUnicast
ÜÜ )
(
ÜÜ) *
string
İİ 
module
İİ 
,
İİ 
string
ŞŞ 
	operation
ŞŞ 
,
ŞŞ 
FXmlNode
ßß 
property
ßß 
,
ßß 
string
àà 
data
àà 
,
àà 
string
áá 
channel
áá 
,
áá 
int
ââ 
guaranteedTtl
ââ 
,
ââ 
UInt32
ãã 
tid
ãã 
)
ää 
{
åå 	
Message
ææ 
req
ææ 
=
ææ 
null
ææ 
;
ææ 
StreamTransformer
çç 
former
çç $
=
çç% &
null
çç' +
;
çç+ ,
try
éé 
{
êê 
req
ëë 
=
ëë 
	m_session
ëë 
.
ëë  
createMessage
ëë  -
(
ëë- .
)
ëë. /
;
ëë/ 0
req
ìì 
=
ìì 
setProperties
ìì #
(
ìì# $
req
ìì$ '
,
ìì' (
$str
ìì) +
,
ìì+ ,
module
ìì- 3
,
ìì3 4
	operation
ìì5 >
,
ìì> ?
property
ìì@ H
,
ììH I
tid
ììJ M
)
ììM N
;
ììN O
req
ğğ 
.
ğğ 
setDeliveryMode
ğğ #
(
ğğ# $
DeliveryType
ğğ$ 0
.
ğğ0 1 
GUARANTEED_UNICAST
ğğ1 C
)
ğğC D
;
ğğD E
req
ññ 
.
ññ 

setChannel
ññ 
(
ññ 
channel
ññ &
)
ññ& '
;
ññ' (
req
òò 
.
òò 
setTTL
òò 
(
òò 
$num
òò 
<
òò 
guaranteedTtl
òò ,
?
òò- .
guaranteedTtl
òò/ <
:
òò= >
m_guaranteedTtl
òò? N
)
òòN O
;
òòO P
if
öö 
(
öö 
m_isTrs
öö 
)
öö 
{
÷÷ 
former
øø 
=
øø 
new
øø  #
StreamTransformerImpl
øø! 6
(
øø6 7
)
øø7 8
;
øø8 9
former
ùù 
.
ùù 
writeMsgString
ùù )
(
ùù) *
data
ùù* .
)
ùù. /
;
ùù/ 0
req
úú 
.
úú 
setData
úú 
(
úú  
former
úú  &
.
úú& '
getBytes
úú' /
(
úú/ 0
)
úú0 1
)
úú1 2
;
úú2 3
}
ûû 
else
üü 
{
ıı 
if
şş 
(
şş 
m_isCompressed
şş &
)
şş& '
{
ÿÿ 
req
€	€	 
.
€	€	 
setData
€	€	 #
(
€	€	# $
F7Zip
€	€	$ )
.
€	€	) *
compress
€	€	* 2
(
€	€	2 3
data
€	€	3 7
)
€	€	7 8
)
€	€	8 9
;
€	€	9 :
}
		 
else
‚	‚	 
{
ƒ	ƒ	 
req
„	„	 
.
„	„	 
setData
„	„	 #
(
„	„	# $
data
„	„	$ (
)
„	„	( )
;
„	„	) *
}
…	…	 
}
†	†	 
	m_session
Š	Š	 
.
Š	Š	 #
sendGuaranteedUnicast
Š	Š	 /
(
Š	Š	/ 0
channel
Š	Š	0 7
,
Š	Š	7 8
req
Š	Š	9 <
)
Š	Š	< =
;
Š	Š	= >
}
‹	‹	 
catch
Œ	Œ	 
(
Œ	Œ	 
	Exception
Œ	Œ	 
ex
Œ	Œ	 
)
Œ	Œ	  
{
		 
FDebug
		 
.
		 
throwException
		 %
(
		% &
ex
		& (
)
		( )
;
		) *
}
		 
finally
		 
{
‘	‘	 
req
’	’	 
=
’	’	 
null
’	’	 
;
’	’	 
}
“	“	 
}
”	”	 	
public
˜	˜	 
void
˜	˜	 #
sendGuaranteedUnicast
˜	˜	 )
(
˜	˜	) *
string
™	™	 
serviceName
™	™	 
,
™	™	 
string
š	š	 
module
š	š	 
,
š	š	 
string
›	›	 
	operation
›	›	 
,
›	›	 
FXmlNode
œ	œ	 
data
œ	œ	 
,
œ	œ	 
string
		 
channel
		 
,
		 
int
		 
guaranteedTtl
		 
,
		 
UInt32
Ÿ	Ÿ	 
tid
Ÿ	Ÿ	 
)
 	 	 
{
¡	¡	 	
Message
¢	¢	 
req
¢	¢	 
=
¢	¢	 
null
¢	¢	 
;
¢	¢	 
StreamTransformer
£	£	 
former
£	£	 $
=
£	£	% &
null
£	£	' +
;
£	£	+ ,
try
¥	¥	 
{
¦	¦	 
req
§	§	 
=
§	§	 
	m_session
§	§	 
.
§	§	  
createMessage
§	§	  -
(
§	§	- .
)
§	§	. /
;
§	§	/ 0
req
¨	¨	 
=
¨	¨	 
setProperties
¨	¨	 #
(
¨	¨	# $
req
¨	¨	$ '
,
¨	¨	' (
serviceName
¨	¨	) 4
,
¨	¨	4 5
module
¨	¨	6 <
,
¨	¨	< =
	operation
¨	¨	> G
,
¨	¨	G H
null
¨	¨	I M
,
¨	¨	M N
tid
¨	¨	O R
)
¨	¨	R S
;
¨	¨	S T
req
¬	¬	 
.
¬	¬	 
setDeliveryMode
¬	¬	 #
(
¬	¬	# $
DeliveryType
¬	¬	$ 0
.
¬	¬	0 1 
GUARANTEED_UNICAST
¬	¬	1 C
)
¬	¬	C D
;
¬	¬	D E
req
­	­	 
.
­	­	 

setChannel
­	­	 
(
­	­	 
channel
­	­	 &
)
­	­	& '
;
­	­	' (
req
®	®	 
.
®	®	 
setTTL
®	®	 
(
®	®	 
$num
®	®	 
<
®	®	 
guaranteedTtl
®	®	 ,
?
®	®	- .
guaranteedTtl
®	®	/ <
:
®	®	= >
m_guaranteedTtl
®	®	? N
)
®	®	N O
;
®	®	O P
if
²	²	 
(
²	²	 
m_isTrs
²	²	 
)
²	²	 
{
³	³	 
former
´	´	 
=
´	´	 
new
´	´	  #
StreamTransformerImpl
´	´	! 6
(
´	´	6 7
)
´	´	7 8
;
´	´	8 9
former
µ	µ	 
.
µ	µ	 
writeMsgString
µ	µ	 )
(
µ	µ	) *
data
µ	µ	* .
.
µ	µ	. /
outerXml
µ	µ	/ 7
)
µ	µ	7 8
;
µ	µ	8 9
req
¶	¶	 
.
¶	¶	 
setData
¶	¶	 
(
¶	¶	  
former
¶	¶	  &
.
¶	¶	& '
getBytes
¶	¶	' /
(
¶	¶	/ 0
)
¶	¶	0 1
)
¶	¶	1 2
;
¶	¶	2 3
}
·	·	 
else
¸	¸	 
{
¹	¹	 
if
º	º	 
(
º	º	 
m_isCompressed
º	º	 &
)
º	º	& '
{
»	»	 
req
¼	¼	 
.
¼	¼	 
setData
¼	¼	 #
(
¼	¼	# $
F7Zip
¼	¼	$ )
.
¼	¼	) *
compress
¼	¼	* 2
(
¼	¼	2 3
data
¼	¼	3 7
.
¼	¼	7 8
outerXml
¼	¼	8 @
)
¼	¼	@ A
)
¼	¼	A B
;
¼	¼	B C
}
½	½	 
else
¾	¾	 
{
¿	¿	 
req
À	À	 
.
À	À	 
setData
À	À	 #
(
À	À	# $
data
À	À	$ (
.
À	À	( )
outerXml
À	À	) 1
)
À	À	1 2
;
À	À	2 3
}
Á	Á	 
}
Â	Â	 
	m_session
Æ	Æ	 
.
Æ	Æ	 #
sendGuaranteedUnicast
Æ	Æ	 /
(
Æ	Æ	/ 0
channel
Æ	Æ	0 7
,
Æ	Æ	7 8
req
Æ	Æ	9 <
)
Æ	Æ	< =
;
Æ	Æ	= >
}
Ç	Ç	 
catch
È	È	 
(
È	È	 
	Exception
È	È	 
ex
È	È	 
)
È	È	  
{
É	É	 
FDebug
Ê	Ê	 
.
Ê	Ê	 
throwException
Ê	Ê	 %
(
Ê	Ê	% &
ex
Ê	Ê	& (
)
Ê	Ê	( )
;
Ê	Ê	) *
}
Ë	Ë	 
finally
Ì	Ì	 
{
Í	Í	 
req
Î	Î	 
=
Î	Î	 
null
Î	Î	 
;
Î	Î	 
}
Ï	Ï	 
}
Ğ	Ğ	 	
public
Ô	Ô	 
void
Ô	Ô	 #
sendGuaranteedUnicast
Ô	Ô	 )
(
Ô	Ô	) *
string
Õ	Õ	 
serviceName
Õ	Õ	 
,
Õ	Õ	 
string
Ö	Ö	 
module
Ö	Ö	 
,
Ö	Ö	 
string
×	×	 
	operation
×	×	 
,
×	×	 
FXmlNode
Ø	Ø	 
data
Ø	Ø	 
,
Ø	Ø	 
string
Ù	Ù	 
channel
Ù	Ù	 
,
Ù	Ù	 
int
Ú	Ú	 
guaranteedTtl
Ú	Ú	 
)
Û	Û	 
{
Ü	Ü	 	
try
İ	İ	 
{
Ş	Ş	 #
sendGuaranteedUnicast
ß	ß	 %
(
ß	ß	% &
serviceName
ß	ß	& 1
,
ß	ß	1 2
module
ß	ß	3 9
,
ß	ß	9 :
	operation
ß	ß	; D
,
ß	ß	D E
data
ß	ß	F J
,
ß	ß	J K
channel
ß	ß	L S
,
ß	ß	S T
guaranteedTtl
ß	ß	U b
,
ß	ß	b c
this
ß	ß	d h
.
ß	ß	h i
fTidPointer
ß	ß	i t
.
ß	ß	t u
uniqueId
ß	ß	u }
)
ß	ß	} ~
;
ß	ß	~ 
}
à	à	 
catch
á	á	 
(
á	á	 
	Exception
á	á	 
ex
á	á	 
)
á	á	  
{
â	â	 
FDebug
ã	ã	 
.
ã	ã	 
throwException
ã	ã	 %
(
ã	ã	% &
ex
ã	ã	& (
)
ã	ã	( )
;
ã	ã	) *
}
ä	ä	 
finally
å	å	 
{
æ	æ	 
}
è	è	 
}
é	é	 	
public
í	í	 
void
í	í	 #
sendGuaranteedUnicast
í	í	 )
(
í	í	) *
string
î	î	 
module
î	î	 
,
î	î	 
string
ï	ï	 
	operation
ï	ï	 
,
ï	ï	 
FXmlNode
ğ	ğ	 
data
ğ	ğ	 
,
ğ	ğ	 
string
ñ	ñ	 
channel
ñ	ñ	 
,
ñ	ñ	 
int
ò	ò	 
guaranteedTtl
ò	ò	 
,
ò	ò	 
UInt32
ó	ó	 
tid
ó	ó	 
)
ô	ô	 
{
õ	õ	 	
try
ö	ö	 
{
÷	÷	 #
sendGuaranteedUnicast
ø	ø	 %
(
ø	ø	% &
string
ø	ø	& ,
.
ø	ø	, -
Empty
ø	ø	- 2
,
ø	ø	2 3
module
ø	ø	4 :
,
ø	ø	: ;
	operation
ø	ø	< E
,
ø	ø	E F
data
ø	ø	G K
,
ø	ø	K L
channel
ø	ø	M T
,
ø	ø	T U
guaranteedTtl
ø	ø	V c
,
ø	ø	c d
tid
ø	ø	e h
)
ø	ø	h i
;
ø	ø	i j
}
ù	ù	 
catch
ú	ú	 
(
ú	ú	 
	Exception
ú	ú	 
ex
ú	ú	 
)
ú	ú	  
{
û	û	 
FDebug
ü	ü	 
.
ü	ü	 
throwException
ü	ü	 %
(
ü	ü	% &
ex
ü	ü	& (
)
ü	ü	( )
;
ü	ü	) *
}
ı	ı	 
finally
ş	ş	 
{
ÿ	ÿ	 
}


 
}
‚
‚
 	
public
†
†
 
void
†
†
 #
sendGuaranteedUnicast
†
†
 )
(
†
†
) *
string
‡
‡
 
module
‡
‡
 
,
‡
‡
 
string
ˆ
ˆ
 
	operation
ˆ
ˆ
 
,
ˆ
ˆ
 
FXmlNode
‰
‰
 
data
‰
‰
 
,
‰
‰
 
string
Š
Š
 
channel
Š
Š
 
,
Š
Š
 
int
‹
‹
 
guaranteedTtl
‹
‹
 
)
Œ
Œ
 
{


 	
try


 
{


 #
sendGuaranteedUnicast


 %
(


% &
string


& ,
.


, -
Empty


- 2
,


2 3
module


4 :
,


: ;
	operation


< E
,


E F
data


G K
,


K L
channel


M T
,


T U
guaranteedTtl


V c
,


c d
this


e i
.


i j
fTidPointer


j u
.


u v
uniqueId


v ~
)


~ 
;

 €
}
‘
‘
 
catch
’
’
 
(
’
’
 
	Exception
’
’
 
ex
’
’
 
)
’
’
  
{
“
“
 
FDebug
”
”
 
.
”
”
 
throwException
”
”
 %
(
”
”
% &
ex
”
”
& (
)
”
”
( )
;
”
”
) *
}
•
•
 
finally
–
–
 
{
—
—
 
}
™
™
 
}
š
š
 	
public


 
void


 
sendMulticast


 !
(


! "
string
Ÿ
Ÿ
 
serviceName
Ÿ
Ÿ
 
,
Ÿ
Ÿ
 
string
 
 
 
module
 
 
 
,
 
 
 
string
¡
¡
 
	operation
¡
¡
 
,
¡
¡
 
string
¢
¢
 
data
¢
¢
 
,
¢
¢
 
string
£
£
 
channel
£
£
 
,
£
£
 
int
¤
¤
 
ttl
¤
¤
 
,
¤
¤
 
UInt32
¥
¥
 
tid
¥
¥
 
)
¦
¦
 
{
§
§
 	
Message
¨
¨
 
req
¨
¨
 
=
¨
¨
 
null
¨
¨
 
;
¨
¨
 
StreamTransformer
©
©
 
former
©
©
 $
=
©
©
% &
null
©
©
' +
;
©
©
+ ,
try
«
«
 
{
¬
¬
 
req
­
­
 
=
­
­
 
	m_session
­
­
 
.
­
­
  
createMessage
­
­
  -
(
­
­
- .
)
­
­
. /
;
­
­
/ 0
req
®
®
 
=
®
®
 
setProperties
®
®
 #
(
®
®
# $
req
®
®
$ '
,
®
®
' (
serviceName
®
®
) 4
,
®
®
4 5
module
®
®
6 <
,
®
®
< =
	operation
®
®
> G
,
®
®
G H
null
®
®
I M
,
®
®
M N
tid
®
®
O R
)
®
®
R S
;
®
®
S T
req
²
²
 
.
²
²
 
setDeliveryMode
²
²
 #
(
²
²
# $
DeliveryType
²
²
$ 0
.
²
²
0 1
	MULTICAST
²
²
1 :
)
²
²
: ;
;
²
²
; <
req
³
³
 
.
³
³
 

setChannel
³
³
 
(
³
³
 
channel
³
³
 &
)
³
³
& '
;
³
³
' (
req
´
´
 
.
´
´
 
setTTL
´
´
 
(
´
´
 
$num
´
´
 
<
´
´
 
ttl
´
´
 "
?
´
´
# $
ttl
´
´
% (
:
´
´
) *
m_ttl
´
´
+ 0
)
´
´
0 1
;
´
´
1 2
if
¸
¸
 
(
¸
¸
 
m_isTrs
¸
¸
 
)
¸
¸
 
{
¹
¹
 
former
º
º
 
=
º
º
 
new
º
º
  #
StreamTransformerImpl
º
º
! 6
(
º
º
6 7
)
º
º
7 8
;
º
º
8 9
former
»
»
 
.
»
»
 
writeMsgString
»
»
 )
(
»
»
) *
data
»
»
* .
)
»
»
. /
;
»
»
/ 0
req
¼
¼
 
.
¼
¼
 
setData
¼
¼
 
(
¼
¼
  
former
¼
¼
  &
.
¼
¼
& '
getBytes
¼
¼
' /
(
¼
¼
/ 0
)
¼
¼
0 1
)
¼
¼
1 2
;
¼
¼
2 3
}
½
½
 
else
¾
¾
 
{
¿
¿
 
if
À
À
 
(
À
À
 
m_isCompressed
À
À
 &
)
À
À
& '
{
Á
Á
 
req
Â
Â
 
.
Â
Â
 
setData
Â
Â
 #
(
Â
Â
# $
F7Zip
Â
Â
$ )
.
Â
Â
) *
compress
Â
Â
* 2
(
Â
Â
2 3
data
Â
Â
3 7
)
Â
Â
7 8
)
Â
Â
8 9
;
Â
Â
9 :
}
Ã
Ã
 
else
Ä
Ä
 
{
Å
Å
 
req
Æ
Æ
 
.
Æ
Æ
 
setData
Æ
Æ
 #
(
Æ
Æ
# $
data
Æ
Æ
$ (
)
Æ
Æ
( )
;
Æ
Æ
) *
}
Ç
Ç
 
}
È
È
 
	m_session
Ì
Ì
 
.
Ì
Ì
 
sendMulticast
Ì
Ì
 '
(
Ì
Ì
' (
req
Ì
Ì
( +
)
Ì
Ì
+ ,
;
Ì
Ì
, -
}
Í
Í
 
catch
Î
Î
 
(
Î
Î
 
	Exception
Î
Î
 
ex
Î
Î
 
)
Î
Î
  
{
Ï
Ï
 
FDebug
Ğ
Ğ
 
.
Ğ
Ğ
 
throwException
Ğ
Ğ
 %
(
Ğ
Ğ
% &
ex
Ğ
Ğ
& (
)
Ğ
Ğ
( )
;
Ğ
Ğ
) *
}
Ñ
Ñ
 
finally
Ò
Ò
 
{
Ó
Ó
 
req
Ô
Ô
 
=
Ô
Ô
 
null
Ô
Ô
 
;
Ô
Ô
 
}
Õ
Õ
 
}
Ö
Ö
 	
public
Ú
Ú
 
void
Ú
Ú
 
sendMulticast
Ú
Ú
 !
(
Ú
Ú
! "
string
Û
Û
 
serviceName
Û
Û
 
,
Û
Û
 
string
Ü
Ü
 
module
Ü
Ü
 
,
Ü
Ü
 
string
İ
İ
 
	operation
İ
İ
 
,
İ
İ
 
FXmlNode
Ş
Ş
 
property
Ş
Ş
 
,
Ş
Ş
 
string
ß
ß
 
data
ß
ß
 
,
ß
ß
 
string
à
à
 
channel
à
à
 
,
à
à
 
int
á
á
 
ttl
á
á
 
,
á
á
 
UInt32
â
â
 
tid
â
â
 
)
ã
ã
 
{
ä
ä
 	
Message
å
å
 
req
å
å
 
=
å
å
 
null
å
å
 
;
å
å
 
StreamTransformer
æ
æ
 
former
æ
æ
 $
=
æ
æ
% &
null
æ
æ
' +
;
æ
æ
+ ,
try
è
è
 
{
é
é
 
req
ê
ê
 
=
ê
ê
 
	m_session
ê
ê
 
.
ê
ê
  
createMessage
ê
ê
  -
(
ê
ê
- .
)
ê
ê
. /
;
ê
ê
/ 0
req
ë
ë
 
=
ë
ë
 
setProperties
ë
ë
 #
(
ë
ë
# $
req
ë
ë
$ '
,
ë
ë
' (
serviceName
ë
ë
) 4
,
ë
ë
4 5
module
ë
ë
6 <
,
ë
ë
< =
	operation
ë
ë
> G
,
ë
ë
G H
property
ë
ë
I Q
,
ë
ë
Q R
tid
ë
ë
S V
)
ë
ë
V W
;
ë
ë
W X
req
ï
ï
 
.
ï
ï
 
setDeliveryMode
ï
ï
 #
(
ï
ï
# $
DeliveryType
ï
ï
$ 0
.
ï
ï
0 1
	MULTICAST
ï
ï
1 :
)
ï
ï
: ;
;
ï
ï
; <
req
ğ
ğ
 
.
ğ
ğ
 

setChannel
ğ
ğ
 
(
ğ
ğ
 
channel
ğ
ğ
 &
)
ğ
ğ
& '
;
ğ
ğ
' (
req
ñ
ñ
 
.
ñ
ñ
 
setTTL
ñ
ñ
 
(
ñ
ñ
 
$num
ñ
ñ
 
<
ñ
ñ
 
ttl
ñ
ñ
 "
?
ñ
ñ
# $
ttl
ñ
ñ
% (
:
ñ
ñ
) *
m_ttl
ñ
ñ
+ 0
)
ñ
ñ
0 1
;
ñ
ñ
1 2
if
õ
õ
 
(
õ
õ
 
m_isTrs
õ
õ
 
)
õ
õ
 
{
ö
ö
 
former
÷
÷
 
=
÷
÷
 
new
÷
÷
  #
StreamTransformerImpl
÷
÷
! 6
(
÷
÷
6 7
)
÷
÷
7 8
;
÷
÷
8 9
former
ø
ø
 
.
ø
ø
 
writeMsgString
ø
ø
 )
(
ø
ø
) *
data
ø
ø
* .
)
ø
ø
. /
;
ø
ø
/ 0
req
ù
ù
 
.
ù
ù
 
setData
ù
ù
 
(
ù
ù
  
former
ù
ù
  &
.
ù
ù
& '
getBytes
ù
ù
' /
(
ù
ù
/ 0
)
ù
ù
0 1
)
ù
ù
1 2
;
ù
ù
2 3
}
ú
ú
 
else
û
û
 
{
ü
ü
 
if
ı
ı
 
(
ı
ı
 
m_isCompressed
ı
ı
 &
)
ı
ı
& '
{
ş
ş
 
req
ÿ
ÿ
 
.
ÿ
ÿ
 
setData
ÿ
ÿ
 #
(
ÿ
ÿ
# $
F7Zip
ÿ
ÿ
$ )
.
ÿ
ÿ
) *
compress
ÿ
ÿ
* 2
(
ÿ
ÿ
2 3
data
ÿ
ÿ
3 7
)
ÿ
ÿ
7 8
)
ÿ
ÿ
8 9
;
ÿ
ÿ
9 :
}
€€ 
else
 
{
‚‚ 
req
ƒƒ 
.
ƒƒ 
setData
ƒƒ #
(
ƒƒ# $
data
ƒƒ$ (
)
ƒƒ( )
;
ƒƒ) *
}
„„ 
}
…… 
	m_session
‰‰ 
.
‰‰ 
sendMulticast
‰‰ '
(
‰‰' (
req
‰‰( +
)
‰‰+ ,
;
‰‰, -
}
ŠŠ 
catch
‹‹ 
(
‹‹ 
	Exception
‹‹ 
ex
‹‹ 
)
‹‹  
{
ŒŒ 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
 
{
 
req
‘‘ 
=
‘‘ 
null
‘‘ 
;
‘‘ 
}
’’ 
}
““ 	
public
—— 
void
—— 
sendMulticast
—— !
(
——! "
string
˜˜ 
module
˜˜ 
,
˜˜ 
string
™™ 
	operation
™™ 
,
™™ 
string
šš 
data
šš 
,
šš 
string
›› 
channel
›› 
,
›› 
int
œœ 
ttl
œœ 
,
œœ 
UInt32
 
tid
 
)
 
{
ŸŸ 	
try
   
{
¡¡ 
sendMulticast
¢¢ 
(
¢¢ 
string
¢¢ $
.
¢¢$ %
Empty
¢¢% *
,
¢¢* +
module
¢¢, 2
,
¢¢2 3
	operation
¢¢4 =
,
¢¢= >
data
¢¢? C
,
¢¢C D
channel
¢¢E L
,
¢¢L M
ttl
¢¢N Q
,
¢¢Q R
tid
¢¢S V
)
¢¢V W
;
¢¢W X
}
££ 
catch
¤¤ 
(
¤¤ 
	Exception
¤¤ 
ex
¤¤ 
)
¤¤  
{
¥¥ 
FDebug
¦¦ 
.
¦¦ 
throwException
¦¦ %
(
¦¦% &
ex
¦¦& (
)
¦¦( )
;
¦¦) *
}
§§ 
finally
¨¨ 
{
©© 
}
«« 
}
¬¬ 	
public
°° 
void
°° 
sendMulticast
°° !
(
°°! "
string
±± 
module
±± 
,
±± 
string
²² 
	operation
²² 
,
²² 
FXmlNode
³³ 
property
³³ 
,
³³ 
string
´´ 
data
´´ 
,
´´ 
string
µµ 
channel
µµ 
,
µµ 
int
¶¶ 
ttl
¶¶ 
,
¶¶ 
UInt32
·· 
tid
·· 
)
¸¸ 
{
¹¹ 	
try
ºº 
{
»» 
sendMulticast
¼¼ 
(
¼¼ 
string
¼¼ $
.
¼¼$ %
Empty
¼¼% *
,
¼¼* +
module
¼¼, 2
,
¼¼2 3
	operation
¼¼4 =
,
¼¼= >
property
¼¼? G
,
¼¼G H
data
¼¼I M
,
¼¼M N
channel
¼¼O V
,
¼¼V W
ttl
¼¼X [
,
¼¼[ \
tid
¼¼] `
)
¼¼` a
;
¼¼a b
}
½½ 
catch
¾¾ 
(
¾¾ 
	Exception
¾¾ 
ex
¾¾ 
)
¾¾  
{
¿¿ 
FDebug
ÀÀ 
.
ÀÀ 
throwException
ÀÀ %
(
ÀÀ% &
ex
ÀÀ& (
)
ÀÀ( )
;
ÀÀ) *
}
ÁÁ 
finally
ÂÂ 
{
ÃÃ 
}
ÅÅ 
}
ÆÆ 	
public
ÊÊ 
void
ÊÊ 
sendMulticast
ÊÊ !
(
ÊÊ! "
string
ËË 
serviceName
ËË 
,
ËË 
string
ÌÌ 
module
ÌÌ 
,
ÌÌ 
string
ÍÍ 
	operation
ÍÍ 
,
ÍÍ 
FXmlNode
ÎÎ 
data
ÎÎ 
,
ÎÎ 
string
ÏÏ 
channel
ÏÏ 
,
ÏÏ 
int
ĞĞ 
ttl
ĞĞ 
,
ĞĞ 
UInt32
ÑÑ 
tid
ÑÑ 
)
ÒÒ 
{
ÓÓ 	
try
ÔÔ 
{
ÕÕ 
sendMulticast
ÖÖ 
(
ÖÖ 
serviceName
ÖÖ )
,
ÖÖ) *
module
ÖÖ+ 1
,
ÖÖ1 2
	operation
ÖÖ3 <
,
ÖÖ< =
data
ÖÖ> B
.
ÖÖB C
outerXml
ÖÖC K
,
ÖÖK L
channel
ÖÖM T
,
ÖÖT U
ttl
ÖÖV Y
,
ÖÖY Z
tid
ÖÖ[ ^
)
ÖÖ^ _
;
ÖÖ_ `
}
×× 
catch
ØØ 
(
ØØ 
	Exception
ØØ 
ex
ØØ 
)
ØØ  
{
ÙÙ 
FDebug
ÚÚ 
.
ÚÚ 
throwException
ÚÚ %
(
ÚÚ% &
ex
ÚÚ& (
)
ÚÚ( )
;
ÚÚ) *
}
ÛÛ 
finally
ÜÜ 
{
İİ 
}
ßß 
}
àà 	
public
ää 
void
ää 
sendMulticast
ää !
(
ää! "
string
åå 
serviceName
åå 
,
åå 
string
ææ 
module
ææ 
,
ææ 
string
çç 
	operation
çç 
,
çç 
FXmlNode
èè 
data
èè 
,
èè 
string
éé 
channel
éé 
,
éé 
int
êê 
ttl
êê 
)
ëë 
{
ìì 	
try
íí 
{
îî 
sendMulticast
ïï 
(
ïï 
serviceName
ïï )
,
ïï) *
module
ïï+ 1
,
ïï1 2
	operation
ïï3 <
,
ïï< =
data
ïï> B
,
ïïB C
channel
ïïD K
,
ïïK L
ttl
ïïM P
,
ïïP Q
this
ïïR V
.
ïïV W
fTidPointer
ïïW b
.
ïïb c
uniqueId
ïïc k
)
ïïk l
;
ïïl m
}
ğğ 
catch
ññ 
(
ññ 
	Exception
ññ 
ex
ññ 
)
ññ  
{
òò 
FDebug
óó 
.
óó 
throwException
óó %
(
óó% &
ex
óó& (
)
óó( )
;
óó) *
}
ôô 
finally
õõ 
{
öö 
}
øø 
}
ùù 	
public
ıı 
void
ıı 
sendMulticast
ıı !
(
ıı! "
string
şş 
module
şş 
,
şş 
string
ÿÿ 
	operation
ÿÿ 
,
ÿÿ 
FXmlNode
€€ 
data
€€ 
,
€€ 
string
 
channel
 
,
 
int
‚‚ 
ttl
‚‚ 
,
‚‚ 
UInt32
ƒƒ 
tid
ƒƒ 
)
„„ 
{
…… 	
try
†† 
{
‡‡ 
sendMulticast
ˆˆ 
(
ˆˆ 
string
ˆˆ $
.
ˆˆ$ %
Empty
ˆˆ% *
,
ˆˆ* +
module
ˆˆ, 2
,
ˆˆ2 3
	operation
ˆˆ4 =
,
ˆˆ= >
data
ˆˆ? C
,
ˆˆC D
channel
ˆˆE L
,
ˆˆL M
ttl
ˆˆN Q
,
ˆˆQ R
tid
ˆˆS V
)
ˆˆV W
;
ˆˆW X
}
‰‰ 
catch
ŠŠ 
(
ŠŠ 
	Exception
ŠŠ 
ex
ŠŠ 
)
ŠŠ  
{
‹‹ 
FDebug
ŒŒ 
.
ŒŒ 
throwException
ŒŒ %
(
ŒŒ% &
ex
ŒŒ& (
)
ŒŒ( )
;
ŒŒ) *
}
 
finally
 
{
 
}
‘‘ 
}
’’ 	
public
–– 
void
–– 
sendMulticast
–– !
(
––! "
string
—— 
module
—— 
,
—— 
string
˜˜ 
	operation
˜˜ 
,
˜˜ 
FXmlNode
™™ 
data
™™ 
,
™™ 
string
šš 
channel
šš 
,
šš 
int
›› 
ttl
›› 
)
œœ 
{
 	
try
 
{
ŸŸ 
sendMulticast
   
(
   
string
   $
.
  $ %
Empty
  % *
,
  * +
module
  , 2
,
  2 3
	operation
  4 =
,
  = >
data
  ? C
,
  C D
channel
  E L
,
  L M
ttl
  N Q
,
  Q R
this
  S W
.
  W X
fTidPointer
  X c
.
  c d
uniqueId
  d l
)
  l m
;
  m n
}
¡¡ 
catch
¢¢ 
(
¢¢ 
	Exception
¢¢ 
ex
¢¢ 
)
¢¢  
{
££ 
FDebug
¤¤ 
.
¤¤ 
throwException
¤¤ %
(
¤¤% &
ex
¤¤& (
)
¤¤( )
;
¤¤) *
}
¥¥ 
finally
¦¦ 
{
§§ 
}
©© 
}
ªª 	
public
®® 
void
®® %
sendGuaranteedMulticast
®® +
(
®®+ ,
string
¯¯ 
serviceName
¯¯ 
,
¯¯ 
string
°° 
module
°° 
,
°° 
string
±± 
	operation
±± 
,
±± 
string
²² 
data
²² 
,
²² 
string
³³ 
channel
³³ 
,
³³ 
int
´´ 
guaranteedTtl
´´ 
,
´´ 
UInt32
µµ 
tid
µµ 
)
¶¶ 
{
·· 	
Message
¸¸ 
req
¸¸ 
=
¸¸ 
null
¸¸ 
;
¸¸ 
StreamTransformer
¹¹ 
former
¹¹ $
=
¹¹% &
null
¹¹' +
;
¹¹+ ,
try
»» 
{
¼¼ 
req
½½ 
=
½½ 
	m_session
½½ 
.
½½  
createMessage
½½  -
(
½½- .
)
½½. /
;
½½/ 0
req
¾¾ 
=
¾¾ 
setProperties
¾¾ #
(
¾¾# $
req
¾¾$ '
,
¾¾' (
serviceName
¾¾) 4
,
¾¾4 5
module
¾¾6 <
,
¾¾< =
	operation
¾¾> G
,
¾¾G H
null
¾¾I M
,
¾¾M N
tid
¾¾O R
)
¾¾R S
;
¾¾S T
req
ÂÂ 
.
ÂÂ 
setDeliveryMode
ÂÂ #
(
ÂÂ# $
DeliveryType
ÂÂ$ 0
.
ÂÂ0 1"
GUARANTEED_MULTICAST
ÂÂ1 E
)
ÂÂE F
;
ÂÂF G
req
ÃÃ 
.
ÃÃ 

setChannel
ÃÃ 
(
ÃÃ 
channel
ÃÃ &
)
ÃÃ& '
;
ÃÃ' (
req
ÄÄ 
.
ÄÄ 
setTTL
ÄÄ 
(
ÄÄ 
$num
ÄÄ 
<
ÄÄ 
guaranteedTtl
ÄÄ ,
?
ÄÄ- .
guaranteedTtl
ÄÄ/ <
:
ÄÄ= >
m_guaranteedTtl
ÄÄ? N
)
ÄÄN O
;
ÄÄO P
if
ÈÈ 
(
ÈÈ 
m_isTrs
ÈÈ 
)
ÈÈ 
{
ÉÉ 
former
ÊÊ 
=
ÊÊ 
new
ÊÊ  #
StreamTransformerImpl
ÊÊ! 6
(
ÊÊ6 7
)
ÊÊ7 8
;
ÊÊ8 9
former
ËË 
.
ËË 
writeMsgString
ËË )
(
ËË) *
data
ËË* .
)
ËË. /
;
ËË/ 0
req
ÌÌ 
.
ÌÌ 
setData
ÌÌ 
(
ÌÌ  
former
ÌÌ  &
.
ÌÌ& '
getBytes
ÌÌ' /
(
ÌÌ/ 0
)
ÌÌ0 1
)
ÌÌ1 2
;
ÌÌ2 3
}
ÍÍ 
else
ÎÎ 
{
ÏÏ 
if
ĞĞ 
(
ĞĞ 
m_isCompressed
ĞĞ &
)
ĞĞ& '
{
ÑÑ 
req
ÒÒ 
.
ÒÒ 
setData
ÒÒ #
(
ÒÒ# $
F7Zip
ÒÒ$ )
.
ÒÒ) *
compress
ÒÒ* 2
(
ÒÒ2 3
data
ÒÒ3 7
)
ÒÒ7 8
)
ÒÒ8 9
;
ÒÒ9 :
}
ÓÓ 
else
ÔÔ 
{
ÕÕ 
req
ÖÖ 
.
ÖÖ 
setData
ÖÖ #
(
ÖÖ# $
data
ÖÖ$ (
)
ÖÖ( )
;
ÖÖ) *
}
×× 
}
ØØ 
	m_session
ÜÜ 
.
ÜÜ %
sendGuaranteedMulticast
ÜÜ 1
(
ÜÜ1 2
channel
ÜÜ2 9
,
ÜÜ9 :
req
ÜÜ; >
)
ÜÜ> ?
;
ÜÜ? @
}
İİ 
catch
ŞŞ 
(
ŞŞ 
	Exception
ŞŞ 
ex
ŞŞ 
)
ŞŞ  
{
ßß 
FDebug
àà 
.
àà 
throwException
àà %
(
àà% &
ex
àà& (
)
àà( )
;
àà) *
}
áá 
finally
ââ 
{
ãã 
req
ää 
=
ää 
null
ää 
;
ää 
}
åå 
}
ææ 	
public
êê 
void
êê %
sendGuaranteedMulticast
êê +
(
êê+ ,
string
ëë 
serviceName
ëë 
,
ëë 
string
ìì 
module
ìì 
,
ìì 
string
íí 
	operation
íí 
,
íí 
FXmlNode
îî 
property
îî 
,
îî 
string
ïï 
data
ïï 
,
ïï 
string
ğğ 
channel
ğğ 
,
ğğ 
int
ññ 
guaranteedTtl
ññ 
,
ññ 
UInt32
òò 
tid
òò 
)
óó 
{
ôô 	
Message
õõ 
req
õõ 
=
õõ 
null
õõ 
;
õõ 
StreamTransformer
öö 
former
öö $
=
öö% &
null
öö' +
;
öö+ ,
try
øø 
{
ùù 
req
úú 
=
úú 
	m_session
úú 
.
úú  
createMessage
úú  -
(
úú- .
)
úú. /
;
úú/ 0
req
ûû 
=
ûû 
setProperties
ûû #
(
ûû# $
req
ûû$ '
,
ûû' (
serviceName
ûû) 4
,
ûû4 5
module
ûû6 <
,
ûû< =
	operation
ûû> G
,
ûûG H
property
ûûI Q
,
ûûQ R
tid
ûûS V
)
ûûV W
;
ûûW X
req
ÿÿ 
.
ÿÿ 
setDeliveryMode
ÿÿ #
(
ÿÿ# $
DeliveryType
ÿÿ$ 0
.
ÿÿ0 1"
GUARANTEED_MULTICAST
ÿÿ1 E
)
ÿÿE F
;
ÿÿF G
req
€€ 
.
€€ 

setChannel
€€ 
(
€€ 
channel
€€ &
)
€€& '
;
€€' (
req
 
.
 
setTTL
 
(
 
$num
 
<
 
guaranteedTtl
 ,
?
- .
guaranteedTtl
/ <
:
= >
m_guaranteedTtl
? N
)
N O
;
O P
if
…… 
(
…… 
m_isTrs
…… 
)
…… 
{
†† 
former
‡‡ 
=
‡‡ 
new
‡‡  #
StreamTransformerImpl
‡‡! 6
(
‡‡6 7
)
‡‡7 8
;
‡‡8 9
former
ˆˆ 
.
ˆˆ 
writeMsgString
ˆˆ )
(
ˆˆ) *
data
ˆˆ* .
)
ˆˆ. /
;
ˆˆ/ 0
req
‰‰ 
.
‰‰ 
setData
‰‰ 
(
‰‰  
former
‰‰  &
.
‰‰& '
getBytes
‰‰' /
(
‰‰/ 0
)
‰‰0 1
)
‰‰1 2
;
‰‰2 3
}
ŠŠ 
else
‹‹ 
{
ŒŒ 
if
 
(
 
m_isCompressed
 &
)
& '
{
 
req
 
.
 
setData
 #
(
# $
F7Zip
$ )
.
) *
compress
* 2
(
2 3
data
3 7
)
7 8
)
8 9
;
9 :
}
 
else
‘‘ 
{
’’ 
req
““ 
.
““ 
setData
““ #
(
““# $
data
““$ (
)
““( )
;
““) *
}
”” 
}
•• 
	m_session
™™ 
.
™™ %
sendGuaranteedMulticast
™™ 1
(
™™1 2
channel
™™2 9
,
™™9 :
req
™™; >
)
™™> ?
;
™™? @
}
šš 
catch
›› 
(
›› 
	Exception
›› 
ex
›› 
)
››  
{
œœ 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
ŸŸ 
{
   
req
¡¡ 
=
¡¡ 
null
¡¡ 
;
¡¡ 
}
¢¢ 
}
££ 	
public
§§ 
void
§§ %
sendGuaranteedMulticast
§§ +
(
§§+ ,
string
¨¨ 
module
¨¨ 
,
¨¨ 
string
©© 
	operation
©© 
,
©© 
string
ªª 
data
ªª 
,
ªª 
string
«« 
channel
«« 
,
«« 
int
¬¬ 
guaranteedTtl
¬¬ 
,
¬¬ 
UInt32
­­ 
tid
­­ 
)
®® 
{
¯¯ 	
try
°° 
{
±± %
sendGuaranteedMulticast
²² '
(
²²' (
string
²²( .
.
²². /
Empty
²²/ 4
,
²²4 5
module
²²6 <
,
²²< =
	operation
²²> G
,
²²G H
data
²²I M
,
²²M N
channel
²²O V
,
²²V W
guaranteedTtl
²²X e
,
²²e f
tid
²²g j
)
²²j k
;
²²k l
}
³³ 
catch
´´ 
(
´´ 
	Exception
´´ 
ex
´´ 
)
´´  
{
µµ 
FDebug
¶¶ 
.
¶¶ 
throwException
¶¶ %
(
¶¶% &
ex
¶¶& (
)
¶¶( )
;
¶¶) *
}
·· 
finally
¸¸ 
{
¹¹ 
}
»» 
}
¼¼ 	
public
ÀÀ 
void
ÀÀ %
sendGuaranteedMulticast
ÀÀ +
(
ÀÀ+ ,
string
ÁÁ 
module
ÁÁ 
,
ÁÁ 
string
ÂÂ 
	operation
ÂÂ 
,
ÂÂ 
FXmlNode
ÃÃ 
property
ÃÃ 
,
ÃÃ 
string
ÄÄ 
data
ÄÄ 
,
ÄÄ 
string
ÅÅ 
channel
ÅÅ 
,
ÅÅ 
int
ÆÆ 
guaranteedTtl
ÆÆ 
,
ÆÆ 
UInt32
ÇÇ 
tid
ÇÇ 
)
ÈÈ 
{
ÉÉ 	
try
ÊÊ 
{
ËË %
sendGuaranteedMulticast
ÌÌ '
(
ÌÌ' (
string
ÌÌ( .
.
ÌÌ. /
Empty
ÌÌ/ 4
,
ÌÌ4 5
module
ÌÌ6 <
,
ÌÌ< =
	operation
ÌÌ> G
,
ÌÌG H
property
ÌÌI Q
,
ÌÌQ R
data
ÌÌS W
,
ÌÌW X
channel
ÌÌY `
,
ÌÌ` a
guaranteedTtl
ÌÌb o
,
ÌÌo p
tid
ÌÌq t
)
ÌÌt u
;
ÌÌu v
}
ÍÍ 
catch
ÎÎ 
(
ÎÎ 
	Exception
ÎÎ 
ex
ÎÎ 
)
ÎÎ  
{
ÏÏ 
FDebug
ĞĞ 
.
ĞĞ 
throwException
ĞĞ %
(
ĞĞ% &
ex
ĞĞ& (
)
ĞĞ( )
;
ĞĞ) *
}
ÑÑ 
finally
ÒÒ 
{
ÓÓ 
}
ÕÕ 
}
ÖÖ 	
public
ÚÚ 
void
ÚÚ %
sendGuaranteedMulticast
ÚÚ +
(
ÚÚ+ ,
string
ÛÛ 
serviceName
ÛÛ 
,
ÛÛ 
string
ÜÜ 
module
ÜÜ 
,
ÜÜ 
string
İİ 
	operation
İİ 
,
İİ 
FXmlNode
ŞŞ 
data
ŞŞ 
,
ŞŞ 
string
ßß 
channel
ßß 
,
ßß 
int
àà 
guaranteedTtl
àà 
,
àà 
UInt32
áá 
tid
áá 
)
ââ 
{
ãã 	
try
ää 
{
åå %
sendGuaranteedMulticast
ææ '
(
ææ' (
serviceName
ææ( 3
,
ææ3 4
module
ææ5 ;
,
ææ; <
	operation
ææ= F
,
ææF G
data
ææH L
.
ææL M
outerXml
ææM U
,
ææU V
channel
ææW ^
,
ææ^ _
guaranteedTtl
ææ` m
,
ææm n
tid
ææo r
)
æær s
;
ææs t
}
çç 
catch
èè 
(
èè 
	Exception
èè 
ex
èè 
)
èè  
{
éé 
FDebug
êê 
.
êê 
throwException
êê %
(
êê% &
ex
êê& (
)
êê( )
;
êê) *
}
ëë 
finally
ìì 
{
íí 
}
ïï 
}
ğğ 	
public
ôô 
void
ôô %
sendGuaranteedMulticast
ôô +
(
ôô+ ,
string
õõ 
serviceName
õõ 
,
õõ 
string
öö 
module
öö 
,
öö 
string
÷÷ 
	operation
÷÷ 
,
÷÷ 
FXmlNode
øø 
data
øø 
,
øø 
string
ùù 
channel
ùù 
,
ùù 
int
úú 
guaranteedTtl
úú 
)
ûû 
{
üü 	
try
ıı 
{
şş %
sendGuaranteedMulticast
ÿÿ '
(
ÿÿ' (
serviceName
ÿÿ( 3
,
ÿÿ3 4
module
ÿÿ5 ;
,
ÿÿ; <
	operation
ÿÿ= F
,
ÿÿF G
data
ÿÿH L
,
ÿÿL M
channel
ÿÿN U
,
ÿÿU V
guaranteedTtl
ÿÿW d
,
ÿÿd e
this
ÿÿf j
.
ÿÿj k
fTidPointer
ÿÿk v
.
ÿÿv w
uniqueId
ÿÿw 
)ÿÿ €
;ÿÿ€ 
}
€€ 
catch
 
(
 
	Exception
 
ex
 
)
  
{
‚‚ 
FDebug
ƒƒ 
.
ƒƒ 
throwException
ƒƒ %
(
ƒƒ% &
ex
ƒƒ& (
)
ƒƒ( )
;
ƒƒ) *
}
„„ 
finally
…… 
{
†† 
}
ˆˆ 
}
‰‰ 	
public
 
void
 %
sendGuaranteedMulticast
 +
(
+ ,
string
 
module
 
,
 
string
 
	operation
 
,
 
FXmlNode
 
data
 
,
 
string
‘‘ 
channel
‘‘ 
,
‘‘ 
int
’’ 
guaranteedTtl
’’ 
,
’’ 
UInt32
““ 
tid
““ 
)
”” 
{
•• 	
try
–– 
{
—— %
sendGuaranteedMulticast
˜˜ '
(
˜˜' (
string
˜˜( .
.
˜˜. /
Empty
˜˜/ 4
,
˜˜4 5
module
˜˜6 <
,
˜˜< =
	operation
˜˜> G
,
˜˜G H
data
˜˜I M
,
˜˜M N
channel
˜˜O V
,
˜˜V W
guaranteedTtl
˜˜X e
,
˜˜e f
tid
˜˜g j
)
˜˜j k
;
˜˜k l
}
™™ 
catch
šš 
(
šš 
	Exception
šš 
ex
šš 
)
šš  
{
›› 
FDebug
œœ 
.
œœ 
throwException
œœ %
(
œœ% &
ex
œœ& (
)
œœ( )
;
œœ) *
}
 
finally
 
{
ŸŸ 
}
¡¡ 
}
¢¢ 	
public
¦¦ 
void
¦¦ %
sendGuaranteedMulticast
¦¦ +
(
¦¦+ ,
string
§§ 
module
§§ 
,
§§ 
string
¨¨ 
	operation
¨¨ 
,
¨¨ 
FXmlNode
©© 
data
©© 
,
©© 
string
ªª 
channel
ªª 
,
ªª 
int
«« 
guaranteedTtl
«« 
)
¬¬ 
{
­­ 	
try
®® 
{
¯¯ %
sendGuaranteedMulticast
°° '
(
°°' (
string
°°( .
.
°°. /
Empty
°°/ 4
,
°°4 5
module
°°6 <
,
°°< =
	operation
°°> G
,
°°G H
data
°°I M
,
°°M N
channel
°°O V
,
°°V W
guaranteedTtl
°°X e
,
°°e f
this
°°g k
.
°°k l
fTidPointer
°°l w
.
°°w x
uniqueId°°x €
)°°€ 
;°° ‚
}
±± 
catch
²² 
(
²² 
	Exception
²² 
ex
²² 
)
²²  
{
³³ 
FDebug
´´ 
.
´´ 
throwException
´´ %
(
´´% &
ex
´´& (
)
´´( )
;
´´) *
}
µµ 
finally
¶¶ 
{
·· 
}
¹¹ 
}
ºº 	
public
¾¾ 
FXmlNode
¾¾ 
sendRequest
¾¾ #
(
¾¾# $
string
¿¿ 
serviceName
¿¿ 
,
¿¿ 
string
ÀÀ 
module
ÀÀ 
,
ÀÀ 
string
ÁÁ 
	operation
ÁÁ 
,
ÁÁ 
FXmlNode
ÂÂ 
data
ÂÂ 
,
ÂÂ 
string
ÃÃ 
channel
ÃÃ 
,
ÃÃ 
int
ÄÄ 
ttl
ÄÄ 
,
ÄÄ 
bool
ÅÅ 
async
ÅÅ 
,
ÅÅ 
UInt32
ÆÆ 
tid
ÆÆ 
)
ÇÇ 
{
ÈÈ 	
Message
ÉÉ 
req
ÉÉ 
=
ÉÉ 
null
ÉÉ 
;
ÉÉ 
Message
ÊÊ 
rep
ÊÊ 
=
ÊÊ 
null
ÊÊ 
;
ÊÊ 
StreamTransformer
ËË 
former
ËË $
=
ËË% &
null
ËË' +
;
ËË+ ,
try
ÍÍ 
{
ÎÎ 
req
ÏÏ 
=
ÏÏ 
	m_session
ÏÏ 
.
ÏÏ  
createMessage
ÏÏ  -
(
ÏÏ- .
)
ÏÏ. /
;
ÏÏ/ 0
req
ĞĞ 
=
ĞĞ 
setProperties
ĞĞ #
(
ĞĞ# $
req
ĞĞ$ '
,
ĞĞ' (
serviceName
ĞĞ) 4
,
ĞĞ4 5
module
ĞĞ6 <
,
ĞĞ< =
	operation
ĞĞ> G
,
ĞĞG H
null
ĞĞI M
,
ĞĞM N
tid
ĞĞO R
)
ĞĞR S
;
ĞĞS T
req
ÔÔ 
.
ÔÔ 
setDeliveryMode
ÔÔ #
(
ÔÔ# $
DeliveryType
ÔÔ$ 0
.
ÔÔ0 1
REQUEST
ÔÔ1 8
)
ÔÔ8 9
;
ÔÔ9 :
req
ÕÕ 
.
ÕÕ 

setChannel
ÕÕ 
(
ÕÕ 
channel
ÕÕ &
)
ÕÕ& '
;
ÕÕ' (
req
ÖÖ 
.
ÖÖ 
setTTL
ÖÖ 
(
ÖÖ 
$num
ÖÖ 
<
ÖÖ 
ttl
ÖÖ "
?
ÖÖ# $
ttl
ÖÖ% (
:
ÖÖ) *
m_ttl
ÖÖ+ 0
)
ÖÖ0 1
;
ÖÖ1 2
if
ÚÚ 
(
ÚÚ 
m_isTrs
ÚÚ 
)
ÚÚ 
{
ÛÛ 
former
ÜÜ 
=
ÜÜ 
new
ÜÜ  #
StreamTransformerImpl
ÜÜ! 6
(
ÜÜ6 7
)
ÜÜ7 8
;
ÜÜ8 9
former
İİ 
.
İİ 
writeMsgString
İİ )
(
İİ) *
data
İİ* .
.
İİ. /
outerXml
İİ/ 7
)
İİ7 8
;
İİ8 9
req
ŞŞ 
.
ŞŞ 
setData
ŞŞ 
(
ŞŞ  
former
ŞŞ  &
.
ŞŞ& '
getBytes
ŞŞ' /
(
ŞŞ/ 0
)
ŞŞ0 1
)
ŞŞ1 2
;
ŞŞ2 3
}
ßß 
else
àà 
{
áá 
if
ââ 
(
ââ 
m_isCompressed
ââ &
)
ââ& '
{
ãã 
req
ää 
.
ää 
setData
ää #
(
ää# $
F7Zip
ää$ )
.
ää) *
compress
ää* 2
(
ää2 3
data
ää3 7
.
ää7 8
outerXml
ää8 @
)
ää@ A
)
ääA B
;
ääB C
}
åå 
else
ææ 
{
çç 
req
èè 
.
èè 
setData
èè #
(
èè# $
data
èè$ (
.
èè( )
outerXml
èè) 1
)
èè1 2
;
èè2 3
}
éé 
}
êê 
rep
îî 
=
îî 

m_consumer
îî  
.
îî  !
requestReply
îî! -
(
îî- .
req
îî. 1
,
îî1 2
async
îî3 8
)
îî8 9
;
îî9 :
if
ïï 
(
ïï 
rep
ïï 
.
ïï 
getProperty
ïï #
(
ïï# $
FH101
ïï$ )
.
ïï) *"
XGEN_TAG_RESULT_CODE
ïï* >
)
ïï> ?
!=
ïï@ B
null
ïïC G
)
ïïG H
{
ğğ 
FDebug
ññ 
.
ññ 
throwFException
ññ *
(
ññ* +
(
òò 
string
òò 
)
òò  
rep
òò  #
.
òò# $
getProperty
òò$ /
(
òò/ 0
FH101
òò0 5
.
òò5 6!
XGEN_TAG_RESULT_MSG
òò6 I
)
òòI J
+
òòK L
$str
òòM P
+
òòQ R
(
òòS T
string
òòT Z
)
òòZ [
rep
òò[ ^
.
òò^ _
getProperty
òò_ j
(
òòj k
FH101
òòk p
.
òòp q#
XGEN_TAG_RESULT_CODEòòq …
)òò… †
+òò‡ ˆ
$stròò‰ Œ
)
óó 
;
óó 
}
ôô 
if
øø 
(
øø 
m_isTrs
øø 
)
øø 
{
ùù 
former
úú 
=
úú 
new
úú  #
StreamTransformerImpl
úú! 6
(
úú6 7
rep
úú7 :
.
úú: ;
getData
úú; B
(
úúB C
)
úúC D
)
úúD E
;
úúE F
return
ûû 
FDataConvert
ûû '
.
ûû' (
stringToXmlNode
ûû( 7
(
ûû7 8
former
ûû8 >
.
ûû> ?
readMsgString
ûû? L
(
ûûL M
)
ûûM N
)
ûûN O
;
ûûO P
}
üü 
if
şş 
(
şş 
m_isCompressed
şş "
)
şş" #
{
ÿÿ 
return
€€ 
FDataConvert
€€ '
.
€€' (
stringToXmlNode
€€( 7
(
€€7 8
F7Zip
€€8 =
.
€€= >

decompress
€€> H
(
€€H I
rep
€€I L
.
€€L M
getDataAsString
€€M \
(
€€\ ]
)
€€] ^
)
€€^ _
)
€€_ `
;
€€` a
}
 
return
‚‚ 
FDataConvert
‚‚ #
.
‚‚# $
stringToXmlNode
‚‚$ 3
(
‚‚3 4
rep
‚‚4 7
.
‚‚7 8
getDataAsString
‚‚8 G
(
‚‚G H
)
‚‚H I
)
‚‚I J
;
‚‚J K
}
ƒƒ 
catch
„„ 
(
„„ 
	Exception
„„ 
ex
„„ 
)
„„  
{
…… 
FDebug
†† 
.
†† 
throwException
†† %
(
††% &
ex
††& (
)
††( )
;
††) *
}
‡‡ 
finally
ˆˆ 
{
‰‰ 
req
ŠŠ 
=
ŠŠ 
null
ŠŠ 
;
ŠŠ 
rep
‹‹ 
=
‹‹ 
null
‹‹ 
;
‹‹ 
}
ŒŒ 
return
 
null
 
;
 
}
 	
public
’’ 
FXmlNode
’’ 
sendRequest
’’ #
(
’’# $
string
““ 
serviceName
““ 
,
““ 
string
”” 
module
”” 
,
”” 
string
•• 
	operation
•• 
,
•• 
FXmlNode
–– 
data
–– 
,
–– 
string
—— 
channel
—— 
,
—— 
int
˜˜ 
ttl
˜˜ 
,
˜˜ 
bool
™™ 
async
™™ 
)
šš 
{
›› 	
try
œœ 
{
 
return
 
sendRequest
 "
(
" #
serviceName
# .
,
. /
module
0 6
,
6 7
	operation
8 A
,
A B
data
C G
,
G H
channel
I P
,
P Q
ttl
R U
,
U V
async
W \
,
\ ]
this
^ b
.
b c
fTidPointer
c n
.
n o
uniqueId
o w
)
w x
;
x y
}
ŸŸ 
catch
   
(
   
	Exception
   
ex
   
)
    
{
¡¡ 
FDebug
¢¢ 
.
¢¢ 
throwException
¢¢ %
(
¢¢% &
ex
¢¢& (
)
¢¢( )
;
¢¢) *
}
££ 
finally
¤¤ 
{
¥¥ 
}
§§ 
return
¨¨ 
null
¨¨ 
;
¨¨ 
}
©© 	
public
­­ 
FXmlNode
­­ 
sendRequest
­­ #
(
­­# $
string
®® 
module
®® 
,
®® 
string
¯¯ 
	operation
¯¯ 
,
¯¯ 
FXmlNode
°° 
data
°° 
,
°° 
string
±± 
channel
±± 
,
±± 
int
²² 
ttl
²² 
,
²² 
bool
³³ 
async
³³ 
,
³³ 
UInt32
´´ 
tid
´´ 
)
µµ 
{
¶¶ 	
try
·· 
{
¸¸ 
return
¹¹ 
sendRequest
¹¹ "
(
¹¹" #
string
¹¹# )
.
¹¹) *
Empty
¹¹* /
,
¹¹/ 0
module
¹¹1 7
,
¹¹7 8
	operation
¹¹9 B
,
¹¹B C
data
¹¹D H
,
¹¹H I
channel
¹¹J Q
,
¹¹Q R
ttl
¹¹S V
,
¹¹V W
async
¹¹X ]
,
¹¹] ^
tid
¹¹_ b
)
¹¹b c
;
¹¹c d
}
ºº 
catch
»» 
(
»» 
	Exception
»» 
ex
»» 
)
»»  
{
¼¼ 
FDebug
½½ 
.
½½ 
throwException
½½ %
(
½½% &
ex
½½& (
)
½½( )
;
½½) *
}
¾¾ 
finally
¿¿ 
{
ÀÀ 
}
ÂÂ 
return
ÃÃ 
null
ÃÃ 
;
ÃÃ 
}
ÄÄ 	
public
ÈÈ 
FXmlNode
ÈÈ 
sendRequest
ÈÈ #
(
ÈÈ# $
string
ÉÉ 
module
ÉÉ 
,
ÉÉ 
string
ÊÊ 
	operation
ÊÊ 
,
ÊÊ 
FXmlNode
ËË 
data
ËË 
,
ËË 
string
ÌÌ 
channel
ÌÌ 
,
ÌÌ 
int
ÍÍ 
ttl
ÍÍ 
,
ÍÍ 
bool
ÎÎ 
async
ÎÎ 
)
ÏÏ 
{
ĞĞ 	
try
ÑÑ 
{
ÒÒ 
return
ÓÓ 
sendRequest
ÓÓ "
(
ÓÓ" #
string
ÓÓ# )
.
ÓÓ) *
Empty
ÓÓ* /
,
ÓÓ/ 0
module
ÓÓ1 7
,
ÓÓ7 8
	operation
ÓÓ9 B
,
ÓÓB C
data
ÓÓD H
,
ÓÓH I
channel
ÓÓJ Q
,
ÓÓQ R
ttl
ÓÓS V
,
ÓÓV W
async
ÓÓX ]
,
ÓÓ] ^
this
ÓÓ_ c
.
ÓÓc d
fTidPointer
ÓÓd o
.
ÓÓo p
uniqueId
ÓÓp x
)
ÓÓx y
;
ÓÓy z
}
ÔÔ 
catch
ÕÕ 
(
ÕÕ 
	Exception
ÕÕ 
ex
ÕÕ 
)
ÕÕ  
{
ÖÖ 
FDebug
×× 
.
×× 
throwException
×× %
(
××% &
ex
××& (
)
××( )
;
××) *
}
ØØ 
finally
ÙÙ 
{
ÚÚ 
}
ÜÜ 
return
İİ 
null
İİ 
;
İİ 
}
ŞŞ 	
public
ââ 
void
ââ 
sendRequestAsync
ââ $
(
ââ$ %
string
ãã 
serviceName
ãã 
,
ãã 
string
ää 
module
ää 
,
ää 
string
åå 
	operation
åå 
,
åå 
string
ææ 
data
ææ 
,
ææ 
string
çç 
channel
çç 
,
çç 
int
èè 
ttl
èè 
,
èè 
UInt32
éé 
tid
éé 
)
êê 
{
ëë 	
Message
ìì 
req
ìì 
=
ìì 
null
ìì 
;
ìì 
StreamTransformer
íí 
former
íí $
=
íí% &
null
íí' +
;
íí+ ,
try
ïï 
{
ğğ 
req
ññ 
=
ññ 
	m_session
ññ 
.
ññ  
createMessage
ññ  -
(
ññ- .
)
ññ. /
;
ññ/ 0
req
òò 
=
òò 
setProperties
òò #
(
òò# $
req
òò$ '
,
òò' (
serviceName
òò) 4
,
òò4 5
module
òò6 <
,
òò< =
	operation
òò> G
,
òòG H
null
òòI M
,
òòM N
tid
òòO R
)
òòR S
;
òòS T
req
öö 
.
öö 
setDeliveryMode
öö #
(
öö# $
DeliveryType
öö$ 0
.
öö0 1
REQUEST
öö1 8
)
öö8 9
;
öö9 :
req
÷÷ 
.
÷÷ 

setChannel
÷÷ 
(
÷÷ 
channel
÷÷ &
)
÷÷& '
;
÷÷' (
req
øø 
.
øø 
setTTL
øø 
(
øø 
$num
øø 
<
øø 
ttl
øø "
?
øø# $
ttl
øø% (
:
øø) *
m_ttl
øø+ 0
)
øø0 1
;
øø1 2
if
üü 
(
üü 
m_isTrs
üü 
)
üü 
{
ıı 
former
şş 
=
şş 
new
şş  #
StreamTransformerImpl
şş! 6
(
şş6 7
)
şş7 8
;
şş8 9
former
ÿÿ 
.
ÿÿ 
writeMsgString
ÿÿ )
(
ÿÿ) *
data
ÿÿ* .
)
ÿÿ. /
;
ÿÿ/ 0
req
€€ 
.
€€ 
setData
€€ 
(
€€  
former
€€  &
.
€€& '
getBytes
€€' /
(
€€/ 0
)
€€0 1
)
€€1 2
;
€€2 3
}
 
else
‚‚ 
{
ƒƒ 
if
„„ 
(
„„ 
m_isCompressed
„„ &
)
„„& '
{
…… 
req
†† 
.
†† 
setData
†† #
(
††# $
F7Zip
††$ )
.
††) *
compress
††* 2
(
††2 3
data
††3 7
)
††7 8
)
††8 9
;
††9 :
}
‡‡ 
else
ˆˆ 
{
‰‰ 
req
ŠŠ 
.
ŠŠ 
setData
ŠŠ #
(
ŠŠ# $
data
ŠŠ$ (
)
ŠŠ( )
;
ŠŠ) *
}
‹‹ 
}
ŒŒ 
	m_session
 
.
 
sendRequestAsync
 *
(
* +
req
+ .
,
. /
null
0 4
)
4 5
;
5 6
}
‘‘ 
catch
’’ 
(
’’ 
	Exception
’’ 
ex
’’ 
)
’’  
{
““ 
FDebug
”” 
.
”” 
throwException
”” %
(
””% &
ex
””& (
)
””( )
;
””) *
}
•• 
finally
–– 
{
—— 
req
˜˜ 
=
˜˜ 
null
˜˜ 
;
˜˜ 
}
™™ 
}
šš 	
public
 
void
 
sendRequestAsync
 $
(
$ %
string
ŸŸ 
module
ŸŸ 
,
ŸŸ 
string
   
	operation
   
,
   
string
¡¡ 
data
¡¡ 
,
¡¡ 
string
¢¢ 
channel
¢¢ 
,
¢¢ 
int
££ 
ttl
££ 
,
££ 
UInt32
¤¤ 
tid
¤¤ 
)
¥¥ 
{
¦¦ 	
try
§§ 
{
¨¨ 
sendRequestAsync
©©  
(
©©  !
string
©©! '
.
©©' (
Empty
©©( -
,
©©- .
module
©©/ 5
,
©©5 6
	operation
©©7 @
,
©©@ A
data
©©B F
,
©©F G
channel
©©H O
,
©©O P
ttl
©©Q T
,
©©T U
tid
©©V Y
)
©©Y Z
;
©©Z [
}
ªª 
catch
«« 
(
«« 
	Exception
«« 
ex
«« 
)
««  
{
¬¬ 
FDebug
­­ 
.
­­ 
throwException
­­ %
(
­­% &
ex
­­& (
)
­­( )
;
­­) *
}
®® 
finally
¯¯ 
{
°° 
}
²² 
}
³³ 	
public
·· 
void
·· 
sendRequestAsync
·· $
(
··$ %
string
¸¸ 
module
¸¸ 
,
¸¸ 
string
¹¹ 
	operation
¹¹ 
,
¹¹ 
FXmlNode
ºº 
property
ºº 
,
ºº 
string
»» 
data
»» 
,
»» 
string
¼¼ 
channel
¼¼ 
,
¼¼ 
int
½½ 
ttl
½½ 
,
½½ 
UInt32
¾¾ 
tid
¾¾ 
)
¿¿ 
{
ÀÀ 	
try
ÁÁ 
{
ÂÂ 
sendRequestAsync
ÃÃ  
(
ÃÃ  !
string
ÃÃ! '
.
ÃÃ' (
Empty
ÃÃ( -
,
ÃÃ- .
module
ÃÃ/ 5
,
ÃÃ5 6
	operation
ÃÃ7 @
,
ÃÃ@ A
property
ÃÃB J
,
ÃÃJ K
data
ÃÃL P
,
ÃÃP Q
channel
ÃÃR Y
,
ÃÃY Z
ttl
ÃÃ[ ^
,
ÃÃ^ _
tid
ÃÃ` c
)
ÃÃc d
;
ÃÃd e
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
	Exception
ÅÅ 
ex
ÅÅ 
)
ÅÅ  
{
ÆÆ 
FDebug
ÇÇ 
.
ÇÇ 
throwException
ÇÇ %
(
ÇÇ% &
ex
ÇÇ& (
)
ÇÇ( )
;
ÇÇ) *
}
ÈÈ 
finally
ÉÉ 
{
ÊÊ 
}
ÌÌ 
}
ÍÍ 	
public
ÑÑ 
void
ÑÑ 
sendRequestAsync
ÑÑ $
(
ÑÑ$ %
string
ÒÒ 
serviceName
ÒÒ 
,
ÒÒ 
string
ÓÓ 
module
ÓÓ 
,
ÓÓ 
string
ÔÔ 
	operation
ÔÔ 
,
ÔÔ 
FXmlNode
ÕÕ 
property
ÕÕ 
,
ÕÕ 
string
ÖÖ 
data
ÖÖ 
,
ÖÖ 
string
×× 
channel
×× 
,
×× 
int
ØØ 
ttl
ØØ 
,
ØØ 
UInt32
ÙÙ 
tid
ÙÙ 
)
ÚÚ 
{
ÛÛ 	
Message
ÜÜ 
req
ÜÜ 
=
ÜÜ 
null
ÜÜ 
;
ÜÜ 
StreamTransformer
İİ 
former
İİ $
=
İİ% &
null
İİ' +
;
İİ+ ,
try
ßß 
{
àà 
req
áá 
=
áá 
	m_session
áá 
.
áá  
createMessage
áá  -
(
áá- .
)
áá. /
;
áá/ 0
req
ââ 
=
ââ 
setProperties
ââ #
(
ââ# $
req
ââ$ '
,
ââ' (
serviceName
ââ) 4
,
ââ4 5
module
ââ6 <
,
ââ< =
	operation
ââ> G
,
ââG H
property
ââI Q
,
ââQ R
tid
ââS V
)
ââV W
;
ââW X
req
ææ 
.
ææ 
setDeliveryMode
ææ #
(
ææ# $
DeliveryType
ææ$ 0
.
ææ0 1
REQUEST
ææ1 8
)
ææ8 9
;
ææ9 :
req
çç 
.
çç 

setChannel
çç 
(
çç 
channel
çç &
)
çç& '
;
çç' (
req
èè 
.
èè 
setTTL
èè 
(
èè 
$num
èè 
<
èè 
ttl
èè "
?
èè# $
ttl
èè% (
:
èè) *
m_ttl
èè+ 0
)
èè0 1
;
èè1 2
if
ìì 
(
ìì 
m_isTrs
ìì 
)
ìì 
{
íí 
former
îî 
=
îî 
new
îî  #
StreamTransformerImpl
îî! 6
(
îî6 7
)
îî7 8
;
îî8 9
former
ïï 
.
ïï 
writeMsgString
ïï )
(
ïï) *
data
ïï* .
)
ïï. /
;
ïï/ 0
req
ğğ 
.
ğğ 
setData
ğğ 
(
ğğ  
former
ğğ  &
.
ğğ& '
getBytes
ğğ' /
(
ğğ/ 0
)
ğğ0 1
)
ğğ1 2
;
ğğ2 3
}
ññ 
else
òò 
{
óó 
if
ôô 
(
ôô 
m_isCompressed
ôô &
)
ôô& '
{
õõ 
req
öö 
.
öö 
setData
öö #
(
öö# $
F7Zip
öö$ )
.
öö) *
compress
öö* 2
(
öö2 3
data
öö3 7
)
öö7 8
)
öö8 9
;
öö9 :
}
÷÷ 
else
øø 
{
ùù 
req
úú 
.
úú 
setData
úú #
(
úú# $
data
úú$ (
)
úú( )
;
úú) *
}
ûû 
}
üü 
	m_session
€€ 
.
€€ 
sendRequestAsync
€€ *
(
€€* +
req
€€+ .
,
€€. /
null
€€0 4
)
€€4 5
;
€€5 6
}
 
catch
‚‚ 
(
‚‚ 
	Exception
‚‚ 
ex
‚‚ 
)
‚‚  
{
ƒƒ 
FDebug
„„ 
.
„„ 
throwException
„„ %
(
„„% &
ex
„„& (
)
„„( )
;
„„) *
}
…… 
finally
†† 
{
‡‡ 
req
ˆˆ 
=
ˆˆ 
null
ˆˆ 
;
ˆˆ 
}
‰‰ 
}
ŠŠ 	
public
’’ 
void
’’ 
sendRequestAsync
’’ $
(
’’$ %
string
““ 
serviceName
““ 
,
““ 
string
”” 
module
”” 
,
”” 
string
•• 
	operation
•• 
,
•• 
FXmlNode
–– 
data
–– 
,
–– 
string
—— 
channel
—— 
,
—— 
int
˜˜ 
ttl
˜˜ 
,
˜˜ 
UInt32
™™ 
tid
™™ 
)
šš 
{
›› 	
try
œœ 
{
 
sendRequestAsync
  
(
  !
serviceName
! ,
,
, -
module
. 4
,
4 5
	operation
6 ?
,
? @
data
A E
.
E F
outerXml
F N
,
N O
channel
P W
,
W X
ttl
Y \
,
\ ]
tid
^ a
)
a b
;
b c
}
ŸŸ 
catch
   
(
   
	Exception
   
ex
   
)
    
{
¡¡ 
FDebug
¢¢ 
.
¢¢ 
throwException
¢¢ %
(
¢¢% &
ex
¢¢& (
)
¢¢( )
;
¢¢) *
}
££ 
finally
¤¤ 
{
¥¥ 
}
§§ 
}
¨¨ 	
public
°° 
void
°° 
sendRequestAsync
°° $
(
°°$ %
string
±± 
serviceName
±± 
,
±± 
string
²² 
module
²² 
,
²² 
string
³³ 
	operation
³³ 
,
³³ 
FXmlNode
´´ 
data
´´ 
,
´´ 
string
µµ 
channel
µµ 
,
µµ 
int
¶¶ 
ttl
¶¶ 
)
·· 
{
¸¸ 	
try
¹¹ 
{
ºº 
sendRequestAsync
»»  
(
»»  !
serviceName
»»! ,
,
»», -
module
»». 4
,
»»4 5
	operation
»»6 ?
,
»»? @
data
»»A E
,
»»E F
channel
»»G N
,
»»N O
ttl
»»P S
,
»»S T
this
»»U Y
.
»»Y Z
fTidPointer
»»Z e
.
»»e f
uniqueId
»»f n
)
»»n o
;
»»o p
}
¼¼ 
catch
½½ 
(
½½ 
	Exception
½½ 
ex
½½ 
)
½½  
{
¾¾ 
FDebug
¿¿ 
.
¿¿ 
throwException
¿¿ %
(
¿¿% &
ex
¿¿& (
)
¿¿( )
;
¿¿) *
}
ÀÀ 
finally
ÁÁ 
{
ÂÂ 
}
ÄÄ 
}
ÅÅ 	
public
ÍÍ 
void
ÍÍ 
sendRequestAsync
ÍÍ $
(
ÍÍ$ %
string
ÎÎ 
module
ÎÎ 
,
ÎÎ 
string
ÏÏ 
	operation
ÏÏ 
,
ÏÏ 
FXmlNode
ĞĞ 
data
ĞĞ 
,
ĞĞ 
string
ÑÑ 
channel
ÑÑ 
,
ÑÑ 
int
ÒÒ 
ttl
ÒÒ 
,
ÒÒ 
UInt32
ÓÓ 
tid
ÓÓ 
)
ÔÔ 
{
ÕÕ 	
try
ÖÖ 
{
×× 
sendRequestAsync
ØØ  
(
ØØ  !
string
ØØ! '
.
ØØ' (
Empty
ØØ( -
,
ØØ- .
module
ØØ/ 5
,
ØØ5 6
	operation
ØØ7 @
,
ØØ@ A
data
ØØB F
,
ØØF G
channel
ØØH O
,
ØØO P
ttl
ØØQ T
,
ØØT U
tid
ØØV Y
)
ØØY Z
;
ØØZ [
}
ÙÙ 
catch
ÚÚ 
(
ÚÚ 
	Exception
ÚÚ 
ex
ÚÚ 
)
ÚÚ  
{
ÛÛ 
FDebug
ÜÜ 
.
ÜÜ 
throwException
ÜÜ %
(
ÜÜ% &
ex
ÜÜ& (
)
ÜÜ( )
;
ÜÜ) *
}
İİ 
finally
ŞŞ 
{
ßß 
}
áá 
}
ââ 	
public
êê 
void
êê 
sendRequestAsync
êê $
(
êê$ %
string
ëë 
module
ëë 
,
ëë 
string
ìì 
	operation
ìì 
,
ìì 
FXmlNode
íí 
data
íí 
,
íí 
string
îî 
channel
îî 
,
îî 
int
ïï 
ttl
ïï 
)
ğğ 
{
ññ 	
try
òò 
{
óó 
sendRequestAsync
ôô  
(
ôô  !
string
ôô! '
.
ôô' (
Empty
ôô( -
,
ôô- .
module
ôô/ 5
,
ôô5 6
	operation
ôô7 @
,
ôô@ A
data
ôôB F
,
ôôF G
channel
ôôH O
,
ôôO P
ttl
ôôQ T
,
ôôT U
this
ôôV Z
.
ôôZ [
fTidPointer
ôô[ f
.
ôôf g
uniqueId
ôôg o
)
ôôo p
;
ôôp q
}
õõ 
catch
öö 
(
öö 
	Exception
öö 
ex
öö 
)
öö  
{
÷÷ 
FDebug
øø 
.
øø 
throwException
øø %
(
øø% &
ex
øø& (
)
øø( )
;
øø) *
}
ùù 
finally
úú 
{
ûû 
}
ıı 
}
şş 	
}
„„ 
}…… Õz
`D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Reflection\c_FReflection.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

static 
class 
FReflection #
{ 
static 
FReflection 
( 
) 
{ 	
} 	
public-- 
static-- 
object-- 
createInstance-- +
(--+ ,
string.. 
fileName.. 
,.. 
string// 
typeName// 
,// 
object00 
[00 
]00 
args00 
)11 
{22 	
Assembly33 
assembly33 
=33 
null33  $
;33$ %
Type44 
type44 
=44 
null44 
;44 
try66 
{77 
assembly88 
=88 
Assembly88 #
.88# $
LoadFrom88$ ,
(88, -
fileName88- 5
)885 6
;886 7
type99 
=99 
assembly99 
.99  
GetType99  '
(99' (
typeName99( 0
)990 1
;991 2
if:: 
(:: 
type:: 
==:: 
null::  
)::  !
{;; 
return<< 
null<< 
;<<  
}== 
ifAA 
(AA 
argsAA 
==AA 
nullAA  
)AA  !
{BB 
returnCC 
	ActivatorCC $
.CC$ %
CreateInstanceCC% 3
(CC3 4
typeCC4 8
)CC8 9
;CC9 :
}DD 
returnEE 
	ActivatorEE  
.EE  !
CreateInstanceEE! /
(EE/ 0
typeEE0 4
,EE4 5
argsEE6 :
)EE: ;
;EE; <
}FF 
catchGG 
(GG 
	ExceptionGG 
exGG 
)GG  
{HH 
FDebugII 
.II 
throwExceptionII %
(II% &
exII& (
)II( )
;II) *
}JJ 
finallyKK 
{LL 
assemblyMM 
=MM 
nullMM 
;MM  
}NN 
returnOO 
nullOO 
;OO 
}PP 	
publicTT 
staticTT 
objectTT 
createInstanceTT +
(TT+ ,
stringUU 
fileNameUU 
,UU 
stringVV 
typeNameVV 
)WW 
{XX 	
tryYY 
{ZZ 
return[[ 
createInstance[[ %
([[% &
fileName[[& .
,[[. /
typeName[[0 8
,[[8 9
null[[: >
)[[> ?
;[[? @
}\\ 
catch]] 
(]] 
	Exception]] 
ex]] 
)]]  
{^^ 
FDebug__ 
.__ 
throwException__ %
(__% &
ex__& (
)__( )
;__) *
}`` 
finallyaa 
{bb 
}dd 
returnee 
nullee 
;ee 
}ff 	
publicjj 
staticjj 
Typejj 
getTypejj "
(jj" #
stringkk 
fileNamekk 
,kk 
stringll 
typeNamell 
)mm 
{nn 	
Assemblyoo 
assemblyoo 
=oo 
nulloo  $
;oo$ %
tryqq 
{rr 
assemblyss 
=ss 
Assemblyss #
.ss# $
LoadFiless$ ,
(ss, -
fileNamess- 5
)ss5 6
;ss6 7
returntt 
assemblytt 
.tt  
GetTypett  '
(tt' (
typeNamett( 0
)tt0 1
;tt1 2
}uu 
catchvv 
(vv 
	Exceptionvv 
exvv 
)vv  
{ww 
FDebugxx 
.xx 
throwExceptionxx %
(xx% &
exxx& (
)xx( )
;xx) *
}yy 
finallyzz 
{{{ 
}}} 
return~~ 
null~~ 
;~~ 
} 	
public
ƒƒ 
static
ƒƒ 
object
ƒƒ $
createInstanceInMemory
ƒƒ 3
(
ƒƒ3 4
string
„„ 
fileName
„„ 
,
„„ 
string
…… 
typeName
…… 
,
…… 
object
†† 
[
†† 
]
†† 
args
†† 
)
‡‡ 
{
ˆˆ 	

FileStream
‰‰ 
fs
‰‰ 
=
‰‰ 
null
‰‰  
;
‰‰  !
byte
ŠŠ 
[
ŠŠ 
]
ŠŠ 
buf
ŠŠ 
=
ŠŠ 
null
ŠŠ 
;
ŠŠ 
Assembly
‹‹ 
assembly
‹‹ 
=
‹‹ 
null
‹‹  $
;
‹‹$ %
Type
ŒŒ 
type
ŒŒ 
=
ŒŒ 
null
ŒŒ 
;
ŒŒ 
try
 
{
 
fs
 
=
 
new
 

FileStream
 #
(
# $
fileName
$ ,
,
, -
FileMode
. 6
.
6 7
Open
7 ;
,
; <

FileAccess
= G
.
G H
Read
H L
)
L M
;
M N
buf
‘‘ 
=
‘‘ 
new
‘‘ 
byte
‘‘ 
[
‘‘ 
fs
‘‘ !
.
‘‘! "
Length
‘‘" (
]
‘‘( )
;
‘‘) *
fs
’’ 
.
’’ 
Read
’’ 
(
’’ 
buf
’’ 
,
’’ 
$num
’’ 
,
’’ 
buf
’’  #
.
’’# $
Length
’’$ *
)
’’* +
;
’’+ ,
fs
”” 
.
”” 
Close
”” 
(
”” 
)
”” 
;
”” 
fs
•• 
.
•• 
Dispose
•• 
(
•• 
)
•• 
;
•• 
fs
–– 
=
–– 
null
–– 
;
–– 
assembly
˜˜ 
=
˜˜ 
Assembly
˜˜ #
.
˜˜# $
Load
˜˜$ (
(
˜˜( )
buf
˜˜) ,
)
˜˜, -
;
˜˜- .
type
™™ 
=
™™ 
assembly
™™ 
.
™™  
GetType
™™  '
(
™™' (
typeName
™™( 0
)
™™0 1
;
™™1 2
if
šš 
(
šš 
type
šš 
==
šš 
null
šš  
)
šš  !
{
›› 
return
œœ 
null
œœ 
;
œœ  
}
 
if
££ 
(
££ 
args
££ 
==
££ 
null
££  
)
££  !
{
¤¤ 
return
¥¥ 
	Activator
¥¥ $
.
¥¥$ %
CreateInstance
¥¥% 3
(
¥¥3 4
type
¥¥4 8
)
¥¥8 9
;
¥¥9 :
}
¦¦ 
return
§§ 
	Activator
§§  
.
§§  !
CreateInstance
§§! /
(
§§/ 0
type
§§0 4
,
§§4 5
args
§§6 :
)
§§: ;
;
§§; <
}
¨¨ 
catch
©© 
(
©© '
TargetInvocationException
©© ,
targetEx
©©- 5
)
©©5 6
{
ªª 
return
«« 
null
«« 
;
«« 
}
¬¬ 
catch
­­ 
(
­­ 
	Exception
­­ 
ex
­­ 
)
­­  
{
®® 
FDebug
¯¯ 
.
¯¯ 
throwException
¯¯ %
(
¯¯% &
ex
¯¯& (
)
¯¯( )
;
¯¯) *
}
°° 
finally
±± 
{
²² 
if
³³ 
(
³³ 
fs
³³ 
!=
³³ 
null
³³ 
)
³³ 
{
´´ 
fs
µµ 
.
µµ 
Close
µµ 
(
µµ 
)
µµ 
;
µµ 
fs
¶¶ 
.
¶¶ 
Dispose
¶¶ 
(
¶¶ 
)
¶¶  
;
¶¶  !
fs
·· 
=
·· 
null
·· 
;
·· 
}
¸¸ 
assembly
¹¹ 
=
¹¹ 
null
¹¹ 
;
¹¹  
}
ºº 
return
»» 
null
»» 
;
»» 
}
¼¼ 	
public
ÀÀ 
static
ÀÀ 
object
ÀÀ $
createInstanceInMemory
ÀÀ 3
(
ÀÀ3 4
string
ÁÁ 
fileName
ÁÁ 
,
ÁÁ 
string
ÂÂ 
typeName
ÂÂ 
)
ÃÃ 
{
ÄÄ 	
try
ÅÅ 
{
ÆÆ 
return
ÇÇ 
createInstance
ÇÇ %
(
ÇÇ% &
fileName
ÇÇ& .
,
ÇÇ. /
typeName
ÇÇ0 8
,
ÇÇ8 9
null
ÇÇ: >
)
ÇÇ> ?
;
ÇÇ? @
}
ÈÈ 
catch
ÉÉ 
(
ÉÉ 
	Exception
ÉÉ 
ex
ÉÉ 
)
ÉÉ  
{
ÊÊ 
FDebug
ËË 
.
ËË 
throwException
ËË %
(
ËË% &
ex
ËË& (
)
ËË( )
;
ËË) *
}
ÌÌ 
finally
ÍÍ 
{
ÎÎ 
}
ĞĞ 
return
ÑÑ 
null
ÑÑ 
;
ÑÑ 
}
ÒÒ 	
public
ÖÖ 
static
ÖÖ 
object
ÖÖ 
invokeMethod
ÖÖ )
(
ÖÖ) *
object
×× 
instance
×× 
,
×× 
Type
ØØ 
type
ØØ 
,
ØØ 
string
ÙÙ 

methodName
ÙÙ 
,
ÙÙ 
object
ÚÚ 
[
ÚÚ 
]
ÚÚ 
args
ÚÚ 
)
ÛÛ 
{
ÜÜ 	

MethodInfo
İİ 

methodInfo
İİ !
=
İİ" #
null
İİ$ (
;
İİ( )
List
ŞŞ 
<
ŞŞ 
Type
ŞŞ 
>
ŞŞ 
argTypes
ŞŞ 
=
ŞŞ  !
null
ŞŞ" &
;
ŞŞ& '
try
àà 
{
áá 
argTypes
ââ 
=
ââ 
new
ââ 
List
ââ #
<
ââ# $
Type
ââ$ (
>
ââ( )
(
ââ) *
)
ââ* +
;
ââ+ ,
foreach
ãã 
(
ãã 
object
ãã 
arg
ãã  #
in
ãã$ &
args
ãã' +
)
ãã+ ,
{
ää 
argTypes
åå 
.
åå 
Add
åå  
(
åå  !
arg
åå! $
.
åå$ %
GetType
åå% ,
(
åå, -
)
åå- .
)
åå. /
;
åå/ 0
}
ææ 

methodInfo
êê 
=
êê 
type
êê !
.
êê! "
	GetMethod
êê" +
(
êê+ ,

methodName
êê, 6
,
êê6 7
argTypes
êê8 @
.
êê@ A
ToArray
êêA H
(
êêH I
)
êêI J
)
êêJ K
;
êêK L
if
ëë 
(
ëë 

methodInfo
ëë 
==
ëë !
null
ëë" &
)
ëë& '
{
ìì 
FDebug
íí 
.
íí 
throwFException
íí *
(
íí* +
string
íí+ 1
.
íí1 2
Format
íí2 8
(
íí8 9

FConstants
íí9 C
.
ííC D

err_m_0003
ííD N
,
ííN O
$str
ííP X
)
ííX Y
)
ííY Z
;
ííZ [
}
îî 
return
òò 

methodInfo
òò !
.
òò! "
Invoke
òò" (
(
òò( )
instance
òò) 1
,
òò1 2
args
òò3 7
)
òò7 8
;
òò8 9
}
óó 
catch
ôô 
(
ôô 
	Exception
ôô 
ex
ôô 
)
ôô  
{
õõ 
FDebug
öö 
.
öö 
throwException
öö %
(
öö% &
ex
öö& (
)
öö( )
;
öö) *
}
÷÷ 
finally
øø 
{
ùù 

methodInfo
úú 
=
úú 
null
úú !
;
úú! "
}
ûû 
return
üü 
null
üü 
;
üü 
}
ıı 	
public
 
static
 
object
 
invokeMethod
 )
(
) *
object
‚‚ 
instance
‚‚ 
,
‚‚ 
string
ƒƒ 
typeName
ƒƒ 
,
ƒƒ 
string
„„ 

methodName
„„ 
,
„„ 
object
…… 
[
…… 
]
…… 
args
…… 
)
†† 
{
‡‡ 	
Type
ˆˆ 
type
ˆˆ 
=
ˆˆ 
null
ˆˆ 
;
ˆˆ 

MethodInfo
‰‰ 

methodInfo
‰‰ !
=
‰‰" #
null
‰‰$ (
;
‰‰( )
try
‹‹ 
{
ŒŒ 
type
 
=
 
Type
 
.
 
GetType
 #
(
# $
typeName
$ ,
)
, -
;
- .
if
 
(
 
type
 
==
 
null
  
)
  !
{
 
FDebug
 
.
 
throwFException
 *
(
* +
string
+ 1
.
1 2
Format
2 8
(
8 9

FConstants
9 C
.
C D

err_m_0003
D N
,
N O
$str
P V
)
V W
)
W X
;
X Y
}
‘‘ 

methodInfo
•• 
=
•• 
type
•• !
.
••! "
	GetMethod
••" +
(
••+ ,

methodName
••, 6
)
••6 7
;
••7 8
if
–– 
(
–– 

methodInfo
–– 
==
–– !
null
––" &
)
––& '
{
—— 
FDebug
˜˜ 
.
˜˜ 
throwFException
˜˜ *
(
˜˜* +
string
˜˜+ 1
.
˜˜1 2
Format
˜˜2 8
(
˜˜8 9

FConstants
˜˜9 C
.
˜˜C D

err_m_0003
˜˜D N
,
˜˜N O
$str
˜˜P X
)
˜˜X Y
)
˜˜Y Z
;
˜˜Z [
}
™™ 
return
 

methodInfo
 !
.
! "
Invoke
" (
(
( )
instance
) 1
,
1 2
args
3 7
)
7 8
;
8 9
}
 
catch
ŸŸ 
(
ŸŸ 
	Exception
ŸŸ 
ex
ŸŸ 
)
ŸŸ  
{
   
FDebug
¡¡ 
.
¡¡ 
throwException
¡¡ %
(
¡¡% &
ex
¡¡& (
)
¡¡( )
;
¡¡) *
}
¢¢ 
finally
££ 
{
¤¤ 
type
¥¥ 
=
¥¥ 
null
¥¥ 
;
¥¥ 

methodInfo
¦¦ 
=
¦¦ 
null
¦¦ !
;
¦¦! "
}
§§ 
return
¨¨ 
null
¨¨ 
;
¨¨ 
}
©© 	
public
­­ 
static
­­ 
object
­­ 
invokeMethod
­­ )
(
­­) *
object
®® 
instance
®® 
,
®® 
string
¯¯ 
typeName
¯¯ 
,
¯¯ 
string
°° 

methodName
°° 
)
±± 
{
²² 	
try
³³ 
{
´´ 
return
µµ 
invokeMethod
µµ #
(
µµ# $
instance
µµ$ ,
,
µµ, -
typeName
µµ. 6
,
µµ6 7

methodName
µµ8 B
,
µµB C
null
µµD H
)
µµH I
;
µµI J
}
¶¶ 
catch
·· 
(
·· 
	Exception
·· 
ex
·· 
)
··  
{
¸¸ 
FDebug
¹¹ 
.
¹¹ 
throwException
¹¹ %
(
¹¹% &
ex
¹¹& (
)
¹¹( )
;
¹¹) *
}
ºº 
finally
»» 
{
¼¼ 
}
¾¾ 
return
¿¿ 
null
¿¿ 
;
¿¿ 
}
ÀÀ 	
}
ÆÆ 
}ÇÇ ¬>
VD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Queue\c_FQueue.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FQueue 
< 
T 
> 
: 
IDisposable (
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
	FCodeLock 
m_fCodeLock %
=& '
null( ,
;, -
private 
Queue 
< 
T 
> 
m_queue  
=! "
null# '
;' (
public## 
FQueue## 
(## 
)$$ 
{%% 	
m_fCodeLock&& 
=&& 
new&& 
	FCodeLock&& '
(&&' (
)&&( )
;&&) *
m_queue'' 
='' 
new'' 
Queue'' 
<''  
T''  !
>''! "
(''" #
)''# $
;''$ %
}(( 	
~,, 	
FQueue,,	 
(,, 
)-- 
{.. 	
	myDispose// 
(// 
false// 
)// 
;// 
}00 	
	protected44 
void44 
	myDispose44  
(44  !
bool55 
	disposing55 
)66 
{77 	
if88 
(88 
!88 

m_disposed88 
)88 
{99 
if:: 
(:: 
	disposing:: 
):: 
{;; 
if<< 
(<< 
m_queue<< 
!=<<  "
null<<# '
)<<' (
{== 
m_queue>> 
.>>  
Clear>>  %
(>>% &
)>>& '
;>>' (
m_queue?? 
=??  !
null??" &
;??& '
}@@ 
ifDD 
(DD 
m_fCodeLockDD #
!=DD$ &
nullDD' +
)DD+ ,
{EE 
m_fCodeLockFF #
.FF# $
DisposeFF$ +
(FF+ ,
)FF, -
;FF- .
m_fCodeLockGG #
=GG$ %
nullGG& *
;GG* +
}HH 
}II 

m_disposedKK 
=KK 
trueKK !
;KK! "
}LL 
}MM 	
publicUU 
voidUU 
DisposeUU 
(UU 
)VV 
{WW 	
	myDisposeXX 
(XX 
trueXX 
)XX 
;XX 
GCYY 
.YY 
SuppressFinalizeYY 
(YY  
thisYY  $
)YY$ %
;YY% &
}ZZ 	
publicbb 
intbb 
countbb 
{cc 	
getdd 
{ee 
tryff 
{gg 
m_fCodeLockhh 
.hh  
waithh  $
(hh$ %
)hh% &
;hh& '
returnii 
m_queueii "
.ii" #
Countii# (
;ii( )
}jj 
catchkk 
(kk 
	Exceptionkk  
exkk! #
)kk# $
{ll 
FDebugmm 
.mm 
throwExceptionmm )
(mm) *
exmm* ,
)mm, -
;mm- .
}nn 
finallyoo 
{pp 
m_fCodeLockqq 
.qq  
setqq  #
(qq# $
)qq$ %
;qq% &
}rr 
returnss 
$numss 
;ss 
}tt 
}uu 	
public}} 
void}} 
enqueue}} 
(}} 
T~~ 
data~~ 
) 
{
€€ 	
try
 
{
‚‚ 
m_fCodeLock
ƒƒ 
.
ƒƒ 
wait
ƒƒ  
(
ƒƒ  !
)
ƒƒ! "
;
ƒƒ" #
m_queue
„„ 
.
„„ 
Enqueue
„„ 
(
„„  
data
„„  $
)
„„$ %
;
„„% &
}
…… 
catch
†† 
(
†† 
	Exception
†† 
ex
†† 
)
††  
{
‡‡ 
FDebug
ˆˆ 
.
ˆˆ 
throwException
ˆˆ %
(
ˆˆ% &
ex
ˆˆ& (
)
ˆˆ( )
;
ˆˆ) *
}
‰‰ 
finally
ŠŠ 
{
‹‹ 
m_fCodeLock
ŒŒ 
.
ŒŒ 
set
ŒŒ 
(
ŒŒ  
)
ŒŒ  !
;
ŒŒ! "
}
 
}
 	
public
’’ 
void
’’ 
enqueue
’’ 
(
’’ 
T
’’ 
[
’’ 
]
’’ 
datas
’’  %
)
’’% &
{
““ 	
try
”” 
{
•• 
m_fCodeLock
–– 
.
–– 
wait
––  
(
––  !
)
––! "
;
––" #
foreach
—— 
(
—— 
T
—— 
t
—— 
in
—— 
datas
——  %
)
——% &
{
˜˜ 
m_queue
™™ 
.
™™ 
Enqueue
™™ #
(
™™# $
t
™™$ %
)
™™% &
;
™™& '
}
šš 
}
›› 
catch
œœ 
(
œœ 
	Exception
œœ 
ex
œœ 
)
œœ  
{
 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
ŸŸ 
finally
   
{
¡¡ 
m_fCodeLock
¢¢ 
.
¢¢ 
set
¢¢ 
(
¢¢  
)
¢¢  !
;
¢¢! "
}
££ 
}
¤¤ 	
public
¨¨ 
T
¨¨ 
dequeue
¨¨ 
(
¨¨ 
)
©© 
{
ªª 	
try
«« 
{
¬¬ 
m_fCodeLock
­­ 
.
­­ 
wait
­­  
(
­­  !
)
­­! "
;
­­" #
if
®® 
(
®® 
m_queue
®® 
.
®® 
Count
®® !
==
®®" $
$num
®®% &
)
®®& '
{
¯¯ 
return
°° 
default
°° "
(
°°" #
T
°°# $
)
°°$ %
;
°°% &
}
±± 
return
²² 
m_queue
²² 
.
²² 
Dequeue
²² &
(
²²& '
)
²²' (
;
²²( )
}
³³ 
catch
´´ 
(
´´ 
	Exception
´´ 
ex
´´ 
)
´´  
{
µµ 
FDebug
¶¶ 
.
¶¶ 
throwException
¶¶ %
(
¶¶% &
ex
¶¶& (
)
¶¶( )
;
¶¶) *
}
·· 
finally
¸¸ 
{
¹¹ 
m_fCodeLock
ºº 
.
ºº 
set
ºº 
(
ºº  
)
ºº  !
;
ºº! "
}
»» 
return
¼¼ 
default
¼¼ 
(
¼¼ 
T
¼¼ 
)
¼¼ 
;
¼¼ 
}
½½ 	
public
ÁÁ 
T
ÁÁ 
[
ÁÁ 
]
ÁÁ 

dequeueAll
ÁÁ 
(
ÁÁ 
)
ÂÂ 
{
ÃÃ 	
try
ÄÄ 
{
ÅÅ 
m_fCodeLock
ÆÆ 
.
ÆÆ 
wait
ÆÆ  
(
ÆÆ  !
)
ÆÆ! "
;
ÆÆ" #
return
ÇÇ 
m_queue
ÇÇ 
.
ÇÇ 
ToArray
ÇÇ &
(
ÇÇ& '
)
ÇÇ' (
;
ÇÇ( )
}
ÈÈ 
catch
ÉÉ 
(
ÉÉ 
	Exception
ÉÉ 
ex
ÉÉ 
)
ÉÉ  
{
ÊÊ 
FDebug
ËË 
.
ËË 
throwException
ËË %
(
ËË% &
ex
ËË& (
)
ËË( )
;
ËË) *
}
ÌÌ 
finally
ÍÍ 
{
ÎÎ 
m_queue
ÏÏ 
.
ÏÏ 
Clear
ÏÏ 
(
ÏÏ 
)
ÏÏ 
;
ÏÏ  
m_fCodeLock
ĞĞ 
.
ĞĞ 
set
ĞĞ 
(
ĞĞ  
)
ĞĞ  !
;
ĞĞ! "
}
ÑÑ 
return
ÒÒ 
null
ÒÒ 
;
ÒÒ 
}
ÓÓ 	
}
ÙÙ 
}ÚÚ Ç
gD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Xml\c_FXmlNodeModifiedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class %
FXmlNodeModifiedEventArgs *
:+ ,
	EventArgs- 6
,6 7
IDisposable8 C
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FXmlNode 

m_fXmlNode #
=$ %
null& *
;* +
internal!! %
FXmlNodeModifiedEventArgs!! *
(!!* +
FXmlNode"" 
fXmlNode"" 
)## 
{$$ 	

m_fXmlNode%% 
=%% 
fXmlNode%% !
;%%! "
}&& 	
~** 	%
FXmlNodeModifiedEventArgs**	 "
(**" #
)++ 
{,, 	
	myDispose-- 
(-- 
false-- 
)-- 
;-- 
}.. 	
	protected22 
void22 
	myDispose22  
(22  !
bool33 
	disposing33 
)44 
{55 	
if66 
(66 
!66 

m_disposed66 
)66 
{77 
if88 
(88 
	disposing88 
)88 
{99 
};; 

m_disposed== 
=== 
true== !
;==! "
}>> 
}?? 	
publicGG 
voidGG 
DisposeGG 
(GG 
)HH 
{II 	
	myDisposeJJ 
(JJ 
trueJJ 
)JJ 
;JJ 
GCKK 
.KK 
SuppressFinalizeKK 
(KK  
thisKK  $
)KK$ %
;KK% &
}LL 	
publicTT 
FXmlNodeTT 
fXmlNodeTT  
{UU 	
getVV 
{WW 
tryXX 
{YY 
returnZZ 

m_fXmlNodeZZ %
;ZZ% &
}[[ 
catch\\ 
(\\ 
	Exception\\  
ex\\! #
)\\# $
{]] 
FDebug^^ 
.^^ 
throwException^^ )
(^^) *
ex^^* ,
)^^, -
;^^- .
}__ 
finally`` 
{aa 
}cc 
returndd 
nulldd 
;dd 
}ee 
}ff 	
}rr 
}ss ÁU
`D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\IDPointer\c_FIDPointer32.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FIDPointer32 
: 
IDisposable  +
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
	FCodeLock 
m_fCodeLock %
=& '
null( ,
;, -
private 
UInt32 
m_min 
= 
UInt32 %
.% &
MinValue& .
;. /
private 
UInt32 
m_max 
= 
UInt32 %
.% &
MaxValue& .
;. /
private 
UInt32 
m_currentId "
=# $
UInt32% +
.+ ,
MinValue, 4
;4 5
public$$ 
FIDPointer32$$ 
($$ 
)%% 
{&& 	
init'' 
('' 
)'' 
;'' 
}(( 	
public,, 
FIDPointer32,, 
(,, 
UInt32-- 
	currentId-- 
).. 
:// 
this// 
(// 
)// 
{00 	
m_currentId11 
=11 
	currentId11 #
;11# $
}22 	
public66 
FIDPointer3266 
(66 
UInt3277 
min77 
,77 
UInt3288 
max88 
,88 
UInt3299 
	currentId99 
):: 
:;; 
this;; 
(;; 
);; 
{<< 	
m_min== 
=== 
min== 
;== 
m_max>> 
=>> 
max>> 
;>> 
m_currentId?? 
=?? 
	currentId?? #
;??# $
}@@ 	
~DD 	
FIDPointer32DD	 
(DD 
)EE 
{FF 	
	myDisposeGG 
(GG 
falseGG 
)GG 
;GG 
}HH 	
	protectedLL 
voidLL 
	myDisposeLL  
(LL  !
boolMM 
	disposingMM 
)NN 
{OO 	
ifPP 
(PP 
!PP 

m_disposedPP 
)PP 
{QQ 
ifRR 
(RR 
	disposingRR 
)RR 
{SS 
termTT 
(TT 
)TT 
;TT 
}UU 

m_disposedWW 
=WW 
trueWW !
;WW! "
}XX 
}YY 	
publicaa 
voidaa 
Disposeaa 
(aa 
)bb 
{cc 	
	myDisposedd 
(dd 
truedd 
)dd 
;dd 
GCee 
.ee 
SuppressFinalizeee 
(ee  
thisee  $
)ee$ %
;ee% &
}ff 	
publicnn 
UInt32nn 
	currentIdnn 
{oo 	
getpp 
{qq 
tryrr 
{ss 
m_fCodeLocktt 
.tt  
waittt  $
(tt$ %
)tt% &
;tt& '
returnuu 
m_currentIduu &
;uu& '
}vv 
catchww 
(ww 
	Exceptionww  
exww! #
)ww# $
{xx 
FDebugyy 
.yy 
throwExceptionyy )
(yy) *
exyy* ,
)yy, -
;yy- .
}zz 
finally{{ 
{|| 
m_fCodeLock}} 
.}}  
set}}  #
(}}# $
)}}$ %
;}}% &
}~~ 
return 
$num 
; 
}
€€ 
}
 	
public
…… 
UInt32
…… 
uniqueId
…… 
{
†† 	
get
‡‡ 
{
ˆˆ 
UInt32
‰‰ 
id
‰‰ 
=
‰‰ 
$num
‰‰ 
;
‰‰ 
try
‹‹ 
{
ŒŒ 
m_fCodeLock
 
.
  
wait
  $
(
$ %
)
% &
;
& '
id
 
=
 
m_currentId
 $
;
$ %
if
‘‘ 
(
‘‘ 
m_currentId
‘‘ #
>=
‘‘$ &
m_max
‘‘' ,
)
‘‘, -
{
’’ 
m_currentId
““ #
=
““$ %
m_min
““& +
;
““+ ,
}
”” 
else
•• 
{
–– 
m_currentId
—— #
++
——# %
;
——% &
}
˜˜ 
return
™™ 
id
™™ 
;
™™ 
}
šš 
catch
›› 
(
›› 
	Exception
››  
ex
››! #
)
››# $
{
œœ 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
ŸŸ 
{
   
m_fCodeLock
¡¡ 
.
¡¡  
set
¡¡  #
(
¡¡# $
)
¡¡$ %
;
¡¡% &
}
¢¢ 
return
££ 
$num
££ 
;
££ 
}
¤¤ 
}
¥¥ 	
public
©© 
UInt32
©© 
min
©© 
{
ªª 	
get
«« 
{
¬¬ 
try
­­ 
{
®® 
return
¯¯ 
m_min
¯¯  
;
¯¯  !
}
°° 
catch
±± 
(
±± 
	Exception
±±  
ex
±±! #
)
±±# $
{
²² 
FDebug
³³ 
.
³³ 
throwException
³³ )
(
³³) *
ex
³³* ,
)
³³, -
;
³³- .
}
´´ 
finally
µµ 
{
¶¶ 
}
¸¸ 
return
¹¹ 
$num
¹¹ 
;
¹¹ 
}
ºº 
}
»» 	
public
¿¿ 
UInt32
¿¿ 
max
¿¿ 
{
ÀÀ 	
get
ÁÁ 
{
ÂÂ 
try
ÃÃ 
{
ÄÄ 
return
ÅÅ 
m_max
ÅÅ  
;
ÅÅ  !
}
ÆÆ 
catch
ÇÇ 
(
ÇÇ 
	Exception
ÇÇ  
ex
ÇÇ! #
)
ÇÇ# $
{
ÈÈ 
FDebug
ÉÉ 
.
ÉÉ 
throwException
ÉÉ )
(
ÉÉ) *
ex
ÉÉ* ,
)
ÉÉ, -
;
ÉÉ- .
}
ÊÊ 
finally
ËË 
{
ÌÌ 
}
ÎÎ 
return
ÏÏ 
$num
ÏÏ 
;
ÏÏ 
}
ĞĞ 
}
ÑÑ 	
private
ÙÙ 
void
ÙÙ 
init
ÙÙ 
(
ÙÙ 
)
ÚÚ 
{
ÛÛ 	
try
ÜÜ 
{
İİ 
m_fCodeLock
ŞŞ 
=
ŞŞ 
new
ŞŞ !
	FCodeLock
ŞŞ" +
(
ŞŞ+ ,
)
ŞŞ, -
;
ŞŞ- .
}
ßß 
catch
àà 
(
àà 
	Exception
àà 
ex
àà 
)
àà  
{
áá 
FDebug
ââ 
.
ââ 
throwException
ââ %
(
ââ% &
ex
ââ& (
)
ââ( )
;
ââ) *
}
ãã 
finally
ää 
{
åå 
}
çç 
}
èè 	
private
ìì 
void
ìì 
term
ìì 
(
ìì 
)
íí 
{
îî 	
try
ïï 
{
ğğ 
if
ññ 
(
ññ 
m_fCodeLock
ññ 
!=
ññ  "
null
ññ# '
)
ññ' (
{
òò 
m_fCodeLock
óó 
.
óó  
Dispose
óó  '
(
óó' (
)
óó( )
;
óó) *
m_fCodeLock
ôô 
=
ôô  !
null
ôô" &
;
ôô& '
}
õõ 
}
öö 
catch
÷÷ 
(
÷÷ 
	Exception
÷÷ 
ex
÷÷ 
)
÷÷  
{
øø 
FDebug
ùù 
.
ùù 
throwException
ùù %
(
ùù% &
ex
ùù& (
)
ùù( )
;
ùù) *
}
úú 
finally
ûû 
{
üü 
}
şş 
}
ÿÿ 	
public
ƒƒ 
void
ƒƒ 
reset
ƒƒ 
(
ƒƒ 
)
„„ 
{
…… 	
try
†† 
{
‡‡ 
m_fCodeLock
ˆˆ 
.
ˆˆ 
wait
ˆˆ  
(
ˆˆ  !
)
ˆˆ! "
;
ˆˆ" #
m_currentId
‰‰ 
=
‰‰ 
m_min
‰‰ #
;
‰‰# $
}
ŠŠ 
catch
‹‹ 
(
‹‹ 
	Exception
‹‹ 
ex
‹‹ 
)
‹‹  
{
ŒŒ 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
 
{
 
m_fCodeLock
‘‘ 
.
‘‘ 
set
‘‘ 
(
‘‘  
)
‘‘  !
;
‘‘! "
}
’’ 
}
““ 	
public
—— 
void
—— 
reset
—— 
(
—— 
UInt32
˜˜ 
	currentId
˜˜ 
)
™™ 
{
šš 	
try
›› 
{
œœ 
m_fCodeLock
 
.
 
wait
  
(
  !
)
! "
;
" #
m_currentId
 
=
 
	currentId
 '
;
' (
}
ŸŸ 
catch
   
(
   
	Exception
   
ex
   
)
    
{
¡¡ 
FDebug
¢¢ 
.
¢¢ 
throwException
¢¢ %
(
¢¢% &
ex
¢¢& (
)
¢¢( )
;
¢¢) *
}
££ 
finally
¤¤ 
{
¥¥ 
m_fCodeLock
¦¦ 
.
¦¦ 
set
¦¦ 
(
¦¦  
)
¦¦  !
;
¦¦! "
}
§§ 
}
¨¨ 	
public
¬¬ 
void
¬¬ 
reset
¬¬ 
(
¬¬ 
UInt32
­­ 
min
­­ 
,
­­ 
UInt32
®® 
max
®® 
,
®® 
UInt32
¯¯ 
	currentId
¯¯ 
)
°° 
{
±± 	
try
²² 
{
³³ 
m_fCodeLock
´´ 
.
´´ 
wait
´´  
(
´´  !
)
´´! "
;
´´" #
m_min
µµ 
=
µµ 
min
µµ 
;
µµ 
m_max
¶¶ 
=
¶¶ 
max
¶¶ 
;
¶¶ 
m_currentId
·· 
=
·· 
	currentId
·· '
;
··' (
}
¸¸ 
catch
¹¹ 
(
¹¹ 
	Exception
¹¹ 
ex
¹¹ 
)
¹¹  
{
ºº 
FDebug
»» 
.
»» 
throwException
»» %
(
»»% &
ex
»»& (
)
»»( )
;
»») *
}
¼¼ 
finally
½½ 
{
¾¾ 
m_fCodeLock
¿¿ 
.
¿¿ 
set
¿¿ 
(
¿¿  
)
¿¿  !
;
¿¿! "
}
ÀÀ 
}
ÁÁ 	
}
ÇÇ 
}ÈÈ ÁU
`D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\IDPointer\c_FIDPointer64.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FIDPointer64 
: 
IDisposable  +
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
	FCodeLock 
m_fCodeLock %
=& '
null( ,
;, -
private 
UInt64 
m_min 
= 
UInt64 %
.% &
MinValue& .
;. /
private 
UInt64 
m_max 
= 
UInt64 %
.% &
MaxValue& .
;. /
private 
UInt64 
m_currentId "
=# $
UInt64% +
.+ ,
MinValue, 4
;4 5
public$$ 
FIDPointer64$$ 
($$ 
)%% 
{&& 	
init'' 
('' 
)'' 
;'' 
}(( 	
public,, 
FIDPointer64,, 
(,, 
UInt64-- 
	currentId-- 
).. 
:// 
this// 
(// 
)// 
{00 	
m_currentId11 
=11 
	currentId11 #
;11# $
}22 	
public66 
FIDPointer6466 
(66 
UInt6477 
min77 
,77 
UInt6488 
max88 
,88 
UInt6499 
	currentId99 
):: 
:;; 
this;; 
(;; 
);; 
{<< 	
m_min== 
=== 
min== 
;== 
m_max>> 
=>> 
max>> 
;>> 
m_currentId?? 
=?? 
	currentId?? #
;??# $
}@@ 	
~DD 	
FIDPointer64DD	 
(DD 
)EE 
{FF 	
	myDisposeGG 
(GG 
falseGG 
)GG 
;GG 
}HH 	
	protectedLL 
voidLL 
	myDisposeLL  
(LL  !
boolMM 
	disposingMM 
)NN 
{OO 	
ifPP 
(PP 
!PP 

m_disposedPP 
)PP 
{QQ 
ifRR 
(RR 
	disposingRR 
)RR 
{SS 
termTT 
(TT 
)TT 
;TT 
}UU 

m_disposedWW 
=WW 
trueWW !
;WW! "
}XX 
}YY 	
publicaa 
voidaa 
Disposeaa 
(aa 
)bb 
{cc 	
	myDisposedd 
(dd 
truedd 
)dd 
;dd 
GCee 
.ee 
SuppressFinalizeee 
(ee  
thisee  $
)ee$ %
;ee% &
}ff 	
publicnn 
UInt64nn 
	currentIdnn 
{oo 	
getpp 
{qq 
tryrr 
{ss 
m_fCodeLocktt 
.tt  
waittt  $
(tt$ %
)tt% &
;tt& '
returnuu 
m_currentIduu &
;uu& '
}vv 
catchww 
(ww 
	Exceptionww  
exww! #
)ww# $
{xx 
FDebugyy 
.yy 
throwExceptionyy )
(yy) *
exyy* ,
)yy, -
;yy- .
}zz 
finally{{ 
{|| 
m_fCodeLock}} 
.}}  
set}}  #
(}}# $
)}}$ %
;}}% &
}~~ 
return 
$num 
; 
}
€€ 
}
 	
public
…… 
UInt64
…… 
uniqueId
…… 
{
†† 	
get
‡‡ 
{
ˆˆ 
UInt64
‰‰ 
id
‰‰ 
=
‰‰ 
$num
‰‰ 
;
‰‰ 
try
‹‹ 
{
ŒŒ 
m_fCodeLock
 
.
  
wait
  $
(
$ %
)
% &
;
& '
id
 
=
 
m_currentId
 $
;
$ %
if
 
(
 
m_currentId
 #
>=
$ &
m_max
' ,
)
, -
{
 
m_currentId
‘‘ #
=
‘‘$ %
m_min
‘‘& +
;
‘‘+ ,
}
’’ 
else
““ 
{
”” 
m_currentId
•• #
++
••# %
;
••% &
}
–– 
return
—— 
id
—— 
;
—— 
}
˜˜ 
catch
™™ 
(
™™ 
	Exception
™™  
ex
™™! #
)
™™# $
{
šš 
FDebug
›› 
.
›› 
throwException
›› )
(
››) *
ex
››* ,
)
››, -
;
››- .
}
œœ 
finally
 
{
 
m_fCodeLock
ŸŸ 
.
ŸŸ  
set
ŸŸ  #
(
ŸŸ# $
)
ŸŸ$ %
;
ŸŸ% &
}
   
return
¡¡ 
$num
¡¡ 
;
¡¡ 
}
¢¢ 
}
££ 	
public
§§ 
UInt64
§§ 
min
§§ 
{
¨¨ 	
get
©© 
{
ªª 
try
«« 
{
¬¬ 
return
­­ 
m_min
­­  
;
­­  !
}
®® 
catch
¯¯ 
(
¯¯ 
	Exception
¯¯  
ex
¯¯! #
)
¯¯# $
{
°° 
FDebug
±± 
.
±± 
throwException
±± )
(
±±) *
ex
±±* ,
)
±±, -
;
±±- .
}
²² 
finally
³³ 
{
´´ 
}
¶¶ 
return
·· 
$num
·· 
;
·· 
}
¸¸ 
}
¹¹ 	
public
½½ 
UInt64
½½ 
max
½½ 
{
¾¾ 	
get
¿¿ 
{
ÀÀ 
try
ÁÁ 
{
ÂÂ 
return
ÃÃ 
m_max
ÃÃ  
;
ÃÃ  !
}
ÄÄ 
catch
ÅÅ 
(
ÅÅ 
	Exception
ÅÅ  
ex
ÅÅ! #
)
ÅÅ# $
{
ÆÆ 
FDebug
ÇÇ 
.
ÇÇ 
throwException
ÇÇ )
(
ÇÇ) *
ex
ÇÇ* ,
)
ÇÇ, -
;
ÇÇ- .
}
ÈÈ 
finally
ÉÉ 
{
ÊÊ 
}
ÌÌ 
return
ÍÍ 
$num
ÍÍ 
;
ÍÍ 
}
ÎÎ 
}
ÏÏ 	
private
×× 
void
×× 
init
×× 
(
×× 
)
ØØ 
{
ÙÙ 	
try
ÚÚ 
{
ÛÛ 
m_fCodeLock
ÜÜ 
=
ÜÜ 
new
ÜÜ !
	FCodeLock
ÜÜ" +
(
ÜÜ+ ,
)
ÜÜ, -
;
ÜÜ- .
}
İİ 
catch
ŞŞ 
(
ŞŞ 
	Exception
ŞŞ 
ex
ŞŞ 
)
ŞŞ  
{
ßß 
FDebug
àà 
.
àà 
throwException
àà %
(
àà% &
ex
àà& (
)
àà( )
;
àà) *
}
áá 
finally
ââ 
{
ãã 
}
åå 
}
ææ 	
private
êê 
void
êê 
term
êê 
(
êê 
)
ëë 
{
ìì 	
try
íí 
{
îî 
if
ïï 
(
ïï 
m_fCodeLock
ïï 
!=
ïï  "
null
ïï# '
)
ïï' (
{
ğğ 
m_fCodeLock
ññ 
.
ññ  
Dispose
ññ  '
(
ññ' (
)
ññ( )
;
ññ) *
m_fCodeLock
òò 
=
òò  !
null
òò" &
;
òò& '
}
óó 
}
ôô 
catch
õõ 
(
õõ 
	Exception
õõ 
ex
õõ 
)
õõ  
{
öö 
FDebug
÷÷ 
.
÷÷ 
throwException
÷÷ %
(
÷÷% &
ex
÷÷& (
)
÷÷( )
;
÷÷) *
}
øø 
finally
ùù 
{
úú 
}
üü 
}
ıı 	
public
 
void
 
reset
 
(
 
)
‚‚ 
{
ƒƒ 	
try
„„ 
{
…… 
m_fCodeLock
†† 
.
†† 
wait
††  
(
††  !
)
††! "
;
††" #
m_currentId
‡‡ 
=
‡‡ 
m_min
‡‡ #
;
‡‡# $
}
ˆˆ 
catch
‰‰ 
(
‰‰ 
	Exception
‰‰ 
ex
‰‰ 
)
‰‰  
{
ŠŠ 
FDebug
‹‹ 
.
‹‹ 
throwException
‹‹ %
(
‹‹% &
ex
‹‹& (
)
‹‹( )
;
‹‹) *
}
ŒŒ 
finally
 
{
 
m_fCodeLock
 
.
 
set
 
(
  
)
  !
;
! "
}
 
}
‘‘ 	
public
•• 
void
•• 
reset
•• 
(
•• 
UInt64
–– 
	currentId
–– 
)
—— 
{
˜˜ 	
try
™™ 
{
šš 
m_fCodeLock
›› 
.
›› 
wait
››  
(
››  !
)
››! "
;
››" #
m_currentId
œœ 
=
œœ 
	currentId
œœ '
;
œœ' (
}
 
catch
 
(
 
	Exception
 
ex
 
)
  
{
ŸŸ 
FDebug
   
.
   
throwException
   %
(
  % &
ex
  & (
)
  ( )
;
  ) *
}
¡¡ 
finally
¢¢ 
{
££ 
m_fCodeLock
¤¤ 
.
¤¤ 
set
¤¤ 
(
¤¤  
)
¤¤  !
;
¤¤! "
}
¥¥ 
}
¦¦ 	
public
ªª 
void
ªª 
reset
ªª 
(
ªª 
UInt64
«« 
min
«« 
,
«« 
UInt64
¬¬ 
max
¬¬ 
,
¬¬ 
UInt64
­­ 
	currentId
­­ 
)
®® 
{
¯¯ 	
try
°° 
{
±± 
m_fCodeLock
²² 
.
²² 
wait
²²  
(
²²  !
)
²²! "
;
²²" #
m_min
³³ 
=
³³ 
min
³³ 
;
³³ 
m_max
´´ 
=
´´ 
max
´´ 
;
´´ 
m_currentId
µµ 
=
µµ 
	currentId
µµ '
;
µµ' (
}
¶¶ 
catch
·· 
(
·· 
	Exception
·· 
ex
·· 
)
··  
{
¸¸ 
FDebug
¹¹ 
.
¹¹ 
throwException
¹¹ %
(
¹¹% &
ex
¹¹& (
)
¹¹( )
;
¹¹) *
}
ºº 
finally
»» 
{
¼¼ 
m_fCodeLock
½½ 
.
½½ 
set
½½ 
(
½½  
)
½½  !
;
½½! "
}
¾¾ 
}
¿¿ 	
}
ÅÅ 
}ÆÆ ˆ$
\D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Graphics\c_FGraphics.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

static 
class 
	FGraphics !
{ 
static 
	FGraphics 
( 
) 
{ 	
}!! 	
public// 
static// 
GraphicsPath// "!
calculateGraphicsPath//# 8
(//8 9
Bitmap00 
bitmap00 
,00 
int11 
startX11 
,11 
int22 
startY22 
)33 
{44 	
GraphicsPath55 
gp55 
=55 
null55 "
;55" #
Color66 
color66 
;66 
int77 
opCol77 
=77 
$num77 
;77 
int88 
nextCol88 
=88 
$num88 
;88 
try:: 
{;; 
gp<< 
=<< 
new<< 
GraphicsPath<< %
(<<% &
)<<& '
;<<' (
colorBB 
=BB 
bitmapBB 
.BB 
GetPixelBB '
(BB' (
$numBB( )
,BB) *
$numBB+ ,
)BB, -
;BB- .
forGG 
(GG 
intGG 
rowGG 
=GG 
$numGG  
;GG  !
rowGG" %
<GG& '
bitmapGG( .
.GG. /
HeightGG/ 5
;GG5 6
rowGG7 :
++GG: <
)GG< =
{HH 
opColII 
=II 
$numII 
;II 
forNN 
(NN 
intNN 
colNN  
=NN! "
$numNN# $
;NN$ %
colNN& )
<NN* +
bitmapNN, 2
.NN2 3
WidthNN3 8
;NN8 9
colNN: =
++NN= ?
)NN? @
{OO 
ifPP 
(PP 
bitmapPP "
.PP" #
GetPixelPP# +
(PP+ ,
colPP, /
,PP/ 0
rowPP1 4
)PP4 5
!=PP6 8
colorPP9 >
)PP> ?
{QQ 
opColRR !
=RR" #
colRR$ '
;RR' (
forSS 
(SS  !
nextColSS! (
=SS) *
opColSS+ 0
;SS0 1
nextColSS2 9
<SS: ;
bitmapSS< B
.SSB C
WidthSSC H
;SSH I
nextColSSJ Q
++SSQ S
)SSS T
{TT 
ifUU  "
(UU# $
bitmapUU$ *
.UU* +
GetPixelUU+ 3
(UU3 4
nextColUU4 ;
,UU; <
rowUU= @
)UU@ A
==UUB D
colorUUE J
)UUJ K
breakVV$ )
;VV) *
}WW 
gpYY 
.YY 
AddRectangleYY +
(YY+ ,
newYY, /
	RectangleYY0 9
(YY9 :
opColYY: ?
+YY@ A
startXYYB H
,YYH I
rowYYJ M
+YYN O
startYYYP V
,YYV W
nextColYYX _
-YY` a
opColYYb g
,YYg h
$numYYi j
)YYj k
)YYk l
;YYl m
colZZ 
=ZZ  !
nextColZZ" )
;ZZ) *
}[[ 
}\\ 
}]] 
return__ 
gp__ 
;__ 
}`` 
catchaa 
(aa 
	Exceptionaa 
exaa 
)aa  
{bb 
FDebugcc 
.cc 
throwExceptioncc %
(cc% &
excc& (
)cc( )
;cc) *
}dd 
finallyee 
{ff 
}hh 
returnii 
nullii 
;ii 
}jj 	
publicnn 
staticnn 
GraphicsPathnn "!
calculateGraphicsPathnn# 8
(nn8 9
Bitmapoo 
bitmapoo 
)pp 
{qq 	
tryrr 
{ss 
returnww !
calculateGraphicsPathww ,
(ww, -
bitmapww- 3
,ww3 4
$numww5 6
,ww6 7
$numww8 9
)ww9 :
;ww: ;
}xx 
catchyy 
(yy 
	Exceptionyy 
exyy 
)yy  
{zz 
FDebug{{ 
.{{ 
throwException{{ %
({{% &
ex{{& (
){{( )
;{{) *
}|| 
finally}} 
{~~ 
}
€€ 
return
 
null
 
;
 
}
‚‚ 	
}
ˆˆ 
}‰‰ ©õ	
`D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\NativeAPIs\c_FNativeAPIs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
System 
. 
Security 
. )
SuppressUnmanagedCodeSecurity 2
]2 3
[ 
System 
. 
Runtime 
. 
InteropServices #
.# $

ComVisible$ .
(. /
false/ 4
)4 5
]5 6
public 

static 
class 
FNativeAPIs #
{ 
public 
const 
int 
RESOURCETYPE_DISK *
=+ ,
$num- 1
;1 2
public 
const 
int 
STD_INPUT_HANDLE )
=* +
-, -
$num- /
;/ 0
public   
const   
int   
QuickEditMode   &
=  ' (
$num  ) +
;  + ,
public!! 
const!! 
int!! 
ExtendedFlags!! &
=!!' (
$num!!) ,
;!!, -
public%% 
const%% 
uint%% 
SC_CLOSE%% "
=%%# $
$num%%% +
;%%+ ,
public** 
const** 
uint** 

MF_ENABLED** $
=**% &
$num**' 1
;**1 2
public// 
const// 
uint// 

MF_DISABLE// $
=//% &
$num//' 1
;//1 2
static44 
FNativeAPIs44 
(44 
)55 
{66 	
}88 	
public@@ 
enum@@ 
FWinMsgs@@ 
:@@ 
int@@ "
{AA 	
WM_NULLBB 
=BB 
$numBB 
,BB 
	WM_CREATECC 
=CC 
$numCC 
,CC 

WM_DESTROYDD 
=DD 
$numDD 
,DD  
WM_MOVEEE 
=EE 
$numEE 
,EE 
WM_SIZEFF 
=FF 
$numFF 
,FF 
WM_ACTIVATEGG 
=GG 
$numGG  
,GG  !
WM_SETFOCUSHH 
=HH 
$numHH  
,HH  !
WM_KILLFOCUSII 
=II 
$numII !
,II! "
	WM_ENABLEJJ 
=JJ 
$numJJ 
,JJ 
WM_SETREDRAWKK 
=KK 
$numKK !
,KK! "

WM_SETTEXTLL 
=LL 
$numLL 
,LL  

WM_GETTEXTMM 
=MM 
$numMM 
,MM  
WM_GETTEXTLENGTHNN 
=NN 
$numNN %
,NN% &
WM_PAINTOO 
=OO 
$numOO 
,OO 
WM_CLOSEPP 
=PP 
$numPP 
,PP 
WM_QUERYENDSESSIONQQ 
=QQ  
$numQQ! '
,QQ' (
WM_QUERYOPENRR 
=RR 
$numRR !
,RR! "
WM_ENDSESSIONSS 
=SS 
$numSS "
,SS" #
WM_QUITTT 
=TT 
$numTT 
,TT 
WM_ERASEBKGNDUU 
=UU 
$numUU "
,UU" #
WM_SYSCOLORCHANGEVV 
=VV 
$numVV  &
,VV& '
WM_SHOWWINDOWWW 
=WW 
$numWW "
,WW" #
WM_WININICHANGEXX 
=XX 
$numXX $
,XX$ %
WM_SETTINGCHANGEYY 
=YY 
$numYY %
,YY% &
WM_DEVMODECHANGEZZ 
=ZZ 
$numZZ %
,ZZ% &
WM_ACTIVATEAPP[[ 
=[[ 
$num[[ #
,[[# $
WM_FONTCHANGE\\ 
=\\ 
$num\\ "
,\\" #
WM_TIMECHANGE]] 
=]] 
$num]] "
,]]" #
WM_CANCELMODE^^ 
=^^ 
$num^^ "
,^^" #
WM_SETCURSOR__ 
=__ 
$num__ !
,__! "
WM_MOUSEACTIVATE`` 
=`` 
$num`` %
,``% &
WM_CHILDACTIVATEaa 
=aa 
$numaa %
,aa% &
WM_QUEUESYNCbb 
=bb 
$numbb !
,bb! "
WM_GETMINMAXINFOcc 
=cc 
$numcc %
,cc% &
WM_PAINTICONdd 
=dd 
$numdd !
,dd! "
WM_ICONERASEBKGNDee 
=ee 
$numee  &
,ee& '
WM_NEXTDLGCTLff 
=ff 
$numff "
,ff" #
WM_SPOOLERSTATUSgg 
=gg 
$numgg %
,gg% &
WM_DRAWITEMhh 
=hh 
$numhh  
,hh  !
WM_MEASUREITEMii 
=ii 
$numii #
,ii# $
WM_DELETEITEMjj 
=jj 
$numjj "
,jj" #
WM_VKEYTOITEMkk 
=kk 
$numkk "
,kk" #
WM_CHARTOITEMll 
=ll 
$numll "
,ll" #

WM_SETFONTmm 
=mm 
$nummm 
,mm  

WM_GETFONTnn 
=nn 
$numnn 
,nn  
WM_SETHOTKEYoo 
=oo 
$numoo !
,oo! "
WM_GETHOTKEYpp 
=pp 
$numpp !
,pp! "
WM_QUERYDRAGICONqq 
=qq 
$numqq %
,qq% &
WM_COMPAREITEMrr 
=rr 
$numrr #
,rr# $
WM_GETOBJECTss 
=ss 
$numss !
,ss! "
WM_COMPACTINGtt 
=tt 
$numtt "
,tt" #
WM_COMMNOTIFYuu 
=uu 
$numuu "
,uu" # 
WM_WINDOWPOSCHANGINGvv  
=vv! "
$numvv# )
,vv) *
WM_WINDOWPOSCHANGEDww 
=ww  !
$numww" (
,ww( )
WM_POWERxx 
=xx 
$numxx 
,xx 
WM_COPYDATAyy 
=yy 
$numyy  
,yy  !
WM_CANCELJOURNALzz 
=zz 
$numzz %
,zz% &
	WM_NOTIFY{{ 
={{ 
$num{{ 
,{{ %
WM_INPUTLANGCHANGEREQUEST|| %
=||& '
$num||( .
,||. /
WM_INPUTLANGCHANGE}} 
=}}  
$num}}! '
,}}' (
WM_TCARD~~ 
=~~ 
$num~~ 
,~~ 
WM_HELP 
= 
$num 
, 
WM_USERCHANGED
€€ 
=
€€ 
$num
€€ #
,
€€# $
WM_NOTIFYFORMAT
 
=
 
$num
 $
,
$ %
WM_CONTEXTMENU
‚‚ 
=
‚‚ 
$num
‚‚ #
,
‚‚# $
WM_STYLECHANGING
ƒƒ 
=
ƒƒ 
$num
ƒƒ %
,
ƒƒ% &
WM_STYLECHANGED
„„ 
=
„„ 
$num
„„ $
,
„„$ %
WM_DISPLAYCHANGE
…… 
=
…… 
$num
…… %
,
……% &

WM_GETICON
†† 
=
†† 
$num
†† 
,
††  

WM_SETICON
‡‡ 
=
‡‡ 
$num
‡‡ 
,
‡‡  
WM_NCCREATE
ˆˆ 
=
ˆˆ 
$num
ˆˆ  
,
ˆˆ  !
WM_NCDESTROY
‰‰ 
=
‰‰ 
$num
‰‰ !
,
‰‰! "
WM_NCCALCSIZE
ŠŠ 
=
ŠŠ 
$num
ŠŠ "
,
ŠŠ" #
WM_NCHITTEST
‹‹ 
=
‹‹ 
$num
‹‹ !
,
‹‹! "

WM_NCPAINT
ŒŒ 
=
ŒŒ 
$num
ŒŒ 
,
ŒŒ  
WM_NCACTIVATE
 
=
 
$num
 "
,
" #
WM_GETDLGCODE
 
=
 
$num
 "
,
" #
WM_SYNCPAINT
 
=
 
$num
 !
,
! "
WM_NCMOUSEMOVE
 
=
 
$num
 #
,
# $
WM_NCLBUTTONDOWN
‘‘ 
=
‘‘ 
$num
‘‘ %
,
‘‘% &
WM_NCLBUTTONUP
’’ 
=
’’ 
$num
’’ #
,
’’# $ 
WM_NCLBUTTONDBLCLK
““ 
=
““  
$num
““! '
,
““' (
WM_NCRBUTTONDOWN
”” 
=
”” 
$num
”” %
,
””% &
WM_NCRBUTTONUP
•• 
=
•• 
$num
•• #
,
••# $ 
WM_NCRBUTTONDBLCLK
–– 
=
––  
$num
––! '
,
––' (
WM_NCMBUTTONDOWN
—— 
=
—— 
$num
—— %
,
——% &
WM_NCMBUTTONUP
˜˜ 
=
˜˜ 
$num
˜˜ #
,
˜˜# $ 
WM_NCMBUTTONDBLCLK
™™ 
=
™™  
$num
™™! '
,
™™' (
WM_NCXBUTTONDOWN
šš 
=
šš 
$num
šš %
,
šš% &
WM_NCXBUTTONUP
›› 
=
›› 
$num
›› #
,
››# $ 
WM_NCXBUTTONDBLCLK
œœ 
=
œœ  
$num
œœ! '
,
œœ' (
WM_INPUT
 
=
 
$num
 
,
 
WM_KEYFIRST
 
=
 
$num
  
,
  !

WM_KEYDOWN
ŸŸ 
=
ŸŸ 
$num
ŸŸ 
,
ŸŸ  
WM_KEYUP
   
=
   
$num
   
,
   
WM_CHAR
¡¡ 
=
¡¡ 
$num
¡¡ 
,
¡¡ 
WM_DEADCHAR
¢¢ 
=
¢¢ 
$num
¢¢  
,
¢¢  !
WM_SYSKEYDOWN
££ 
=
££ 
$num
££ "
,
££" #
WM_SYSKEYUP
¤¤ 
=
¤¤ 
$num
¤¤  
,
¤¤  !

WM_SYSCHAR
¥¥ 
=
¥¥ 
$num
¥¥ 
,
¥¥  
WM_SYSDEADCHAR
¦¦ 
=
¦¦ 
$num
¦¦ #
,
¦¦# $

WM_UNICHAR
§§ 
=
§§ 
$num
§§ 
,
§§  
WM_KEYLAST_NT501
¨¨ 
=
¨¨ 
$num
¨¨ %
,
¨¨% &
UNICODE_NOCHAR
©© 
=
©© 
$num
©© #
,
©©# $
WM_KEYLAST_PRE501
ªª 
=
ªª 
$num
ªª  &
,
ªª& '%
WM_IME_STARTCOMPOSITION
«« #
=
««$ %
$num
««& ,
,
««, -#
WM_IME_ENDCOMPOSITION
¬¬ !
=
¬¬" #
$num
¬¬$ *
,
¬¬* + 
WM_IME_COMPOSITION
­­ 
=
­­  
$num
­­! '
,
­­' (
WM_IME_KEYLAST
®® 
=
®® 
$num
®® #
,
®®# $
WM_INITDIALOG
¯¯ 
=
¯¯ 
$num
¯¯ "
,
¯¯" #

WM_COMMAND
°° 
=
°° 
$num
°° 
,
°°  
WM_SYSCOMMAND
±± 
=
±± 
$num
±± "
,
±±" #
WM_TIMER
²² 
=
²² 
$num
²² 
,
²² 

WM_HSCROLL
³³ 
=
³³ 
$num
³³ 
,
³³  

WM_VSCROLL
´´ 
=
´´ 
$num
´´ 
,
´´  
WM_INITMENU
µµ 
=
µµ 
$num
µµ  
,
µµ  !
WM_INITMENUPOPUP
¶¶ 
=
¶¶ 
$num
¶¶ %
,
¶¶% &
WM_MENUSELECT
·· 
=
·· 
$num
·· "
,
··" #
WM_MENUCHAR
¸¸ 
=
¸¸ 
$num
¸¸  
,
¸¸  !
WM_ENTERIDLE
¹¹ 
=
¹¹ 
$num
¹¹ !
,
¹¹! "
WM_MENURBUTTONUP
ºº 
=
ºº 
$num
ºº %
,
ºº% &
WM_MENUDRAG
»» 
=
»» 
$num
»»  
,
»»  !
WM_MENUGETOBJECT
¼¼ 
=
¼¼ 
$num
¼¼ %
,
¼¼% & 
WM_UNINITMENUPOPUP
½½ 
=
½½  
$num
½½! '
,
½½' (
WM_MENUCOMMAND
¾¾ 
=
¾¾ 
$num
¾¾ #
,
¾¾# $
WM_CHANGEUISTATE
¿¿ 
=
¿¿ 
$num
¿¿ %
,
¿¿% &
WM_UPDATEUISTATE
ÀÀ 
=
ÀÀ 
$num
ÀÀ %
,
ÀÀ% &
WM_QUERYUISTATE
ÁÁ 
=
ÁÁ 
$num
ÁÁ $
,
ÁÁ$ %
WM_CTLCOLORMSGBOX
ÂÂ 
=
ÂÂ 
$num
ÂÂ  &
,
ÂÂ& '
WM_CTLCOLOREDIT
ÃÃ 
=
ÃÃ 
$num
ÃÃ $
,
ÃÃ$ % 
WM_CTLCOLORLISTBOX
ÄÄ 
=
ÄÄ  
$num
ÄÄ! '
,
ÄÄ' (
WM_CTLCOLORBTN
ÅÅ 
=
ÅÅ 
$num
ÅÅ #
,
ÅÅ# $
WM_CTLCOLORDLG
ÆÆ 
=
ÆÆ 
$num
ÆÆ #
,
ÆÆ# $"
WM_CTLCOLORSCROLLBAR
ÇÇ  
=
ÇÇ! "
$num
ÇÇ# )
,
ÇÇ) *
WM_CTLCOLORSTATIC
ÈÈ 
=
ÈÈ 
$num
ÈÈ  &
,
ÈÈ& '
WM_MOUSEFIRST
ÉÉ 
=
ÉÉ 
$num
ÉÉ "
,
ÉÉ" #
WM_MOUSEMOVE
ÊÊ 
=
ÊÊ 
$num
ÊÊ !
,
ÊÊ! "
WM_LBUTTONDOWN
ËË 
=
ËË 
$num
ËË #
,
ËË# $
WM_LBUTTONUP
ÌÌ 
=
ÌÌ 
$num
ÌÌ !
,
ÌÌ! "
WM_LBUTTONDBLCLK
ÍÍ 
=
ÍÍ 
$num
ÍÍ %
,
ÍÍ% &
WM_RBUTTONDOWN
ÎÎ 
=
ÎÎ 
$num
ÎÎ #
,
ÎÎ# $
WM_RBUTTONUP
ÏÏ 
=
ÏÏ 
$num
ÏÏ !
,
ÏÏ! "
WM_RBUTTONDBLCLK
ĞĞ 
=
ĞĞ 
$num
ĞĞ %
,
ĞĞ% &
WM_MBUTTONDOWN
ÑÑ 
=
ÑÑ 
$num
ÑÑ #
,
ÑÑ# $
WM_MBUTTONUP
ÒÒ 
=
ÒÒ 
$num
ÒÒ !
,
ÒÒ! "
WM_MBUTTONDBLCLK
ÓÓ 
=
ÓÓ 
$num
ÓÓ %
,
ÓÓ% &
WM_MOUSEWHEEL
ÔÔ 
=
ÔÔ 
$num
ÔÔ "
,
ÔÔ" #
WM_XBUTTONDOWN
ÕÕ 
=
ÕÕ 
$num
ÕÕ #
,
ÕÕ# $
WM_XBUTTONUP
ÖÖ 
=
ÖÖ 
$num
ÖÖ !
,
ÖÖ! "
WM_XBUTTONDBLCLK
×× 
=
×× 
$num
×× %
,
××% &
WM_MOUSELAST_5
ØØ 
=
ØØ 
$num
ØØ #
,
ØØ# $
WM_MOUSELAST_4
ÙÙ 
=
ÙÙ 
$num
ÙÙ #
,
ÙÙ# $ 
WM_MOUSELAST_PRE_4
ÚÚ 
=
ÚÚ  
$num
ÚÚ! '
,
ÚÚ' (
WM_PARENTNOTIFY
ÛÛ 
=
ÛÛ 
$num
ÛÛ $
,
ÛÛ$ %
WM_ENTERMENULOOP
ÜÜ 
=
ÜÜ 
$num
ÜÜ %
,
ÜÜ% &
WM_EXITMENULOOP
İİ 
=
İİ 
$num
İİ $
,
İİ$ %
WM_NEXTMENU
ŞŞ 
=
ŞŞ 
$num
ŞŞ  
,
ŞŞ  !
	WM_SIZING
ßß 
=
ßß 
$num
ßß 
,
ßß 
WM_CAPTURECHANGED
àà 
=
àà 
$num
àà  &
,
àà& '
	WM_MOVING
áá 
=
áá 
$num
áá 
,
áá 
WM_POWERBROADCAST
ââ 
=
ââ 
$num
ââ  &
,
ââ& '
WM_DEVICECHANGE
ãã 
=
ãã 
$num
ãã $
,
ãã$ %
WM_MDICREATE
ää 
=
ää 
$num
ää !
,
ää! "
WM_MDIDESTROY
åå 
=
åå 
$num
åå "
,
åå" #
WM_MDIACTIVATE
ææ 
=
ææ 
$num
ææ #
,
ææ# $
WM_MDIRESTORE
çç 
=
çç 
$num
çç "
,
çç" #

WM_MDINEXT
èè 
=
èè 
$num
èè 
,
èè  
WM_MDIMAXIMIZE
éé 
=
éé 
$num
éé #
,
éé# $

WM_MDITILE
êê 
=
êê 
$num
êê 
,
êê  
WM_MDICASCADE
ëë 
=
ëë 
$num
ëë "
,
ëë" #
WM_MDIICONARRANGE
ìì 
=
ìì 
$num
ìì  &
,
ìì& '
WM_MDIGETACTIVE
íí 
=
íí 
$num
íí $
,
íí$ %
WM_MDISETMENU
îî 
=
îî 
$num
îî "
,
îî" #
WM_ENTERSIZEMOVE
ïï 
=
ïï 
$num
ïï %
,
ïï% &
WM_EXITSIZEMOVE
ğğ 
=
ğğ 
$num
ğğ $
,
ğğ$ %
WM_DROPFILES
ññ 
=
ññ 
$num
ññ !
,
ññ! "
WM_MDIREFRESHMENU
òò 
=
òò 
$num
òò  &
,
òò& '
WM_IME_SETCONTEXT
óó 
=
óó 
$num
óó  &
,
óó& '
WM_IME_NOTIFY
ôô 
=
ôô 
$num
ôô "
,
ôô" #
WM_IME_CONTROL
õõ 
=
õõ 
$num
õõ #
,
õõ# $$
WM_IME_COMPOSITIONFULL
öö "
=
öö# $
$num
öö% +
,
öö+ ,
WM_IME_SELECT
÷÷ 
=
÷÷ 
$num
÷÷ "
,
÷÷" #
WM_IME_CHAR
øø 
=
øø 
$num
øø  
,
øø  !
WM_IME_REQUEST
ùù 
=
ùù 
$num
ùù #
,
ùù# $
WM_IME_KEYDOWN
úú 
=
úú 
$num
úú #
,
úú# $
WM_IME_KEYUP
ûû 
=
ûû 
$num
ûû !
,
ûû! "
WM_MOUSEHOVER
üü 
=
üü 
$num
üü "
,
üü" #
WM_MOUSELEAVE
ıı 
=
ıı 
$num
ıı "
,
ıı" #
WM_NCMOUSEHOVER
şş 
=
şş 
$num
şş $
,
şş$ %
WM_NCMOUSELEAVE
ÿÿ 
=
ÿÿ 
$num
ÿÿ $
,
ÿÿ$ %"
WM_WTSSESSION_CHANGE
€€  
=
€€! "
$num
€€# )
,
€€) *
WM_TABLET_FIRST
 
=
 
$num
 $
,
$ %
WM_TABLET_LAST
‚‚ 
=
‚‚ 
$num
‚‚ #
,
‚‚# $
WM_CUT
ƒƒ 
=
ƒƒ 
$num
ƒƒ 
,
ƒƒ 
WM_COPY
„„ 
=
„„ 
$num
„„ 
,
„„ 
WM_PASTE
…… 
=
…… 
$num
…… 
,
…… 
WM_CLEAR
†† 
=
†† 
$num
†† 
,
†† 
WM_UNDO
‡‡ 
=
‡‡ 
$num
‡‡ 
,
‡‡ 
WM_RENDERFORMAT
ˆˆ 
=
ˆˆ 
$num
ˆˆ $
,
ˆˆ$ %!
WM_RENDERALLFORMATS
‰‰ 
=
‰‰  !
$num
‰‰" (
,
‰‰( )!
WM_DESTROYCLIPBOARD
ŠŠ 
=
ŠŠ  !
$num
ŠŠ" (
,
ŠŠ( )
WM_DRAWCLIPBOARD
‹‹ 
=
‹‹ 
$num
‹‹ %
,
‹‹% &
WM_PAINTCLIPBOARD
ŒŒ 
=
ŒŒ 
$num
ŒŒ  &
,
ŒŒ& '!
WM_VSCROLLCLIPBOARD
 
=
  !
$num
" (
,
( )
WM_SIZECLIPBOARD
 
=
 
$num
 %
,
% & 
WM_ASKCBFORMATNAME
 
=
  
$num
! '
,
' (
WM_CHANGECBCHAIN
 
=
 
$num
 %
,
% &!
WM_HSCROLLCLIPBOARD
‘‘ 
=
‘‘  !
$num
‘‘" (
,
‘‘( ) 
WM_QUERYNEWPALETTE
’’ 
=
’’  
$num
’’! '
,
’’' ("
WM_PALETTEISCHANGING
““  
=
““! "
$num
““# )
,
““) *
WM_PALETTECHANGED
”” 
=
”” 
$num
””  &
,
””& '
	WM_HOTKEY
•• 
=
•• 
$num
•• 
,
•• 
WM_PRINT
–– 
=
–– 
$num
–– 
,
–– 
WM_PRINTCLIENT
—— 
=
—— 
$num
—— #
,
——# $
WM_APPCOMMAND
˜˜ 
=
˜˜ 
$num
˜˜ "
,
˜˜" #
WM_THEMECHANGED
™™ 
=
™™ 
$num
™™ $
,
™™$ %
WM_HANDHELDFIRST
šš 
=
šš 
$num
šš %
,
šš% &
WM_HANDHELDLAST
›› 
=
›› 
$num
›› $
,
››$ %
WM_AFXFIRST
œœ 
=
œœ 
$num
œœ  
,
œœ  !

WM_AFXLAST
 
=
 
$num
 
,
  
WM_PENWINFIRST
 
=
 
$num
 #
,
# $
WM_PENWINLAST
ŸŸ 
=
ŸŸ 
$num
ŸŸ "
,
ŸŸ" #
WM_APP
   
=
   
$num
   
,
   
WM_USER
¡¡ 
=
¡¡ 
$num
¡¡ 
,
¡¡ 
	EM_GETSEL
¢¢ 
=
¢¢ 
$num
¢¢ 
,
¢¢ 
	EM_SETSEL
££ 
=
££ 
$num
££ 
,
££ 

EM_GETRECT
¤¤ 
=
¤¤ 
$num
¤¤ 
,
¤¤  

EM_SETRECT
¥¥ 
=
¥¥ 
$num
¥¥ 
,
¥¥  
EM_SETRECTNP
¦¦ 
=
¦¦ 
$num
¦¦ !
,
¦¦! "
	EM_SCROLL
§§ 
=
§§ 
$num
§§ 
,
§§ 
EM_LINESCROLL
¨¨ 
=
¨¨ 
$num
¨¨ "
,
¨¨" #
EM_SCROLLCARET
©© 
=
©© 
$num
©© #
,
©©# $
EM_GETMODIFY
ªª 
=
ªª 
$num
ªª !
,
ªª! "
EM_SETMODIFY
«« 
=
«« 
$num
«« !
,
««! "
EM_GETLINECOUNT
¬¬ 
=
¬¬ 
$num
¬¬ $
,
¬¬$ %
EM_LINEINDEX
­­ 
=
­­ 
$num
­­ !
,
­­! "
EM_SETHANDLE
®® 
=
®® 
$num
®® !
,
®®! "
EM_GETHANDLE
¯¯ 
=
¯¯ 
$num
¯¯ !
,
¯¯! "
EM_GETTHUMB
°° 
=
°° 
$num
°°  
,
°°  !
EM_LINELENGTH
±± 
=
±± 
$num
±± "
,
±±" #
EM_REPLACESEL
²² 
=
²² 
$num
²² "
,
²²" #

EM_GETLINE
³³ 
=
³³ 
$num
³³ 
,
³³  
EM_LIMITTEXT
´´ 
=
´´ 
$num
´´ !
,
´´! "

EM_CANUNDO
µµ 
=
µµ 
$num
µµ 
,
µµ  
EM_UNDO
¶¶ 
=
¶¶ 
$num
¶¶ 
,
¶¶ 
EM_FMTLINES
·· 
=
·· 
$num
··  
,
··  !
EM_LINEFROMCHAR
¸¸ 
=
¸¸ 
$num
¸¸ $
,
¸¸$ %
EM_SETTABSTOPS
¹¹ 
=
¹¹ 
$num
¹¹ #
,
¹¹# $ 
EM_SETPASSWORDCHAR
ºº 
=
ºº  
$num
ºº! '
,
ºº' ( 
EM_EMPTYUNDOBUFFER
»» 
=
»»  
$num
»»! '
,
»»' ($
EM_GETFIRSTVISIBLELINE
¼¼ "
=
¼¼# $
$num
¼¼% +
,
¼¼+ ,
EM_SETREADONLY
½½ 
=
½½ 
$num
½½ #
,
½½# $!
EM_SETWORDBREAKPROC
¾¾ 
=
¾¾  !
$num
¾¾" (
,
¾¾( )!
EM_GETWORDBREAKPROC
¿¿ 
=
¿¿  !
$num
¿¿" (
,
¿¿( ) 
EM_GETPASSWORDCHAR
ÀÀ 
=
ÀÀ  
$num
ÀÀ! '
,
ÀÀ' (
EM_SETMARGINS
ÁÁ 
=
ÁÁ 
$num
ÁÁ "
,
ÁÁ" #
EM_GETMARGINS
ÂÂ 
=
ÂÂ 
$num
ÂÂ "
,
ÂÂ" #
EM_SETLIMITTEXT
ÃÃ 
=
ÃÃ 
EM_LIMITTEXT
ÃÃ *
,
ÃÃ* +
EM_GETLIMITTEXT
ÄÄ 
=
ÄÄ 
$num
ÄÄ $
,
ÄÄ$ %
EM_POSFROMCHAR
ÅÅ 
=
ÅÅ 
$num
ÅÅ #
,
ÅÅ# $
EM_CHARFROMPOS
ÆÆ 
=
ÆÆ 
$num
ÆÆ #
,
ÆÆ# $
EM_SETIMESTATUS
ÇÇ 
=
ÇÇ 
$num
ÇÇ $
,
ÇÇ$ %
EM_GETIMESTATUS
ÈÈ 
=
ÈÈ 
$num
ÈÈ $
,
ÈÈ$ %
BM_GETCHECK
ÉÉ 
=
ÉÉ 
$num
ÉÉ  
,
ÉÉ  !
BM_SETCHECK
ÊÊ 
=
ÊÊ 
$num
ÊÊ  
,
ÊÊ  !
BM_GETSTATE
ËË 
=
ËË 
$num
ËË  
,
ËË  !
BM_SETSTATE
ÌÌ 
=
ÌÌ 
$num
ÌÌ  
,
ÌÌ  !
BM_SETSTYLE
ÍÍ 
=
ÍÍ 
$num
ÍÍ  
,
ÍÍ  !
BM_CLICK
ÎÎ 
=
ÎÎ 
$num
ÎÎ 
,
ÎÎ 
BM_GETIMAGE
ÏÏ 
=
ÏÏ 
$num
ÏÏ  
,
ÏÏ  !
BM_SETIMAGE
ĞĞ 
=
ĞĞ 
$num
ĞĞ  
,
ĞĞ  !
STM_SETICON
ÑÑ 
=
ÑÑ 
$num
ÑÑ  
,
ÑÑ  !
STM_GETICON
ÒÒ 
=
ÒÒ 
$num
ÒÒ  
,
ÒÒ  !
STM_SETIMAGE
ÓÓ 
=
ÓÓ 
$num
ÓÓ !
,
ÓÓ! "
STM_GETIMAGE
ÔÔ 
=
ÔÔ 
$num
ÔÔ !
,
ÔÔ! "

STM_MSGMAX
ÕÕ 
=
ÕÕ 
$num
ÕÕ 
,
ÕÕ  
DM_GETDEFID
ÖÖ 
=
ÖÖ 
(
ÖÖ 
WM_USER
ÖÖ "
+
ÖÖ# $
$num
ÖÖ% &
)
ÖÖ& '
,
ÖÖ' (
DM_SETDEFID
×× 
=
×× 
(
×× 
WM_USER
×× "
+
××# $
$num
××% &
)
××& '
,
××' (
DM_REPOSITION
ØØ 
=
ØØ 
(
ØØ 
WM_USER
ØØ $
+
ØØ% &
$num
ØØ' (
)
ØØ( )
,
ØØ) *
LB_ADDSTRING
ÙÙ 
=
ÙÙ 
$num
ÙÙ !
,
ÙÙ! "
LB_INSERTSTRING
ÚÚ 
=
ÚÚ 
$num
ÚÚ $
,
ÚÚ$ %
LB_DELETESTRING
ÛÛ 
=
ÛÛ 
$num
ÛÛ $
,
ÛÛ$ %
LB_SELITEMRANGEEX
ÜÜ 
=
ÜÜ 
$num
ÜÜ  &
,
ÜÜ& '
LB_RESETCONTENT
İİ 
=
İİ 
$num
İİ $
,
İİ$ %
	LB_SETSEL
ŞŞ 
=
ŞŞ 
$num
ŞŞ 
,
ŞŞ 
LB_SETCURSEL
ßß 
=
ßß 
$num
ßß !
,
ßß! "
	LB_GETSEL
àà 
=
àà 
$num
àà 
,
àà 
LB_GETCURSEL
áá 
=
áá 
$num
áá !
,
áá! "

LB_GETTEXT
ââ 
=
ââ 
$num
ââ 
,
ââ  
LB_GETTEXTLEN
ãã 
=
ãã 
$num
ãã "
,
ãã" #
LB_GETCOUNT
ää 
=
ää 
$num
ää  
,
ää  !
LB_SELECTSTRING
åå 
=
åå 
$num
åå $
,
åå$ %
LB_DIR
ææ 
=
ææ 
$num
ææ 
,
ææ 
LB_GETTOPINDEX
çç 
=
çç 
$num
çç #
,
çç# $
LB_FINDSTRING
èè 
=
èè 
$num
èè "
,
èè" #
LB_GETSELCOUNT
éé 
=
éé 
$num
éé #
,
éé# $
LB_GETSELITEMS
êê 
=
êê 
$num
êê #
,
êê# $
LB_SETTABSTOPS
ëë 
=
ëë 
$num
ëë #
,
ëë# $$
LB_GETHORIZONTALEXTENT
ìì "
=
ìì# $
$num
ìì% +
,
ìì+ ,$
LB_SETHORIZONTALEXTENT
íí "
=
íí# $
$num
íí% +
,
íí+ ,
LB_SETCOLUMNWIDTH
îî 
=
îî 
$num
îî  &
,
îî& '

LB_ADDFILE
ïï 
=
ïï 
$num
ïï 
,
ïï  
LB_SETTOPINDEX
ğğ 
=
ğğ 
$num
ğğ #
,
ğğ# $
LB_GETITEMRECT
ññ 
=
ññ 
$num
ññ #
,
ññ# $
LB_GETITEMDATA
òò 
=
òò 
$num
òò #
,
òò# $
LB_SETITEMDATA
óó 
=
óó 
$num
óó #
,
óó# $
LB_SELITEMRANGE
ôô 
=
ôô 
$num
ôô $
,
ôô$ %
LB_SETANCHORINDEX
õõ 
=
õõ 
$num
õõ  &
,
õõ& '
LB_GETANCHORINDEX
öö 
=
öö 
$num
öö  &
,
öö& '
LB_SETCARETINDEX
÷÷ 
=
÷÷ 
$num
÷÷ %
,
÷÷% &
LB_GETCARETINDEX
øø 
=
øø 
$num
øø %
,
øø% &
LB_SETITEMHEIGHT
ùù 
=
ùù 
$num
ùù %
,
ùù% &
LB_GETITEMHEIGHT
úú 
=
úú 
$num
úú %
,
úú% & 
LB_FINDSTRINGEXACT
ûû 
=
ûû  
$num
ûû! '
,
ûû' (
LB_SETLOCALE
üü 
=
üü 
$num
üü !
,
üü! "
LB_GETLOCALE
ıı 
=
ıı 
$num
ıı !
,
ıı! "
LB_SETCOUNT
şş 
=
şş 
$num
şş  
,
şş  !
LB_INITSTORAGE
ÿÿ 
=
ÿÿ 
$num
ÿÿ #
,
ÿÿ# $
LB_ITEMFROMPOINT
€€ 
=
€€ 
$num
€€ %
,
€€% &"
LB_MULTIPLEADDSTRING
  
=
! "
$num
# )
,
) *
LB_GETLISTBOXINFO
‚‚ 
=
‚‚ 
$num
‚‚  &
,
‚‚& '
LB_MSGMAX_501
ƒƒ 
=
ƒƒ 
$num
ƒƒ "
,
ƒƒ" #
LB_MSGMAX_WCE4
„„ 
=
„„ 
$num
„„ #
,
„„# $
LB_MSGMAX_4
…… 
=
…… 
$num
……  
,
……  !
LB_MSGMAX_PRE4
†† 
=
†† 
$num
†† #
,
††# $
CB_GETEDITSEL
‡‡ 
=
‡‡ 
$num
‡‡ "
,
‡‡" #
CB_LIMITTEXT
ˆˆ 
=
ˆˆ 
$num
ˆˆ !
,
ˆˆ! "
CB_SETEDITSEL
‰‰ 
=
‰‰ 
$num
‰‰ "
,
‰‰" #
CB_ADDSTRING
ŠŠ 
=
ŠŠ 
$num
ŠŠ !
,
ŠŠ! "
CB_DELETESTRING
‹‹ 
=
‹‹ 
$num
‹‹ $
,
‹‹$ %
CB_DIR
ŒŒ 
=
ŒŒ 
$num
ŒŒ 
,
ŒŒ 
CB_GETCOUNT
 
=
 
$num
  
,
  !
CB_GETCURSEL
 
=
 
$num
 !
,
! "
CB_GETLBTEXT
 
=
 
$num
 !
,
! "
CB_GETLBTEXTLEN
 
=
 
$num
 $
,
$ %
CB_INSERTSTRING
‘‘ 
=
‘‘ 
$num
‘‘ $
,
‘‘$ %
CB_RESETCONTENT
’’ 
=
’’ 
$num
’’ $
,
’’$ %
CB_FINDSTRING
““ 
=
““ 
$num
““ "
,
““" #
CB_SELECTSTRING
”” 
=
”” 
$num
”” $
,
””$ %
CB_SETCURSEL
•• 
=
•• 
$num
•• !
,
••! "
CB_SHOWDROPDOWN
–– 
=
–– 
$num
–– $
,
––$ %
CB_GETITEMDATA
—— 
=
—— 
$num
—— #
,
——# $
CB_SETITEMDATA
˜˜ 
=
˜˜ 
$num
˜˜ #
,
˜˜# $&
CB_GETDROPPEDCONTROLRECT
™™ $
=
™™% &
$num
™™' -
,
™™- .
CB_SETITEMHEIGHT
šš 
=
šš 
$num
šš %
,
šš% &
CB_GETITEMHEIGHT
›› 
=
›› 
$num
›› %
,
››% &
CB_SETEXTENDEDUI
œœ 
=
œœ 
$num
œœ %
,
œœ% &
CB_GETEXTENDEDUI
 
=
 
$num
 %
,
% & 
CB_GETDROPPEDSTATE
 
=
  
$num
! '
,
' ( 
CB_FINDSTRINGEXACT
ŸŸ 
=
ŸŸ  
$num
ŸŸ! '
,
ŸŸ' (
CB_SETLOCALE
   
=
   
$num
   !
,
  ! "
CB_GETLOCALE
¡¡ 
=
¡¡ 
$num
¡¡ !
,
¡¡! "
CB_GETTOPINDEX
¢¢ 
=
¢¢ 
$num
¢¢ #
,
¢¢# $
CB_SETTOPINDEX
££ 
=
££ 
$num
££ #
,
££# $$
CB_GETHORIZONTALEXTENT
¤¤ "
=
¤¤# $
$num
¤¤% +
,
¤¤+ ,$
CB_SETHORIZONTALEXTENT
¥¥ "
=
¥¥# $
$num
¥¥% +
,
¥¥+ , 
CB_GETDROPPEDWIDTH
¦¦ 
=
¦¦  
$num
¦¦! '
,
¦¦' ( 
CB_SETDROPPEDWIDTH
§§ 
=
§§  
$num
§§! '
,
§§' (
CB_INITSTORAGE
¨¨ 
=
¨¨ 
$num
¨¨ #
,
¨¨# $"
CB_MULTIPLEADDSTRING
©©  
=
©©! "
$num
©©# )
,
©©) * 
CB_GETCOMBOBOXINFO
ªª 
=
ªª  
$num
ªª! '
,
ªª' (
CB_MSGMAX_501
«« 
=
«« 
$num
«« "
,
««" #
CB_MSGMAX_WCE400
¬¬ 
=
¬¬ 
$num
¬¬ %
,
¬¬% &
CB_MSGMAX_400
­­ 
=
­­ 
$num
­­ "
,
­­" #
CB_MSGMAX_PRE400
®® 
=
®® 
$num
®® %
,
®®% &

SBM_SETPOS
¯¯ 
=
¯¯ 
$num
¯¯ 
,
¯¯  

SBM_GETPOS
°° 
=
°° 
$num
°° 
,
°°  
SBM_SETRANGE
±± 
=
±± 
$num
±± !
,
±±! " 
SBM_SETRANGEREDRAW
²² 
=
²²  
$num
²²! '
,
²²' (
SBM_GETRANGE
³³ 
=
³³ 
$num
³³ !
,
³³! "
SBM_ENABLE_ARROWS
´´ 
=
´´ 
$num
´´  &
,
´´& '
SBM_SETSCROLLINFO
µµ 
=
µµ 
$num
µµ  &
,
µµ& '
SBM_GETSCROLLINFO
¶¶ 
=
¶¶ 
$num
¶¶  &
,
¶¶& '"
SBM_GETSCROLLBARINFO
··  
=
··! "
$num
··# )
,
··) *
	LVM_FIRST
¸¸ 
=
¸¸ 
$num
¸¸ 
,
¸¸ 
TV_FIRST
¹¹ 
=
¹¹ 
$num
¹¹ 
,
¹¹ 
	HDM_FIRST
ºº 
=
ºº 
$num
ºº 
,
ºº 
	TCM_FIRST
»» 
=
»» 
$num
»» 
,
»» 
	PGM_FIRST
¼¼ 
=
¼¼ 
$num
¼¼ 
,
¼¼ 
	ECM_FIRST
½½ 
=
½½ 
$num
½½ 
,
½½ 
	BCM_FIRST
¾¾ 
=
¾¾ 
$num
¾¾ 
,
¾¾ 
	CBM_FIRST
¿¿ 
=
¿¿ 
$num
¿¿ 
,
¿¿ 
	CCM_FIRST
ÀÀ 
=
ÀÀ 
$num
ÀÀ 
,
ÀÀ 
CCM_LAST
ÁÁ 
=
ÁÁ 
(
ÁÁ 
	CCM_FIRST
ÁÁ !
+
ÁÁ" #
$num
ÁÁ$ )
)
ÁÁ) *
,
ÁÁ* +
CCM_SETBKCOLOR
ÂÂ 
=
ÂÂ 
(
ÂÂ 
	CCM_FIRST
ÂÂ '
+
ÂÂ( )
$num
ÂÂ* +
)
ÂÂ+ ,
,
ÂÂ, - 
CCM_SETCOLORSCHEME
ÃÃ 
=
ÃÃ  
(
ÃÃ! "
	CCM_FIRST
ÃÃ" +
+
ÃÃ, -
$num
ÃÃ. /
)
ÃÃ/ 0
,
ÃÃ0 1 
CCM_GETCOLORSCHEME
ÄÄ 
=
ÄÄ  
(
ÄÄ! "
	CCM_FIRST
ÄÄ" +
+
ÄÄ, -
$num
ÄÄ. /
)
ÄÄ/ 0
,
ÄÄ0 1
CCM_GETDROPTARGET
ÅÅ 
=
ÅÅ 
(
ÅÅ  !
	CCM_FIRST
ÅÅ! *
+
ÅÅ+ ,
$num
ÅÅ- .
)
ÅÅ. /
,
ÅÅ/ 0"
CCM_SETUNICODEFORMAT
ÆÆ  
=
ÆÆ! "
(
ÆÆ# $
	CCM_FIRST
ÆÆ$ -
+
ÆÆ. /
$num
ÆÆ0 1
)
ÆÆ1 2
,
ÆÆ2 3"
CCM_GETUNICODEFORMAT
ÇÇ  
=
ÇÇ! "
(
ÇÇ# $
	CCM_FIRST
ÇÇ$ -
+
ÇÇ. /
$num
ÇÇ0 1
)
ÇÇ1 2
,
ÇÇ2 3
CCM_SETVERSION
ÈÈ 
=
ÈÈ 
(
ÈÈ 
	CCM_FIRST
ÈÈ '
+
ÈÈ( )
$num
ÈÈ* -
)
ÈÈ- .
,
ÈÈ. /
CCM_GETVERSION
ÉÉ 
=
ÉÉ 
(
ÉÉ 
	CCM_FIRST
ÉÉ '
+
ÉÉ( )
$num
ÉÉ* -
)
ÉÉ- .
,
ÉÉ. /!
CCM_SETNOTIFYWINDOW
ÊÊ 
=
ÊÊ  !
(
ÊÊ" #
	CCM_FIRST
ÊÊ# ,
+
ÊÊ- .
$num
ÊÊ/ 2
)
ÊÊ2 3
,
ÊÊ3 4 
CCM_SETWINDOWTHEME
ËË 
=
ËË  
(
ËË! "
	CCM_FIRST
ËË" +
+
ËË, -
$num
ËË. 1
)
ËË1 2
,
ËË2 3
CCM_DPISCALE
ÌÌ 
=
ÌÌ 
(
ÌÌ 
	CCM_FIRST
ÌÌ %
+
ÌÌ& '
$num
ÌÌ( +
)
ÌÌ+ ,
,
ÌÌ, -
HDM_GETITEMCOUNT
ÍÍ 
=
ÍÍ 
(
ÍÍ  
	HDM_FIRST
ÍÍ  )
+
ÍÍ* +
$num
ÍÍ, -
)
ÍÍ- .
,
ÍÍ. /
HDM_INSERTITEMA
ÎÎ 
=
ÎÎ 
(
ÎÎ 
	HDM_FIRST
ÎÎ (
+
ÎÎ) *
$num
ÎÎ+ ,
)
ÎÎ, -
,
ÎÎ- .
HDM_INSERTITEMW
ÏÏ 
=
ÏÏ 
(
ÏÏ 
	HDM_FIRST
ÏÏ (
+
ÏÏ) *
$num
ÏÏ+ -
)
ÏÏ- .
,
ÏÏ. /
HDM_DELETEITEM
ĞĞ 
=
ĞĞ 
(
ĞĞ 
	HDM_FIRST
ĞĞ '
+
ĞĞ( )
$num
ĞĞ* +
)
ĞĞ+ ,
,
ĞĞ, -
HDM_GETITEMA
ÑÑ 
=
ÑÑ 
(
ÑÑ 
	HDM_FIRST
ÑÑ %
+
ÑÑ& '
$num
ÑÑ( )
)
ÑÑ) *
,
ÑÑ* +
HDM_GETITEMW
ÒÒ 
=
ÒÒ 
(
ÒÒ 
	HDM_FIRST
ÒÒ %
+
ÒÒ& '
$num
ÒÒ( *
)
ÒÒ* +
,
ÒÒ+ ,
HDM_SETITEMA
ÓÓ 
=
ÓÓ 
(
ÓÓ 
	HDM_FIRST
ÓÓ %
+
ÓÓ& '
$num
ÓÓ( )
)
ÓÓ) *
,
ÓÓ* +
HDM_SETITEMW
ÔÔ 
=
ÔÔ 
(
ÔÔ 
	HDM_FIRST
ÔÔ %
+
ÔÔ& '
$num
ÔÔ( *
)
ÔÔ* +
,
ÔÔ+ ,

HDM_LAYOUT
ÕÕ 
=
ÕÕ 
(
ÕÕ 
	HDM_FIRST
ÕÕ #
+
ÕÕ$ %
$num
ÕÕ& '
)
ÕÕ' (
,
ÕÕ( )
HDM_HITTEST
ÖÖ 
=
ÖÖ 
(
ÖÖ 
	HDM_FIRST
ÖÖ $
+
ÖÖ% &
$num
ÖÖ' (
)
ÖÖ( )
,
ÖÖ) *
HDM_GETITEMRECT
×× 
=
×× 
(
×× 
	HDM_FIRST
×× (
+
××) *
$num
××+ ,
)
××, -
,
××- .
HDM_SETIMAGELIST
ØØ 
=
ØØ 
(
ØØ  
	HDM_FIRST
ØØ  )
+
ØØ* +
$num
ØØ, -
)
ØØ- .
,
ØØ. /
HDM_GETIMAGELIST
ÙÙ 
=
ÙÙ 
(
ÙÙ  
	HDM_FIRST
ÙÙ  )
+
ÙÙ* +
$num
ÙÙ, -
)
ÙÙ- .
,
ÙÙ. /
HDM_ORDERTOINDEX
ÚÚ 
=
ÚÚ 
(
ÚÚ  
	HDM_FIRST
ÚÚ  )
+
ÚÚ* +
$num
ÚÚ, .
)
ÚÚ. /
,
ÚÚ/ 0!
HDM_CREATEDRAGIMAGE
ÛÛ 
=
ÛÛ  !
(
ÛÛ" #
	HDM_FIRST
ÛÛ# ,
+
ÛÛ- .
$num
ÛÛ/ 1
)
ÛÛ1 2
,
ÛÛ2 3
HDM_GETORDERARRAY
ÜÜ 
=
ÜÜ 
(
ÜÜ  !
	HDM_FIRST
ÜÜ! *
+
ÜÜ+ ,
$num
ÜÜ- /
)
ÜÜ/ 0
,
ÜÜ0 1
HDM_SETORDERARRAY
İİ 
=
İİ 
(
İİ  !
	HDM_FIRST
İİ! *
+
İİ+ ,
$num
İİ- /
)
İİ/ 0
,
İİ0 1
HDM_SETHOTDIVIDER
ŞŞ 
=
ŞŞ 
(
ŞŞ  !
	HDM_FIRST
ŞŞ! *
+
ŞŞ+ ,
$num
ŞŞ- /
)
ŞŞ/ 0
,
ŞŞ0 1!
HDM_SETBITMAPMARGIN
ßß 
=
ßß  !
(
ßß" #
	HDM_FIRST
ßß# ,
+
ßß- .
$num
ßß/ 1
)
ßß1 2
,
ßß2 3!
HDM_GETBITMAPMARGIN
àà 
=
àà  !
(
àà" #
	HDM_FIRST
àà# ,
+
àà- .
$num
àà/ 1
)
àà1 2
,
àà2 3"
HDM_SETUNICODEFORMAT
áá  
=
áá! ""
CCM_SETUNICODEFORMAT
áá# 7
,
áá7 8"
HDM_GETUNICODEFORMAT
ââ  
=
ââ! ""
CCM_GETUNICODEFORMAT
ââ# 7
,
ââ7 8(
HDM_SETFILTERCHANGETIMEOUT
ãã &
=
ãã' (
(
ãã) *
	HDM_FIRST
ãã* 3
+
ãã4 5
$num
ãã6 8
)
ãã8 9
,
ãã9 :
HDM_EDITFILTER
ää 
=
ää 
(
ää 
	HDM_FIRST
ää '
+
ää( )
$num
ää* ,
)
ää, -
,
ää- .
HDM_CLEARFILTER
åå 
=
åå 
(
åå 
	HDM_FIRST
åå (
+
åå) *
$num
åå+ -
)
åå- .
,
åå. /
TB_ENABLEBUTTON
ææ 
=
ææ 
(
ææ 
WM_USER
ææ &
+
ææ' (
$num
ææ) *
)
ææ* +
,
ææ+ ,
TB_CHECKBUTTON
çç 
=
çç 
(
çç 
WM_USER
çç %
+
çç& '
$num
çç( )
)
çç) *
,
çç* +
TB_PRESSBUTTON
èè 
=
èè 
(
èè 
WM_USER
èè %
+
èè& '
$num
èè( )
)
èè) *
,
èè* +
TB_HIDEBUTTON
éé 
=
éé 
(
éé 
WM_USER
éé $
+
éé% &
$num
éé' (
)
éé( )
,
éé) *
TB_INDETERMINATE
êê 
=
êê 
(
êê  
WM_USER
êê  '
+
êê( )
$num
êê* +
)
êê+ ,
,
êê, -
TB_MARKBUTTON
ëë 
=
ëë 
(
ëë 
WM_USER
ëë $
+
ëë% &
$num
ëë' (
)
ëë( )
,
ëë) * 
TB_ISBUTTONENABLED
ìì 
=
ìì  
(
ìì! "
WM_USER
ìì" )
+
ìì* +
$num
ìì, -
)
ìì- .
,
ìì. / 
TB_ISBUTTONCHECKED
íí 
=
íí  
(
íí! "
WM_USER
íí" )
+
íí* +
$num
íí, .
)
íí. /
,
íí/ 0 
TB_ISBUTTONPRESSED
îî 
=
îî  
(
îî! "
WM_USER
îî" )
+
îî* +
$num
îî, .
)
îî. /
,
îî/ 0
TB_ISBUTTONHIDDEN
ïï 
=
ïï 
(
ïï  !
WM_USER
ïï! (
+
ïï) *
$num
ïï+ -
)
ïï- .
,
ïï. /&
TB_ISBUTTONINDETERMINATE
ğğ $
=
ğğ% &
(
ğğ' (
WM_USER
ğğ( /
+
ğğ0 1
$num
ğğ2 4
)
ğğ4 5
,
ğğ5 6$
TB_ISBUTTONHIGHLIGHTED
ññ "
=
ññ# $
(
ññ% &
WM_USER
ññ& -
+
ññ. /
$num
ññ0 2
)
ññ2 3
,
ññ3 4
TB_SETSTATE
òò 
=
òò 
(
òò 
WM_USER
òò "
+
òò# $
$num
òò% '
)
òò' (
,
òò( )
TB_GETSTATE
óó 
=
óó 
(
óó 
WM_USER
óó "
+
óó# $
$num
óó% '
)
óó' (
,
óó( )
TB_ADDBITMAP
ôô 
=
ôô 
(
ôô 
WM_USER
ôô #
+
ôô$ %
$num
ôô& (
)
ôô( )
,
ôô) *
TB_ADDBUTTONSA
õõ 
=
õõ 
(
õõ 
WM_USER
õõ %
+
õõ& '
$num
õõ( *
)
õõ* +
,
õõ+ ,
TB_INSERTBUTTONA
öö 
=
öö 
(
öö  
WM_USER
öö  '
+
öö( )
$num
öö* ,
)
öö, -
,
öö- .
TB_ADDBUTTONS
÷÷ 
=
÷÷ 
(
÷÷ 
WM_USER
÷÷ $
+
÷÷% &
$num
÷÷' )
)
÷÷) *
,
÷÷* +
TB_INSERTBUTTON
øø 
=
øø 
(
øø 
WM_USER
øø &
+
øø' (
$num
øø) +
)
øø+ ,
,
øø, -
TB_DELETEBUTTON
ùù 
=
ùù 
(
ùù 
WM_USER
ùù &
+
ùù' (
$num
ùù) +
)
ùù+ ,
,
ùù, -
TB_GETBUTTON
úú 
=
úú 
(
úú 
WM_USER
úú #
+
úú$ %
$num
úú& (
)
úú( )
,
úú) *
TB_BUTTONCOUNT
ûû 
=
ûû 
(
ûû 
WM_USER
ûû %
+
ûû& '
$num
ûû( *
)
ûû* +
,
ûû+ ,
TB_COMMANDTOINDEX
üü 
=
üü 
(
üü  !
WM_USER
üü! (
+
üü) *
$num
üü+ -
)
üü- .
,
üü. /
TB_SAVERESTOREA
ıı 
=
ıı 
(
ıı 
WM_USER
ıı &
+
ıı' (
$num
ıı) +
)
ıı+ ,
,
ıı, -
TB_SAVERESTOREW
şş 
=
şş 
(
şş 
WM_USER
şş &
+
şş' (
$num
şş) +
)
şş+ ,
,
şş, -
TB_CUSTOMIZE
ÿÿ 
=
ÿÿ 
(
ÿÿ 
WM_USER
ÿÿ #
+
ÿÿ$ %
$num
ÿÿ& (
)
ÿÿ( )
,
ÿÿ) *
TB_ADDSTRINGA
€€ 
=
€€ 
(
€€ 
WM_USER
€€ $
+
€€% &
$num
€€' )
)
€€) *
,
€€* +
TB_ADDSTRINGW
 
=
 
(
 
WM_USER
 $
+
% &
$num
' )
)
) *
,
* +
TB_GETITEMRECT
‚‚ 
=
‚‚ 
(
‚‚ 
WM_USER
‚‚ %
+
‚‚& '
$num
‚‚( *
)
‚‚* +
,
‚‚+ ,!
TB_BUTTONSTRUCTSIZE
ƒƒ 
=
ƒƒ  !
(
ƒƒ" #
WM_USER
ƒƒ# *
+
ƒƒ+ ,
$num
ƒƒ- /
)
ƒƒ/ 0
,
ƒƒ0 1
TB_SETBUTTONSIZE
„„ 
=
„„ 
(
„„  
WM_USER
„„  '
+
„„( )
$num
„„* ,
)
„„, -
,
„„- .
TB_SETBITMAPSIZE
…… 
=
…… 
(
……  
WM_USER
……  '
+
……( )
$num
……* ,
)
……, -
,
……- .
TB_AUTOSIZE
†† 
=
†† 
(
†† 
WM_USER
†† "
+
††# $
$num
††% '
)
††' (
,
††( )
TB_GETTOOLTIPS
‡‡ 
=
‡‡ 
(
‡‡ 
WM_USER
‡‡ %
+
‡‡& '
$num
‡‡( *
)
‡‡* +
,
‡‡+ ,
TB_SETTOOLTIPS
ˆˆ 
=
ˆˆ 
(
ˆˆ 
WM_USER
ˆˆ %
+
ˆˆ& '
$num
ˆˆ( *
)
ˆˆ* +
,
ˆˆ+ ,
TB_SETPARENT
‰‰ 
=
‰‰ 
(
‰‰ 
WM_USER
‰‰ #
+
‰‰$ %
$num
‰‰& (
)
‰‰( )
,
‰‰) *

TB_SETROWS
ŠŠ 
=
ŠŠ 
(
ŠŠ 
WM_USER
ŠŠ !
+
ŠŠ" #
$num
ŠŠ$ &
)
ŠŠ& '
,
ŠŠ' (

TB_GETROWS
‹‹ 
=
‹‹ 
(
‹‹ 
WM_USER
‹‹ !
+
‹‹" #
$num
‹‹$ &
)
‹‹& '
,
‹‹' (
TB_SETCMDID
ŒŒ 
=
ŒŒ 
(
ŒŒ 
WM_USER
ŒŒ "
+
ŒŒ# $
$num
ŒŒ% '
)
ŒŒ' (
,
ŒŒ( )
TB_CHANGEBITMAP
 
=
 
(
 
WM_USER
 &
+
' (
$num
) +
)
+ ,
,
, -
TB_GETBITMAP
 
=
 
(
 
WM_USER
 #
+
$ %
$num
& (
)
( )
,
) *
TB_GETBUTTONTEXTA
 
=
 
(
  !
WM_USER
! (
+
) *
$num
+ -
)
- .
,
. /
TB_GETBUTTONTEXTW
 
=
 
(
  !
WM_USER
! (
+
) *
$num
+ -
)
- .
,
. /
TB_REPLACEBITMAP
‘‘ 
=
‘‘ 
(
‘‘  
WM_USER
‘‘  '
+
‘‘( )
$num
‘‘* ,
)
‘‘, -
,
‘‘- .
TB_SETINDENT
’’ 
=
’’ 
(
’’ 
WM_USER
’’ #
+
’’$ %
$num
’’& (
)
’’( )
,
’’) *
TB_SETIMAGELIST
““ 
=
““ 
(
““ 
WM_USER
““ &
+
““' (
$num
““) +
)
““+ ,
,
““, -
TB_GETIMAGELIST
”” 
=
”” 
(
”” 
WM_USER
”” &
+
””' (
$num
””) +
)
””+ ,
,
””, -
TB_LOADIMAGES
•• 
=
•• 
(
•• 
WM_USER
•• $
+
••% &
$num
••' )
)
••) *
,
••* +

TB_GETRECT
–– 
=
–– 
(
–– 
WM_USER
–– !
+
––" #
$num
––$ &
)
––& '
,
––' ( 
TB_SETHOTIMAGELIST
—— 
=
——  
(
——! "
WM_USER
——" )
+
——* +
$num
——, .
)
——. /
,
——/ 0 
TB_GETHOTIMAGELIST
˜˜ 
=
˜˜  
(
˜˜! "
WM_USER
˜˜" )
+
˜˜* +
$num
˜˜, .
)
˜˜. /
,
˜˜/ 0%
TB_SETDISABLEDIMAGELIST
™™ #
=
™™$ %
(
™™& '
WM_USER
™™' .
+
™™/ 0
$num
™™1 3
)
™™3 4
,
™™4 5%
TB_GETDISABLEDIMAGELIST
šš #
=
šš$ %
(
šš& '
WM_USER
šš' .
+
šš/ 0
$num
šš1 3
)
šš3 4
,
šš4 5
TB_SETSTYLE
›› 
=
›› 
(
›› 
WM_USER
›› "
+
››# $
$num
››% '
)
››' (
,
››( )
TB_GETSTYLE
œœ 
=
œœ 
(
œœ 
WM_USER
œœ "
+
œœ# $
$num
œœ% '
)
œœ' (
,
œœ( )
TB_GETBUTTONSIZE
 
=
 
(
  
WM_USER
  '
+
( )
$num
* ,
)
, -
,
- .
TB_SETBUTTONWIDTH
 
=
 
(
  !
WM_USER
! (
+
) *
$num
+ -
)
- .
,
. /
TB_SETMAXTEXTROWS
ŸŸ 
=
ŸŸ 
(
ŸŸ  !
WM_USER
ŸŸ! (
+
ŸŸ) *
$num
ŸŸ+ -
)
ŸŸ- .
,
ŸŸ. /
TB_GETTEXTROWS
   
=
   
(
   
WM_USER
   %
+
  & '
$num
  ( *
)
  * +
,
  + ,
TB_GETOBJECT
¡¡ 
=
¡¡ 
(
¡¡ 
WM_USER
¡¡ #
+
¡¡$ %
$num
¡¡& (
)
¡¡( )
,
¡¡) *
TB_GETHOTITEM
¢¢ 
=
¢¢ 
(
¢¢ 
WM_USER
¢¢ $
+
¢¢% &
$num
¢¢' )
)
¢¢) *
,
¢¢* +
TB_SETHOTITEM
££ 
=
££ 
(
££ 
WM_USER
££ $
+
££% &
$num
££' )
)
££) *
,
££* +#
TB_SETANCHORHIGHLIGHT
¤¤ !
=
¤¤" #
(
¤¤$ %
WM_USER
¤¤% ,
+
¤¤- .
$num
¤¤/ 1
)
¤¤1 2
,
¤¤2 3#
TB_GETANCHORHIGHLIGHT
¥¥ !
=
¥¥" #
(
¥¥$ %
WM_USER
¥¥% ,
+
¥¥- .
$num
¥¥/ 1
)
¥¥1 2
,
¥¥2 3 
TB_MAPACCELERATORA
¦¦ 
=
¦¦  
(
¦¦! "
WM_USER
¦¦" )
+
¦¦* +
$num
¦¦, .
)
¦¦. /
,
¦¦/ 0
TB_GETINSERTMARK
§§ 
=
§§ 
(
§§  
WM_USER
§§  '
+
§§( )
$num
§§* ,
)
§§, -
,
§§- .
TB_SETINSERTMARK
¨¨ 
=
¨¨ 
(
¨¨  
WM_USER
¨¨  '
+
¨¨( )
$num
¨¨* ,
)
¨¨, -
,
¨¨- ."
TB_INSERTMARKHITTEST
©©  
=
©©! "
(
©©# $
WM_USER
©©$ +
+
©©, -
$num
©©. 0
)
©©0 1
,
©©1 2
TB_MOVEBUTTON
ªª 
=
ªª 
(
ªª 
WM_USER
ªª $
+
ªª% &
$num
ªª' )
)
ªª) *
,
ªª* +
TB_GETMAXSIZE
«« 
=
«« 
(
«« 
WM_USER
«« $
+
««% &
$num
««' )
)
««) *
,
««* +!
TB_SETEXTENDEDSTYLE
¬¬ 
=
¬¬  !
(
¬¬" #
WM_USER
¬¬# *
+
¬¬+ ,
$num
¬¬- /
)
¬¬/ 0
,
¬¬0 1!
TB_GETEXTENDEDSTYLE
­­ 
=
­­  !
(
­­" #
WM_USER
­­# *
+
­­+ ,
$num
­­- /
)
­­/ 0
,
­­0 1
TB_GETPADDING
®® 
=
®® 
(
®® 
WM_USER
®® $
+
®®% &
$num
®®' )
)
®®) *
,
®®* +
TB_SETPADDING
¯¯ 
=
¯¯ 
(
¯¯ 
WM_USER
¯¯ $
+
¯¯% &
$num
¯¯' )
)
¯¯) *
,
¯¯* +#
TB_SETINSERTMARKCOLOR
°° !
=
°°" #
(
°°$ %
WM_USER
°°% ,
+
°°- .
$num
°°/ 1
)
°°1 2
,
°°2 3#
TB_GETINSERTMARKCOLOR
±± !
=
±±" #
(
±±$ %
WM_USER
±±% ,
+
±±- .
$num
±±/ 1
)
±±1 2
,
±±2 3
TB_SETCOLORSCHEME
²² 
=
²²  
CCM_SETCOLORSCHEME
²²  2
,
²²2 3
TB_GETCOLORSCHEME
³³ 
=
³³  
CCM_GETCOLORSCHEME
³³  2
,
³³2 3!
TB_SETUNICODEFORMAT
´´ 
=
´´  !"
CCM_SETUNICODEFORMAT
´´" 6
,
´´6 7!
TB_GETUNICODEFORMAT
µµ 
=
µµ  !"
CCM_GETUNICODEFORMAT
µµ" 6
,
µµ6 7 
TB_MAPACCELERATORW
¶¶ 
=
¶¶  
(
¶¶! "
WM_USER
¶¶" )
+
¶¶* +
$num
¶¶, .
)
¶¶. /
,
¶¶/ 0
TB_GETBITMAPFLAGS
·· 
=
·· 
(
··  !
WM_USER
··! (
+
··) *
$num
··+ -
)
··- .
,
··. /
TB_GETBUTTONINFOW
¸¸ 
=
¸¸ 
(
¸¸  !
WM_USER
¸¸! (
+
¸¸) *
$num
¸¸+ -
)
¸¸- .
,
¸¸. /
TB_SETBUTTONINFOW
¹¹ 
=
¹¹ 
(
¹¹  !
WM_USER
¹¹! (
+
¹¹) *
$num
¹¹+ -
)
¹¹- .
,
¹¹. /
TB_GETBUTTONINFOA
ºº 
=
ºº 
(
ºº  !
WM_USER
ºº! (
+
ºº) *
$num
ºº+ -
)
ºº- .
,
ºº. /
TB_SETBUTTONINFOA
»» 
=
»» 
(
»»  !
WM_USER
»»! (
+
»») *
$num
»»+ -
)
»»- .
,
»». /
TB_INSERTBUTTONW
¼¼ 
=
¼¼ 
(
¼¼  
WM_USER
¼¼  '
+
¼¼( )
$num
¼¼* ,
)
¼¼, -
,
¼¼- .
TB_ADDBUTTONSW
½½ 
=
½½ 
(
½½ 
WM_USER
½½ %
+
½½& '
$num
½½( *
)
½½* +
,
½½+ ,

TB_HITTEST
¾¾ 
=
¾¾ 
(
¾¾ 
WM_USER
¾¾ !
+
¾¾" #
$num
¾¾$ &
)
¾¾& '
,
¾¾' (!
TB_SETDRAWTEXTFLAGS
¿¿ 
=
¿¿  !
(
¿¿" #
WM_USER
¿¿# *
+
¿¿+ ,
$num
¿¿- /
)
¿¿/ 0
,
¿¿0 1
TB_GETSTRINGW
ÀÀ 
=
ÀÀ 
(
ÀÀ 
WM_USER
ÀÀ $
+
ÀÀ% &
$num
ÀÀ' )
)
ÀÀ) *
,
ÀÀ* +
TB_GETSTRINGA
ÁÁ 
=
ÁÁ 
(
ÁÁ 
WM_USER
ÁÁ $
+
ÁÁ% &
$num
ÁÁ' )
)
ÁÁ) *
,
ÁÁ* +
TB_GETMETRICS
ÂÂ 
=
ÂÂ 
(
ÂÂ 
WM_USER
ÂÂ $
+
ÂÂ% &
$num
ÂÂ' *
)
ÂÂ* +
,
ÂÂ+ ,
TB_SETMETRICS
ÃÃ 
=
ÃÃ 
(
ÃÃ 
WM_USER
ÃÃ $
+
ÃÃ% &
$num
ÃÃ' *
)
ÃÃ* +
,
ÃÃ+ ,
TB_SETWINDOWTHEME
ÄÄ 
=
ÄÄ  
CCM_SETWINDOWTHEME
ÄÄ  2
,
ÄÄ2 3
RB_INSERTBANDA
ÅÅ 
=
ÅÅ 
(
ÅÅ 
WM_USER
ÅÅ %
+
ÅÅ& '
$num
ÅÅ( )
)
ÅÅ) *
,
ÅÅ* +
RB_DELETEBAND
ÆÆ 
=
ÆÆ 
(
ÆÆ 
WM_USER
ÆÆ $
+
ÆÆ% &
$num
ÆÆ' (
)
ÆÆ( )
,
ÆÆ) *
RB_GETBARINFO
ÇÇ 
=
ÇÇ 
(
ÇÇ 
WM_USER
ÇÇ $
+
ÇÇ% &
$num
ÇÇ' (
)
ÇÇ( )
,
ÇÇ) *
RB_SETBARINFO
ÈÈ 
=
ÈÈ 
(
ÈÈ 
WM_USER
ÈÈ $
+
ÈÈ% &
$num
ÈÈ' (
)
ÈÈ( )
,
ÈÈ) *
RB_GETBANDINFO
ÉÉ 
=
ÉÉ 
(
ÉÉ 
WM_USER
ÉÉ %
+
ÉÉ& '
$num
ÉÉ( )
)
ÉÉ) *
,
ÉÉ* +
RB_SETBANDINFOA
ÊÊ 
=
ÊÊ 
(
ÊÊ 
WM_USER
ÊÊ &
+
ÊÊ' (
$num
ÊÊ) *
)
ÊÊ* +
,
ÊÊ+ ,
RB_SETPARENT
ËË 
=
ËË 
(
ËË 
WM_USER
ËË #
+
ËË$ %
$num
ËË& '
)
ËË' (
,
ËË( )

RB_HITTEST
ÌÌ 
=
ÌÌ 
(
ÌÌ 
WM_USER
ÌÌ !
+
ÌÌ" #
$num
ÌÌ$ %
)
ÌÌ% &
,
ÌÌ& '

RB_GETRECT
ÍÍ 
=
ÍÍ 
(
ÍÍ 
WM_USER
ÍÍ !
+
ÍÍ" #
$num
ÍÍ$ %
)
ÍÍ% &
,
ÍÍ& '
RB_INSERTBANDW
ÎÎ 
=
ÎÎ 
(
ÎÎ 
WM_USER
ÎÎ %
+
ÎÎ& '
$num
ÎÎ( *
)
ÎÎ* +
,
ÎÎ+ ,
RB_SETBANDINFOW
ÏÏ 
=
ÏÏ 
(
ÏÏ 
WM_USER
ÏÏ &
+
ÏÏ' (
$num
ÏÏ) +
)
ÏÏ+ ,
,
ÏÏ, -
RB_GETBANDCOUNT
ĞĞ 
=
ĞĞ 
(
ĞĞ 
WM_USER
ĞĞ &
+
ĞĞ' (
$num
ĞĞ) +
)
ĞĞ+ ,
,
ĞĞ, -
RB_GETROWCOUNT
ÑÑ 
=
ÑÑ 
(
ÑÑ 
WM_USER
ÑÑ %
+
ÑÑ& '
$num
ÑÑ( *
)
ÑÑ* +
,
ÑÑ+ ,
RB_GETROWHEIGHT
ÒÒ 
=
ÒÒ 
(
ÒÒ 
WM_USER
ÒÒ &
+
ÒÒ' (
$num
ÒÒ) +
)
ÒÒ+ ,
,
ÒÒ, -
RB_IDTOINDEX
ÓÓ 
=
ÓÓ 
(
ÓÓ 
WM_USER
ÓÓ #
+
ÓÓ$ %
$num
ÓÓ& (
)
ÓÓ( )
,
ÓÓ) *
RB_GETTOOLTIPS
ÔÔ 
=
ÔÔ 
(
ÔÔ 
WM_USER
ÔÔ %
+
ÔÔ& '
$num
ÔÔ( *
)
ÔÔ* +
,
ÔÔ+ ,
RB_SETTOOLTIPS
ÕÕ 
=
ÕÕ 
(
ÕÕ 
WM_USER
ÕÕ %
+
ÕÕ& '
$num
ÕÕ( *
)
ÕÕ* +
,
ÕÕ+ ,
RB_SETBKCOLOR
ÖÖ 
=
ÖÖ 
(
ÖÖ 
WM_USER
ÖÖ $
+
ÖÖ% &
$num
ÖÖ' )
)
ÖÖ) *
,
ÖÖ* +
RB_GETBKCOLOR
×× 
=
×× 
(
×× 
WM_USER
×× $
+
××% &
$num
××' )
)
××) *
,
××* +
RB_SETTEXTCOLOR
ØØ 
=
ØØ 
(
ØØ 
WM_USER
ØØ &
+
ØØ' (
$num
ØØ) +
)
ØØ+ ,
,
ØØ, -
RB_GETTEXTCOLOR
ÙÙ 
=
ÙÙ 
(
ÙÙ 
WM_USER
ÙÙ &
+
ÙÙ' (
$num
ÙÙ) +
)
ÙÙ+ ,
,
ÙÙ, -
RB_SIZETORECT
ÚÚ 
=
ÚÚ 
(
ÚÚ 
WM_USER
ÚÚ $
+
ÚÚ% &
$num
ÚÚ' )
)
ÚÚ) *
,
ÚÚ* +
RB_SETCOLORSCHEME
ÛÛ 
=
ÛÛ  
CCM_SETCOLORSCHEME
ÛÛ  2
,
ÛÛ2 3
RB_GETCOLORSCHEME
ÜÜ 
=
ÜÜ  
CCM_GETCOLORSCHEME
ÜÜ  2
,
ÜÜ2 3
RB_BEGINDRAG
İİ 
=
İİ 
(
İİ 
WM_USER
İİ #
+
İİ$ %
$num
İİ& (
)
İİ( )
,
İİ) *

RB_ENDDRAG
ŞŞ 
=
ŞŞ 
(
ŞŞ 
WM_USER
ŞŞ !
+
ŞŞ" #
$num
ŞŞ$ &
)
ŞŞ& '
,
ŞŞ' (
RB_DRAGMOVE
ßß 
=
ßß 
(
ßß 
WM_USER
ßß "
+
ßß# $
$num
ßß% '
)
ßß' (
,
ßß( )
RB_GETBARHEIGHT
àà 
=
àà 
(
àà 
WM_USER
àà &
+
àà' (
$num
àà) +
)
àà+ ,
,
àà, -
RB_GETBANDINFOW
áá 
=
áá 
(
áá 
WM_USER
áá &
+
áá' (
$num
áá) +
)
áá+ ,
,
áá, -
RB_GETBANDINFOA
ââ 
=
ââ 
(
ââ 
WM_USER
ââ &
+
ââ' (
$num
ââ) +
)
ââ+ ,
,
ââ, -
RB_MINIMIZEBAND
ãã 
=
ãã 
(
ãã 
WM_USER
ãã &
+
ãã' (
$num
ãã) +
)
ãã+ ,
,
ãã, -
RB_MAXIMIZEBAND
ää 
=
ää 
(
ää 
WM_USER
ää &
+
ää' (
$num
ää) +
)
ää+ ,
,
ää, -
RB_GETDROPTARGET
åå 
=
åå 
(
åå  
CCM_GETDROPTARGET
åå  1
)
åå1 2
,
åå2 3
RB_GETBANDBORDERS
ææ 
=
ææ 
(
ææ  !
WM_USER
ææ! (
+
ææ) *
$num
ææ+ -
)
ææ- .
,
ææ. /
RB_SHOWBAND
çç 
=
çç 
(
çç 
WM_USER
çç "
+
çç# $
$num
çç% '
)
çç' (
,
çç( )
RB_SETPALETTE
èè 
=
èè 
(
èè 
WM_USER
èè $
+
èè% &
$num
èè' )
)
èè) *
,
èè* +
RB_GETPALETTE
éé 
=
éé 
(
éé 
WM_USER
éé $
+
éé% &
$num
éé' )
)
éé) *
,
éé* +
RB_MOVEBAND
êê 
=
êê 
(
êê 
WM_USER
êê "
+
êê# $
$num
êê% '
)
êê' (
,
êê( )!
RB_SETUNICODEFORMAT
ëë 
=
ëë  !"
CCM_SETUNICODEFORMAT
ëë" 6
,
ëë6 7!
RB_GETUNICODEFORMAT
ìì 
=
ìì  !"
CCM_GETUNICODEFORMAT
ìì" 6
,
ìì6 7
RB_GETBANDMARGINS
íí 
=
íí 
(
íí  !
WM_USER
íí! (
+
íí) *
$num
íí+ -
)
íí- .
,
íí. /
RB_SETWINDOWTHEME
îî 
=
îî  
CCM_SETWINDOWTHEME
îî  2
,
îî2 3
RB_PUSHCHEVRON
ïï 
=
ïï 
(
ïï 
WM_USER
ïï %
+
ïï& '
$num
ïï( *
)
ïï* +
,
ïï+ ,
TTM_ACTIVATE
ğğ 
=
ğğ 
(
ğğ 
WM_USER
ğğ #
+
ğğ$ %
$num
ğğ& '
)
ğğ' (
,
ğğ( )
TTM_SETDELAYTIME
ññ 
=
ññ 
(
ññ  
WM_USER
ññ  '
+
ññ( )
$num
ññ* +
)
ññ+ ,
,
ññ, -
TTM_ADDTOOLA
òò 
=
òò 
(
òò 
WM_USER
òò #
+
òò$ %
$num
òò& '
)
òò' (
,
òò( )
TTM_ADDTOOLW
óó 
=
óó 
(
óó 
WM_USER
óó #
+
óó$ %
$num
óó& (
)
óó( )
,
óó) *
TTM_DELTOOLA
ôô 
=
ôô 
(
ôô 
WM_USER
ôô #
+
ôô$ %
$num
ôô& '
)
ôô' (
,
ôô( )
TTM_DELTOOLW
õõ 
=
õõ 
(
õõ 
WM_USER
õõ #
+
õõ$ %
$num
õõ& (
)
õõ( )
,
õõ) *
TTM_NEWTOOLRECTA
öö 
=
öö 
(
öö  
WM_USER
öö  '
+
öö( )
$num
öö* +
)
öö+ ,
,
öö, -
TTM_NEWTOOLRECTW
÷÷ 
=
÷÷ 
(
÷÷  
WM_USER
÷÷  '
+
÷÷( )
$num
÷÷* ,
)
÷÷, -
,
÷÷- .
TTM_RELAYEVENT
øø 
=
øø 
(
øø 
WM_USER
øø %
+
øø& '
$num
øø( )
)
øø) *
,
øø* +
TTM_GETTOOLINFOA
ùù 
=
ùù 
(
ùù  
WM_USER
ùù  '
+
ùù( )
$num
ùù* +
)
ùù+ ,
,
ùù, -
TTM_GETTOOLINFOW
úú 
=
úú 
(
úú  
WM_USER
úú  '
+
úú( )
$num
úú* ,
)
úú, -
,
úú- .
TTM_SETTOOLINFOA
ûû 
=
ûû 
(
ûû  
WM_USER
ûû  '
+
ûû( )
$num
ûû* +
)
ûû+ ,
,
ûû, -
TTM_SETTOOLINFOW
üü 
=
üü 
(
üü  
WM_USER
üü  '
+
üü( )
$num
üü* ,
)
üü, -
,
üü- .
TTM_HITTESTA
ıı 
=
ıı 
(
ıı 
WM_USER
ıı #
+
ıı$ %
$num
ıı& (
)
ıı( )
,
ıı) *
TTM_HITTESTW
şş 
=
şş 
(
şş 
WM_USER
şş #
+
şş$ %
$num
şş& (
)
şş( )
,
şş) *
TTM_GETTEXTA
ÿÿ 
=
ÿÿ 
(
ÿÿ 
WM_USER
ÿÿ #
+
ÿÿ$ %
$num
ÿÿ& (
)
ÿÿ( )
,
ÿÿ) *
TTM_GETTEXTW
€€ 
=
€€ 
(
€€ 
WM_USER
€€ #
+
€€$ %
$num
€€& (
)
€€( )
,
€€) * 
TTM_UPDATETIPTEXTA
 
=
  
(
! "
WM_USER
" )
+
* +
$num
, .
)
. /
,
/ 0 
TTM_UPDATETIPTEXTW
‚‚ 
=
‚‚  
(
‚‚! "
WM_USER
‚‚" )
+
‚‚* +
$num
‚‚, .
)
‚‚. /
,
‚‚/ 0
TTM_GETTOOLCOUNT
ƒƒ 
=
ƒƒ 
(
ƒƒ  
WM_USER
ƒƒ  '
+
ƒƒ( )
$num
ƒƒ* ,
)
ƒƒ, -
,
ƒƒ- .
TTM_ENUMTOOLSA
„„ 
=
„„ 
(
„„ 
WM_USER
„„ %
+
„„& '
$num
„„( *
)
„„* +
,
„„+ ,
TTM_ENUMTOOLSW
…… 
=
…… 
(
…… 
WM_USER
…… %
+
……& '
$num
……( *
)
……* +
,
……+ ,!
TTM_GETCURRENTTOOLA
†† 
=
††  !
(
††" #
WM_USER
††# *
+
††+ ,
$num
††- /
)
††/ 0
,
††0 1!
TTM_GETCURRENTTOOLW
‡‡ 
=
‡‡  !
(
‡‡" #
WM_USER
‡‡# *
+
‡‡+ ,
$num
‡‡- /
)
‡‡/ 0
,
‡‡0 1!
TTM_WINDOWFROMPOINT
ˆˆ 
=
ˆˆ  !
(
ˆˆ" #
WM_USER
ˆˆ# *
+
ˆˆ+ ,
$num
ˆˆ- /
)
ˆˆ/ 0
,
ˆˆ0 1
TTM_TRACKACTIVATE
‰‰ 
=
‰‰ 
(
‰‰  !
WM_USER
‰‰! (
+
‰‰) *
$num
‰‰+ -
)
‰‰- .
,
‰‰. /
TTM_TRACKPOSITION
ŠŠ 
=
ŠŠ 
(
ŠŠ  !
WM_USER
ŠŠ! (
+
ŠŠ) *
$num
ŠŠ+ -
)
ŠŠ- .
,
ŠŠ. /
TTM_SETTIPBKCOLOR
‹‹ 
=
‹‹ 
(
‹‹  !
WM_USER
‹‹! (
+
‹‹) *
$num
‹‹+ -
)
‹‹- .
,
‹‹. /!
TTM_SETTIPTEXTCOLOR
ŒŒ 
=
ŒŒ  !
(
ŒŒ" #
WM_USER
ŒŒ# *
+
ŒŒ+ ,
$num
ŒŒ- /
)
ŒŒ/ 0
,
ŒŒ0 1
TTM_GETDELAYTIME
 
=
 
(
  
WM_USER
  '
+
( )
$num
* ,
)
, -
,
- .
TTM_GETTIPBKCOLOR
 
=
 
(
  !
WM_USER
! (
+
) *
$num
+ -
)
- .
,
. /!
TTM_GETTIPTEXTCOLOR
 
=
  !
(
" #
WM_USER
# *
+
+ ,
$num
- /
)
/ 0
,
0 1 
TTM_SETMAXTIPWIDTH
 
=
  
(
! "
WM_USER
" )
+
* +
$num
, .
)
. /
,
/ 0 
TTM_GETMAXTIPWIDTH
‘‘ 
=
‘‘  
(
‘‘! "
WM_USER
‘‘" )
+
‘‘* +
$num
‘‘, .
)
‘‘. /
,
‘‘/ 0
TTM_SETMARGIN
’’ 
=
’’ 
(
’’ 
WM_USER
’’ $
+
’’% &
$num
’’' )
)
’’) *
,
’’* +
TTM_GETMARGIN
““ 
=
““ 
(
““ 
WM_USER
““ $
+
““% &
$num
““' )
)
““) *
,
““* +
TTM_POP
”” 
=
”” 
(
”” 
WM_USER
”” 
+
””  
$num
””! #
)
””# $
,
””$ %

TTM_UPDATE
•• 
=
•• 
(
•• 
WM_USER
•• !
+
••" #
$num
••$ &
)
••& '
,
••' (
TTM_GETBUBBLESIZE
–– 
=
–– 
(
––  !
WM_USER
––! (
+
––) *
$num
––+ -
)
––- .
,
––. /
TTM_ADJUSTRECT
—— 
=
—— 
(
—— 
WM_USER
—— %
+
——& '
$num
——( *
)
——* +
,
——+ ,
TTM_SETTITLEA
˜˜ 
=
˜˜ 
(
˜˜ 
WM_USER
˜˜ $
+
˜˜% &
$num
˜˜' )
)
˜˜) *
,
˜˜* +
TTM_SETTITLEW
™™ 
=
™™ 
(
™™ 
WM_USER
™™ $
+
™™% &
$num
™™' )
)
™™) *
,
™™* +
	TTM_POPUP
šš 
=
šš 
(
šš 
WM_USER
šš  
+
šš! "
$num
šš# %
)
šš% &
,
šš& '
TTM_GETTITLE
›› 
=
›› 
(
›› 
WM_USER
›› #
+
››$ %
$num
››& (
)
››( )
,
››) * 
TTM_SETWINDOWTHEME
œœ 
=
œœ   
CCM_SETWINDOWTHEME
œœ! 3
,
œœ3 4
SB_SETTEXTA
 
=
 
(
 
WM_USER
 "
+
# $
$num
% &
)
& '
,
' (
SB_SETTEXTW
 
=
 
(
 
WM_USER
 "
+
# $
$num
% '
)
' (
,
( )
SB_GETTEXTA
ŸŸ 
=
ŸŸ 
(
ŸŸ 
WM_USER
ŸŸ "
+
ŸŸ# $
$num
ŸŸ% &
)
ŸŸ& '
,
ŸŸ' (
SB_GETTEXTW
   
=
   
(
   
WM_USER
   "
+
  # $
$num
  % '
)
  ' (
,
  ( )
SB_GETTEXTLENGTHA
¡¡ 
=
¡¡ 
(
¡¡  !
WM_USER
¡¡! (
+
¡¡) *
$num
¡¡+ ,
)
¡¡, -
,
¡¡- .
SB_GETTEXTLENGTHW
¢¢ 
=
¢¢ 
(
¢¢  !
WM_USER
¢¢! (
+
¢¢) *
$num
¢¢+ -
)
¢¢- .
,
¢¢. /
SB_SETPARTS
££ 
=
££ 
(
££ 
WM_USER
££ "
+
££# $
$num
££% &
)
££& '
,
££' (
SB_GETPARTS
¤¤ 
=
¤¤ 
(
¤¤ 
WM_USER
¤¤ "
+
¤¤# $
$num
¤¤% &
)
¤¤& '
,
¤¤' (
SB_GETBORDERS
¥¥ 
=
¥¥ 
(
¥¥ 
WM_USER
¥¥ $
+
¥¥% &
$num
¥¥' (
)
¥¥( )
,
¥¥) *
SB_SETMINHEIGHT
¦¦ 
=
¦¦ 
(
¦¦ 
WM_USER
¦¦ &
+
¦¦' (
$num
¦¦) *
)
¦¦* +
,
¦¦+ ,
	SB_SIMPLE
§§ 
=
§§ 
(
§§ 
WM_USER
§§  
+
§§! "
$num
§§# $
)
§§$ %
,
§§% &

SB_GETRECT
¨¨ 
=
¨¨ 
(
¨¨ 
WM_USER
¨¨ !
+
¨¨" #
$num
¨¨$ &
)
¨¨& '
,
¨¨' (
SB_ISSIMPLE
©© 
=
©© 
(
©© 
WM_USER
©© "
+
©©# $
$num
©©% '
)
©©' (
,
©©( )

SB_SETICON
ªª 
=
ªª 
(
ªª 
WM_USER
ªª !
+
ªª" #
$num
ªª$ &
)
ªª& '
,
ªª' (
SB_SETTIPTEXTA
«« 
=
«« 
(
«« 
WM_USER
«« %
+
««& '
$num
««( *
)
««* +
,
««+ ,
SB_SETTIPTEXTW
¬¬ 
=
¬¬ 
(
¬¬ 
WM_USER
¬¬ %
+
¬¬& '
$num
¬¬( *
)
¬¬* +
,
¬¬+ ,
SB_GETTIPTEXTA
­­ 
=
­­ 
(
­­ 
WM_USER
­­ %
+
­­& '
$num
­­( *
)
­­* +
,
­­+ ,
SB_GETTIPTEXTW
®® 
=
®® 
(
®® 
WM_USER
®® %
+
®®& '
$num
®®( *
)
®®* +
,
®®+ ,

SB_GETICON
¯¯ 
=
¯¯ 
(
¯¯ 
WM_USER
¯¯ !
+
¯¯" #
$num
¯¯$ &
)
¯¯& '
,
¯¯' (!
SB_SETUNICODEFORMAT
°° 
=
°°  !"
CCM_SETUNICODEFORMAT
°°" 6
,
°°6 7!
SB_GETUNICODEFORMAT
±± 
=
±±  !"
CCM_GETUNICODEFORMAT
±±" 6
,
±±6 7
SB_SETBKCOLOR
²² 
=
²² 
CCM_SETBKCOLOR
²² *
,
²²* +
SB_SIMPLEID
³³ 
=
³³ 
$num
³³  
,
³³  !

TBM_GETPOS
´´ 
=
´´ 
(
´´ 
WM_USER
´´ !
)
´´! "
,
´´" #
TBM_GETRANGEMIN
µµ 
=
µµ 
(
µµ 
WM_USER
µµ &
+
µµ' (
$num
µµ) *
)
µµ* +
,
µµ+ ,
TBM_GETRANGEMAX
¶¶ 
=
¶¶ 
(
¶¶ 
WM_USER
¶¶ &
+
¶¶' (
$num
¶¶) *
)
¶¶* +
,
¶¶+ ,

TBM_GETTIC
·· 
=
·· 
(
·· 
WM_USER
·· !
+
··" #
$num
··$ %
)
··% &
,
··& '

TBM_SETTIC
¸¸ 
=
¸¸ 
(
¸¸ 
WM_USER
¸¸ !
+
¸¸" #
$num
¸¸$ %
)
¸¸% &
,
¸¸& '

TBM_SETPOS
¹¹ 
=
¹¹ 
(
¹¹ 
WM_USER
¹¹ !
+
¹¹" #
$num
¹¹$ %
)
¹¹% &
,
¹¹& '
TBM_SETRANGE
ºº 
=
ºº 
(
ºº 
WM_USER
ºº #
+
ºº$ %
$num
ºº& '
)
ºº' (
,
ºº( )
TBM_SETRANGEMIN
»» 
=
»» 
(
»» 
WM_USER
»» &
+
»»' (
$num
»») *
)
»»* +
,
»»+ ,
TBM_SETRANGEMAX
¼¼ 
=
¼¼ 
(
¼¼ 
WM_USER
¼¼ &
+
¼¼' (
$num
¼¼) *
)
¼¼* +
,
¼¼+ ,
TBM_CLEARTICS
½½ 
=
½½ 
(
½½ 
WM_USER
½½ $
+
½½% &
$num
½½' (
)
½½( )
,
½½) *

TBM_SETSEL
¾¾ 
=
¾¾ 
(
¾¾ 
WM_USER
¾¾ !
+
¾¾" #
$num
¾¾$ &
)
¾¾& '
,
¾¾' (
TBM_SETSELSTART
¿¿ 
=
¿¿ 
(
¿¿ 
WM_USER
¿¿ &
+
¿¿' (
$num
¿¿) +
)
¿¿+ ,
,
¿¿, -
TBM_SETSELEND
ÀÀ 
=
ÀÀ 
(
ÀÀ 
WM_USER
ÀÀ $
+
ÀÀ% &
$num
ÀÀ' )
)
ÀÀ) *
,
ÀÀ* +
TBM_GETPTICS
ÁÁ 
=
ÁÁ 
(
ÁÁ 
WM_USER
ÁÁ #
+
ÁÁ$ %
$num
ÁÁ& (
)
ÁÁ( )
,
ÁÁ) *
TBM_GETTICPOS
ÂÂ 
=
ÂÂ 
(
ÂÂ 
WM_USER
ÂÂ $
+
ÂÂ% &
$num
ÂÂ' )
)
ÂÂ) *
,
ÂÂ* +
TBM_GETNUMTICS
ÃÃ 
=
ÃÃ 
(
ÃÃ 
WM_USER
ÃÃ %
+
ÃÃ& '
$num
ÃÃ( *
)
ÃÃ* +
,
ÃÃ+ ,
TBM_GETSELSTART
ÄÄ 
=
ÄÄ 
(
ÄÄ 
WM_USER
ÄÄ &
+
ÄÄ' (
$num
ÄÄ) +
)
ÄÄ+ ,
,
ÄÄ, -
TBM_GETSELEND
ÅÅ 
=
ÅÅ 
(
ÅÅ 
WM_USER
ÅÅ $
+
ÅÅ% &
$num
ÅÅ' )
)
ÅÅ) *
,
ÅÅ* +
TBM_CLEARSEL
ÆÆ 
=
ÆÆ 
(
ÆÆ 
WM_USER
ÆÆ #
+
ÆÆ$ %
$num
ÆÆ& (
)
ÆÆ( )
,
ÆÆ) *
TBM_SETTICFREQ
ÇÇ 
=
ÇÇ 
(
ÇÇ 
WM_USER
ÇÇ %
+
ÇÇ& '
$num
ÇÇ( *
)
ÇÇ* +
,
ÇÇ+ ,
TBM_SETPAGESIZE
ÈÈ 
=
ÈÈ 
(
ÈÈ 
WM_USER
ÈÈ &
+
ÈÈ' (
$num
ÈÈ) +
)
ÈÈ+ ,
,
ÈÈ, -
TBM_GETPAGESIZE
ÉÉ 
=
ÉÉ 
(
ÉÉ 
WM_USER
ÉÉ &
+
ÉÉ' (
$num
ÉÉ) +
)
ÉÉ+ ,
,
ÉÉ, -
TBM_SETLINESIZE
ÊÊ 
=
ÊÊ 
(
ÊÊ 
WM_USER
ÊÊ &
+
ÊÊ' (
$num
ÊÊ) +
)
ÊÊ+ ,
,
ÊÊ, -
TBM_GETLINESIZE
ËË 
=
ËË 
(
ËË 
WM_USER
ËË &
+
ËË' (
$num
ËË) +
)
ËË+ ,
,
ËË, -
TBM_GETTHUMBRECT
ÌÌ 
=
ÌÌ 
(
ÌÌ  
WM_USER
ÌÌ  '
+
ÌÌ( )
$num
ÌÌ* ,
)
ÌÌ, -
,
ÌÌ- . 
TBM_GETCHANNELRECT
ÍÍ 
=
ÍÍ  
(
ÍÍ! "
WM_USER
ÍÍ" )
+
ÍÍ* +
$num
ÍÍ, .
)
ÍÍ. /
,
ÍÍ/ 0 
TBM_SETTHUMBLENGTH
ÎÎ 
=
ÎÎ  
(
ÎÎ! "
WM_USER
ÎÎ" )
+
ÎÎ* +
$num
ÎÎ, .
)
ÎÎ. /
,
ÎÎ/ 0 
TBM_GETTHUMBLENGTH
ÏÏ 
=
ÏÏ  
(
ÏÏ! "
WM_USER
ÏÏ" )
+
ÏÏ* +
$num
ÏÏ, .
)
ÏÏ. /
,
ÏÏ/ 0
TBM_SETTOOLTIPS
ĞĞ 
=
ĞĞ 
(
ĞĞ 
WM_USER
ĞĞ &
+
ĞĞ' (
$num
ĞĞ) +
)
ĞĞ+ ,
,
ĞĞ, -
TBM_GETTOOLTIPS
ÑÑ 
=
ÑÑ 
(
ÑÑ 
WM_USER
ÑÑ &
+
ÑÑ' (
$num
ÑÑ) +
)
ÑÑ+ ,
,
ÑÑ, -
TBM_SETTIPSIDE
ÒÒ 
=
ÒÒ 
(
ÒÒ 
WM_USER
ÒÒ %
+
ÒÒ& '
$num
ÒÒ( *
)
ÒÒ* +
,
ÒÒ+ ,
TBM_SETBUDDY
ÓÓ 
=
ÓÓ 
(
ÓÓ 
WM_USER
ÓÓ #
+
ÓÓ$ %
$num
ÓÓ& (
)
ÓÓ( )
,
ÓÓ) *
TBM_GETBUDDY
ÔÔ 
=
ÔÔ 
(
ÔÔ 
WM_USER
ÔÔ #
+
ÔÔ$ %
$num
ÔÔ& (
)
ÔÔ( )
,
ÔÔ) *"
TBM_SETUNICODEFORMAT
ÕÕ  
=
ÕÕ! ""
CCM_SETUNICODEFORMAT
ÕÕ# 7
,
ÕÕ7 8"
TBM_GETUNICODEFORMAT
ÖÖ  
=
ÖÖ! ""
CCM_GETUNICODEFORMAT
ÖÖ# 7
,
ÖÖ7 8
DL_BEGINDRAG
×× 
=
×× 
(
×× 
WM_USER
×× #
+
××$ %
$num
××& )
)
××) *
,
××* +
DL_DRAGGING
ØØ 
=
ØØ 
(
ØØ 
WM_USER
ØØ "
+
ØØ# $
$num
ØØ% (
)
ØØ( )
,
ØØ) *

DL_DROPPED
ÙÙ 
=
ÙÙ 
(
ÙÙ 
WM_USER
ÙÙ !
+
ÙÙ" #
$num
ÙÙ$ '
)
ÙÙ' (
,
ÙÙ( )
DL_CANCELDRAG
ÚÚ 
=
ÚÚ 
(
ÚÚ 
WM_USER
ÚÚ $
+
ÚÚ% &
$num
ÚÚ' *
)
ÚÚ* +
,
ÚÚ+ ,
UDM_SETRANGE
ÛÛ 
=
ÛÛ 
(
ÛÛ 
WM_USER
ÛÛ #
+
ÛÛ$ %
$num
ÛÛ& )
)
ÛÛ) *
,
ÛÛ* +
UDM_GETRANGE
ÜÜ 
=
ÜÜ 
(
ÜÜ 
WM_USER
ÜÜ #
+
ÜÜ$ %
$num
ÜÜ& )
)
ÜÜ) *
,
ÜÜ* +

UDM_SETPOS
İİ 
=
İİ 
(
İİ 
WM_USER
İİ !
+
İİ" #
$num
İİ$ '
)
İİ' (
,
İİ( )

UDM_GETPOS
ŞŞ 
=
ŞŞ 
(
ŞŞ 
WM_USER
ŞŞ !
+
ŞŞ" #
$num
ŞŞ$ '
)
ŞŞ' (
,
ŞŞ( )
UDM_SETBUDDY
ßß 
=
ßß 
(
ßß 
WM_USER
ßß #
+
ßß$ %
$num
ßß& )
)
ßß) *
,
ßß* +
UDM_GETBUDDY
àà 
=
àà 
(
àà 
WM_USER
àà #
+
àà$ %
$num
àà& )
)
àà) *
,
àà* +
UDM_SETACCEL
áá 
=
áá 
(
áá 
WM_USER
áá #
+
áá$ %
$num
áá& )
)
áá) *
,
áá* +
UDM_GETACCEL
ââ 
=
ââ 
(
ââ 
WM_USER
ââ #
+
ââ$ %
$num
ââ& )
)
ââ) *
,
ââ* +
UDM_SETBASE
ãã 
=
ãã 
(
ãã 
WM_USER
ãã "
+
ãã# $
$num
ãã% (
)
ãã( )
,
ãã) *
UDM_GETBASE
ää 
=
ää 
(
ää 
WM_USER
ää "
+
ää# $
$num
ää% (
)
ää( )
,
ää) *
UDM_SETRANGE32
åå 
=
åå 
(
åå 
WM_USER
åå %
+
åå& '
$num
åå( +
)
åå+ ,
,
åå, -
UDM_GETRANGE32
ææ 
=
ææ 
(
ææ 
WM_USER
ææ %
+
ææ& '
$num
ææ( +
)
ææ+ ,
,
ææ, -"
UDM_SETUNICODEFORMAT
çç  
=
çç! ""
CCM_SETUNICODEFORMAT
çç# 7
,
çç7 8"
UDM_GETUNICODEFORMAT
èè  
=
èè! ""
CCM_GETUNICODEFORMAT
èè# 7
,
èè7 8
UDM_SETPOS32
éé 
=
éé 
(
éé 
WM_USER
éé #
+
éé$ %
$num
éé& )
)
éé) *
,
éé* +
UDM_GETPOS32
êê 
=
êê 
(
êê 
WM_USER
êê #
+
êê$ %
$num
êê& )
)
êê) *
,
êê* +
PBM_SETRANGE
ëë 
=
ëë 
(
ëë 
WM_USER
ëë #
+
ëë$ %
$num
ëë& '
)
ëë' (
,
ëë( )

PBM_SETPOS
ìì 
=
ìì 
(
ìì 
WM_USER
ìì !
+
ìì" #
$num
ìì$ %
)
ìì% &
,
ìì& '
PBM_DELTAPOS
íí 
=
íí 
(
íí 
WM_USER
íí #
+
íí$ %
$num
íí& '
)
íí' (
,
íí( )
PBM_SETSTEP
îî 
=
îî 
(
îî 
WM_USER
îî "
+
îî# $
$num
îî% &
)
îî& '
,
îî' (

PBM_STEPIT
ïï 
=
ïï 
(
ïï 
WM_USER
ïï !
+
ïï" #
$num
ïï$ %
)
ïï% &
,
ïï& '
PBM_SETRANGE32
ğğ 
=
ğğ 
(
ğğ 
WM_USER
ğğ %
+
ğğ& '
$num
ğğ( )
)
ğğ) *
,
ğğ* +
PBM_GETRANGE
ññ 
=
ññ 
(
ññ 
WM_USER
ññ #
+
ññ$ %
$num
ññ& '
)
ññ' (
,
ññ( )

PBM_GETPOS
òò 
=
òò 
(
òò 
WM_USER
òò !
+
òò" #
$num
òò$ %
)
òò% &
,
òò& '
PBM_SETBARCOLOR
óó 
=
óó 
(
óó 
WM_USER
óó &
+
óó' (
$num
óó) *
)
óó* +
,
óó+ ,
PBM_SETBKCOLOR
ôô 
=
ôô 
CCM_SETBKCOLOR
ôô +
,
ôô+ ,
HKM_SETHOTKEY
õõ 
=
õõ 
(
õõ 
WM_USER
õõ $
+
õõ% &
$num
õõ' (
)
õõ( )
,
õõ) *
HKM_GETHOTKEY
öö 
=
öö 
(
öö 
WM_USER
öö $
+
öö% &
$num
öö' (
)
öö( )
,
öö) *
HKM_SETRULES
÷÷ 
=
÷÷ 
(
÷÷ 
WM_USER
÷÷ #
+
÷÷$ %
$num
÷÷& '
)
÷÷' (
,
÷÷( )"
LVM_SETUNICODEFORMAT
øø  
=
øø! ""
CCM_SETUNICODEFORMAT
øø# 7
,
øø7 8"
LVM_GETUNICODEFORMAT
ùù  
=
ùù! ""
CCM_GETUNICODEFORMAT
ùù# 7
,
ùù7 8
LVM_GETBKCOLOR
úú 
=
úú 
(
úú 
	LVM_FIRST
úú '
+
úú( )
$num
úú* +
)
úú+ ,
,
úú, -
LVM_SETBKCOLOR
ûû 
=
ûû 
(
ûû 
	LVM_FIRST
ûû '
+
ûû( )
$num
ûû* +
)
ûû+ ,
,
ûû, -
LVM_GETIMAGELIST
üü 
=
üü 
(
üü  
	LVM_FIRST
üü  )
+
üü* +
$num
üü, -
)
üü- .
,
üü. /
LVM_SETIMAGELIST
ıı 
=
ıı 
(
ıı  
	LVM_FIRST
ıı  )
+
ıı* +
$num
ıı, -
)
ıı- .
,
ıı. /
LVM_GETITEMCOUNT
şş 
=
şş 
(
şş  
	LVM_FIRST
şş  )
+
şş* +
$num
şş, -
)
şş- .
,
şş. /
LVM_GETITEMA
ÿÿ 
=
ÿÿ 
(
ÿÿ 
	LVM_FIRST
ÿÿ %
+
ÿÿ& '
$num
ÿÿ( )
)
ÿÿ) *
,
ÿÿ* +
LVM_GETITEMW
€€ 
=
€€ 
(
€€ 
	LVM_FIRST
€€ %
+
€€& '
$num
€€( *
)
€€* +
,
€€+ ,
LVM_SETITEMA
 
=
 
(
 
	LVM_FIRST
 %
+
& '
$num
( )
)
) *
,
* +
LVM_SETITEMW
‚‚ 
=
‚‚ 
(
‚‚ 
	LVM_FIRST
‚‚ %
+
‚‚& '
$num
‚‚( *
)
‚‚* +
,
‚‚+ ,
LVM_INSERTITEMA
ƒƒ 
=
ƒƒ 
(
ƒƒ 
	LVM_FIRST
ƒƒ (
+
ƒƒ) *
$num
ƒƒ+ ,
)
ƒƒ, -
,
ƒƒ- .
LVM_INSERTITEMW
„„ 
=
„„ 
(
„„ 
	LVM_FIRST
„„ (
+
„„) *
$num
„„+ -
)
„„- .
,
„„. /
LVM_DELETEITEM
…… 
=
…… 
(
…… 
	LVM_FIRST
…… '
+
……( )
$num
……* +
)
……+ ,
,
……, - 
LVM_DELETEALLITEMS
†† 
=
††  
(
††! "
	LVM_FIRST
††" +
+
††, -
$num
††. /
)
††/ 0
,
††0 1!
LVM_GETCALLBACKMASK
‡‡ 
=
‡‡  !
(
‡‡" #
	LVM_FIRST
‡‡# ,
+
‡‡- .
$num
‡‡/ 1
)
‡‡1 2
,
‡‡2 3!
LVM_SETCALLBACKMASK
ˆˆ 
=
ˆˆ  !
(
ˆˆ" #
	LVM_FIRST
ˆˆ# ,
+
ˆˆ- .
$num
ˆˆ/ 1
)
ˆˆ1 2
,
ˆˆ2 3
LVM_FINDITEMA
‰‰ 
=
‰‰ 
(
‰‰ 
	LVM_FIRST
‰‰ &
+
‰‰' (
$num
‰‰) +
)
‰‰+ ,
,
‰‰, -
LVM_FINDITEMW
ŠŠ 
=
ŠŠ 
(
ŠŠ 
	LVM_FIRST
ŠŠ &
+
ŠŠ' (
$num
ŠŠ) +
)
ŠŠ+ ,
,
ŠŠ, -
LVM_GETITEMRECT
‹‹ 
=
‹‹ 
(
‹‹ 
	LVM_FIRST
‹‹ (
+
‹‹) *
$num
‹‹+ -
)
‹‹- .
,
‹‹. /!
LVM_SETITEMPOSITION
ŒŒ 
=
ŒŒ  !
(
ŒŒ" #
	LVM_FIRST
ŒŒ# ,
+
ŒŒ- .
$num
ŒŒ/ 1
)
ŒŒ1 2
,
ŒŒ2 3!
LVM_GETITEMPOSITION
 
=
  !
(
" #
	LVM_FIRST
# ,
+
- .
$num
/ 1
)
1 2
,
2 3!
LVM_GETSTRINGWIDTHA
 
=
  !
(
" #
	LVM_FIRST
# ,
+
- .
$num
/ 1
)
1 2
,
2 3!
LVM_GETSTRINGWIDTHW
 
=
  !
(
" #
	LVM_FIRST
# ,
+
- .
$num
/ 1
)
1 2
,
2 3
LVM_HITTEST
 
=
 
(
 
	LVM_FIRST
 $
+
% &
$num
' )
)
) *
,
* +
LVM_ENSUREVISIBLE
‘‘ 
=
‘‘ 
(
‘‘  !
	LVM_FIRST
‘‘! *
+
‘‘+ ,
$num
‘‘- /
)
‘‘/ 0
,
‘‘0 1

LVM_SCROLL
’’ 
=
’’ 
(
’’ 
	LVM_FIRST
’’ #
+
’’$ %
$num
’’& (
)
’’( )
,
’’) *
LVM_REDRAWITEMS
““ 
=
““ 
(
““ 
	LVM_FIRST
““ (
+
““) *
$num
““+ -
)
““- .
,
““. /
LVM_ARRANGE
”” 
=
”” 
(
”” 
	LVM_FIRST
”” $
+
””% &
$num
””' )
)
””) *
,
””* +
LVM_EDITLABELA
•• 
=
•• 
(
•• 
	LVM_FIRST
•• '
+
••( )
$num
••* ,
)
••, -
,
••- .
LVM_EDITLABELW
–– 
=
–– 
(
–– 
	LVM_FIRST
–– '
+
––( )
$num
––* -
)
––- .
,
––. / 
LVM_GETEDITCONTROL
—— 
=
——  
(
——! "
	LVM_FIRST
——" +
+
——, -
$num
——. 0
)
——0 1
,
——1 2
LVM_GETCOLUMNA
˜˜ 
=
˜˜ 
(
˜˜ 
	LVM_FIRST
˜˜ '
+
˜˜( )
$num
˜˜* ,
)
˜˜, -
,
˜˜- .
LVM_GETCOLUMNW
™™ 
=
™™ 
(
™™ 
	LVM_FIRST
™™ '
+
™™( )
$num
™™* ,
)
™™, -
,
™™- .
LVM_SETCOLUMNA
šš 
=
šš 
(
šš 
	LVM_FIRST
šš '
+
šš( )
$num
šš* ,
)
šš, -
,
šš- .
LVM_SETCOLUMNW
›› 
=
›› 
(
›› 
	LVM_FIRST
›› '
+
››( )
$num
››* ,
)
››, -
,
››- .
LVM_INSERTCOLUMNA
œœ 
=
œœ 
(
œœ  !
	LVM_FIRST
œœ! *
+
œœ+ ,
$num
œœ- /
)
œœ/ 0
,
œœ0 1
LVM_INSERTCOLUMNW
 
=
 
(
  !
	LVM_FIRST
! *
+
+ ,
$num
- /
)
/ 0
,
0 1
LVM_DELETECOLUMN
 
=
 
(
  
	LVM_FIRST
  )
+
* +
$num
, .
)
. /
,
/ 0 
LVM_GETCOLUMNWIDTH
ŸŸ 
=
ŸŸ  
(
ŸŸ! "
	LVM_FIRST
ŸŸ" +
+
ŸŸ, -
$num
ŸŸ. 0
)
ŸŸ0 1
,
ŸŸ1 2 
LVM_SETCOLUMNWIDTH
   
=
    
(
  ! "
	LVM_FIRST
  " +
+
  , -
$num
  . 0
)
  0 1
,
  1 2!
LVM_CREATEDRAGIMAGE
¡¡ 
=
¡¡  !
(
¡¡" #
	LVM_FIRST
¡¡# ,
+
¡¡- .
$num
¡¡/ 1
)
¡¡1 2
,
¡¡2 3
LVM_GETVIEWRECT
¢¢ 
=
¢¢ 
(
¢¢ 
	LVM_FIRST
¢¢ (
+
¢¢) *
$num
¢¢+ -
)
¢¢- .
,
¢¢. /
LVM_GETTEXTCOLOR
££ 
=
££ 
(
££  
	LVM_FIRST
££  )
+
££* +
$num
££, .
)
££. /
,
££/ 0
LVM_SETTEXTCOLOR
¤¤ 
=
¤¤ 
(
¤¤  
	LVM_FIRST
¤¤  )
+
¤¤* +
$num
¤¤, .
)
¤¤. /
,
¤¤/ 0 
LVM_GETTEXTBKCOLOR
¥¥ 
=
¥¥  
(
¥¥! "
	LVM_FIRST
¥¥" +
+
¥¥, -
$num
¥¥. 0
)
¥¥0 1
,
¥¥1 2 
LVM_SETTEXTBKCOLOR
¦¦ 
=
¦¦  
(
¦¦! "
	LVM_FIRST
¦¦" +
+
¦¦, -
$num
¦¦. 0
)
¦¦0 1
,
¦¦1 2
LVM_GETTOPINDEX
§§ 
=
§§ 
(
§§ 
	LVM_FIRST
§§ (
+
§§) *
$num
§§+ -
)
§§- .
,
§§. /!
LVM_GETCOUNTPERPAGE
¨¨ 
=
¨¨  !
(
¨¨" #
	LVM_FIRST
¨¨# ,
+
¨¨- .
$num
¨¨/ 1
)
¨¨1 2
,
¨¨2 3
LVM_GETORIGIN
©© 
=
©© 
(
©© 
	LVM_FIRST
©© &
+
©©' (
$num
©©) +
)
©©+ ,
,
©©, -

LVM_UPDATE
ªª 
=
ªª 
(
ªª 
	LVM_FIRST
ªª #
+
ªª$ %
$num
ªª& (
)
ªª( )
,
ªª) *
LVM_SETITEMSTATE
«« 
=
«« 
(
««  
	LVM_FIRST
««  )
+
««* +
$num
««, .
)
««. /
,
««/ 0
LVM_GETITEMSTATE
¬¬ 
=
¬¬ 
(
¬¬  
	LVM_FIRST
¬¬  )
+
¬¬* +
$num
¬¬, .
)
¬¬. /
,
¬¬/ 0
LVM_GETITEMTEXTA
­­ 
=
­­ 
(
­­  
	LVM_FIRST
­­  )
+
­­* +
$num
­­, .
)
­­. /
,
­­/ 0
LVM_GETITEMTEXTW
®® 
=
®® 
(
®®  
	LVM_FIRST
®®  )
+
®®* +
$num
®®, /
)
®®/ 0
,
®®0 1
LVM_SETITEMTEXTA
¯¯ 
=
¯¯ 
(
¯¯  
	LVM_FIRST
¯¯  )
+
¯¯* +
$num
¯¯, .
)
¯¯. /
,
¯¯/ 0
LVM_SETITEMTEXTW
°° 
=
°° 
(
°°  
	LVM_FIRST
°°  )
+
°°* +
$num
°°, /
)
°°/ 0
,
°°0 1
LVM_SETITEMCOUNT
±± 
=
±± 
(
±±  
	LVM_FIRST
±±  )
+
±±* +
$num
±±, .
)
±±. /
,
±±/ 0
LVM_SORTITEMS
²² 
=
²² 
(
²² 
	LVM_FIRST
²² &
+
²²' (
$num
²²) +
)
²²+ ,
,
²², -#
LVM_SETITEMPOSITION32
³³ !
=
³³" #
(
³³$ %
	LVM_FIRST
³³% .
+
³³/ 0
$num
³³1 3
)
³³3 4
,
³³4 5"
LVM_GETSELECTEDCOUNT
´´  
=
´´! "
(
´´# $
	LVM_FIRST
´´$ -
+
´´. /
$num
´´0 2
)
´´2 3
,
´´3 4 
LVM_GETITEMSPACING
µµ 
=
µµ  
(
µµ! "
	LVM_FIRST
µµ" +
+
µµ, -
$num
µµ. 0
)
µµ0 1
,
µµ1 2#
LVM_GETISEARCHSTRINGA
¶¶ !
=
¶¶" #
(
¶¶$ %
	LVM_FIRST
¶¶% .
+
¶¶/ 0
$num
¶¶1 3
)
¶¶3 4
,
¶¶4 5#
LVM_GETISEARCHSTRINGW
·· !
=
··" #
(
··$ %
	LVM_FIRST
··% .
+
··/ 0
$num
··1 4
)
··4 5
,
··5 6 
LVM_SETICONSPACING
¸¸ 
=
¸¸  
(
¸¸! "
	LVM_FIRST
¸¸" +
+
¸¸, -
$num
¸¸. 0
)
¸¸0 1
,
¸¸1 2*
LVM_SETEXTENDEDLISTVIEWSTYLE
¹¹ (
=
¹¹) *
(
¹¹+ ,
	LVM_FIRST
¹¹, 5
+
¹¹6 7
$num
¹¹8 :
)
¹¹: ;
,
¹¹; <*
LVM_GETEXTENDEDLISTVIEWSTYLE
ºº (
=
ºº) *
(
ºº+ ,
	LVM_FIRST
ºº, 5
+
ºº6 7
$num
ºº8 :
)
ºº: ;
,
ºº; < 
LVM_GETSUBITEMRECT
»» 
=
»»  
(
»»! "
	LVM_FIRST
»»" +
+
»», -
$num
»». 0
)
»»0 1
,
»»1 2 
LVM_SUBITEMHITTEST
¼¼ 
=
¼¼  
(
¼¼! "
	LVM_FIRST
¼¼" +
+
¼¼, -
$num
¼¼. 0
)
¼¼0 1
,
¼¼1 2%
LVM_SETCOLUMNORDERARRAY
½½ #
=
½½$ %
(
½½& '
	LVM_FIRST
½½' 0
+
½½1 2
$num
½½3 5
)
½½5 6
,
½½6 7%
LVM_GETCOLUMNORDERARRAY
¾¾ #
=
¾¾$ %
(
¾¾& '
	LVM_FIRST
¾¾' 0
+
¾¾1 2
$num
¾¾3 5
)
¾¾5 6
,
¾¾6 7
LVM_SETHOTITEM
¿¿ 
=
¿¿ 
(
¿¿ 
	LVM_FIRST
¿¿ '
+
¿¿( )
$num
¿¿* ,
)
¿¿, -
,
¿¿- .
LVM_GETHOTITEM
ÀÀ 
=
ÀÀ 
(
ÀÀ 
	LVM_FIRST
ÀÀ '
+
ÀÀ( )
$num
ÀÀ* ,
)
ÀÀ, -
,
ÀÀ- .
LVM_SETHOTCURSOR
ÁÁ 
=
ÁÁ 
(
ÁÁ  
	LVM_FIRST
ÁÁ  )
+
ÁÁ* +
$num
ÁÁ, .
)
ÁÁ. /
,
ÁÁ/ 0
LVM_GETHOTCURSOR
ÂÂ 
=
ÂÂ 
(
ÂÂ  
	LVM_FIRST
ÂÂ  )
+
ÂÂ* +
$num
ÂÂ, .
)
ÂÂ. /
,
ÂÂ/ 0%
LVM_APPROXIMATEVIEWRECT
ÃÃ #
=
ÃÃ$ %
(
ÃÃ& '
	LVM_FIRST
ÃÃ' 0
+
ÃÃ1 2
$num
ÃÃ3 5
)
ÃÃ5 6
,
ÃÃ6 7
LVM_SETWORKAREAS
ÄÄ 
=
ÄÄ 
(
ÄÄ  
	LVM_FIRST
ÄÄ  )
+
ÄÄ* +
$num
ÄÄ, .
)
ÄÄ. /
,
ÄÄ/ 0
LVM_GETWORKAREAS
ÅÅ 
=
ÅÅ 
(
ÅÅ  
	LVM_FIRST
ÅÅ  )
+
ÅÅ* +
$num
ÅÅ, .
)
ÅÅ. /
,
ÅÅ/ 0&
LVM_GETNUMBEROFWORKAREAS
ÆÆ $
=
ÆÆ% &
(
ÆÆ' (
	LVM_FIRST
ÆÆ( 1
+
ÆÆ2 3
$num
ÆÆ4 6
)
ÆÆ6 7
,
ÆÆ7 8"
LVM_GETSELECTIONMARK
ÇÇ  
=
ÇÇ! "
(
ÇÇ# $
	LVM_FIRST
ÇÇ$ -
+
ÇÇ. /
$num
ÇÇ0 2
)
ÇÇ2 3
,
ÇÇ3 4"
LVM_SETSELECTIONMARK
ÈÈ  
=
ÈÈ! "
(
ÈÈ# $
	LVM_FIRST
ÈÈ$ -
+
ÈÈ. /
$num
ÈÈ0 2
)
ÈÈ2 3
,
ÈÈ3 4
LVM_SETHOVERTIME
ÉÉ 
=
ÉÉ 
(
ÉÉ  
	LVM_FIRST
ÉÉ  )
+
ÉÉ* +
$num
ÉÉ, .
)
ÉÉ. /
,
ÉÉ/ 0
LVM_GETHOVERTIME
ÊÊ 
=
ÊÊ 
(
ÊÊ  
	LVM_FIRST
ÊÊ  )
+
ÊÊ* +
$num
ÊÊ, .
)
ÊÊ. /
,
ÊÊ/ 0
LVM_SETTOOLTIPS
ËË 
=
ËË 
(
ËË 
	LVM_FIRST
ËË (
+
ËË) *
$num
ËË+ -
)
ËË- .
,
ËË. /
LVM_GETTOOLTIPS
ÌÌ 
=
ÌÌ 
(
ÌÌ 
	LVM_FIRST
ÌÌ (
+
ÌÌ) *
$num
ÌÌ+ -
)
ÌÌ- .
,
ÌÌ. /
LVM_SORTITEMSEX
ÍÍ 
=
ÍÍ 
(
ÍÍ 
	LVM_FIRST
ÍÍ (
+
ÍÍ) *
$num
ÍÍ+ -
)
ÍÍ- .
,
ÍÍ. /
LVM_SETBKIMAGEA
ÎÎ 
=
ÎÎ 
(
ÎÎ 
	LVM_FIRST
ÎÎ (
+
ÎÎ) *
$num
ÎÎ+ -
)
ÎÎ- .
,
ÎÎ. /
LVM_SETBKIMAGEW
ÏÏ 
=
ÏÏ 
(
ÏÏ 
	LVM_FIRST
ÏÏ (
+
ÏÏ) *
$num
ÏÏ+ .
)
ÏÏ. /
,
ÏÏ/ 0
LVM_GETBKIMAGEA
ĞĞ 
=
ĞĞ 
(
ĞĞ 
	LVM_FIRST
ĞĞ (
+
ĞĞ) *
$num
ĞĞ+ -
)
ĞĞ- .
,
ĞĞ. /
LVM_GETBKIMAGEW
ÑÑ 
=
ÑÑ 
(
ÑÑ 
	LVM_FIRST
ÑÑ (
+
ÑÑ) *
$num
ÑÑ+ .
)
ÑÑ. /
,
ÑÑ/ 0#
LVM_SETSELECTEDCOLUMN
ÒÒ !
=
ÒÒ" #
(
ÒÒ$ %
	LVM_FIRST
ÒÒ% .
+
ÒÒ/ 0
$num
ÒÒ1 4
)
ÒÒ4 5
,
ÒÒ5 6
LVM_SETTILEWIDTH
ÓÓ 
=
ÓÓ 
(
ÓÓ  
	LVM_FIRST
ÓÓ  )
+
ÓÓ* +
$num
ÓÓ, /
)
ÓÓ/ 0
,
ÓÓ0 1
LVM_SETVIEW
ÔÔ 
=
ÔÔ 
(
ÔÔ 
	LVM_FIRST
ÔÔ $
+
ÔÔ% &
$num
ÔÔ' *
)
ÔÔ* +
,
ÔÔ+ ,
LVM_GETVIEW
ÕÕ 
=
ÕÕ 
(
ÕÕ 
	LVM_FIRST
ÕÕ $
+
ÕÕ% &
$num
ÕÕ' *
)
ÕÕ* +
,
ÕÕ+ ,
LVM_INSERTGROUP
ÖÖ 
=
ÖÖ 
(
ÖÖ 
	LVM_FIRST
ÖÖ (
+
ÖÖ) *
$num
ÖÖ+ .
)
ÖÖ. /
,
ÖÖ/ 0
LVM_SETGROUPINFO
×× 
=
×× 
(
××  
	LVM_FIRST
××  )
+
××* +
$num
××, /
)
××/ 0
,
××0 1
LVM_GETGROUPINFO
ØØ 
=
ØØ 
(
ØØ  
	LVM_FIRST
ØØ  )
+
ØØ* +
$num
ØØ, /
)
ØØ/ 0
,
ØØ0 1
LVM_REMOVEGROUP
ÙÙ 
=
ÙÙ 
(
ÙÙ 
	LVM_FIRST
ÙÙ (
+
ÙÙ) *
$num
ÙÙ+ .
)
ÙÙ. /
,
ÙÙ/ 0
LVM_MOVEGROUP
ÚÚ 
=
ÚÚ 
(
ÚÚ 
	LVM_FIRST
ÚÚ &
+
ÚÚ' (
$num
ÚÚ) ,
)
ÚÚ, -
,
ÚÚ- .!
LVM_MOVEITEMTOGROUP
ÛÛ 
=
ÛÛ  !
(
ÛÛ" #
	LVM_FIRST
ÛÛ# ,
+
ÛÛ- .
$num
ÛÛ/ 2
)
ÛÛ2 3
,
ÛÛ3 4!
LVM_SETGROUPMETRICS
ÜÜ 
=
ÜÜ  !
(
ÜÜ" #
	LVM_FIRST
ÜÜ# ,
+
ÜÜ- .
$num
ÜÜ/ 2
)
ÜÜ2 3
,
ÜÜ3 4!
LVM_GETGROUPMETRICS
İİ 
=
İİ  !
(
İİ" #
	LVM_FIRST
İİ# ,
+
İİ- .
$num
İİ/ 2
)
İİ2 3
,
İİ3 4!
LVM_ENABLEGROUPVIEW
ŞŞ 
=
ŞŞ  !
(
ŞŞ" #
	LVM_FIRST
ŞŞ# ,
+
ŞŞ- .
$num
ŞŞ/ 2
)
ŞŞ2 3
,
ŞŞ3 4
LVM_SORTGROUPS
ßß 
=
ßß 
(
ßß 
	LVM_FIRST
ßß '
+
ßß( )
$num
ßß* -
)
ßß- .
,
ßß. /#
LVM_INSERTGROUPSORTED
àà !
=
àà" #
(
àà$ %
	LVM_FIRST
àà% .
+
àà/ 0
$num
àà1 4
)
àà4 5
,
àà5 6!
LVM_REMOVEALLGROUPS
áá 
=
áá  !
(
áá" #
	LVM_FIRST
áá# ,
+
áá- .
$num
áá/ 2
)
áá2 3
,
áá3 4
LVM_HASGROUP
ââ 
=
ââ 
(
ââ 
	LVM_FIRST
ââ %
+
ââ& '
$num
ââ( +
)
ââ+ ,
,
ââ, -!
LVM_SETTILEVIEWINFO
ãã 
=
ãã  !
(
ãã" #
	LVM_FIRST
ãã# ,
+
ãã- .
$num
ãã/ 2
)
ãã2 3
,
ãã3 4!
LVM_GETTILEVIEWINFO
ää 
=
ää  !
(
ää" #
	LVM_FIRST
ää# ,
+
ää- .
$num
ää/ 2
)
ää2 3
,
ää3 4
LVM_SETTILEINFO
åå 
=
åå 
(
åå 
	LVM_FIRST
åå (
+
åå) *
$num
åå+ .
)
åå. /
,
åå/ 0
LVM_GETTILEINFO
ææ 
=
ææ 
(
ææ 
	LVM_FIRST
ææ (
+
ææ) *
$num
ææ+ .
)
ææ. /
,
ææ/ 0
LVM_SETINSERTMARK
çç 
=
çç 
(
çç  !
	LVM_FIRST
çç! *
+
çç+ ,
$num
çç- 0
)
çç0 1
,
çç1 2
LVM_GETINSERTMARK
èè 
=
èè 
(
èè  !
	LVM_FIRST
èè! *
+
èè+ ,
$num
èè- 0
)
èè0 1
,
èè1 2#
LVM_INSERTMARKHITTEST
éé !
=
éé" #
(
éé$ %
	LVM_FIRST
éé% .
+
éé/ 0
$num
éé1 4
)
éé4 5
,
éé5 6#
LVM_GETINSERTMARKRECT
êê !
=
êê" #
(
êê$ %
	LVM_FIRST
êê% .
+
êê/ 0
$num
êê1 4
)
êê4 5
,
êê5 6$
LVM_SETINSERTMARKCOLOR
ëë "
=
ëë# $
(
ëë% &
	LVM_FIRST
ëë& /
+
ëë0 1
$num
ëë2 5
)
ëë5 6
,
ëë6 7$
LVM_GETINSERTMARKCOLOR
ìì "
=
ìì# $
(
ìì% &
	LVM_FIRST
ìì& /
+
ìì0 1
$num
ìì2 5
)
ìì5 6
,
ìì6 7
LVM_SETINFOTIP
íí 
=
íí 
(
íí 
	LVM_FIRST
íí '
+
íí( )
$num
íí* -
)
íí- .
,
íí. /#
LVM_GETSELECTEDCOLUMN
îî !
=
îî" #
(
îî$ %
	LVM_FIRST
îî% .
+
îî/ 0
$num
îî1 4
)
îî4 5
,
îî5 6$
LVM_ISGROUPVIEWENABLED
ïï "
=
ïï# $
(
ïï% &
	LVM_FIRST
ïï& /
+
ïï0 1
$num
ïï2 5
)
ïï5 6
,
ïï6 7!
LVM_GETOUTLINECOLOR
ğğ 
=
ğğ  !
(
ğğ" #
	LVM_FIRST
ğğ# ,
+
ğğ- .
$num
ğğ/ 2
)
ğğ2 3
,
ğğ3 4!
LVM_SETOUTLINECOLOR
ññ 
=
ññ  !
(
ññ" #
	LVM_FIRST
ññ# ,
+
ññ- .
$num
ññ/ 2
)
ññ2 3
,
ññ3 4!
LVM_CANCELEDITLABEL
òò 
=
òò  !
(
òò" #
	LVM_FIRST
òò# ,
+
òò- .
$num
òò/ 2
)
òò2 3
,
òò3 4
LVM_MAPINDEXTOID
óó 
=
óó 
(
óó  
	LVM_FIRST
óó  )
+
óó* +
$num
óó, /
)
óó/ 0
,
óó0 1
LVM_MAPIDTOINDEX
ôô 
=
ôô 
(
ôô  
	LVM_FIRST
ôô  )
+
ôô* +
$num
ôô, /
)
ôô/ 0
,
ôô0 1
TVM_INSERTITEMA
õõ 
=
õõ 
(
õõ 
TV_FIRST
õõ '
+
õõ( )
$num
õõ* +
)
õõ+ ,
,
õõ, -
TVM_INSERTITEMW
öö 
=
öö 
(
öö 
TV_FIRST
öö '
+
öö( )
$num
öö* ,
)
öö, -
,
öö- .
TVM_DELETEITEM
÷÷ 
=
÷÷ 
(
÷÷ 
TV_FIRST
÷÷ &
+
÷÷' (
$num
÷÷) *
)
÷÷* +
,
÷÷+ ,

TVM_EXPAND
øø 
=
øø 
(
øø 
TV_FIRST
øø "
+
øø# $
$num
øø% &
)
øø& '
,
øø' (
TVM_GETITEMRECT
ùù 
=
ùù 
(
ùù 
TV_FIRST
ùù '
+
ùù( )
$num
ùù* +
)
ùù+ ,
,
ùù, -
TVM_GETCOUNT
úú 
=
úú 
(
úú 
TV_FIRST
úú $
+
úú% &
$num
úú' (
)
úú( )
,
úú) *
TVM_GETINDENT
ûû 
=
ûû 
(
ûû 
TV_FIRST
ûû %
+
ûû& '
$num
ûû( )
)
ûû) *
,
ûû* +
TVM_SETINDENT
üü 
=
üü 
(
üü 
TV_FIRST
üü %
+
üü& '
$num
üü( )
)
üü) *
,
üü* +
TVM_GETIMAGELIST
ıı 
=
ıı 
(
ıı  
TV_FIRST
ıı  (
+
ıı) *
$num
ıı+ ,
)
ıı, -
,
ıı- .
TVM_SETIMAGELIST
şş 
=
şş 
(
şş  
TV_FIRST
şş  (
+
şş) *
$num
şş+ ,
)
şş, -
,
şş- .
TVM_GETNEXTITEM
ÿÿ 
=
ÿÿ 
(
ÿÿ 
TV_FIRST
ÿÿ '
+
ÿÿ( )
$num
ÿÿ* ,
)
ÿÿ, -
,
ÿÿ- .
TVM_SELECTITEM
€€ 
=
€€ 
(
€€ 
TV_FIRST
€€ &
+
€€' (
$num
€€) +
)
€€+ ,
,
€€, -
TVM_GETITEMA
 
=
 
(
 
TV_FIRST
 $
+
% &
$num
' )
)
) *
,
* +
TVM_GETITEMW
‚‚ 
=
‚‚ 
(
‚‚ 
TV_FIRST
‚‚ $
+
‚‚% &
$num
‚‚' )
)
‚‚) *
,
‚‚* +
TVM_SETITEMA
ƒƒ 
=
ƒƒ 
(
ƒƒ 
TV_FIRST
ƒƒ $
+
ƒƒ% &
$num
ƒƒ' )
)
ƒƒ) *
,
ƒƒ* +
TVM_SETITEMW
„„ 
=
„„ 
(
„„ 
TV_FIRST
„„ $
+
„„% &
$num
„„' )
)
„„) *
,
„„* +
TVM_EDITLABELA
…… 
=
…… 
(
…… 
TV_FIRST
…… &
+
……' (
$num
……) +
)
……+ ,
,
……, -
TVM_EDITLABELW
†† 
=
†† 
(
†† 
TV_FIRST
†† &
+
††' (
$num
††) +
)
††+ ,
,
††, - 
TVM_GETEDITCONTROL
‡‡ 
=
‡‡  
(
‡‡! "
TV_FIRST
‡‡" *
+
‡‡+ ,
$num
‡‡- /
)
‡‡/ 0
,
‡‡0 1!
TVM_GETVISIBLECOUNT
ˆˆ 
=
ˆˆ  !
(
ˆˆ" #
TV_FIRST
ˆˆ# +
+
ˆˆ, -
$num
ˆˆ. 0
)
ˆˆ0 1
,
ˆˆ1 2
TVM_HITTEST
‰‰ 
=
‰‰ 
(
‰‰ 
TV_FIRST
‰‰ #
+
‰‰$ %
$num
‰‰& (
)
‰‰( )
,
‰‰) *!
TVM_CREATEDRAGIMAGE
ŠŠ 
=
ŠŠ  !
(
ŠŠ" #
TV_FIRST
ŠŠ# +
+
ŠŠ, -
$num
ŠŠ. 0
)
ŠŠ0 1
,
ŠŠ1 2
TVM_SORTCHILDREN
‹‹ 
=
‹‹ 
(
‹‹  
TV_FIRST
‹‹  (
+
‹‹) *
$num
‹‹+ -
)
‹‹- .
,
‹‹. /
TVM_ENSUREVISIBLE
ŒŒ 
=
ŒŒ 
(
ŒŒ  !
TV_FIRST
ŒŒ! )
+
ŒŒ* +
$num
ŒŒ, .
)
ŒŒ. /
,
ŒŒ/ 0 
TVM_SORTCHILDRENCB
 
=
  
(
! "
TV_FIRST
" *
+
+ ,
$num
- /
)
/ 0
,
0 1!
TVM_ENDEDITLABELNOW
 
=
  !
(
" #
TV_FIRST
# +
+
, -
$num
. 0
)
0 1
,
1 2#
TVM_GETISEARCHSTRINGA
 !
=
" #
(
$ %
TV_FIRST
% -
+
. /
$num
0 2
)
2 3
,
3 4#
TVM_GETISEARCHSTRINGW
 !
=
" #
(
$ %
TV_FIRST
% -
+
. /
$num
0 2
)
2 3
,
3 4
TVM_SETTOOLTIPS
‘‘ 
=
‘‘ 
(
‘‘ 
TV_FIRST
‘‘ '
+
‘‘( )
$num
‘‘* ,
)
‘‘, -
,
‘‘- .
TVM_GETTOOLTIPS
’’ 
=
’’ 
(
’’ 
TV_FIRST
’’ '
+
’’( )
$num
’’* ,
)
’’, -
,
’’- .
TVM_SETINSERTMARK
““ 
=
““ 
(
““  !
TV_FIRST
““! )
+
““* +
$num
““, .
)
““. /
,
““/ 0"
TVM_SETUNICODEFORMAT
””  
=
””! ""
CCM_SETUNICODEFORMAT
””# 7
,
””7 8"
TVM_GETUNICODEFORMAT
••  
=
••! ""
CCM_GETUNICODEFORMAT
••# 7
,
••7 8
TVM_SETITEMHEIGHT
–– 
=
–– 
(
––  !
TV_FIRST
––! )
+
––* +
$num
––, .
)
––. /
,
––/ 0
TVM_GETITEMHEIGHT
—— 
=
—— 
(
——  !
TV_FIRST
——! )
+
——* +
$num
——, .
)
——. /
,
——/ 0
TVM_SETBKCOLOR
˜˜ 
=
˜˜ 
(
˜˜ 
TV_FIRST
˜˜ &
+
˜˜' (
$num
˜˜) +
)
˜˜+ ,
,
˜˜, -
TVM_SETTEXTCOLOR
™™ 
=
™™ 
(
™™  
TV_FIRST
™™  (
+
™™) *
$num
™™+ -
)
™™- .
,
™™. /
TVM_GETBKCOLOR
šš 
=
šš 
(
šš 
TV_FIRST
šš &
+
šš' (
$num
šš) +
)
šš+ ,
,
šš, -
TVM_GETTEXTCOLOR
›› 
=
›› 
(
››  
TV_FIRST
››  (
+
››) *
$num
››+ -
)
››- .
,
››. /
TVM_SETSCROLLTIME
œœ 
=
œœ 
(
œœ  !
TV_FIRST
œœ! )
+
œœ* +
$num
œœ, .
)
œœ. /
,
œœ/ 0
TVM_GETSCROLLTIME
 
=
 
(
  !
TV_FIRST
! )
+
* +
$num
, .
)
. /
,
/ 0$
TVM_SETINSERTMARKCOLOR
 "
=
# $
(
% &
TV_FIRST
& .
+
/ 0
$num
1 3
)
3 4
,
4 5$
TVM_GETINSERTMARKCOLOR
ŸŸ "
=
ŸŸ# $
(
ŸŸ% &
TV_FIRST
ŸŸ& .
+
ŸŸ/ 0
$num
ŸŸ1 3
)
ŸŸ3 4
,
ŸŸ4 5
TVM_GETITEMSTATE
   
=
   
(
    
TV_FIRST
    (
+
  ) *
$num
  + -
)
  - .
,
  . /
TVM_SETLINECOLOR
¡¡ 
=
¡¡ 
(
¡¡  
TV_FIRST
¡¡  (
+
¡¡) *
$num
¡¡+ -
)
¡¡- .
,
¡¡. /
TVM_GETLINECOLOR
¢¢ 
=
¢¢ 
(
¢¢  
TV_FIRST
¢¢  (
+
¢¢) *
$num
¢¢+ -
)
¢¢- .
,
¢¢. /%
TVM_MAPACCIDTOHTREEITEM
££ #
=
££$ %
(
££& '
TV_FIRST
££' /
+
££0 1
$num
££2 4
)
££4 5
,
££5 6%
TVM_MAPHTREEITEMTOACCID
¤¤ #
=
¤¤$ %
(
¤¤& '
TV_FIRST
¤¤' /
+
¤¤0 1
$num
¤¤2 4
)
¤¤4 5
,
¤¤5 6
CBEM_INSERTITEMA
¥¥ 
=
¥¥ 
(
¥¥  
WM_USER
¥¥  '
+
¥¥( )
$num
¥¥* +
)
¥¥+ ,
,
¥¥, -
CBEM_SETIMAGELIST
¦¦ 
=
¦¦ 
(
¦¦  !
WM_USER
¦¦! (
+
¦¦) *
$num
¦¦+ ,
)
¦¦, -
,
¦¦- .
CBEM_GETIMAGELIST
§§ 
=
§§ 
(
§§  !
WM_USER
§§! (
+
§§) *
$num
§§+ ,
)
§§, -
,
§§- .
CBEM_GETITEMA
¨¨ 
=
¨¨ 
(
¨¨ 
WM_USER
¨¨ $
+
¨¨% &
$num
¨¨' (
)
¨¨( )
,
¨¨) *
CBEM_SETITEMA
©© 
=
©© 
(
©© 
WM_USER
©© $
+
©©% &
$num
©©' (
)
©©( )
,
©©) *
CBEM_DELETEITEM
ªª 
=
ªª 
CB_DELETESTRING
ªª -
,
ªª- ."
CBEM_GETCOMBOCONTROL
««  
=
««! "
(
««# $
WM_USER
««$ +
+
««, -
$num
««. /
)
««/ 0
,
««0 1!
CBEM_GETEDITCONTROL
¬¬ 
=
¬¬  !
(
¬¬" #
WM_USER
¬¬# *
+
¬¬+ ,
$num
¬¬- .
)
¬¬. /
,
¬¬/ 0#
CBEM_SETEXTENDEDSTYLE
­­ !
=
­­" #
(
­­$ %
WM_USER
­­% ,
+
­­- .
$num
­­/ 1
)
­­1 2
,
­­2 3#
CBEM_GETEXTENDEDSTYLE
®® !
=
®®" #
(
®®$ %
WM_USER
®®% ,
+
®®- .
$num
®®/ 0
)
®®0 1
,
®®1 2#
CBEM_SETUNICODEFORMAT
¯¯ !
=
¯¯" #"
CCM_SETUNICODEFORMAT
¯¯$ 8
,
¯¯8 9#
CBEM_GETUNICODEFORMAT
°° !
=
°°" #"
CCM_GETUNICODEFORMAT
°°$ 8
,
°°8 9
CBEM_SETEXSTYLE
±± 
=
±± 
(
±± 
WM_USER
±± &
+
±±' (
$num
±±) *
)
±±* +
,
±±+ ,
CBEM_GETEXSTYLE
²² 
=
²² 
(
²² 
WM_USER
²² &
+
²²' (
$num
²²) *
)
²²* +
,
²²+ ,!
CBEM_HASEDITCHANGED
³³ 
=
³³  !
(
³³" #
WM_USER
³³# *
+
³³+ ,
$num
³³- /
)
³³/ 0
,
³³0 1
CBEM_INSERTITEMW
´´ 
=
´´ 
(
´´  
WM_USER
´´  '
+
´´( )
$num
´´* ,
)
´´, -
,
´´- .
CBEM_SETITEMW
µµ 
=
µµ 
(
µµ 
WM_USER
µµ $
+
µµ% &
$num
µµ' )
)
µµ) *
,
µµ* +
CBEM_GETITEMW
¶¶ 
=
¶¶ 
(
¶¶ 
WM_USER
¶¶ $
+
¶¶% &
$num
¶¶' )
)
¶¶) *
,
¶¶* +
TCM_GETIMAGELIST
·· 
=
·· 
(
··  
	TCM_FIRST
··  )
+
··* +
$num
··, -
)
··- .
,
··. /
TCM_SETIMAGELIST
¸¸ 
=
¸¸ 
(
¸¸  
	TCM_FIRST
¸¸  )
+
¸¸* +
$num
¸¸, -
)
¸¸- .
,
¸¸. /
TCM_GETITEMCOUNT
¹¹ 
=
¹¹ 
(
¹¹  
	TCM_FIRST
¹¹  )
+
¹¹* +
$num
¹¹, -
)
¹¹- .
,
¹¹. /
TCM_GETITEMA
ºº 
=
ºº 
(
ºº 
	TCM_FIRST
ºº %
+
ºº& '
$num
ºº( )
)
ºº) *
,
ºº* +
TCM_GETITEMW
»» 
=
»» 
(
»» 
	TCM_FIRST
»» %
+
»»& '
$num
»»( *
)
»»* +
,
»»+ ,
TCM_SETITEMA
¼¼ 
=
¼¼ 
(
¼¼ 
	TCM_FIRST
¼¼ %
+
¼¼& '
$num
¼¼( )
)
¼¼) *
,
¼¼* +
TCM_SETITEMW
½½ 
=
½½ 
(
½½ 
	TCM_FIRST
½½ %
+
½½& '
$num
½½( *
)
½½* +
,
½½+ ,
TCM_INSERTITEMA
¾¾ 
=
¾¾ 
(
¾¾ 
	TCM_FIRST
¾¾ (
+
¾¾) *
$num
¾¾+ ,
)
¾¾, -
,
¾¾- .
TCM_INSERTITEMW
¿¿ 
=
¿¿ 
(
¿¿ 
	TCM_FIRST
¿¿ (
+
¿¿) *
$num
¿¿+ -
)
¿¿- .
,
¿¿. /
TCM_DELETEITEM
ÀÀ 
=
ÀÀ 
(
ÀÀ 
	TCM_FIRST
ÀÀ '
+
ÀÀ( )
$num
ÀÀ* +
)
ÀÀ+ ,
,
ÀÀ, - 
TCM_DELETEALLITEMS
ÁÁ 
=
ÁÁ  
(
ÁÁ! "
	TCM_FIRST
ÁÁ" +
+
ÁÁ, -
$num
ÁÁ. /
)
ÁÁ/ 0
,
ÁÁ0 1
TCM_GETITEMRECT
ÂÂ 
=
ÂÂ 
(
ÂÂ 
	TCM_FIRST
ÂÂ (
+
ÂÂ) *
$num
ÂÂ+ -
)
ÂÂ- .
,
ÂÂ. /
TCM_GETCURSEL
ÃÃ 
=
ÃÃ 
(
ÃÃ 
	TCM_FIRST
ÃÃ &
+
ÃÃ' (
$num
ÃÃ) +
)
ÃÃ+ ,
,
ÃÃ, -
TCM_SETCURSEL
ÄÄ 
=
ÄÄ 
(
ÄÄ 
	TCM_FIRST
ÄÄ &
+
ÄÄ' (
$num
ÄÄ) +
)
ÄÄ+ ,
,
ÄÄ, -
TCM_HITTEST
ÅÅ 
=
ÅÅ 
(
ÅÅ 
	TCM_FIRST
ÅÅ $
+
ÅÅ% &
$num
ÅÅ' )
)
ÅÅ) *
,
ÅÅ* +
TCM_SETITEMEXTRA
ÆÆ 
=
ÆÆ 
(
ÆÆ  
	TCM_FIRST
ÆÆ  )
+
ÆÆ* +
$num
ÆÆ, .
)
ÆÆ. /
,
ÆÆ/ 0
TCM_ADJUSTRECT
ÇÇ 
=
ÇÇ 
(
ÇÇ 
	TCM_FIRST
ÇÇ '
+
ÇÇ( )
$num
ÇÇ* ,
)
ÇÇ, -
,
ÇÇ- .
TCM_SETITEMSIZE
ÈÈ 
=
ÈÈ 
(
ÈÈ 
	TCM_FIRST
ÈÈ (
+
ÈÈ) *
$num
ÈÈ+ -
)
ÈÈ- .
,
ÈÈ. /
TCM_REMOVEIMAGE
ÉÉ 
=
ÉÉ 
(
ÉÉ 
	TCM_FIRST
ÉÉ (
+
ÉÉ) *
$num
ÉÉ+ -
)
ÉÉ- .
,
ÉÉ. /
TCM_SETPADDING
ÊÊ 
=
ÊÊ 
(
ÊÊ 
	TCM_FIRST
ÊÊ '
+
ÊÊ( )
$num
ÊÊ* ,
)
ÊÊ, -
,
ÊÊ- .
TCM_GETROWCOUNT
ËË 
=
ËË 
(
ËË 
	TCM_FIRST
ËË (
+
ËË) *
$num
ËË+ -
)
ËË- .
,
ËË. /
TCM_GETTOOLTIPS
ÌÌ 
=
ÌÌ 
(
ÌÌ 
	TCM_FIRST
ÌÌ (
+
ÌÌ) *
$num
ÌÌ+ -
)
ÌÌ- .
,
ÌÌ. /
TCM_SETTOOLTIPS
ÍÍ 
=
ÍÍ 
(
ÍÍ 
	TCM_FIRST
ÍÍ (
+
ÍÍ) *
$num
ÍÍ+ -
)
ÍÍ- .
,
ÍÍ. /
TCM_GETCURFOCUS
ÎÎ 
=
ÎÎ 
(
ÎÎ 
	TCM_FIRST
ÎÎ (
+
ÎÎ) *
$num
ÎÎ+ -
)
ÎÎ- .
,
ÎÎ. /
TCM_SETCURFOCUS
ÏÏ 
=
ÏÏ 
(
ÏÏ 
	TCM_FIRST
ÏÏ (
+
ÏÏ) *
$num
ÏÏ+ -
)
ÏÏ- .
,
ÏÏ. / 
TCM_SETMINTABWIDTH
ĞĞ 
=
ĞĞ  
(
ĞĞ! "
	TCM_FIRST
ĞĞ" +
+
ĞĞ, -
$num
ĞĞ. 0
)
ĞĞ0 1
,
ĞĞ1 2
TCM_DESELECTALL
ÑÑ 
=
ÑÑ 
(
ÑÑ 
	TCM_FIRST
ÑÑ (
+
ÑÑ) *
$num
ÑÑ+ -
)
ÑÑ- .
,
ÑÑ. /
TCM_HIGHLIGHTITEM
ÒÒ 
=
ÒÒ 
(
ÒÒ  !
	TCM_FIRST
ÒÒ! *
+
ÒÒ+ ,
$num
ÒÒ- /
)
ÒÒ/ 0
,
ÒÒ0 1"
TCM_SETEXTENDEDSTYLE
ÓÓ  
=
ÓÓ! "
(
ÓÓ# $
	TCM_FIRST
ÓÓ$ -
+
ÓÓ. /
$num
ÓÓ0 2
)
ÓÓ2 3
,
ÓÓ3 4"
TCM_GETEXTENDEDSTYLE
ÔÔ  
=
ÔÔ! "
(
ÔÔ# $
	TCM_FIRST
ÔÔ$ -
+
ÔÔ. /
$num
ÔÔ0 2
)
ÔÔ2 3
,
ÔÔ3 4"
TCM_SETUNICODEFORMAT
ÕÕ  
=
ÕÕ! ""
CCM_SETUNICODEFORMAT
ÕÕ# 7
,
ÕÕ7 8"
TCM_GETUNICODEFORMAT
ÖÖ  
=
ÖÖ! ""
CCM_GETUNICODEFORMAT
ÖÖ# 7
,
ÖÖ7 8
	ACM_OPENA
×× 
=
×× 
(
×× 
WM_USER
××  
+
××! "
$num
××# &
)
××& '
,
××' (
	ACM_OPENW
ØØ 
=
ØØ 
(
ØØ 
WM_USER
ØØ  
+
ØØ! "
$num
ØØ# &
)
ØØ& '
,
ØØ' (
ACM_PLAY
ÙÙ 
=
ÙÙ 
(
ÙÙ 
WM_USER
ÙÙ 
+
ÙÙ  !
$num
ÙÙ" %
)
ÙÙ% &
,
ÙÙ& '
ACM_STOP
ÚÚ 
=
ÚÚ 
(
ÚÚ 
WM_USER
ÚÚ 
+
ÚÚ  !
$num
ÚÚ" %
)
ÚÚ% &
,
ÚÚ& '
	MCM_FIRST
ÛÛ 
=
ÛÛ 
$num
ÛÛ 
,
ÛÛ 
MCM_GETCURSEL
ÜÜ 
=
ÜÜ 
(
ÜÜ 
	MCM_FIRST
ÜÜ &
+
ÜÜ' (
$num
ÜÜ) *
)
ÜÜ* +
,
ÜÜ+ ,
MCM_SETCURSEL
İİ 
=
İİ 
(
İİ 
	MCM_FIRST
İİ &
+
İİ' (
$num
İİ) *
)
İİ* +
,
İİ+ , 
MCM_GETMAXSELCOUNT
ŞŞ 
=
ŞŞ  
(
ŞŞ! "
	MCM_FIRST
ŞŞ" +
+
ŞŞ, -
$num
ŞŞ. /
)
ŞŞ/ 0
,
ŞŞ0 1 
MCM_SETMAXSELCOUNT
ßß 
=
ßß  
(
ßß! "
	MCM_FIRST
ßß" +
+
ßß, -
$num
ßß. /
)
ßß/ 0
,
ßß0 1
MCM_GETSELRANGE
àà 
=
àà 
(
àà 
	MCM_FIRST
àà (
+
àà) *
$num
àà+ ,
)
àà, -
,
àà- .
MCM_SETSELRANGE
áá 
=
áá 
(
áá 
	MCM_FIRST
áá (
+
áá) *
$num
áá+ ,
)
áá, -
,
áá- .
MCM_GETMONTHRANGE
ââ 
=
ââ 
(
ââ  !
	MCM_FIRST
ââ! *
+
ââ+ ,
$num
ââ- .
)
ââ. /
,
ââ/ 0
MCM_SETDAYSTATE
ãã 
=
ãã 
(
ãã 
	MCM_FIRST
ãã (
+
ãã) *
$num
ãã+ ,
)
ãã, -
,
ãã- .
MCM_GETMINREQRECT
ää 
=
ää 
(
ää  !
	MCM_FIRST
ää! *
+
ää+ ,
$num
ää- .
)
ää. /
,
ää/ 0
MCM_SETCOLOR
åå 
=
åå 
(
åå 
	MCM_FIRST
åå %
+
åå& '
$num
åå( *
)
åå* +
,
åå+ ,
MCM_GETCOLOR
ææ 
=
ææ 
(
ææ 
	MCM_FIRST
ææ %
+
ææ& '
$num
ææ( *
)
ææ* +
,
ææ+ ,
MCM_SETTODAY
çç 
=
çç 
(
çç 
	MCM_FIRST
çç %
+
çç& '
$num
çç( *
)
çç* +
,
çç+ ,
MCM_GETTODAY
èè 
=
èè 
(
èè 
	MCM_FIRST
èè %
+
èè& '
$num
èè( *
)
èè* +
,
èè+ ,
MCM_HITTEST
éé 
=
éé 
(
éé 
	MCM_FIRST
éé $
+
éé% &
$num
éé' )
)
éé) *
,
éé* +#
MCM_SETFIRSTDAYOFWEEK
êê !
=
êê" #
(
êê$ %
	MCM_FIRST
êê% .
+
êê/ 0
$num
êê1 3
)
êê3 4
,
êê4 5#
MCM_GETFIRSTDAYOFWEEK
ëë !
=
ëë" #
(
ëë$ %
	MCM_FIRST
ëë% .
+
ëë/ 0
$num
ëë1 3
)
ëë3 4
,
ëë4 5
MCM_GETRANGE
ìì 
=
ìì 
(
ìì 
	MCM_FIRST
ìì %
+
ìì& '
$num
ìì( *
)
ìì* +
,
ìì+ ,
MCM_SETRANGE
íí 
=
íí 
(
íí 
	MCM_FIRST
íí %
+
íí& '
$num
íí( *
)
íí* +
,
íí+ ,
MCM_GETMONTHDELTA
îî 
=
îî 
(
îî  !
	MCM_FIRST
îî! *
+
îî+ ,
$num
îî- /
)
îî/ 0
,
îî0 1
MCM_SETMONTHDELTA
ïï 
=
ïï 
(
ïï  !
	MCM_FIRST
ïï! *
+
ïï+ ,
$num
ïï- /
)
ïï/ 0
,
ïï0 1"
MCM_GETMAXTODAYWIDTH
ğğ  
=
ğğ! "
(
ğğ# $
	MCM_FIRST
ğğ$ -
+
ğğ. /
$num
ğğ0 2
)
ğğ2 3
,
ğğ3 4"
MCM_SETUNICODEFORMAT
ññ  
=
ññ! ""
CCM_SETUNICODEFORMAT
ññ# 7
,
ññ7 8"
MCM_GETUNICODEFORMAT
òò  
=
òò! ""
CCM_GETUNICODEFORMAT
òò# 7
,
òò7 8
	DTM_FIRST
óó 
=
óó 
$num
óó 
,
óó 
DTM_GETSYSTEMTIME
ôô 
=
ôô 
(
ôô  !
	DTM_FIRST
ôô! *
+
ôô+ ,
$num
ôô- .
)
ôô. /
,
ôô/ 0
DTM_SETSYSTEMTIME
õõ 
=
õõ 
(
õõ  !
	DTM_FIRST
õõ! *
+
õõ+ ,
$num
õõ- .
)
õõ. /
,
õõ/ 0
DTM_GETRANGE
öö 
=
öö 
(
öö 
	DTM_FIRST
öö %
+
öö& '
$num
öö( )
)
öö) *
,
öö* +
DTM_SETRANGE
÷÷ 
=
÷÷ 
(
÷÷ 
	DTM_FIRST
÷÷ %
+
÷÷& '
$num
÷÷( )
)
÷÷) *
,
÷÷* +
DTM_SETFORMATA
øø 
=
øø 
(
øø 
	DTM_FIRST
øø '
+
øø( )
$num
øø* +
)
øø+ ,
,
øø, -
DTM_SETFORMATW
ùù 
=
ùù 
(
ùù 
	DTM_FIRST
ùù '
+
ùù( )
$num
ùù* ,
)
ùù, -
,
ùù- .
DTM_SETMCCOLOR
úú 
=
úú 
(
úú 
	DTM_FIRST
úú '
+
úú( )
$num
úú* +
)
úú+ ,
,
úú, -
DTM_GETMCCOLOR
ûû 
=
ûû 
(
ûû 
	DTM_FIRST
ûû '
+
ûû( )
$num
ûû* +
)
ûû+ ,
,
ûû, -
DTM_GETMONTHCAL
üü 
=
üü 
(
üü 
	DTM_FIRST
üü (
+
üü) *
$num
üü+ ,
)
üü, -
,
üü- .
DTM_SETMCFONT
ıı 
=
ıı 
(
ıı 
	DTM_FIRST
ıı &
+
ıı' (
$num
ıı) *
)
ıı* +
,
ıı+ ,
DTM_GETMCFONT
şş 
=
şş 
(
şş 
	DTM_FIRST
şş &
+
şş' (
$num
şş) +
)
şş+ ,
,
şş, -
PGM_SETCHILD
ÿÿ 
=
ÿÿ 
(
ÿÿ 
	PGM_FIRST
ÿÿ %
+
ÿÿ& '
$num
ÿÿ( )
)
ÿÿ) *
,
ÿÿ* +
PGM_RECALCSIZE
€€ 
=
€€ 
(
€€ 
	PGM_FIRST
€€ '
+
€€( )
$num
€€* +
)
€€+ ,
,
€€, -
PGM_FORWARDMOUSE
 
=
 
(
  
	PGM_FIRST
  )
+
* +
$num
, -
)
- .
,
. /
PGM_SETBKCOLOR
‚‚ 
=
‚‚ 
(
‚‚ 
	PGM_FIRST
‚‚ '
+
‚‚( )
$num
‚‚* +
)
‚‚+ ,
,
‚‚, -
PGM_GETBKCOLOR
ƒƒ 
=
ƒƒ 
(
ƒƒ 
	PGM_FIRST
ƒƒ '
+
ƒƒ( )
$num
ƒƒ* +
)
ƒƒ+ ,
,
ƒƒ, -
PGM_SETBORDER
„„ 
=
„„ 
(
„„ 
	PGM_FIRST
„„ &
+
„„' (
$num
„„) *
)
„„* +
,
„„+ ,
PGM_GETBORDER
…… 
=
…… 
(
…… 
	PGM_FIRST
…… &
+
……' (
$num
……) *
)
……* +
,
……+ ,

PGM_SETPOS
†† 
=
†† 
(
†† 
	PGM_FIRST
†† #
+
††$ %
$num
††& '
)
††' (
,
††( )

PGM_GETPOS
‡‡ 
=
‡‡ 
(
‡‡ 
	PGM_FIRST
‡‡ #
+
‡‡$ %
$num
‡‡& '
)
‡‡' (
,
‡‡( )
PGM_SETBUTTONSIZE
ˆˆ 
=
ˆˆ 
(
ˆˆ  !
	PGM_FIRST
ˆˆ! *
+
ˆˆ+ ,
$num
ˆˆ- /
)
ˆˆ/ 0
,
ˆˆ0 1
PGM_GETBUTTONSIZE
‰‰ 
=
‰‰ 
(
‰‰  !
	PGM_FIRST
‰‰! *
+
‰‰+ ,
$num
‰‰- /
)
‰‰/ 0
,
‰‰0 1 
PGM_GETBUTTONSTATE
ŠŠ 
=
ŠŠ  
(
ŠŠ! "
	PGM_FIRST
ŠŠ" +
+
ŠŠ, -
$num
ŠŠ. 0
)
ŠŠ0 1
,
ŠŠ1 2
PGM_GETDROPTARGET
‹‹ 
=
‹‹ 
CCM_GETDROPTARGET
‹‹  1
,
‹‹1 2
BCM_GETIDEALSIZE
ŒŒ 
=
ŒŒ 
(
ŒŒ  
	BCM_FIRST
ŒŒ  )
+
ŒŒ* +
$num
ŒŒ, 2
)
ŒŒ2 3
,
ŒŒ3 4
BCM_SETIMAGELIST
 
=
 
(
  
	BCM_FIRST
  )
+
* +
$num
, 2
)
2 3
,
3 4
BCM_GETIMAGELIST
 
=
 
(
  
	BCM_FIRST
  )
+
* +
$num
, 2
)
2 3
,
3 4
BCM_SETTEXTMARGIN
 
=
 
(
  !
	BCM_FIRST
! *
+
+ ,
$num
- 3
)
3 4
,
4 5
BCM_GETTEXTMARGIN
 
=
 
(
  !
	BCM_FIRST
! *
+
+ ,
$num
- 3
)
3 4
,
4 5
EM_SETCUEBANNER
‘‘ 
=
‘‘ 
(
‘‘ 
	ECM_FIRST
‘‘ (
+
‘‘) *
$num
‘‘+ ,
)
‘‘, -
,
‘‘- .
EM_GETCUEBANNER
’’ 
=
’’ 
(
’’ 
	ECM_FIRST
’’ (
+
’’) *
$num
’’+ ,
)
’’, -
,
’’- .
EM_SHOWBALLOONTIP
““ 
=
““ 
(
““  !
	ECM_FIRST
““! *
+
““+ ,
$num
““- .
)
““. /
,
““/ 0
EM_HIDEBALLOONTIP
”” 
=
”” 
(
””  !
	ECM_FIRST
””! *
+
””+ ,
$num
””- .
)
””. /
,
””/ 0
CB_SETMINVISIBLE
•• 
=
•• 
(
••  
	CBM_FIRST
••  )
+
••* +
$num
••, -
)
••- .
,
••. /
CB_GETMINVISIBLE
–– 
=
–– 
(
––  
	CBM_FIRST
––  )
+
––* +
$num
––, -
)
––- .
,
––. /

LM_HITTEST
—— 
=
—— 
(
—— 
WM_USER
—— !
+
——" #
$num
——$ )
)
——) *
,
——* +
LM_GETIDEALHEIGHT
˜˜ 
=
˜˜ 
(
˜˜  !
WM_USER
˜˜! (
+
˜˜) *
$num
˜˜+ 0
)
˜˜0 1
,
˜˜1 2

LM_SETITEM
™™ 
=
™™ 
(
™™ 
WM_USER
™™ !
+
™™" #
$num
™™$ )
)
™™) *
,
™™* +

LM_GETITEM
šš 
=
šš 
(
šš 
WM_USER
šš !
+
šš" #
$num
šš$ )
)
šš) *
}
›› 	
public
ŸŸ 
enum
ŸŸ 

FWinStyles
ŸŸ 
:
ŸŸ  
int
ŸŸ! $
{
   	
WS_OVERLAPPED
¡¡ 
=
¡¡ 
$num
¡¡ &
,
¡¡& '
WS_POPUP
¢¢ 
=
¢¢ 
-
¢¢ 
$num
¢¢ "
,
¢¢" #
WS_CHILD
££ 
=
££ 
$num
££ !
,
££! "
WS_MINIMIZE
¤¤ 
=
¤¤ 
$num
¤¤ $
,
¤¤$ %

WS_VISIBLE
¥¥ 
=
¥¥ 
$num
¥¥ #
,
¥¥# $
WS_DISABLED
¦¦ 
=
¦¦ 
$num
¦¦ $
,
¦¦$ %
WS_CLIPSIBLINGS
§§ 
=
§§ 
$num
§§ (
,
§§( )
WS_CLIPCHILDREN
¨¨ 
=
¨¨ 
$num
¨¨ (
,
¨¨( )
WS_MAXIMIZE
©© 
=
©© 
$num
©© $
,
©©$ %

WS_CAPTION
ªª 
=
ªª 
$num
ªª #
,
ªª# $
	WS_BORDER
«« 
=
«« 
$num
«« "
,
««" #
WS_DLGFRAME
¬¬ 
=
¬¬ 
$num
¬¬ $
,
¬¬$ %

WS_VSCROLL
­­ 
=
­­ 
$num
­­ #
,
­­# $

WS_HSCROLL
®® 
=
®® 
$num
®® #
,
®®# $

WS_SYSMENU
¯¯ 
=
¯¯ 
$num
¯¯ #
,
¯¯# $
WS_THICKFRAME
°° 
=
°° 
$num
°° &
,
°°& '
WS_GROUP
±± 
=
±± 
$num
±± !
,
±±! "

WS_TABSTOP
²² 
=
²² 
$num
²² #
,
²²# $
WS_MINIMIZEBOX
³³ 
=
³³ 
$num
³³ '
,
³³' (
WS_MAXIMIZEBOX
´´ 
=
´´ 
$num
´´ '
,
´´' (
WS_TILED
µµ 
=
µµ 
WS_OVERLAPPED
µµ $
,
µµ$ %
	WS_ICONIC
¶¶ 
=
¶¶ 
WS_MINIMIZE
¶¶ #
,
¶¶# $

WS_SIZEBOX
·· 
=
·· 
WS_THICKFRAME
·· &
,
··& '
WS_TILEDWINDOW
¸¸ 
=
¸¸ !
WS_OVERLAPPEDWINDOW
¸¸ 0
,
¸¸0 1!
WS_OVERLAPPEDWINDOW
¹¹ 
=
¹¹  !
(
¹¹" #
WS_OVERLAPPED
¹¹# 0
|
¹¹1 2

WS_CAPTION
¹¹3 =
|
¹¹> ?

WS_SYSMENU
¹¹@ J
|
¹¹K L
WS_THICKFRAME
¹¹M Z
|
¹¹[ \
WS_MINIMIZEBOX
¹¹] k
|
¹¹l m
WS_MAXIMIZEBOX
¹¹n |
)
¹¹| }
,
¹¹} ~
WS_POPUPWINDOW
ºº 
=
ºº 
(
ºº 
WS_POPUP
ºº &
|
ºº' (
	WS_BORDER
ºº) 2
|
ºº3 4

WS_SYSMENU
ºº5 ?
)
ºº? @
,
ºº@ A
WS_CHILDWINDOW
»» 
=
»» 
(
»» 
WS_CHILD
»» &
)
»»& '
}
¼¼ 	
public
ÀÀ 
enum
ÀÀ 

FNCHITTEST
ÀÀ 
{
ÁÁ 	
HTERROR
ÈÈ 
=
ÈÈ 
(
ÈÈ 
-
ÈÈ 
$num
ÈÈ 
)
ÈÈ 
,
ÈÈ 
HTTRANSPARENT
ĞĞ 
=
ĞĞ 
(
ĞĞ 
-
ĞĞ 
$num
ĞĞ 
)
ĞĞ  
,
ĞĞ  !
	HTNOWHERE
×× 
=
×× 
$num
×× 
,
×× 
HTCLIENT
ŞŞ 
=
ŞŞ 
$num
ŞŞ 
,
ŞŞ 
	HTCAPTION
åå 
=
åå 
$num
åå 
,
åå 
	HTSYSMENU
ìì 
=
ìì 
$num
ìì 
,
ìì 
	HTGROWBOX
óó 
=
óó 
$num
óó 
,
óó 
HTMENU
úú 
=
úú 
$num
úú 
,
úú 
	HTHSCROLL
		 
=
		 
$num
		 
,
		 
	HTVSCROLL
ˆ	ˆ	 
=
ˆ	ˆ	 
$num
ˆ	ˆ	 
,
ˆ	ˆ	 
HTMINBUTTON
		 
=
		 
$num
		 
,
		 
HTMAXBUTTON
–	–	 
=
–	–	 
$num
–	–	 
,
–	–	 
HTLEFT
		 
=
		 
$num
		 
,
		 
HTRIGHT
¦	¦	 
=
¦	¦	 
$num
¦	¦	 
,
¦	¦	 
HTTOP
­	­	 
=
­	­	 
$num
­	­	 
,
­	­	 
	HTTOPLEFT
´	´	 
=
´	´	 
$num
´	´	 
,
´	´	 

HTTOPRIGHT
»	»	 
=
»	»	 
$num
»	»	 
,
»	»	 
HTBOTTOM
Ã	Ã	 
=
Ã	Ã	 
$num
Ã	Ã	 
,
Ã	Ã	 
HTBOTTOMLEFT
Ë	Ë	 
=
Ë	Ë	 
$num
Ë	Ë	 
,
Ë	Ë	 
HTBOTTOMRIGHT
Ó	Ó	 
=
Ó	Ó	 
$num
Ó	Ó	 
,
Ó	Ó	 
HTBORDER
Ú	Ú	 
=
Ú	Ú	 
$num
Ú	Ú	 
,
Ú	Ú	 
HTOBJECT
ß	ß	 
=
ß	ß	 
$num
ß	ß	 
,
ß	ß	 
HTCLOSE
æ	æ	 
=
æ	æ	 
$num
æ	æ	 
,
æ	æ	 
HTHELP
í	í	 
=
í	í	 
$num
í	í	 
,
í	í	 
}
î	î	 	
public
ò	ò	 
enum
ò	ò	 
FSysMetrics
ò	ò	 
:
ò	ò	  !
int
ò	ò	" %
{
ó	ó	 	
SM_CXSCREEN
ù	ù	 
=
ù	ù	 
$num
ù	ù	 
,
ù	ù	 
SM_CYSCREEN
€
€
 
=
€
€
 
$num
€
€
 
,
€
€
 
SM_CXFULLSCREEN
‡
‡
 
=
‡
‡
 
$num
‡
‡
  
,
‡
‡
  !
SM_CYFULLSCREEN


 
=


 
$num


  
,


  !
	SM_CYMENU
•
•
 
=
•
•
 
$num
•
•
 
,
•
•
 
SM_CYCAPTION
œ
œ
 
=
œ
œ
 
$num
œ
œ
 
,
œ
œ
 

SM_CXFRAME
£
£
 
=
£
£
 
$num
£
£
 
,
£
£
 
SM_CXHSCROLL
ª
ª
 
=
ª
ª
 
$num
ª
ª
 
,
ª
ª
 
SM_CYHSCROLL
±
±
 
=
±
±
 
$num
±
±
 
,
±
±
 
SM_CXVSCROLL
¸
¸
 
=
¸
¸
 
$num
¸
¸
 
,
¸
¸
 
SM_CYVSCROLL
¿
¿
 
=
¿
¿
 
$num
¿
¿
 
,
¿
¿
 
	SM_CXSIZE
Æ
Æ
 
=
Æ
Æ
 
$num
Æ
Æ
 
,
Æ
Æ
 
	SM_CYSIZE
Í
Í
 
=
Í
Í
 
$num
Í
Í
 
,
Í
Í
 
SM_CXCURSOR
Ô
Ô
 
=
Ô
Ô
 
$num
Ô
Ô
 
,
Ô
Ô
 
SM_CYCURSOR
Û
Û
 
=
Û
Û
 
$num
Û
Û
 
}
Ü
Ü
 	
public
à
à
 
enum
à
à
  
FCredUIReturnCodes
à
à
 &
{
á
á
 	
NO_ERROR
â
â
 
=
â
â
 
$num
â
â
 
,
â
â
 
ERROR_CANCELLED
ã
ã
 
=
ã
ã
 
$num
ã
ã
 "
,
ã
ã
" #)
ERROR_NO_SUCH_LOGON_SESSION
ä
ä
 '
=
ä
ä
( )
$num
ä
ä
* .
,
ä
ä
. /
ERROR_NOT_FOUND
å
å
 
=
å
å
 
$num
å
å
 "
,
å
å
" #(
ERROR_INVALID_ACCOUNT_NAME
æ
æ
 &
=
æ
æ
' (
$num
æ
æ
) -
,
æ
æ
- .'
ERROR_INSUFFICIENT_BUFFER
ç
ç
 %
=
ç
ç
& '
$num
ç
ç
( +
,
ç
ç
+ ,%
ERROR_INVALID_PARAMETER
è
è
 #
=
è
è
$ %
$num
è
è
& (
,
è
è
( )!
ERROR_INVALID_FLAGS
é
é
 
=
é
é
  !
$num
é
é
" &
,
é
é
& '!
ERROR_BAD_ARGUMENTS
ê
ê
 
=
ê
ê
  !
$num
ê
ê
" %
}
ë
ë
 	
[
ï
ï
 	
Flags
ï
ï
	 
]
ï
ï
 
public
ğ
ğ
 
enum
ğ
ğ
 
FCREDUI_FLAGS
ğ
ğ
 !
{
ñ
ñ
 	 
INCORRECT_PASSWORD
ò
ò
 
=
ò
ò
  
$num
ò
ò
! $
,
ò
ò
$ %
DO_NOT_PERSIST
ó
ó
 
=
ó
ó
 
$num
ó
ó
  
,
ó
ó
  !#
REQUEST_ADMINISTRATOR
ô
ô
 !
=
ô
ô
" #
$num
ô
ô
$ '
,
ô
ô
' ("
EXCLUDE_CERTIFICATES
õ
õ
  
=
õ
õ
! "
$num
õ
õ
# &
,
õ
õ
& '!
REQUIRE_CERTIFICATE
ö
ö
 
=
ö
ö
  !
$num
ö
ö
" &
,
ö
ö
& '!
SHOW_SAVE_CHECK_BOX
÷
÷
 
=
÷
÷
  !
$num
÷
÷
" &
,
÷
÷
& '
ALWAYS_SHOW_UI
ø
ø
 
=
ø
ø
 
$num
ø
ø
 !
,
ø
ø
! "
REQUIRE_SMARTCARD
ù
ù
 
=
ù
ù
 
$num
ù
ù
  %
,
ù
ù
% &
PASSWORD_ONLY_OK
ú
ú
 
=
ú
ú
 
$num
ú
ú
 $
,
ú
ú
$ %
VALIDATE_USERNAME
û
û
 
=
û
û
 
$num
û
û
  %
,
û
û
% &
COMPLETE_USERNAME
ü
ü
 
=
ü
ü
 
$num
ü
ü
  %
,
ü
ü
% &
PERSIST
ı
ı
 
=
ı
ı
 
$num
ı
ı
 
,
ı
ı
 
SERVER_CREDENTIAL
ş
ş
 
=
ş
ş
 
$num
ş
ş
  &
,
ş
ş
& '!
EXPECT_CONFIRMATION
ÿ
ÿ
 
=
ÿ
ÿ
  !
$num
ÿ
ÿ
" )
,
ÿ
ÿ
) *!
GENERIC_CREDENTIALS
€€ 
=
€€  !
$num
€€" )
,
€€) *)
USERNAME_TARGET_CREDENTIALS
 '
=
( )
$num
* 1
,
1 2
KEEP_USERNAME
‚‚ 
=
‚‚ 
$num
‚‚ $
,
‚‚$ %
}
ƒƒ 	
[
‹‹ 	
StructLayout
‹‹	 
(
‹‹ 

LayoutKind
‹‹  
.
‹‹  !

Sequential
‹‹! +
,
‹‹+ ,
CharSet
‹‹- 4
=
‹‹5 6
CharSet
‹‹7 >
.
‹‹> ?
Auto
‹‹? C
)
‹‹C D
]
‹‹D E
public
ŒŒ 
struct
ŒŒ 
NETRESOURCE
ŒŒ !
{
 	
public
 
uint
 
dwScope
 
;
  
public
 
uint
 
dwType
 
;
 
public
 
uint
 
dwDisplayType
 %
;
% &
public
‘‘ 
uint
‘‘ 
dwUsage
‘‘ 
;
‘‘  
public
’’ 
string
’’ 
lpLocalName
’’ %
;
’’% &
public
““ 
string
““ 
lpRemoteName
““ &
;
““& '
public
”” 
string
”” 
	lpComment
”” #
;
””# $
public
•• 
string
•• 

lpProvider
•• $
;
••$ %
}
–– 	
[
˜˜ 	
StructLayout
˜˜	 
(
˜˜ 

LayoutKind
˜˜  
.
˜˜  !

Sequential
˜˜! +
,
˜˜+ ,
CharSet
˜˜- 4
=
˜˜5 6
CharSet
˜˜7 >
.
˜˜> ?
Auto
˜˜? C
)
˜˜C D
]
˜˜D E
public
™™ 
struct
™™ 
COPYDATASTRUCT
™™ $
{
šš 	
public
›› 
IntPtr
›› 
dwData
››  
;
››  !
public
œœ 
UInt32
œœ 
cbData
œœ  
;
œœ  !
[
 
	MarshalAs
 
(
 
UnmanagedType
 $
.
$ %
LPStr
% *
)
* +
]
+ ,
public
 
string
 
lpData
  
;
  !
}
ŸŸ 	
[
¡¡ 	
StructLayout
¡¡	 
(
¡¡ 

LayoutKind
¡¡  
.
¡¡  !

Sequential
¡¡! +
,
¡¡+ ,
CharSet
¡¡- 4
=
¡¡5 6
CharSet
¡¡7 >
.
¡¡> ?
Auto
¡¡? C
)
¡¡C D
]
¡¡D E
public
¢¢ 
struct
¢¢ 
	AUTH_INFO
¢¢ 
{
££ 	
public
¤¤ 
int
¤¤ 
cbSize
¤¤ 
;
¤¤ 
public
¥¥ 
IntPtr
¥¥ 

hwndParent
¥¥ $
;
¥¥$ %
public
¦¦ 
string
¦¦ 
pszMessageText
¦¦ (
;
¦¦( )
public
§§ 
string
§§ 
pszCaptionText
§§ (
;
§§( )
public
¨¨ 
IntPtr
¨¨ 
	hbmBanner
¨¨ #
;
¨¨# $
}
©© 	
[
±± 	 
DllImportAttribute
±±	 
(
±± 
$str
±± (
)
±±( )
]
±±) *
public
²² 
static
²² 
extern
²² 
int
²²  
SendMessage
²²! ,
(
²², -
IntPtr
²²- 3
hWnd
²²4 8
,
²²8 9
FWinMsgs
²²: B
Msg
²²C F
,
²²F G

FNCHITTEST
²²H R
wParam
²²S Y
,
²²Y Z
int
²²[ ^
lParam
²²_ e
)
²²e f
;
²²f g
[
´´ 	
	DllImport
´´	 
(
´´ 
$str
´´ 
,
´´  
SetLastError
´´! -
=
´´. /
true
´´0 4
,
´´4 5
CharSet
´´6 =
=
´´> ?
CharSet
´´@ G
.
´´G H
Auto
´´H L
)
´´L M
]
´´M N
public
µµ 
static
µµ 
extern
µµ 
int
µµ  !
GetWindowTextLength
µµ! 4
(
µµ4 5
IntPtr
µµ5 ;
hWnd
µµ< @
)
µµ@ A
;
µµA B
[
·· 	
	DllImport
··	 
(
·· 
$str
·· 
,
··  
CharSet
··! (
=
··) *
CharSet
··+ 2
.
··2 3
Auto
··3 7
,
··7 8
SetLastError
··9 E
=
··F G
true
··H L
)
··L M
]
··M N
public
¸¸ 
static
¸¸ 
extern
¸¸ 
int
¸¸  
GetWindowText
¸¸! .
(
¸¸. /
IntPtr
¸¸/ 5
hWnd
¸¸6 :
,
¸¸: ;
StringBuilder
¸¸< I
lpString
¸¸J R
,
¸¸R S
int
¸¸T W
	nMaxCount
¸¸X a
)
¸¸a b
;
¸¸b c
[
ºº 	
	DllImport
ºº	 
(
ºº 
$str
ºº 
)
ºº  
]
ºº  !
public
»» 
static
»» 
extern
»» 
bool
»» !
CloseWindow
»»" -
(
»»- .
IntPtr
»». 4
hWnd
»»5 9
)
»»9 :
;
»»: ;
[
½½ 	
	DllImport
½½	 
(
½½ 
$str
½½ 
)
½½  
]
½½  !
public
¾¾ 
static
¾¾ 
extern
¾¾ 
bool
¾¾ !
	EndDialog
¾¾" +
(
¾¾+ ,
IntPtr
¾¾, 2
hDlg
¾¾3 7
,
¾¾7 8
IntPtr
¾¾9 ?
nResult
¾¾@ G
)
¾¾G H
;
¾¾H I
[
ÀÀ 	 
DllImportAttribute
ÀÀ	 
(
ÀÀ 
$str
ÀÀ (
)
ÀÀ( )
]
ÀÀ) *
public
ÁÁ 
static
ÁÁ 
extern
ÁÁ 
bool
ÁÁ !
ReleaseCapture
ÁÁ" 0
(
ÁÁ0 1
)
ÁÁ1 2
;
ÁÁ2 3
[
ÃÃ 	
	DllImport
ÃÃ	 
(
ÃÃ 
$str
ÃÃ 
,
ÃÃ  

EntryPoint
ÃÃ! +
=
ÃÃ, -
$str
ÃÃ. >
)
ÃÃ> ?
]
ÃÃ? @
public
ÄÄ 
static
ÄÄ 
extern
ÄÄ 
int
ÄÄ  
GetWindowLong
ÄÄ! .
(
ÄÄ. /
IntPtr
ÄÄ/ 5
hWnd
ÄÄ6 :
,
ÄÄ: ;
int
ÄÄ< ?
nIndex
ÄÄ@ F
)
ÄÄF G
;
ÄÄG H
[
ÆÆ 	
	DllImport
ÆÆ	 
(
ÆÆ 
$str
ÆÆ 
,
ÆÆ  

EntryPoint
ÆÆ! +
=
ÆÆ, -
$str
ÆÆ. >
)
ÆÆ> ?
]
ÆÆ? @
public
ÇÇ 
static
ÇÇ 
extern
ÇÇ 
int
ÇÇ  
SetWindowLong
ÇÇ! .
(
ÇÇ. /
IntPtr
ÇÇ/ 5
hWnd
ÇÇ6 :
,
ÇÇ: ;
int
ÇÇ< ?
nIndex
ÇÇ@ F
,
ÇÇF G
int
ÇÇH K
	dwNewLong
ÇÇL U
)
ÇÇU V
;
ÇÇV W
[
ÉÉ 	 
DllImportAttribute
ÉÉ	 
(
ÉÉ 
$str
ÉÉ (
)
ÉÉ( )
]
ÉÉ) *
public
ÊÊ 
static
ÊÊ 
extern
ÊÊ 
int
ÊÊ  
GetSystemMetrics
ÊÊ! 1
(
ÊÊ1 2
int
ÊÊ2 5
nIndex
ÊÊ6 <
)
ÊÊ< =
;
ÊÊ= >
[
ÌÌ 	 
DllImportAttribute
ÌÌ	 
(
ÌÌ 
$str
ÌÌ )
)
ÌÌ) *
]
ÌÌ* +
public
ÍÍ 
static
ÍÍ 
extern
ÍÍ 
int
ÍÍ  
ShellExecute
ÍÍ! -
(
ÍÍ- .
IntPtr
ÍÍ. 4
hWnd
ÍÍ5 9
,
ÍÍ9 :
string
ÍÍ; A
	operation
ÍÍB K
,
ÍÍK L
string
ÍÍM S
file
ÍÍT X
,
ÍÍX Y
string
ÍÍZ `
	parameter
ÍÍa j
,
ÍÍj k
string
ÍÍl r
	directory
ÍÍs |
,
ÍÍ| }
intÍÍ~ 
nShowCmdÍÍ‚ Š
)ÍÍŠ ‹
;ÍÍ‹ Œ
[
ÏÏ 	
	DllImport
ÏÏ	 
(
ÏÏ 
$str
ÏÏ 
,
ÏÏ 
CharSet
ÏÏ %
=
ÏÏ& '
CharSet
ÏÏ( /
.
ÏÏ/ 0
Auto
ÏÏ0 4
)
ÏÏ4 5
]
ÏÏ5 6
public
ĞĞ 
static
ĞĞ 
extern
ĞĞ 
int
ĞĞ  
WNetUseConnection
ĞĞ! 2
(
ĞĞ2 3
IntPtr
ÑÑ 
	hwndOwner
ÑÑ 
,
ÑÑ 
[
ÒÒ 
	MarshalAs
ÒÒ 
(
ÒÒ 
UnmanagedType
ÒÒ $
.
ÒÒ$ %
Struct
ÒÒ% +
)
ÒÒ+ ,
]
ÒÒ, -
ref
ÒÒ. 1
NETRESOURCE
ÒÒ2 =
lpNetResource
ÒÒ> K
,
ÒÒK L
string
ÓÓ 

lpPassword
ÓÓ 
,
ÓÓ 
string
ÔÔ 
lpUserID
ÔÔ 
,
ÔÔ 
uint
ÕÕ 
dwFlags
ÕÕ 
,
ÕÕ 
StringBuilder
ÖÖ 
lpAccessName
ÖÖ &
,
ÖÖ& '
ref
×× 
int
×× 
lpBufferSize
××  
,
××  !
out
ØØ 
uint
ØØ 
lpResult
ØØ 
)
ÙÙ 
;
ÙÙ 
[
ÛÛ 	
	DllImport
ÛÛ	 
(
ÛÛ 
$str
ÛÛ 
,
ÛÛ 
CharSet
ÛÛ %
=
ÛÛ& '
CharSet
ÛÛ( /
.
ÛÛ/ 0
Auto
ÛÛ0 4
)
ÛÛ4 5
]
ÛÛ5 6
public
ÜÜ 
static
ÜÜ 
extern
ÜÜ 
int
ÜÜ  !
WNetAddConnection2A
ÜÜ! 4
(
ÜÜ4 5
ref
ÜÜ5 8
NETRESOURCE
ÜÜ9 D
	pstNetRes
ÜÜE N
,
ÜÜN O
string
ÜÜP V

psPassword
ÜÜW a
,
ÜÜa b
string
ÜÜc i

psUsername
ÜÜj t
,
ÜÜt u
int
ÜÜv y
piFlagsÜÜz 
)ÜÜ ‚
;ÜÜ‚ ƒ
[
ŞŞ 	
	DllImport
ŞŞ	 
(
ŞŞ 
$str
ŞŞ 
,
ŞŞ 

EntryPoint
ŞŞ (
=
ŞŞ) *
$str
ŞŞ+ B
,
ŞŞB C
CharSet
ŞŞD K
=
ŞŞL M
CharSet
ŞŞN U
.
ŞŞU V
Auto
ŞŞV Z
)
ŞŞZ [
]
ŞŞ[ \
public
ßß 
static
ßß 
extern
ßß 
int
ßß  $
WNetCancelConnection2A
ßß! 7
(
ßß7 8
string
ßß8 >
lpName
ßß? E
,
ßßE F
int
ßßG J
dwFlags
ßßK R
,
ßßR S
int
ßßT W
fForce
ßßX ^
)
ßß^ _
;
ßß_ `
[
áá 	
	DllImport
áá	 
(
áá 
$str
áá 
,
áá  
CharSet
áá! (
=
áá) *
CharSet
áá+ 2
.
áá2 3
Auto
áá3 7
)
áá7 8
]
áá8 9
public
ââ 
static
ââ 
extern
ââ 
IntPtr
ââ #
SendMessage
ââ$ /
(
ââ/ 0
IntPtr
ââ0 6
hWnd
ââ7 ;
,
ââ; <
UInt32
ââ= C
Msg
ââD G
,
ââG H
IntPtr
ââI O
wParam
ââP V
,
ââV W
ref
ââX [
FNativeAPIs
ââ\ g
.
ââg h
COPYDATASTRUCT
ââh v
lParam
ââw }
)
ââ} ~
;
ââ~ 
[
ää 	
	DllImport
ää	 
(
ää 
$str
ää 
,
ää  
CharSet
ää! (
=
ää) *
CharSet
ää+ 2
.
ää2 3
Auto
ää3 7
)
ää7 8
]
ää8 9
public
åå 
static
åå 
extern
åå 
IntPtr
åå #

FindWindow
åå$ .
(
åå. /
string
åå/ 5
strClassName
åå6 B
,
ååB C
string
ååD J
strWindowName
ååK X
)
ååX Y
;
ååY Z
[
çç 	
	DllImport
çç	 
(
çç 
$str
çç 
,
çç 

EntryPoint
çç '
=
çç( )
$str
çç* ?
)
çç? @
]
çç@ A
public
èè 
static
èè 
extern
èè 
bool
èè !!
SetForegroundWindow
èè" 5
(
èè5 6
IntPtr
èè6 <
hWnd
èè= A
)
èèA B
;
èèB C
[
êê 	
	DllImport
êê	 
(
êê 
$str
êê !
,
êê! "

EntryPoint
êê# -
=
êê. /
$str
êê0 ;
)
êê; <
]
êê< =
public
ëë 
static
ëë 
extern
ëë 
bool
ëë !
	LogonUser
ëë" +
(
ëë+ ,
string
ëë, 2
userName
ëë3 ;
,
ëë; <
string
ëë= C
domain
ëëD J
,
ëëJ K
string
ëëL R
password
ëëS [
,
ëë[ \
int
ëë] `
dwLogonType
ëëa l
,
ëël m
int
ëën q
dwLogonProviderëër 
,ëë ‚
refëëƒ †
IntPtrëë‡ 
phTokenëë •
)ëë• –
;ëë– —
[
íí 	
	DllImport
íí	 
(
íí 
$str
íí !
,
íí! "
SetLastError
íí# /
=
íí0 1
true
íí2 6
)
íí6 7
]
íí7 8
public
îî 
extern
îî 
static
îî 
bool
îî !
DuplicateToken
îî" 0
(
îî0 1
IntPtr
îî1 7!
ExistingTokenHandle
îî8 K
,
îîK L
int
îîM P*
SECURITY_IMPERSONATION_LEVEL
îîQ m
,
îîm n
out
îîo r
IntPtr
îîs y#
DuplicateTokenHandleîîz 
)îî 
;îî 
[
ğğ 	
	DllImport
ğğ	 
(
ğğ 
$str
ğğ !
,
ğğ! "
SetLastError
ğğ# /
=
ğğ0 1
true
ğğ2 6
)
ğğ6 7
]
ğğ7 8
[
ññ 	
return
ññ	 
:
ññ 
	MarshalAs
ññ 
(
ññ 
UnmanagedType
ññ (
.
ññ( )
Bool
ññ) -
)
ññ- .
]
ññ. /
public
òò 
static
òò 
extern
òò 
bool
òò !
CloseHandle
òò" -
(
òò- .
IntPtr
òò. 4
hObject
òò5 <
)
òò< =
;
òò= >
[
ôô 	
	DllImport
ôô	 
(
ôô 
$str
ôô 
)
ôô 
]
ôô  
public
õõ 
static
õõ 
extern
õõ 
void
õõ !
CoTaskMemFree
õõ" /
(
õõ/ 0
IntPtr
õõ0 6
ptr
õõ7 :
)
õõ: ;
;
õõ; <
[
÷÷ 	
	DllImport
÷÷	 
(
÷÷ 
$str
÷÷ 
,
÷÷  
CharSet
÷÷! (
=
÷÷) *
CharSet
÷÷+ 2
.
÷÷2 3
Auto
÷÷3 7
)
÷÷7 8
]
÷÷8 9
public
øø 
static
øø 
extern
øø 
bool
øø !,
CredUnPackAuthenticationBuffer
øø" @
(
øø@ A
int
ùù 
dwFlags
ùù 
,
ùù 
IntPtr
úú 
pAuthBuffer
úú 
,
úú 
uint
ûû 
cbAuthBuffer
ûû 
,
ûû 
StringBuilder
üü 
pszUserName
üü %
,
üü% &
ref
ıı 
int
ıı 
pcchMaxUserName
ıı #
,
ıı# $
StringBuilder
şş 
pszDomainName
şş '
,
şş' (
ref
ÿÿ 
int
ÿÿ 
pcchMaxDomainame
ÿÿ $
,
ÿÿ$ %
StringBuilder
€€ 
pszPassword
€€ %
,
€€% &
ref
 
int
 
pcchMaxPassword
 #
)
‚‚ 
;
‚‚ 
[
„„ 	
	DllImport
„„	 
(
„„ 
$str
„„ 
,
„„  
CharSet
„„! (
=
„„) *
CharSet
„„+ 2
.
„„2 3
Auto
„„3 7
)
„„7 8
]
„„8 9
public
…… 
static
…… 
extern
……  
FCredUIReturnCodes
…… /(
CredUIPromptForCredentials
……0 J
(
……J K
ref
†† 
	AUTH_INFO
†† 
authInfo
†† "
,
††" #
string
‡‡ 

targetName
‡‡ 
,
‡‡ 
IntPtr
ˆˆ 
	reserved1
ˆˆ 
,
ˆˆ 
int
‰‰ 
	authError
‰‰ 
,
‰‰ 
StringBuilder
ŠŠ 
userName
ŠŠ "
,
ŠŠ" #
int
‹‹ 
maxUserName
‹‹ 
,
‹‹ 
StringBuilder
ŒŒ 
password
ŒŒ "
,
ŒŒ" #
int
 
maxPassword
 
,
 
[
 
	MarshalAs
 
(
 
UnmanagedType
 $
.
$ %
Bool
% )
)
) *
]
* +
ref
, /
bool
0 4
pfSave
5 ;
,
; <
FCREDUI_FLAGS
 
flags
 
)
 
;
 
[
’’ 	
	DllImport
’’	 
(
’’ 
$str
’’ 
,
’’  
CharSet
’’! (
=
’’) *
CharSet
’’+ 2
.
’’2 3
Auto
’’3 7
)
’’7 8
]
’’8 9
public
““ 
static
““ 
extern
““  
FCredUIReturnCodes
““ /!
CredUIParseUserName
““0 C
(
““C D
string
”” 
userName
”” 
,
”” 
StringBuilder
•• 
user
•• 
,
•• 
int
–– 
userMaxChars
–– 
,
–– 
StringBuilder
—— 
domain
——  
,
——  !
int
˜˜ 
domainMaxChars
˜˜ 
)
™™ 
;
™™ 
[
›› 	
	DllImport
››	 
(
›› 
$str
›› 
,
››  
CharSet
››! (
=
››) *
CharSet
››+ 2
.
››2 3
Auto
››3 7
)
››7 8
]
››8 9
public
œœ 
static
œœ 
extern
œœ 
int
œœ  /
!CredUIPromptForWindowsCredentials
œœ! B
(
œœB C
ref
 
	AUTH_INFO
 
authInfo
 "
,
" #
int
 
	authError
 
,
 
ref
ŸŸ 
uint
ŸŸ 
authPackage
ŸŸ  
,
ŸŸ  !
IntPtr
   
InAuthBuffer
   
,
    
uint
¡¡ 
InAuthBufferSize
¡¡ !
,
¡¡! "
out
¢¢ 
IntPtr
¢¢ 
refOutAuthBuffer
¢¢ '
,
¢¢' (
out
££ 
uint
££ "
refOutAuthBufferSize
££ )
,
££) *
ref
¤¤ 
bool
¤¤ 
fSave
¤¤ 
,
¤¤ 
int
¥¥ 
flags
¥¥ 
)
¦¦ 
;
¦¦ 
[
¬¬ 	
	DllImport
¬¬	 
(
¬¬ 
$str
¬¬ !
,
¬¬! "
SetLastError
¬¬# /
=
¬¬0 1
true
¬¬2 6
)
¬¬6 7
]
¬¬7 8
[
­­ 	
return
­­	 
:
­­ 
	MarshalAs
­­ 
(
­­ 
UnmanagedType
­­ (
.
­­( )
I8
­­) +
)
­­+ ,
]
­­, -
public
®® 
static
®® 
extern
®® 
long
®® !'
WritePrivateProfileString
®®" ;
(
®®; <
string
®®< B
section
®®C J
,
®®J K
string
®®L R
key
®®S V
,
®®V W
string
®®X ^
val
®®_ b
,
®®b c
string
®®d j
filePath
®®k s
)
®®s t
;
®®t u
[
°° 	
	DllImport
°°	 
(
°° 
$str
°° !
,
°°! "
SetLastError
°°# /
=
°°0 1
true
°°2 6
)
°°6 7
]
°°7 8
[
±± 	
return
±±	 
:
±± 
	MarshalAs
±± 
(
±± 
UnmanagedType
±± (
.
±±( )
I4
±±) +
)
±±+ ,
]
±±, -
public
²² 
static
²² 
extern
²² 
int
²²  %
GetPrivateProfileString
²²! 8
(
²²8 9
string
²²9 ?
section
²²@ G
,
²²G H
string
²²I O
key
²²P S
,
²²S T
string
²²U [
def
²²\ _
,
²²_ `
StringBuilder
²²a n
retVal
²²o u
,
²²u v
int
²²w z
size
²²{ 
,²² €
string²² ‡
filePath²²ˆ 
)²² ‘
;²²‘ ’
[
´´ 	
	DllImport
´´	 
(
´´ 
$str
´´ !
,
´´! "
SetLastError
´´# /
=
´´0 1
true
´´2 6
)
´´6 7
]
´´7 8
public
µµ 
static
µµ 
extern
µµ 
IntPtr
µµ #
GetStdHandle
µµ$ 0
(
µµ0 1
int
µµ1 4

nStdHandle
µµ5 ?
)
µµ? @
;
µµ@ A
[
·· 	
	DllImport
··	 
(
·· 
$str
·· !
)
··! "
]
··" #
public
¸¸ 
static
¸¸ 
extern
¸¸ 
IntPtr
¸¸ #
GetConsoleWindow
¸¸$ 4
(
¸¸4 5
)
¸¸5 6
;
¸¸6 7
[
ºº 	
	DllImport
ºº	 
(
ºº 
$str
ºº !
,
ºº! "
SetLastError
ºº# /
=
ºº0 1
true
ºº2 6
)
ºº6 7
]
ºº7 8
private
»» 
static
»» 
extern
»» 
bool
»» "
GetConsoleMode
»»# 1
(
»»1 2
IntPtr
¼¼ 
hConsoleHandle
¼¼ !
,
¼¼! "
out
½½ 
int
½½ 
lpMode
½½ 
)
½½ 
;
½½ 
[
¿¿ 	
	DllImport
¿¿	 
(
¿¿ 
$str
¿¿ !
,
¿¿! "
SetLastError
¿¿# /
=
¿¿0 1
true
¿¿2 6
)
¿¿6 7
]
¿¿7 8
private
ÀÀ 
static
ÀÀ 
extern
ÀÀ 
bool
ÀÀ "
SetConsoleMode
ÀÀ# 1
(
ÀÀ1 2
IntPtr
ÁÁ 
hConsoleHandle
ÁÁ !
,
ÁÁ! "
int
ÂÂ 
ioMode
ÂÂ 
)
ÂÂ 
;
ÂÂ 
[
ÄÄ 	
	DllImport
ÄÄ	 
(
ÄÄ 
$str
ÄÄ 
,
ÄÄ  
SetLastError
ÄÄ! -
=
ÄÄ. /
true
ÄÄ0 4
)
ÄÄ4 5
]
ÄÄ5 6
private
ÅÅ 
static
ÅÅ 
extern
ÅÅ 
IntPtr
ÅÅ $
GetSystemMenu
ÅÅ% 2
(
ÅÅ2 3
IntPtr
ÅÅ3 9
windowHandle
ÅÅ: F
,
ÅÅF G
bool
ÅÅH L
revert
ÅÅM S
)
ÅÅS T
;
ÅÅT U
[
ÇÇ 	
	DllImport
ÇÇ	 
(
ÇÇ 
$str
ÇÇ 
,
ÇÇ  
SetLastError
ÇÇ! -
=
ÇÇ. /
true
ÇÇ0 4
)
ÇÇ4 5
]
ÇÇ5 6
private
ÈÈ 
static
ÈÈ 
extern
ÈÈ 
bool
ÈÈ "
EnableMenuItem
ÈÈ# 1
(
ÈÈ1 2
IntPtr
ÈÈ2 8

menuHandle
ÈÈ9 C
,
ÈÈC D
uint
ÈÈE I

menuItemId
ÈÈJ T
,
ÈÈT U
uint
ÈÈV Z
enabled
ÈÈ[ b
)
ÈÈb c
;
ÈÈc d
public
ĞĞ 
static
ĞĞ 
void
ĞĞ 
DisableQuickEdit
ĞĞ +
(
ĞĞ+ ,
)
ĞĞ, -
{
ÑÑ 	
IntPtr
ÒÒ 
	conHandle
ÒÒ 
=
ÒÒ 
GetStdHandle
ÒÒ +
(
ÒÒ+ ,
STD_INPUT_HANDLE
ÒÒ, <
)
ÒÒ< =
;
ÒÒ= >
int
ÓÓ 
mode
ÓÓ 
;
ÓÓ 
if
ÕÕ 
(
ÕÕ 
!
ÕÕ 
GetConsoleMode
ÕÕ 
(
ÕÕ  
	conHandle
ÕÕ  )
,
ÕÕ) *
out
ÕÕ+ .
mode
ÕÕ/ 3
)
ÕÕ3 4
)
ÕÕ4 5
{
ÖÖ 
Console
×× 
.
×× 
	WriteLine
×× !
(
××! "
$str
××" B
)
××B C
;
××C D
return
ÙÙ 
;
ÙÙ 
}
ÚÚ 
mode
ÜÜ 
=
ÜÜ 
mode
ÜÜ 
&
ÜÜ 
~
ÜÜ 
(
ÜÜ 
QuickEditMode
ÜÜ )
|
ÜÜ* +
ExtendedFlags
ÜÜ, 9
)
ÜÜ9 :
;
ÜÜ: ;
if
ŞŞ 
(
ŞŞ 
!
ŞŞ 
SetConsoleMode
ŞŞ 
(
ŞŞ  
	conHandle
ŞŞ  )
,
ŞŞ) *
mode
ŞŞ+ /
)
ŞŞ/ 0
)
ŞŞ0 1
{
ßß 
Console
àà 
.
àà 
	WriteLine
àà !
(
àà! "
$str
àà" B
)
ààB C
;
ààC D
}
ââ 
}
ää 	
public
èè 
static
èè 
void
èè 
EnableQuickEdit
èè *
(
èè* +
)
èè+ ,
{
éé 	
IntPtr
êê 
	conHandle
êê 
=
êê 
GetStdHandle
êê +
(
êê+ ,
STD_INPUT_HANDLE
êê, <
)
êê< =
;
êê= >
int
ëë 
mode
ëë 
;
ëë 
if
íí 
(
íí 
!
íí 
GetConsoleMode
íí 
(
íí  
	conHandle
íí  )
,
íí) *
out
íí+ .
mode
íí/ 3
)
íí3 4
)
íí4 5
{
îî 
Console
ïï 
.
ïï 
	WriteLine
ïï !
(
ïï! "
$str
ïï" A
)
ïïA B
;
ïïB C
return
ññ 
;
ññ 
}
òò 
mode
ôô 
=
ôô 
mode
ôô 
|
ôô 
(
ôô 
QuickEditMode
ôô (
|
ôô) *
ExtendedFlags
ôô+ 8
)
ôô8 9
;
ôô9 :
if
öö 
(
öö 
!
öö 
SetConsoleMode
öö 
(
öö  
	conHandle
öö  )
,
öö) *
mode
öö+ /
)
öö/ 0
)
öö0 1
{
÷÷ 
Console
øø 
.
øø 
	WriteLine
øø !
(
øø! "
$str
øø" A
)
øøA B
;
øøB C
}
úú 
}
ûû 	
public
ÿÿ 
static
ÿÿ 
void
ÿÿ #
SetCloseButtonEnabled
ÿÿ 0
(
ÿÿ0 1
bool
ÿÿ1 5
enabled
ÿÿ6 =
)
ÿÿ= >
{
 	
IntPtr
‚‚ 
handle
‚‚ 
=
‚‚ 
GetConsoleWindow
‚‚ ,
(
‚‚, -
)
‚‚- .
;
‚‚. /
IntPtr
ƒƒ 
sysMenu
ƒƒ 
=
ƒƒ 
GetSystemMenu
ƒƒ *
(
ƒƒ* +
handle
ƒƒ+ 1
,
ƒƒ1 2
false
ƒƒ3 8
)
ƒƒ8 9
;
ƒƒ9 :
EnableMenuItem
…… 
(
…… 
sysMenu
…… "
,
……" #
SC_CLOSE
……$ ,
,
……, -
(
……. /
uint
……/ 3
)
……3 4
(
……4 5

MF_ENABLED
……5 ?
|
……@ A
(
……B C
enabled
……C J
?
……K L

MF_ENABLED
……M W
:
……X Y

MF_DISABLE
……Z d
)
……d e
)
……e f
)
……f g
;
……g h
}
†† 	
}
ŒŒ 
} ü#
aD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Thread\c_FThreadEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
Serializable 
] 
public 

class 
FThreadEventArgs !
:" #
	EventArgs$ -
,- .
IDisposable/ :
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
[ 	
NonSerialized	 
] 
private 
FThread 
m_ownerThread %
=& '
null( ,
;, -
private 
object 
m_savedData "
=# $
null% )
;) *
internal%% 
FThreadEventArgs%% !
(%%! "
FThread&& 
ownerThread&& 
)'' 
{(( 	
m_ownerThread)) 
=)) 
ownerThread)) '
;))' (
}** 	
~.. 	
FThreadEventArgs..	 
(.. 
)// 
{00 	
	myDispose11 
(11 
false11 
)11 
;11 
}22 	
	protected66 
void66 
	myDispose66  
(66  !
bool77 
	disposing77 
)88 
{99 	
if:: 
(:: 
!:: 

m_disposed:: 
):: 
{;; 
if<< 
(<< 
	disposing<< 
)<< 
{== 
m_ownerThread>> !
=>>" #
null>>$ (
;>>( )
}?? 

m_disposedAA 
=AA 
trueAA !
;AA! "
}BB 
}CC 	
publicKK 
voidKK 
DisposeKK 
(KK 
)LL 
{MM 	
	myDisposeNN 
(NN 
trueNN 
)NN 
;NN 
GCOO 
.OO 
SuppressFinalizeOO 
(OO  
thisOO  $
)OO$ %
;OO% &
}PP 	
publicXX 
FThreadXX 
ownerThreadXX "
{YY 	
getZZ 
{[[ 
try\\ 
{]] 
return^^ 
m_ownerThread^^ (
;^^( )
}__ 
catch`` 
(`` 
	Exception``  
ex``! #
)``# $
{aa 
FDebugbb 
.bb 
throwExceptionbb )
(bb) *
exbb* ,
)bb, -
;bb- .
}cc 
finallydd 
{ee 
}gg 
returnhh 
nullhh 
;hh 
}ii 
}jj 	
publicnn 
objectnn 
	savedDatann 
{oo 	
getpp 
{qq 
tryrr 
{ss 
returntt 
m_savedDatatt &
;tt& '
}uu 
catchvv 
(vv 
	Exceptionvv  
exvv! #
)vv# $
{ww 
FDebugxx 
.xx 
throwExceptionxx )
(xx) *
exxx* ,
)xx, -
;xx- .
}yy 
finallyzz 
{{{ 
}}} 
return~~ 
null~~ 
;~~ 
} 
set
 
{
‚‚ 
try
ƒƒ 
{
„„ 
m_savedData
…… 
=
……  !
value
……" '
;
……' (
}
†† 
catch
‡‡ 
(
‡‡ 
	Exception
‡‡  
ex
‡‡! #
)
‡‡# $
{
ˆˆ 
FDebug
‰‰ 
.
‰‰ 
throwException
‰‰ )
(
‰‰) *
ex
‰‰* ,
)
‰‰, -
;
‰‰- .
}
ŠŠ 
finally
‹‹ 
{
ŒŒ 
}
 
}
 
}
 	
public
˜˜ 
void
˜˜ 
sleepThread
˜˜ 
(
˜˜  
int
™™ 
milliseconds
™™ 
)
šš 
{
›› 	
try
œœ 
{
 
Thread
 
.
 
Sleep
 
(
 
milliseconds
 )
)
) *
;
* +
}
ŸŸ 
catch
   
(
   
	Exception
   
ex
   
)
    
{
¡¡ 
FDebug
¢¢ 
.
¢¢ 
throwException
¢¢ %
(
¢¢% &
ex
¢¢& (
)
¢¢( )
;
¢¢) *
}
££ 
finally
¤¤ 
{
¥¥ 
}
§§ 
}
¨¨ 	
}
®® 
}¯¯ ¼7
`D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\MessageBox\c_FMessageBox.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

static 
class 
FMessageBox #
{ 
static 
FMessageBox 
( 
) 
{ 	
}   	
public.. 
static.. 
void.. 
	showError.. $
(..$ %
string// 
caption// 
,// 
string00 
message00 
,00 
IWin32Window11 
owner11 
)22 
{33 	
try44 
{55 
if66 
(66 
owner66 
==66 
null66 !
)66! "
{77 

MessageBox88 
.88 
Show88 #
(88# $
message88$ +
,88+ ,
caption88- 4
,884 5
MessageBoxButtons886 G
.88G H
OK88H J
,88J K
MessageBoxIcon88L Z
.88Z [
Error88[ `
)88` a
;88a b
}99 
else:: 
{;; 

MessageBox<< 
.<< 
Show<< #
(<<# $
owner<<$ )
,<<) *
message<<+ 2
,<<2 3
caption<<4 ;
,<<; <
MessageBoxButtons<<= N
.<<N O
OK<<O Q
,<<Q R
MessageBoxIcon<<S a
.<<a b
Error<<b g
)<<g h
;<<h i
}== 
}>> 
catch?? 
(?? 
	Exception?? 
ex?? 
)??  
{@@ 
FDebugAA 
.AA 
throwExceptionAA %
(AA% &
exAA& (
)AA( )
;AA) *
}BB 
finallyCC 
{DD 
}FF 
}GG 	
publicKK 
staticKK 
voidKK 
	showErrorKK $
(KK$ %
stringLL 
captionLL 
,LL 
	ExceptionMM 
	exceptionMM 
,MM  
IWin32WindowNN 
ownerNN 
)OO 
{PP 	
tryQQ 
{RR 
FDebugSS 
.SS 
writeLogSS 
(SS  
	exceptionSS  )
)SS) *
;SS* +
ifUU 
(UU 
ownerUU 
==UU 
nullUU !
)UU! "
{VV 

MessageBoxWW 
.WW 
ShowWW #
(WW# $
	exceptionWW$ -
.WW- .
MessageWW. 5
,WW5 6
captionWW7 >
,WW> ?
MessageBoxButtonsWW@ Q
.WWQ R
OKWWR T
,WWT U
MessageBoxIconWWV d
.WWd e
ErrorWWe j
)WWj k
;WWk l
}XX 
elseYY 
{ZZ 

MessageBox[[ 
.[[ 
Show[[ #
([[# $
owner[[$ )
,[[) *
	exception[[+ 4
.[[4 5
Message[[5 <
,[[< =
caption[[> E
,[[E F
MessageBoxButtons[[G X
.[[X Y
OK[[Y [
,[[[ \
MessageBoxIcon[[] k
.[[k l
Error[[l q
)[[q r
;[[r s
}\\ 
}]] 
catch^^ 
(^^ 
	Exception^^ 
ex^^ 
)^^  
{__ 
FDebug`` 
.`` 
throwException`` %
(``% &
ex``& (
)``( )
;``) *
}aa 
finallybb 
{cc 
}ee 
}ff 	
publicjj 
staticjj 
DialogResultjj "
showQuestionjj# /
(jj/ 0
stringkk 
captionkk 
,kk 
stringll 
messagell 
,ll 
MessageBoxButtonsmm 
buttonsmm %
,mm% &#
MessageBoxDefaultButtonnn #
defaultButtonnn$ 1
,nn1 2
IWin32Windowoo 
owneroo 
)pp 
{qq 	
tryrr 
{ss 
iftt 
(tt 
ownertt 
==tt 
nulltt !
)tt! "
{uu 
returnvv 

MessageBoxvv %
.vv% &
Showvv& *
(vv* +
messagevv+ 2
,vv2 3
captionvv4 ;
,vv; <
buttonsvv= D
,vvD E
MessageBoxIconvvF T
.vvT U
QuestionvvU ]
,vv] ^
defaultButtonvv_ l
)vvl m
;vvm n
}ww 
elsexx 
{yy 
returnzz 

MessageBoxzz %
.zz% &
Showzz& *
(zz* +
ownerzz+ 0
,zz0 1
messagezz2 9
,zz9 :
captionzz; B
,zzB C
buttonszzD K
,zzK L
MessageBoxIconzzM [
.zz[ \
Questionzz\ d
,zzd e
defaultButtonzzf s
)zzs t
;zzt u
}{{ 
}|| 
catch}} 
(}} 
	Exception}} 
ex}} 
)}}  
{~~ 
FDebug 
. 
throwException %
(% &
ex& (
)( )
;) *
}
€€ 
finally
 
{
‚‚ 
}
„„ 
return
…… 
DialogResult
…… 
.
……  
None
……  $
;
……$ %
}
†† 	
public
ŠŠ 
static
ŠŠ 
void
ŠŠ 
showInformation
ŠŠ *
(
ŠŠ* +
string
‹‹ 
caption
‹‹ 
,
‹‹ 
string
ŒŒ 
message
ŒŒ 
,
ŒŒ 
IWin32Window
 
owner
 
)
 
{
 	
try
 
{
‘‘ 
if
’’ 
(
’’ 
owner
’’ 
==
’’ 
null
’’ !
)
’’! "
{
““ 

MessageBox
”” 
.
”” 
Show
”” #
(
””# $
message
””$ +
,
””+ ,
caption
””- 4
,
””4 5
MessageBoxButtons
””6 G
.
””G H
OK
””H J
,
””J K
MessageBoxIcon
””L Z
.
””Z [
Information
””[ f
)
””f g
;
””g h
}
•• 
else
–– 
{
—— 

MessageBox
˜˜ 
.
˜˜ 
Show
˜˜ #
(
˜˜# $
owner
˜˜$ )
,
˜˜) *
message
˜˜+ 2
,
˜˜2 3
caption
˜˜4 ;
,
˜˜; <
MessageBoxButtons
˜˜= N
.
˜˜N O
OK
˜˜O Q
,
˜˜Q R
MessageBoxIcon
˜˜S a
.
˜˜a b
Information
˜˜b m
)
˜˜m n
;
˜˜n o
}
™™ 
}
šš 
catch
›› 
(
›› 
	Exception
›› 
ex
›› 
)
››  
{
œœ 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
ŸŸ 
{
   
}
¢¢ 
}
££ 	
}
©© 
}ªª ‰ê
XD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Thread\c_FThread.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FThread 
: 
IDisposable &
{ 
public 
event &
FThreadStartedEventHandler /
ThreadStarted0 =
=> ?
null@ D
;D E
public 
event &
FThreadStoppedEventHandler /
ThreadStopped0 =
=> ?
null@ D
;D E
public 
event *
FThreadErrorRaisedEventHandler 3
ThreadErrorRaised4 E
=F G
nullH L
;L M
public 
event (
FThreadJobCalledEventHandler 1
ThreadJobCalled2 A
=B C
nullD H
;H I
private 
const 
int 
DefaultThreadSleep ,
=- .
$num/ 0
;0 1
private   
const   
int   #
DefaultTerminateTimeout   1
=  2 3
$num  4 9
;  9 :
private"" 
bool"" 

m_disposed"" 
=""  !
false""" '
;""' (
private$$ 
string$$ 
m_name$$ 
=$$ 
string$$  &
.$$& '
Empty$$' ,
;$$, -
private%% 
bool%% 
m_isBackground%% #
=%%$ %
false%%& +
;%%+ ,
private&& 
ThreadPriority&& 

m_priority&& )
=&&* +
ThreadPriority&&, :
.&&: ;
Normal&&; A
;&&A B
private'' 
bool'' 
m_asyncEvent'' !
=''" #
false''$ )
;'') *
private)) 
bool)) 
m_alived)) 
=)) 
false))  %
;))% &
private** 
Thread** 
m_thdJob** 
=**  !
null**" &
;**& '
private,, 
	FCodeLock,, 

m_fSpdLock,, $
=,,% &
null,,' +
;,,+ ,
private-- 
bool-- 
m_suspended--  
=--! "
false--# (
;--( )
public33 
FThread33 
(33 
string44 
name44 
)55 
{66 	

m_fSpdLock77 
=77 
new77 
	FCodeLock77 &
(77& '
)77' (
;77( )
m_name88 
=88 
name88 
;88 
}99 	
public== 
FThread== 
(== 
string>> 
name>> 
,>> 
bool?? 
isBackground?? 
)@@ 
:AA 
thisAA 
(AA 
nameAA 
)AA 
{BB 	
m_isBackgroundCC 
=CC 
isBackgroundCC )
;CC) *
}DD 	
publicHH 
FThreadHH 
(HH 
stringII 
nameII 
,II 
boolJJ 
isBackgroundJJ 
,JJ 
ThreadPriorityKK 
priorityKK #
,KK# $
boolLL 

asyncEventLL 
)MM 
:MM 
thisMM 
(MM 
nameMM 
)MM 
{NN 	
m_isBackgroundOO 
=OO 
isBackgroundOO )
;OO) *

m_priorityPP 
=PP 
priorityPP !
;PP! "
m_asyncEventQQ 
=QQ 

asyncEventQQ %
;QQ% &
}RR 	
~VV 	
FThreadVV	 
(VV 
)WW 
{XX 	
	myDisposeYY 
(YY 
falseYY 
)YY 
;YY 
}ZZ 	
	protected^^ 
void^^ 
	myDispose^^  
(^^  !
bool__ 
	disposing__ 
)`` 
{aa 	
ifbb 
(bb 
!bb 

m_disposedbb 
)bb 
{cc 
ifdd 
(dd 
	disposingdd 
)dd 
{ee 
stopff 
(ff 
)ff 
;ff 
ifhh 
(hh 

m_fSpdLockhh "
!=hh# %
nullhh& *
)hh* +
{ii 

m_fSpdLockjj "
.jj" #
Disposejj# *
(jj* +
)jj+ ,
;jj, -

m_fSpdLockkk "
=kk# $
nullkk% )
;kk) *
}ll 
}nn 

m_disposedpp 
=pp 
truepp !
;pp! "
}qq 
}rr 	
publiczz 
voidzz 
Disposezz 
(zz 
){{ 
{|| 	
	myDispose}} 
(}} 
true}} 
)}} 
;}} 
GC~~ 
.~~ 
SuppressFinalize~~ 
(~~  
this~~  $
)~~$ %
;~~% &
} 	
public
‡‡ 
string
‡‡ 
name
‡‡ 
{
ˆˆ 	
get
‰‰ 
{
ŠŠ 
try
‹‹ 
{
ŒŒ 
return
 
m_name
 !
;
! "
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
‘‘ 
.
‘‘ 
throwException
‘‘ )
(
‘‘) *
ex
‘‘* ,
)
‘‘, -
;
‘‘- .
}
’’ 
finally
““ 
{
”” 
}
–– 
return
—— 
string
—— 
.
—— 
Empty
—— #
;
——# $
}
˜˜ 
}
™™ 	
public
 
bool
 
isBackground
  
{
 	
get
ŸŸ 
{
   
try
¡¡ 
{
¢¢ 
return
££ 
m_isBackground
££ )
;
££) *
}
¤¤ 
catch
¥¥ 
(
¥¥ 
	Exception
¥¥  
ex
¥¥! #
)
¥¥# $
{
¦¦ 
FDebug
§§ 
.
§§ 
throwException
§§ )
(
§§) *
ex
§§* ,
)
§§, -
;
§§- .
}
¨¨ 
finally
©© 
{
ªª 
}
¬¬ 
return
­­ 
false
­­ 
;
­­ 
}
®® 
}
¯¯ 	
public
³³ 
ThreadPriority
³³ 
priority
³³ &
{
´´ 	
get
µµ 
{
¶¶ 
try
·· 
{
¸¸ 
return
¹¹ 

m_priority
¹¹ %
;
¹¹% &
}
ºº 
catch
»» 
(
»» 
	Exception
»»  
ex
»»! #
)
»»# $
{
¼¼ 
FDebug
½½ 
.
½½ 
throwException
½½ )
(
½½) *
ex
½½* ,
)
½½, -
;
½½- .
}
¾¾ 
finally
¿¿ 
{
ÀÀ 
}
ÂÂ 
return
ÃÃ 
ThreadPriority
ÃÃ %
.
ÃÃ% &
Normal
ÃÃ& ,
;
ÃÃ, -
}
ÄÄ 
}
ÅÅ 	
public
ÉÉ 
bool
ÉÉ 

asyncEvent
ÉÉ 
{
ÊÊ 	
get
ËË 
{
ÌÌ 
try
ÍÍ 
{
ÎÎ 
return
ÏÏ 
m_asyncEvent
ÏÏ '
;
ÏÏ' (
}
ĞĞ 
catch
ÑÑ 
(
ÑÑ 
	Exception
ÑÑ  
ex
ÑÑ! #
)
ÑÑ# $
{
ÒÒ 
FDebug
ÓÓ 
.
ÓÓ 
throwException
ÓÓ )
(
ÓÓ) *
ex
ÓÓ* ,
)
ÓÓ, -
;
ÓÓ- .
}
ÔÔ 
finally
ÕÕ 
{
ÖÖ 
}
ØØ 
return
ÙÙ 
false
ÙÙ 
;
ÙÙ 
}
ÚÚ 
}
ÛÛ 	
public
ßß 
bool
ßß 
alived
ßß 
{
àà 	
get
áá 
{
ââ 
try
ãã 
{
ää 
return
åå 
m_alived
åå #
;
åå# $
}
ææ 
catch
çç 
(
çç 
	Exception
çç  
ex
çç! #
)
çç# $
{
èè 
FDebug
éé 
.
éé 
throwException
éé )
(
éé) *
ex
éé* ,
)
éé, -
;
éé- .
}
êê 
finally
ëë 
{
ìì 
}
îî 
return
ïï 
false
ïï 
;
ïï 
}
ğğ 
}
ññ 	
public
ùù 
void
ùù 
suspend
ùù 
(
ùù 
)
úú 
{
ûû 	
try
üü 
{
ıı 
if
şş 
(
şş 
m_suspended
şş 
)
şş  
{
ÿÿ 
return
€€ 
;
€€ 
}
 

m_fSpdLock
ƒƒ 
.
ƒƒ 
wait
ƒƒ 
(
ƒƒ  
)
ƒƒ  !
;
ƒƒ! "
m_suspended
„„ 
=
„„ 
true
„„ "
;
„„" #
}
…… 
catch
†† 
(
†† 
	Exception
†† 
ex
†† 
)
††  
{
‡‡ 
FDebug
ˆˆ 
.
ˆˆ 
throwException
ˆˆ %
(
ˆˆ% &
ex
ˆˆ& (
)
ˆˆ( )
;
ˆˆ) *
}
‰‰ 
finally
ŠŠ 
{
‹‹ 
}
 
}
 	
public
’’ 
void
’’ 
resume
’’ 
(
’’ 
)
““ 
{
”” 	
try
•• 
{
–– 
if
—— 
(
—— 
!
—— 
m_suspended
——  
)
——  !
{
˜˜ 
return
™™ 
;
™™ 
}
šš 

m_fSpdLock
œœ 
.
œœ 
set
œœ 
(
œœ 
)
œœ  
;
œœ  !
m_suspended
 
=
 
false
 #
;
# $
}
 
catch
ŸŸ 
(
ŸŸ 
	Exception
ŸŸ 
ex
ŸŸ 
)
ŸŸ  
{
   
FDebug
¡¡ 
.
¡¡ 
throwException
¡¡ %
(
¡¡% &
ex
¡¡& (
)
¡¡( )
;
¡¡) *
}
¢¢ 
finally
££ 
{
¤¤ 
}
¦¦ 
}
§§ 	
public
«« 
void
«« 
start
«« 
(
«« 
)
¬¬ 
{
­­ 	
try
®® 
{
¯¯ 
if
°° 
(
°° 
m_alived
°° 
)
°° 
{
±± 
return
²² 
;
²² 
}
³³ 
m_alived
·· 
=
·· 
true
·· 
;
··  
m_thdJob
¸¸ 
=
¸¸ 
new
¸¸ 
Thread
¸¸ %
(
¸¸% &
new
¸¸& )
ThreadStart
¸¸* 5
(
¸¸5 6
doJob
¸¸6 ;
)
¸¸; <
)
¸¸< =
;
¸¸= >
m_thdJob
¹¹ 
.
¹¹ 
Name
¹¹ 
=
¹¹ 
m_name
¹¹  &
;
¹¹& '
m_thdJob
ºº 
.
ºº 
IsBackground
ºº %
=
ºº& '
m_isBackground
ºº( 6
;
ºº6 7
m_thdJob
»» 
.
»» 
Priority
»» !
=
»»" #

m_priority
»»$ .
;
»». /
m_thdJob
¼¼ 
.
¼¼ 
Start
¼¼ 
(
¼¼ 
)
¼¼  
;
¼¼  !
}
½½ 
catch
¾¾ 
(
¾¾ 
	Exception
¾¾ 
ex
¾¾ 
)
¾¾  
{
¿¿ 
FDebug
ÀÀ 
.
ÀÀ 
throwException
ÀÀ %
(
ÀÀ% &
ex
ÀÀ& (
)
ÀÀ( )
;
ÀÀ) *
}
ÁÁ 
finally
ÂÂ 
{
ÃÃ 
}
ÅÅ 
}
ÆÆ 	
public
ÊÊ 
void
ÊÊ 
stop
ÊÊ 
(
ÊÊ 
)
ËË 
{
ÌÌ 	
try
ÍÍ 
{
ÎÎ 
stop
ÏÏ 
(
ÏÏ %
DefaultTerminateTimeout
ÏÏ ,
)
ÏÏ, -
;
ÏÏ- .
}
ĞĞ 
catch
ÑÑ 
(
ÑÑ 
	Exception
ÑÑ 
ex
ÑÑ 
)
ÑÑ  
{
ÒÒ 
FDebug
ÓÓ 
.
ÓÓ 
throwException
ÓÓ %
(
ÓÓ% &
ex
ÓÓ& (
)
ÓÓ( )
;
ÓÓ) *
}
ÔÔ 
finally
ÕÕ 
{
ÖÖ 
}
ØØ 
}
ÙÙ 	
public
İİ 
void
İİ 
stop
İİ 
(
İİ 
int
ŞŞ  
millisecondTimeout
ŞŞ "
)
ßß 
{
àà 	
try
áá 
{
ââ 
if
ãã 
(
ãã 
!
ãã 
m_alived
ãã 
)
ãã 
{
ää 
return
åå 
;
åå 
}
ææ 
m_alived
êê 
=
êê 
false
êê  
;
êê  !
if
ëë 
(
ëë 
m_thdJob
ëë 
!=
ëë 
null
ëë  $
)
ëë$ %
{
ìì 
if
íí 
(
íí 
!
íí 
m_thdJob
íí !
.
íí! "
Join
íí" &
(
íí& ' 
millisecondTimeout
íí' 9
)
íí9 :
)
íí: ;
{
îî 
m_thdJob
ïï  
.
ïï  !
Abort
ïï! &
(
ïï& '
)
ïï' (
;
ïï( )
}
ğğ 
m_thdJob
ññ 
=
ññ 
null
ññ #
;
ññ# $
}
òò 
}
óó 
catch
ôô 
(
ôô 
	Exception
ôô 
ex
ôô 
)
ôô  
{
õõ 
FDebug
öö 
.
öö 
throwException
öö %
(
öö% &
ex
öö& (
)
öö( )
;
öö) *
}
÷÷ 
finally
øø 
{
ùù 
}
ûû 
}
üü 	
private
€€ 
void
€€ 
doJob
€€ 
(
€€ 
)
 
{
‚‚ 	
FDebugLogArgs
ƒƒ 
logArgs
ƒƒ !
=
ƒƒ" #
null
ƒƒ$ (
;
ƒƒ( )
FThreadEventArgs
„„ 
args
„„ !
=
„„" #
null
„„$ (
;
„„( )
IAsyncResult
…… 
ar
…… 
=
…… 
null
…… "
;
……" #
try
‡‡ 
{
ˆˆ 
logArgs
‰‰ 
=
‰‰ 
new
‰‰ 
FDebugLogArgs
‰‰ +
(
‰‰+ ,
FDebugLogCategory
‰‰, =
.
‰‰= >
Information
‰‰> I
,
‰‰I J
$str
‰‰K X
,
‰‰X Y
this
‰‰Z ^
.
‰‰^ _
GetType
‰‰_ f
(
‰‰f g
)
‰‰g h
,
‰‰h i
$str
‰‰j q
)
‰‰q r
;
‰‰r s
logArgs
ŠŠ 
.
ŠŠ 
additionInfo
ŠŠ $
=
ŠŠ% &
$str
ŠŠ' 5
+
ŠŠ6 7
m_name
ŠŠ8 >
+
ŠŠ? @
$str
ŠŠA P
+
ŠŠQ R
m_thdJob
ŠŠS [
.
ŠŠ[ \
ManagedThreadId
ŠŠ\ k
.
ŠŠk l
ToString
ŠŠl t
(
ŠŠt u
)
ŠŠu v
+
ŠŠw x
$strŠŠy Œ
+ŠŠ 
m_isBackgroundŠŠ 
.ŠŠ 
ToStringŠŠ ¦
(ŠŠ¦ §
)ŠŠ§ ¨
+ŠŠ© ª
$strŠŠ« º
+ŠŠ» ¼

m_priorityŠŠ½ Ç
.ŠŠÇ È
ToStringŠŠÈ Ğ
(ŠŠĞ Ñ
)ŠŠÑ Ò
+ŠŠÓ Ô
$strŠŠÕ æ
+ŠŠç è
m_asyncEventŠŠé õ
.ŠŠõ ö
ToStringŠŠö ş
(ŠŠş ÿ
)ŠŠÿ €
+ŠŠ ‚
$strŠŠƒ †
;ŠŠ† ‡
FDebug
‹‹ 
.
‹‹ 
writeLog
‹‹ 
(
‹‹  
logArgs
‹‹  '
)
‹‹' (
;
‹‹( )
args
 
=
 
new
 
FThreadEventArgs
 +
(
+ ,
this
, 0
)
0 1
;
1 2
ar
 
=
 
onThreadStarted
 $
(
$ %
args
% )
)
) *
;
* +
while
”” 
(
”” 
m_alived
”” 
)
””  
{
•• 
try
–– 
{
—— 
if
˜˜ 
(
˜˜ 
ar
˜˜ 
!=
˜˜ !
null
˜˜" &
)
˜˜& '
{
™™ 
if
šš 
(
šš  
!
šš  !
ar
šš! #
.
šš# $
AsyncWaitHandle
šš$ 3
.
šš3 4
WaitOne
šš4 ;
(
šš; <
$num
šš< =
)
šš= >
)
šš> ?
{
›› 
continue
œœ  (
;
œœ( )
}
 
ar
 
.
 
AsyncWaitHandle
 .
.
. /
Dispose
/ 6
(
6 7
)
7 8
;
8 9
ar
ŸŸ 
=
ŸŸ  
null
ŸŸ! %
;
ŸŸ% &
}
   
if
¤¤ 
(
¤¤ 

m_fSpdLock
¤¤ &
.
¤¤& '
tryWait
¤¤' .
(
¤¤. /
$num
¤¤/ 0
)
¤¤0 1
)
¤¤1 2
{
¥¥ 
ar
¦¦ 
=
¦¦  
onThreadJobCalled
¦¦! 2
(
¦¦2 3
args
¦¦3 7
)
¦¦7 8
;
¦¦8 9
}
§§ 
}
¨¨ 
catch
©© 
(
©© 
	Exception
©© $
ex
©©% '
)
©©' (
{
ªª 
FDebug
«« 
.
«« 
writeLog
«« '
(
««' (
ex
««( *
)
««* +
;
««+ ,
ar
¬¬ 
=
¬¬ !
onThreadErrorRaised
¬¬ 0
(
¬¬0 1
ex
¬¬1 3
)
¬¬3 4
;
¬¬4 5
}
­­ 
finally
®® 
{
¯¯ 
}
±± 
}
²² 
ar
¶¶ 
=
¶¶ 
onThreadStopped
¶¶ $
(
¶¶$ %
args
¶¶% )
)
¶¶) *
;
¶¶* +
if
·· 
(
·· 
ar
·· 
!=
·· 
null
·· 
)
·· 
{
¸¸ 
ar
¹¹ 
.
¹¹ 
AsyncWaitHandle
¹¹ &
.
¹¹& '
WaitOne
¹¹' .
(
¹¹. /
)
¹¹/ 0
;
¹¹0 1
}
ºº 
logArgs
¾¾ 
=
¾¾ 
new
¾¾ 
FDebugLogArgs
¾¾ +
(
¾¾+ ,
FDebugLogCategory
¾¾, =
.
¾¾= >
Information
¾¾> I
,
¾¾I J
$str
¾¾K W
,
¾¾W X
this
¾¾Y ]
.
¾¾] ^
GetType
¾¾^ e
(
¾¾e f
)
¾¾f g
,
¾¾g h
$str
¾¾i p
)
¾¾p q
;
¾¾q r
logArgs
¿¿ 
.
¿¿ 
additionInfo
¿¿ $
=
¿¿% &
$str
¿¿' 5
+
¿¿6 7
m_name
¿¿8 >
+
¿¿? @
$str
¿¿A P
+
¿¿Q R
m_thdJob
¿¿S [
.
¿¿[ \
ManagedThreadId
¿¿\ k
.
¿¿k l
ToString
¿¿l t
(
¿¿t u
)
¿¿u v
+
¿¿w x
$str¿¿y Œ
+¿¿ 
m_isBackground¿¿ 
.¿¿ 
ToString¿¿ ¦
(¿¿¦ §
)¿¿§ ¨
+¿¿© ª
$str¿¿« º
+¿¿» ¼

m_priority¿¿½ Ç
.¿¿Ç È
ToString¿¿È Ğ
(¿¿Ğ Ñ
)¿¿Ñ Ò
+¿¿Ó Ô
$str¿¿Õ æ
+¿¿ç è
m_asyncEvent¿¿é õ
.¿¿õ ö
ToString¿¿ö ş
(¿¿ş ÿ
)¿¿ÿ €
+¿¿ ‚
$str¿¿ƒ †
;¿¿† ‡
FDebug
ÀÀ 
.
ÀÀ 
writeLog
ÀÀ 
(
ÀÀ  
logArgs
ÀÀ  '
)
ÀÀ' (
;
ÀÀ( )
}
ÁÁ 
catch
ÂÂ 
(
ÂÂ 
	Exception
ÂÂ 
ex
ÂÂ 
)
ÂÂ  
{
ÃÃ 
FDebug
ÄÄ 
.
ÄÄ 
writeLog
ÄÄ 
(
ÄÄ  
ex
ÄÄ  "
)
ÄÄ" #
;
ÄÄ# $
}
ÅÅ 
finally
ÆÆ 
{
ÇÇ 
args
ÈÈ 
=
ÈÈ 
null
ÈÈ 
;
ÈÈ 
ar
ÉÉ 
=
ÉÉ 
null
ÉÉ 
;
ÉÉ 
}
ÊÊ 
}
ËË 	
private
ÏÏ 
IAsyncResult
ÏÏ 
onThreadStarted
ÏÏ ,
(
ÏÏ, -
FThreadEventArgs
ĞĞ 
args
ĞĞ !
)
ÑÑ 
{
ÒÒ 	
IAsyncResult
ÓÓ 
ar
ÓÓ 
=
ÓÓ 
null
ÓÓ "
;
ÓÓ" #
try
ÕÕ 
{
ÖÖ 
if
×× 
(
×× 
ThreadStarted
×× !
!=
××" $
null
××% )
)
××) *
{
ØØ 
if
ÙÙ 
(
ÙÙ 
m_asyncEvent
ÙÙ $
)
ÙÙ$ %
{
ÚÚ 
ar
ÛÛ 
=
ÛÛ 
ThreadStarted
ÛÛ *
.
ÛÛ* +
BeginInvoke
ÛÛ+ 6
(
ÛÛ6 7
this
ÛÛ7 ;
,
ÛÛ; <
args
ÛÛ= A
,
ÛÛA B
new
ÛÛC F
AsyncCallback
ÛÛG T
(
ÛÛT U 
eventAsyncCallback
ÛÛU g
)
ÛÛg h
,
ÛÛh i
ThreadStarted
ÛÛj w
)
ÛÛw x
;
ÛÛx y
}
ÜÜ 
else
İİ 
{
ŞŞ 
ThreadStarted
ßß %
(
ßß% &
this
ßß& *
,
ßß* +
args
ßß, 0
)
ßß0 1
;
ßß1 2
}
àà 
}
áá 
return
ââ 
ar
ââ 
;
ââ 
}
ãã 
catch
ää 
(
ää 
	Exception
ää 
ex
ää 
)
ää  
{
åå 
FDebug
ææ 
.
ææ 
writeLog
ææ 
(
ææ  
ex
ææ  "
)
ææ" #
;
ææ# $
}
çç 
finally
èè 
{
éé 
}
ëë 
return
ìì 
null
ìì 
;
ìì 
}
íí 	
private
ññ 
IAsyncResult
ññ 
onThreadStopped
ññ ,
(
ññ, -
FThreadEventArgs
òò 
args
òò !
)
óó 
{
ôô 	
IAsyncResult
õõ 
ar
õõ 
=
õõ 
null
õõ "
;
õõ" #
try
÷÷ 
{
øø 
if
ùù 
(
ùù 
ThreadStopped
ùù !
!=
ùù" $
null
ùù% )
)
ùù) *
{
úú 
if
ûû 
(
ûû 
m_asyncEvent
ûû $
)
ûû$ %
{
üü 
ar
ıı 
=
ıı 
ThreadStopped
ıı *
.
ıı* +
BeginInvoke
ıı+ 6
(
ıı6 7
this
ıı7 ;
,
ıı; <
args
ıı= A
,
ııA B
new
ııC F
AsyncCallback
ııG T
(
ııT U 
eventAsyncCallback
ııU g
)
ııg h
,
ııh i
ThreadStopped
ııj w
)
ııw x
;
ııx y
}
şş 
else
ÿÿ 
{
€€ 
ThreadStopped
 %
(
% &
this
& *
,
* +
args
, 0
)
0 1
;
1 2
}
‚‚ 
}
ƒƒ 
return
„„ 
ar
„„ 
;
„„ 
}
…… 
catch
†† 
(
†† 
	Exception
†† 
ex
†† 
)
††  
{
‡‡ 
FDebug
ˆˆ 
.
ˆˆ 
writeLog
ˆˆ 
(
ˆˆ  
ex
ˆˆ  "
)
ˆˆ" #
;
ˆˆ# $
}
‰‰ 
finally
ŠŠ 
{
‹‹ 
}
 
return
 
null
 
;
 
}
 	
private
““ 
IAsyncResult
““ !
onThreadErrorRaised
““ 0
(
““0 1
	Exception
”” 
	exception
”” 
)
•• 
{
–– 	
IAsyncResult
—— 
ar
—— 
=
—— 
null
—— "
;
——" #
try
™™ 
{
šš 
if
›› 
(
›› 
ThreadErrorRaised
›› %
!=
››& (
null
››) -
)
››- .
{
œœ 
if
 
(
 
m_asyncEvent
 $
)
$ %
{
 
ar
ŸŸ 
=
ŸŸ 
ThreadErrorRaised
ŸŸ .
.
ŸŸ. /
BeginInvoke
ŸŸ/ :
(
ŸŸ: ;
this
    
,
    !
new
¡¡ )
FThreadErrorRaisedEventArgs
¡¡  ;
(
¡¡; <
this
¡¡< @
,
¡¡@ A
	exception
¡¡B K
.
¡¡K L
Message
¡¡L S
,
¡¡S T
	exception
¡¡U ^
)
¡¡^ _
,
¡¡_ `
new
¢¢ 
AsyncCallback
¢¢  -
(
¢¢- . 
eventAsyncCallback
¢¢. @
)
¢¢@ A
,
¢¢A B
ThreadErrorRaised
££ -
)
¤¤ 
;
¤¤ 
}
¥¥ 
else
¦¦ 
{
§§ 
ThreadErrorRaised
¨¨ )
(
¨¨) *
this
¨¨* .
,
¨¨. /
new
¨¨0 3)
FThreadErrorRaisedEventArgs
¨¨4 O
(
¨¨O P
this
¨¨P T
,
¨¨T U
	exception
¨¨V _
.
¨¨_ `
Message
¨¨` g
,
¨¨g h
	exception
¨¨i r
)
¨¨r s
)
¨¨s t
;
¨¨t u
}
©© 
}
ªª 
else
«« 
{
¬¬ 
Thread
­­ 
.
­­ 
Sleep
­­  
(
­­  ! 
DefaultThreadSleep
­­! 3
)
­­3 4
;
­­4 5
}
®® 
return
¯¯ 
ar
¯¯ 
;
¯¯ 
}
°° 
catch
±± 
(
±± 

FException
±± 
ex
±±  
)
±±  !
{
²² 
FDebug
³³ 
.
³³ 
writeLog
³³ 
(
³³  
ex
³³  "
)
³³" #
;
³³# $
}
´´ 
finally
µµ 
{
¶¶ 
}
¸¸ 
return
¹¹ 
null
¹¹ 
;
¹¹ 
}
ºº 	
private
¾¾ 
IAsyncResult
¾¾ 
onThreadJobCalled
¾¾ .
(
¾¾. /
FThreadEventArgs
¿¿ 
args
¿¿ !
)
ÀÀ 
{
ÁÁ 	
IAsyncResult
ÂÂ 
ar
ÂÂ 
=
ÂÂ 
null
ÂÂ "
;
ÂÂ" #
try
ÄÄ 
{
ÅÅ 
if
ÆÆ 
(
ÆÆ 
ThreadJobCalled
ÆÆ #
!=
ÆÆ$ &
null
ÆÆ' +
)
ÆÆ+ ,
{
ÇÇ 
if
ÈÈ 
(
ÈÈ 
m_asyncEvent
ÈÈ $
)
ÈÈ$ %
{
ÉÉ 
ar
ÊÊ 
=
ÊÊ 
ThreadJobCalled
ÊÊ ,
.
ÊÊ, -
BeginInvoke
ÊÊ- 8
(
ÊÊ8 9
this
ÊÊ9 =
,
ÊÊ= >
args
ÊÊ? C
,
ÊÊC D
new
ÊÊE H
AsyncCallback
ÊÊI V
(
ÊÊV W 
eventAsyncCallback
ÊÊW i
)
ÊÊi j
,
ÊÊj k
ThreadJobCalled
ÊÊl {
)
ÊÊ{ |
;
ÊÊ| }
}
ËË 
else
ÌÌ 
{
ÍÍ 
ThreadJobCalled
ÎÎ '
(
ÎÎ' (
this
ÎÎ( ,
,
ÎÎ, -
args
ÎÎ. 2
)
ÎÎ2 3
;
ÎÎ3 4
}
ÏÏ 
}
ĞĞ 
else
ÑÑ 
{
ÒÒ 
Thread
ÓÓ 
.
ÓÓ 
Sleep
ÓÓ  
(
ÓÓ  ! 
DefaultThreadSleep
ÓÓ! 3
)
ÓÓ3 4
;
ÓÓ4 5
}
ÔÔ 
return
ÕÕ 
ar
ÕÕ 
;
ÕÕ 
}
ÖÖ 
catch
×× 
(
×× 

FException
×× 
ex
××  
)
××  !
{
ØØ 
FDebug
ÙÙ 
.
ÙÙ 
writeLog
ÙÙ 
(
ÙÙ  
ex
ÙÙ  "
)
ÙÙ" #
;
ÙÙ# $
}
ÚÚ 
finally
ÛÛ 
{
ÜÜ 
}
ŞŞ 
return
ßß 
null
ßß 
;
ßß 
}
àà 	
private
ää 
void
ää  
eventAsyncCallback
ää '
(
ää' (
IAsyncResult
åå 
ar
åå 
)
ææ 
{
çç 	
try
èè 
{
éé 
if
êê 
(
êê 
ar
êê 
.
êê 

AsyncState
êê !
is
êê" $*
FThreadJobCalledEventHandler
êê% A
)
êêA B
{
ëë 
(
ìì 
(
ìì *
FThreadJobCalledEventHandler
ìì 2
)
ìì2 3
ar
ìì3 5
.
ìì5 6

AsyncState
ìì6 @
)
ìì@ A
.
ììA B
	EndInvoke
ììB K
(
ììK L
ar
ììL N
)
ììN O
;
ììO P
}
íí 
else
îî 
if
îî 
(
îî 
ar
îî 
.
îî 

AsyncState
îî &
is
îî' )(
FThreadStartedEventHandler
îî* D
)
îîD E
{
ïï 
(
ğğ 
(
ğğ (
FThreadStartedEventHandler
ğğ 0
)
ğğ0 1
ar
ğğ1 3
.
ğğ3 4

AsyncState
ğğ4 >
)
ğğ> ?
.
ğğ? @
	EndInvoke
ğğ@ I
(
ğğI J
ar
ğğJ L
)
ğğL M
;
ğğM N
}
ññ 
else
òò 
if
òò 
(
òò 
ar
òò 
.
òò 

AsyncState
òò &
is
òò' )(
FThreadStoppedEventHandler
òò* D
)
òòD E
{
óó 
(
ôô 
(
ôô (
FThreadStoppedEventHandler
ôô 0
)
ôô0 1
ar
ôô1 3
.
ôô3 4

AsyncState
ôô4 >
)
ôô> ?
.
ôô? @
	EndInvoke
ôô@ I
(
ôôI J
ar
ôôJ L
)
ôôL M
;
ôôM N
}
õõ 
else
öö 
if
öö 
(
öö 
ar
öö 
.
öö 

AsyncState
öö &
is
öö' ),
FThreadErrorRaisedEventHandler
öö* H
)
ööH I
{
÷÷ 
(
øø 
(
øø ,
FThreadErrorRaisedEventHandler
øø 4
)
øø4 5
ar
øø5 7
.
øø7 8

AsyncState
øø8 B
)
øøB C
.
øøC D
	EndInvoke
øøD M
(
øøM N
ar
øøN P
)
øøP Q
;
øøQ R
}
ùù 
}
úú 
catch
ûû 
(
ûû 
	Exception
ûû 
ex
ûû 
)
ûû  
{
üü 
FDebug
ıı 
.
ıı 
writeLog
ıı 
(
ıı  
ex
ıı  "
)
ıı" #
;
ıı# $
}
şş 
finally
ÿÿ 
{
€€ 
}
‚‚ 
}
ƒƒ 	
}
‰‰ 
}ŠŠ ˆD
ZD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Common\d_FDelegate.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

delegate 
void &
FThreadStartedEventHandler 3
(3 4
object4 :
sender; A
,A B
FThreadEventArgsC S
eT U
)U V
;V W
public 

delegate 
void &
FThreadStoppedEventHandler 3
(3 4
object4 :
sender; A
,A B
FThreadEventArgsC S
eT U
)U V
;V W
public 

delegate 
void *
FThreadErrorRaisedEventHandler 7
(7 8
object8 >
sender? E
,E F'
FThreadErrorRaisedEventArgsG b
ec d
)d e
;e f
public 

delegate 
void (
FThreadJobCalledEventHandler 5
(5 6
object6 <
sender= C
,C D
FThreadEventArgsE U
eV W
)W X
;X Y
public&& 

delegate&& 
void&& %
FTimerElapsedEventHandler&& 2
(&&2 3
object&&3 9
sender&&: @
,&&@ A"
FTimerElapsedEventArgs&&B X
e&&Y Z
)&&Z [
;&&[ \
public-- 

delegate-- 
void-- (
FXmlNodeModifiedEventHandler-- 5
(--5 6
object--6 <
sender--= C
,--C D%
FXmlNodeModifiedEventArgs--E ^
e--_ `
)--` a
;--a b
public44 

delegate44 
void44 3
'FTcpListenerAcceptCompletedEventHandler44 @
(44@ A
object44A G
sender44H N
,44N O0
$FTcpListenerAcceptCompletedEventArgs44P t
e44u v
)44v w
;44w x
public55 

delegate55 
void55 /
#FTcpListenerErrorRaisedEventHandler55 <
(55< =
object55= C
sender55D J
,55J K,
 FTcpListenerErrorRaisedEventArgs55L l
e55m n
)55n o
;55o p
public<< 

delegate<< 
void<< .
"FTcpClientStateChangedEventHandler<< ;
(<<; <
object<<< B
sender<<C I
,<<I J+
FTcpClientStateChangedEventArgs<<K j
e<<k l
)<<l m
;<<m n
public== 

delegate== 
void== .
"FTcpClientDataReceivedEventHandler== ;
(==; <
object==< B
sender==C I
,==I J+
FTcpClientDataReceivedEventArgs==K j
e==k l
)==l m
;==m n
public>> 

delegate>> 
void>> *
FTcpClientDataSentEventHandler>> 7
(>>7 8
object>>8 >
sender>>? E
,>>E F'
FTcpClientDataSentEventArgs>>G b
e>>c d
)>>d e
;>>e f
public?? 

delegate?? 
void?? 0
$FTcpClientDataSendFailedEventHandler?? =
(??= >
object??> D
sender??E K
,??K L-
!FTcpClientDataSendFailedEventArgs??M n
e??o p
)??p q
;??q r
public@@ 

delegate@@ 
void@@ -
!FTcpClientErrorRaisedEventHandler@@ :
(@@: ;
object@@; A
sender@@B H
,@@H I*
FTcpClientErrorRaisedEventArgs@@J h
e@@i j
)@@j k
;@@k l
publicGG 

delegateGG 
voidGG )
FPipeStateChangedEventHandlerGG 6
(GG6 7
objectGG7 =
senderGG> D
,GGD E&
FPipeStateChangedEventArgsGGF `
eGGa b
)GGb c
;GGc d
publicHH 

delegateHH 
voidHH )
FPipeDataReceivedEventHandlerHH 6
(HH6 7
objectHH7 =
senderHH> D
,HHD E&
FPipeDataReceivedEventArgsHHF `
eHHa b
)HHb c
;HHc d
publicII 

delegateII 
voidII %
FPipeDataSentEventHandlerII 2
(II2 3
objectII3 9
senderII: @
,II@ A"
FPipeDataSentEventArgsIIB X
eIIY Z
)IIZ [
;II[ \
publicJJ 

delegateJJ 
voidJJ +
FPipeDataSendFailedEventHandlerJJ 8
(JJ8 9
objectJJ9 ?
senderJJ@ F
,JJF G(
FPipeDataSendFailedEventArgsJJH d
eJJe f
)JJf g
;JJg h
publicKK 

delegateKK 
voidKK (
FPipeErrorRaisedEventHandlerKK 5
(KK5 6
objectKK6 <
senderKK= C
,KKC D%
FPipeErrorRaisedEventArgsKKE ^
eKK_ `
)KK` a
;KKa b
publicRR 

delegateRR 
voidRR +
FSerialStateChangedEventHandlerRR 8
(RR8 9
objectRR9 ?
senderRR@ F
,RRF G(
FSerialStateChangedEventArgsRRH d
eRRe f
)RRf g
;RRg h
publicSS 

delegateSS 
voidSS +
FSerialDataReceivedEventHandlerSS 8
(SS8 9
objectSS9 ?
senderSS@ F
,SSF G(
FSerialDataReceivedEventArgsSSH d
eSSe f
)SSf g
;SSg h
publicTT 

delegateTT 
voidTT '
FSerialDataSentEventHandlerTT 4
(TT4 5
objectTT5 ;
senderTT< B
,TTB C$
FSerialDataSentEventArgsTTD \
eTT] ^
)TT^ _
;TT_ `
publicUU 

delegateUU 
voidUU -
!FSerialDataSendFailedEventHandlerUU :
(UU: ;
objectUU; A
senderUUB H
,UUH I*
FSerialDataSendFailedEventArgsUUJ h
eUUi j
)UUj k
;UUk l
publicVV 

delegateVV 
voidVV *
FSerialErrorRaisedEventHandlerVV 7
(VV7 8
objectVV8 >
senderVV? E
,VVE F'
FSerialErrorRaisedEventArgsVVG b
eVVc d
)VVd e
;VVe f
public]] 

delegate]] 
void]] 4
(FServiceTraceMessageReceivedEventHandler]] A
(]]A B
object]]B H
sender]]I O
,]]O P1
%FServiceTraceMessageReceivedEventArgs]]Q v
e]]w x
)]]x y
;]]y z
public^^ 

delegate^^ 
void^^ 0
$FServiceTraceErrorRaisedEventHandler^^ =
(^^= >
object^^> D
sender^^E K
,^^K L-
!FServiceTraceErrorRaisedEventArgs^^M n
e^^o p
)^^p q
;^^q r
publicee 

delegateee 
voidee (
FProcessResourceEventHandleree 5
(ee5 6
objectee6 <
senderee= C
,eeC D%
FProcessResourceEventArgseeE ^
eee_ `
)ee` a
;eea b
publicff 

delegateff 
voidff '
FSystemResourceEventHandlerff 4
(ff4 5
objectff5 ;
senderff< B
,ffB C$
FSystemResourceEventArgsffD \
eff] ^
)ff^ _
;ff_ `
publicmm 

delegatemm 
voidmm +
FTelnetStateChangedEventHandlermm 8
(mm8 9
objectmm9 ?
sendermm@ F
,mmF G(
FTelnetStateChangedEventArgsmmH d
emme f
)mmf g
;mmg h
publicnn 

delegatenn 
voidnn -
!FTelnetPacketReceivedEventHandlernn :
(nn: ;
objectnn; A
sendernnB H
,nnH I*
FTelnetPacketReceivedEventArgsnnJ h
enni j
)nnj k
;nnk l
publicoo 

delegateoo 
voidoo )
FTelnetPacketSentEventHandleroo 6
(oo6 7
objectoo7 =
senderoo> D
,ooD E&
FTelnetPacketSentEventArgsooF `
eooa b
)oob c
;ooc d
publicvv 

delegatevv 
voidvv (
FH101ErrorRaisedEventHandlervv 5
(vv5 6
objectvv6 <
sendervv= C
,vvC D%
FH101ErrorRaisedEventArgsvvE ^
evv_ `
)vv` a
;vva b
publicww 

delegateww 
voidww &
FH101ConnectedEventHandlerww 3
(ww3 4
objectww4 :
senderww; A
)wwA B
;wwB C
publicxx 

delegatexx 
voidxx )
FH101DisconnectedEventHandlerxx 6
(xx6 7
objectxx7 =
senderxx> D
)xxD E
;xxE F
}|| —$
lD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Thread\c_FThreadErrorRaisedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
Serializable 
] 
public 

class '
FThreadErrorRaisedEventArgs ,
:- .
	EventArgs/ 8
,8 9
IDisposable: E
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
[ 	
NonSerialized	 
] 
private 
FThread 
m_owerThread $
=% &
null' +
;+ ,
private 
string 
	m_message  
=! "
string# )
.) *
Empty* /
;/ 0
private   
	Exception   
m_exception   %
=  & '
null  ( ,
;  , -
internal&& '
FThreadErrorRaisedEventArgs&& ,
(&&, -
FThread'' 

owerThread'' 
,'' 
string(( 
message(( 
,(( 
	Exception)) 
	exception)) 
)** 
{++ 	
m_owerThread,, 
=,, 

owerThread,, %
;,,% &
	m_message-- 
=-- 
message-- 
;--  
m_exception.. 
=.. 
	exception.. #
;..# $
}// 	
~33 	'
FThreadErrorRaisedEventArgs33	 $
(33$ %
)44 
{55 	
	myDispose66 
(66 
false66 
)66 
;66 
}77 	
	protected;; 
void;; 
	myDispose;;  
(;;  !
bool<< 
	disposing<< 
)== 
{>> 	
if?? 
(?? 
!?? 

m_disposed?? 
)?? 
{@@ 
ifAA 
(AA 
	disposingAA 
)AA 
{BB 
m_owerThreadCC  
=CC! "
nullCC# '
;CC' (
m_exceptionDD 
=DD  !
nullDD" &
;DD& '
}EE 

m_disposedGG 
=GG 
trueGG !
;GG! "
}HH 
}II 	
publicQQ 
voidQQ 
DisposeQQ 
(QQ 
)RR 
{SS 	
	myDisposeTT 
(TT 
trueTT 
)TT 
;TT 
GCUU 
.UU 
SuppressFinalizeUU 
(UU  
thisUU  $
)UU$ %
;UU% &
}VV 	
public^^ 
FThread^^ 
onwerThread^^ "
{__ 	
get`` 
{aa 
trybb 
{cc 
returndd 
m_owerThreaddd '
;dd' (
}ee 
catchff 
(ff 
	Exceptionff  
exff! #
)ff# $
{gg 
FDebughh 
.hh 
throwExceptionhh )
(hh) *
exhh* ,
)hh, -
;hh- .
}ii 
finallyjj 
{kk 
}mm 
returnnn 
nullnn 
;nn 
}oo 
}pp 	
publictt 
stringtt 
messagett 
{uu 	
getvv 
{ww 
tryxx 
{yy 
returnzz 
	m_messagezz $
;zz$ %
}{{ 
catch|| 
(|| 
	Exception||  
ex||! #
)||# $
{}} 
FDebug~~ 
.~~ 
throwException~~ )
(~~) *
ex~~* ,
)~~, -
;~~- .
} 
finally
€€ 
{
 
}
ƒƒ 
return
„„ 
string
„„ 
.
„„ 
Empty
„„ #
;
„„# $
}
…… 
}
†† 	
public
ŠŠ 
	Exception
ŠŠ 
	exception
ŠŠ "
{
‹‹ 	
get
ŒŒ 
{
 
try
 
{
 
return
 
m_exception
 &
;
& '
}
‘‘ 
catch
’’ 
(
’’ 
	Exception
’’  
ex
’’! #
)
’’# $
{
““ 
FDebug
”” 
.
”” 
throwException
”” )
(
””) *
ex
””* ,
)
””, -
;
””- .
}
•• 
finally
–– 
{
—— 
}
™™ 
return
šš 
null
šš 
;
šš 
}
›› 
}
œœ 	
}
¨¨ 
}©© ó
YD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Time\c_FTickCount.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

static 
class 

FTickCount "
{ 
static 

FTickCount 
( 
) 
{ 	
} 	
public'' 
static'' 
long'' 
ticks''  
{(( 	
get)) 
{** 
try++ 
{,, 
return00 
Environment00 &
.00& '
	TickCount00' 0
&001 2
Int32003 8
.008 9
MaxValue009 A
;00A B
}11 
catch22 
(22 
	Exception22  
ex22! #
)22# $
{33 
FDebug44 
.44 
throwException44 )
(44) *
ex44* ,
)44, -
;44- .
}55 
finally66 
{77 
}99 
return:: 
$num:: 
;:: 
};; 
}<< 	
publicDD 
staticDD 
longDD 
addTicksDD #
(DD# $
longEE 
	baseTicksEE 
,EE 
longFF 
valueFF 
)GG 
{HH 	
tryII 
{JJ 
returnKK 
(KK 
	baseTicksKK !
+KK" #
valueKK$ )
)KK) *
&KK+ ,
Int32KK- 2
.KK2 3
MaxValueKK3 ;
;KK; <
}LL 
catchMM 
(MM 
	ExceptionMM 
exMM 
)MM  
{NN 
FDebugOO 
.OO 
throwExceptionOO %
(OO% &
exOO& (
)OO( )
;OO) *
}PP 
finallyQQ 
{RR 
}TT 
returnUU 
$numUU 
;UU 
}VV 	
publicZZ 
staticZZ 
boolZZ 
timeoutZZ "
(ZZ" #
long[[ 
ticks[[ 
,[[ 
int\\ 
dueTime\\ 
)]] 
{^^ 	
long__ 
newTicks__ 
=__ 
$num__ 
;__ 
long`` 
result`` 
=`` 
$num`` 
;`` 
trybb 
{cc 
newTicksdd 
=dd 

FTickCountdd %
.dd% &
ticksdd& +
;dd+ ,
resultee 
=ee 
(ee 
newTicksee "
-ee# $
ticksee% *
)ee* +
&ee, -
Int32ee. 3
.ee3 4
MaxValueee4 <
;ee< =
returnff 
(ff 
resultff 
<ff  
dueTimeff! (
?ff) *
falseff+ 0
:ff1 2
trueff3 7
)ff7 8
;ff8 9
}gg 
catchhh 
(hh 
	Exceptionhh 
exhh 
)hh  
{ii 
FDebugjj 
.jj 
throwExceptionjj %
(jj% &
exjj& (
)jj( )
;jj) *
}kk 
finallyll 
{mm 
}oo 
returnpp 
falsepp 
;pp 
}qq 	
}ww 
}xx ©v
UD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Time\c_FTimer.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FTimer 
: 
IDisposable %
{ 
public 
event %
FTimerElapsedEventHandler .
TimerElapsed/ ;
=< =
null> B
;B C
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
string 
m_name 
= 
string  &
.& '
Empty' ,
;, -
private 
bool 
m_atOnce 
= 
false  %
;% &
private 
int 
m_period 
= 
$num  
;  !
private   
bool   
m_asyncEvent   !
=  " #
false  $ )
;  ) *
private!! 
bool!! 
	m_enabled!! 
=!!  
false!!! &
;!!& '
private## 
FThread## 
	m_fThread## !
=##" #
null##$ (
;##( )
private$$ 
IAsyncResult$$ 
m_ar$$ !
=$$" #
null$$$ (
;$$( )
private%% "
FTimerElapsedEventArgs%% &#
m_fTimeElapsedEventArgs%%' >
=%%? @
null%%A E
;%%E F
private&& 
long&& 
m_ticks&& 
=&& 
$num&&  
;&&  !
public,, 
FTimer,, 
(,, 
string-- 
name-- 
,-- 
bool.. 
atOnce.. 
,.. 
int// 
period// 
,// 
bool00 

asyncEvent00 
)11 
{22 	
m_name33 
=33 
name33 
;33 
m_atOnce44 
=44 
atOnce44 
;44 
m_period55 
=55 
period55 
;55 
m_asyncEvent66 
=66 

asyncEvent66 %
;66% &
}77 	
~;; 	
FTimer;;	 
(;; 
)<< 
{== 	
	myDispose>> 
(>> 
false>> 
)>> 
;>> 
}?? 	
	protectedCC 
voidCC 
	myDisposeCC  
(CC  !
boolDD 
	disposingDD 
)EE 
{FF 	
ifGG 
(GG 
!GG 

m_disposedGG 
)GG 
{HH 
ifII 
(II 
	disposingII 
)II 
{JJ 
stopKK 
(KK 
)KK 
;KK 
}LL 

m_disposedNN 
=NN 
trueNN !
;NN! "
}OO 
}PP 	
publicXX 
voidXX 
DisposeXX 
(XX 
)YY 
{ZZ 	
	myDispose[[ 
([[ 
true[[ 
)[[ 
;[[ 
GC\\ 
.\\ 
SuppressFinalize\\ 
(\\  
this\\  $
)\\$ %
;\\% &
}]] 	
publicee 
stringee 
nameee 
{ff 	
getgg 
{hh 
tryii 
{jj 
returnkk 
m_namekk !
;kk! "
}ll 
catchmm 
(mm 
	Exceptionmm  
exmm! #
)mm# $
{nn 
FDebugoo 
.oo 
throwExceptionoo )
(oo) *
exoo* ,
)oo, -
;oo- .
}pp 
finallyqq 
{rr 
}tt 
returnuu 
stringuu 
.uu 
Emptyuu #
;uu# $
}vv 
}ww 	
public{{ 
bool{{ 
atOnce{{ 
{|| 	
get}} 
{~~ 
try 
{
€€ 
return
 
m_atOnce
 #
;
# $
}
‚‚ 
catch
ƒƒ 
(
ƒƒ 
	Exception
ƒƒ  
ex
ƒƒ! #
)
ƒƒ# $
{
„„ 
FDebug
…… 
.
…… 
throwException
…… )
(
……) *
ex
……* ,
)
……, -
;
……- .
}
†† 
finally
‡‡ 
{
ˆˆ 
}
ŠŠ 
return
‹‹ 
false
‹‹ 
;
‹‹ 
}
ŒŒ 
}
 	
public
‘‘ 
int
‘‘ 
period
‘‘ 
{
’’ 	
get
““ 
{
”” 
try
•• 
{
–– 
return
—— 
m_period
—— #
;
——# $
}
˜˜ 
catch
™™ 
(
™™ 
	Exception
™™  
ex
™™! #
)
™™# $
{
šš 
FDebug
›› 
.
›› 
throwException
›› )
(
››) *
ex
››* ,
)
››, -
;
››- .
}
œœ 
finally
 
{
 
}
   
return
¡¡ 
$num
¡¡ 
;
¡¡ 
}
¢¢ 
}
££ 	
public
§§ 
bool
§§ 
enabled
§§ 
{
¨¨ 	
get
©© 
{
ªª 
try
«« 
{
¬¬ 
return
­­ 
	m_enabled
­­ $
;
­­$ %
}
®® 
catch
¯¯ 
(
¯¯ 
	Exception
¯¯  
ex
¯¯! #
)
¯¯# $
{
°° 
FDebug
±± 
.
±± 
throwException
±± )
(
±±) *
ex
±±* ,
)
±±, -
;
±±- .
}
²² 
finally
³³ 
{
´´ 
}
¶¶ 
return
·· 
false
·· 
;
·· 
}
¸¸ 
}
¹¹ 	
public
ÁÁ 
void
ÁÁ 
start
ÁÁ 
(
ÁÁ 
)
ÂÂ 
{
ÃÃ 	
try
ÄÄ 
{
ÅÅ 
if
ÆÆ 
(
ÆÆ 
	m_enabled
ÆÆ 
)
ÆÆ 
{
ÇÇ 
return
ÈÈ 
;
ÈÈ 
}
ÉÉ 
	m_enabled
ÍÍ 
=
ÍÍ 
true
ÍÍ  
;
ÍÍ  !
if
ÎÎ 
(
ÎÎ %
m_fTimeElapsedEventArgs
ÎÎ +
==
ÎÎ, .
null
ÎÎ/ 3
)
ÎÎ3 4
{
ÏÏ %
m_fTimeElapsedEventArgs
ĞĞ +
=
ĞĞ, -
new
ĞĞ. 1$
FTimerElapsedEventArgs
ĞĞ2 H
(
ĞĞH I
this
ĞĞI M
)
ĞĞM N
;
ĞĞN O
}
ÑÑ 
if
ÕÕ 
(
ÕÕ 
m_atOnce
ÕÕ 
)
ÕÕ 
{
ÖÖ 
m_ticks
×× 
=
×× 

FTickCount
×× (
.
××( )
addTicks
××) 1
(
××1 2

FTickCount
××2 <
.
××< =
ticks
××= B
,
××B C
m_period
××D L
*
××M N
-
××O P
$num
××P Q
)
××Q R
;
××R S
}
ØØ 
else
ÙÙ 
{
ÚÚ 
m_ticks
ÛÛ 
=
ÛÛ 

FTickCount
ÛÛ (
.
ÛÛ( )
ticks
ÛÛ) .
;
ÛÛ. /
}
ÜÜ 
	m_fThread
àà 
=
àà 
new
àà 
FThread
àà  '
(
àà' (
$str
àà( 1
+
àà2 3
m_name
àà4 :
)
àà: ;
;
àà; <
	m_fThread
áá 
.
áá 
ThreadJobCalled
áá )
+=
áá* ,
new
áá- 0*
FThreadJobCalledEventHandler
áá1 M
(
ááM N&
m_thread_ThreadJobCalled
ááN f
)
ááf g
;
áág h
	m_fThread
ââ 
.
ââ 
start
ââ 
(
ââ  
)
ââ  !
;
ââ! "
}
ãã 
catch
ää 
(
ää 
	Exception
ää 
ex
ää 
)
ää  
{
åå 
FDebug
ææ 
.
ææ 
throwException
ææ %
(
ææ% &
ex
ææ& (
)
ææ( )
;
ææ) *
}
çç 
finally
èè 
{
éé 
}
ëë 
}
ìì 	
public
ğğ 
void
ğğ 
stop
ğğ 
(
ğğ 
)
ññ 
{
òò 	
try
óó 
{
ôô 
if
õõ 
(
õõ 
!
õõ 
	m_enabled
õõ 
)
õõ 
{
öö 
return
÷÷ 
;
÷÷ 
}
øø 
if
úú 
(
úú 
	m_fThread
úú 
!=
úú  
null
úú! %
)
úú% &
{
ûû 
	m_fThread
üü 
.
üü 
ThreadJobCalled
üü -
-=
üü. 0
new
üü1 4*
FThreadJobCalledEventHandler
üü5 Q
(
üüQ R&
m_thread_ThreadJobCalled
üüR j
)
üüj k
;
üük l
	m_fThread
ıı 
.
ıı 
stop
ıı "
(
ıı" #
)
ıı# $
;
ıı$ %
	m_fThread
şş 
.
şş 
Dispose
şş %
(
şş% &
)
şş& '
;
şş' (
	m_fThread
ÿÿ 
=
ÿÿ 
null
ÿÿ  $
;
ÿÿ$ %
}
€€ 
	m_enabled
 
=
 
false
 !
;
! "
}
‚‚ 
catch
ƒƒ 
(
ƒƒ 
	Exception
ƒƒ 
ex
ƒƒ 
)
ƒƒ  
{
„„ 
FDebug
…… 
.
…… 
throwException
…… %
(
……% &
ex
……& (
)
……( )
;
……) *
}
†† 
finally
‡‡ 
{
ˆˆ 
}
ŠŠ 
}
‹‹ 	
public
 
void
 
restart
 
(
 
)
 
{
‘‘ 	
try
’’ 
{
““ 
if
”” 
(
”” 
	m_enabled
”” 
)
”” 
{
•• 
stop
–– 
(
–– 
)
–– 
;
–– 
}
—— 
start
˜˜ 
(
˜˜ 
)
˜˜ 
;
˜˜ 
}
™™ 
catch
šš 
(
šš 
	Exception
šš 
ex
šš 
)
šš  
{
›› 
FDebug
œœ 
.
œœ 
throwException
œœ %
(
œœ% &
ex
œœ& (
)
œœ( )
;
œœ) *
}
 
finally
 
{
ŸŸ 
}
¡¡ 
}
¢¢ 	
private
¦¦ 
IAsyncResult
¦¦ 
onTimerElapsed
¦¦ +
(
¦¦+ ,
)
§§ 
{
¨¨ 	
IAsyncResult
©© 
ar
©© 
=
©© 
null
©© "
;
©©" #
try
«« 
{
¬¬ 
if
­­ 
(
­­ 
TimerElapsed
­­  
!=
­­! #
null
­­$ (
)
­­( )
{
®® 
if
¯¯ 
(
¯¯ 
m_asyncEvent
¯¯ $
)
¯¯$ %
{
°° 
ar
±± 
=
±± 
TimerElapsed
±± )
.
±±) *
BeginInvoke
±±* 5
(
±±5 6
this
±±6 :
,
±±: ;%
m_fTimeElapsedEventArgs
±±< S
,
±±S T
new
±±U X
AsyncCallback
±±Y f
(
±±f g 
eventAsyncCallback
±±g y
)
±±y z
,
±±z {
TimerElapsed±±| ˆ
)±±ˆ ‰
;±±‰ Š
}
²² 
else
³³ 
{
´´ 
TimerElapsed
µµ $
(
µµ$ %
this
µµ% )
,
µµ) *%
m_fTimeElapsedEventArgs
µµ+ B
)
µµB C
;
µµC D
}
¶¶ 
}
·· 
return
¸¸ 
ar
¸¸ 
;
¸¸ 
}
¹¹ 
catch
ºº 
(
ºº 
	Exception
ºº 
ex
ºº 
)
ºº  
{
»» 
FDebug
¼¼ 
.
¼¼ 
writeLog
¼¼ 
(
¼¼  
ex
¼¼  "
)
¼¼" #
;
¼¼# $
}
½½ 
finally
¾¾ 
{
¿¿ 
}
ÁÁ 
return
ÂÂ 
null
ÂÂ 
;
ÂÂ 
}
ÃÃ 	
private
ÇÇ 
void
ÇÇ  
eventAsyncCallback
ÇÇ '
(
ÇÇ' (
IAsyncResult
ÈÈ 
ar
ÈÈ 
)
ÉÉ 
{
ÊÊ 	
try
ËË 
{
ÌÌ 
if
ÍÍ 
(
ÍÍ 
ar
ÍÍ 
.
ÍÍ 

AsyncState
ÍÍ !
is
ÍÍ" $'
FTimerElapsedEventHandler
ÍÍ% >
)
ÍÍ> ?
{
ÎÎ 
(
ÏÏ 
(
ÏÏ '
FTimerElapsedEventHandler
ÏÏ /
)
ÏÏ/ 0
ar
ÏÏ0 2
.
ÏÏ2 3

AsyncState
ÏÏ3 =
)
ÏÏ= >
.
ÏÏ> ?
	EndInvoke
ÏÏ? H
(
ÏÏH I
ar
ÏÏI K
)
ÏÏK L
;
ÏÏL M
}
ĞĞ 
}
ÑÑ 
catch
ÒÒ 
(
ÒÒ 
	Exception
ÒÒ 
ex
ÒÒ 
)
ÒÒ  
{
ÓÓ 
FDebug
ÔÔ 
.
ÔÔ 
writeLog
ÔÔ 
(
ÔÔ  
ex
ÔÔ  "
)
ÔÔ" #
;
ÔÔ# $
}
ÕÕ 
finally
ÖÖ 
{
×× 
}
ÙÙ 
}
ÚÚ 	
private
ââ 
void
ââ &
m_thread_ThreadJobCalled
ââ -
(
ââ- .
object
ãã 
sender
ãã 
,
ãã 
FThreadEventArgs
ää 
e
ää 
)
åå 
{
ææ 	
try
çç 
{
èè 
if
éé 
(
éé 
m_ar
éé 
!=
éé 
null
éé  
)
éé  !
{
êê 
if
ëë 
(
ëë 
!
ëë 
m_ar
ëë 
.
ëë 
AsyncWaitHandle
ëë -
.
ëë- .
WaitOne
ëë. 5
(
ëë5 6
$num
ëë6 7
)
ëë7 8
)
ëë8 9
{
ìì 
return
íí 
;
íí 
}
îî 
m_ar
ïï 
.
ïï 
AsyncWaitHandle
ïï (
.
ïï( )
Dispose
ïï) 0
(
ïï0 1
)
ïï1 2
;
ïï2 3
m_ar
ğğ 
=
ğğ 
null
ğğ 
;
ğğ  
}
ññ 
if
õõ 
(
õõ 

FTickCount
õõ 
.
õõ 
timeout
õõ &
(
õõ& '
m_ticks
õõ' .
,
õõ. /
m_period
õõ0 8
)
õõ8 9
)
õõ9 :
{
öö 
m_ticks
÷÷ 
=
÷÷ 

FTickCount
÷÷ (
.
÷÷( )
addTicks
÷÷) 1
(
÷÷1 2
m_ticks
÷÷2 9
,
÷÷9 :
m_period
÷÷; C
)
÷÷C D
;
÷÷D E
m_ar
øø 
=
øø 
onTimerElapsed
øø )
(
øø) *
)
øø* +
;
øø+ ,
}
ùù 
else
úú 
{
ûû 
e
üü 
.
üü 
sleepThread
üü !
(
üü! "
$num
üü" #
)
üü# $
;
üü$ %
}
ıı 
}
şş 
catch
ÿÿ 
(
ÿÿ 
	Exception
ÿÿ 
ex
ÿÿ 
)
ÿÿ  
{
€€ 
FDebug
 
.
 
writeLog
 
(
  
ex
  "
)
" #
;
# $
}
‚‚ 
finally
ƒƒ 
{
„„ 
}
†† 
}
‡‡ 	
}
 
} ¸>
[D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Time\c_FStaticTimer.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FStaticTimer 
: 
IDisposable  +
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
int 
	m_dueTime 
= 
$num  $
;$ %
private 
bool 
	m_enabled 
=  
false! &
;& '
private 
long 
m_ticks 
= 
$num  
;  !
public## 
FStaticTimer## 
(## 
)$$ 
{%% 	
}'' 	
~++ 	
FStaticTimer++	 
(++ 
),, 
{-- 	
	myDispose.. 
(.. 
false.. 
).. 
;.. 
}// 	
	protected33 
void33 
	myDispose33  
(33  !
bool44 
	disposing44 
)55 
{66 	
if77 
(77 
!77 

m_disposed77 
)77 
{88 
if99 
(99 
	disposing99 
)99 
{:: 
}<< 

m_disposed>> 
=>> 
true>> !
;>>! "
}?? 
}@@ 	
publicHH 
voidHH 
DisposeHH 
(HH 
)II 
{JJ 	
	myDisposeKK 
(KK 
trueKK 
)KK 
;KK 
GCLL 
.LL 
SuppressFinalizeLL 
(LL  
thisLL  $
)LL$ %
;LL% &
}MM 	
publicUU 
intUU 
dueTimeUU 
{VV 	
getWW 
{XX 
tryYY 
{ZZ 
return[[ 
	m_dueTime[[ $
;[[$ %
}\\ 
catch]] 
(]] 
	Exception]]  
ex]]! #
)]]# $
{^^ 
FDebug__ 
.__ 
throwException__ )
(__) *
ex__* ,
)__, -
;__- .
}`` 
finallyaa 
{bb 
}dd 
returnee 
$numee 
;ee 
}ff 
}gg 	
publickk 
boolkk 
enabledkk 
{ll 	
getmm 
{nn 
tryoo 
{pp 
returnqq 
	m_enabledqq $
;qq$ %
}rr 
catchss 
(ss 
	Exceptionss  
exss! #
)ss# $
{tt 
FDebuguu 
.uu 
throwExceptionuu )
(uu) *
exuu* ,
)uu, -
;uu- .
}vv 
finallyww 
{xx 
}zz 
return{{ 
false{{ 
;{{ 
}|| 
}}} 	
public
…… 
void
…… 
start
…… 
(
…… 
int
†† 
dueTime
†† 
)
‡‡ 
{
ˆˆ 	
try
‰‰ 
{
ŠŠ 
if
‹‹ 
(
‹‹ 
	m_enabled
‹‹ 
)
‹‹ 
{
ŒŒ 
return
 
;
 
}
 
	m_enabled
 
=
 
true
  
;
  !
	m_dueTime
‘‘ 
=
‘‘ 
dueTime
‘‘ #
;
‘‘# $
m_ticks
’’ 
=
’’ 

FTickCount
’’ $
.
’’$ %
ticks
’’% *
;
’’* +
}
““ 
catch
”” 
(
”” 
	Exception
”” 
ex
”” 
)
””  
{
•• 
FDebug
–– 
.
–– 
throwException
–– %
(
––% &
ex
––& (
)
––( )
;
––) *
}
—— 
finally
˜˜ 
{
™™ 
}
›› 
}
œœ 	
public
   
void
   
stop
   
(
   
)
¡¡ 
{
¢¢ 	
try
££ 
{
¤¤ 
if
¥¥ 
(
¥¥ 
!
¥¥ 
	m_enabled
¥¥ 
)
¥¥ 
{
¦¦ 
return
§§ 
;
§§ 
}
¨¨ 
m_ticks
ªª 
=
ªª 
$num
ªª 
;
ªª 
	m_enabled
«« 
=
«« 
false
«« !
;
««! "
}
¬¬ 
catch
­­ 
(
­­ 
	Exception
­­ 
ex
­­ 
)
­­  
{
®® 
FDebug
¯¯ 
.
¯¯ 
throwException
¯¯ %
(
¯¯% &
ex
¯¯& (
)
¯¯( )
;
¯¯) *
}
°° 
finally
±± 
{
²² 
}
´´ 
}
µµ 	
public
¹¹ 
void
¹¹ 
restart
¹¹ 
(
¹¹ 
)
ºº 
{
»» 	
try
¼¼ 
{
½½ 
restart
¾¾ 
(
¾¾ 
	m_dueTime
¾¾ !
)
¾¾! "
;
¾¾" #
}
¿¿ 
catch
ÀÀ 
(
ÀÀ 
	Exception
ÀÀ 
ex
ÀÀ 
)
ÀÀ  
{
ÁÁ 
FDebug
ÂÂ 
.
ÂÂ 
throwException
ÂÂ %
(
ÂÂ% &
ex
ÂÂ& (
)
ÂÂ( )
;
ÂÂ) *
}
ÃÃ 
finally
ÄÄ 
{
ÅÅ 
}
ÇÇ 
}
ÈÈ 	
public
ÌÌ 
void
ÌÌ 
restart
ÌÌ 
(
ÌÌ 
int
ÍÍ 
dueTime
ÍÍ 
)
ÎÎ 
{
ÏÏ 	
try
ĞĞ 
{
ÑÑ 
if
ÒÒ 
(
ÒÒ 
	m_enabled
ÒÒ 
)
ÒÒ 
{
ÓÓ 
stop
ÔÔ 
(
ÔÔ 
)
ÔÔ 
;
ÔÔ 
}
ÕÕ 
start
ÖÖ 
(
ÖÖ 
dueTime
ÖÖ 
)
ÖÖ 
;
ÖÖ 
}
×× 
catch
ØØ 
(
ØØ 
	Exception
ØØ 
ex
ØØ 
)
ØØ  
{
ÙÙ 
FDebug
ÚÚ 
.
ÚÚ 
throwException
ÚÚ %
(
ÚÚ% &
ex
ÚÚ& (
)
ÚÚ( )
;
ÚÚ) *
}
ÛÛ 
finally
ÜÜ 
{
İİ 
}
ßß 
}
àà 	
public
ää 
bool
ää 
elasped
ää 
(
ää 
bool
åå 
autoRestart
åå 
)
ææ 
{
çç 	
try
èè 
{
éé 
if
êê 
(
êê 
!
êê 
	m_enabled
êê 
)
êê 
{
ëë 
return
ìì 
false
ìì  
;
ìì  !
}
íí 
if
ïï 
(
ïï 

FTickCount
ïï 
.
ïï 
timeout
ïï &
(
ïï& '
m_ticks
ïï' .
,
ïï. /
	m_dueTime
ïï0 9
)
ïï9 :
)
ïï: ;
{
ğğ 
if
ññ 
(
ññ 
autoRestart
ññ #
)
ññ# $
{
òò 
m_ticks
óó 
=
óó  !

FTickCount
óó" ,
.
óó, -
addTicks
óó- 5
(
óó5 6
m_ticks
óó6 =
,
óó= >
	m_dueTime
óó? H
)
óóH I
;
óóI J
}
ôô 
else
õõ 
{
öö 
stop
÷÷ 
(
÷÷ 
)
÷÷ 
;
÷÷ 
}
øø 
return
ùù 
true
ùù 
;
ùù  
}
úú 
return
ûû 
false
ûû 
;
ûû 
}
üü 
catch
ıı 
(
ıı 
	Exception
ıı 
ex
ıı 
)
ıı  
{
şş 
FDebug
ÿÿ 
.
ÿÿ 
throwException
ÿÿ %
(
ÿÿ% &
ex
ÿÿ& (
)
ÿÿ( )
;
ÿÿ) *
}
€€ 
finally
 
{
‚‚ 
}
„„ 
return
…… 
false
…… 
;
…… 
}
†† 	
}
ŒŒ 
} È!
eD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Time\c_FTimerElapsedEventArgs.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
[ 
Serializable 
] 
public 

class "
FTimerElapsedEventArgs '
:( )
	EventArgs* 3
,3 4
IDisposable5 @
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FTimer 
m_ownerTimer #
=$ %
null& *
;* +
private 
object 
m_savedData "
=# $
null% )
;) *
internal"" "
FTimerElapsedEventArgs"" '
(""' (
FTimer## 

ownerTimer## 
)$$ 
{%% 	
m_ownerTimer&& 
=&& 

ownerTimer&& %
;&&% &
}'' 	
~++ 	"
FTimerElapsedEventArgs++	 
(++  
),, 
{-- 	
	myDispose.. 
(.. 
false.. 
).. 
;.. 
}// 	
	protected33 
void33 
	myDispose33  
(33  !
bool44 
	disposing44 
)55 
{66 	
if77 
(77 
!77 

m_disposed77 
)77 
{88 
if99 
(99 
	disposing99 
)99 
{:: 
}<< 

m_disposed>> 
=>> 
true>> !
;>>! "
}?? 
}@@ 	
publicHH 
voidHH 
DisposeHH 
(HH 
)II 
{JJ 	
	myDisposeKK 
(KK 
trueKK 
)KK 
;KK 
GCLL 
.LL 
SuppressFinalizeLL 
(LL  
thisLL  $
)LL$ %
;LL% &
}MM 	
publicUU 
FTimerUU 

ownerTimerUU  
{VV 	
getWW 
{XX 
tryYY 
{ZZ 
return[[ 
m_ownerTimer[[ '
;[[' (
}\\ 
catch]] 
(]] 
	Exception]]  
ex]]! #
)]]# $
{^^ 
FDebug__ 
.__ 
throwException__ )
(__) *
ex__* ,
)__, -
;__- .
}`` 
finallyaa 
{bb 
}dd 
returnee 
nullee 
;ee 
}ff 
sethh 
{ii 
tryjj 
{kk 
m_ownerTimerll  
=ll! "
valuell# (
;ll( )
}mm 
catchnn 
(nn 
	Exceptionnn  
exnn! #
)nn# $
{oo 
FDebugpp 
.pp 
throwExceptionpp )
(pp) *
expp* ,
)pp, -
;pp- .
}qq 
finallyrr 
{ss 
}uu 
}vv 
}ww 	
public{{ 
object{{ 
	savedData{{ 
{|| 	
get}} 
{~~ 
try 
{
€€ 
return
 
m_savedData
 &
;
& '
}
‚‚ 
catch
ƒƒ 
(
ƒƒ 
	Exception
ƒƒ  
ex
ƒƒ! #
)
ƒƒ# $
{
„„ 
FDebug
…… 
.
…… 
throwException
…… )
(
……) *
ex
……* ,
)
……, -
;
……- .
}
†† 
finally
‡‡ 
{
ˆˆ 
}
ŠŠ 
return
‹‹ 
null
‹‹ 
;
‹‹ 
}
ŒŒ 
set
 
{
 
try
 
{
‘‘ 
m_savedData
’’ 
=
’’  !
value
’’" '
;
’’' (
}
““ 
catch
”” 
(
”” 
	Exception
””  
ex
””! #
)
””# $
{
•• 
FDebug
–– 
.
–– 
throwException
–– )
(
––) *
ex
––* ,
)
––, -
;
––- .
}
—— 
finally
˜˜ 
{
™™ 
}
›› 
}
œœ 
}
 	
}
©© 
}ªª Ò 
VD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Xml\c_FXmlCore.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
internal 
class 
FXmlCore 
: 
IDisposable )
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
	FCodeLock 
m_fCodeLock %
=& '
null( ,
;, -
private 
FXmlDocument 
m_fXmlDocument +
=, -
null. 2
;2 3
public"" 
FXmlCore"" 
("" 
FXmlDocument## 
fXmlDocument## %
)$$ 
{%% 	
m_fCodeLock&& 
=&& 
new&& 
	FCodeLock&& '
(&&' (
)&&( )
;&&) *
m_fXmlDocument'' 
='' 
fXmlDocument'' )
;'') *
}(( 	
~,, 	
FXmlCore,,	 
(,, 
)-- 
{.. 	
	myDispose// 
(// 
false// 
)// 
;// 
}00 	
	protected44 
void44 
	myDispose44  
(44  !
bool55 
	disposing55 
)66 
{77 	
if88 
(88 
!88 

m_disposed88 
)88 
{99 
if:: 
(:: 
	disposing:: 
):: 
{;; 
if<< 
(<< 
m_fCodeLock<< #
!=<<$ &
null<<' +
)<<+ ,
{== 
m_fCodeLock>> #
.>># $
Dispose>>$ +
(>>+ ,
)>>, -
;>>- .
m_fCodeLock?? #
=??$ %
null??& *
;??* +
}@@ 
}AA 

m_disposedBB 
=BB 
trueBB !
;BB! "
}CC 
}DD 	
publicLL 
voidLL 
DisposeLL 
(LL 
)MM 
{NN 	
	myDisposeOO 
(OO 
trueOO 
)OO 
;OO 
GCPP 
.PP 
SuppressFinalizePP 
(PP  
thisPP  $
)PP$ %
;PP% &
}QQ 	
publicYY 
FXmlDocumentYY 
xmlDocumentYY '
{ZZ 	
get[[ 
{\\ 
try]] 
{^^ 
return__ 
m_fXmlDocument__ )
;__) *
}`` 
catchaa 
(aa 
	Exceptionaa  
exaa! #
)aa# $
{bb 
FDebugcc 
.cc 
throwExceptioncc )
(cc) *
excc* ,
)cc, -
;cc- .
}dd 
finallyee 
{ff 
}hh 
returnii 
nullii 
;ii 
}jj 
}kk 	
publicss 
voidss 
waitss 
(ss 
)tt 
{uu 	
tryvv 
{ww 
m_fCodeLockxx 
.xx 
waitxx  
(xx  !
)xx! "
;xx" #
}yy 
catchzz 
(zz 
	Exceptionzz 
exzz 
)zz  
{{{ 
FDebug|| 
.|| 
throwException|| %
(||% &
ex||& (
)||( )
;||) *
}}} 
finally~~ 
{ 
}
 
}
‚‚ 	
public
†† 
void
†† 
set
†† 
(
†† 
)
‡‡ 
{
ˆˆ 	
try
‰‰ 
{
ŠŠ 
m_fCodeLock
‹‹ 
.
‹‹ 
set
‹‹ 
(
‹‹  
)
‹‹  !
;
‹‹! "
}
ŒŒ 
catch
 
(
 
	Exception
 
ex
 
)
  
{
 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
‘‘ 
{
’’ 
}
”” 
}
•• 	
}
›› 
}œœ ²Ñ
ZD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Xml\c_FXmlDocument.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FXmlDocument 
: 
IDisposable  +
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FXmlCore 

m_fXmlCore #
=$ %
null& *
;* +
private 
XmlDocument 
m_xmlDoc $
=% &
null' +
;+ ,
public## 
FXmlDocument## 
(## 
)$$ 
{%% 	

m_fXmlCore&& 
=&& 
new&& 
FXmlCore&& %
(&&% &
this&&& *
)&&* +
;&&+ ,
m_xmlDoc'' 
='' 
new'' 
XmlDocument'' &
(''& '
)''' (
;''( )
}(( 	
internal,, 
FXmlDocument,, 
(,, 
XmlDocument-- 
xmlDoc-- 
).. 
{// 	

m_fXmlCore00 
=00 
new00 
FXmlCore00 %
(00% &
this00& *
)00* +
;00+ ,
m_xmlDoc11 
=11 
xmlDoc11 
;11 
}22 	
~66 	
FXmlDocument66	 
(66 
)77 
{88 	
	myDispose99 
(99 
false99 
)99 
;99 
}:: 	
	protected>> 
void>> 
	myDispose>>  
(>>  !
bool?? 
	disposing?? 
)@@ 
{AA 	
ifBB 
(BB 
!BB 

m_disposedBB 
)BB 
{CC 
ifDD 
(DD 
	disposingDD 
)DD 
{EE 
m_xmlDocFF 
=FF 
nullFF #
;FF# $
ifHH 
(HH 

m_fXmlCoreHH "
!=HH# %
nullHH& *
)HH* +
{II 

m_fXmlCoreJJ "
.JJ" #
DisposeJJ# *
(JJ* +
)JJ+ ,
;JJ, -

m_fXmlCoreKK "
=KK# $
nullKK% )
;KK) *
}LL 
}MM 

m_disposedNN 
=NN 
trueNN !
;NN! "
}OO 
}PP 	
publicXX 
voidXX 
DisposeXX 
(XX 
)YY 
{ZZ 	
	myDispose[[ 
([[ 
true[[ 
)[[ 
;[[ 
GC\\ 
.\\ 
SuppressFinalize\\ 
(\\  
this\\  $
)\\$ %
;\\% &
}]] 	
internalee 
XmlDocumentee 
baseXmlee $
{ff 	
getgg 
{hh 
tryii 
{jj 

m_fXmlCorekk 
.kk 
waitkk #
(kk# $
)kk$ %
;kk% &
returnll 
m_xmlDocll #
;ll# $
}mm 
catchnn 
(nn 
	Exceptionnn  
exnn! #
)nn# $
{oo 
FDebugpp 
.pp 
throwExceptionpp )
(pp) *
expp* ,
)pp, -
;pp- .
}qq 
finallyrr 
{ss 

m_fXmlCorett 
.tt 
settt "
(tt" #
)tt# $
;tt$ %
}uu 
returnvv 
nullvv 
;vv 
}ww 
}xx 	
public|| 
string|| 
name|| 
{}} 	
get~~ 
{ 
try
€€ 
{
 

m_fXmlCore
‚‚ 
.
‚‚ 
wait
‚‚ #
(
‚‚# $
)
‚‚$ %
;
‚‚% &
return
ƒƒ 
m_xmlDoc
ƒƒ #
.
ƒƒ# $
Name
ƒƒ$ (
;
ƒƒ( )
}
„„ 
catch
…… 
(
…… 
	Exception
……  
ex
……! #
)
……# $
{
†† 
FDebug
‡‡ 
.
‡‡ 
throwException
‡‡ )
(
‡‡) *
ex
‡‡* ,
)
‡‡, -
;
‡‡- .
}
ˆˆ 
finally
‰‰ 
{
ŠŠ 

m_fXmlCore
‹‹ 
.
‹‹ 
set
‹‹ "
(
‹‹" #
)
‹‹# $
;
‹‹$ %
}
ŒŒ 
return
 
string
 
.
 
Empty
 #
;
# $
}
 
}
 	
public
““ 
bool
““  
preserveWhiteSpace
““ &
{
”” 	
get
•• 
{
–– 
try
—— 
{
˜˜ 

m_fXmlCore
™™ 
.
™™ 
wait
™™ #
(
™™# $
)
™™$ %
;
™™% &
return
šš 
m_xmlDoc
šš #
.
šš# $ 
PreserveWhitespace
šš$ 6
;
šš6 7
}
›› 
catch
œœ 
(
œœ 
	Exception
œœ  
ex
œœ! #
)
œœ# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
ŸŸ 
finally
   
{
¡¡ 

m_fXmlCore
¢¢ 
.
¢¢ 
set
¢¢ "
(
¢¢" #
)
¢¢# $
;
¢¢$ %
}
££ 
return
¤¤ 
false
¤¤ 
;
¤¤ 
}
¥¥ 
set
§§ 
{
¨¨ 
try
©© 
{
ªª 

m_fXmlCore
«« 
.
«« 
wait
«« #
(
««# $
)
««$ %
;
««% &
m_xmlDoc
¬¬ 
.
¬¬  
PreserveWhitespace
¬¬ /
=
¬¬0 1
value
¬¬2 7
;
¬¬7 8
}
­­ 
catch
®® 
(
®® 
	Exception
®®  
ex
®®! #
)
®®# $
{
¯¯ 
FDebug
°° 
.
°° 
throwException
°° )
(
°°) *
ex
°°* ,
)
°°, -
;
°°- .
}
±± 
finally
²² 
{
³³ 

m_fXmlCore
´´ 
.
´´ 
set
´´ "
(
´´" #
)
´´# $
;
´´$ %
}
µµ 
}
¶¶ 
}
·· 	
public
»» %
FXmlAttributeCollection
»» &
fAttributes
»»' 2
{
¼¼ 	
get
½½ 
{
¾¾ 
try
¿¿ 
{
ÀÀ 

m_fXmlCore
ÁÁ 
.
ÁÁ 
wait
ÁÁ #
(
ÁÁ# $
)
ÁÁ$ %
;
ÁÁ% &
return
ÂÂ 
new
ÂÂ %
FXmlAttributeCollection
ÂÂ 6
(
ÂÂ6 7

m_fXmlCore
ÂÂ7 A
,
ÂÂA B
m_xmlDoc
ÂÂC K
.
ÂÂK L

Attributes
ÂÂL V
)
ÂÂV W
;
ÂÂW X
}
ÃÃ 
catch
ÄÄ 
(
ÄÄ 
	Exception
ÄÄ  
ex
ÄÄ! #
)
ÄÄ# $
{
ÅÅ 
FDebug
ÆÆ 
.
ÆÆ 
throwException
ÆÆ )
(
ÆÆ) *
ex
ÆÆ* ,
)
ÆÆ, -
;
ÆÆ- .
}
ÇÇ 
finally
ÈÈ 
{
ÉÉ 

m_fXmlCore
ÊÊ 
.
ÊÊ 
set
ÊÊ "
(
ÊÊ" #
)
ÊÊ# $
;
ÊÊ$ %
}
ËË 
return
ÌÌ 
null
ÌÌ 
;
ÌÌ 
}
ÍÍ 
}
ÎÎ 	
public
ÒÒ 
bool
ÒÒ 
hasChildNode
ÒÒ  
{
ÓÓ 	
get
ÔÔ 
{
ÕÕ 
try
ÖÖ 
{
×× 

m_fXmlCore
ØØ 
.
ØØ 
wait
ØØ #
(
ØØ# $
)
ØØ$ %
;
ØØ% &
return
ÙÙ 
m_xmlDoc
ÙÙ #
.
ÙÙ# $
HasChildNodes
ÙÙ$ 1
;
ÙÙ1 2
}
ÚÚ 
catch
ÛÛ 
(
ÛÛ 
	Exception
ÛÛ  
ex
ÛÛ! #
)
ÛÛ# $
{
ÜÜ 
FDebug
İİ 
.
İİ 
throwException
İİ )
(
İİ) *
ex
İİ* ,
)
İİ, -
;
İİ- .
}
ŞŞ 
finally
ßß 
{
àà 

m_fXmlCore
áá 
.
áá 
set
áá "
(
áá" #
)
áá# $
;
áá$ %
}
ââ 
return
ãã 
false
ãã 
;
ãã 
}
ää 
}
åå 	
public
éé 
FXmlNodeList
éé 
fChildNodes
éé '
{
êê 	
get
ëë 
{
ìì 
try
íí 
{
îî 

m_fXmlCore
ïï 
.
ïï 
wait
ïï #
(
ïï# $
)
ïï$ %
;
ïï% &
return
ğğ 
new
ğğ 
FXmlNodeList
ğğ +
(
ğğ+ ,

m_fXmlCore
ğğ, 6
,
ğğ6 7
m_xmlDoc
ğğ8 @
.
ğğ@ A

ChildNodes
ğğA K
)
ğğK L
;
ğğL M
}
ññ 
catch
òò 
(
òò 
	Exception
òò  
ex
òò! #
)
òò# $
{
óó 
FDebug
ôô 
.
ôô 
throwException
ôô )
(
ôô) *
ex
ôô* ,
)
ôô, -
;
ôô- .
}
õõ 
finally
öö 
{
÷÷ 

m_fXmlCore
øø 
.
øø 
set
øø "
(
øø" #
)
øø# $
;
øø$ %
}
ùù 
return
úú 
null
úú 
;
úú 
}
ûû 
}
üü 	
public
€€ 
FXmlNode
€€ 
fFirstChild
€€ #
{
 	
get
‚‚ 
{
ƒƒ 
try
„„ 
{
…… 

m_fXmlCore
†† 
.
†† 
wait
†† #
(
††# $
)
††$ %
;
††% &
if
‡‡ 
(
‡‡ 
m_xmlDoc
‡‡  
.
‡‡  !

FirstChild
‡‡! +
==
‡‡, .
null
‡‡/ 3
)
‡‡3 4
{
ˆˆ 
return
‰‰ 
null
‰‰ #
;
‰‰# $
}
ŠŠ 
return
‹‹ 
new
‹‹ 
FXmlNode
‹‹ '
(
‹‹' (

m_fXmlCore
‹‹( 2
,
‹‹2 3
m_xmlDoc
‹‹4 <
.
‹‹< =

FirstChild
‹‹= G
)
‹‹G H
;
‹‹H I
}
ŒŒ 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
‘‘ 
{
’’ 

m_fXmlCore
““ 
.
““ 
set
““ "
(
““" #
)
““# $
;
““$ %
}
”” 
return
•• 
null
•• 
;
•• 
}
–– 
}
—— 	
public
›› 
FXmlNode
›› 

fLastChild
›› "
{
œœ 	
get
 
{
 
try
ŸŸ 
{
   

m_fXmlCore
¡¡ 
.
¡¡ 
wait
¡¡ #
(
¡¡# $
)
¡¡$ %
;
¡¡% &
if
¢¢ 
(
¢¢ 
m_xmlDoc
¢¢  
.
¢¢  !
	LastChild
¢¢! *
==
¢¢+ -
null
¢¢. 2
)
¢¢2 3
{
££ 
return
¤¤ 
null
¤¤ #
;
¤¤# $
}
¥¥ 
return
¦¦ 
new
¦¦ 
FXmlNode
¦¦ '
(
¦¦' (

m_fXmlCore
¦¦( 2
,
¦¦2 3
m_xmlDoc
¦¦4 <
.
¦¦< =
	LastChild
¦¦= F
)
¦¦F G
;
¦¦G H
}
§§ 
catch
¨¨ 
(
¨¨ 
	Exception
¨¨  
ex
¨¨! #
)
¨¨# $
{
©© 
FDebug
ªª 
.
ªª 
throwException
ªª )
(
ªª) *
ex
ªª* ,
)
ªª, -
;
ªª- .
}
«« 
finally
¬¬ 
{
­­ 

m_fXmlCore
®® 
.
®® 
set
®® "
(
®®" #
)
®®# $
;
®®$ %
}
¯¯ 
return
°° 
null
°° 
;
°° 
}
±± 
}
²² 	
public
¶¶ 
string
¶¶ 
outerXml
¶¶ 
{
·· 	
get
¸¸ 
{
¹¹ 
try
ºº 
{
»» 

m_fXmlCore
¼¼ 
.
¼¼ 
wait
¼¼ #
(
¼¼# $
)
¼¼$ %
;
¼¼% &
return
½½ 
m_xmlDoc
½½ #
.
½½# $
OuterXml
½½$ ,
;
½½, -
}
¾¾ 
catch
¿¿ 
(
¿¿ 
	Exception
¿¿  
ex
¿¿! #
)
¿¿# $
{
ÀÀ 
FDebug
ÁÁ 
.
ÁÁ 
throwException
ÁÁ )
(
ÁÁ) *
ex
ÁÁ* ,
)
ÁÁ, -
;
ÁÁ- .
}
ÂÂ 
finally
ÃÃ 
{
ÄÄ 

m_fXmlCore
ÅÅ 
.
ÅÅ 
set
ÅÅ "
(
ÅÅ" #
)
ÅÅ# $
;
ÅÅ$ %
}
ÆÆ 
return
ÇÇ 
string
ÇÇ 
.
ÇÇ 
Empty
ÇÇ #
;
ÇÇ# $
}
ÈÈ 
}
ÉÉ 	
public
ÑÑ 
void
ÑÑ 
load
ÑÑ 
(
ÑÑ 
string
ÒÒ 
fileName
ÒÒ 
)
ÓÓ 
{
ÔÔ 	
try
ÕÕ 
{
ÖÖ 

m_fXmlCore
×× 
.
×× 
wait
×× 
(
××  
)
××  !
;
××! "
m_xmlDoc
ØØ 
.
ØØ 
Load
ØØ 
(
ØØ 
fileName
ØØ &
)
ØØ& '
;
ØØ' (
}
ÙÙ 
catch
ÚÚ 
(
ÚÚ 
	Exception
ÚÚ 
ex
ÚÚ 
)
ÚÚ  
{
ÛÛ 
FDebug
ÜÜ 
.
ÜÜ 
throwException
ÜÜ %
(
ÜÜ% &
ex
ÜÜ& (
)
ÜÜ( )
;
ÜÜ) *
}
İİ 
finally
ŞŞ 
{
ßß 

m_fXmlCore
àà 
.
àà 
set
àà 
(
àà 
)
àà  
;
àà  !
}
áá 
}
ââ 	
public
ææ 
void
ææ 
loadXml
ææ 
(
ææ 
string
çç 
xml
çç 
)
èè 
{
éé 	
try
êê 
{
ëë 

m_fXmlCore
ìì 
.
ìì 
wait
ìì 
(
ìì  
)
ìì  !
;
ìì! "
m_xmlDoc
íí 
.
íí 
LoadXml
íí  
(
íí  !
xml
íí! $
)
íí$ %
;
íí% &
}
îî 
catch
ïï 
(
ïï 
	Exception
ïï 
ex
ïï 
)
ïï  
{
ğğ 
FDebug
ññ 
.
ññ 
throwException
ññ %
(
ññ% &
ex
ññ& (
)
ññ( )
;
ññ) *
}
òò 
finally
óó 
{
ôô 

m_fXmlCore
õõ 
.
õõ 
set
õõ 
(
õõ 
)
õõ  
;
õõ  !
}
öö 
}
÷÷ 	
public
ûû 
void
ûû 
save
ûû 
(
ûû 
string
üü 
fileName
üü 
)
ıı 
{
şş 	
try
ÿÿ 
{
€€ 

m_fXmlCore
 
.
 
wait
 
(
  
)
  !
;
! "
m_xmlDoc
‚‚ 
.
‚‚ 
Save
‚‚ 
(
‚‚ 
fileName
‚‚ &
)
‚‚& '
;
‚‚' (
}
ƒƒ 
catch
„„ 
(
„„ 
	Exception
„„ 
ex
„„ 
)
„„  
{
…… 
FDebug
†† 
.
†† 
throwException
†† %
(
††% &
ex
††& (
)
††( )
;
††) *
}
‡‡ 
finally
ˆˆ 
{
‰‰ 

m_fXmlCore
ŠŠ 
.
ŠŠ 
set
ŠŠ 
(
ŠŠ 
)
ŠŠ  
;
ŠŠ  !
}
‹‹ 
}
ŒŒ 	
public
 
FXmlDocument
 
clone
 !
(
! "
bool
‘‘ 
deep
‘‘ 
)
’’ 
{
““ 	
try
”” 
{
•• 

m_fXmlCore
–– 
.
–– 
wait
–– 
(
––  
)
––  !
;
––! "
return
—— 
new
—— 
FXmlDocument
—— '
(
——' (
(
——( )
XmlDocument
——) 4
)
——4 5
m_xmlDoc
——5 =
.
——= >
	CloneNode
——> G
(
——G H
deep
——H L
)
——L M
)
——M N
;
——N O
}
˜˜ 
catch
™™ 
(
™™ 
	Exception
™™ 
ex
™™ 
)
™™  
{
šš 
FDebug
›› 
.
›› 
throwException
›› %
(
››% &
ex
››& (
)
››( )
;
››) *
}
œœ 
finally
 
{
 

m_fXmlCore
ŸŸ 
.
ŸŸ 
set
ŸŸ 
(
ŸŸ 
)
ŸŸ  
;
ŸŸ  !
}
¡¡ 
return
¢¢ 
null
¢¢ 
;
¢¢ 
}
££ 	
public
§§ 
FXmlNode
§§ "
createXmlDeclaration
§§ ,
(
§§, -
string
¨¨ 
version
¨¨ 
,
¨¨ 
string
©© 
encoding
©© 
,
©© 
string
ªª 

standalone
ªª 
)
«« 
{
¬¬ 	
try
­­ 
{
®® 

m_fXmlCore
¯¯ 
.
¯¯ 
wait
¯¯ 
(
¯¯  
)
¯¯  !
;
¯¯! "
return
°° 
new
°° 
FXmlNode
°° #
(
°°# $

m_fXmlCore
±± 
,
±± 
(
²² 
XmlNode
²² 
)
²² 
m_xmlDoc
²² %
.
²²% &"
CreateXmlDeclaration
²²& :
(
²²: ;
version
²²; B
,
²²B C
encoding
²²D L
,
²²L M

standalone
²²N X
)
²²X Y
)
³³ 
;
³³ 
}
´´ 
catch
µµ 
(
µµ 
	Exception
µµ 
ex
µµ 
)
µµ  
{
¶¶ 
FDebug
·· 
.
·· 
throwException
·· %
(
··% &
ex
··& (
)
··( )
;
··) *
}
¸¸ 
finally
¹¹ 
{
ºº 

m_fXmlCore
»» 
.
»» 
set
»» 
(
»» 
)
»»  
;
»»  !
}
¼¼ 
return
½½ 
null
½½ 
;
½½ 
}
¾¾ 	
public
ÂÂ 
FXmlNode
ÂÂ 

createNode
ÂÂ "
(
ÂÂ" #
string
ÃÃ 
name
ÃÃ 
)
ÄÄ 
{
ÅÅ 	
try
ÆÆ 
{
ÇÇ 

m_fXmlCore
ÈÈ 
.
ÈÈ 
wait
ÈÈ 
(
ÈÈ  
)
ÈÈ  !
;
ÈÈ! "
return
ÉÉ 
new
ÉÉ 
FXmlNode
ÉÉ #
(
ÉÉ# $

m_fXmlCore
ÊÊ 
,
ÊÊ 
m_xmlDoc
ËË 
.
ËË 

CreateNode
ËË '
(
ËË' (
XmlNodeType
ËË( 3
.
ËË3 4
Element
ËË4 ;
,
ËË; <
name
ËË= A
,
ËËA B
string
ËËC I
.
ËËI J
Empty
ËËJ O
)
ËËO P
)
ÌÌ 
;
ÌÌ 
}
ÍÍ 
catch
ÎÎ 
(
ÎÎ 
	Exception
ÎÎ 
ex
ÎÎ 
)
ÎÎ  
{
ÏÏ 
FDebug
ĞĞ 
.
ĞĞ 
throwException
ĞĞ %
(
ĞĞ% &
ex
ĞĞ& (
)
ĞĞ( )
;
ĞĞ) *
}
ÑÑ 
finally
ÒÒ 
{
ÓÓ 

m_fXmlCore
ÔÔ 
.
ÔÔ 
set
ÔÔ 
(
ÔÔ 
)
ÔÔ  
;
ÔÔ  !
}
ÕÕ 
return
ÖÖ 
null
ÖÖ 
;
ÖÖ 
}
×× 	
public
ÛÛ 
FXmlComment
ÛÛ 
createComment
ÛÛ (
(
ÛÛ( )
string
ÜÜ 
data
ÜÜ 
)
İİ 
{
ŞŞ 	
try
ßß 
{
àà 

m_fXmlCore
áá 
.
áá 
wait
áá 
(
áá  
)
áá  !
;
áá! "
return
ââ 
new
ââ 
FXmlComment
ââ &
(
ââ& '

m_fXmlCore
ãã 
,
ãã 
m_xmlDoc
ää 
.
ää 
CreateComment
ää *
(
ää* +
data
ää+ /
)
ää/ 0
)
åå 
;
åå 
}
ææ 
catch
çç 
(
çç 
	Exception
çç 
ex
çç 
)
çç  
{
èè 
FDebug
éé 
.
éé 
throwException
éé %
(
éé% &
ex
éé& (
)
éé( )
;
éé) *
}
êê 
finally
ëë 
{
ìì 

m_fXmlCore
íí 
.
íí 
set
íí 
(
íí 
)
íí  
;
íí  !
}
îî 
return
ïï 
null
ïï 
;
ïï 
}
ğğ 	
public
ôô 
FXmlAttribute
ôô 
createAttribute
ôô ,
(
ôô, -
string
õõ 
name
õõ 
)
öö 
{
÷÷ 	
try
øø 
{
ùù 

m_fXmlCore
úú 
.
úú 
wait
úú 
(
úú  
)
úú  !
;
úú! "
return
ûû 
new
ûû 
FXmlAttribute
ûû (
(
ûû( )

m_fXmlCore
ûû) 3
,
ûû3 4
m_xmlDoc
ûû5 =
.
ûû= >
CreateAttribute
ûû> M
(
ûûM N
name
ûûN R
)
ûûR S
)
ûûS T
;
ûûT U
}
üü 
catch
ıı 
(
ıı 
	Exception
ıı 
ex
ıı 
)
ıı  
{
şş 
FDebug
ÿÿ 
.
ÿÿ 
throwException
ÿÿ %
(
ÿÿ% &
ex
ÿÿ& (
)
ÿÿ( )
;
ÿÿ) *
}
€€ 
finally
 
{
‚‚ 

m_fXmlCore
ƒƒ 
.
ƒƒ 
set
ƒƒ 
(
ƒƒ 
)
ƒƒ  
;
ƒƒ  !
}
„„ 
return
…… 
null
…… 
;
…… 
}
†† 	
public
ŠŠ 
FXmlNode
ŠŠ 
appendChild
ŠŠ #
(
ŠŠ# $
FXmlNode
‹‹ 
newChild
‹‹ 
)
ŒŒ 
{
 	
XmlNode
 
xmlNode
 
=
 
null
 "
;
" #
try
 
{
‘‘ 

m_fXmlCore
’’ 
.
’’ 
wait
’’ 
(
’’  
)
’’  !
;
’’! "
if
““ 
(
““ 
m_xmlDoc
““ 
.
““ 
Equals
““ #
(
““# $
newChild
““$ ,
.
““, -
baseXml
““- 4
.
““4 5
OwnerDocument
““5 B
)
““B C
)
““C D
{
”” 
xmlNode
•• 
=
•• 
m_xmlDoc
•• &
.
••& '
AppendChild
••' 2
(
••2 3
newChild
••3 ;
.
••; <
baseXml
••< C
)
••C D
;
••D E
}
–– 
else
—— 
{
˜˜ 
xmlNode
™™ 
=
™™ 
m_xmlDoc
™™ &
.
™™& '
AppendChild
™™' 2
(
™™2 3
m_xmlDoc
™™3 ;
.
™™; <

ImportNode
™™< F
(
™™F G
newChild
™™G O
.
™™O P
baseXml
™™P W
,
™™W X
true
™™Y ]
)
™™] ^
)
™™^ _
;
™™_ `
}
šš 
return
›› 
new
›› 
FXmlNode
›› #
(
››# $

m_fXmlCore
››$ .
,
››. /
xmlNode
››0 7
)
››7 8
;
››8 9
}
œœ 
catch
 
(
 
	Exception
 
ex
 
)
  
{
 
FDebug
ŸŸ 
.
ŸŸ 
throwException
ŸŸ %
(
ŸŸ% &
ex
ŸŸ& (
)
ŸŸ( )
;
ŸŸ) *
}
   
finally
¡¡ 
{
¢¢ 

m_fXmlCore
££ 
.
££ 
set
££ 
(
££ 
)
££  
;
££  !
}
¤¤ 
return
¥¥ 
null
¥¥ 
;
¥¥ 
}
¦¦ 	
public
ªª 
FXmlNode
ªª 
insertBefore
ªª $
(
ªª$ %
FXmlNode
«« 
newChild
«« 
,
«« 
FXmlNode
¬¬ 
refChild
¬¬ 
)
­­ 
{
®® 	
XmlNode
¯¯ 
xmlNode
¯¯ 
=
¯¯ 
null
¯¯ "
;
¯¯" #
try
±± 
{
²² 

m_fXmlCore
³³ 
.
³³ 
wait
³³ 
(
³³  
)
³³  !
;
³³! "
if
´´ 
(
´´ 
m_xmlDoc
´´ 
.
´´ 
Equals
´´ #
(
´´# $
newChild
´´$ ,
.
´´, -
baseXml
´´- 4
.
´´4 5
OwnerDocument
´´5 B
)
´´B C
)
´´C D
{
µµ 
xmlNode
¶¶ 
=
¶¶ 
m_xmlDoc
¶¶ &
.
¶¶& '
InsertBefore
¶¶' 3
(
¶¶3 4
newChild
¶¶4 <
.
¶¶< =
baseXml
¶¶= D
,
¶¶D E
refChild
¶¶F N
.
¶¶N O
baseXml
¶¶O V
)
¶¶V W
;
¶¶W X
}
·· 
else
¸¸ 
{
¹¹ 
xmlNode
ºº 
=
ºº 
m_xmlDoc
ºº &
.
ºº& '
InsertBefore
ºº' 3
(
ºº3 4
m_xmlDoc
ºº4 <
.
ºº< =

ImportNode
ºº= G
(
ººG H
newChild
ººH P
.
ººP Q
baseXml
ººQ X
,
ººX Y
true
ººZ ^
)
ºº^ _
,
ºº_ `
refChild
ººa i
.
ººi j
baseXml
ººj q
)
ººq r
;
ººr s
}
»» 
return
¼¼ 
new
¼¼ 
FXmlNode
¼¼ #
(
¼¼# $

m_fXmlCore
¼¼$ .
,
¼¼. /
xmlNode
¼¼0 7
)
¼¼7 8
;
¼¼8 9
}
½½ 
catch
¾¾ 
(
¾¾ 

FException
¾¾ 
ex
¾¾  
)
¾¾  !
{
¿¿ 
FDebug
ÀÀ 
.
ÀÀ 
throwException
ÀÀ %
(
ÀÀ% &
ex
ÀÀ& (
)
ÀÀ( )
;
ÀÀ) *
}
ÁÁ 
finally
ÂÂ 
{
ÃÃ 

m_fXmlCore
ÄÄ 
.
ÄÄ 
set
ÄÄ 
(
ÄÄ 
)
ÄÄ  
;
ÄÄ  !
}
ÅÅ 
return
ÆÆ 
null
ÆÆ 
;
ÆÆ 
}
ÇÇ 	
public
ìì 
FXmlNode
ìì 
insertAfter
ìì #
(
ìì# $
FXmlNode
íí 
newChild
íí 
,
íí 
FXmlNode
îî 
refChild
îî 
)
ïï 
{
ğğ 	
XmlNode
ññ 
xmlNode
ññ 
=
ññ 
null
ññ "
;
ññ" #
try
óó 
{
ôô 

m_fXmlCore
õõ 
.
õõ 
wait
õõ 
(
õõ  
)
õõ  !
;
õõ! "
if
öö 
(
öö 
m_xmlDoc
öö 
.
öö 
Equals
öö #
(
öö# $
newChild
öö$ ,
.
öö, -
baseXml
öö- 4
.
öö4 5
OwnerDocument
öö5 B
)
ööB C
)
ööC D
{
÷÷ 
xmlNode
øø 
=
øø 
m_xmlDoc
øø &
.
øø& '
InsertAfter
øø' 2
(
øø2 3
newChild
øø3 ;
.
øø; <
baseXml
øø< C
,
øøC D
refChild
øøE M
.
øøM N
baseXml
øøN U
)
øøU V
;
øøV W
}
ùù 
else
úú 
{
ûû 
xmlNode
üü 
=
üü 
m_xmlDoc
üü &
.
üü& '
InsertAfter
üü' 2
(
üü2 3
m_xmlDoc
üü3 ;
.
üü; <

ImportNode
üü< F
(
üüF G
newChild
üüG O
.
üüO P
baseXml
üüP W
,
üüW X
true
üüY ]
)
üü] ^
,
üü^ _
refChild
üü` h
.
üüh i
baseXml
üüi p
)
üüp q
;
üüq r
}
ıı 
return
şş 
new
şş 
FXmlNode
şş #
(
şş# $

m_fXmlCore
şş$ .
,
şş. /
xmlNode
şş0 7
)
şş7 8
;
şş8 9
}
ÿÿ 
catch
€€ 
(
€€ 

FException
€€ 
ex
€€  
)
€€  !
{
 
FDebug
‚‚ 
.
‚‚ 
throwException
‚‚ %
(
‚‚% &
ex
‚‚& (
)
‚‚( )
;
‚‚) *
}
ƒƒ 
finally
„„ 
{
…… 

m_fXmlCore
†† 
.
†† 
set
†† 
(
†† 
)
††  
;
††  !
}
‡‡ 
return
ˆˆ 
null
ˆˆ 
;
ˆˆ 
}
‰‰ 	
public
 
FXmlNode
 
insertAfter
 #
(
# $
FXmlComment
 
newChild
  
,
  !
FXmlNode
 
refChild
 
)
 
{
‘‘ 	
XmlNode
’’ 
xmlNode
’’ 
=
’’ 
null
’’ "
;
’’" #
try
”” 
{
•• 

m_fXmlCore
–– 
.
–– 
wait
–– 
(
––  
)
––  !
;
––! "
if
—— 
(
—— 
m_xmlDoc
—— 
.
—— 
Equals
—— #
(
——# $
newChild
——$ ,
.
——, -
baseXml
——- 4
.
——4 5
OwnerDocument
——5 B
)
——B C
)
——C D
{
˜˜ 
xmlNode
™™ 
=
™™ 
m_xmlDoc
™™ &
.
™™& '
InsertAfter
™™' 2
(
™™2 3
newChild
™™3 ;
.
™™; <
baseXml
™™< C
,
™™C D
refChild
™™E M
.
™™M N
baseXml
™™N U
)
™™U V
;
™™V W
}
šš 
else
›› 
{
œœ 
xmlNode
 
=
 
m_xmlDoc
 &
.
& '
InsertAfter
' 2
(
2 3
m_xmlDoc
3 ;
.
; <

ImportNode
< F
(
F G
newChild
G O
.
O P
baseXml
P W
,
W X
true
Y ]
)
] ^
,
^ _
refChild
` h
.
h i
baseXml
i p
)
p q
;
q r
}
 
return
ŸŸ 
new
ŸŸ 
FXmlNode
ŸŸ #
(
ŸŸ# $

m_fXmlCore
ŸŸ$ .
,
ŸŸ. /
xmlNode
ŸŸ0 7
)
ŸŸ7 8
;
ŸŸ8 9
}
   
catch
¡¡ 
(
¡¡ 

FException
¡¡ 
ex
¡¡  
)
¡¡  !
{
¢¢ 
FDebug
££ 
.
££ 
throwException
££ %
(
££% &
ex
££& (
)
££( )
;
££) *
}
¤¤ 
finally
¥¥ 
{
¦¦ 

m_fXmlCore
§§ 
.
§§ 
set
§§ 
(
§§ 
)
§§  
;
§§  !
}
¨¨ 
return
©© 
null
©© 
;
©© 
}
ªª 	
public
®® 
FXmlNode
®® 
removeChild
®® #
(
®®# $
FXmlNode
¯¯ 
oldChild
¯¯ 
)
°° 
{
±± 	
XmlNode
²² 
xmlNode
²² 
=
²² 
null
²² "
;
²²" #
try
´´ 
{
µµ 

m_fXmlCore
¶¶ 
.
¶¶ 
wait
¶¶ 
(
¶¶  
)
¶¶  !
;
¶¶! "
xmlNode
·· 
=
·· 
m_xmlDoc
·· "
.
··" #
RemoveChild
··# .
(
··. /
oldChild
··/ 7
.
··7 8
baseXml
··8 ?
)
··? @
;
··@ A
return
¸¸ 
new
¸¸ 
FXmlNode
¸¸ #
(
¸¸# $

m_fXmlCore
¸¸$ .
,
¸¸. /
xmlNode
¸¸0 7
)
¸¸7 8
;
¸¸8 9
}
¹¹ 
catch
ºº 
(
ºº 
	Exception
ºº 
ex
ºº 
)
ºº  
{
»» 
FDebug
¼¼ 
.
¼¼ 
throwException
¼¼ %
(
¼¼% &
ex
¼¼& (
)
¼¼( )
;
¼¼) *
}
½½ 
finally
¾¾ 
{
¿¿ 

m_fXmlCore
ÀÀ 
.
ÀÀ 
set
ÀÀ 
(
ÀÀ 
)
ÀÀ  
;
ÀÀ  !
}
ÁÁ 
return
ÂÂ 
null
ÂÂ 
;
ÂÂ 
}
ÃÃ 	
public
ÇÇ 
void
ÇÇ 
	removeAll
ÇÇ 
(
ÇÇ 
)
ÈÈ 
{
ÉÉ 	
try
ÊÊ 
{
ËË 

m_fXmlCore
ÌÌ 
.
ÌÌ 
wait
ÌÌ 
(
ÌÌ  
)
ÌÌ  !
;
ÌÌ! "
m_xmlDoc
ÍÍ 
.
ÍÍ 
	RemoveAll
ÍÍ "
(
ÍÍ" #
)
ÍÍ# $
;
ÍÍ$ %
}
ÎÎ 
catch
ÏÏ 
(
ÏÏ 
	Exception
ÏÏ 
ex
ÏÏ 
)
ÏÏ  
{
ĞĞ 
FDebug
ÑÑ 
.
ÑÑ 
throwException
ÑÑ %
(
ÑÑ% &
ex
ÑÑ& (
)
ÑÑ( )
;
ÑÑ) *
}
ÒÒ 
finally
ÓÓ 
{
ÔÔ 

m_fXmlCore
ÕÕ 
.
ÕÕ 
set
ÕÕ 
(
ÕÕ 
)
ÕÕ  
;
ÕÕ  !
}
ÖÖ 
}
×× 	
public
ÛÛ 
FXmlNode
ÛÛ 
selectSingleNode
ÛÛ (
(
ÛÛ( )
string
ÜÜ 
xpath
ÜÜ 
)
İİ 
{
ŞŞ 	
XmlNode
ßß 
xmlNode
ßß 
=
ßß 
null
ßß "
;
ßß" #
try
áá 
{
ââ 

m_fXmlCore
ãã 
.
ãã 
wait
ãã 
(
ãã  
)
ãã  !
;
ãã! "
xmlNode
ää 
=
ää 
m_xmlDoc
ää "
.
ää" #
SelectSingleNode
ää# 3
(
ää3 4
xpath
ää4 9
)
ää9 :
;
ää: ;
if
åå 
(
åå 
xmlNode
åå 
==
åå 
null
åå #
)
åå# $
{
ææ 
return
çç 
null
çç 
;
çç  
}
èè 
return
éé 
new
éé 
FXmlNode
éé #
(
éé# $

m_fXmlCore
éé$ .
,
éé. /
xmlNode
éé0 7
)
éé7 8
;
éé8 9
}
êê 
catch
ëë 
(
ëë 
	Exception
ëë 
ex
ëë 
)
ëë  
{
ìì 
FDebug
íí 
.
íí 
throwException
íí %
(
íí% &
ex
íí& (
)
íí( )
;
íí) *
}
îî 
finally
ïï 
{
ğğ 

m_fXmlCore
ññ 
.
ññ 
set
ññ 
(
ññ 
)
ññ  
;
ññ  !
}
òò 
return
óó 
null
óó 
;
óó 
}
ôô 	
public
øø 
FXmlNodeList
øø 
selectNodes
øø '
(
øø' (
string
ùù 
xpath
ùù 
)
úú 
{
ûû 	
try
üü 
{
ıı 

m_fXmlCore
şş 
.
şş 
wait
şş 
(
şş  
)
şş  !
;
şş! "
return
ÿÿ 
new
ÿÿ 
FXmlNodeList
ÿÿ '
(
ÿÿ' (

m_fXmlCore
ÿÿ( 2
,
ÿÿ2 3
m_xmlDoc
ÿÿ4 <
.
ÿÿ< =
SelectNodes
ÿÿ= H
(
ÿÿH I
xpath
ÿÿI N
)
ÿÿN O
)
ÿÿO P
;
ÿÿP Q
}
€€ 
catch
 
(
 
	Exception
 
ex
 
)
  
{
‚‚ 
FDebug
ƒƒ 
.
ƒƒ 
throwException
ƒƒ %
(
ƒƒ% &
ex
ƒƒ& (
)
ƒƒ( )
;
ƒƒ) *
}
„„ 
finally
…… 
{
†† 

m_fXmlCore
‡‡ 
.
‡‡ 
set
‡‡ 
(
‡‡ 
)
‡‡  
;
‡‡  !
}
ˆˆ 
return
‰‰ 
null
‰‰ 
;
‰‰ 
}
ŠŠ 	
public
 
string
 
xmlToString
 !
(
! "
bool
  
preserveWhiteSpace
 #
)
 
{
‘‘ 	
	XmlWriter
’’ 
	xmlWriter
’’ 
=
’’  !
null
’’" &
;
’’& '
XmlWriterSettings
““ 
settings
““ &
=
““' (
null
““) -
;
““- .
StringBuilder
”” 
stringBuilder
”” '
=
””( )
null
””* .
;
””. /
try
–– 
{
—— 

m_fXmlCore
˜˜ 
.
˜˜ 
wait
˜˜ 
(
˜˜  
)
˜˜  !
;
˜˜! "
if
šš 
(
šš 
!
šš  
preserveWhiteSpace
šš '
)
šš' (
{
›› 
return
œœ 
this
œœ 
.
œœ  
outerXml
œœ  (
;
œœ( )
}
 
settings
ŸŸ 
=
ŸŸ 
new
ŸŸ 
XmlWriterSettings
ŸŸ 0
(
ŸŸ0 1
)
ŸŸ1 2
;
ŸŸ2 3
settings
   
.
   
Indent
   
=
    !
true
  " &
;
  & '
settings
¡¡ 
.
¡¡ 
IndentChars
¡¡ $
=
¡¡% &
$str
¡¡' +
;
¡¡+ ,
settings
¢¢ 
.
¢¢ 
NewLineHandling
¢¢ (
=
¢¢) *
NewLineHandling
¢¢+ :
.
¢¢: ;
Replace
¢¢; B
;
¢¢B C
settings
££ 
.
££ 
CheckCharacters
££ (
=
££) *
false
££+ 0
;
££0 1
stringBuilder
¥¥ 
=
¥¥ 
new
¥¥  #
StringBuilder
¥¥$ 1
(
¥¥1 2
)
¥¥2 3
;
¥¥3 4
	xmlWriter
¦¦ 
=
¦¦ 
	XmlWriter
¦¦ %
.
¦¦% &
Create
¦¦& ,
(
¦¦, -
stringBuilder
¦¦- :
,
¦¦: ;
settings
¦¦< D
)
¦¦D E
;
¦¦E F
m_xmlDoc
¨¨ 
.
¨¨ 
Save
¨¨ 
(
¨¨ 
	xmlWriter
¨¨ '
)
¨¨' (
;
¨¨( )
return
¬¬ 
stringBuilder
¬¬ $
.
¬¬$ %
ToString
¬¬% -
(
¬¬- .
)
¬¬. /
;
¬¬/ 0
}
­­ 
catch
®® 
(
®® 
	Exception
®® 
ex
®® 
)
®®  
{
¯¯ 
FDebug
°° 
.
°° 
throwException
°° %
(
°°% &
ex
°°& (
)
°°( )
;
°°) *
}
±± 
finally
²² 
{
³³ 

m_fXmlCore
´´ 
.
´´ 
set
´´ 
(
´´ 
)
´´  
;
´´  !
}
µµ 
return
¶¶ 
string
¶¶ 
.
¶¶ 
Empty
¶¶ 
;
¶¶  
}
·· 	
public
¿¿ 
override
¿¿ 
int
¿¿ 
GetHashCode
¿¿ '
(
¿¿' (
)
ÀÀ 
{
ÁÁ 	
try
ÂÂ 
{
ÃÃ 
return
ÄÄ 
base
ÄÄ 
.
ÄÄ 
GetHashCode
ÄÄ '
(
ÄÄ' (
)
ÄÄ( )
;
ÄÄ) *
}
ÅÅ 
catch
ÆÆ 
(
ÆÆ 
	Exception
ÆÆ 
ex
ÆÆ 
)
ÆÆ  
{
ÇÇ 
FDebug
ÈÈ 
.
ÈÈ 
throwException
ÈÈ %
(
ÈÈ% &
ex
ÈÈ& (
)
ÈÈ( )
;
ÈÈ) *
}
ÉÉ 
finally
ÊÊ 
{
ËË 
}
ÍÍ 
return
ÎÎ 
$num
ÎÎ 
;
ÎÎ 
}
ÏÏ 	
public
ÓÓ 
override
ÓÓ 
bool
ÓÓ 
Equals
ÓÓ #
(
ÓÓ# $
object
ÔÔ 
obj
ÔÔ 
)
ÕÕ 
{
ÖÖ 	
try
×× 
{
ØØ 
if
ÙÙ 
(
ÙÙ 
obj
ÙÙ 
==
ÙÙ 
null
ÙÙ 
||
ÙÙ  "
!
ÙÙ# $
(
ÙÙ$ %
obj
ÙÙ% (
is
ÙÙ) +
FXmlDocument
ÙÙ, 8
)
ÙÙ8 9
)
ÙÙ9 :
{
ÚÚ 
return
ÛÛ 
false
ÛÛ  
;
ÛÛ  !
}
ÜÜ 
return
ŞŞ 
m_xmlDoc
ŞŞ 
.
ŞŞ  
Equals
ŞŞ  &
(
ŞŞ& '
(
ßß 
(
ßß 
FXmlDocument
ßß "
)
ßß" #
obj
ßß# &
)
ßß& '
.
ßß' (
baseXml
ßß( /
)
àà 
;
àà 
}
áá 
catch
ââ 
(
ââ 
	Exception
ââ 
ex
ââ 
)
ââ  
{
ãã 
FDebug
ää 
.
ää 
throwException
ää %
(
ää% &
ex
ää& (
)
ää( )
;
ää) *
}
åå 
finally
ææ 
{
çç 
}
éé 
return
êê 
false
êê 
;
êê 
}
ëë 	
public
ïï 
static
ïï 
bool
ïï 
operator
ïï #
==
ïï$ &
(
ïï& '
FXmlDocument
ğğ 
lhs
ğğ 
,
ğğ 
FXmlDocument
ññ 
rhs
ññ 
)
òò 
{
óó 	
try
ôô 
{
õõ 
if
öö 
(
öö 
(
öö 
object
öö 
)
öö 
lhs
öö 
==
öö  "
null
öö# '
)
öö' (
{
÷÷ 
return
øø 
(
øø 
(
øø 
object
øø #
)
øø# $
rhs
øø$ '
==
øø( *
null
øø+ /
?
øø0 1
true
øø2 6
:
øø7 8
false
øø9 >
)
øø> ?
;
øø? @
}
ùù 
return
úú 
lhs
úú 
.
úú 
Equals
úú !
(
úú! "
rhs
úú" %
)
úú% &
;
úú& '
}
ûû 
catch
üü 
(
üü 
	Exception
üü 
ex
üü 
)
üü  
{
ıı 
FDebug
şş 
.
şş 
throwException
şş %
(
şş% &
ex
şş& (
)
şş( )
;
şş) *
}
ÿÿ 
finally
€€ 
{
 
}
ƒƒ 
return
„„ 
false
„„ 
;
„„ 
}
…… 	
public
‰‰ 
static
‰‰ 
bool
‰‰ 
operator
‰‰ #
!=
‰‰$ &
(
‰‰& '
FXmlDocument
ŠŠ 
lhs
ŠŠ 
,
ŠŠ 
FXmlDocument
‹‹ 
rhs
‹‹ 
)
ŒŒ 
{
 	
try
 
{
 
if
 
(
 
(
 
object
 
)
 
lhs
 
==
  "
null
# '
)
' (
{
‘‘ 
return
’’ 
(
’’ 
(
’’ 
object
’’ #
)
’’# $
rhs
’’$ '
==
’’( *
null
’’+ /
?
’’0 1
false
’’2 7
:
’’8 9
true
’’: >
)
’’> ?
;
’’? @
}
““ 
return
”” 
!
”” 
lhs
”” 
.
”” 
Equals
”” "
(
””" #
rhs
””# &
)
””& '
;
””' (
}
•• 
catch
–– 
(
–– 
	Exception
–– 
ex
–– 
)
––  
{
—— 
FDebug
˜˜ 
.
˜˜ 
throwException
˜˜ %
(
˜˜% &
ex
˜˜& (
)
˜˜( )
;
˜˜) *
}
™™ 
finally
šš 
{
›› 
}
 
return
 
false
 
;
 
}
ŸŸ 	
}
¥¥ 
}¦¦ ³ú
VD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Xml\c_FXmlNode.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FXmlNode 
: 
IDisposable '
{ 
public 
event (
FXmlNodeModifiedEventHandler 1
XmlNodeModified2 A
=B C
nullD H
;H I
private!! 
const!! 
string!! 
A_Value!! $
=!!% &
$str!!' *
;!!* +
private## 
bool## 

m_disposed## 
=##  !
false##" '
;##' (
private%% 
FXmlCore%% 

m_fXmlCore%% #
=%%$ %
null%%& *
;%%* +
private&& 
XmlNode&& 
	m_xmlNode&& !
=&&" #
null&&$ (
;&&( )
internal,, 
FXmlNode,, 
(,, 
FXmlCore-- 
fXmlCore-- 
,-- 
XmlNode.. 
xmlNode.. 
)// 
{00 	

m_fXmlCore11 
=11 
fXmlCore11 !
;11! "
	m_xmlNode22 
=22 
xmlNode22 
;22  
}33 	
~77 	
FXmlNode77	 
(77 
)88 
{99 	
	myDispose:: 
(:: 
false:: 
):: 
;:: 
};; 	
	protected?? 
void?? 
	myDispose??  
(??  !
bool@@ 
	disposing@@ 
)AA 
{BB 	
ifCC 
(CC 
!CC 

m_disposedCC 
)CC 
{DD 
ifEE 
(EE 
	disposingEE 
)EE 
{FF 
	m_xmlNodeGG 
=GG 
nullGG  $
;GG$ %
}HH 

m_disposedJJ 
=JJ 
trueJJ !
;JJ! "
}KK 
}LL 	
publicTT 
voidTT 
DisposeTT 
(TT 
)UU 
{VV 	
	myDisposeWW 
(WW 
trueWW 
)WW 
;WW 
GCXX 
.XX 
SuppressFinalizeXX 
(XX  
thisXX  $
)XX$ %
;XX% &
}YY 	
internalaa 
XmlNodeaa 
baseXmlaa  
{bb 	
getcc 
{dd 
tryee 
{ff 

m_fXmlCoregg 
.gg 
waitgg #
(gg# $
)gg$ %
;gg% &
returnhh 
	m_xmlNodehh $
;hh$ %
}ii 
catchjj 
(jj 
	Exceptionjj  
exjj! #
)jj# $
{kk 
FDebugll 
.ll 
throwExceptionll )
(ll) *
exll* ,
)ll, -
;ll- .
}mm 
finallynn 
{oo 

m_fXmlCorepp 
.pp 
setpp "
(pp" #
)pp# $
;pp$ %
}qq 
returnrr 
nullrr 
;rr 
}ss 
}tt 	
publicxx 
stringxx 
namexx 
{yy 	
getzz 
{{{ 
try|| 
{}} 

m_fXmlCore~~ 
.~~ 
wait~~ #
(~~# $
)~~$ %
;~~% &
return 
	m_xmlNode $
.$ %
Name% )
;) *
}
€€ 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
‚‚ 
FDebug
ƒƒ 
.
ƒƒ 
throwException
ƒƒ )
(
ƒƒ) *
ex
ƒƒ* ,
)
ƒƒ, -
;
ƒƒ- .
}
„„ 
finally
…… 
{
†† 

m_fXmlCore
‡‡ 
.
‡‡ 
set
‡‡ "
(
‡‡" #
)
‡‡# $
;
‡‡$ %
}
ˆˆ 
return
‰‰ 
string
‰‰ 
.
‰‰ 
Empty
‰‰ #
;
‰‰# $
}
ŠŠ 
}
‹‹ 	
public
 
string
 
value
 
{
 	
get
‘‘ 
{
’’ 
try
““ 
{
”” 

m_fXmlCore
•• 
.
•• 
wait
•• #
(
••# $
)
••$ %
;
••% &
return
–– 
	m_xmlNode
–– $
.
––$ %
Value
––% *
;
––* +
}
—— 
catch
˜˜ 
(
˜˜ 
	Exception
˜˜  
ex
˜˜! #
)
˜˜# $
{
™™ 
FDebug
šš 
.
šš 
throwException
šš )
(
šš) *
ex
šš* ,
)
šš, -
;
šš- .
}
›› 
finally
œœ 
{
 

m_fXmlCore
 
.
 
set
 "
(
" #
)
# $
;
$ %
}
ŸŸ 
return
   
string
   
.
   
Empty
   #
;
  # $
}
¡¡ 
set
££ 
{
¤¤ 
try
¥¥ 
{
¦¦ 

m_fXmlCore
§§ 
.
§§ 
wait
§§ #
(
§§# $
)
§§$ %
;
§§% &
	m_xmlNode
¨¨ 
.
¨¨ 
Value
¨¨ #
=
¨¨$ %
value
¨¨& +
;
¨¨+ ,
}
©© 
catch
ªª 
(
ªª 
	Exception
ªª  
ex
ªª! #
)
ªª# $
{
«« 
FDebug
¬¬ 
.
¬¬ 
throwException
¬¬ )
(
¬¬) *
ex
¬¬* ,
)
¬¬, -
;
¬¬- .
}
­­ 
finally
®® 
{
¯¯ 

m_fXmlCore
°° 
.
°° 
set
°° "
(
°°" #
)
°°# $
;
°°$ %
}
±± 
}
²² 
}
³³ 	
public
·· 
FXmlDocument
·· 
fOwnerDocument
·· *
{
¸¸ 	
get
¹¹ 
{
ºº 
try
»» 
{
¼¼ 

m_fXmlCore
½½ 
.
½½ 
wait
½½ #
(
½½# $
)
½½$ %
;
½½% &
return
¾¾ 

m_fXmlCore
¾¾ %
.
¾¾% &
xmlDocument
¾¾& 1
;
¾¾1 2
}
¿¿ 
catch
ÀÀ 
(
ÀÀ 
	Exception
ÀÀ  
ex
ÀÀ! #
)
ÀÀ# $
{
ÁÁ 
FDebug
ÂÂ 
.
ÂÂ 
throwException
ÂÂ )
(
ÂÂ) *
ex
ÂÂ* ,
)
ÂÂ, -
;
ÂÂ- .
}
ÃÃ 
finally
ÄÄ 
{
ÅÅ 

m_fXmlCore
ÆÆ 
.
ÆÆ 
set
ÆÆ "
(
ÆÆ" #
)
ÆÆ# $
;
ÆÆ$ %
}
ÇÇ 
return
ÈÈ 
null
ÈÈ 
;
ÈÈ 
}
ÉÉ 
}
ÊÊ 	
public
ÎÎ 
FXmlNode
ÎÎ 
fParentNode
ÎÎ #
{
ÏÏ 	
get
ĞĞ 
{
ÑÑ 
try
ÒÒ 
{
ÓÓ 

m_fXmlCore
ÔÔ 
.
ÔÔ 
wait
ÔÔ #
(
ÔÔ# $
)
ÔÔ$ %
;
ÔÔ% &
if
ÕÕ 
(
ÕÕ 
	m_xmlNode
ÕÕ !
.
ÕÕ! "

ParentNode
ÕÕ" ,
==
ÕÕ- /
null
ÕÕ0 4
)
ÕÕ4 5
{
ÖÖ 
return
×× 
null
×× #
;
××# $
}
ØØ 
return
ÙÙ 
new
ÙÙ 
FXmlNode
ÙÙ '
(
ÙÙ' (

m_fXmlCore
ÙÙ( 2
,
ÙÙ2 3
	m_xmlNode
ÙÙ4 =
.
ÙÙ= >

ParentNode
ÙÙ> H
)
ÙÙH I
;
ÙÙI J
}
ÚÚ 
catch
ÛÛ 
(
ÛÛ 
	Exception
ÛÛ  
ex
ÛÛ! #
)
ÛÛ# $
{
ÜÜ 
FDebug
İİ 
.
İİ 
throwException
İİ )
(
İİ) *
ex
İİ* ,
)
İİ, -
;
İİ- .
}
ŞŞ 
finally
ßß 
{
àà 

m_fXmlCore
áá 
.
áá 
set
áá "
(
áá" #
)
áá# $
;
áá$ %
}
ââ 
return
ãã 
null
ãã 
;
ãã 
}
ää 
}
åå 	
public
éé 
FXmlNode
éé 
fPreviousSibling
éé (
{
êê 	
get
ëë 
{
ìì 
try
íí 
{
îî 

m_fXmlCore
ïï 
.
ïï 
wait
ïï #
(
ïï# $
)
ïï$ %
;
ïï% &
if
ğğ 
(
ğğ 
	m_xmlNode
ğğ !
.
ğğ! "
PreviousSibling
ğğ" 1
==
ğğ2 4
null
ğğ5 9
)
ğğ9 :
{
ññ 
return
òò 
null
òò #
;
òò# $
}
óó 
return
ôô 
new
ôô 
FXmlNode
ôô '
(
ôô' (

m_fXmlCore
ôô( 2
,
ôô2 3
	m_xmlNode
ôô4 =
.
ôô= >
PreviousSibling
ôô> M
)
ôôM N
;
ôôN O
}
õõ 
catch
öö 
(
öö 
	Exception
öö  
ex
öö! #
)
öö# $
{
÷÷ 
FDebug
øø 
.
øø 
throwException
øø )
(
øø) *
ex
øø* ,
)
øø, -
;
øø- .
}
ùù 
finally
úú 
{
ûû 

m_fXmlCore
üü 
.
üü 
set
üü "
(
üü" #
)
üü# $
;
üü$ %
}
ıı 
return
şş 
null
şş 
;
şş 
}
ÿÿ 
}
€€ 	
public
„„ 
FXmlNode
„„ 
fNextSibling
„„ $
{
…… 	
get
†† 
{
‡‡ 
try
ˆˆ 
{
‰‰ 

m_fXmlCore
ŠŠ 
.
ŠŠ 
wait
ŠŠ #
(
ŠŠ# $
)
ŠŠ$ %
;
ŠŠ% &
if
‹‹ 
(
‹‹ 
	m_xmlNode
‹‹ !
.
‹‹! "
NextSibling
‹‹" -
==
‹‹. 0
null
‹‹1 5
)
‹‹5 6
{
ŒŒ 
return
 
null
 #
;
# $
}
 
return
 
new
 
FXmlNode
 '
(
' (

m_fXmlCore
( 2
,
2 3
	m_xmlNode
4 =
.
= >
NextSibling
> I
)
I J
;
J K
}
 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘  
ex
‘‘! #
)
‘‘# $
{
’’ 
FDebug
““ 
.
““ 
throwException
““ )
(
““) *
ex
““* ,
)
““, -
;
““- .
}
”” 
finally
•• 
{
–– 

m_fXmlCore
—— 
.
—— 
set
—— "
(
——" #
)
——# $
;
——$ %
}
˜˜ 
return
™™ 
null
™™ 
;
™™ 
}
šš 
}
›› 	
public
ŸŸ %
FXmlAttributeCollection
ŸŸ &
fAttributes
ŸŸ' 2
{
   	
get
¡¡ 
{
¢¢ 
try
££ 
{
¤¤ 

m_fXmlCore
¥¥ 
.
¥¥ 
wait
¥¥ #
(
¥¥# $
)
¥¥$ %
;
¥¥% &
return
¦¦ 
new
¦¦ %
FXmlAttributeCollection
¦¦ 6
(
¦¦6 7

m_fXmlCore
¦¦7 A
,
¦¦A B
	m_xmlNode
¦¦C L
.
¦¦L M

Attributes
¦¦M W
)
¦¦W X
;
¦¦X Y
}
§§ 
catch
¨¨ 
(
¨¨ 
	Exception
¨¨  
ex
¨¨! #
)
¨¨# $
{
©© 
FDebug
ªª 
.
ªª 
throwException
ªª )
(
ªª) *
ex
ªª* ,
)
ªª, -
;
ªª- .
}
«« 
finally
¬¬ 
{
­­ 

m_fXmlCore
®® 
.
®® 
set
®® "
(
®®" #
)
®®# $
;
®®$ %
}
¯¯ 
return
°° 
null
°° 
;
°° 
}
±± 
}
²² 	
public
¶¶ 
bool
¶¶ 
hasChildNode
¶¶  
{
·· 	
get
¸¸ 
{
¹¹ 
try
ºº 
{
»» 

m_fXmlCore
¼¼ 
.
¼¼ 
wait
¼¼ #
(
¼¼# $
)
¼¼$ %
;
¼¼% &
return
½½ 
	m_xmlNode
½½ $
.
½½$ %
HasChildNodes
½½% 2
;
½½2 3
}
¾¾ 
catch
¿¿ 
(
¿¿ 
	Exception
¿¿  
ex
¿¿! #
)
¿¿# $
{
ÀÀ 
FDebug
ÁÁ 
.
ÁÁ 
throwException
ÁÁ )
(
ÁÁ) *
ex
ÁÁ* ,
)
ÁÁ, -
;
ÁÁ- .
}
ÂÂ 
finally
ÃÃ 
{
ÄÄ 

m_fXmlCore
ÅÅ 
.
ÅÅ 
set
ÅÅ "
(
ÅÅ" #
)
ÅÅ# $
;
ÅÅ$ %
}
ÆÆ 
return
ÇÇ 
false
ÇÇ 
;
ÇÇ 
}
ÈÈ 
}
ÉÉ 	
public
ÍÍ 
FXmlNodeList
ÍÍ 
fChildNodes
ÍÍ '
{
ÎÎ 	
get
ÏÏ 
{
ĞĞ 
try
ÑÑ 
{
ÒÒ 

m_fXmlCore
ÓÓ 
.
ÓÓ 
wait
ÓÓ #
(
ÓÓ# $
)
ÓÓ$ %
;
ÓÓ% &
return
ÔÔ 
new
ÔÔ 
FXmlNodeList
ÔÔ +
(
ÔÔ+ ,

m_fXmlCore
ÔÔ, 6
,
ÔÔ6 7
	m_xmlNode
ÔÔ8 A
.
ÔÔA B

ChildNodes
ÔÔB L
)
ÔÔL M
;
ÔÔM N
}
ÕÕ 
catch
ÖÖ 
(
ÖÖ 
	Exception
ÖÖ  
ex
ÖÖ! #
)
ÖÖ# $
{
×× 
FDebug
ØØ 
.
ØØ 
throwException
ØØ )
(
ØØ) *
ex
ØØ* ,
)
ØØ, -
;
ØØ- .
}
ÙÙ 
finally
ÚÚ 
{
ÛÛ 

m_fXmlCore
ÜÜ 
.
ÜÜ 
set
ÜÜ "
(
ÜÜ" #
)
ÜÜ# $
;
ÜÜ$ %
}
İİ 
return
ŞŞ 
null
ŞŞ 
;
ŞŞ 
}
ßß 
}
àà 	
public
ää 
FXmlNode
ää 
fFirstChild
ää #
{
åå 	
get
ææ 
{
çç 
try
èè 
{
éé 

m_fXmlCore
êê 
.
êê 
wait
êê #
(
êê# $
)
êê$ %
;
êê% &
if
ëë 
(
ëë 
	m_xmlNode
ëë !
.
ëë! "

FirstChild
ëë" ,
==
ëë- /
null
ëë0 4
)
ëë4 5
{
ìì 
return
íí 
null
íí #
;
íí# $
}
îî 
return
ïï 
new
ïï 
FXmlNode
ïï '
(
ïï' (

m_fXmlCore
ïï( 2
,
ïï2 3
	m_xmlNode
ïï4 =
.
ïï= >

FirstChild
ïï> H
)
ïïH I
;
ïïI J
}
ğğ 
catch
ññ 
(
ññ 
	Exception
ññ  
ex
ññ! #
)
ññ# $
{
òò 
FDebug
óó 
.
óó 
throwException
óó )
(
óó) *
ex
óó* ,
)
óó, -
;
óó- .
}
ôô 
finally
õõ 
{
öö 

m_fXmlCore
÷÷ 
.
÷÷ 
set
÷÷ "
(
÷÷" #
)
÷÷# $
;
÷÷$ %
}
øø 
return
ùù 
null
ùù 
;
ùù 
}
úú 
}
ûû 	
public
ÿÿ 
FXmlNode
ÿÿ 

fLastChild
ÿÿ "
{
€€ 	
get
 
{
‚‚ 
try
ƒƒ 
{
„„ 

m_fXmlCore
…… 
.
…… 
wait
…… #
(
……# $
)
……$ %
;
……% &
if
†† 
(
†† 
	m_xmlNode
†† !
.
††! "
	LastChild
††" +
==
††, .
null
††/ 3
)
††3 4
{
‡‡ 
return
ˆˆ 
null
ˆˆ #
;
ˆˆ# $
}
‰‰ 
return
ŠŠ 
new
ŠŠ 
FXmlNode
ŠŠ '
(
ŠŠ' (

m_fXmlCore
ŠŠ( 2
,
ŠŠ2 3
	m_xmlNode
ŠŠ4 =
.
ŠŠ= >
	LastChild
ŠŠ> G
)
ŠŠG H
;
ŠŠH I
}
‹‹ 
catch
ŒŒ 
(
ŒŒ 
	Exception
ŒŒ  
ex
ŒŒ! #
)
ŒŒ# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
 
finally
 
{
‘‘ 

m_fXmlCore
’’ 
.
’’ 
set
’’ "
(
’’" #
)
’’# $
;
’’$ %
}
““ 
return
”” 
null
”” 
;
”” 
}
•• 
}
–– 	
public
šš 
string
šš 
innerXml
šš 
{
›› 	
get
œœ 
{
 
try
 
{
ŸŸ 

m_fXmlCore
   
.
   
wait
   #
(
  # $
)
  $ %
;
  % &
return
¡¡ 
	m_xmlNode
¡¡ $
.
¡¡$ %
InnerXml
¡¡% -
;
¡¡- .
}
¢¢ 
catch
££ 
(
££ 
	Exception
££  
ex
££! #
)
££# $
{
¤¤ 
FDebug
¥¥ 
.
¥¥ 
throwException
¥¥ )
(
¥¥) *
ex
¥¥* ,
)
¥¥, -
;
¥¥- .
}
¦¦ 
finally
§§ 
{
¨¨ 

m_fXmlCore
©© 
.
©© 
set
©© "
(
©©" #
)
©©# $
;
©©$ %
}
ªª 
return
«« 
null
«« 
;
«« 
}
¬¬ 
set
®® 
{
¯¯ 
try
°° 
{
±± 

m_fXmlCore
²² 
.
²² 
wait
²² #
(
²²# $
)
²²$ %
;
²²% &
	m_xmlNode
³³ 
.
³³ 
InnerXml
³³ &
=
³³' (
value
³³) .
;
³³. /
}
´´ 
catch
µµ 
(
µµ 
	Exception
µµ  
ex
µµ! #
)
µµ# $
{
¶¶ 
FDebug
·· 
.
·· 
throwException
·· )
(
··) *
ex
··* ,
)
··, -
;
··- .
}
¸¸ 
finally
¹¹ 
{
ºº 

m_fXmlCore
»» 
.
»» 
set
»» "
(
»»" #
)
»»# $
;
»»$ %
}
¼¼ 
}
½½ 
}
¾¾ 	
public
ÂÂ 
string
ÂÂ 
outerXml
ÂÂ 
{
ÃÃ 	
get
ÄÄ 
{
ÅÅ 
try
ÆÆ 
{
ÇÇ 

m_fXmlCore
ÈÈ 
.
ÈÈ 
wait
ÈÈ #
(
ÈÈ# $
)
ÈÈ$ %
;
ÈÈ% &
return
ÉÉ 
	m_xmlNode
ÉÉ $
.
ÉÉ$ %
OuterXml
ÉÉ% -
;
ÉÉ- .
}
ÊÊ 
catch
ËË 
(
ËË 
	Exception
ËË  
ex
ËË! #
)
ËË# $
{
ÌÌ 
FDebug
ÍÍ 
.
ÍÍ 
throwException
ÍÍ )
(
ÍÍ) *
ex
ÍÍ* ,
)
ÍÍ, -
;
ÍÍ- .
}
ÎÎ 
finally
ÏÏ 
{
ĞĞ 

m_fXmlCore
ÑÑ 
.
ÑÑ 
set
ÑÑ "
(
ÑÑ" #
)
ÑÑ# $
;
ÑÑ$ %
}
ÒÒ 
return
ÓÓ 
string
ÓÓ 
.
ÓÓ 
Empty
ÓÓ #
;
ÓÓ# $
}
ÔÔ 
}
ÕÕ 	
public
ÙÙ 
string
ÙÙ 
	innerText
ÙÙ 
{
ÚÚ 	
get
ÛÛ 
{
ÜÜ 
try
İİ 
{
ŞŞ 

m_fXmlCore
ßß 
.
ßß 
wait
ßß #
(
ßß# $
)
ßß$ %
;
ßß% &
return
àà 
(
àà 
(
àà 

XmlElement
àà '
)
àà' (
	m_xmlNode
àà( 1
)
àà1 2
.
àà2 3
	InnerText
àà3 <
;
àà< =
}
áá 
catch
ââ 
(
ââ 
	Exception
ââ  
ex
ââ! #
)
ââ# $
{
ãã 
FDebug
ää 
.
ää 
throwException
ää )
(
ää) *
ex
ää* ,
)
ää, -
;
ää- .
}
åå 
finally
ææ 
{
çç 

m_fXmlCore
èè 
.
èè 
set
èè "
(
èè" #
)
èè# $
;
èè$ %
}
éé 
return
êê 
string
êê 
.
êê 
Empty
êê #
;
êê# $
}
ëë 
set
íí 
{
îî 
try
ïï 
{
ğğ 

m_fXmlCore
ññ 
.
ññ 
wait
ññ #
(
ññ# $
)
ññ$ %
;
ññ% &
(
òò 
(
òò 

XmlElement
òò  
)
òò  !
	m_xmlNode
òò! *
)
òò* +
.
òò+ ,
	InnerText
òò, 5
=
òò6 7
value
òò8 =
;
òò= >
}
óó 
catch
ôô 
(
ôô 
	Exception
ôô  
ex
ôô! #
)
ôô# $
{
õõ 
FDebug
öö 
.
öö 
throwException
öö )
(
öö) *
ex
öö* ,
)
öö, -
;
öö- .
}
÷÷ 
finally
øø 
{
ùù 

m_fXmlCore
úú 
.
úú 
set
úú "
(
úú" #
)
úú# $
;
úú$ %
}
ûû 
}
üü 
}
ıı 	
public
 
FXmlNodeType
 
	fNodeType
 %
{
‚‚ 	
get
ƒƒ 
{
„„ 
try
…… 
{
†† 
return
‡‡ 
(
‡‡ 
FXmlNodeType
‡‡ (
)
‡‡( )
	m_xmlNode
‡‡) 2
.
‡‡2 3
NodeType
‡‡3 ;
;
‡‡; <
}
ˆˆ 
catch
‰‰ 
(
‰‰ 
	Exception
‰‰  
ex
‰‰! #
)
‰‰# $
{
ŠŠ 
FDebug
‹‹ 
.
‹‹ 
throwException
‹‹ )
(
‹‹) *
ex
‹‹* ,
)
‹‹, -
;
‹‹- .
}
ŒŒ 
finally
 
{
 
}
 
return
‘‘ 
FXmlNodeType
‘‘ #
.
‘‘# $
Element
‘‘$ +
;
‘‘+ ,
}
’’ 
}
““ 	
public
›› 
FXmlNode
›› 

importNode
›› "
(
››" #
FXmlNode
œœ 
fXmlNode
œœ 
,
œœ 
bool
 
deep
 
)
 
{
ŸŸ 	
try
   
{
¡¡ 

m_fXmlCore
¢¢ 
.
¢¢ 
wait
¢¢ 
(
¢¢  
)
¢¢  !
;
¢¢! "
if
££ 
(
££ 
	m_xmlNode
££ 
.
££ 
OwnerDocument
££ +
.
££+ ,
Equals
££, 2
(
££2 3
fXmlNode
££3 ;
.
££; <
baseXml
££< C
.
££C D
OwnerDocument
££D Q
)
££Q R
)
££R S
{
¤¤ 
return
¥¥ 
new
¥¥ 
FXmlNode
¥¥ '
(
¥¥' (

m_fXmlCore
¥¥( 2
,
¥¥2 3
fXmlNode
¥¥4 <
.
¥¥< =
baseXml
¥¥= D
.
¥¥D E
	CloneNode
¥¥E N
(
¥¥N O
deep
¥¥O S
)
¥¥S T
)
¥¥T U
;
¥¥U V
}
¦¦ 
return
§§ 
new
§§ 
FXmlNode
§§ #
(
§§# $

m_fXmlCore
§§$ .
,
§§. /
	m_xmlNode
§§0 9
.
§§9 :
OwnerDocument
§§: G
.
§§G H

ImportNode
§§H R
(
§§R S
fXmlNode
§§S [
.
§§[ \
baseXml
§§\ c
,
§§c d
deep
§§e i
)
§§i j
)
§§j k
;
§§k l
}
¨¨ 
catch
©© 
(
©© 
	Exception
©© 
ex
©© 
)
©©  
{
ªª 
FDebug
«« 
.
«« 
throwException
«« %
(
««% &
ex
««& (
)
««( )
;
««) *
}
¬¬ 
finally
­­ 
{
®® 

m_fXmlCore
¯¯ 
.
¯¯ 
set
¯¯ 
(
¯¯ 
)
¯¯  
;
¯¯  !
}
°° 
return
±± 
null
±± 
;
±± 
}
²² 	
public
¶¶ 
FXmlNode
¶¶ 
clone
¶¶ 
(
¶¶ 
bool
·· 
deep
·· 
)
¸¸ 
{
¹¹ 	
try
ºº 
{
»» 

m_fXmlCore
¼¼ 
.
¼¼ 
wait
¼¼ 
(
¼¼  
)
¼¼  !
;
¼¼! "
return
½½ 
new
½½ 
FXmlNode
½½ #
(
½½# $

m_fXmlCore
½½$ .
,
½½. /
	m_xmlNode
½½0 9
.
½½9 :
	CloneNode
½½: C
(
½½C D
deep
½½D H
)
½½H I
)
½½I J
;
½½J K
}
¾¾ 
catch
¿¿ 
(
¿¿ 
	Exception
¿¿ 
ex
¿¿ 
)
¿¿  
{
ÀÀ 
FDebug
ÁÁ 
.
ÁÁ 
throwException
ÁÁ %
(
ÁÁ% &
ex
ÁÁ& (
)
ÁÁ( )
;
ÁÁ) *
}
ÂÂ 
finally
ÃÃ 
{
ÄÄ 

m_fXmlCore
ÅÅ 
.
ÅÅ 
set
ÅÅ 
(
ÅÅ 
)
ÅÅ  
;
ÅÅ  !
}
ÆÆ 
return
ÇÇ 
null
ÇÇ 
;
ÇÇ 
}
ÈÈ 	
public
ÌÌ 
FXmlNode
ÌÌ 
appendChild
ÌÌ #
(
ÌÌ# $
FXmlNode
ÍÍ 
newChild
ÍÍ 
)
ÎÎ 
{
ÏÏ 	
XmlNode
ĞĞ 
xmlNode
ĞĞ 
=
ĞĞ 
null
ĞĞ "
;
ĞĞ" #
try
ÒÒ 
{
ÓÓ 

m_fXmlCore
ÔÔ 
.
ÔÔ 
wait
ÔÔ 
(
ÔÔ  
)
ÔÔ  !
;
ÔÔ! "
if
ÕÕ 
(
ÕÕ 
	m_xmlNode
ÕÕ 
.
ÕÕ 
OwnerDocument
ÕÕ +
.
ÕÕ+ ,
Equals
ÕÕ, 2
(
ÕÕ2 3
newChild
ÕÕ3 ;
.
ÕÕ; <
baseXml
ÕÕ< C
.
ÕÕC D
OwnerDocument
ÕÕD Q
)
ÕÕQ R
)
ÕÕR S
{
ÖÖ 
xmlNode
×× 
=
×× 
	m_xmlNode
×× '
.
××' (
AppendChild
××( 3
(
××3 4
newChild
××4 <
.
××< =
baseXml
××= D
)
××D E
;
××E F
}
ØØ 
else
ÙÙ 
{
ÚÚ 
xmlNode
ÛÛ 
=
ÛÛ 
	m_xmlNode
ÛÛ '
.
ÛÛ' (
AppendChild
ÛÛ( 3
(
ÛÛ3 4
	m_xmlNode
ÛÛ4 =
.
ÛÛ= >
OwnerDocument
ÛÛ> K
.
ÛÛK L

ImportNode
ÛÛL V
(
ÛÛV W
newChild
ÛÛW _
.
ÛÛ_ `
baseXml
ÛÛ` g
,
ÛÛg h
true
ÛÛi m
)
ÛÛm n
)
ÛÛn o
;
ÛÛo p
}
ÜÜ 
return
İİ 
new
İİ 
FXmlNode
İİ #
(
İİ# $

m_fXmlCore
İİ$ .
,
İİ. /
xmlNode
İİ0 7
)
İİ7 8
;
İİ8 9
}
ŞŞ 
catch
ßß 
(
ßß 
	Exception
ßß 
ex
ßß 
)
ßß  
{
àà 
FDebug
áá 
.
áá 
throwException
áá %
(
áá% &
ex
áá& (
)
áá( )
;
áá) *
}
ââ 
finally
ãã 
{
ää 

m_fXmlCore
åå 
.
åå 
set
åå 
(
åå 
)
åå  
;
åå  !
}
ææ 
return
çç 
null
çç 
;
çç 
}
èè 	
public
ìì 
FXmlNode
ìì 
insertBefore
ìì $
(
ìì$ %
FXmlNode
íí 
newChild
íí 
,
íí 
FXmlNode
îî 
refChild
îî 
)
ïï 
{
ğğ 	
XmlNode
ññ 
xmlNode
ññ 
=
ññ 
null
ññ "
;
ññ" #
try
óó 
{
ôô 

m_fXmlCore
õõ 
.
õõ 
wait
õõ 
(
õõ  
)
õõ  !
;
õõ! "
if
öö 
(
öö 
	m_xmlNode
öö 
.
öö 
OwnerDocument
öö +
.
öö+ ,
Equals
öö, 2
(
öö2 3
newChild
öö3 ;
.
öö; <
baseXml
öö< C
.
ööC D
OwnerDocument
ööD Q
)
ööQ R
)
ööR S
{
÷÷ 
xmlNode
øø 
=
øø 
	m_xmlNode
øø '
.
øø' (
InsertBefore
øø( 4
(
øø4 5
newChild
øø5 =
.
øø= >
baseXml
øø> E
,
øøE F
refChild
øøG O
.
øøO P
baseXml
øøP W
)
øøW X
;
øøX Y
}
ùù 
else
úú 
{
ûû 
xmlNode
üü 
=
üü 
	m_xmlNode
üü '
.
üü' (
InsertBefore
üü( 4
(
üü4 5
	m_xmlNode
üü5 >
.
üü> ?
OwnerDocument
üü? L
.
üüL M

ImportNode
üüM W
(
üüW X
newChild
üüX `
.
üü` a
baseXml
üüa h
,
üüh i
true
üüj n
)
üün o
,
üüo p
refChild
üüq y
.
üüy z
baseXmlüüz 
)üü ‚
;üü‚ ƒ
}
ıı 
return
şş 
new
şş 
FXmlNode
şş #
(
şş# $

m_fXmlCore
şş$ .
,
şş. /
xmlNode
şş0 7
)
şş7 8
;
şş8 9
}
ÿÿ 
catch
€€ 
(
€€ 
	Exception
€€ 
ex
€€ 
)
€€  
{
 
FDebug
‚‚ 
.
‚‚ 
throwException
‚‚ %
(
‚‚% &
ex
‚‚& (
)
‚‚( )
;
‚‚) *
}
ƒƒ 
finally
„„ 
{
…… 

m_fXmlCore
†† 
.
†† 
set
†† 
(
†† 
)
††  
;
††  !
}
‡‡ 
return
ˆˆ 
null
ˆˆ 
;
ˆˆ 
}
‰‰ 	
public
 
FXmlNode
 
insertAfter
 #
(
# $
FXmlNode
 
newChild
 
,
 
FXmlNode
 
refChild
 
)
 
{
‘‘ 	
XmlNode
’’ 
xmlNode
’’ 
=
’’ 
null
’’ "
;
’’" #
try
”” 
{
•• 

m_fXmlCore
–– 
.
–– 
wait
–– 
(
––  
)
––  !
;
––! "
if
—— 
(
—— 
	m_xmlNode
—— 
.
—— 
OwnerDocument
—— +
.
——+ ,
Equals
——, 2
(
——2 3
newChild
——3 ;
.
——; <
baseXml
——< C
.
——C D
OwnerDocument
——D Q
)
——Q R
)
——R S
{
˜˜ 
xmlNode
™™ 
=
™™ 
	m_xmlNode
™™ '
.
™™' (
InsertAfter
™™( 3
(
™™3 4
newChild
™™4 <
.
™™< =
baseXml
™™= D
,
™™D E
refChild
™™F N
.
™™N O
baseXml
™™O V
)
™™V W
;
™™W X
}
šš 
else
›› 
{
œœ 
xmlNode
 
=
 
	m_xmlNode
 '
.
' (
InsertAfter
( 3
(
3 4
	m_xmlNode
4 =
.
= >
OwnerDocument
> K
.
K L

ImportNode
L V
(
V W
newChild
W _
.
_ `
baseXml
` g
,
g h
true
i m
)
m n
,
n o
refChild
p x
.
x y
baseXmly €
)€ 
; ‚
}
 
return
ŸŸ 
new
ŸŸ 
FXmlNode
ŸŸ #
(
ŸŸ# $

m_fXmlCore
ŸŸ$ .
,
ŸŸ. /
xmlNode
ŸŸ0 7
)
ŸŸ7 8
;
ŸŸ8 9
}
   
catch
¡¡ 
(
¡¡ 
	Exception
¡¡ 
ex
¡¡ 
)
¡¡  
{
¢¢ 
FDebug
££ 
.
££ 
throwException
££ %
(
££% &
ex
££& (
)
££( )
;
££) *
}
¤¤ 
finally
¥¥ 
{
¦¦ 

m_fXmlCore
§§ 
.
§§ 
set
§§ 
(
§§ 
)
§§  
;
§§  !
}
¨¨ 
return
©© 
null
©© 
;
©© 
}
ªª 	
public
®® 
FXmlNode
®® 
removeChild
®® #
(
®®# $
FXmlNode
¯¯ 
oldChild
¯¯ 
)
°° 
{
±± 	
XmlNode
²² 
xmlNode
²² 
=
²² 
null
²² "
;
²²" #
try
´´ 
{
µµ 

m_fXmlCore
¶¶ 
.
¶¶ 
wait
¶¶ 
(
¶¶  
)
¶¶  !
;
¶¶! "
xmlNode
·· 
=
·· 
	m_xmlNode
·· #
.
··# $
RemoveChild
··$ /
(
··/ 0
oldChild
··0 8
.
··8 9
baseXml
··9 @
)
··@ A
;
··A B
return
¸¸ 
new
¸¸ 
FXmlNode
¸¸ #
(
¸¸# $

m_fXmlCore
¸¸$ .
,
¸¸. /
xmlNode
¸¸0 7
)
¸¸7 8
;
¸¸8 9
}
¹¹ 
catch
ºº 
(
ºº 
	Exception
ºº 
ex
ºº 
)
ºº  
{
»» 
FDebug
¼¼ 
.
¼¼ 
throwException
¼¼ %
(
¼¼% &
ex
¼¼& (
)
¼¼( )
;
¼¼) *
}
½½ 
finally
¾¾ 
{
¿¿ 

m_fXmlCore
ÀÀ 
.
ÀÀ 
set
ÀÀ 
(
ÀÀ 
)
ÀÀ  
;
ÀÀ  !
}
ÁÁ 
return
ÂÂ 
null
ÂÂ 
;
ÂÂ 
}
ÃÃ 	
public
ÇÇ 
FXmlNode
ÇÇ 
moveUp
ÇÇ 
(
ÇÇ 
)
ÈÈ 
{
ÉÉ 	
XmlNode
ÊÊ 
xmlNodeParent
ÊÊ !
=
ÊÊ" #
null
ÊÊ$ (
;
ÊÊ( )
XmlNode
ËË 
xmlNodePrev
ËË 
=
ËË  !
null
ËË" &
;
ËË& '
try
ÍÍ 
{
ÎÎ 

m_fXmlCore
ÏÏ 
.
ÏÏ 
wait
ÏÏ 
(
ÏÏ  
)
ÏÏ  !
;
ÏÏ! "
xmlNodeParent
ĞĞ 
=
ĞĞ 
	m_xmlNode
ĞĞ  )
.
ĞĞ) *

ParentNode
ĞĞ* 4
;
ĞĞ4 5
xmlNodePrev
ÑÑ 
=
ÑÑ 
	m_xmlNode
ÑÑ '
.
ÑÑ' (
PreviousSibling
ÑÑ( 7
;
ÑÑ7 8
xmlNodeParent
ÒÒ 
.
ÒÒ 
RemoveChild
ÒÒ )
(
ÒÒ) *
	m_xmlNode
ÒÒ* 3
)
ÒÒ3 4
;
ÒÒ4 5
xmlNodeParent
ÓÓ 
.
ÓÓ 
InsertBefore
ÓÓ *
(
ÓÓ* +
	m_xmlNode
ÓÓ+ 4
,
ÓÓ4 5
xmlNodePrev
ÓÓ6 A
)
ÓÓA B
;
ÓÓB C
return
ÔÔ 
new
ÔÔ 
FXmlNode
ÔÔ #
(
ÔÔ# $

m_fXmlCore
ÔÔ$ .
,
ÔÔ. /
	m_xmlNode
ÔÔ0 9
)
ÔÔ9 :
;
ÔÔ: ;
}
ÕÕ 
catch
ÖÖ 
(
ÖÖ 
	Exception
ÖÖ 
ex
ÖÖ 
)
ÖÖ  
{
×× 
FDebug
ØØ 
.
ØØ 
throwException
ØØ %
(
ØØ% &
ex
ØØ& (
)
ØØ( )
;
ØØ) *
}
ÙÙ 
finally
ÚÚ 
{
ÛÛ 

m_fXmlCore
ÜÜ 
.
ÜÜ 
set
ÜÜ 
(
ÜÜ 
)
ÜÜ  
;
ÜÜ  !
xmlNodeParent
İİ 
=
İİ 
null
İİ  $
;
İİ$ %
xmlNodePrev
ŞŞ 
=
ŞŞ 
null
ŞŞ "
;
ŞŞ" #
}
ßß 
return
àà 
null
àà 
;
àà 
}
áá 	
public
åå 
FXmlNode
åå 
moveDown
åå  
(
åå  !
)
ææ 
{
çç 	
XmlNode
èè 
xmlNodeParent
èè !
=
èè" #
null
èè$ (
;
èè( )
XmlNode
éé 
xmlNodePrev
éé 
=
éé  !
null
éé" &
;
éé& '
try
ëë 
{
ìì 

m_fXmlCore
íí 
.
íí 
wait
íí 
(
íí  
)
íí  !
;
íí! "
xmlNodeParent
îî 
=
îî 
	m_xmlNode
îî  )
.
îî) *

ParentNode
îî* 4
;
îî4 5
xmlNodePrev
ïï 
=
ïï 
	m_xmlNode
ïï '
.
ïï' (
NextSibling
ïï( 3
;
ïï3 4
xmlNodeParent
ğğ 
.
ğğ 
RemoveChild
ğğ )
(
ğğ) *
	m_xmlNode
ğğ* 3
)
ğğ3 4
;
ğğ4 5
xmlNodeParent
ññ 
.
ññ 
InsertAfter
ññ )
(
ññ) *
	m_xmlNode
ññ* 3
,
ññ3 4
xmlNodePrev
ññ5 @
)
ññ@ A
;
ññA B
return
òò 
new
òò 
FXmlNode
òò #
(
òò# $

m_fXmlCore
òò$ .
,
òò. /
	m_xmlNode
òò0 9
)
òò9 :
;
òò: ;
}
óó 
catch
ôô 
(
ôô 
	Exception
ôô 
ex
ôô 
)
ôô  
{
õõ 
FDebug
öö 
.
öö 
throwException
öö %
(
öö% &
ex
öö& (
)
öö( )
;
öö) *
}
÷÷ 
finally
øø 
{
ùù 

m_fXmlCore
úú 
.
úú 
set
úú 
(
úú 
)
úú  
;
úú  !
xmlNodeParent
ûû 
=
ûû 
null
ûû  $
;
ûû$ %
xmlNodePrev
üü 
=
üü 
null
üü "
;
üü" #
}
ıı 
return
şş 
null
şş 
;
şş 
}
ÿÿ 	
public
ƒƒ 
void
ƒƒ 
	removeAll
ƒƒ 
(
ƒƒ 
)
„„ 
{
…… 	
try
†† 
{
‡‡ 

m_fXmlCore
ˆˆ 
.
ˆˆ 
wait
ˆˆ 
(
ˆˆ  
)
ˆˆ  !
;
ˆˆ! "
	m_xmlNode
‰‰ 
.
‰‰ 
	RemoveAll
‰‰ #
(
‰‰# $
)
‰‰$ %
;
‰‰% &
}
ŠŠ 
catch
‹‹ 
(
‹‹ 
	Exception
‹‹ 
ex
‹‹ 
)
‹‹  
{
ŒŒ 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
 
{
 

m_fXmlCore
‘‘ 
.
‘‘ 
set
‘‘ 
(
‘‘ 
)
‘‘  
;
‘‘  !
}
’’ 
}
““ 	
public
—— 
FXmlNode
—— 
selectSingleNode
—— (
(
——( )
string
˜˜ 
xpath
˜˜ 
)
™™ 
{
šš 	
XmlNode
›› 
xmlNode
›› 
=
›› 
null
›› "
;
››" #
try
 
{
 

m_fXmlCore
ŸŸ 
.
ŸŸ 
wait
ŸŸ 
(
ŸŸ  
)
ŸŸ  !
;
ŸŸ! "
xmlNode
   
=
   
	m_xmlNode
   #
.
  # $
SelectSingleNode
  $ 4
(
  4 5
xpath
  5 :
)
  : ;
;
  ; <
if
¡¡ 
(
¡¡ 
xmlNode
¡¡ 
==
¡¡ 
null
¡¡ #
)
¡¡# $
{
¢¢ 
return
££ 
null
££ 
;
££  
}
¤¤ 
return
¥¥ 
new
¥¥ 
FXmlNode
¥¥ #
(
¥¥# $

m_fXmlCore
¥¥$ .
,
¥¥. /
xmlNode
¥¥0 7
)
¥¥7 8
;
¥¥8 9
}
¦¦ 
catch
§§ 
(
§§ 
	Exception
§§ 
ex
§§ 
)
§§  
{
¨¨ 
FDebug
©© 
.
©© 
throwException
©© %
(
©©% &
ex
©©& (
)
©©( )
;
©©) *
}
ªª 
finally
«« 
{
¬¬ 

m_fXmlCore
­­ 
.
­­ 
set
­­ 
(
­­ 
)
­­  
;
­­  !
}
®® 
return
¯¯ 
null
¯¯ 
;
¯¯ 
}
°° 	
public
´´ 
FXmlNodeList
´´ 
selectNodes
´´ '
(
´´' (
string
µµ 
xpath
µµ 
)
¶¶ 
{
·· 	
try
¸¸ 
{
¹¹ 

m_fXmlCore
ºº 
.
ºº 
wait
ºº 
(
ºº  
)
ºº  !
;
ºº! "
return
»» 
new
»» 
FXmlNodeList
»» '
(
»»' (

m_fXmlCore
»»( 2
,
»»2 3
	m_xmlNode
»»4 =
.
»»= >
SelectNodes
»»> I
(
»»I J
xpath
»»J O
)
»»O P
)
»»P Q
;
»»Q R
}
¼¼ 
catch
½½ 
(
½½ 
	Exception
½½ 
ex
½½ 
)
½½  
{
¾¾ 
FDebug
¿¿ 
.
¿¿ 
throwException
¿¿ %
(
¿¿% &
ex
¿¿& (
)
¿¿( )
;
¿¿) *
}
ÀÀ 
finally
ÁÁ 
{
ÂÂ 

m_fXmlCore
ÃÃ 
.
ÃÃ 
set
ÃÃ 
(
ÃÃ 
)
ÃÃ  
;
ÃÃ  !
}
ÄÄ 
return
ÅÅ 
null
ÅÅ 
;
ÅÅ 
}
ÆÆ 	
public
ÊÊ 
string
ÊÊ 
xmlToString
ÊÊ !
(
ÊÊ! "
bool
ËË  
preserveWhiteSpace
ËË #
)
ÌÌ 
{
ÍÍ 	
XmlDocument
ÎÎ 
xmlDoc
ÎÎ 
=
ÎÎ  
null
ÎÎ! %
;
ÎÎ% &
	XmlWriter
ĞĞ 
	xmlWriter
ĞĞ 
=
ĞĞ  !
null
ĞĞ" &
;
ĞĞ& '
XmlWriterSettings
ÑÑ 
settings
ÑÑ &
=
ÑÑ' (
null
ÑÑ) -
;
ÑÑ- .
StringBuilder
ÒÒ 
stringBuilder
ÒÒ '
=
ÒÒ( )
null
ÒÒ* .
;
ÒÒ. /
try
ÔÔ 
{
ÕÕ 

m_fXmlCore
ÖÖ 
.
ÖÖ 
wait
ÖÖ 
(
ÖÖ  
)
ÖÖ  !
;
ÖÖ! "
if
ÚÚ 
(
ÚÚ 
!
ÚÚ  
preserveWhiteSpace
ÚÚ '
)
ÚÚ' (
{
ÛÛ 
return
ÜÜ 
	m_xmlNode
ÜÜ $
.
ÜÜ$ %
OuterXml
ÜÜ% -
;
ÜÜ- .
}
İİ 
xmlDoc
ßß 
=
ßß 
new
ßß 
XmlDocument
ßß (
(
ßß( )
)
ßß) *
;
ßß* +
xmlDoc
àà 
.
àà 
LoadXml
àà 
(
àà 
	m_xmlNode
àà (
.
àà( )
OuterXml
àà) 1
)
àà1 2
;
àà2 3
settings
ää 
=
ää 
new
ää 
XmlWriterSettings
ää 0
(
ää0 1
)
ää1 2
;
ää2 3
settings
åå 
.
åå  
OmitXmlDeclaration
åå +
=
åå, -
true
åå. 2
;
åå2 3
settings
ææ 
.
ææ 
Indent
ææ 
=
ææ  !
true
ææ" &
;
ææ& '
settings
èè 
.
èè 
IndentChars
èè $
=
èè% &
$str
èè' +
;
èè+ ,
settings
éé 
.
éé 
NewLineHandling
éé (
=
éé) *
NewLineHandling
éé+ :
.
éé: ;
Replace
éé; B
;
ééB C
settings
êê 
.
êê 
CheckCharacters
êê (
=
êê) *
false
êê+ 0
;
êê0 1
stringBuilder
ìì 
=
ìì 
new
ìì  #
StringBuilder
ìì$ 1
(
ìì1 2
)
ìì2 3
;
ìì3 4
	xmlWriter
íí 
=
íí 
	XmlWriter
íí %
.
íí% &
Create
íí& ,
(
íí, -
stringBuilder
íí- :
,
íí: ;
settings
íí< D
)
ííD E
;
ííE F
xmlDoc
ïï 
.
ïï 
Save
ïï 
(
ïï 
	xmlWriter
ïï %
)
ïï% &
;
ïï& '
return
óó 
stringBuilder
óó $
.
óó$ %
ToString
óó% -
(
óó- .
)
óó. /
;
óó/ 0
}
ôô 
catch
õõ 
(
õõ 
	Exception
õõ 
ex
õõ 
)
õõ  
{
öö 
FDebug
÷÷ 
.
÷÷ 
throwException
÷÷ %
(
÷÷% &
ex
÷÷& (
)
÷÷( )
;
÷÷) *
}
øø 
finally
ùù 
{
úú 

m_fXmlCore
ûû 
.
ûû 
set
ûû 
(
ûû 
)
ûû  
;
ûû  !
}
üü 
return
ıı 
string
ıı 
.
ıı 
Empty
ıı 
;
ıı  
}
şş 	
public
‚‚ 
bool
‚‚ 
containsNode
‚‚  
(
‚‚  !
string
ƒƒ 
xpath
ƒƒ 
)
„„ 
{
…… 	
try
†† 
{
‡‡ 

m_fXmlCore
ˆˆ 
.
ˆˆ 
wait
ˆˆ 
(
ˆˆ  
)
ˆˆ  !
;
ˆˆ! "
return
‰‰ 
(
‰‰ 
	m_xmlNode
‰‰ !
.
‰‰! "
SelectSingleNode
‰‰" 2
(
‰‰2 3
xpath
‰‰3 8
)
‰‰8 9
==
‰‰: <
null
‰‰= A
?
‰‰B C
false
‰‰D I
:
‰‰J K
true
‰‰L P
)
‰‰P Q
;
‰‰Q R
}
ŠŠ 
catch
‹‹ 
(
‹‹ 
	Exception
‹‹ 
ex
‹‹ 
)
‹‹  
{
ŒŒ 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
 
{
 

m_fXmlCore
‘‘ 
.
‘‘ 
set
‘‘ 
(
‘‘ 
)
‘‘  
;
‘‘  !
}
’’ 
return
““ 
false
““ 
;
““ 
}
”” 	
public
˜˜ 
string
˜˜ 
get_attrVal
˜˜ !
(
˜˜! "
string
™™ 
name
™™ 
)
šš 
{
›› 	
XmlAttribute
œœ 
xmlAttr
œœ  
=
œœ! "
null
œœ# '
;
œœ' (
try
 
{
ŸŸ 

m_fXmlCore
   
.
   
wait
   
(
    
)
    !
;
  ! "
xmlAttr
¡¡ 
=
¡¡ 
	m_xmlNode
¡¡ #
.
¡¡# $

Attributes
¡¡$ .
[
¡¡. /
name
¡¡/ 3
]
¡¡3 4
;
¡¡4 5
if
¢¢ 
(
¢¢ 
xmlAttr
¢¢ 
==
¢¢ 
null
¢¢ #
)
¢¢# $
{
££ 
return
¤¤ 
string
¤¤ !
.
¤¤! "
Empty
¤¤" '
;
¤¤' (
}
¥¥ 
return
¦¦ 
xmlAttr
¦¦ 
.
¦¦ 
Value
¦¦ $
;
¦¦$ %
}
§§ 
catch
¨¨ 
(
¨¨ 
	Exception
¨¨ 
ex
¨¨ 
)
¨¨  
{
©© 
FDebug
ªª 
.
ªª 
throwException
ªª %
(
ªª% &
ex
ªª& (
)
ªª( )
;
ªª) *
}
«« 
finally
¬¬ 
{
­­ 

m_fXmlCore
®® 
.
®® 
set
®® 
(
®® 
)
®®  
;
®®  !
}
¯¯ 
return
°° 
string
°° 
.
°° 
Empty
°° 
;
°°  
}
±± 	
public
µµ 
string
µµ 
get_attrVal
µµ !
(
µµ! "
string
¶¶ 
name
¶¶ 
,
¶¶ 
string
·· 
defaultValue
·· 
)
¸¸ 
{
¹¹ 	
XmlAttribute
ºº 
xmlAttr
ºº  
=
ºº! "
null
ºº# '
;
ºº' (
try
¼¼ 
{
½½ 

m_fXmlCore
¾¾ 
.
¾¾ 
wait
¾¾ 
(
¾¾  
)
¾¾  !
;
¾¾! "
xmlAttr
¿¿ 
=
¿¿ 
	m_xmlNode
¿¿ #
.
¿¿# $

Attributes
¿¿$ .
[
¿¿. /
name
¿¿/ 3
]
¿¿3 4
;
¿¿4 5
if
ÀÀ 
(
ÀÀ 
xmlAttr
ÀÀ 
==
ÀÀ 
null
ÀÀ #
)
ÀÀ# $
{
ÁÁ 
return
ÂÂ 
defaultValue
ÂÂ '
;
ÂÂ' (
}
ÃÃ 
return
ÄÄ 
xmlAttr
ÄÄ 
.
ÄÄ 
Value
ÄÄ $
;
ÄÄ$ %
}
ÅÅ 
catch
ÆÆ 
(
ÆÆ 
	Exception
ÆÆ 
ex
ÆÆ 
)
ÆÆ  
{
ÇÇ 
FDebug
ÈÈ 
.
ÈÈ 
throwException
ÈÈ %
(
ÈÈ% &
ex
ÈÈ& (
)
ÈÈ( )
;
ÈÈ) *
}
ÉÉ 
finally
ÊÊ 
{
ËË 

m_fXmlCore
ÌÌ 
.
ÌÌ 
set
ÌÌ 
(
ÌÌ 
)
ÌÌ  
;
ÌÌ  !
}
ÍÍ 
return
ÎÎ 
string
ÎÎ 
.
ÎÎ 
Empty
ÎÎ 
;
ÎÎ  
}
ÏÏ 	
public
ÓÓ 
void
ÓÓ 
set_attrVal
ÓÓ 
(
ÓÓ  
string
ÔÔ 
name
ÔÔ 
,
ÔÔ 
string
ÕÕ 
value
ÕÕ 
)
ÖÖ 
{
×× 	
XmlAttribute
ØØ 
xmlAttr
ØØ  
=
ØØ! "
null
ØØ# '
;
ØØ' (
try
ÚÚ 
{
ÛÛ 

m_fXmlCore
ÜÜ 
.
ÜÜ 
wait
ÜÜ 
(
ÜÜ  
)
ÜÜ  !
;
ÜÜ! "
xmlAttr
İİ 
=
İİ 
	m_xmlNode
İİ #
.
İİ# $

Attributes
İİ$ .
[
İİ. /
name
İİ/ 3
]
İİ3 4
;
İİ4 5
if
ŞŞ 
(
ŞŞ 
xmlAttr
ŞŞ 
==
ŞŞ 
null
ŞŞ #
)
ŞŞ# $
{
ßß 
xmlAttr
àà 
=
àà 
	m_xmlNode
àà '
.
àà' (

Attributes
àà( 2
.
àà2 3
Append
àà3 9
(
àà9 :
	m_xmlNode
àà: C
.
ààC D
OwnerDocument
ààD Q
.
ààQ R
CreateAttribute
ààR a
(
ààa b
name
ààb f
)
ààf g
)
ààg h
;
ààh i
}
áá 
xmlAttr
ââ 
.
ââ 
Value
ââ 
=
ââ 
value
ââ  %
;
ââ% &
}
ãã 
catch
ää 
(
ää 
	Exception
ää 
ex
ää 
)
ää  
{
åå 
FDebug
ææ 
.
ææ 
throwException
ææ %
(
ææ% &
ex
ææ& (
)
ææ( )
;
ææ) *
}
çç 
finally
èè 
{
éé 

m_fXmlCore
êê 
.
êê 
set
êê 
(
êê 
)
êê  
;
êê  !
}
ëë 
}
ìì 	
public
ğğ 
void
ğğ 
set_attrVal
ğğ 
(
ğğ  
string
ññ 
name
ññ 
,
ññ 
string
òò 
defaultValue
òò 
,
òò  
string
óó 
value
óó 
)
ôô 
{
õõ 	
XmlAttribute
öö 
xmlAttr
öö  
=
öö! "
null
öö# '
;
öö' (
try
øø 
{
ùù 

m_fXmlCore
úú 
.
úú 
wait
úú 
(
úú  
)
úú  !
;
úú! "
xmlAttr
ûû 
=
ûû 
	m_xmlNode
ûû #
.
ûû# $

Attributes
ûû$ .
[
ûû. /
name
ûû/ 3
]
ûû3 4
;
ûû4 5
if
üü 
(
üü 
defaultValue
üü  
==
üü! #
value
üü$ )
)
üü) *
{
ıı 
if
şş 
(
şş 
xmlAttr
şş 
!=
şş  "
null
şş# '
)
şş' (
{
ÿÿ 
	m_xmlNode
€€ !
.
€€! "

Attributes
€€" ,
.
€€, -
Remove
€€- 3
(
€€3 4
xmlAttr
€€4 ;
)
€€; <
;
€€< =
}
 
}
‚‚ 
else
ƒƒ 
{
„„ 
if
…… 
(
…… 
xmlAttr
…… 
==
……  "
null
……# '
)
……' (
{
†† 
xmlAttr
‡‡ 
=
‡‡  !
	m_xmlNode
‡‡" +
.
‡‡+ ,

Attributes
‡‡, 6
.
‡‡6 7
Append
‡‡7 =
(
‡‡= >
	m_xmlNode
‡‡> G
.
‡‡G H
OwnerDocument
‡‡H U
.
‡‡U V
CreateAttribute
‡‡V e
(
‡‡e f
name
‡‡f j
)
‡‡j k
)
‡‡k l
;
‡‡l m
}
ˆˆ 
xmlAttr
‰‰ 
.
‰‰ 
Value
‰‰ !
=
‰‰" #
value
‰‰$ )
;
‰‰) *
}
ŠŠ 
}
‹‹ 
catch
ŒŒ 
(
ŒŒ 
	Exception
ŒŒ 
ex
ŒŒ 
)
ŒŒ  
{
 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
 
{
‘‘ 

m_fXmlCore
’’ 
.
’’ 
set
’’ 
(
’’ 
)
’’  
;
’’  !
}
““ 
}
”” 	
public
˜˜ 
void
˜˜ 
set_attrVal
˜˜ 
(
˜˜  
string
™™ 
name
™™ 
,
™™ 
string
šš 
value
šš 
,
šš 
bool
›› 
isModifyEvent
›› 
)
œœ 
{
 	
XmlAttribute
 
xmlAttr
  
=
! "
null
# '
;
' (
try
   
{
¡¡ 

m_fXmlCore
¢¢ 
.
¢¢ 
wait
¢¢ 
(
¢¢  
)
¢¢  !
;
¢¢! "
xmlAttr
££ 
=
££ 
	m_xmlNode
££ #
.
££# $

Attributes
££$ .
[
££. /
name
££/ 3
]
££3 4
;
££4 5
if
¤¤ 
(
¤¤ 
xmlAttr
¤¤ 
==
¤¤ 
null
¤¤ #
)
¤¤# $
{
¥¥ 
xmlAttr
¦¦ 
=
¦¦ 
	m_xmlNode
¦¦ '
.
¦¦' (

Attributes
¦¦( 2
.
¦¦2 3
Append
¦¦3 9
(
¦¦9 :
	m_xmlNode
¦¦: C
.
¦¦C D
OwnerDocument
¦¦D Q
.
¦¦Q R
CreateAttribute
¦¦R a
(
¦¦a b
name
¦¦b f
)
¦¦f g
)
¦¦g h
;
¦¦h i
}
§§ 
if
©© 
(
©© 
xmlAttr
©© 
.
©© 
Value
©© !
!=
©©" $
value
©©% *
)
©©* +
{
ªª 
xmlAttr
«« 
.
«« 
Value
«« !
=
««" #
value
««$ )
;
««) *
if
¬¬ 
(
¬¬ 
isModifyEvent
¬¬ %
)
¬¬% &
{
­­ 
onXmlNodeModified
®® )
(
®®) *
)
®®* +
;
®®+ ,
}
¯¯ 
}
°° 
}
±± 
catch
²² 
(
²² 
	Exception
²² 
ex
²² 
)
²²  
{
³³ 
FDebug
´´ 
.
´´ 
throwException
´´ %
(
´´% &
ex
´´& (
)
´´( )
;
´´) *
}
µµ 
finally
¶¶ 
{
·· 

m_fXmlCore
¸¸ 
.
¸¸ 
set
¸¸ 
(
¸¸ 
)
¸¸  
;
¸¸  !
}
¹¹ 
}
ºº 	
public
¾¾ 
void
¾¾ 
set_attrVal
¾¾ 
(
¾¾  
string
¿¿ 
name
¿¿ 
,
¿¿ 
string
ÀÀ 
defaultValue
ÀÀ 
,
ÀÀ  
string
ÁÁ 
value
ÁÁ 
,
ÁÁ 
bool
ÂÂ 
isModifyEvent
ÂÂ 
)
ÃÃ 
{
ÄÄ 	
XmlAttribute
ÅÅ 
xmlAttr
ÅÅ  
=
ÅÅ! "
null
ÅÅ# '
;
ÅÅ' (
try
ÇÇ 
{
ÈÈ 

m_fXmlCore
ÉÉ 
.
ÉÉ 
wait
ÉÉ 
(
ÉÉ  
)
ÉÉ  !
;
ÉÉ! "
xmlAttr
ÊÊ 
=
ÊÊ 
	m_xmlNode
ÊÊ #
.
ÊÊ# $

Attributes
ÊÊ$ .
[
ÊÊ. /
name
ÊÊ/ 3
]
ÊÊ3 4
;
ÊÊ4 5
if
ËË 
(
ËË 
defaultValue
ËË  
==
ËË! #
value
ËË$ )
)
ËË) *
{
ÌÌ 
if
ÍÍ 
(
ÍÍ 
xmlAttr
ÍÍ 
!=
ÍÍ  "
null
ÍÍ# '
)
ÍÍ' (
{
ÎÎ 
	m_xmlNode
ÏÏ !
.
ÏÏ! "

Attributes
ÏÏ" ,
.
ÏÏ, -
Remove
ÏÏ- 3
(
ÏÏ3 4
xmlAttr
ÏÏ4 ;
)
ÏÏ; <
;
ÏÏ< =
if
ĞĞ 
(
ĞĞ 
isModifyEvent
ĞĞ )
)
ĞĞ) *
{
ÑÑ 
onXmlNodeModified
ÒÒ -
(
ÒÒ- .
)
ÒÒ. /
;
ÒÒ/ 0
}
ÓÓ 
}
ÔÔ 
}
ÕÕ 
else
ÖÖ 
{
×× 
if
ØØ 
(
ØØ 
xmlAttr
ØØ 
==
ØØ  "
null
ØØ# '
)
ØØ' (
{
ÙÙ 
xmlAttr
ÚÚ 
=
ÚÚ  !
	m_xmlNode
ÚÚ" +
.
ÚÚ+ ,

Attributes
ÚÚ, 6
.
ÚÚ6 7
Append
ÚÚ7 =
(
ÚÚ= >
	m_xmlNode
ÚÚ> G
.
ÚÚG H
OwnerDocument
ÚÚH U
.
ÚÚU V
CreateAttribute
ÚÚV e
(
ÚÚe f
name
ÚÚf j
)
ÚÚj k
)
ÚÚk l
;
ÚÚl m
}
ÛÛ 
if
İİ 
(
İİ 
xmlAttr
İİ 
.
İİ  
Value
İİ  %
!=
İİ& (
value
İİ) .
)
İİ. /
{
ŞŞ 
xmlAttr
ßß 
.
ßß  
Value
ßß  %
=
ßß& '
value
ßß( -
;
ßß- .
if
àà 
(
àà 
isModifyEvent
àà )
)
àà) *
{
áá 
onXmlNodeModified
ââ -
(
ââ- .
)
ââ. /
;
ââ/ 0
}
ãã 
}
ää 
}
åå 
}
ææ 
catch
çç 
(
çç 
	Exception
çç 
ex
çç 
)
çç  
{
èè 
FDebug
éé 
.
éé 
throwException
éé %
(
éé% &
ex
éé& (
)
éé( )
;
éé) *
}
êê 
finally
ëë 
{
ìì 

m_fXmlCore
íí 
.
íí 
set
íí 
(
íí 
)
íí  
;
íí  !
}
îî 
}
ïï 	
public
óó 
FXmlNode
óó 
get_elem
óó  
(
óó  !
string
ôô 
name
ôô 
)
õõ 
{
öö 	
XmlNode
÷÷ 
x
÷÷ 
=
÷÷ 
null
÷÷ 
;
÷÷ 
try
ùù 
{
úú 

m_fXmlCore
ûû 
.
ûû 
wait
ûû 
(
ûû  
)
ûû  !
;
ûû! "
x
ıı 
=
ıı 
	m_xmlNode
ıı 
.
ıı 
SelectSingleNode
ıı .
(
ıı. /
name
ıı/ 3
)
ıı3 4
;
ıı4 5
if
şş 
(
şş 
x
şş 
==
şş 
null
şş 
)
şş 
{
ÿÿ 
return
€	€	 
null
€	€	 
;
€	€	  
}
		 
return
‚	‚	 
new
‚	‚	 
FXmlNode
‚	‚	 #
(
‚	‚	# $

m_fXmlCore
‚	‚	$ .
,
‚	‚	. /
x
‚	‚	0 1
)
‚	‚	1 2
;
‚	‚	2 3
}
ƒ	ƒ	 
catch
„	„	 
(
„	„	 
	Exception
„	„	 
ex
„	„	 
)
„	„	  
{
…	…	 
FDebug
†	†	 
.
†	†	 
throwException
†	†	 %
(
†	†	% &
ex
†	†	& (
)
†	†	( )
;
†	†	) *
}
‡	‡	 
finally
ˆ	ˆ	 
{
‰	‰	 

m_fXmlCore
Š	Š	 
.
Š	Š	 
set
Š	Š	 
(
Š	Š	 
)
Š	Š	  
;
Š	Š	  !
}
‹	‹	 
return
Œ	Œ	 
null
Œ	Œ	 
;
Œ	Œ	 
}
		 	
public
‘	‘	 
FXmlNodeList
‘	‘	 
get_elemList
‘	‘	 (
(
‘	‘	( )
string
’	’	 
name
’	’	 
)
“	“	 
{
”	”	 	
try
•	•	 
{
–	–	 

m_fXmlCore
—	—	 
.
—	—	 
wait
—	—	 
(
—	—	  
)
—	—	  !
;
—	—	! "
return
™	™	 
new
™	™	 
FXmlNodeList
™	™	 '
(
™	™	' (

m_fXmlCore
™	™	( 2
,
™	™	2 3
	m_xmlNode
™	™	4 =
.
™	™	= >
SelectNodes
™	™	> I
(
™	™	I J
name
™	™	J N
)
™	™	N O
)
™	™	O P
;
™	™	P Q
}
š	š	 
catch
›	›	 
(
›	›	 
	Exception
›	›	 
ex
›	›	 
)
›	›	  
{
œ	œ	 
FDebug
		 
.
		 
throwException
		 %
(
		% &
ex
		& (
)
		( )
;
		) *
}
		 
finally
Ÿ	Ÿ	 
{
 	 	 

m_fXmlCore
¡	¡	 
.
¡	¡	 
set
¡	¡	 
(
¡	¡	 
)
¡	¡	  
;
¡	¡	  !
}
¢	¢	 
return
£	£	 
null
£	£	 
;
£	£	 
}
¤	¤	 	
public
¨	¨	 
FXmlNode
¨	¨	 
set_elem
¨	¨	  
(
¨	¨	  !
string
©	©	 
name
©	©	 
)
ª	ª	 
{
«	«	 	
XmlNode
¬	¬	 
x
¬	¬	 
=
¬	¬	 
null
¬	¬	 
;
¬	¬	 
try
®	®	 
{
¯	¯	 

m_fXmlCore
°	°	 
.
°	°	 
wait
°	°	 
(
°	°	  
)
°	°	  !
;
°	°	! "
x
²	²	 
=
²	²	 
	m_xmlNode
²	²	 
.
²	²	 
SelectSingleNode
²	²	 .
(
²	²	. /
name
²	²	/ 3
)
²	²	3 4
;
²	²	4 5
if
³	³	 
(
³	³	 
x
³	³	 
==
³	³	 
null
³	³	 
)
³	³	 
{
´	´	 
x
µ	µ	 
=
µ	µ	 
	m_xmlNode
µ	µ	 !
.
µ	µ	! "
AppendChild
µ	µ	" -
(
µ	µ	- .
	m_xmlNode
µ	µ	. 7
.
µ	µ	7 8
OwnerDocument
µ	µ	8 E
.
µ	µ	E F

CreateNode
µ	µ	F P
(
µ	µ	P Q
XmlNodeType
µ	µ	Q \
.
µ	µ	\ ]
Element
µ	µ	] d
,
µ	µ	d e
name
µ	µ	f j
,
µ	µ	j k
string
µ	µ	l r
.
µ	µ	r s
Empty
µ	µ	s x
)
µ	µ	x y
)
µ	µ	y z
;
µ	µ	z {
}
¶	¶	 
return
·	·	 
new
·	·	 
FXmlNode
·	·	 #
(
·	·	# $

m_fXmlCore
·	·	$ .
,
·	·	. /
x
·	·	0 1
)
·	·	1 2
;
·	·	2 3
}
¸	¸	 
catch
¹	¹	 
(
¹	¹	 
	Exception
¹	¹	 
ex
¹	¹	 
)
¹	¹	  
{
º	º	 
FDebug
»	»	 
.
»	»	 
throwException
»	»	 %
(
»	»	% &
ex
»	»	& (
)
»	»	( )
;
»	»	) *
}
¼	¼	 
finally
½	½	 
{
¾	¾	 

m_fXmlCore
¿	¿	 
.
¿	¿	 
set
¿	¿	 
(
¿	¿	 
)
¿	¿	  
;
¿	¿	  !
}
À	À	 
return
Á	Á	 
null
Á	Á	 
;
Á	Á	 
}
Â	Â	 	
public
Æ	Æ	 
string
Æ	Æ	 
get_elemVal
Æ	Æ	 !
(
Æ	Æ	! "
string
Ç	Ç	 
name
Ç	Ç	 
)
È	È	 
{
É	É	 	
XmlNode
Ê	Ê	 
x
Ê	Ê	 
=
Ê	Ê	 
null
Ê	Ê	 
;
Ê	Ê	 
XmlAttribute
Ë	Ë	 
a
Ë	Ë	 
=
Ë	Ë	 
null
Ë	Ë	 !
;
Ë	Ë	! "
try
Í	Í	 
{
Î	Î	 

m_fXmlCore
Ï	Ï	 
.
Ï	Ï	 
wait
Ï	Ï	 
(
Ï	Ï	  
)
Ï	Ï	  !
;
Ï	Ï	! "
x
Ñ	Ñ	 
=
Ñ	Ñ	 
	m_xmlNode
Ñ	Ñ	 
.
Ñ	Ñ	 
SelectSingleNode
Ñ	Ñ	 .
(
Ñ	Ñ	. /
name
Ñ	Ñ	/ 3
)
Ñ	Ñ	3 4
;
Ñ	Ñ	4 5
if
Ò	Ò	 
(
Ò	Ò	 
x
Ò	Ò	 
==
Ò	Ò	 
null
Ò	Ò	 
)
Ò	Ò	 
{
Ó	Ó	 
return
Ô	Ô	 
string
Ô	Ô	 !
.
Ô	Ô	! "
Empty
Ô	Ô	" '
;
Ô	Ô	' (
}
Õ	Õ	 
a
×	×	 
=
×	×	 
x
×	×	 
.
×	×	 

Attributes
×	×	  
[
×	×	  !
A_Value
×	×	! (
]
×	×	( )
;
×	×	) *
if
Ø	Ø	 
(
Ø	Ø	 
a
Ø	Ø	 
==
Ø	Ø	 
null
Ø	Ø	 
)
Ø	Ø	 
{
Ù	Ù	 
return
Ú	Ú	 
string
Ú	Ú	 !
.
Ú	Ú	! "
Empty
Ú	Ú	" '
;
Ú	Ú	' (
}
Û	Û	 
return
Ü	Ü	 
a
Ü	Ü	 
.
Ü	Ü	 
Value
Ü	Ü	 
;
Ü	Ü	 
}
İ	İ	 
catch
Ş	Ş	 
(
Ş	Ş	 
	Exception
Ş	Ş	 
ex
Ş	Ş	 
)
Ş	Ş	  
{
ß	ß	 
FDebug
à	à	 
.
à	à	 
throwException
à	à	 %
(
à	à	% &
ex
à	à	& (
)
à	à	( )
;
à	à	) *
}
á	á	 
finally
â	â	 
{
ã	ã	 

m_fXmlCore
ä	ä	 
.
ä	ä	 
set
ä	ä	 
(
ä	ä	 
)
ä	ä	  
;
ä	ä	  !
}
å	å	 
return
æ	æ	 
string
æ	æ	 
.
æ	æ	 
Empty
æ	æ	 
;
æ	æ	  
}
ç	ç	 	
public
ë	ë	 
string
ë	ë	 
get_elemVal
ë	ë	 !
(
ë	ë	! "
string
ì	ì	 
name
ì	ì	 
,
ì	ì	 
string
í	í	 
defaultValue
í	í	 
)
î	î	 
{
ï	ï	 	
XmlNode
ğ	ğ	 
x
ğ	ğ	 
=
ğ	ğ	 
null
ğ	ğ	 
;
ğ	ğ	 
XmlAttribute
ñ	ñ	 
a
ñ	ñ	 
=
ñ	ñ	 
null
ñ	ñ	 !
;
ñ	ñ	! "
try
ó	ó	 
{
ô	ô	 

m_fXmlCore
õ	õ	 
.
õ	õ	 
wait
õ	õ	 
(
õ	õ	  
)
õ	õ	  !
;
õ	õ	! "
x
÷	÷	 
=
÷	÷	 
	m_xmlNode
÷	÷	 
.
÷	÷	 
SelectSingleNode
÷	÷	 .
(
÷	÷	. /
name
÷	÷	/ 3
)
÷	÷	3 4
;
÷	÷	4 5
if
ø	ø	 
(
ø	ø	 
x
ø	ø	 
==
ø	ø	 
null
ø	ø	 
)
ø	ø	 
{
ù	ù	 
return
ú	ú	 
defaultValue
ú	ú	 '
;
ú	ú	' (
}
û	û	 
a
ı	ı	 
=
ı	ı	 
x
ı	ı	 
.
ı	ı	 

Attributes
ı	ı	  
[
ı	ı	  !
A_Value
ı	ı	! (
]
ı	ı	( )
;
ı	ı	) *
if
ş	ş	 
(
ş	ş	 
a
ş	ş	 
==
ş	ş	 
null
ş	ş	 
)
ş	ş	 
{
ÿ	ÿ	 
return
€
€
 
defaultValue
€
€
 '
;
€
€
' (
}


 
return
‚
‚
 
a
‚
‚
 
.
‚
‚
 
Value
‚
‚
 
;
‚
‚
 
}
ƒ
ƒ
 
catch
„
„
 
(
„
„
 
	Exception
„
„
 
ex
„
„
 
)
„
„
  
{
…
…
 
FDebug
†
†
 
.
†
†
 
throwException
†
†
 %
(
†
†
% &
ex
†
†
& (
)
†
†
( )
;
†
†
) *
}
‡
‡
 
finally
ˆ
ˆ
 
{
‰
‰
 

m_fXmlCore
Š
Š
 
.
Š
Š
 
set
Š
Š
 
(
Š
Š
 
)
Š
Š
  
;
Š
Š
  !
}
‹
‹
 
return
Œ
Œ
 
string
Œ
Œ
 
.
Œ
Œ
 
Empty
Œ
Œ
 
;
Œ
Œ
  
}


 	
public
‘
‘
 
FXmlNode
‘
‘
 
set_elemVal
‘
‘
 #
(
‘
‘
# $
string
’
’
 
name
’
’
 
,
’
’
 
string
“
“
 
value
“
“
 
)
”
”
 
{
•
•
 	
XmlNode
–
–
 
x
–
–
 
=
–
–
 
null
–
–
 
;
–
–
 
XmlAttribute
—
—
 
a
—
—
 
=
—
—
 
null
—
—
 !
;
—
—
! "
try
™
™
 
{
š
š
 

m_fXmlCore
›
›
 
.
›
›
 
wait
›
›
 
(
›
›
  
)
›
›
  !
;
›
›
! "
x


 
=


 
	m_xmlNode


 
.


 
SelectSingleNode


 .
(


. /
name


/ 3
)


3 4
;


4 5
if


 
(


 
x


 
==


 
null


 
)


 
{
Ÿ
Ÿ
 
x
 
 
 
=
 
 
 
	m_xmlNode
 
 
 !
.
 
 
! "
AppendChild
 
 
" -
(
 
 
- .
	m_xmlNode
 
 
. 7
.
 
 
7 8
OwnerDocument
 
 
8 E
.
 
 
E F

CreateNode
 
 
F P
(
 
 
P Q
XmlNodeType
 
 
Q \
.
 
 
\ ]
Element
 
 
] d
,
 
 
d e
name
 
 
f j
,
 
 
j k
string
 
 
l r
.
 
 
r s
Empty
 
 
s x
)
 
 
x y
)
 
 
y z
;
 
 
z {
}
¡
¡
 
a
£
£
 
=
£
£
 
x
£
£
 
.
£
£
 

Attributes
£
£
  
[
£
£
  !
A_Value
£
£
! (
]
£
£
( )
;
£
£
) *
if
¤
¤
 
(
¤
¤
 
a
¤
¤
 
==
¤
¤
 
null
¤
¤
 
)
¤
¤
 
{
¥
¥
 
a
¦
¦
 
=
¦
¦
 
x
¦
¦
 
.
¦
¦
 

Attributes
¦
¦
 $
.
¦
¦
$ %
Append
¦
¦
% +
(
¦
¦
+ ,
	m_xmlNode
¦
¦
, 5
.
¦
¦
5 6
OwnerDocument
¦
¦
6 C
.
¦
¦
C D
CreateAttribute
¦
¦
D S
(
¦
¦
S T
A_Value
¦
¦
T [
)
¦
¦
[ \
)
¦
¦
\ ]
;
¦
¦
] ^
}
§
§
 
a
©
©
 
.
©
©
 
Value
©
©
 
=
©
©
 
value
©
©
 
;
©
©
  
return
«
«
 
new
«
«
 
FXmlNode
«
«
 #
(
«
«
# $

m_fXmlCore
«
«
$ .
,
«
«
. /
x
«
«
0 1
)
«
«
1 2
;
«
«
2 3
}
¬
¬
 
catch
­
­
 
(
­
­
 
	Exception
­
­
 
ex
­
­
 
)
­
­
  
{
®
®
 
FDebug
¯
¯
 
.
¯
¯
 
throwException
¯
¯
 %
(
¯
¯
% &
ex
¯
¯
& (
)
¯
¯
( )
;
¯
¯
) *
}
°
°
 
finally
±
±
 
{
²
²
 

m_fXmlCore
³
³
 
.
³
³
 
set
³
³
 
(
³
³
 
)
³
³
  
;
³
³
  !
}
´
´
 
return
µ
µ
 
null
µ
µ
 
;
µ
µ
 
}
¶
¶
 	
public
º
º
 
FXmlNode
º
º
 
set_elemVal
º
º
 #
(
º
º
# $
string
»
»
 
name
»
»
 
,
»
»
 
string
¼
¼
 
defaultValue
¼
¼
 
,
¼
¼
  
string
½
½
 
value
½
½
 
)
¾
¾
 
{
¿
¿
 	
XmlNode
À
À
 
x
À
À
 
=
À
À
 
null
À
À
 
;
À
À
 
XmlAttribute
Á
Á
 
a
Á
Á
 
=
Á
Á
 
null
Á
Á
 !
;
Á
Á
! "
try
Ã
Ã
 
{
Ä
Ä
 

m_fXmlCore
Å
Å
 
.
Å
Å
 
wait
Å
Å
 
(
Å
Å
  
)
Å
Å
  !
;
Å
Å
! "
x
Ç
Ç
 
=
Ç
Ç
 
	m_xmlNode
Ç
Ç
 
.
Ç
Ç
 
SelectSingleNode
Ç
Ç
 .
(
Ç
Ç
. /
name
Ç
Ç
/ 3
)
Ç
Ç
3 4
;
Ç
Ç
4 5
if
È
È
 
(
È
È
 
x
È
È
 
==
È
È
 
null
È
È
 
)
È
È
 
{
É
É
 
x
Ê
Ê
 
=
Ê
Ê
 
	m_xmlNode
Ê
Ê
 !
.
Ê
Ê
! "
AppendChild
Ê
Ê
" -
(
Ê
Ê
- .
	m_xmlNode
Ê
Ê
. 7
.
Ê
Ê
7 8
OwnerDocument
Ê
Ê
8 E
.
Ê
Ê
E F

CreateNode
Ê
Ê
F P
(
Ê
Ê
P Q
XmlNodeType
Ê
Ê
Q \
.
Ê
Ê
\ ]
Element
Ê
Ê
] d
,
Ê
Ê
d e
name
Ê
Ê
f j
,
Ê
Ê
j k
string
Ê
Ê
l r
.
Ê
Ê
r s
Empty
Ê
Ê
s x
)
Ê
Ê
x y
)
Ê
Ê
y z
;
Ê
Ê
z {
}
Ë
Ë
 
a
Í
Í
 
=
Í
Í
 
x
Í
Í
 
.
Í
Í
 

Attributes
Í
Í
  
[
Í
Í
  !
A_Value
Í
Í
! (
]
Í
Í
( )
;
Í
Í
) *
if
Î
Î
 
(
Î
Î
 
a
Î
Î
 
==
Î
Î
 
null
Î
Î
 
)
Î
Î
 
{
Ï
Ï
 
if
Ğ
Ğ
 
(
Ğ
Ğ
 
value
Ğ
Ğ
 
!=
Ğ
Ğ
  
defaultValue
Ğ
Ğ
! -
)
Ğ
Ğ
- .
{
Ñ
Ñ
 
x
Ò
Ò
 
.
Ò
Ò
 

Attributes
Ò
Ò
 $
.
Ò
Ò
$ %
Append
Ò
Ò
% +
(
Ò
Ò
+ ,
	m_xmlNode
Ò
Ò
, 5
.
Ò
Ò
5 6
OwnerDocument
Ò
Ò
6 C
.
Ò
Ò
C D
CreateAttribute
Ò
Ò
D S
(
Ò
Ò
S T
A_Value
Ò
Ò
T [
)
Ò
Ò
[ \
)
Ò
Ò
\ ]
.
Ò
Ò
] ^
Value
Ò
Ò
^ c
=
Ò
Ò
d e
value
Ò
Ò
f k
;
Ò
Ò
k l
}
Ó
Ó
 
}
Ô
Ô
 
else
Õ
Õ
 
{
Ö
Ö
 
if
×
×
 
(
×
×
 
value
×
×
 
==
×
×
  
defaultValue
×
×
! -
)
×
×
- .
{
Ø
Ø
 
x
Ù
Ù
 
.
Ù
Ù
 

Attributes
Ù
Ù
 $
.
Ù
Ù
$ %
Remove
Ù
Ù
% +
(
Ù
Ù
+ ,
a
Ù
Ù
, -
)
Ù
Ù
- .
;
Ù
Ù
. /
}
Ú
Ú
 
else
Û
Û
 
{
Ü
Ü
 
a
İ
İ
 
.
İ
İ
 
Value
İ
İ
 
=
İ
İ
  !
value
İ
İ
" '
;
İ
İ
' (
}
Ş
Ş
 
}
ß
ß
 
return
á
á
 
new
á
á
 
FXmlNode
á
á
 #
(
á
á
# $

m_fXmlCore
á
á
$ .
,
á
á
. /
x
á
á
0 1
)
á
á
1 2
;
á
á
2 3
}
â
â
 
catch
ã
ã
 
(
ã
ã
 
	Exception
ã
ã
 
ex
ã
ã
 
)
ã
ã
  
{
ä
ä
 
FDebug
å
å
 
.
å
å
 
throwException
å
å
 %
(
å
å
% &
ex
å
å
& (
)
å
å
( )
;
å
å
) *
}
æ
æ
 
finally
ç
ç
 
{
è
è
 

m_fXmlCore
é
é
 
.
é
é
 
set
é
é
 
(
é
é
 
)
é
é
  
;
é
é
  !
}
ê
ê
 
return
ë
ë
 
null
ë
ë
 
;
ë
ë
 
}
ì
ì
 	
public
ğ
ğ
 
FXmlNode
ğ
ğ
 
add_elem
ğ
ğ
  
(
ğ
ğ
  !
string
ñ
ñ
 
name
ñ
ñ
 
)
ò
ò
 
{
ó
ó
 	
try
ô
ô
 
{
õ
õ
 

m_fXmlCore
ö
ö
 
.
ö
ö
 
wait
ö
ö
 
(
ö
ö
  
)
ö
ö
  !
;
ö
ö
! "
return
ø
ø
 
new
ø
ø
 
FXmlNode
ø
ø
 #
(
ø
ø
# $

m_fXmlCore
ù
ù
 
,
ù
ù
 
	m_xmlNode
ú
ú
 
.
ú
ú
 
AppendChild
ú
ú
 )
(
ú
ú
) *
	m_xmlNode
ú
ú
* 3
.
ú
ú
3 4
OwnerDocument
ú
ú
4 A
.
ú
ú
A B

CreateNode
ú
ú
B L
(
ú
ú
L M
XmlNodeType
ú
ú
M X
.
ú
ú
X Y
Element
ú
ú
Y `
,
ú
ú
` a
name
ú
ú
b f
,
ú
ú
f g
string
ú
ú
h n
.
ú
ú
n o
Empty
ú
ú
o t
)
ú
ú
t u
)
ú
ú
u v
)
û
û
 
;
û
û
 
}
ü
ü
 
catch
ı
ı
 
(
ı
ı
 
	Exception
ı
ı
 
ex
ı
ı
 
)
ı
ı
  
{
ş
ş
 
FDebug
ÿ
ÿ
 
.
ÿ
ÿ
 
throwException
ÿ
ÿ
 %
(
ÿ
ÿ
% &
ex
ÿ
ÿ
& (
)
ÿ
ÿ
( )
;
ÿ
ÿ
) *
}
€€ 
finally
 
{
‚‚ 

m_fXmlCore
ƒƒ 
.
ƒƒ 
set
ƒƒ 
(
ƒƒ 
)
ƒƒ  
;
ƒƒ  !
}
„„ 
return
…… 
null
…… 
;
…… 
}
†† 	
public
ŠŠ 
FXmlNode
ŠŠ 
add_elemVal
ŠŠ #
(
ŠŠ# $
string
‹‹ 
name
‹‹ 
,
‹‹ 
string
ŒŒ 
value
ŒŒ 
)
 
{
 	
XmlNode
 
x
 
=
 
null
 
;
 
try
‘‘ 
{
’’ 

m_fXmlCore
““ 
.
““ 
wait
““ 
(
““  
)
““  !
;
““! "
x
•• 
=
•• 
	m_xmlNode
•• 
.
•• 
AppendChild
•• )
(
••) *
	m_xmlNode
••* 3
.
••3 4
OwnerDocument
••4 A
.
••A B

CreateNode
••B L
(
••L M
XmlNodeType
••M X
.
••X Y
Element
••Y `
,
••` a
name
••b f
,
••f g
string
••h n
.
••n o
Empty
••o t
)
••t u
)
••u v
;
••v w
x
–– 
.
–– 

Attributes
–– 
.
–– 
Append
–– #
(
––# $
	m_xmlNode
––$ -
.
––- .
OwnerDocument
––. ;
.
––; <
CreateAttribute
––< K
(
––K L
A_Value
––L S
)
––S T
)
––T U
.
––U V
Value
––V [
=
––\ ]
value
––^ c
;
––c d
return
˜˜ 
new
˜˜ 
FXmlNode
˜˜ #
(
˜˜# $

m_fXmlCore
˜˜$ .
,
˜˜. /
x
˜˜0 1
)
˜˜1 2
;
˜˜2 3
}
™™ 
catch
šš 
(
šš 
	Exception
šš 
ex
šš 
)
šš  
{
›› 
FDebug
œœ 
.
œœ 
throwException
œœ %
(
œœ% &
ex
œœ& (
)
œœ( )
;
œœ) *
}
 
finally
 
{
ŸŸ 

m_fXmlCore
   
.
   
set
   
(
   
)
    
;
    !
}
¡¡ 
return
¢¢ 
null
¢¢ 
;
¢¢ 
}
££ 	
public
§§ 
FXmlNode
§§ 
add_elemVal
§§ #
(
§§# $
string
¨¨ 
name
¨¨ 
,
¨¨ 
string
©© 
defaultValue
©© 
,
©©  
string
ªª 
value
ªª 
)
«« 
{
¬¬ 	
XmlNode
­­ 
x
­­ 
=
­­ 
null
­­ 
;
­­ 
try
¯¯ 
{
°° 

m_fXmlCore
±± 
.
±± 
wait
±± 
(
±±  
)
±±  !
;
±±! "
x
³³ 
=
³³ 
	m_xmlNode
³³ 
.
³³ 
AppendChild
³³ )
(
³³) *
	m_xmlNode
³³* 3
.
³³3 4
OwnerDocument
³³4 A
.
³³A B

CreateNode
³³B L
(
³³L M
XmlNodeType
³³M X
.
³³X Y
Element
³³Y `
,
³³` a
name
³³b f
,
³³f g
string
³³h n
.
³³n o
Empty
³³o t
)
³³t u
)
³³u v
;
³³v w
if
´´ 
(
´´ 
value
´´ 
!=
´´ 
defaultValue
´´ )
)
´´) *
{
µµ 
x
¶¶ 
.
¶¶ 

Attributes
¶¶  
.
¶¶  !
Append
¶¶! '
(
¶¶' (
	m_xmlNode
¶¶( 1
.
¶¶1 2
OwnerDocument
¶¶2 ?
.
¶¶? @
CreateAttribute
¶¶@ O
(
¶¶O P
A_Value
¶¶P W
)
¶¶W X
)
¶¶X Y
.
¶¶Y Z
Value
¶¶Z _
=
¶¶` a
value
¶¶b g
;
¶¶g h
}
·· 
return
¹¹ 
new
¹¹ 
FXmlNode
¹¹ #
(
¹¹# $

m_fXmlCore
¹¹$ .
,
¹¹. /
x
¹¹0 1
)
¹¹1 2
;
¹¹2 3
}
ºº 
catch
»» 
(
»» 
	Exception
»» 
ex
»» 
)
»»  
{
¼¼ 
FDebug
½½ 
.
½½ 
throwException
½½ %
(
½½% &
ex
½½& (
)
½½( )
;
½½) *
}
¾¾ 
finally
¿¿ 
{
ÀÀ 

m_fXmlCore
ÁÁ 
.
ÁÁ 
set
ÁÁ 
(
ÁÁ 
)
ÁÁ  
;
ÁÁ  !
}
ÂÂ 
return
ÃÃ 
null
ÃÃ 
;
ÃÃ 
}
ÄÄ 	
public
ÈÈ 
bool
ÈÈ 
containElem
ÈÈ 
(
ÈÈ  
string
ÉÉ 
name
ÉÉ 
)
ÊÊ 
{
ËË 	
try
ÌÌ 
{
ÍÍ 

m_fXmlCore
ÎÎ 
.
ÎÎ 
wait
ÎÎ 
(
ÎÎ  
)
ÎÎ  !
;
ÎÎ! "
if
ĞĞ 
(
ĞĞ 
	m_xmlNode
ĞĞ 
.
ĞĞ 
SelectSingleNode
ĞĞ .
(
ĞĞ. /
name
ĞĞ/ 3
)
ĞĞ3 4
==
ĞĞ5 7
null
ĞĞ8 <
)
ĞĞ< =
{
ÑÑ 
return
ÒÒ 
false
ÒÒ  
;
ÒÒ  !
}
ÓÓ 
return
ÔÔ 
true
ÔÔ 
;
ÔÔ 
}
ÕÕ 
catch
ÖÖ 
(
ÖÖ 
	Exception
ÖÖ 
ex
ÖÖ 
)
ÖÖ  
{
×× 
FDebug
ØØ 
.
ØØ 
throwException
ØØ %
(
ØØ% &
ex
ØØ& (
)
ØØ( )
;
ØØ) *
}
ÙÙ 
finally
ÚÚ 
{
ÛÛ 

m_fXmlCore
ÜÜ 
.
ÜÜ 
set
ÜÜ 
(
ÜÜ 
)
ÜÜ  
;
ÜÜ  !
}
İİ 
return
ŞŞ 
false
ŞŞ 
;
ŞŞ 
}
ßß 	
public
ãã 
bool
ãã 
containElemVal
ãã "
(
ãã" #
string
ää 
name
ää 
)
åå 
{
ææ 	
XmlNode
çç 
x
çç 
=
çç 
null
çç 
;
çç 
try
éé 
{
êê 

m_fXmlCore
ëë 
.
ëë 
wait
ëë 
(
ëë  
)
ëë  !
;
ëë! "
x
íí 
=
íí 
	m_xmlNode
íí 
.
íí 
SelectSingleNode
íí .
(
íí. /
name
íí/ 3
)
íí3 4
;
íí4 5
if
îî 
(
îî 
x
îî 
==
îî 
null
îî 
)
îî 
{
ïï 
return
ğğ 
false
ğğ  
;
ğğ  !
}
ññ 
if
óó 
(
óó 
x
óó 
.
óó 

Attributes
óó  
[
óó  !
A_Value
óó! (
]
óó( )
==
óó* ,
null
óó- 1
)
óó1 2
{
ôô 
return
õõ 
false
õõ  
;
õõ  !
}
öö 
return
÷÷ 
true
÷÷ 
;
÷÷ 
}
øø 
catch
ùù 
(
ùù 
	Exception
ùù 
ex
ùù 
)
ùù  
{
úú 
FDebug
ûû 
.
ûû 
throwException
ûû %
(
ûû% &
ex
ûû& (
)
ûû( )
;
ûû) *
}
üü 
finally
ıı 
{
şş 

m_fXmlCore
ÿÿ 
.
ÿÿ 
set
ÿÿ 
(
ÿÿ 
)
ÿÿ  
;
ÿÿ  !
}
€€ 
return
 
false
 
;
 
}
‚‚ 	
public
†† 
string
†† 
get_val
†† 
(
†† 
)
‡‡ 
{
ˆˆ 	
XmlAttribute
‰‰ 
a
‰‰ 
=
‰‰ 
null
‰‰ !
;
‰‰! "
try
‹‹ 
{
ŒŒ 

m_fXmlCore
 
.
 
wait
 
(
  
)
  !
;
! "
a
 
=
 
	m_xmlNode
 
.
 

Attributes
 (
[
( )
A_Value
) 0
]
0 1
;
1 2
if
 
(
 
a
 
==
 
null
 
)
 
{
‘‘ 
return
’’ 
string
’’ !
.
’’! "
Empty
’’" '
;
’’' (
}
““ 
return
”” 
a
”” 
.
”” 
Value
”” 
;
”” 
}
•• 
catch
–– 
(
–– 
	Exception
–– 
ex
–– 
)
––  
{
—— 
FDebug
˜˜ 
.
˜˜ 
throwException
˜˜ %
(
˜˜% &
ex
˜˜& (
)
˜˜( )
;
˜˜) *
}
™™ 
finally
šš 
{
›› 

m_fXmlCore
œœ 
.
œœ 
set
œœ 
(
œœ 
)
œœ  
;
œœ  !
}
 
return
 
string
 
.
 
Empty
 
;
  
}
ŸŸ 	
public
££ 
string
££ 
get_val
££ 
(
££ 
string
¤¤ 
defaultValue
¤¤ 
)
¥¥ 
{
¦¦ 	
XmlAttribute
§§ 
a
§§ 
=
§§ 
null
§§ !
;
§§! "
try
©© 
{
ªª 

m_fXmlCore
«« 
.
«« 
wait
«« 
(
««  
)
««  !
;
««! "
a
­­ 
=
­­ 
	m_xmlNode
­­ 
.
­­ 

Attributes
­­ (
[
­­( )
A_Value
­­) 0
]
­­0 1
;
­­1 2
if
®® 
(
®® 
a
®® 
==
®® 
null
®® 
)
®® 
{
¯¯ 
return
°° 
defaultValue
°° '
;
°°' (
}
±± 
return
²² 
a
²² 
.
²² 
Value
²² 
;
²² 
}
³³ 
catch
´´ 
(
´´ 
	Exception
´´ 
ex
´´ 
)
´´  
{
µµ 
FDebug
¶¶ 
.
¶¶ 
throwException
¶¶ %
(
¶¶% &
ex
¶¶& (
)
¶¶( )
;
¶¶) *
}
·· 
finally
¸¸ 
{
¹¹ 

m_fXmlCore
ºº 
.
ºº 
set
ºº 
(
ºº 
)
ºº  
;
ºº  !
}
»» 
return
¼¼ 
string
¼¼ 
.
¼¼ 
Empty
¼¼ 
;
¼¼  
}
½½ 	
public
ÁÁ 
void
ÁÁ 
set_val
ÁÁ 
(
ÁÁ 
string
ÂÂ 
value
ÂÂ 
)
ÃÃ 
{
ÄÄ 	
XmlAttribute
ÅÅ 
a
ÅÅ 
=
ÅÅ 
null
ÅÅ !
;
ÅÅ! "
try
ÇÇ 
{
ÈÈ 

m_fXmlCore
ÉÉ 
.
ÉÉ 
wait
ÉÉ 
(
ÉÉ  
)
ÉÉ  !
;
ÉÉ! "
a
ËË 
=
ËË 
	m_xmlNode
ËË 
.
ËË 

Attributes
ËË (
[
ËË( )
A_Value
ËË) 0
]
ËË0 1
;
ËË1 2
if
ÌÌ 
(
ÌÌ 
a
ÌÌ 
==
ÌÌ 
null
ÌÌ 
)
ÌÌ 
{
ÍÍ 
a
ÎÎ 
=
ÎÎ 
	m_xmlNode
ÎÎ !
.
ÎÎ! "

Attributes
ÎÎ" ,
.
ÎÎ, -
Append
ÎÎ- 3
(
ÎÎ3 4
	m_xmlNode
ÎÎ4 =
.
ÎÎ= >
OwnerDocument
ÎÎ> K
.
ÎÎK L
CreateAttribute
ÎÎL [
(
ÎÎ[ \
A_Value
ÎÎ\ c
)
ÎÎc d
)
ÎÎd e
;
ÎÎe f
}
ÏÏ 
a
ĞĞ 
.
ĞĞ 
Value
ĞĞ 
=
ĞĞ 
value
ĞĞ 
;
ĞĞ  
}
ÑÑ 
catch
ÒÒ 
(
ÒÒ 
	Exception
ÒÒ 
ex
ÒÒ 
)
ÒÒ  
{
ÓÓ 
FDebug
ÔÔ 
.
ÔÔ 
throwException
ÔÔ %
(
ÔÔ% &
ex
ÔÔ& (
)
ÔÔ( )
;
ÔÔ) *
}
ÕÕ 
finally
ÖÖ 
{
×× 

m_fXmlCore
ØØ 
.
ØØ 
set
ØØ 
(
ØØ 
)
ØØ  
;
ØØ  !
}
ÙÙ 
}
ÚÚ 	
public
ŞŞ 
void
ŞŞ 
set_val
ŞŞ 
(
ŞŞ 
string
ßß 
defaultValue
ßß 
,
ßß  
string
àà 
value
àà 
)
áá 
{
ââ 	
XmlAttribute
ãã 
a
ãã 
=
ãã 
null
ãã !
;
ãã! "
try
åå 
{
ææ 

m_fXmlCore
çç 
.
çç 
wait
çç 
(
çç  
)
çç  !
;
çç! "
a
éé 
=
éé 
	m_xmlNode
éé 
.
éé 

Attributes
éé (
[
éé( )
A_Value
éé) 0
]
éé0 1
;
éé1 2
if
êê 
(
êê 
a
êê 
==
êê 
null
êê 
)
êê 
{
ëë 
if
ìì 
(
ìì 
value
ìì 
!=
ìì  
defaultValue
ìì! -
)
ìì- .
{
íí 
	m_xmlNode
îî !
.
îî! "

Attributes
îî" ,
.
îî, -
Append
îî- 3
(
îî3 4
	m_xmlNode
îî4 =
.
îî= >
OwnerDocument
îî> K
.
îîK L
CreateAttribute
îîL [
(
îî[ \
A_Value
îî\ c
)
îîc d
)
îîd e
.
îîe f
Value
îîf k
=
îîl m
value
îîn s
;
îîs t
}
ïï 
}
ğğ 
else
ññ 
{
òò 
if
óó 
(
óó 
value
óó 
==
óó  
defaultValue
óó! -
)
óó- .
{
ôô 
	m_xmlNode
õõ !
.
õõ! "

Attributes
õõ" ,
.
õõ, -
Remove
õõ- 3
(
õõ3 4
a
õõ4 5
)
õõ5 6
;
õõ6 7
}
öö 
else
÷÷ 
{
øø 
a
ùù 
.
ùù 
Value
ùù 
=
ùù  !
value
ùù" '
;
ùù' (
}
úú 
}
ûû 
}
üü 
catch
ıı 
(
ıı 
	Exception
ıı 
ex
ıı 
)
ıı  
{
şş 
FDebug
ÿÿ 
.
ÿÿ 
throwException
ÿÿ %
(
ÿÿ% &
ex
ÿÿ& (
)
ÿÿ( )
;
ÿÿ) *
}
€€ 
finally
 
{
‚‚ 

m_fXmlCore
ƒƒ 
.
ƒƒ 
set
ƒƒ 
(
ƒƒ 
)
ƒƒ  
;
ƒƒ  !
}
„„ 
}
…… 	
public
‰‰ 
bool
‰‰ 

containVal
‰‰ 
(
‰‰ 
)
ŠŠ 
{
‹‹ 	
try
ŒŒ 
{
 

m_fXmlCore
 
.
 
wait
 
(
  
)
  !
;
! "
if
 
(
 
	m_xmlNode
 
.
 

Attributes
 (
[
( )
A_Value
) 0
]
0 1
==
2 4
null
5 9
)
9 :
{
‘‘ 
return
’’ 
false
’’  
;
’’  !
}
““ 
return
”” 
true
”” 
;
”” 
}
•• 
catch
–– 
(
–– 
	Exception
–– 
ex
–– 
)
––  
{
—— 
FDebug
˜˜ 
.
˜˜ 
throwException
˜˜ %
(
˜˜% &
ex
˜˜& (
)
˜˜( )
;
˜˜) *
}
™™ 
finally
šš 
{
›› 

m_fXmlCore
œœ 
.
œœ 
set
œœ 
(
œœ 
)
œœ  
;
œœ  !
}
 
return
 
false
 
;
 
}
ŸŸ 	
public
££ 
int
££ 
getIndex
££ 
(
££ 
bool
¤¤ 
isError
¤¤ 
)
¥¥ 
{
¦¦ 	
int
§§ 
index
§§ 
=
§§ 
-
§§ 
$num
§§ 
;
§§ 
try
©© 
{
ªª 

m_fXmlCore
«« 
.
«« 
wait
«« 
(
««  
)
««  !
;
««! "
if
­­ 
(
­­ 
	m_xmlNode
­­ 
.
­­ 

ParentNode
­­ (
!=
­­) +
null
­­, 0
)
­­0 1
{
®® 
for
¯¯ 
(
¯¯ 
int
¯¯ 
i
¯¯ 
=
¯¯  
$num
¯¯! "
;
¯¯" #
i
¯¯$ %
<
¯¯& '
	m_xmlNode
¯¯( 1
.
¯¯1 2

ParentNode
¯¯2 <
.
¯¯< =

ChildNodes
¯¯= G
.
¯¯G H
Count
¯¯H M
;
¯¯M N
i
¯¯O P
++
¯¯P R
)
¯¯R S
{
°° 
if
±± 
(
±± 
	m_xmlNode
±± %
==
±±& (
	m_xmlNode
±±) 2
.
±±2 3

ParentNode
±±3 =
.
±±= >

ChildNodes
±±> H
[
±±H I
i
±±I J
]
±±J K
)
±±K L
{
²² 
index
³³ !
=
³³" #
i
³³$ %
;
³³% &
break
´´ !
;
´´! "
}
µµ 
}
¶¶ 
}
·· 
if
¹¹ 
(
¹¹ 
isError
¹¹ 
&&
¹¹ 
index
¹¹ $
==
¹¹% '
-
¹¹( )
$num
¹¹) *
)
¹¹* +
{
ºº 
FDebug
»» 
.
»» 
throwFException
»» *
(
»»* +
string
»»+ 1
.
»»1 2
Format
»»2 8
(
»»8 9

FConstants
»»9 C
.
»»C D

err_m_0003
»»D N
,
»»N O
$str
»»P X
)
»»X Y
)
»»Y Z
;
»»Z [
}
¼¼ 
return
½½ 
index
½½ 
;
½½ 
}
¾¾ 
catch
¿¿ 
(
¿¿ 
	Exception
¿¿ 
ex
¿¿ 
)
¿¿  
{
ÀÀ 
FDebug
ÁÁ 
.
ÁÁ 
throwException
ÁÁ %
(
ÁÁ% &
ex
ÁÁ& (
)
ÁÁ( )
;
ÁÁ) *
}
ÂÂ 
finally
ÃÃ 
{
ÄÄ 

m_fXmlCore
ÅÅ 
.
ÅÅ 
set
ÅÅ 
(
ÅÅ 
)
ÅÅ  
;
ÅÅ  !
}
ÆÆ 
return
ÇÇ 
$num
ÇÇ 
;
ÇÇ 
}
ÈÈ 	
private
ÌÌ 
void
ÌÌ 
onXmlNodeModified
ÌÌ &
(
ÌÌ& '
)
ÍÍ 
{
ÎÎ 	
try
ÏÏ 
{
ĞĞ 
if
ÑÑ 
(
ÑÑ 
XmlNodeModified
ÑÑ #
!=
ÑÑ$ &
null
ÑÑ' +
)
ÑÑ+ ,
{
ÒÒ 
XmlNodeModified
ÓÓ #
(
ÓÓ# $
this
ÓÓ$ (
,
ÓÓ( )
new
ÓÓ* -'
FXmlNodeModifiedEventArgs
ÓÓ. G
(
ÓÓG H
this
ÓÓH L
)
ÓÓL M
)
ÓÓM N
;
ÓÓN O
}
ÔÔ 
}
ÕÕ 
catch
ÖÖ 
(
ÖÖ 
	Exception
ÖÖ 
ex
ÖÖ 
)
ÖÖ  
{
×× 
FDebug
ØØ 
.
ØØ 
throwException
ØØ %
(
ØØ% &
ex
ØØ& (
)
ØØ( )
;
ØØ) *
}
ÙÙ 
finally
ÚÚ 
{
ÛÛ 
}
İİ 
}
ŞŞ 	
public
ææ 
override
ææ 
int
ææ 
GetHashCode
ææ '
(
ææ' (
)
çç 
{
èè 	
try
éé 
{
êê 
return
ëë 
base
ëë 
.
ëë 
GetHashCode
ëë '
(
ëë' (
)
ëë( )
;
ëë) *
}
ìì 
catch
íí 
(
íí 
	Exception
íí 
ex
íí 
)
íí  
{
îî 
FDebug
ïï 
.
ïï 
throwException
ïï %
(
ïï% &
ex
ïï& (
)
ïï( )
;
ïï) *
}
ğğ 
finally
ññ 
{
òò 
}
ôô 
return
õõ 
$num
õõ 
;
õõ 
}
öö 	
public
úú 
override
úú 
bool
úú 
Equals
úú #
(
úú# $
object
ûû 
obj
ûû 
)
üü 
{
ıı 	
try
şş 
{
ÿÿ 
if
€€ 
(
€€ 
obj
€€ 
==
€€ 
null
€€ 
||
€€  "
!
€€# $
(
€€$ %
obj
€€% (
is
€€) +
FXmlNode
€€, 4
)
€€4 5
)
€€5 6
{
 
return
‚‚ 
false
‚‚  
;
‚‚  !
}
ƒƒ 
return
…… 
	m_xmlNode
……  
.
……  !
Equals
……! '
(
……' (
(
†† 
(
†† 
FXmlNode
†† 
)
†† 
obj
†† "
)
††" #
.
††# $
baseXml
††$ +
)
‡‡ 
;
‡‡ 
}
ˆˆ 
catch
‰‰ 
(
‰‰ 
	Exception
‰‰ 
ex
‰‰ 
)
‰‰  
{
ŠŠ 
FDebug
‹‹ 
.
‹‹ 
throwException
‹‹ %
(
‹‹% &
ex
‹‹& (
)
‹‹( )
;
‹‹) *
}
ŒŒ 
finally
 
{
 
}
 
return
‘‘ 
false
‘‘ 
;
‘‘ 
}
’’ 	
public
–– 
static
–– 
bool
–– 
operator
–– #
==
––$ &
(
––& '
FXmlNode
—— 
lhs
—— 
,
—— 
FXmlNode
˜˜ 
rhs
˜˜ 
)
™™ 
{
šš 	
try
›› 
{
œœ 
if
 
(
 
(
 
object
 
)
 
lhs
 
==
  "
null
# '
)
' (
{
 
return
ŸŸ 
(
ŸŸ 
(
ŸŸ 
object
ŸŸ #
)
ŸŸ# $
rhs
ŸŸ$ '
==
ŸŸ( *
null
ŸŸ+ /
?
ŸŸ0 1
true
ŸŸ2 6
:
ŸŸ7 8
false
ŸŸ9 >
)
ŸŸ> ?
;
ŸŸ? @
}
   
return
¡¡ 
lhs
¡¡ 
.
¡¡ 
Equals
¡¡ !
(
¡¡! "
rhs
¡¡" %
)
¡¡% &
;
¡¡& '
}
¢¢ 
catch
££ 
(
££ 
	Exception
££ 
ex
££ 
)
££  
{
¤¤ 
FDebug
¥¥ 
.
¥¥ 
throwException
¥¥ %
(
¥¥% &
ex
¥¥& (
)
¥¥( )
;
¥¥) *
}
¦¦ 
finally
§§ 
{
¨¨ 
}
ªª 
return
«« 
false
«« 
;
«« 
}
¬¬ 	
public
°° 
static
°° 
bool
°° 
operator
°° #
!=
°°$ &
(
°°& '
FXmlNode
±± 
lhs
±± 
,
±± 
FXmlNode
²² 
rhs
²² 
)
³³ 
{
´´ 	
try
µµ 
{
¶¶ 
if
·· 
(
·· 
(
·· 
object
·· 
)
·· 
lhs
·· 
==
··  "
null
··# '
)
··' (
{
¸¸ 
return
¹¹ 
(
¹¹ 
(
¹¹ 
object
¹¹ #
)
¹¹# $
rhs
¹¹$ '
==
¹¹( *
null
¹¹+ /
?
¹¹0 1
false
¹¹2 7
:
¹¹8 9
true
¹¹: >
)
¹¹> ?
;
¹¹? @
}
ºº 
return
»» 
!
»» 
lhs
»» 
.
»» 
Equals
»» "
(
»»" #
rhs
»»# &
)
»»& '
;
»»' (
}
¼¼ 
catch
½½ 
(
½½ 
	Exception
½½ 
ex
½½ 
)
½½  
{
¾¾ 
FDebug
¿¿ 
.
¿¿ 
throwException
¿¿ %
(
¿¿% &
ex
¿¿& (
)
¿¿( )
;
¿¿) *
}
ÀÀ 
finally
ÁÁ 
{
ÂÂ 
}
ÄÄ 
return
ÅÅ 
false
ÅÅ 
;
ÅÅ 
}
ÆÆ 	
}
ÌÌ 
}ÍÍ ’P
[D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Xml\c_FXmlAttribute.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FXmlAttribute 
:  
IDisposable! ,
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FXmlCore 

m_fXmlCore #
=$ %
null& *
;* +
private 
XmlAttribute 
	m_xmlAttr &
=' (
null) -
;- .
internal## 
FXmlAttribute## 
(## 
FXmlCore$$ 
fXmlCore$$ 
,$$ 
XmlAttribute%% 
xmlAttr%%  
)&& 
{'' 	

m_fXmlCore(( 
=(( 
fXmlCore(( !
;((! "
	m_xmlAttr)) 
=)) 
xmlAttr)) 
;))  
}** 	
~.. 	
FXmlAttribute..	 
(.. 
)// 
{00 	
	myDispose11 
(11 
false11 
)11 
;11 
}22 	
	protected66 
void66 
	myDispose66  
(66  !
bool77 
	disposing77 
)88 
{99 	
if:: 
(:: 
!:: 

m_disposed:: 
):: 
{;; 
if<< 
(<< 
	disposing<< 
)<< 
{== 
	m_xmlAttr>> 
=>> 
null>>  $
;>>$ %
}?? 

m_disposedAA 
=AA 
trueAA !
;AA! "
}BB 
}CC 	
publicKK 
voidKK 
DisposeKK 
(KK 
)LL 
{MM 	
	myDisposeNN 
(NN 
trueNN 
)NN 
;NN 
GCOO 
.OO 
SuppressFinalizeOO 
(OO  
thisOO  $
)OO$ %
;OO% &
}PP 	
internalXX 
XmlAttributeXX 
baseXmlXX %
{YY 	
getZZ 
{[[ 
try\\ 
{]] 

m_fXmlCore^^ 
.^^ 
wait^^ #
(^^# $
)^^$ %
;^^% &
return__ 
	m_xmlAttr__ $
;__$ %
}`` 
catchaa 
(aa 
	Exceptionaa  
exaa! #
)aa# $
{bb 
FDebugcc 
.cc 
throwExceptioncc )
(cc) *
excc* ,
)cc, -
;cc- .
}dd 
finallyee 
{ff 

m_fXmlCoregg 
.gg 
setgg "
(gg" #
)gg# $
;gg$ %
}hh 
returnii 
nullii 
;ii 
}jj 
}kk 	
publicoo 
stringoo 
nameoo 
{pp 	
getqq 
{rr 
tryss 
{tt 

m_fXmlCoreuu 
.uu 
waituu #
(uu# $
)uu$ %
;uu% &
returnvv 
	m_xmlAttrvv $
.vv$ %
Namevv% )
;vv) *
}ww 
catchxx 
(xx 
	Exceptionxx  
exxx! #
)xx# $
{yy 
FDebugzz 
.zz 
throwExceptionzz )
(zz) *
exzz* ,
)zz, -
;zz- .
}{{ 
finally|| 
{}} 

m_fXmlCore~~ 
.~~ 
set~~ "
(~~" #
)~~# $
;~~$ %
} 
return
€€ 
string
€€ 
.
€€ 
Empty
€€ #
;
€€# $
}
 
}
‚‚ 	
public
†† 
string
†† 
value
†† 
{
‡‡ 	
get
ˆˆ 
{
‰‰ 
try
ŠŠ 
{
‹‹ 

m_fXmlCore
ŒŒ 
.
ŒŒ 
wait
ŒŒ #
(
ŒŒ# $
)
ŒŒ$ %
;
ŒŒ% &
return
 
	m_xmlAttr
 $
.
$ %
Value
% *
;
* +
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
‘‘ 
.
‘‘ 
throwException
‘‘ )
(
‘‘) *
ex
‘‘* ,
)
‘‘, -
;
‘‘- .
}
’’ 
finally
““ 
{
”” 

m_fXmlCore
•• 
.
•• 
set
•• "
(
••" #
)
••# $
;
••$ %
}
–– 
return
—— 
string
—— 
.
—— 
Empty
—— #
;
——# $
}
˜˜ 
set
šš 
{
›› 
try
œœ 
{
 

m_fXmlCore
 
.
 
wait
 #
(
# $
)
$ %
;
% &
	m_xmlAttr
ŸŸ 
.
ŸŸ 
Value
ŸŸ #
=
ŸŸ$ %
value
ŸŸ& +
;
ŸŸ+ ,
}
   
catch
¡¡ 
(
¡¡ 
	Exception
¡¡  
ex
¡¡! #
)
¡¡# $
{
¢¢ 
FDebug
££ 
.
££ 
throwException
££ )
(
££) *
ex
££* ,
)
££, -
;
££- .
}
¤¤ 
finally
¥¥ 
{
¦¦ 

m_fXmlCore
§§ 
.
§§ 
set
§§ "
(
§§" #
)
§§# $
;
§§$ %
}
¨¨ 
}
©© 
}
ªª 	
public
¸¸ 
override
¸¸ 
int
¸¸ 
GetHashCode
¸¸ '
(
¸¸' (
)
¹¹ 
{
ºº 	
try
»» 
{
¼¼ 
return
½½ 
base
½½ 
.
½½ 
GetHashCode
½½ '
(
½½' (
)
½½( )
;
½½) *
}
¾¾ 
catch
¿¿ 
(
¿¿ 
	Exception
¿¿ 
ex
¿¿ 
)
¿¿  
{
ÀÀ 
FDebug
ÁÁ 
.
ÁÁ 
throwException
ÁÁ %
(
ÁÁ% &
ex
ÁÁ& (
)
ÁÁ( )
;
ÁÁ) *
}
ÂÂ 
finally
ÃÃ 
{
ÄÄ 
}
ÆÆ 
return
ÇÇ 
$num
ÇÇ 
;
ÇÇ 
}
ÈÈ 	
public
ÌÌ 
override
ÌÌ 
bool
ÌÌ 
Equals
ÌÌ #
(
ÌÌ# $
object
ÍÍ 
obj
ÍÍ 
)
ÎÎ 
{
ÏÏ 	
try
ĞĞ 
{
ÑÑ 
if
ÒÒ 
(
ÒÒ 
obj
ÒÒ 
==
ÒÒ 
null
ÒÒ 
||
ÒÒ  "
!
ÒÒ# $
(
ÒÒ$ %
obj
ÒÒ% (
is
ÒÒ) +
FXmlAttribute
ÒÒ, 9
)
ÒÒ9 :
)
ÒÒ: ;
{
ÓÓ 
return
ÔÔ 
false
ÔÔ  
;
ÔÔ  !
}
ÕÕ 
return
×× 
	m_xmlAttr
××  
.
××  !
Equals
××! '
(
××' (
(
ØØ 
(
ØØ 
FXmlAttribute
ØØ #
)
ØØ# $
obj
ØØ$ '
)
ØØ' (
.
ØØ( )
baseXml
ØØ) 0
)
ÙÙ 
;
ÙÙ 
}
ÚÚ 
catch
ÛÛ 
(
ÛÛ 
	Exception
ÛÛ 
ex
ÛÛ 
)
ÛÛ  
{
ÜÜ 
FDebug
İİ 
.
İİ 
throwException
İİ %
(
İİ% &
ex
İİ& (
)
İİ( )
;
İİ) *
}
ŞŞ 
finally
ßß 
{
àà 
}
ââ 
return
ãã 
false
ãã 
;
ãã 
}
ää 	
public
èè 
static
èè 
bool
èè 
operator
èè #
==
èè$ &
(
èè& '
FXmlAttribute
éé 
lhs
éé 
,
éé 
FXmlAttribute
êê 
rhs
êê 
)
ëë 
{
ìì 	
try
íí 
{
îî 
if
ïï 
(
ïï 
(
ïï 
object
ïï 
)
ïï 
lhs
ïï 
==
ïï  "
null
ïï# '
)
ïï' (
{
ğğ 
return
ññ 
(
ññ 
(
ññ 
object
ññ #
)
ññ# $
rhs
ññ$ '
==
ññ( *
null
ññ+ /
?
ññ0 1
true
ññ2 6
:
ññ7 8
false
ññ9 >
)
ññ> ?
;
ññ? @
}
òò 
return
óó 
lhs
óó 
.
óó 
Equals
óó !
(
óó! "
rhs
óó" %
)
óó% &
;
óó& '
}
ôô 
catch
õõ 
(
õõ 
	Exception
õõ 
ex
õõ 
)
õõ  
{
öö 
FDebug
÷÷ 
.
÷÷ 
throwException
÷÷ %
(
÷÷% &
ex
÷÷& (
)
÷÷( )
;
÷÷) *
}
øø 
finally
ùù 
{
úú 
}
üü 
return
ıı 
false
ıı 
;
ıı 
}
şş 	
public
‚‚ 
static
‚‚ 
bool
‚‚ 
operator
‚‚ #
!=
‚‚$ &
(
‚‚& '
FXmlAttribute
ƒƒ 
lhs
ƒƒ 
,
ƒƒ 
FXmlAttribute
„„ 
rhs
„„ 
)
…… 
{
†† 	
try
‡‡ 
{
ˆˆ 
if
‰‰ 
(
‰‰ 
(
‰‰ 
object
‰‰ 
)
‰‰ 
lhs
‰‰ 
==
‰‰  "
null
‰‰# '
)
‰‰' (
{
ŠŠ 
return
‹‹ 
(
‹‹ 
(
‹‹ 
object
‹‹ #
)
‹‹# $
rhs
‹‹$ '
==
‹‹( *
null
‹‹+ /
?
‹‹0 1
false
‹‹2 7
:
‹‹8 9
true
‹‹: >
)
‹‹> ?
;
‹‹? @
}
ŒŒ 
return
 
!
 
lhs
 
.
 
Equals
 "
(
" #
rhs
# &
)
& '
;
' (
}
 
catch
 
(
 
	Exception
 
ex
 
)
  
{
 
FDebug
‘‘ 
.
‘‘ 
throwException
‘‘ %
(
‘‘% &
ex
‘‘& (
)
‘‘( )
;
‘‘) *
}
’’ 
finally
““ 
{
”” 
}
–– 
return
—— 
false
—— 
;
—— 
}
˜˜ 	
}
 
}ŸŸ ­¿
eD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Xml\c_FXmlAttributeCollection.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class #
FXmlAttributeCollection (
:) *
IDisposable+ 6
,6 7
IEnumerable8 C
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FXmlCore 

m_fXmlCore #
=$ %
null& *
;* +
private "
XmlAttributeCollection &
m_xmlAttrCol' 3
=4 5
null6 :
;: ;
internal$$ #
FXmlAttributeCollection$$ (
($$( )
FXmlCore%% 
fXmlCore%% 
,%% "
XmlAttributeCollection&& "

xmlAttrCol&&# -
)'' 
{(( 	

m_fXmlCore)) 
=)) 
fXmlCore)) !
;))! "
m_xmlAttrCol** 
=** 

xmlAttrCol** %
;**% &
}++ 	
~// 	#
FXmlAttributeCollection//	  
(//  !
)00 
{11 	
	myDispose22 
(22 
false22 
)22 
;22 
}33 	
	protected77 
void77 
	myDispose77  
(77  !
bool88 
	disposing88 
)99 
{:: 	
if;; 
(;; 
!;; 

m_disposed;; 
);; 
{<< 
if== 
(== 
	disposing== 
)== 
{>> 
m_xmlAttrCol??  
=??! "
null??# '
;??' (
}@@ 

m_disposedBB 
=BB 
trueBB !
;BB! "
}CC 
}DD 	
publicLL 
voidLL 
DisposeLL 
(LL 
)MM 
{NN 	
	myDisposeOO 
(OO 
trueOO 
)OO 
;OO 
GCPP 
.PP 
SuppressFinalizePP 
(PP  
thisPP  $
)PP$ %
;PP% &
}QQ 	
publicYY 
IEnumeratorYY 
GetEnumeratorYY (
(YY( )
)ZZ 
{[[ 	
try\\ 
{]] 
return^^ 
new^^ -
!FXmlAttributeCollectionEnumerator^^ <
(^^< =
this^^= A
)^^A B
;^^B C
}__ 
catch`` 
(`` 
	Exception`` 
ex`` 
)``  
{aa 
FDebugbb 
.bb 
throwExceptionbb %
(bb% &
exbb& (
)bb( )
;bb) *
}cc 
finallydd 
{ee 
}gg 
returnhh 
nullhh 
;hh 
}ii 	
internalqq "
XmlAttributeCollectionqq '
baseXmlqq( /
{rr 	
getss 
{tt 
tryuu 
{vv 

m_fXmlCoreww 
.ww 
waitww #
(ww# $
)ww$ %
;ww% &
returnxx 
m_xmlAttrColxx '
;xx' (
}yy 
catchzz 
(zz 
	Exceptionzz  
exzz! #
)zz# $
{{{ 
FDebug|| 
.|| 
throwException|| )
(||) *
ex||* ,
)||, -
;||- .
}}} 
finally~~ 
{ 

m_fXmlCore
€€ 
.
€€ 
set
€€ "
(
€€" #
)
€€# $
;
€€$ %
}
 
return
‚‚ 
null
‚‚ 
;
‚‚ 
}
ƒƒ 
}
„„ 	
public
ˆˆ 
int
ˆˆ 
count
ˆˆ 
{
‰‰ 	
get
ŠŠ 
{
‹‹ 
try
ŒŒ 
{
 

m_fXmlCore
 
.
 
wait
 #
(
# $
)
$ %
;
% &
return
 
m_xmlAttrCol
 '
.
' (
Count
( -
;
- .
}
 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘  
ex
‘‘! #
)
‘‘# $
{
’’ 
FDebug
““ 
.
““ 
throwException
““ )
(
““) *
ex
““* ,
)
““, -
;
““- .
}
”” 
finally
•• 
{
–– 

m_fXmlCore
—— 
.
—— 
set
—— "
(
——" #
)
——# $
;
——$ %
}
˜˜ 
return
™™ 
$num
™™ 
;
™™ 
}
šš 
}
›› 	
public
ŸŸ 
FXmlAttribute
ŸŸ 
this
ŸŸ !
[
ŸŸ! "
int
ŸŸ" %
i
ŸŸ& '
]
ŸŸ' (
{
   	
get
¡¡ 
{
¢¢ 
XmlAttribute
££ 
xmlAttr
££ $
=
££% &
null
££' +
;
££+ ,
try
¥¥ 
{
¦¦ 

m_fXmlCore
§§ 
.
§§ 
wait
§§ #
(
§§# $
)
§§$ %
;
§§% &
xmlAttr
¨¨ 
=
¨¨ 
m_xmlAttrCol
¨¨ *
[
¨¨* +
i
¨¨+ ,
]
¨¨, -
;
¨¨- .
if
©© 
(
©© 
xmlAttr
©© 
==
©©  "
null
©©# '
)
©©' (
{
ªª 
return
«« 
null
«« #
;
««# $
}
¬¬ 
return
­­ 
new
­­ 
FXmlAttribute
­­ ,
(
­­, -

m_fXmlCore
­­- 7
,
­­7 8
xmlAttr
­­9 @
)
­­@ A
;
­­A B
}
®® 
catch
¯¯ 
(
¯¯ 
	Exception
¯¯  
ex
¯¯! #
)
¯¯# $
{
°° 
FDebug
±± 
.
±± 
throwException
±± )
(
±±) *
ex
±±* ,
)
±±, -
;
±±- .
}
²² 
finally
³³ 
{
´´ 

m_fXmlCore
µµ 
.
µµ 
set
µµ "
(
µµ" #
)
µµ# $
;
µµ$ %
}
¶¶ 
return
·· 
null
·· 
;
·· 
}
¸¸ 
}
¹¹ 	
public
½½ 
FXmlAttribute
½½ 
this
½½ !
[
½½! "
string
½½" (
name
½½) -
]
½½- .
{
¾¾ 	
get
¿¿ 
{
ÀÀ 
XmlAttribute
ÁÁ 
xmlAttr
ÁÁ $
=
ÁÁ% &
null
ÁÁ' +
;
ÁÁ+ ,
try
ÃÃ 
{
ÄÄ 

m_fXmlCore
ÅÅ 
.
ÅÅ 
wait
ÅÅ #
(
ÅÅ# $
)
ÅÅ$ %
;
ÅÅ% &
xmlAttr
ÆÆ 
=
ÆÆ 
m_xmlAttrCol
ÆÆ *
[
ÆÆ* +
name
ÆÆ+ /
]
ÆÆ/ 0
;
ÆÆ0 1
if
ÇÇ 
(
ÇÇ 
xmlAttr
ÇÇ 
==
ÇÇ  "
null
ÇÇ# '
)
ÇÇ' (
{
ÈÈ 
return
ÉÉ 
null
ÉÉ #
;
ÉÉ# $
}
ÊÊ 
return
ËË 
new
ËË 
FXmlAttribute
ËË ,
(
ËË, -

m_fXmlCore
ËË- 7
,
ËË7 8
xmlAttr
ËË9 @
)
ËË@ A
;
ËËA B
}
ÌÌ 
catch
ÍÍ 
(
ÍÍ 
	Exception
ÍÍ  
ex
ÍÍ! #
)
ÍÍ# $
{
ÎÎ 
FDebug
ÏÏ 
.
ÏÏ 
throwException
ÏÏ )
(
ÏÏ) *
ex
ÏÏ* ,
)
ÏÏ, -
;
ÏÏ- .
}
ĞĞ 
finally
ÑÑ 
{
ÒÒ 

m_fXmlCore
ÓÓ 
.
ÓÓ 
set
ÓÓ "
(
ÓÓ" #
)
ÓÓ# $
;
ÓÓ$ %
}
ÔÔ 
return
ÕÕ 
null
ÕÕ 
;
ÕÕ 
}
ÖÖ 
}
×× 	
public
ßß 
FXmlAttribute
ßß 
item
ßß !
(
ßß! "
int
àà 
index
àà 
)
áá 
{
ââ 	
XmlAttribute
ãã 
xmlAttr
ãã  
=
ãã! "
null
ãã# '
;
ãã' (
try
åå 
{
ææ 

m_fXmlCore
çç 
.
çç 
wait
çç 
(
çç  
)
çç  !
;
çç! "
xmlAttr
èè 
=
èè 
(
èè 
XmlAttribute
èè '
)
èè' (
m_xmlAttrCol
èè( 4
.
èè4 5
Item
èè5 9
(
èè9 :
index
èè: ?
)
èè? @
;
èè@ A
if
éé 
(
éé 
xmlAttr
éé 
==
éé 
null
éé #
)
éé# $
{
êê 
return
ëë 
null
ëë 
;
ëë  
}
ìì 
return
íí 
new
íí 
FXmlAttribute
íí (
(
íí( )

m_fXmlCore
íí) 3
,
íí3 4
xmlAttr
íí5 <
)
íí< =
;
íí= >
}
îî 
catch
ïï 
(
ïï 
	Exception
ïï 
ex
ïï 
)
ïï  
{
ğğ 
FDebug
ññ 
.
ññ 
throwException
ññ %
(
ññ% &
ex
ññ& (
)
ññ( )
;
ññ) *
}
òò 
finally
óó 
{
ôô 

m_fXmlCore
õõ 
.
õõ 
set
õõ 
(
õõ 
)
õõ  
;
õõ  !
}
öö 
return
÷÷ 
null
÷÷ 
;
÷÷ 
}
øø 	
public
üü 
FXmlAttribute
üü 
getNamedItem
üü )
(
üü) *
string
ıı 
name
ıı 
)
şş 
{
ÿÿ 	
XmlAttribute
€€ 
xmlAttr
€€  
=
€€! "
null
€€# '
;
€€' (
try
‚‚ 
{
ƒƒ 

m_fXmlCore
„„ 
.
„„ 
wait
„„ 
(
„„  
)
„„  !
;
„„! "
xmlAttr
…… 
=
…… 
(
…… 
XmlAttribute
…… '
)
……' (
m_xmlAttrCol
……( 4
.
……4 5
GetNamedItem
……5 A
(
……A B
name
……B F
)
……F G
;
……G H
if
†† 
(
†† 
xmlAttr
†† 
==
†† 
null
†† #
)
††# $
{
‡‡ 
return
ˆˆ 
null
ˆˆ 
;
ˆˆ  
}
‰‰ 
return
ŠŠ 
new
ŠŠ 
FXmlAttribute
ŠŠ (
(
ŠŠ( )

m_fXmlCore
ŠŠ) 3
,
ŠŠ3 4
xmlAttr
ŠŠ5 <
)
ŠŠ< =
;
ŠŠ= >
}
‹‹ 
catch
ŒŒ 
(
ŒŒ 
	Exception
ŒŒ 
ex
ŒŒ 
)
ŒŒ  
{
 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
 
{
‘‘ 

m_fXmlCore
’’ 
.
’’ 
set
’’ 
(
’’ 
)
’’  
;
’’  !
}
““ 
return
”” 
null
”” 
;
”” 
}
•• 	
public
™™ 
FXmlAttribute
™™ 
setNamedItem
™™ )
(
™™) *
FXmlAttribute
šš 
fXmlAttr
šš "
)
›› 
{
œœ 	
XmlAttribute
 
xmlAttr
  
=
! "
null
# '
;
' (
try
ŸŸ 
{
   

m_fXmlCore
¡¡ 
.
¡¡ 
wait
¡¡ 
(
¡¡  
)
¡¡  !
;
¡¡! "
xmlAttr
¢¢ 
=
¢¢ 
(
¢¢ 
XmlAttribute
¢¢ '
)
¢¢' (
m_xmlAttrCol
¢¢( 4
.
¢¢4 5
SetNamedItem
¢¢5 A
(
¢¢A B
fXmlAttr
¢¢B J
.
¢¢J K
baseXml
¢¢K R
)
¢¢R S
;
¢¢S T
if
££ 
(
££ 
xmlAttr
££ 
==
££ 
null
££ #
)
££# $
{
¤¤ 
return
¥¥ 
null
¥¥ 
;
¥¥  
}
¦¦ 
return
§§ 
new
§§ 
FXmlAttribute
§§ (
(
§§( )

m_fXmlCore
§§) 3
,
§§3 4
xmlAttr
§§5 <
)
§§< =
;
§§= >
}
¨¨ 
catch
©© 
(
©© 
	Exception
©© 
ex
©© 
)
©©  
{
ªª 
FDebug
«« 
.
«« 
throwException
«« %
(
««% &
ex
««& (
)
««( )
;
««) *
}
¬¬ 
finally
­­ 
{
®® 

m_fXmlCore
¯¯ 
.
¯¯ 
set
¯¯ 
(
¯¯ 
)
¯¯  
;
¯¯  !
}
°° 
return
±± 
null
±± 
;
±± 
}
²² 	
public
¶¶ 
FXmlAttribute
¶¶ 
removeNamedItem
¶¶ ,
(
¶¶, -
string
·· 
name
·· 
)
¸¸ 
{
¹¹ 	
XmlAttribute
ºº 
xmlAttr
ºº  
=
ºº! "
null
ºº# '
;
ºº' (
try
¼¼ 
{
½½ 

m_fXmlCore
¾¾ 
.
¾¾ 
wait
¾¾ 
(
¾¾  
)
¾¾  !
;
¾¾! "
xmlAttr
¿¿ 
=
¿¿ 
(
¿¿ 
XmlAttribute
¿¿ '
)
¿¿' (
m_xmlAttrCol
¿¿( 4
.
¿¿4 5
RemoveNamedItem
¿¿5 D
(
¿¿D E
name
¿¿E I
)
¿¿I J
;
¿¿J K
if
ÀÀ 
(
ÀÀ 
xmlAttr
ÀÀ 
==
ÀÀ 
null
ÀÀ #
)
ÀÀ# $
{
ÁÁ 
return
ÂÂ 
null
ÂÂ 
;
ÂÂ  
}
ÃÃ 
return
ÄÄ 
new
ÄÄ 
FXmlAttribute
ÄÄ (
(
ÄÄ( )

m_fXmlCore
ÄÄ) 3
,
ÄÄ3 4
xmlAttr
ÄÄ5 <
)
ÄÄ< =
;
ÄÄ= >
}
ÅÅ 
catch
ÆÆ 
(
ÆÆ 
	Exception
ÆÆ 
ex
ÆÆ 
)
ÆÆ  
{
ÇÇ 
FDebug
ÈÈ 
.
ÈÈ 
throwException
ÈÈ %
(
ÈÈ% &
ex
ÈÈ& (
)
ÈÈ( )
;
ÈÈ) *
}
ÉÉ 
finally
ÊÊ 
{
ËË 

m_fXmlCore
ÌÌ 
.
ÌÌ 
set
ÌÌ 
(
ÌÌ 
)
ÌÌ  
;
ÌÌ  !
}
ÍÍ 
return
ÎÎ 
null
ÎÎ 
;
ÎÎ 
}
ÏÏ 	
public
ÓÓ 
FXmlAttribute
ÓÓ 
append
ÓÓ #
(
ÓÓ# $
FXmlAttribute
ÔÔ 
fXmlAttr
ÔÔ "
)
ÕÕ 
{
ÖÖ 	
XmlAttribute
×× 
xmlAttr
××  
=
××! "
null
××# '
;
××' (
try
ÙÙ 
{
ÚÚ 

m_fXmlCore
ÛÛ 
.
ÛÛ 
wait
ÛÛ 
(
ÛÛ  
)
ÛÛ  !
;
ÛÛ! "
xmlAttr
ÜÜ 
=
ÜÜ 
m_xmlAttrCol
ÜÜ &
.
ÜÜ& '
Append
ÜÜ' -
(
ÜÜ- .
fXmlAttr
ÜÜ. 6
.
ÜÜ6 7
baseXml
ÜÜ7 >
)
ÜÜ> ?
;
ÜÜ? @
if
İİ 
(
İİ 
xmlAttr
İİ 
==
İİ 
null
İİ #
)
İİ# $
{
ŞŞ 
return
ßß 
null
ßß 
;
ßß  
}
àà 
return
áá 
new
áá 
FXmlAttribute
áá (
(
áá( )

m_fXmlCore
áá) 3
,
áá3 4
xmlAttr
áá5 <
)
áá< =
;
áá= >
}
ââ 
catch
ãã 
(
ãã 
	Exception
ãã 
ex
ãã 
)
ãã  
{
ää 
FDebug
åå 
.
åå 
throwException
åå %
(
åå% &
ex
åå& (
)
åå( )
;
åå) *
}
ææ 
finally
çç 
{
èè 

m_fXmlCore
éé 
.
éé 
set
éé 
(
éé 
)
éé  
;
éé  !
}
êê 
return
ëë 
null
ëë 
;
ëë 
}
ìì 	
public
ğğ 
FXmlAttribute
ğğ 
remove
ğğ #
(
ğğ# $
FXmlAttribute
ññ 
fXmlAttr
ññ "
)
òò 
{
óó 	
XmlAttribute
ôô 
xmlAttr
ôô  
=
ôô! "
null
ôô# '
;
ôô' (
try
öö 
{
÷÷ 

m_fXmlCore
øø 
.
øø 
wait
øø 
(
øø  
)
øø  !
;
øø! "
xmlAttr
ùù 
=
ùù 
m_xmlAttrCol
ùù &
.
ùù& '
Remove
ùù' -
(
ùù- .
fXmlAttr
ùù. 6
.
ùù6 7
baseXml
ùù7 >
)
ùù> ?
;
ùù? @
if
úú 
(
úú 
xmlAttr
úú 
==
úú 
null
úú #
)
úú# $
{
ûû 
return
üü 
null
üü 
;
üü  
}
ıı 
return
şş 
new
şş 
FXmlAttribute
şş (
(
şş( )

m_fXmlCore
şş) 3
,
şş3 4
xmlAttr
şş5 <
)
şş< =
;
şş= >
}
ÿÿ 
catch
€€ 
(
€€ 
	Exception
€€ 
ex
€€ 
)
€€  
{
 
FDebug
‚‚ 
.
‚‚ 
throwException
‚‚ %
(
‚‚% &
ex
‚‚& (
)
‚‚( )
;
‚‚) *
}
ƒƒ 
finally
„„ 
{
…… 

m_fXmlCore
†† 
.
†† 
set
†† 
(
†† 
)
††  
;
††  !
}
‡‡ 
return
ˆˆ 
null
ˆˆ 
;
ˆˆ 
}
‰‰ 	
public
 
FXmlAttribute
 
removeAt
 %
(
% &
int
 
i
 
)
 
{
 	
XmlAttribute
‘‘ 
xmlAttr
‘‘  
=
‘‘! "
null
‘‘# '
;
‘‘' (
try
““ 
{
”” 

m_fXmlCore
•• 
.
•• 
wait
•• 
(
••  
)
••  !
;
••! "
xmlAttr
–– 
=
–– 
m_xmlAttrCol
–– &
.
––& '
RemoveAt
––' /
(
––/ 0
i
––0 1
)
––1 2
;
––2 3
if
—— 
(
—— 
xmlAttr
—— 
==
—— 
null
—— #
)
——# $
{
˜˜ 
return
™™ 
null
™™ 
;
™™  
}
šš 
return
›› 
new
›› 
FXmlAttribute
›› (
(
››( )

m_fXmlCore
››) 3
,
››3 4
xmlAttr
››5 <
)
››< =
;
››= >
}
œœ 
catch
 
(
 
	Exception
 
ex
 
)
  
{
 
FDebug
ŸŸ 
.
ŸŸ 
throwException
ŸŸ %
(
ŸŸ% &
ex
ŸŸ& (
)
ŸŸ( )
;
ŸŸ) *
}
   
finally
¡¡ 
{
¢¢ 

m_fXmlCore
££ 
.
££ 
set
££ 
(
££ 
)
££  
;
££  !
}
¤¤ 
return
¥¥ 
null
¥¥ 
;
¥¥ 
}
¦¦ 	
public
ªª 
void
ªª 
	removeAll
ªª 
(
ªª 
)
«« 
{
¬¬ 	
try
­­ 
{
®® 

m_fXmlCore
¯¯ 
.
¯¯ 
wait
¯¯ 
(
¯¯  
)
¯¯  !
;
¯¯! "
m_xmlAttrCol
°° 
.
°° 
	RemoveAll
°° &
(
°°& '
)
°°' (
;
°°( )
}
±± 
catch
²² 
(
²² 
	Exception
²² 
ex
²² 
)
²²  
{
³³ 
FDebug
´´ 
.
´´ 
throwException
´´ %
(
´´% &
ex
´´& (
)
´´( )
;
´´) *
}
µµ 
finally
¶¶ 
{
·· 

m_fXmlCore
¸¸ 
.
¸¸ 
set
¸¸ 
(
¸¸ 
)
¸¸  
;
¸¸  !
}
¹¹ 
}
ºº 	
public
ÂÂ 
override
ÂÂ 
int
ÂÂ 
GetHashCode
ÂÂ '
(
ÂÂ' (
)
ÃÃ 
{
ÄÄ 	
try
ÅÅ 
{
ÆÆ 
return
ÇÇ 
base
ÇÇ 
.
ÇÇ 
GetHashCode
ÇÇ '
(
ÇÇ' (
)
ÇÇ( )
;
ÇÇ) *
}
ÈÈ 
catch
ÉÉ 
(
ÉÉ 
	Exception
ÉÉ 
ex
ÉÉ 
)
ÉÉ  
{
ÊÊ 
FDebug
ËË 
.
ËË 
throwException
ËË %
(
ËË% &
ex
ËË& (
)
ËË( )
;
ËË) *
}
ÌÌ 
finally
ÍÍ 
{
ÎÎ 
}
ĞĞ 
return
ÑÑ 
$num
ÑÑ 
;
ÑÑ 
}
ÒÒ 	
public
ÖÖ 
override
ÖÖ 
bool
ÖÖ 
Equals
ÖÖ #
(
ÖÖ# $
object
×× 
obj
×× 
)
ØØ 
{
ÙÙ 	
try
ÚÚ 
{
ÛÛ 
if
ÜÜ 
(
ÜÜ 
obj
ÜÜ 
==
ÜÜ 
null
ÜÜ 
||
ÜÜ  "
!
ÜÜ# $
(
ÜÜ$ %
obj
ÜÜ% (
is
ÜÜ) +%
FXmlAttributeCollection
ÜÜ, C
)
ÜÜC D
)
ÜÜD E
{
İİ 
return
ŞŞ 
false
ŞŞ  
;
ŞŞ  !
}
ßß 
return
áá 
m_xmlAttrCol
áá #
.
áá# $
Equals
áá$ *
(
áá* +
(
ââ 
(
ââ 
FXmlAttribute
ââ #
)
ââ# $
obj
ââ$ '
)
ââ' (
.
ââ( )
baseXml
ââ) 0
)
ãã 
;
ãã 
}
ää 
catch
åå 
(
åå 
	Exception
åå 
ex
åå 
)
åå  
{
ææ 
FDebug
çç 
.
çç 
throwException
çç %
(
çç% &
ex
çç& (
)
çç( )
;
çç) *
}
èè 
finally
éé 
{
êê 
}
ìì 
return
íí 
false
íí 
;
íí 
}
îî 	
public
òò 
static
òò 
bool
òò 
operator
òò #
==
òò$ &
(
òò& '%
FXmlAttributeCollection
óó #
lhs
óó$ '
,
óó' (%
FXmlAttributeCollection
ôô #
rhs
ôô$ '
)
õõ 
{
öö 	
try
÷÷ 
{
øø 
if
ùù 
(
ùù 
(
ùù 
object
ùù 
)
ùù 
lhs
ùù 
==
ùù  "
null
ùù# '
)
ùù' (
{
úú 
return
ûû 
(
ûû 
(
ûû 
object
ûû #
)
ûû# $
rhs
ûû$ '
==
ûû( *
null
ûû+ /
?
ûû0 1
true
ûû2 6
:
ûû7 8
false
ûû9 >
)
ûû> ?
;
ûû? @
}
üü 
return
ıı 
lhs
ıı 
.
ıı 
Equals
ıı !
(
ıı! "
rhs
ıı" %
)
ıı% &
;
ıı& '
}
şş 
catch
ÿÿ 
(
ÿÿ 
	Exception
ÿÿ 
ex
ÿÿ 
)
ÿÿ  
{
€€ 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
‚‚ 
finally
ƒƒ 
{
„„ 
}
†† 
return
‡‡ 
false
‡‡ 
;
‡‡ 
}
ˆˆ 	
public
ŒŒ 
static
ŒŒ 
bool
ŒŒ 
operator
ŒŒ #
!=
ŒŒ$ &
(
ŒŒ& '%
FXmlAttributeCollection
 #
lhs
$ '
,
' (%
FXmlAttributeCollection
 #
rhs
$ '
)
 
{
 	
try
‘‘ 
{
’’ 
if
““ 
(
““ 
(
““ 
object
““ 
)
““ 
lhs
““ 
==
““  "
null
““# '
)
““' (
{
”” 
return
•• 
(
•• 
(
•• 
object
•• #
)
••# $
rhs
••$ '
==
••( *
null
••+ /
?
••0 1
false
••2 7
:
••8 9
true
••: >
)
••> ?
;
••? @
}
–– 
return
—— 
!
—— 
lhs
—— 
.
—— 
Equals
—— "
(
——" #
rhs
——# &
)
——& '
;
——' (
}
˜˜ 
catch
™™ 
(
™™ 
	Exception
™™ 
ex
™™ 
)
™™  
{
šš 
FDebug
›› 
.
›› 
throwException
›› %
(
››% &
ex
››& (
)
››( )
;
››) *
}
œœ 
finally
 
{
 
}
   
return
¡¡ 
false
¡¡ 
;
¡¡ 
}
¢¢ 	
}
¨¨ 
}©© ©`
ZD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Xml\c_FXmlNodeList.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FXmlNodeList 
: 
IDisposable  +
,+ ,
IEnumerable- 8
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FXmlCore 

m_fXmlCore #
=$ %
null& *
;* +
private 
XmlNodeList 
m_xmlNodeList )
=* +
null, 0
;0 1
internal$$ 
FXmlNodeList$$ 
($$ 
FXmlCore%% 
fXmlCore%% 
,%% 
XmlNodeList&& 
xmlNodeList&& #
)'' 
{(( 	

m_fXmlCore)) 
=)) 
fXmlCore)) !
;))! "
m_xmlNodeList** 
=** 
xmlNodeList** '
;**' (
}++ 	
~// 	
FXmlNodeList//	 
(// 
)00 
{11 	
	myDispose22 
(22 
false22 
)22 
;22 
}33 	
	protected77 
void77 
	myDispose77  
(77  !
bool88 
	disposing88 
)99 
{:: 	
if;; 
(;; 
!;; 

m_disposed;; 
);; 
{<< 
if== 
(== 
	disposing== 
)== 
{>> 
m_xmlNodeList?? !
=??" #
null??$ (
;??( )
}@@ 

m_disposedBB 
=BB 
trueBB !
;BB! "
}CC 
}DD 	
publicLL 
voidLL 
DisposeLL 
(LL 
)MM 
{NN 	
	myDisposeOO 
(OO 
trueOO 
)OO 
;OO 
GCPP 
.PP 
SuppressFinalizePP 
(PP  
thisPP  $
)PP$ %
;PP% &
}QQ 	
publicYY 
IEnumeratorYY 
GetEnumeratorYY (
(YY( )
)ZZ 
{[[ 	
try\\ 
{]] 
return^^ 
new^^ "
FXmlNodeListEnumerator^^ 1
(^^1 2
this^^2 6
)^^6 7
;^^7 8
}__ 
catch`` 
(`` 
	Exception`` 
ex`` 
)``  
{aa 
FDebugbb 
.bb 
throwExceptionbb %
(bb% &
exbb& (
)bb( )
;bb) *
}cc 
finallydd 
{ee 
}gg 
returnhh 
nullhh 
;hh 
}ii 	
internalqq 
XmlNodeListqq 
baseXmlqq $
{rr 	
getss 
{tt 
tryuu 
{vv 

m_fXmlCoreww 
.ww 
waitww #
(ww# $
)ww$ %
;ww% &
returnxx 
m_xmlNodeListxx (
;xx( )
}yy 
catchzz 
(zz 
	Exceptionzz  
exzz! #
)zz# $
{{{ 
FDebug|| 
.|| 
throwException|| )
(||) *
ex||* ,
)||, -
;||- .
}}} 
finally~~ 
{ 

m_fXmlCore
€€ 
.
€€ 
set
€€ "
(
€€" #
)
€€# $
;
€€$ %
}
 
return
‚‚ 
null
‚‚ 
;
‚‚ 
}
ƒƒ 
}
„„ 	
public
ˆˆ 
int
ˆˆ 
count
ˆˆ 
{
‰‰ 	
get
ŠŠ 
{
‹‹ 
try
ŒŒ 
{
 

m_fXmlCore
 
.
 
wait
 #
(
# $
)
$ %
;
% &
return
 
m_xmlNodeList
 (
.
( )
Count
) .
;
. /
}
 
catch
‘‘ 
(
‘‘ 
	Exception
‘‘  
ex
‘‘! #
)
‘‘# $
{
’’ 
FDebug
““ 
.
““ 
throwException
““ )
(
““) *
ex
““* ,
)
““, -
;
““- .
}
”” 
finally
•• 
{
–– 

m_fXmlCore
—— 
.
—— 
set
—— "
(
——" #
)
——# $
;
——$ %
}
˜˜ 
return
™™ 
$num
™™ 
;
™™ 
}
šš 
}
›› 	
public
ŸŸ 
FXmlNode
ŸŸ 
this
ŸŸ 
[
ŸŸ 
int
ŸŸ  
i
ŸŸ! "
]
ŸŸ" #
{
   	
get
¡¡ 
{
¢¢ 
XmlNode
££ 
xmlNode
££ 
=
££  !
null
££" &
;
££& '
try
¥¥ 
{
¦¦ 

m_fXmlCore
§§ 
.
§§ 
wait
§§ #
(
§§# $
)
§§$ %
;
§§% &
xmlNode
¨¨ 
=
¨¨ 
m_xmlNodeList
¨¨ +
[
¨¨+ ,
i
¨¨, -
]
¨¨- .
;
¨¨. /
if
©© 
(
©© 
xmlNode
©© 
==
©©  "
null
©©# '
)
©©' (
{
ªª 
return
«« 
null
«« #
;
««# $
}
¬¬ 
return
­­ 
new
­­ 
FXmlNode
­­ '
(
­­' (

m_fXmlCore
­­( 2
,
­­2 3
xmlNode
­­4 ;
)
­­; <
;
­­< =
}
®® 
catch
¯¯ 
(
¯¯ 
	Exception
¯¯  
ex
¯¯! #
)
¯¯# $
{
°° 
FDebug
±± 
.
±± 
throwException
±± )
(
±±) *
ex
±±* ,
)
±±, -
;
±±- .
}
²² 
finally
³³ 
{
´´ 

m_fXmlCore
µµ 
.
µµ 
set
µµ "
(
µµ" #
)
µµ# $
;
µµ$ %
}
¶¶ 
return
·· 
null
·· 
;
·· 
}
¸¸ 
}
¹¹ 	
public
ÁÁ 
FXmlNode
ÁÁ 
item
ÁÁ 
(
ÁÁ 
int
ÂÂ 
index
ÂÂ 
)
ÃÃ 
{
ÄÄ 	
XmlNode
ÅÅ 
xmlNode
ÅÅ 
=
ÅÅ 
null
ÅÅ "
;
ÅÅ" #
try
ÇÇ 
{
ÈÈ 

m_fXmlCore
ÉÉ 
.
ÉÉ 
wait
ÉÉ 
(
ÉÉ  
)
ÉÉ  !
;
ÉÉ! "
xmlNode
ÊÊ 
=
ÊÊ 
m_xmlNodeList
ÊÊ '
.
ÊÊ' (
Item
ÊÊ( ,
(
ÊÊ, -
index
ÊÊ- 2
)
ÊÊ2 3
;
ÊÊ3 4
if
ËË 
(
ËË 
xmlNode
ËË 
==
ËË 
null
ËË #
)
ËË# $
{
ÌÌ 
return
ÍÍ 
null
ÍÍ 
;
ÍÍ  
}
ÎÎ 
return
ÏÏ 
new
ÏÏ 
FXmlNode
ÏÏ #
(
ÏÏ# $

m_fXmlCore
ÏÏ$ .
,
ÏÏ. /
xmlNode
ÏÏ0 7
)
ÏÏ7 8
;
ÏÏ8 9
}
ĞĞ 
catch
ÑÑ 
(
ÑÑ 
	Exception
ÑÑ 
ex
ÑÑ 
)
ÑÑ  
{
ÒÒ 
FDebug
ÓÓ 
.
ÓÓ 
throwException
ÓÓ %
(
ÓÓ% &
ex
ÓÓ& (
)
ÓÓ( )
;
ÓÓ) *
}
ÔÔ 
finally
ÕÕ 
{
ÖÖ 

m_fXmlCore
×× 
.
×× 
set
×× 
(
×× 
)
××  
;
××  !
}
ØØ 
return
ÙÙ 
null
ÙÙ 
;
ÙÙ 
}
ÚÚ 	
public
ââ 
override
ââ 
int
ââ 
GetHashCode
ââ '
(
ââ' (
)
ãã 
{
ää 	
try
åå 
{
ææ 
return
çç 
base
çç 
.
çç 
GetHashCode
çç '
(
çç' (
)
çç( )
;
çç) *
}
èè 
catch
éé 
(
éé 
	Exception
éé 
ex
éé 
)
éé  
{
êê 
FDebug
ëë 
.
ëë 
throwException
ëë %
(
ëë% &
ex
ëë& (
)
ëë( )
;
ëë) *
}
ìì 
finally
íí 
{
îî 
}
ğğ 
return
ññ 
$num
ññ 
;
ññ 
}
òò 	
public
öö 
override
öö 
bool
öö 
Equals
öö #
(
öö# $
object
÷÷ 
obj
÷÷ 
)
øø 
{
ùù 	
try
úú 
{
ûû 
if
üü 
(
üü 
obj
üü 
==
üü 
null
üü 
||
üü  "
!
üü# $
(
üü$ %
obj
üü% (
is
üü) +
FXmlNodeList
üü, 8
)
üü8 9
)
üü9 :
{
ıı 
return
şş 
false
şş  
;
şş  !
}
ÿÿ 
return
 
m_xmlNodeList
 $
.
$ %
Equals
% +
(
+ ,
(
‚‚ 
(
‚‚ 
FXmlNodeList
‚‚ "
)
‚‚" #
obj
‚‚# &
)
‚‚& '
.
‚‚' (
baseXml
‚‚( /
)
ƒƒ 
;
ƒƒ 
}
„„ 
catch
…… 
(
…… 
	Exception
…… 
ex
…… 
)
……  
{
†† 
FDebug
‡‡ 
.
‡‡ 
throwException
‡‡ %
(
‡‡% &
ex
‡‡& (
)
‡‡( )
;
‡‡) *
}
ˆˆ 
finally
‰‰ 
{
ŠŠ 
}
ŒŒ 
return
 
false
 
;
 
}
 	
public
’’ 
static
’’ 
bool
’’ 
operator
’’ #
==
’’$ &
(
’’& '
FXmlNodeList
““ 
lhs
““ 
,
““ 
FXmlNodeList
”” 
rhs
”” 
)
•• 
{
–– 	
try
—— 
{
˜˜ 
if
™™ 
(
™™ 
(
™™ 
object
™™ 
)
™™ 
lhs
™™ 
==
™™  "
null
™™# '
)
™™' (
{
šš 
return
›› 
(
›› 
(
›› 
object
›› #
)
››# $
rhs
››$ '
==
››( *
null
››+ /
?
››0 1
true
››2 6
:
››7 8
false
››9 >
)
››> ?
;
››? @
}
œœ 
return
 
lhs
 
.
 
Equals
 !
(
! "
rhs
" %
)
% &
;
& '
}
 
catch
ŸŸ 
(
ŸŸ 
	Exception
ŸŸ 
ex
ŸŸ 
)
ŸŸ  
{
   
FDebug
¡¡ 
.
¡¡ 
throwException
¡¡ %
(
¡¡% &
ex
¡¡& (
)
¡¡( )
;
¡¡) *
}
¢¢ 
finally
££ 
{
¤¤ 
}
¦¦ 
return
§§ 
false
§§ 
;
§§ 
}
¨¨ 	
public
¬¬ 
static
¬¬ 
bool
¬¬ 
operator
¬¬ #
!=
¬¬$ &
(
¬¬& '
FXmlNodeList
­­ 
lhs
­­ 
,
­­ 
FXmlNodeList
®® 
rhs
®® 
)
¯¯ 
{
°° 	
try
±± 
{
²² 
if
³³ 
(
³³ 
(
³³ 
object
³³ 
)
³³ 
lhs
³³ 
==
³³  "
null
³³# '
)
³³' (
{
´´ 
return
µµ 
(
µµ 
(
µµ 
object
µµ #
)
µµ# $
rhs
µµ$ '
==
µµ( *
null
µµ+ /
?
µµ0 1
false
µµ2 7
:
µµ8 9
true
µµ: >
)
µµ> ?
;
µµ? @
}
¶¶ 
return
·· 
!
·· 
lhs
·· 
.
·· 
Equals
·· "
(
··" #
rhs
··# &
)
··& '
;
··' (
}
¸¸ 
catch
¹¹ 
(
¹¹ 
	Exception
¹¹ 
ex
¹¹ 
)
¹¹  
{
ºº 
FDebug
»» 
.
»» 
throwException
»» %
(
»»% &
ex
»»& (
)
»»( )
;
»») *
}
¼¼ 
finally
½½ 
{
¾¾ 
}
ÀÀ 
return
ÁÁ 
false
ÁÁ 
;
ÁÁ 
}
ÂÂ 	
}
ÈÈ 
}ÉÉ   
oD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Xml\c_FXmlAttributeCollectionEnumerator.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class -
!FXmlAttributeCollectionEnumerator 2
:3 4
IDisposable5 @
,@ A
IEnumeratorB M
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private #
FXmlAttributeCollection '
m_fXmlAttrCol( 5
=6 7
null8 <
;< =
private 
int 
m_index 
= 
- 
$num  
;  !
internal## -
!FXmlAttributeCollectionEnumerator## 2
(##2 3#
FXmlAttributeCollection$$ #
fXmlAttrCol$$$ /
)%% 
{&& 	
m_fXmlAttrCol'' 
='' 
fXmlAttrCol'' '
;''' (
}(( 	
~,, 	-
!FXmlAttributeCollectionEnumerator,,	 *
(,,* +
)-- 
{.. 	
	myDispose// 
(// 
false// 
)// 
;// 
}00 	
	protected44 
void44 
	myDispose44  
(44  !
bool55 
	disposing55 
)66 
{77 	
if88 
(88 
!88 

m_disposed88 
)88 
{99 
if:: 
(:: 
	disposing:: 
):: 
{;; 
m_fXmlAttrCol<< !
=<<" #
null<<$ (
;<<( )
}== 

m_disposed?? 
=?? 
true?? !
;??! "
}@@ 
}AA 	
publicII 
voidII 
DisposeII 
(II 
)JJ 
{KK 	
	myDisposeLL 
(LL 
trueLL 
)LL 
;LL 
GCMM 
.MM 
SuppressFinalizeMM 
(MM  
thisMM  $
)MM$ %
;MM% &
}NN 	
publicVV 
objectVV 
CurrentVV 
{WW 	
getXX 
{YY 
tryZZ 
{[[ 
return\\ 
m_fXmlAttrCol\\ (
[\\( )
m_index\\) 0
]\\0 1
;\\1 2
}]] 
catch^^ 
(^^ 
	Exception^^  
ex^^! #
)^^# $
{__ 
FDebug`` 
.`` 
throwException`` )
(``) *
ex``* ,
)``, -
;``- .
}aa 
finallybb 
{cc 
}ee 
returnff 
nullff 
;ff 
}gg 
}hh 	
publicll 
boolll 
MoveNextll 
(ll 
)mm 
{nn 	
tryoo 
{pp 
returnqq 
(qq 
++qq 
m_indexqq !
<qq" #
m_fXmlAttrColqq$ 1
.qq1 2
countqq2 7
)qq7 8
;qq8 9
}rr 
catchss 
(ss 
	Exceptionss 
exss 
)ss  
{tt 
FDebuguu 
.uu 
throwExceptionuu %
(uu% &
exuu& (
)uu( )
;uu) *
}vv 
finallyww 
{xx 
}zz 
return{{ 
false{{ 
;{{ 
}|| 	
public
€€ 
void
€€ 
Reset
€€ 
(
€€ 
)
 
{
‚‚ 	
try
ƒƒ 
{
„„ 
m_index
…… 
=
…… 
-
…… 
$num
…… 
;
…… 
}
†† 
catch
‡‡ 
(
‡‡ 
	Exception
‡‡ 
ex
‡‡ 
)
‡‡  
{
ˆˆ 
FDebug
‰‰ 
.
‰‰ 
throwException
‰‰ %
(
‰‰% &
ex
‰‰& (
)
‰‰( )
;
‰‰) *
}
ŠŠ 
finally
‹‹ 
{
ŒŒ 
}
 
}
 	
}
•• 
}–– å
dD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Xml\c_FXmlNodeListEnumerator.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class "
FXmlNodeListEnumerator '
:( )
IDisposable* 5
,5 6
IEnumerator7 B
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
FXmlNodeList 
m_fXmlNodeList +
=, -
null. 2
;2 3
private 
int 
m_index 
= 
- 
$num  
;  !
internal## "
FXmlNodeListEnumerator## '
(##' (
FXmlNodeList$$ 
fXmlNodeList$$ %
)%% 
{&& 	
m_fXmlNodeList'' 
='' 
fXmlNodeList'' )
;'') *
}(( 	
~,, 	"
FXmlNodeListEnumerator,,	 
(,,  
)-- 
{.. 	
	myDispose// 
(// 
false// 
)// 
;// 
}00 	
	protected44 
void44 
	myDispose44  
(44  !
bool55 
	disposing55 
)66 
{77 	
if88 
(88 
!88 

m_disposed88 
)88 
{99 
if:: 
(:: 
	disposing:: 
):: 
{;; 
m_fXmlNodeList<< "
=<<# $
null<<% )
;<<) *
}== 

m_disposed?? 
=?? 
true?? !
;??! "
}@@ 
}AA 	
publicII 
voidII 
DisposeII 
(II 
)JJ 
{KK 	
	myDisposeLL 
(LL 
trueLL 
)LL 
;LL 
GCMM 
.MM 
SuppressFinalizeMM 
(MM  
thisMM  $
)MM$ %
;MM% &
}NN 	
publicVV 
objectVV 
CurrentVV 
{WW 	
getXX 
{YY 
tryZZ 
{[[ 
return\\ 
m_fXmlNodeList\\ )
[\\) *
m_index\\* 1
]\\1 2
;\\2 3
}]] 
catch^^ 
(^^ 
	Exception^^  
ex^^! #
)^^# $
{__ 
FDebug`` 
.`` 
throwException`` )
(``) *
ex``* ,
)``, -
;``- .
}aa 
finallybb 
{cc 
}ee 
returnff 
nullff 
;ff 
}gg 
}hh 	
publicll 
boolll 
MoveNextll 
(ll 
)mm 
{nn 	
tryoo 
{pp 
returnqq 
(qq 
++qq 
m_indexqq !
<qq" #
m_fXmlNodeListqq$ 2
.qq2 3
countqq3 8
)qq8 9
;qq9 :
}rr 
catchss 
(ss 
	Exceptionss 
exss 
)ss  
{tt 
FDebuguu 
.uu 
throwExceptionuu %
(uu% &
exuu& (
)uu( )
;uu) *
}vv 
finallyww 
{xx 
}zz 
return{{ 
false{{ 
;{{ 
}|| 	
public
€€ 
void
€€ 
Reset
€€ 
(
€€ 
)
 
{
‚‚ 	
try
ƒƒ 
{
„„ 
m_index
…… 
=
…… 
-
…… 
$num
…… 
;
…… 
}
†† 
catch
‡‡ 
(
‡‡ 
	Exception
‡‡ 
ex
‡‡ 
)
‡‡  
{
ˆˆ 
FDebug
‰‰ 
.
‰‰ 
throwException
‰‰ %
(
‰‰% &
ex
‰‰& (
)
‰‰( )
;
‰‰) *
}
ŠŠ 
finally
‹‹ 
{
ŒŒ 
}
 
}
 	
}
•• 
}–– Ï¡
lD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Resource\c_FProcessResourceCollector.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class %
FProcessResourceCollector *
:+ ,
IDisposable- 8
{ 
public 
event (
FProcessResourceEventHandler 1 
ResourceDataReceived2 F
=G H
nullI M
;M N
private 
bool 

m_disposed 
=  !
false" '
;' (
private   
FThread   
m_fThdPusher   $
=  % &
null  ' +
;  + ,
private!! 
FStaticTimer!! 
m_fTmrPusher!! )
=!!* +
null!!, 0
;!!0 1
private"" 
ManagementScope"" 
m_scope""  '
=""( )
null""* .
;"". /
private$$ 

Dictionary$$ 
<$$ 
string$$ !
,$$! "
FProcessResource$$# 3
>$$3 4
m_fProcResDict$$5 C
=$$D E
null$$F J
;$$J K
private&& 
string&& 
m_appliedDirPath&& '
=&&( )
string&&* 0
.&&0 1
Empty&&1 6
;&&6 7
private'' 
int'' 

m_interval'' 
=''  
$num''! "
;''" #
public-- %
FProcessResourceCollector-- (
(--( )
string.. 
appliedDirPath.. !
)// 
{00 	
m_appliedDirPath11 
=11 
appliedDirPath11 -
;11- .
init55 
(55 
)55 
;55 
}66 	
~:: 	%
FProcessResourceCollector::	 "
(::" #
);; 
{<< 	
	myDispose== 
(== 
false== 
)== 
;== 
}>> 	
	protectedBB 
voidBB 
	myDisposeBB  
(BB  !
boolCC 
	disposingCC 
)DD 
{EE 	
ifFF 
(FF 
!FF 

m_disposedFF 
)FF 
{GG 
ifHH 
(HH 
	disposingHH 
)HH 
{II 
termJJ 
(JJ 
)JJ 
;JJ 
m_scopeLL 
=LL 
nullLL "
;LL" #
m_fProcResDictMM "
=MM# $
nullMM% )
;MM) *
}NN 

m_disposedPP 
=PP 
truePP !
;PP! "
}QQ 
}RR 	
publicZZ 
voidZZ 
DisposeZZ 
(ZZ 
)[[ 
{\\ 	
	myDispose]] 
(]] 
true]] 
)]] 
;]] 
GC^^ 
.^^ 
SuppressFinalize^^ 
(^^  
this^^  $
)^^$ %
;^^% &
}__ 	
publicii &
FProcessResourceCollectionii )

procResColii* 4
{jj 	
getkk 
{ll &
FProcessResourceCollectionmm *
fProcResColmm+ 6
=mm7 8
nullmm9 =
;mm= >
tryoo 
{pp 
ifqq 
(qq 
m_fProcResDictqq &
!=qq' )
nullqq* .
)qq. /
{rr 
fProcResColss #
=ss$ %
newss& )&
FProcessResourceCollectionss* D
(ssD E
m_fProcResDictssE S
,ssS T
m_fProcResDictssU c
.ssc d
Valuesssd j
.ssj k
ToListssk q
(ssq r
)ssr s
)sss t
;sst u
}tt 
returnvv 
fProcResColvv &
;vv& '
}ww 
catchxx 
(xx 
	Exceptionxx  
exxx! #
)xx# $
{yy 
FDebugzz 
.zz 
throwExceptionzz )
(zz) *
exzz* ,
)zz, -
;zz- .
}{{ 
finally|| 
{}} 
fProcResCol~~ 
=~~  !
null~~" &
;~~& '
} 
return
€€ 
null
€€ 
;
€€ 
}
 
}
‚‚ 	
private
ŠŠ 
void
ŠŠ 
init
ŠŠ 
(
ŠŠ 
)
‹‹ 
{
ŒŒ 	
try
 
{
 
try
 
{
 
m_scope
‘‘ 
=
‘‘ 
new
‘‘ !
ManagementScope
‘‘" 1
(
‘‘1 2
$str
‘‘2 ?
)
‘‘? @
;
‘‘@ A
}
’’ 
catch
““ 
(
““ 
	Exception
““  
ex
““! #
)
““# $
{
”” 
FDebug
•• 
.
•• 
throwException
•• )
(
••) *
ex
••* ,
)
••, -
;
••- .
}
–– 
finally
—— 
{
˜˜ 
}
šš 
}
›› 
catch
œœ 
(
œœ 
	Exception
œœ 
ex
œœ 
)
œœ  
{
 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
ŸŸ 
finally
   
{
¡¡ 
}
££ 
}
¤¤ 	
private
¨¨ 
void
¨¨ 
term
¨¨ 
(
¨¨ 
)
©© 
{
ªª 	
try
«« 
{
¬¬ 
if
­­ 
(
­­ 
m_fThdPusher
­­  
!=
­­! #
null
­­$ (
)
­­( )
{
®® 
m_fThdPusher
¯¯  
.
¯¯  !
ThreadJobCalled
¯¯! 0
-=
¯¯1 3
new
¯¯4 7*
FThreadJobCalledEventHandler
¯¯8 T
(
¯¯T U*
m_fThdPusher_ThreadJobCalled
¯¯U q
)
¯¯q r
;
¯¯r s
m_fThdPusher
±±  
.
±±  !
stop
±±! %
(
±±% &
)
±±& '
;
±±' (
m_fThdPusher
²²  
.
²²  !
Dispose
²²! (
(
²²( )
)
²²) *
;
²²* +
m_fThdPusher
³³  
=
³³! "
null
³³# '
;
³³' (
}
´´ 
if
¸¸ 
(
¸¸ 
m_fTmrPusher
¸¸  
!=
¸¸! #
null
¸¸$ (
)
¸¸( )
{
¹¹ 
m_fTmrPusher
ºº  
.
ºº  !
Dispose
ºº! (
(
ºº( )
)
ºº) *
;
ºº* +
m_fThdPusher
»»  
=
»»! "
null
»»# '
;
»»' (
}
¼¼ 
}
½½ 
catch
¾¾ 
(
¾¾ 
	Exception
¾¾ 
ex
¾¾ 
)
¾¾  
{
¿¿ 
FDebug
ÀÀ 
.
ÀÀ 
throwException
ÀÀ %
(
ÀÀ% &
ex
ÀÀ& (
)
ÀÀ( )
;
ÀÀ) *
}
ÁÁ 
finally
ÂÂ 
{
ÃÃ 
}
ÅÅ 
}
ÆÆ 	
public
ÊÊ 
void
ÊÊ 
startEventHandler
ÊÊ %
(
ÊÊ% &
int
ËË 
interval
ËË 
)
ÌÌ 
{
ÍÍ 	
try
ÎÎ 
{
ÏÏ 

m_interval
ĞĞ 
=
ĞĞ 
interval
ĞĞ %
;
ĞĞ% &
term
ÔÔ 
(
ÔÔ 
)
ÔÔ 
;
ÔÔ 
m_fThdPusher
ØØ 
=
ØØ 
new
ØØ "
FThread
ØØ# *
(
ØØ* +
$str
ØØ+ F
,
ØØF G
false
ØØH M
,
ØØM N
System
ØØO U
.
ØØU V
	Threading
ØØV _
.
ØØ_ `
ThreadPriority
ØØ` n
.
ØØn o
Normal
ØØo u
,
ØØu v
true
ØØw {
)
ØØ{ |
;
ØØ| }
m_fThdPusher
ÙÙ 
.
ÙÙ 
ThreadJobCalled
ÙÙ ,
+=
ÙÙ- /
new
ÙÙ0 3*
FThreadJobCalledEventHandler
ÙÙ4 P
(
ÙÙP Q*
m_fThdPusher_ThreadJobCalled
ÙÙQ m
)
ÙÙm n
;
ÙÙn o
m_fThdPusher
ÚÚ 
.
ÚÚ 
start
ÚÚ "
(
ÚÚ" #
)
ÚÚ# $
;
ÚÚ$ %
}
ÛÛ 
catch
ÜÜ 
(
ÜÜ 
	Exception
ÜÜ 
ex
ÜÜ 
)
ÜÜ  
{
İİ 
FDebug
ŞŞ 
.
ŞŞ 
throwException
ŞŞ %
(
ŞŞ% &
ex
ŞŞ& (
)
ŞŞ( )
;
ŞŞ) *
}
ßß 
finally
àà 
{
áá 
}
ãã 
}
ää 	
public
èè 
void
èè 
stopEventHandler
èè $
(
èè$ %
)
éé 
{
êê 	
try
ëë 
{
ìì 
term
íí 
(
íí 
)
íí 
;
íí 
}
îî 
catch
ïï 
(
ïï 
	Exception
ïï 
ex
ïï 
)
ïï  
{
ğğ 
FDebug
ññ 
.
ññ 
throwException
ññ %
(
ññ% &
ex
ññ& (
)
ññ( )
;
ññ) *
}
òò 
finally
óó 
{
ôô 
}
öö 
}
÷÷ 	
private
ûû 
void
ûû %
procProcessResourcePush
ûû ,
(
ûû, -
)
üü 
{
ıı 	
try
şş 
{
ÿÿ  
getProcessResource
€€ "
(
€€" #
)
€€# $
;
€€$ %
if
„„ 
(
„„ "
ResourceDataReceived
„„ (
!=
„„) +
null
„„, 0
)
„„0 1
{
…… "
ResourceDataReceived
†† (
(
††( )
this
‡‡ 
,
‡‡ 
new
ˆˆ '
FProcessResourceEventArgs
ˆˆ 5
(
ˆˆ5 6
this
ˆˆ6 :
.
ˆˆ: ;

procResCol
ˆˆ; E
)
ˆˆE F
)
‰‰ 
;
‰‰ 
}
ŠŠ 
}
‹‹ 
catch
ŒŒ 
(
ŒŒ 
	Exception
ŒŒ 
ex
ŒŒ 
)
ŒŒ  
{
 
FDebug
 
.
 
throwException
 %
(
% &
ex
& (
)
( )
;
) *
}
 
finally
 
{
‘‘ 
}
““ 
}
”” 	
public
˜˜ 
void
˜˜  
getProcessResource
˜˜ &
(
˜˜& '
)
™™ 
{
šš 	&
ManagementObjectSearcher
›› $
searcher
››% -
=
››. /
null
››0 4
;
››4 5
DirectoryInfo
 
dirInfo
 !
=
" #
null
$ (
;
( )
string
 
[
 
]
 
processList
  
=
! "
null
# '
;
' (
string
ŸŸ 
[
ŸŸ 
]
ŸŸ 
dirList
ŸŸ 
=
ŸŸ 
null
ŸŸ #
;
ŸŸ# $
string
   
processName
   
=
    
string
  ! '
.
  ' (
Empty
  ( -
;
  - .
long
¡¡ 
porcessDiskUsage
¡¡ !
=
¡¡" #
$num
¡¡$ %
;
¡¡% &
try
££ 
{
¤¤ 
if
©© 
(
©© 
m_fProcResDict
©© "
==
©©# %
null
©©& *
)
©©* +
{
ªª 
m_fProcResDict
«« "
=
««# $
new
««% (

Dictionary
««) 3
<
««3 4
string
««4 :
,
««: ;
FProcessResource
««< L
>
««L M
(
««M N
)
««N O
;
««O P
}
¬¬ 
if
°° 
(
°° 
!
°° 
	Directory
°° 
.
°° 
Exists
°° %
(
°°% &
m_appliedDirPath
°°& 6
)
°°6 7
)
°°7 8
{
±± 
m_fProcResDict
²² "
.
²²" #
Clear
²²# (
(
²²( )
)
²²) *
;
²²* +
return
³³ 
;
³³ 
}
´´ 
processList
ºº 
=
ºº 
m_fProcResDict
ºº ,
.
ºº, -
Keys
ºº- 1
.
ºº1 2
ToArray
ºº2 9
(
ºº9 :
)
ºº: ;
;
ºº; <
foreach
»» 
(
»» 
string
»» 
process
»»  '
in
»»( *
processList
»»+ 6
)
»»6 7
{
¼¼ 
if
½½ 
(
½½ 
!
½½ 
	Directory
½½ "
.
½½" #
Exists
½½# )
(
½½) *
Path
¾¾ 
.
¾¾ 
Combine
¾¾ $
(
¾¾$ %
new
¾¾% (
string
¾¾) /
[
¾¾/ 0
]
¾¾0 1
{
¾¾2 3
m_appliedDirPath
¾¾4 D
,
¾¾D E
process
¾¾F M
}
¾¾N O
)
¾¾O P
)
¿¿ 
)
¿¿ 
{
ÀÀ 
m_fProcResDict
ÁÁ &
.
ÁÁ& '
Remove
ÁÁ' -
(
ÁÁ- .
process
ÁÁ. 5
)
ÁÁ5 6
;
ÁÁ6 7
}
ÂÂ 
}
ÃÃ 
dirList
ÊÊ 
=
ÊÊ 
	Directory
ÊÊ #
.
ÊÊ# $
GetDirectories
ÊÊ$ 2
(
ÊÊ2 3
m_appliedDirPath
ÊÊ3 C
)
ÊÊC D
.
ÊÊD E
Where
ÊÊE J
(
ÊÊJ K
name
ÊÊK O
=>
ÊÊP R
!
ÊÊS T
name
ÊÊT X
.
ÊÊX Y
Contains
ÊÊY a
(
ÊÊa b
$str
ÊÊb e
)
ÊÊe f
)
ÊÊf g
.
ÊÊg h
ToArray
ÊÊh o
(
ÊÊo p
)
ÊÊp q
;
ÊÊq r
if
ËË 
(
ËË 
dirList
ËË 
.
ËË 
Length
ËË "
==
ËË# %
$num
ËË& '
)
ËË' (
{
ÌÌ 
m_fProcResDict
ÍÍ "
.
ÍÍ" #
Clear
ÍÍ# (
(
ÍÍ( )
)
ÍÍ) *
;
ÍÍ* +
return
ÎÎ 
;
ÎÎ 
}
ÏÏ 
foreach
ÔÔ 
(
ÔÔ 
string
ÔÔ 
dir
ÔÔ  #
in
ÔÔ$ &
dirList
ÔÔ' .
)
ÔÔ. /
{
ÕÕ 
processName
ÖÖ 
=
ÖÖ  !
dir
ÖÖ" %
.
ÖÖ% &
Split
ÖÖ& +
(
ÖÖ+ ,
Path
ÖÖ, 0
.
ÖÖ0 1$
DirectorySeparatorChar
ÖÖ1 G
)
ÖÖG H
.
ÖÖH I
Last
ÖÖI M
(
ÖÖM N
)
ÖÖN O
;
ÖÖO P
dirInfo
ÙÙ 
=
ÙÙ 
new
ÙÙ !
DirectoryInfo
ÙÙ" /
(
ÙÙ/ 0
dir
ÙÙ0 3
)
ÙÙ3 4
;
ÙÙ4 5
porcessDiskUsage
ÚÚ $
=
ÚÚ% &
dirInfo
ÚÚ' .
.
ÚÚ. /
EnumerateFiles
ÚÚ/ =
(
ÚÚ= >
$str
ÚÚ> C
,
ÚÚC D
SearchOption
ÚÚE Q
.
ÚÚQ R
AllDirectories
ÚÚR `
)
ÚÚ` a
.
ÚÚa b
Sum
ÚÚb e
(
ÚÚe f
f
ÚÚf g
=>
ÚÚh j
f
ÚÚk l
.
ÚÚl m
Length
ÚÚm s
)
ÚÚs t
;
ÚÚt u
if
ßß 
(
ßß 
!
ßß 
m_fProcResDict
ßß '
.
ßß' (
ContainsKey
ßß( 3
(
ßß3 4
processName
ßß4 ?
)
ßß? @
)
ßß@ A
{
àà 
FProcessResource
áá (
fProcRes
áá) 1
=
áá2 3
new
áá4 7
FProcessResource
áá8 H
(
ááH I
processName
ááI T
)
ááT U
;
ááU V
fProcRes
ãã  
.
ãã  !
	diskUsage
ãã! *
=
ãã+ ,
Convert
ãã- 4
.
ãã4 5
ToDouble
ãã5 =
(
ãã= >
porcessDiskUsage
ãã> N
)
ããN O
/
ããP Q
(
ããR S
$num
ããS W
*
ããX Y
$num
ããZ ^
)
ãã^ _
;
ãã_ `
m_fProcResDict
ää &
.
ää& '
Add
ää' *
(
ää* +
processName
ää+ 6
,
ää6 7
fProcRes
ää8 @
)
ää@ A
;
ääA B
}
åå 
else
ææ 
{
çç 
m_fProcResDict
èè &
[
èè& '
processName
èè' 2
]
èè2 3
.
èè3 4
	diskUsage
èè4 =
=
èè> ?
Convert
èè@ G
.
èèG H
ToDouble
èèH P
(
èèP Q
porcessDiskUsage
èèQ a
)
èèa b
/
èèc d
(
èèe f
$num
èèf j
*
èèk l
$num
èèm q
)
èèq r
;
èèr s
}
éé 
}
êê 
searcher
ññ 
=
ññ 
new
ññ &
ManagementObjectSearcher
ññ 7
(
ññ7 8
m_scope
òò 
,
òò 
new
óó 
SelectQuery
óó &
(
óó& '
$stróó' ‹
)óó‹ Œ
)
ôô 
;
ôô 
foreach
õõ 
(
õõ 
ManagementObject
õõ )
mo
õõ* ,
in
õõ- /
searcher
õõ0 8
.
õõ8 9
Get
õõ9 <
(
õõ< =
)
õõ= >
)
õõ> ?
{
öö 
if
÷÷ 
(
÷÷ 
m_fProcResDict
÷÷ &
.
÷÷& '
ContainsKey
÷÷' 2
(
÷÷2 3
mo
÷÷3 5
[
÷÷5 6
$str
÷÷6 <
]
÷÷< =
.
÷÷= >
ToString
÷÷> F
(
÷÷F G
)
÷÷G H
)
÷÷H I
)
÷÷I J
{
øø 
m_fProcResDict
ùù &
[
ùù& '
mo
ùù' )
[
ùù) *
$str
ùù* 0
]
ùù0 1
.
ùù1 2
ToString
ùù2 :
(
ùù: ;
)
ùù; <
]
ùù< =
.
ùù= >
cpuUsage
ùù> F
=
ùùG H
Convert
ùùI P
.
ùùP Q
ToDouble
ùùQ Y
(
ùùY Z
mo
ùùZ \
[
ùù\ ]
$str
ùù] s
]
ùùs t
)
ùùt u
/
ùùv w
Environmentùùx ƒ
.ùùƒ „
ProcessorCountùù„ ’
;ùù’ “
m_fProcResDict
úú &
[
úú& '
mo
úú' )
[
úú) *
$str
úú* 0
]
úú0 1
.
úú1 2
ToString
úú2 :
(
úú: ;
)
úú; <
]
úú< =
.
úú= >
memoryUsage
úú> I
=
úúJ K
Convert
úúL S
.
úúS T
ToDouble
úúT \
(
úú\ ]
mo
úú] _
[
úú_ `
$str
úú` s
]
úús t
)
úút u
/
úúv w
(
úúx y
$num
úúy }
*
úú~ 
$numúú€ „
)úú„ …
;úú… †
}
ûû 
}
üü 
}
ıı 
catch
şş 
(
şş 
	Exception
şş 
ex
şş 
)
şş  
{
ÿÿ 
FDebug
€€ 
.
€€ 
throwException
€€ %
(
€€% &
ex
€€& (
)
€€( )
;
€€) *
}
 
finally
‚‚ 
{
ƒƒ 
searcher
„„ 
=
„„ 
null
„„ 
;
„„  
dirInfo
…… 
=
…… 
null
…… 
;
…… 
dirList
†† 
=
†† 
null
†† 
;
†† 
processList
‡‡ 
=
‡‡ 
null
‡‡ "
;
‡‡" #
}
ˆˆ 
}
‰‰ 	
private
‘‘ 
void
‘‘ *
m_fThdPusher_ThreadJobCalled
‘‘ 1
(
‘‘1 2
object
’’ 
sender
’’ 
,
’’ 
FThreadEventArgs
““ 
e
““ 
)
”” 
{
•• 	
try
–– 
{
—— 
if
˜˜ 
(
˜˜ 
m_fTmrPusher
˜˜  
==
˜˜! #
null
˜˜$ (
)
˜˜( )
{
™™ 
m_fTmrPusher
šš  
=
šš! "
new
šš# &
FStaticTimer
šš' 3
(
šš3 4
)
šš4 5
;
šš5 6
m_fTmrPusher
œœ  
.
œœ  !
start
œœ! &
(
œœ& '
$num
œœ' +
)
œœ+ ,
;
œœ, -
return
   
;
   
}
¡¡ 
if
¥¥ 
(
¥¥ 
!
¥¥ 
m_fTmrPusher
¥¥ !
.
¥¥! "
elasped
¥¥" )
(
¥¥) *
true
¥¥* .
)
¥¥. /
)
¥¥/ 0
{
¦¦ 
e
§§ 
.
§§ 
sleepThread
§§ !
(
§§! "
$num
§§" #
)
§§# $
;
§§$ %
return
¨¨ 
;
¨¨ 
}
©© %
procProcessResourcePush
­­ '
(
­­' (
)
­­( )
;
­­) *
e
±± 
.
±± 
sleepThread
±± 
(
±± 
$num
±±  
)
±±  !
;
±±! "
}
²² 
catch
³³ 
(
³³ 
	Exception
³³ 
ex
³³ 
)
³³  
{
´´ 
FDebug
µµ 
.
µµ 
writeLog
µµ 
(
µµ  
ex
µµ  "
)
µµ" #
;
µµ# $
e
¹¹ 
.
¹¹ 
sleepThread
¹¹ 
(
¹¹ 
$num
¹¹ "
)
¹¹" #
;
¹¹# $
}
ºº 
finally
»» 
{
¼¼ 
}
¾¾ 
}
¿¿ 	
}
ÅÅ 
}ÆÆ ë:
aD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Zip\c_FZipEntryCollection.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FZipEntryCollection $
:% &
IDisposable' 2
,2 3
IEnumerable4 ?
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 

Dictionary 
< 
string !
,! "
	FZipEntry# ,
>, -
m_zipEntryDict. <
== >
null? C
;C D
private 
List 
< 
	FZipEntry 
> 
m_zipEntryList  .
=/ 0
null1 5
;5 6
internal## 
FZipEntryCollection## $
(##$ %

Dictionary$$ 
<$$ 
string$$ 
,$$ 
	FZipEntry$$ (
>$$( )
zipEntryDict$$* 6
,$$6 7
List%% 
<%% 
	FZipEntry%% 
>%% 
zipEntryList%% (
)&& 
{'' 	
m_zipEntryDict(( 
=(( 
zipEntryDict(( )
;(() *
m_zipEntryList)) 
=)) 
zipEntryList)) )
;))) *
}** 	
~.. 	
FZipEntryCollection..	 
(.. 
)// 
{00 	
	myDispose11 
(11 
false11 
)11 
;11 
}22 	
	protected66 
void66 
	myDispose66  
(66  !
bool77 
	disposing77 
)88 
{99 	
if:: 
(:: 
!:: 

m_disposed:: 
):: 
{;; 
if<< 
(<< 
	disposing<< 
)<< 
{== 
m_zipEntryDict>> "
=>># $
null>>% )
;>>) *
m_zipEntryList?? "
=??# $
null??% )
;??) *
}@@ 
}AA 

m_disposedCC 
=CC 
trueCC 
;CC 
}DD 	
publicLL 
voidLL 
DisposeLL 
(LL 
)MM 
{NN 	
	myDisposeOO 
(OO 
trueOO 
)OO 
;OO 
GCPP 
.PP 
SuppressFinalizePP 
(PP  
thisPP  $
)PP$ %
;PP% &
}QQ 	
publicYY 
IEnumeratorYY 
GetEnumeratorYY (
(YY( )
)ZZ 
{[[ 	
try\\ 
{]] 
return^^ 
new^^ )
FZipEntryCollectionEnumerator^^ 8
(^^8 9
this^^9 =
)^^= >
;^^> ?
}__ 
catch`` 
(`` 
	Exception`` 
ex`` 
)``  
{aa 
FDebugbb 
.bb 
throwExceptionbb %
(bb% &
exbb& (
)bb( )
;bb) *
}cc 
finallydd 
{ee 
}ff 
returngg 
nullgg 
;gg 
}hh 	
publicll 
intll 
countll 
{mm 	
getnn 
{oo 
trypp 
{qq 
returnrr 
m_zipEntryListrr )
.rr) *
Countrr* /
;rr/ 0
}ss 
catchtt 
(tt 
	Exceptiontt  
extt! #
)tt# $
{uu 
FDebugvv 
.vv 
throwExceptionvv )
(vv) *
exvv* ,
)vv, -
;vv- .
}ww 
finallyxx 
{yy 
}{{ 
return|| 
$num|| 
;|| 
}}} 
}~~ 	
public
‚‚ 
	FZipEntry
‚‚ 
this
‚‚ 
[
‚‚ 
int
‚‚ !
i
‚‚" #
]
‚‚# $
{
ƒƒ 	
get
„„ 
{
…… 
try
†† 
{
‡‡ 
if
ˆˆ 
(
ˆˆ 
i
ˆˆ 
<
ˆˆ 
$num
ˆˆ 
||
ˆˆ  
i
ˆˆ! "
>=
ˆˆ# %
m_zipEntryList
ˆˆ& 4
.
ˆˆ4 5
Count
ˆˆ5 :
)
ˆˆ: ;
{
‰‰ 
return
ŠŠ 
null
ŠŠ #
;
ŠŠ# $
}
‹‹ 
return
ŒŒ 
m_zipEntryList
ŒŒ )
[
ŒŒ) *
i
ŒŒ* +
]
ŒŒ+ ,
;
ŒŒ, -
}
 
catch
 
(
 
	Exception
  
ex
! #
)
# $
{
 
FDebug
 
.
 
throwException
 )
(
) *
ex
* ,
)
, -
;
- .
}
‘‘ 
finally
’’ 
{
““ 
}
•• 
return
–– 
null
–– 
;
–– 
}
—— 
}
˜˜ 	
public
œœ 
	FZipEntry
œœ 
this
œœ 
[
œœ 
string
œœ $
name
œœ% )
]
œœ) *
{
 	
get
 
{
ŸŸ 
try
   
{
¡¡ 
if
¢¢ 
(
¢¢ 
!
¢¢ 
m_zipEntryDict
¢¢ '
.
¢¢' (
ContainsKey
¢¢( 3
(
¢¢3 4
name
¢¢4 8
)
¢¢8 9
)
¢¢9 :
{
££ 
return
¤¤ 
null
¤¤ #
;
¤¤# $
}
¥¥ 
return
¦¦ 
m_zipEntryDict
¦¦ )
[
¦¦) *
name
¦¦* .
]
¦¦. /
;
¦¦/ 0
}
§§ 
catch
¨¨ 
(
¨¨ 
	Exception
¨¨  
ex
¨¨! #
)
¨¨# $
{
©© 
FDebug
ªª 
.
ªª 
throwException
ªª )
(
ªª) *
ex
ªª* ,
)
ªª, -
;
ªª- .
}
«« 
finally
¬¬ 
{
­­ 
}
¯¯ 
return
°° 
null
°° 
;
°° 
}
±± 
}
²² 	
public
ºº 
object
ºº 
item
ºº 
(
ºº 
int
»» 
index
»» 
)
¼¼ 
{
½½ 	
try
¾¾ 
{
¿¿ 
return
ÀÀ 
this
ÀÀ 
[
ÀÀ 
index
ÀÀ !
]
ÀÀ! "
;
ÀÀ" #
}
ÁÁ 
catch
ÂÂ 
(
ÂÂ 
	Exception
ÂÂ 
ex
ÂÂ 
)
ÂÂ  
{
ÃÃ 
FDebug
ÄÄ 
.
ÄÄ 
throwException
ÄÄ %
(
ÄÄ% &
ex
ÄÄ& (
)
ÄÄ( )
;
ÄÄ) *
}
ÅÅ 
finally
ÆÆ 
{
ÇÇ 
}
ÉÉ 
return
ÊÊ 
null
ÊÊ 
;
ÊÊ 
}
ËË 	
public
ÏÏ 
object
ÏÏ 
item
ÏÏ 
(
ÏÏ 
string
ĞĞ 
name
ĞĞ 
)
ÑÑ 
{
ÒÒ 	
try
ÓÓ 
{
ÔÔ 
return
ÕÕ 
this
ÕÕ 
[
ÕÕ 
name
ÕÕ  
]
ÕÕ  !
;
ÕÕ! "
}
ÖÖ 
catch
×× 
(
×× 
	Exception
×× 
ex
×× 
)
××  
{
ØØ 
FDebug
ÙÙ 
.
ÙÙ 
throwException
ÙÙ %
(
ÙÙ% &
ex
ÙÙ& (
)
ÙÙ( )
;
ÙÙ) *
}
ÚÚ 
finally
ÛÛ 
{
ÜÜ 
}
ŞŞ 
return
ßß 
null
ßß 
;
ßß 
}
àà 	
}
ææ 
}çç Ê
kD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Zip\c_FZipEntryCollectionEnumerator.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class )
FZipEntryCollectionEnumerator .
:/ 0
IEnumerator1 <
,< =
IDisposable> I
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
int 
m_index 
= 
- 
$num  
;  !
private 
FZipEntryCollection # 
m_zipEntryCollection$ 8
=9 :
null; ?
;? @
public## )
FZipEntryCollectionEnumerator## ,
(##, -
FZipEntryCollection$$ 
zipEntryCollection$$  2
)%% 
{&& 	 
m_zipEntryCollection''  
=''! "
zipEntryCollection''# 5
;''5 6
}(( 	
~,, 	)
FZipEntryCollectionEnumerator,,	 &
(,,& '
)-- 
{.. 	
}00 	
	protected44 
void44 
	myDispose44  
(44  !
bool55 
	disposing55 
)66 
{77 	
if88 
(88 
!88 

m_disposed88 
)88 
{99 
if:: 
(:: 
	disposing:: 
):: 
{;;  
m_zipEntryCollection<< (
=<<) *
null<<+ /
;<</ 0
}== 
}>> 

m_disposed?? 
=?? 
true?? 
;?? 
}@@ 	
publicHH 
voidHH 
DisposeHH 
(HH 
)II 
{JJ 	
	myDisposeKK 
(KK 
trueKK 
)KK 
;KK 
}LL 	
publicTT 
objectTT 
CurrentTT 
{UU 	
getVV 
{WW 
tryXX 
{YY 
returnZZ  
m_zipEntryCollectionZZ /
[ZZ/ 0
m_indexZZ0 7
]ZZ7 8
;ZZ8 9
}[[ 
catch\\ 
(\\ 
	Exception\\  
ex\\! #
)\\# $
{]] 
FDebug^^ 
.^^ 
throwException^^ )
(^^) *
ex^^* ,
)^^, -
;^^- .
}__ 
finally`` 
{aa 
}cc 
returndd 
nulldd 
;dd 
}ee 
}ff 	
publicjj 
booljj 
MoveNextjj 
(jj 
)kk 
{ll 	
trymm 
{nn 
m_indexoo 
++oo 
;oo 
returnpp 
(pp 
m_indexpp 
<pp  ! 
m_zipEntryCollectionpp" 6
.pp6 7
countpp7 <
)pp< =
;pp= >
}qq 
catchrr 
(rr 
Systemrr 
.rr 
	Exceptionrr #
exrr$ &
)rr& '
{ss 
FDebugtt 
.tt 
throwExceptiontt %
(tt% &
extt& (
)tt( )
;tt) *
}uu 
finallyvv 
{ww 
}yy 
returnzz 
falsezz 
;zz 
}{{ 	
public 
void 
Reset 
( 
)
€€ 
{
 	
try
‚‚ 
{
ƒƒ 
m_index
„„ 
=
„„ 
-
„„ 
$num
„„ 
;
„„ 
}
…… 
catch
†† 
(
†† 
System
†† 
.
†† 
	Exception
†† #
ex
††$ &
)
††& '
{
‡‡ 
FDebug
ˆˆ 
.
ˆˆ 
throwException
ˆˆ %
(
ˆˆ% &
ex
ˆˆ& (
)
ˆˆ( )
;
ˆˆ) *
}
‰‰ 
finally
ŠŠ 
{
‹‹ 
}
 
}
 	
}
”” 
}•• Š(
kD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Comparer\c_FDescendingOrderComparer.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class $
FDescendingOrderComparer )
:* +
	IComparer, 5
,5 6
IDisposable7 B
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
public $
FDescendingOrderComparer '
(' (
) 
{   	
}"" 	
~&& 	$
FDescendingOrderComparer&&	 !
(&&! "
)'' 
{(( 	
	myDispose)) 
()) 
false)) 
))) 
;)) 
}** 	
private.. 
void.. 
	myDispose.. 
(.. 
bool// 
	disposing// 
)00 
{11 	
if22 
(22 
!22 

m_disposed22 
)22 
{33 
if44 
(44 
	disposing44 
)44 
{55 
}77 

m_disposed88 
=88 
true88 !
;88! "
}99 
}:: 	
publicBB 
voidBB 
DisposeBB 
(BB 
)CC 
{DD 	
	myDisposeEE 
(EE 
trueEE 
)EE 
;EE 
GCFF 
.FF 
SuppressFinalizeFF 
(FF  
thisFF  $
)FF$ %
;FF% &
}GG 	
publicUU 
intUU 
CompareUU 
(UU 
objectVV 
obj1VV 
,VV 
objectWW 
obj2WW 
)XX 
{YY 	
tryZZ 
{[[ 
if\\ 
(\\ 
obj1\\ 
is\\ 
string\\ "
&&\\# %
obj2\\& *
is\\+ -
string\\. 4
)\\4 5
{]] 
return^^ 
-^^ 
String^^ "
.^^" #
Compare^^# *
(^^* +
(^^+ ,
string^^, 2
)^^2 3
obj1^^3 7
,^^7 8
(^^9 :
string^^: @
)^^@ A
obj2^^A E
)^^E F
;^^F G
}__ 
else`` 
if`` 
(`` 
obj1`` 
is``  
int``! $
&&``% '
obj2``( ,
is``- /
int``0 3
)``3 4
{aa 
ifbb 
(bb 
(bb 
intbb 
)bb 
obj1bb !
>bb" #
(bb$ %
intbb% (
)bb( )
obj2bb) -
)bb- .
{cc 
returndd 
-dd  
$numdd  !
;dd! "
}ee 
elseff 
ifff 
(ff 
(ff 
intff !
)ff! "
obj1ff" &
<ff' (
(ff) *
intff* -
)ff- .
obj2ff. 2
)ff2 3
{gg 
returnhh 
$numhh  
;hh  !
}ii 
returnjj 
$numjj 
;jj 
}kk 
elsell 
ifll 
(ll 
obj1ll 
isll  
doublell! '
&&ll( *
obj2ll+ /
isll0 2
doublell3 9
)ll9 :
{mm 
ifnn 
(nn 
(nn 
doublenn 
)nn  
obj1nn  $
>nn% &
(nn' (
doublenn( .
)nn. /
obj2nn/ 3
)nn3 4
{oo 
returnpp 
-pp  
$numpp  !
;pp! "
}qq 
elserr 
ifrr 
(rr 
(rr 
doublerr $
)rr$ %
obj1rr% )
<rr* +
(rr, -
doublerr- 3
)rr3 4
obj2rr4 8
)rr8 9
{ss 
returntt 
$numtt  
;tt  !
}uu 
returnvv 
$numvv 
;vv 
}ww 
elsexx 
ifxx 
(xx 
obj1xx 
isxx  
FileInfoxx! )
&&xx* ,
obj2xx- 1
isxx2 4
FileInfoxx5 =
)xx= >
{yy 
returnzz 
-zz 
Stringzz "
.zz" #
Comparezz# *
(zz* +
(zz+ ,
(zz, -
FileInfozz- 5
)zz5 6
obj1zz6 :
)zz: ;
.zz; <
Namezz< @
,zz@ A
(zzB C
(zzC D
FileInfozzD L
)zzL M
obj2zzM Q
)zzQ R
.zzR S
NamezzS W
)zzW X
;zzX Y
}{{ 
}|| 
catch}} 
(}} 
	Exception}} 
ex}} 
)}}  
{~~ 
FDebug 
. 
throwException %
(% &
ex& (
)( )
;) *
}
€€ 
finally
 
{
‚‚ 
}
„„ 
return
…… 
$num
…… 
;
…… 
}
†† 	
}
ŒŒ 
} “å
WD:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Database\c_FSql.cs
	namespace 	
Nexplant
 
. 
MC 
. 
Core 
. 
FaCommon #
{ 
public 

class 
FSql 
: 
IDisposable #
{ 
private 
bool 

m_disposed 
=  !
false" '
;' (
private 
string 
m_name 
= 
Guid  $
.$ %
NewGuid% ,
(, -
)- .
.. /
ToString/ 7
(7 8
)8 9
;9 :
private 
string 
m_system 
=  !
string" (
.( )
Empty) .
;. /
private 
string 
m_module 
=  !
string" (
.( )
Empty) .
;. /
private 
string 

m_function !
=" #
string$ *
.* +
Empty+ 0
;0 1
private 
string 
	m_sqlCode  
=! "
string# )
.) *
Empty* /
;/ 0
private   
string   
m_sql   
=   
string   %
.  % &
Empty  & +
;  + ,
private!! 
string!! 
m_sqlEx!! 
=!!  
string!!! '
.!!' (
Empty!!( -
;!!- .
private"" 

Dictionary"" 
<"" 
string"" !
,""! "
FSqlParameter""# 0
>""0 1
m_sqlParameterDict""2 D
=""E F
null""G K
;""K L
private## 
List## 
<## 
FSqlParameter## "
>##" #
m_sqlParameterList##$ 6
=##7 8
null##9 =
;##= >
public)) 
FSql)) 
()) 
)** 
{++ 	
m_sqlParameterDict,, 
=,,  
new,,! $

Dictionary,,% /
<,,/ 0
string,,0 6
,,,6 7
FSqlParameter,,8 E
>,,E F
(,,F G
),,G H
;,,H I
m_sqlParameterList-- 
=--  
new--! $
List--% )
<--) *
FSqlParameter--* 7
>--7 8
(--8 9
)--9 :
;--: ;
}.. 	
public22 
FSql22 
(22 
string33 
name33 
)44 
:55 
this55 
(55 
)55 
{66 	
m_name77 
=77 
name77 
;77 
}88 	
public<< 
FSql<< 
(<< 
string== 
name== 
,== 
string>> 
sql>> 
)?? 
:@@ 
this@@ 
(@@ 
name@@ 
)@@ 
{AA 	
m_sqlBB 
=BB 
sqlBB 
;BB 
}CC 	
publicGG 
FSqlGG 
(GG 
stringHH 
systemHH 
,HH 
stringII 
moduleII 
,II 
stringJJ 
functionJJ 
,JJ 
stringKK 
sqlCodeKK 
)LL 
:MM 
thisMM 
(MM 
)MM 
{NN 	
m_systemOO 
=OO 
systemOO 
;OO 
m_modulePP 
=PP 
modulePP 
;PP 

m_functionQQ 
=QQ 
functionQQ !
;QQ! "
	m_sqlCodeRR 
=RR 
sqlCodeRR 
;RR  
}SS 	
publicWW 
FSqlWW 
(WW 
stringXX 
nameXX 
,XX 
stringYY 
systemYY 
,YY 
stringZZ 
moduleZZ 
,ZZ 
string[[ 
function[[ 
,[[ 
string\\ 
sqlCode\\ 
)]] 
:^^ 
this^^ 
(^^ 
system^^ 
,^^ 
module^^ !
,^^! "
function^^# +
,^^+ ,
sqlCode^^- 4
)^^4 5
{__ 	
m_name`` 
=`` 
name`` 
;`` 
}aa 	
~ee 	
FSqlee	 
(ee 
)ff 
{gg 	
	myDisposehh 
(hh 
falsehh 
)hh 
;hh 
}ii 	
	protectedmm 
virtualmm 
voidmm 
	myDisposemm (
(mm( )
boolnn 
	disposingnn 
)oo 
{pp 	
ifqq 
(qq 
!qq 

m_disposedqq 
)qq 
{rr 
ifss 
(ss 
	disposingss 
)ss 
{tt 
m_sqlParameterDictuu &
=uu' (
nulluu) -
;uu- .
m_sqlParameterListvv &
=vv' (
nullvv) -
;vv- .
}ww 
}xx 

m_disposedyy 
=yy 
trueyy 
;yy 
}{{ 	
public
ƒƒ 
void
ƒƒ 
Dispose
ƒƒ 
(
ƒƒ 
)
„„ 
{
…… 	
	myDispose
†† 
(
†† 
true
†† 
)
†† 
;
†† 
GC
‡‡ 
.
‡‡ 
SuppressFinalize
‡‡ 
(
‡‡  
this
‡‡  $
)
‡‡$ %
;
‡‡% &
}
ˆˆ 	
public
 
string
 
name
 
{
‘‘ 	
get
’’ 
{
““ 
try
”” 
{
•• 
return
–– 
m_name
–– !
;
––! "
}
—— 
catch
˜˜ 
(
˜˜ 
	Exception
˜˜  
ex
˜˜! #
)
˜˜# $
{
™™ 
FDebug
šš 
.
šš 
throwException
šš &
(
šš& '
ex
šš' )
)
šš) *
;
šš* +
}
›› 
finally
œœ 
{
 
}
ŸŸ 
return
   
string
   
.
   
Empty
   #
;
  # $
}
¡¡ 
}
¢¢ 	
public
¦¦ 
string
¦¦ 
system
¦¦ 
{
§§ 	
get
¨¨ 
{
©© 
try
ªª 
{
«« 
return
¬¬ 
m_system
¬¬ #
;
¬¬# $
}
­­ 
catch
®® 
(
®® 
	Exception
®®  
ex
®®! #
)
®®# $
{
¯¯ 
FDebug
°° 
.
°° 
throwException
°° )
(
°°) *
ex
°°* ,
)
°°, -
;
°°- .
}
±± 
finally
²² 
{
³³ 
}
µµ 
return
¶¶ 
string
¶¶ 
.
¶¶ 
Empty
¶¶ #
;
¶¶# $
}
·· 
}
¸¸ 	
public
¼¼ 
string
¼¼ 
module
¼¼ 
{
½½ 	
get
¾¾ 
{
¿¿ 
try
ÀÀ 
{
ÁÁ 
return
ÂÂ 
m_module
ÂÂ #
;
ÂÂ# $
}
ÃÃ 
catch
ÄÄ 
(
ÄÄ 
	Exception
ÄÄ  
ex
ÄÄ! #
)
ÄÄ# $
{
ÅÅ 
FDebug
ÆÆ 
.
ÆÆ 
throwException
ÆÆ )
(
ÆÆ) *
ex
ÆÆ* ,
)
ÆÆ, -
;
ÆÆ- .
}
ÇÇ 
finally
ÈÈ 
{
ÉÉ 
}
ËË 
return
ÌÌ 
string
ÌÌ 
.
ÌÌ 
Empty
ÌÌ #
;
ÌÌ# $
}
ÍÍ 
}
ÎÎ 	
public
ÒÒ 
string
ÒÒ 
function
ÒÒ 
{
ÓÓ 	
get
ÔÔ 
{
ÕÕ 
try
ÖÖ 
{
×× 
return
ØØ 

m_function
ØØ %
;
ØØ% &
}
ÙÙ 
catch
ÚÚ 
(
ÚÚ 
	Exception
ÚÚ  
ex
ÚÚ! #
)
ÚÚ# $
{
ÛÛ 
FDebug
ÜÜ 
.
ÜÜ 
throwException
ÜÜ )
(
ÜÜ) *
ex
ÜÜ* ,
)
ÜÜ, -
;
ÜÜ- .
}
İİ 
finally
ŞŞ 
{
ßß 
}
áá 
return
ââ 
string
ââ 
.
ââ 
Empty
ââ #
;
ââ# $
}
ãã 
}
ää 	
public
èè 
string
èè 
sqlCode
èè 
{
éé 	
get
êê 
{
ëë 
try
ìì 
{
íí 
return
îî 
	m_sqlCode
îî $
;
îî$ %
}
ïï 
catch
ğğ 
(
ğğ 
	Exception
ğğ  
ex
ğğ! #
)
ğğ# $
{
ññ 
FDebug
òò 
.
òò 
throwException
òò )
(
òò) *
ex
òò* ,
)
òò, -
;
òò- .
}
óó 
finally
ôô 
{
õõ 
}
÷÷ 
return
øø 
string
øø 
.
øø 
Empty
øø #
;
øø# $
}
ùù 
}
úú 	
public
şş 
string
şş 
sql
şş 
{
ÿÿ 	
get
€€ 
{
 
try
‚‚ 
{
ƒƒ 
return
„„ 
m_sql
„„  
;
„„  !
}
…… 
catch
†† 
(
†† 
	Exception
††  
ex
††! #
)
††# $
{
‡‡ 
FDebug
ˆˆ 
.
ˆˆ 
throwException
ˆˆ &
(
ˆˆ& '
ex
ˆˆ' )
)
ˆˆ) *
;
ˆˆ* +
}
‰‰ 
finally
ŠŠ 
{
‹‹ 
}
 
return
 
string
 
.
 
Empty
 #
;
# $
}
 
set
‘‘ 
{
’’ 
try
““ 
{
”” 
m_sql
•• 
=
•• 
value
•• !
;
••! "
cleanSqlStatement
™™ %
(
™™% &
)
™™& '
;
™™' (
}
šš 
catch
›› 
(
›› 
	Exception
››  
ex
››! #
)
››# $
{
œœ 
FDebug
 
.
 
throwException
 &
(
& '
ex
' )
)
) *
;
* +
}
 
finally
ŸŸ 
{
   
}
¢¢ 
}
££ 
}
¤¤ 	
public
¨¨ 
string
¨¨ 
sqlEx
¨¨ 
{
©© 	
get
ªª 
{
«« 
try
¬¬ 
{
­­ 
return
®® 
m_sqlEx
®® "
;
®®" #
}
¯¯ 
catch
°° 
(
°° 
	Exception
°°  
ex
°°! #
)
°°# $
{
±± 
FDebug
²² 
.
²² 
throwException
²² )
(
²²) *
ex
²²* ,
)
²², -
;
²²- .
}
³³ 
finally
´´ 
{
µµ 
}
·· 
return
¸¸ 
string
¸¸ 
.
¸¸ 
Empty
¸¸ #
;
¸¸# $
}
¹¹ 
}
ºº 	
public
¾¾ %
FSqlParameterCollection
¾¾ &$
sqlParameterCollection
¾¾' =
{
¿¿ 	
get
ÀÀ 
{
ÁÁ 
try
ÂÂ 
{
ÃÃ 
return
ÄÄ 
new
ÄÄ %
FSqlParameterCollection
ÄÄ 6
(
ÄÄ6 7 
m_sqlParameterDict
ÄÄ7 I
,
ÄÄI J 
m_sqlParameterList
ÄÄK ]
)
ÄÄ] ^
;
ÄÄ^ _
}
ÅÅ 
catch
ÆÆ 
(
ÆÆ 
	Exception
ÆÆ  
ex
ÆÆ! #
)
ÆÆ# $
{
ÇÇ 
FDebug
ÈÈ 
.
ÈÈ 
throwException
ÈÈ &
(
ÈÈ& '
ex
ÈÈ' )
)
ÈÈ) *
;
ÈÈ* +
}
ÉÉ 
finally
ÊÊ 
{
ËË 
}
ÍÍ 
return
ÎÎ 
null
ÎÎ 
;
ÎÎ 
}
ÏÏ 
}
ĞĞ 	
	protected
ÔÔ 
List
ÔÔ 
<
ÔÔ 
FSqlParameter
ÔÔ $
>
ÔÔ$ %
sqlParameterList
ÔÔ& 6
{
ÕÕ 	
get
ÖÖ 
{
×× 
try
ØØ 
{
ÙÙ 
return
ÚÚ  
m_sqlParameterList
ÚÚ -
;
ÚÚ- .
}
ÛÛ 
catch
ÜÜ 
(
ÜÜ 
	Exception
ÜÜ  
ex
ÜÜ! #
)
ÜÜ# $
{
İİ 
FDebug
ŞŞ 
.
ŞŞ 
throwException
ŞŞ &
(
ŞŞ& '
ex
ŞŞ' )
)
ŞŞ) *
;
ŞŞ* +
}
ßß 
finally
àà 
{
áá 
}
ãã 
return
ää 
null
ää 
;
ää 
}
åå 
}
ææ 	
public
îî 
void
îî  
appendSqlParameter
îî &
(
îî& '
FSqlParameter
ïï 
sqlParameter
ïï &
)
ğğ 
{
ññ 	
try
òò 
{
óó 
if
ôô 
(
ôô  
m_sqlParameterDict
ôô %
.
ôô% &
ContainsKey
ôô& 1
(
ôô1 2
sqlParameter
ôô2 >
.
ôô> ?
name
ôô? C
)
ôôC D
)
ôôD E
{
õõ 
FDebug
öö 
.
öö 
throwFException
öö *
(
öö* +
string
öö+ 1
.
öö1 2
Format
öö2 8
(
öö8 9

FConstants
öö9 C
.
ööC D

err_m_0004
ööD N
,
ööN O
$str
ööO c
)
ööc d
)
ööd e
;
ööe f
}
÷÷  
m_sqlParameterDict
øø "
.
øø" #
Add
øø# &
(
øø& '
sqlParameter
øø' 3
.
øø3 4
name
øø4 8
,
øø8 9
sqlParameter
øø: F
)
øøF G
;
øøG H 
m_sqlParameterList
ùù "
.
ùù" #
Add
ùù# &
(
ùù& '
sqlParameter
ùù' 3
)
ùù3 4
;
ùù4 5
}
úú 
catch
ûû 
(
ûû 
	Exception
ûû 
ex
ûû 
)
ûû  
{
üü 
FDebug
ıı 
.
ıı 
throwException
ıı "
(
ıı" #
ex
ıı# %
)
ıı% &
;
ıı& '
}
şş 
finally
ÿÿ 
{
€€ 
}
‚‚ 
}
ƒƒ 	
public
‡‡ 
void
‡‡  
appendSqlParameter
‡‡ &
(
‡‡& '
string
ˆˆ 
name
ˆˆ 
)
‰‰ 
{
ŠŠ 	
FSqlParameter
‹‹ 
sqlPar
‹‹  
=
‹‹! "
null
‹‹# '
;
‹‹' (
try
 
{
 
if
 
(
  
m_sqlParameterDict
 &
.
& '
ContainsKey
' 2
(
2 3
name
3 7
)
7 8
)
8 9
{
 
FDebug
‘‘ 
.
‘‘ 
throwFException
‘‘ *
(
‘‘* +
string
‘‘+ 1
.
‘‘1 2
Format
‘‘2 8
(
‘‘8 9

FConstants
‘‘9 C
.
‘‘C D

err_m_0004
‘‘D N
,
‘‘N O
$str
‘‘P d
)
‘‘d e
)
‘‘e f
;
‘‘f g
}
’’ 
sqlPar
““ 
=
““ 
new
““ 
FSqlParameter
““ *
(
““* +
name
““+ /
)
““/ 0
;
““0 1 
m_sqlParameterDict
”” "
.
””" #
Add
””# &
(
””& '
sqlPar
””' -
.
””- .
name
””. 2
,
””2 3
sqlPar
””4 :
)
””: ;
;
””; < 
m_sqlParameterList
•• "
.
••" #
Add
••# &
(
••& '
sqlPar
••' -
)
••- .
;
••. /
}
–– 
catch
—— 
(
—— 
	Exception
—— 
ex
—— 
)
——  
{
˜˜ 
FDebug
™™ 
.
™™ 
throwException
™™ %
(
™™% &
ex
™™& (
)
™™( )
;
™™) *
}
šš 
finally
›› 
{
œœ 
sqlPar
 
=
 
null
 
;
 
}
 
}
ŸŸ 	
public
££ 
void
££  
appendSqlParameter
££ &
(
££& '
string
¤¤ 
name
¤¤ 
,
¤¤ 
object
¥¥ 
value
¥¥ 
)
¦¦ 
{
§§ 	
FSqlParameter
¨¨ 
sqlPar
¨¨  
=
¨¨! "
null
¨¨# '
;
¨¨' (
try
ªª 
{
«« 
if
¬¬ 
(
¬¬  
m_sqlParameterDict
¬¬ %
.
¬¬% &
ContainsKey
¬¬& 1
(
¬¬1 2
name
¬¬2 6
)
¬¬6 7
)
¬¬7 8
{
­­ 
FDebug
®® 
.
®® 
throwFException
®® *
(
®®* +
string
®®+ 1
.
®®1 2
Format
®®2 8
(
®®8 9

FConstants
®®9 C
.
®®C D

err_m_0004
®®D N
,
®®N O
$str
®®O c
)
®®c d
)
®®d e
;
®®e f
}
¯¯ 
sqlPar
°° 
=
°° 
new
°° 
FSqlParameter
°° *
(
°°* +
name
°°+ /
,
°°/ 0
value
°°1 6
)
°°6 7
;
°°7 8 
m_sqlParameterDict
±± "
.
±±" #
Add
±±# &
(
±±& '
sqlPar
±±' -
.
±±- .
name
±±. 2
,
±±2 3
sqlPar
±±4 :
)
±±: ;
;
±±; < 
m_sqlParameterList
²² "
.
²²" #
Add
²²# &
(
²²& '
sqlPar
²²' -
)
²²- .
;
²². /
}
³³ 
catch
´´ 
(
´´ 
	Exception
´´ 
ex
´´ 
)
´´  
{
µµ 
FDebug
¶¶ 
.
¶¶ 
throwException
¶¶ "
(
¶¶" #
ex
¶¶# %
)
¶¶% &
;
¶¶& '
}
·· 
finally
¸¸ 
{
¹¹ 
sqlPar
ºº 
=
ºº 
null
ºº 
;
ºº 
}
»» 
}
¼¼ 	
public
ÀÀ 
FSqlParameter
ÀÀ  
removeSqlParameter
ÀÀ /
(
ÀÀ/ 0
FSqlParameter
ÁÁ 
sqlParameter
ÁÁ &
)
ÂÂ 
{
ÃÃ 	
try
ÄÄ 
{
ÅÅ 
if
ÆÆ 
(
ÆÆ 
!
ÆÆ  
m_sqlParameterDict
ÆÆ &
.
ÆÆ& '
ContainsValue
ÆÆ' 4
(
ÆÆ4 5
sqlParameter
ÆÆ5 A
)
ÆÆA B
)
ÆÆB C
{
ÇÇ 
FDebug
ÈÈ 
.
ÈÈ 
throwFException
ÈÈ *
(
ÈÈ* +
string
ÈÈ+ 1
.
ÈÈ1 2
Format
ÈÈ2 8
(
ÈÈ8 9

FConstants
ÈÈ9 C
.
ÈÈC D

err_m_0003
ÈÈD N
,
ÈÈN O
$str
ÈÈP _
)
ÈÈ_ `
)
ÈÈ` a
;
ÈÈa b
}
ÉÉ  
m_sqlParameterDict
ÊÊ "
.
ÊÊ" #
Remove
ÊÊ# )
(
ÊÊ) *
sqlParameter
ÊÊ* 6
.
ÊÊ6 7
name
ÊÊ7 ;
)
ÊÊ; <
;
ÊÊ< = 
m_sqlParameterList
ËË "
.
ËË" #
Remove
ËË# )
(
ËË) *
sqlParameter
ËË* 6
)
ËË6 7
;
ËË7 8
return
ÌÌ 
sqlParameter
ÌÌ #
;
ÌÌ# $
}
ÍÍ 
catch
ÎÎ 
(
ÎÎ 
	Exception
ÎÎ 
ex
ÎÎ 
)
ÎÎ  
{
ÏÏ 
FDebug
ĞĞ 
.
ĞĞ 
throwException
ĞĞ %
(
ĞĞ% &
ex
ĞĞ& (
)
ĞĞ( )
;
ĞĞ) *
}
ÑÑ 
finally
ÒÒ 
{
ÓÓ 
}
ÕÕ 
return
ÖÖ 
null
ÖÖ 
;
ÖÖ 
}
×× 	
private
ÛÛ 
void
ÛÛ 
cleanSqlStatement
ÛÛ &
(
ÛÛ& '
)
ÜÜ 
{
İİ 	
const
ŞŞ 
string
ŞŞ  
PATTERN_TEXT_BLOCK
ŞŞ +
=
ŞŞ, -
$str
ŞŞ. ?
;
ŞŞ? @
const
ßß 
string
ßß 
PATTERN_BREAK_TAB
ßß *
=
ßß+ ,
$str
ßß- :
;
ßß: ;
const
àà 
string
àà $
PATTERN_SINGLE_COMMENT
àà /
=
àà0 1
$str
àà2 A
;
ààA B
const
áá 
string
áá &
PATTERN_MULTIPLE_COMMENT
áá 1
=
áá2 3
$str
áá4 G
;
ááG H
const
ââ 
string
ââ !
PATTERN_ORACLE_HINT
ââ ,
=
ââ- .
$str
ââ/ ?
;
ââ? @
const
ãã 
string
ãã $
PATTERN_MULTIPLE_SPACE
ãã /
=
ãã0 1
$str
ãã2 I
;
ããI J
MatchCollection
çç 
matches
çç #
=
çç$ %
null
çç& *
;
çç* +
string
èè 
pattern1
èè 
=
èè 
string
èè $
.
èè$ %
Empty
èè% *
;
èè* +
string
éé 
pattern2
éé 
=
éé 
string
éé $
.
éé$ %
Empty
éé% *
;
éé* +
try
ëë 
{
ìì 
m_sqlEx
íí 
=
íí 
this
íí 
.
íí 
sql
íí "
;
íí" #
pattern1
ôô 
=
ôô 
string
ôô !
.
ôô! "
Join
ôô" &
(
ôô& '
$str
ôô' *
,
ôô* + 
PATTERN_TEXT_BLOCK
ôô, >
,
ôô> ?
PATTERN_BREAK_TAB
ôô@ Q
,
ôôQ R$
PATTERN_SINGLE_COMMENT
ôôS i
,
ôôi j'
PATTERN_MULTIPLE_COMMENTôôk ƒ
)ôôƒ „
;ôô„ …
matches
øø 
=
øø 
Regex
øø 
.
øø  
Matches
øø  '
(
øø' (
m_sqlEx
øø( /
,
øø/ 0
pattern1
øø1 9
,
øø9 :
RegexOptions
øø; G
.
øøG H

IgnoreCase
øøH R
|
øøS T
RegexOptions
øøU a
.
øøa b
	Multiline
øøb k
)
øøk l
;
øøl m
for
ÿÿ 
(
ÿÿ 
int
ÿÿ 
i
ÿÿ 
=
ÿÿ 
matches
ÿÿ $
.
ÿÿ$ %
Count
ÿÿ% *
-
ÿÿ+ ,
$num
ÿÿ- .
;
ÿÿ. /
i
ÿÿ0 1
>=
ÿÿ2 4
$num
ÿÿ5 6
;
ÿÿ6 7
i
ÿÿ8 9
--
ÿÿ9 ;
)
ÿÿ; <
{
€€ 
if
„„ 
(
„„ 
!
„„ 
matches
„„  
[
„„  !
i
„„! "
]
„„" #
.
„„# $
Value
„„$ )
.
„„) *

StartsWith
„„* 4
(
„„4 5
$str
„„5 8
)
„„8 9
&&
„„: <
!
„„= >
matches
„„> E
[
„„E F
i
„„F G
]
„„G H
.
„„H I
Value
„„I N
.
„„N O
EndsWith
„„O W
(
„„W X
$str
„„X [
)
„„[ \
)
„„\ ]
{
…… 
m_sqlEx
†† 
=
††  !
string
††" (
.
††( )
Join
††) -
(
††- .
$str
††. 1
,
††1 2
m_sqlEx
††3 :
.
††: ;
	Substring
††; D
(
††D E
$num
††E F
,
††F G
matches
††H O
[
††O P
i
††P Q
]
††Q R
.
††R S
Index
††S X
)
††X Y
,
††Y Z
m_sqlEx
††[ b
.
††b c
	Substring
††c l
(
††l m
matches
††m t
[
††t u
i
††u v
]
††v w
.
††w x
Index
††x }
+
††~ 
matches††€ ‡
[††‡ ˆ
i††ˆ ‰
]††‰ Š
.††Š ‹
Length††‹ ‘
)††‘ ’
)††’ “
;††“ ”
}
‡‡ 
}
ˆˆ 
pattern2
 
=
 
string
 !
.
! "
Join
" &
(
& '
$str
' *
,
* +!
PATTERN_ORACLE_HINT
, ?
,
? @$
PATTERN_MULTIPLE_SPACE
A W
)
W X
;
X Y
matches
““ 
=
““ 
Regex
““ 
.
““  
Matches
““  '
(
““' (
m_sqlEx
““( /
,
““/ 0
pattern2
““1 9
,
““9 :
RegexOptions
““; G
.
““G H

IgnoreCase
““H R
|
““S T
RegexOptions
““U a
.
““a b
	Multiline
““b k
)
““k l
;
““l m
for
 
(
 
int
 
i
 
=
 
matches
 $
.
$ %
Count
% *
-
+ ,
$num
- .
;
. /
i
0 1
>=
2 4
$num
5 6
;
6 7
i
8 9
--
9 ;
)
; <
{
 
if
¢¢ 
(
¢¢ 
!
¢¢ 
matches
¢¢  
[
¢¢  !
i
¢¢! "
]
¢¢" #
.
¢¢# $
Value
¢¢$ )
.
¢¢) *

StartsWith
¢¢* 4
(
¢¢4 5
$str
¢¢5 8
)
¢¢8 9
&&
¢¢: <
!
¢¢= >
matches
¢¢> E
[
¢¢E F
i
¢¢F G
]
¢¢G H
.
¢¢H I
Value
¢¢I N
.
¢¢N O
EndsWith
¢¢O W
(
¢¢W X
$str
¢¢X [
)
¢¢[ \
)
¢¢\ ]
{
££ 
if
¤¤ 
(
¤¤ 
Regex
¤¤ !
.
¤¤! "
IsMatch
¤¤" )
(
¤¤) *
matches
¤¤* 1
[
¤¤1 2
i
¤¤2 3
]
¤¤3 4
.
¤¤4 5
Value
¤¤5 :
,
¤¤: ;!
PATTERN_ORACLE_HINT
¤¤< O
,
¤¤O P
RegexOptions
¤¤Q ]
.
¤¤] ^

IgnoreCase
¤¤^ h
|
¤¤i j
RegexOptions
¤¤k w
.
¤¤w x
	Multiline¤¤x 
)¤¤ ‚
)¤¤‚ ƒ
{
¥¥ 
continue
¦¦ $
;
¦¦$ %
}
§§ 
else
¨¨ 
if
¨¨ 
(
¨¨  !
Regex
¨¨! &
.
¨¨& '
IsMatch
¨¨' .
(
¨¨. /
matches
¨¨/ 6
[
¨¨6 7
i
¨¨7 8
]
¨¨8 9
.
¨¨9 :
Value
¨¨: ?
,
¨¨? @$
PATTERN_MULTIPLE_SPACE
¨¨A W
,
¨¨W X
RegexOptions
¨¨Y e
.
¨¨e f

IgnoreCase
¨¨f p
|
¨¨q r
RegexOptions
¨¨s 
.¨¨ €
	Multiline¨¨€ ‰
)¨¨‰ Š
)¨¨Š ‹
{
©© 
m_sqlEx
ªª #
=
ªª$ %
string
ªª& ,
.
ªª, -
Join
ªª- 1
(
ªª1 2
$str
ªª2 5
,
ªª5 6
m_sqlEx
ªª7 >
.
ªª> ?
	Substring
ªª? H
(
ªªH I
$num
ªªI J
,
ªªJ K
matches
ªªL S
[
ªªS T
i
ªªT U
]
ªªU V
.
ªªV W
Index
ªªW \
)
ªª\ ]
,
ªª] ^
m_sqlEx
ªª_ f
.
ªªf g
	Substring
ªªg p
(
ªªp q
matches
ªªq x
[
ªªx y
i
ªªy z
]
ªªz {
.
ªª{ |
Indexªª| 
+ªª‚ ƒ
matchesªª„ ‹
[ªª‹ Œ
iªªŒ 
]ªª 
.ªª 
Lengthªª •
)ªª• –
)ªª– —
;ªª— ˜
}
«« 
}
¬¬ 
}
­­ 
}
®® 
catch
¯¯ 
(
¯¯ 
	Exception
¯¯ 
ex
¯¯ 
)
¯¯  
{
°° 
FDebug
±± 
.
±± 
throwException
±± %
(
±±% &
ex
±±& (
)
±±( )
;
±±) *
}
²² 
finally
³³ 
{
´´ 
matches
µµ 
=
µµ 
null
µµ 
;
µµ 
}
¶¶ 
}
·· 	
private
½½ 
void
½½ 
debugMatchList
½½ #
(
½½# $
string
¾¾ 
title
¾¾ 
,
¾¾ 
MatchCollection
¿¿ 
matches
¿¿ #
)
ÀÀ 
{
ÁÁ 	
System
ÂÂ 
.
ÂÂ 
Diagnostics
ÂÂ 
.
ÂÂ 
Debug
ÂÂ $
.
ÂÂ$ %
	WriteLine
ÂÂ% .
(
ÂÂ. /
string
ÂÂ/ 5
.
ÂÂ5 6
Format
ÂÂ6 <
(
ÂÂ< =
$str
ÂÂ= D
,
ÂÂD E
title
ÂÂF K
)
ÂÂK L
)
ÂÂL M
;
ÂÂM N
for
ÃÃ 
(
ÃÃ 
int
ÃÃ 
i
ÃÃ 
=
ÃÃ 
$num
ÃÃ 
;
ÃÃ 
i
ÃÃ 
<
ÃÃ 
matches
ÃÃ  '
.
ÃÃ' (
Count
ÃÃ( -
;
ÃÃ- .
i
ÃÃ/ 0
++
ÃÃ0 2
)
ÃÃ2 3
{
ÄÄ 
System
ÅÅ 
.
ÅÅ 
Diagnostics
ÅÅ "
.
ÅÅ" #
Debug
ÅÅ# (
.
ÅÅ( )
	WriteLine
ÅÅ) 2
(
ÅÅ2 3
string
ÅÅ3 9
.
ÅÅ9 :
Format
ÅÅ: @
(
ÅÅ@ A
$str
ÅÅA T
,
ÅÅT U
i
ÅÅV W
,
ÅÅW X
(
ÅÅY Z
(
ÅÅZ [
matches
ÅÅ[ b
[
ÅÅb c
i
ÅÅc d
]
ÅÅd e
.
ÅÅe f
Value
ÅÅf k
.
ÅÅk l
Replace
ÅÅl s
(
ÅÅs t
$str
ÅÅt x
,
ÅÅx y
$strÅÅz ƒ
)ÅÅƒ „
)ÅÅ„ …
.ÅÅ… †
ReplaceÅÅ† 
(ÅÅ 
$strÅÅ ’
,ÅÅ’ “
$strÅÅ” ™
)ÅÅ™ š
)ÅÅš ›
.ÅÅ› œ
ReplaceÅÅœ £
(ÅÅ£ ¤
$strÅÅ¤ ¨
,ÅÅ¨ ©
$strÅÅª ¯
)ÅÅ¯ °
)ÅÅ° ±
)ÅÅ± ²
;ÅÅ² ³
}
ÆÆ 
}
ÇÇ 	
}
ÏÏ 
}ĞĞ Š
_D:\Product\Nexplant\src\nexplant.mc\001_MCCore.v4.6\Nexplant.Mc.Core\Properties\AssemblyInfo.cs
[ 
assembly 	
:	 

AssemblyTitle 
( 
$str 0
)0 1
]1 2
[		 
assembly		 	
:			 

AssemblyDescription		 
(		 
$str		 9
)		9 :
]		: ;
[

 
assembly

 	
:

	 
!
AssemblyConfiguration

  
(

  !
$str

! #
)

# $
]

$ %
[ 
assembly 	
:	 

AssemblyCompany 
( 
$str *
)* +
]+ ,
[ 
assembly 	
:	 

AssemblyProduct 
( 
$str 5
)5 6
]6 7
[ 
assembly 	
:	 

AssemblyCopyright 
( 
$str B
)B C
]C D
[ 
assembly 	
:	 

AssemblyTrademark 
( 
$str '
)' (
]( )
[ 
assembly 	
:	 

AssemblyCulture 
( 
$str 
) 
] 
[ 
assembly 	
:	 


ComVisible 
( 
false 
) 
] 
[ 
assembly 	
:	 

Guid 
( 
$str 6
)6 7
]7 8
[## 
assembly## 	
:##	 

AssemblyVersion## 
(## 
$str## $
)##$ %
]##% &
[$$ 
assembly$$ 	
:$$	 

AssemblyFileVersion$$ 
($$ 
$str$$ (
)$$( )
]$$) *